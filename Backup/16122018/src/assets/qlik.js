define("js/configloader",{load:function(a,b,c){b(["assets/require-config"],function(d){(d=d||b)([a],function(a){c(a)})})}}),define("apis/qlik-impl",["client.utils/state","apis/qutil","apis/qglobal","apis/qapp","apis/qnavigation","apis/qsession","apis/qlik-visual","assets/qlikui/custom-components","general.utils/qv-activate","general.utils/qv-swipe","general.utils/qv-longtapswipe","objects/object","client.views/current-selections/current-selections","core.utils/augment","angular-route","angular-animate","angular-sanitize"],function(a,b,c,d,e,f,g){"use strict";function h(a,b){d.setErrorCallback(a),c.setErrorCallback(a),j||f.setupSocketErrorHandling(a,b)}var i,j=b.inClient();j||(a.setState(a.States.analysis),a.setView(a.Views.sheet)),function(){var a=document.querySelectorAll("body > .qvobject, body > .qvplaceholder");return 0!==a.length&&(Array.prototype.forEach.call(a,function(a){if("absolute"!==a.style.position)return!1}),!0)}()&&(document.body.classList.add("absolute-position-mashup"),document.documentElement.classList.add("absolute-position-mashup")),i=new e(j),g.init();var k={openApp:d.openApp,currApp:d.currApp,getGlobal:c.get,setOnError:h,setLanguage:b.setLanguage,table:d.table,getAppList:c.getAppList,resize:b.resize,getExtensionList:b.getExtensionList,callRepository:b.callRepository,registerExtension:b.registerExtension,navigation:i,sessionApp:d.sessionApp,sessionAppFromApp:d.sessionAppFromApp};return Object.defineProperty(k,"Promise",{get:function(){return b.Promise}}),define("qlik",k),require.s.contexts.sense&&(require.s.contexts._.defined.angular=require.s.contexts.sense.defined.angular),k}),define("js/qlik",["js/configloader!apis/qlik-impl"],function(a){return a}),define("assets/qvangular/qvangular-config",[],function(){var a="false"!==(document.documentElement.getAttribute("qva-bootstrap")||document.body.getAttribute("qva-bootstrap"));return{internalOptimizations:a,autoBootstrap:a}}),function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b(require("angular")):"function"==typeof define&&define.amd?define("angular-leonardo-ui",["angular"],b):"object"==typeof exports?exports["angular-leonardo-ui"]=b(require("angular")):a["angular-leonardo-ui"]=b(a.angular)}(this,function(a){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.config=void 0;var d=c(1),e=function(a){return a&&a.__esModule?a:{default:a}}(d),f=c(2);c(3),c(6),c(8),c(10),c(12),c(15),c(17),c(19),c(22),c(26),c(30),c(32);var g=e.default.module("leonardo-ui",["leonardo-ui.button","leonardo-ui.checkbox","leonardo-ui.radiobutton","leonardo-ui.search","leonardo-ui.select","leonardo-ui.switch","leonardo-ui.dialog","leonardo-ui.popover","leonardo-ui.tooltip","leonardo-ui.toast","leonardo-ui.overlay","leonardo-ui.tabview"]);g.directive("luiClassList",function(){return{scope:!1,link:function(a,b,c){var d=[];a.$watch(c.luiClassList,function(a){a&&(d.filter(function(b){return!a||a.indexOf(b)===-1}).forEach(function(a){b.removeClass(a)}),a.filter(function(a){return!d||d.indexOf(a)===-1}).forEach(function(a){b.addClass(a)}),d=a)})}}}),g.directive("luiComponent",["$compile","$controller",function(a,b){return{scope:!1,link:function(c,d,f){var g=c.$new(),h=c.$eval(f.controller),i=c.$eval(f.template)||"",j=c.$eval(f.input)||{},k=d[0].querySelector("lui-transclude"),l=k?e.default.element(k):d,m={$scope:g,$element:l,$attrs:f,input:j};for(var n in j)j.hasOwnProperty(n)&&(m[n]=j[n],g[n]=j[n]);l.html(i),k&&l.replaceWith(l.contents());var o=a(d.contents());h&&d.contents().data("$ngControllerController",b(h,m)),o(g),d.on("remove.luicomponent",function(){g.$$destroyed||g.$destroy()})}}}]);b.config=f.setConfig},function(b,c){b.exports=a},function(a,b){"use strict";function c(a){a.showOverlay&&(b.showOverlay=d=a.showOverlay)}Object.defineProperty(b,"__esModule",{value:!0}),b.setConfig=c;var d=b.showOverlay=null},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}var e=c(1),f=d(e),g=c(4),h=c(5),i=d(h);f.default.module("leonardo-ui.button",[]).directive("luiButton",function(){return{restrict:"E",replace:!0,transclude:!0,template:i.default,scope:{variant:"@",block:"=",active:"="},link:function(a,b){b.on("keypress",function(a){13===a.keyCode&&b.trigger("qv-activate")});var c=function(){a.classList=(0,g.bemClassList)("lui-button",{variant:a.variant,modifiers:{block:a.block},states:{active:a.active}})};a.$watch("variant",c),a.$watch("active",c),a.$watch("block",c),c()}}})},function(a,b){"use strict";function c(a,b){var c=b.modifiers,d=b.variant,e=b.states,f=[a];return d&&f.push(" "+a+"--"+d),c&&Object.keys(c).forEach(function(b){c[b]&&f.push(a+"--"+b)}),e&&Object.keys(e).forEach(function(a){e[a]&&f.push("lui-"+a)}),f}Object.defineProperty(b,"__esModule",{value:!0}),b.bemClassList=c},function(a,b){a.exports='<button lui-class-list="classList" ng-transclude></button>\n'},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}var e=c(1),f=d(e),g=c(4),h=c(7),i=d(h);f.default.module("leonardo-ui.checkbox",[]).directive("luiCheckbox",function(){return{restrict:"E",replace:!0,transclude:!0,template:i.default,scope:{model:"=",disabled:"=?",change:"&",variant:"@"},link:function(a){var b=function(){a.classList=(0,g.bemClassList)("lui-checkbox",{variant:a.variant})};a.$watch("variant",b),b()}}})},function(a,b){a.exports='<label lui-class-list="classList">\n\t<input class="lui-checkbox__input"\n\t\ttype="checkbox"\n\t\tng-model="model"\n\t\tng-disabled="disabled"\n\t\tng-change="change()">\n\t<div class="lui-checkbox__check-wrap">\n\t\t<span class="lui-checkbox__check"></span>\n\t\t<span class="lui-checkbox__check-text" ng-transclude></span>\n\t</div>\n</label>\n'},function(a,b,c){"use strict";var d=c(1),e=function(a){return a&&a.__esModule?a:{default:a}}(d),f=c(2);c(9),e.default.module("leonardo-ui.overlay",["leonardo-ui.default-overlay"]).service("luiOverlay",["$rootScope","$window","luiDefaultOverlay",function(a,b,c){function d(b){a.$root.$$phase?b&&b():a.$apply(b)}function g(){for(var a=m.length-1;a>=0;a--){var b=m[a];if(b.closeOnEscape===!1)return null;if(b.closeOnEscape===!0)return b}return null}function h(a){27===a.keyCode&&function(){var a=g();null!==a&&d(function(){a.close()})}()}function i(a){d(function(){a.close()})}function j(){for(var a=m.length-1;a>=0;a--){var b=m[a];b.closeOnResize===!0&&i(b)}}function k(a){return m.indexOf(a)>-1&&(m.splice(m.indexOf(a),1),!0)}var l={},m=[];return b.addEventListener("resize",j),b.addEventListener("keyup",h),l.show=function(a,b){function g(){k(i),j.destroy()}function h(){d(function(){j.close?j.close():g()})}var i=void 0,j=void 0,l=e.default.extend({},b||{});return l.removeOverlay=g,j=f.showOverlay?(0,f.showOverlay)(a,l):c.showOverlay(a,l),i={res:j,close:h,closeOnEscape:b.closeOnEscape,closeOnResize:b.closeOnResize},m.push(i),d(),{close:h}},l}])},function(a,b,c){"use strict";var d=c(1),e=function(a){return a&&a.__esModule?a:{default:a}}(d);e.default.module("leonardo-ui.default-overlay",[]).service("luiDefaultOverlay",["$rootScope","$controller","$compile",function(a,b,c){var d=null;return{showOverlay:function(f,g){d||(d=e.default.element("<div></div>"),e.default.element(document.body).append(d));var h=e.default.element("<div></div>");d.append(h),h.html(f.template);var i=a.$new(),j=void 0;if(f.controller){if(j={$scope:i,$element:h},g)for(var k in g)g.hasOwnProperty(k)&&(j[k]=g[k],i[k]=g[k]);var l={};j.exposedApi=l,i.exposedApi=l;var m=b(f.controller,j);h.contents().data("$ngControllerController",m)}c(h.contents())(i);var n=function(){i.$$destroyed||i.$destroy(),h.remove()};return h.on("remove",close),{close:j.exposedApi.close,destroy:n}}}}])},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}var e=c(1),f=d(e),g=c(4),h=c(11),i=d(h);f.default.module("leonardo-ui.radiobutton",[]).directive("luiRadiobutton",function(){return{restrict:"E",replace:!0,transclude:!0,scope:{value:"@",name:"@",model:"=",disabled:"=?",change:"&",variant:"@"},template:i.default,link:function(a){var b=function(){a.classList=(0,g.bemClassList)("lui-radiobutton",{variant:a.variant})};a.$watch("variant",b),b()}}})},function(a,b){a.exports='<label lui-class-list="classList">\n\t<input class="lui-radiobutton__input"\n\t\t   type="radio"\n\t\t   ng-value="value"\n\t\t   ng-model="model"\n\t\t   ng-disabled="disabled"\n\t\t   ng-change="change()"\n\t\t   name="{{name}}">\n\t<div class="lui-radiobutton__radio-wrap">\n\t\t<span class="lui-radiobutton__radio"></span>\n\t\t<span class="lui-radiobutton__radio-text" ng-transclude></span>\n\t</div>\n</label>\n'},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}var e=c(1),f=d(e),g=c(4),h=c(13),i=d(h),j=c(14),k=d(j);f.default.module("leonardo-ui.search",[]).directive("luiSearch",function(){return{restrict:"E",replace:!0,transclude:!0,scope:{query:"=",disabled:"=",autocomplete:"=",placeholder:"@",autoFocus:"=?",isFocused:"=?",focuscallback:"&",maxlength:"=",onEscape:"&",onEnter:"&",onClear:"&",variant:"@"},template:i.default,link:function(a,b){var c=f.default.element(b[0].querySelector("input"));c.on("focus.luiSearchField",function(){a.$root.$$phase?a.focused():a.$apply(function(){a.focused()})}),(0,k.default)(a),a.$on("$destroy",function(){c.off(".luiSearchField")});var d=function(){a.classList=(0,g.bemClassList)("lui-search",{variant:a.variant})};a.$watch("variant",d),d()}}})},function(a,b){a.exports='<div lui-class-list="classList">\n\t<span class="lui-search__search-icon"></span>\n\t<input class="lui-search__input" maxlength="{{maxlength || 255}}" q-placeholder="{{placeholder}}" ng-model="query"\n\t\t   ng-disabled="disabled" autocomplete="{{autocomplete}}" spellcheck="false" ng-trim="false" type="text"\n\t\t   qva-blur="blurred()" qva-focus="autoFocus" qv-escape="escape($event)" qv-enter="enter($event)"/>\n\t<span class="lui-search__clear-icon" q-title-translation="Common.Clear" ng-show="query.length" ng-click="clearSearch($event)"></span>\n</div>\n'},function(a,b){"use strict";function c(a){a.focused=function(){a.focuscallback(),a.isFocused=!0},a.blurred=function(){a.isFocused=!1},a.escape=function(b){a.onEscape&&a.onEscape({$event:b})},a.enter=function(b){a.onEnter&&a.onEnter({$event:b})},a.clearSearch=function(b){b.preventDefault(),a.query="",a.onClear&&a.onClear({$event:b})}}Object.defineProperty(b,"__esModule",{value:!0}),b.default=c},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a){return a.replace(/"/g,"&quot;")}var f=c(1),g=d(f),h=c(16),i=d(h);g.default.module("leonardo-ui.select",[]).directive("luiSelect",function(){return{restrict:"E",replace:!0,transclude:!1,template:function(a,b){var c="lui-select";b.variant&&(c+=" lui-select--"+b.variant);var d='class="'+e(c)+'"';return b.model&&(d+=' ng-model="'+e(b.model)+'"'),b.disabled&&(d+=' ng-disabled="'+e(b.disabled)+'"'),b.options&&(d+=' ng-options="'+e(b.options)+'"'),b.change&&(d+=' ng-change="'+e(b.change)+'"'),i.default.replace("%attrs%",d).replace("%options%",a.html())},scope:!1}})},function(a,b){a.exports="<select %attrs%>\n\t%options%\n</select>\n"},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}var e=c(1),f=d(e),g=c(4),h=c(18),i=d(h);f.default.module("leonardo-ui.switch",[]).directive("luiSwitch",function(){return{restrict:"E",replace:!0,transclude:!0,scope:{disabled:"=",model:"=",variant:"@"},template:i.default,link:function(a,b){var c=function(){a.classList=(0,g.bemClassList)("lui-switch",{variant:a.variant,states:{disabled:a.disabled,checked:a.model}})};a.$watch("variant",c),a.$watch("model",c),a.$watch("disabled",c),c(),"ontouchstart"in window&&(a.touch=!0,Touche(b[0].querySelector("label")).swipe({options:{preventDefault:!0},end:function(b,c){a.readOnly||(("right"===c.swipe.direction&&a.model||"left"===c.swipe.direction&&!a.model)&&(a.model=!a.model,a.$apply()),Touche.preventGestures(this.gestureHandler))}}).tap({end:function(){a.readOnly||(a.model=!a.model,a.$apply(),Touche.preventGestures(this.gestureHandler))}}))}}})},function(a,b){a.exports='<div lui-class-list="classList">\n\t<label class="lui-switch__label" >\n\t\t<input type="checkbox" ng-model="model" class="lui-switch__checkbox" ng-disabled="disabled || touch">\n\t\t<span class="lui-switch__wrap">\n\t\t\t<span class="lui-switch__inner"></span>\n\t\t\t<span class="lui-switch__switch" ></span>\n\t\t</span>\n\t</label>\n</div>\n'},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},f=c(1),g=d(f),h=c(4),i=c(20),j=d(i),k=c(21),l=d(k),m=g.default.module("leonardo-ui.dialog",[]),n={opening:0,open:1,closing:2,closed:3},o={template:j.default,scope:{removeOverlay:"=",variant:"=",input:"=",controller:"=",template:"=",openedDeferred:"=",closedDeferred:"=",closingDeferred:"="},controller:["$scope","$timeout",function(a,b){var c=n.opening,d=void 0,e=void 0,f=void 0,g=void 0;a.fade=!0,a.exposedApi.close=a.close=function(f){c!==n.closing&&c!==n.closed&&(c=n.closing,a.closingDeferred.resolve(),a.fade=!0,e=b(function(){d=f,a.removeOverlay()},200))},f=b(function(){a.fade=!1,g=b(function(){c===n.opening?(a.openedDeferred.resolve(),c=n.open):a.openedDeferred.reject()},200)}),a.$on("$destroy",function(){c=n.closed,a.closedDeferred.resolve(d),b.cancel(e),b.cancel(f),b.cancel(g)})}]};m.service("luiDialog",["$q","luiOverlay",function(a,b){return{show:function(c){if("object"!==(void 0===c?"undefined":e(c)))throw new Error("options must be an object");var d=void 0===c.closeOnEscape||c.closeOnEscape,f=a.defer(),g=a.defer(),h=a.defer();return{close:b.show(o,{controller:c.controller||function(){},template:c.template,input:c.input,variant:c.variant,closeOnEscape:d,openedDeferred:f,closedDeferred:g,closingDeferred:h}).close,opened:f.promise,closed:g.promise,closing:h.promise}}}}]),m.directive("luiDialogTrigger",["luiDialog",function(a){return{link:function(b,c,d){c.on("click",function(){var e={template:b.$eval(d.template),controller:b.$eval(d.controller),closeOnEscape:d.closeOnEscape};d.variant&&(e.variant=d.variant);var f=a.show(e);f.closed.then(function(){c[0].focus()}),b.close=f.close})}}}]),m.directive("luiDialog",function(){return{restrict:"E",replace:!0,transclude:!0,template:l.default,scope:"=",link:function(a){var b=function(){a.classList=(0,h.bemClassList)("lui-dialog",{variant:a.variant,states:{fade:a.fade}})};a.$watch("variant",b),a.$watch("fade",b)}}}),m.directive("luiDialogBody",function(){return{restrict:"E",replace:!0,transclude:!0,scope:"=",template:'<div class="lui-dialog__body" ng-transclude></div>'}}),m.directive("luiDialogHeader",function(){return{restrict:"E",replace:!0,transclude:!0,scope:"=",template:'<div class="lui-dialog__header" ng-transclude></div>'}}),m.directive("luiDialogTitle",function(){return{restrict:"E",replace:!0,transclude:!0,scope:"=",template:'<div class="lui-dialog__title" ng-transclude></div>'}}),m.directive("luiDialogFooter",function(){return{restrict:"E",replace:!0,transclude:!0,scope:"=",template:'<div class="lui-dialog__footer" ng-transclude></div>'}})},function(a,b){a.exports='<div class="lui-dialog-container" role="dialog" tabindex="-1" qva-focus="true"\n\t lui-component x-template="template" x-controller="controller" x-input="input" x-close="close" x-variant="variant">\n\t<div class="lui-modal-background" ng-class="{ \'lui-fade\': fade }" ></div>\n\t<lui-transclude></lui-transclude>\n</div>\n'},function(a,b){a.exports='<div lui-class-list="classList" ng-transclude></div>\n'},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},f=c(1),g=d(f),h=c(4),i=c(23),j=c(24),k=d(j),l=c(25),m=d(l),n={opening:0,open:1,closing:2,closed:3},o=g.default.module("leonardo-ui.popover",[]),p={template:k.default,scope:{variant:"=",removeOverlay:"=",dock:"=",alignTo:"=",x:"=",y:"=",positionFn:"=",openedDeferred:"=",closedDeferred:"=",closingDeferred:"=",id:"=",template:"=",controller:"=",input:"=",closeOnOutside:"=",autoFocus:"=",showArrow:"=",outsideIgnore:"="},controller:["$scope","$element","$timeout",function(a,b,c){var d=n.opening,e=void 0,f=void 0,g=void 0,h=void 0;a.fade=!0,a.style={position:"absolute",top:"-99999px",left:"-99999px"},a.arrow={style:{},direction:null},a.exposedApi.close=a.close=function(b,g){d!==n.closing&&d!==n.closed&&(d=n.closing,a.closingDeferred.resolve(g),a.fade=!0,f=c(function(){e=b,a.removeOverlay()},100))},a.onOutside=function(b){a.closeOnOutside&&(b.stopPropagation(),b.preventDefault(),a.close(null,b))},g=c(function(){var e=b[0].querySelector(".lui-popover-container"),f=void 0;f=a.positionFn?a.positionFn(e,{offset:10,minWindowOffset:10,minEdgeOffset:10}):void 0!==a.alignTo?(0,i.positionToElement)(e,a.alignTo,a.dock,{offset:10,minWindowOffset:10,minEdgeOffset:10}):(0,i.positionToCoordinate)(e,a.x,a.y,a.dock,{offset:10,minWindowOffset:10,minEdgeOffset:10});var g=(0,i.oppositeDock)(f.dock);a.arrow.direction=g,a.style.top=f.position.top+"px",a.style.left=f.position.left+"px",a.style.marginRight="10px",a.style.marginBottom="10px","top"===g||"bottom"===g?a.arrow.style.left=f.toPosition.left-f.position.left+"px":a.arrow.style.top=f.toPosition.top-f.position.top+"px",a.fade=!1,h=c(function(){d===n.opening?(a.openedDeferred.resolve(),d=n.open):a.openedDeferred.reject()},100)}),a.alignTo&&a.alignTo.setAttribute("aria-describedby",a.id),a.$on("$destroy",function(){a.alignTo&&a.alignTo.removeAttribute("aria-describedby"),d=n.closed,a.closedDeferred.resolve(e),c.cancel(f),c.cancel(g),c.cancel(h)})}]};o.service("luiPopover",["$q","luiOverlay",function(a,b){var c=function(){var a=0;return function(){return"lui-popover-"+a++}}();return{show:function(d){if("object"!==(void 0===d?"undefined":e(d)))throw new Error("options must be an object");if(!(d.alignTo&&d.alignTo instanceof HTMLElement))throw new Error("Invalid type for parameter: options.alignTo");var f=a.defer(),g=a.defer(),h=a.defer();return{close:b.show(p,{controller:d.controller||function(){},template:d.template,alignTo:d.alignTo,dock:d.dock,variant:d.variant,input:d.input,closeOnEscape:void 0===d.closeOnEscape||d.closeOnEscape,closeOnResize:void 0!==d.closeOnResize&&d.closeOnResize,closeOnOutside:void 0===d.closeOnOutside||d.closeOnOutside,autoFocus:void 0===d.autoFocus||d.autoFocus,showArrow:void 0===d.showArrow||d.showArrow,outsideIgnore:d.outsideIgnore,openedDeferred:f,closedDeferred:g,closingDeferred:h,id:c()}).close,opened:f.promise,closed:g.promise,closing:h.promise}},showToPosition:function(d){if("object"!==(void 0===d?"undefined":e(d)))throw new Error("options must be an object");if("number"!=typeof d.x)throw new Error("options.x must be a number");if("number"!=typeof d.y)throw new Error("options.y must be a number");var f=a.defer(),g=a.defer(),h=a.defer();return{close:b.show(p,{controller:d.controller||function(){},template:d.template,x:d.x,y:d.y,dock:d.dock,variant:d.variant,input:d.input,closeOnEscape:void 0===d.closeOnEscape||d.closeOnEscape,closeOnResize:void 0!==d.closeOnResize&&d.closeOnResize,closeOnOutside:void 0===d.closeOnOutside||d.closeOnOutside,autoFocus:void 0===d.autoFocus||d.autoFocus,showArrow:void 0===d.showArrow||d.showArrow,outsideIgnore:d.outsideIgnore,openedDeferred:f,closedDeferred:g,closingDeferred:h,id:c()}).close,opened:f.promise,closed:g.promise,closingDeferred:h.promise}},showCustom:function(d){if("object"!==(void 0===d?"undefined":e(d)))throw new Error("options must be an object");if("function"!=typeof d.position)throw new Error("options.position must be a function");var f=a.defer(),g=a.defer(),h=a.defer();return{close:b.show(p,{controller:d.controller||function(){},template:d.template,positionFn:d.position,variant:d.variant,input:d.input,closeOnEscape:void 0===d.closeOnEscape||d.closeOnEscape,closeOnResize:void 0!==d.closeOnResize&&d.closeOnResize,closeOnOutside:void 0===d.closeOnOutside||d.closeOnOutside,autoFocus:void 0===d.autoFocus||d.autoFocus,showArrow:void 0===d.showArrow||d.showArrow,outsideIgnore:d.outsideIgnore,openedDeferred:f,closedDeferred:g,closingDeferred:h,id:c()}).close,opened:f.promise,closed:g.promise,closingDeferred:h.promise}}}}]),o.directive("luiPopoverTrigger",["luiPopover",function(a){return{link:function(b,c,d){c.on("click",function(){var e={template:b.$eval(d.template),controller:b.$eval(d.controller),alignTo:c[0],dock:d.dock};d.variant&&(e.variant=d.variant);var f=a.show(e);f.closed.then(function(){c[0].focus()}),b.close=f.close})}}}]),o.directive("luiPopover",function(){return{restrict:"E",replace:!0,transclude:!0,template:m.default,scope:"=",link:function(a){var b=function(){a.classList=(0,h.bemClassList)("lui-popover",{variant:a.variant,states:{fade:a.fade}})};a.$watch("variant",b),a.$watch("fade",b),b()}}}),o.directive("luiPopoverBody",function(){return{restrict:"E",replace:!0,transclude:!0,scope:"=",template:'<div class="lui-popover__body" ng-transclude></div>'}}),o.directive("luiPopoverHeader",function(){return{restrict:"E",replace:!0,transclude:!0,scope:"=",template:'<div class="lui-popover__header" ng-transclude></div>'}}),o.directive("luiPopoverTitle",function(){return{restrict:"E",replace:!0,transclude:!0,scope:"=",template:'<div class="lui-popover__title" ng-transclude></div>'}}),o.directive("luiPopoverFooter",function(){return{restrict:"E",replace:!0,transclude:!0,scope:"=",template:'<div class="lui-popover__footer" ng-transclude></div>'}})},function(a,b){"use strict";function c(a){var b=[a];return b="top"===a?b.concat(["bottom","right","left"]):"right"===a?b.concat(["bottom","left","top"]):"left"===a?b.concat(["bottom","right","top"]):b.concat(["top","right","left"])}function d(a){return m[a]}function e(a,b,c,d){return a=void 0!==a?a:0,b=void 0!==b?b:0,c=void 0!==c?c:0,d=void 0!==d?d:0,{top:a,right:b+c,bottom:a+d,left:b,width:c,height:d}}function f(a,b){var c=void 0,d=void 0;return"top"===b?(c=a.top,d=a.left+a.width/2):"right"===b?(c=a.top+a.height/2,d=a.right):"left"===b?(c=a.top+a.height/2,d=a.left):(c=a.bottom,d=a.left+a.width/2),{top:c,left:d}}function g(a,b){return{left:a.left>=b.left,right:a.right<=b.right,top:a.top>=b.top,bottom:a.bottom<=b.bottom}}function h(a,b,c,d){var f=void 0,g=void 0;return"top"===c?(f=b.top-a.height-d,g=b.left-a.width/2):"right"===c?(f=b.top-a.height/2,g=b.left+d):"left"===c?(f=b.top-a.height/2,g=b.left-a.width-d):(f=b.top+d,g=b.left-a.width/2),e(f,g,a.width,a.height)}function i(a,b,c,d,i){i=i||{};var j=void 0!==i.offset?i.offset:0,k=void 0!==i.minWindowOffset?i.minWindowOffset:0,l=void 0!==i.minEdgeOffset?i.minEdgeOffset:0,m=e(c.top+k,c.left+k,c.width-2*k,c.height-2*k),n=f(b,d),o=h(a,n,d,j),p=g(o,m);return"top"===d||"bottom"===d?(p.left||(o.left=Math.min(m.left,n.left-l),o.right=o.left+o.width,p=g(o,m)),p.right||(o.right=Math.max(m.right,n.left+l),o.left=o.right-o.width,p=g(o,m))):(p.top||(o.top=Math.min(m.top,n.top-l),o.bottom=o.top+o.height,p=g(o,m)),p.bottom||(o.bottom=Math.max(m.bottom,n.top+k),o.top=o.bottom-o.height,p=g(o,m))),{fits:p.top&&p.right&&p.bottom&&p.left,dock:d,position:{left:o.left,top:o.top},toPosition:f(b,d)}}function j(a,b,d,f){f=f||{};for(var g=a.getBoundingClientRect(),h=document.body.scrollTop,j=document.body.scrollLeft,k=e(-h,-j,document.body.scrollWidth,document.body.scrollHeight),l=c(d||"bottom"),m=null,n=0;n<l.length;n++){var o=i(g,b,k,l[n],f);if(o.position.top+=h,o.toPosition.top+=h,o.position.left+=j,o.toPosition.left+=j,o.fits)return o;0===n&&(m=o)}return m}function k(a,b,c,d){return j(a,b.getBoundingClientRect(),c||"bottom",d||{})}function l(a,b,c,d,e){return j(a,{top:c,bottom:c,left:b,right:b,width:0,height:0},d||"bottom",e||{})}Object.defineProperty(b,"__esModule",{value:!0}),b.getDockOrder=c,b.oppositeDock=d,b.createRect=e,b.getDockCenterPoint=f,b.tryPosition=g,b.createTryRect=h,b.tryDock=i,b.positionToElement=k,b.positionToCoordinate=l;var m={top:"bottom",right:"left",bottom:"top",left:"right"}},function(a,b){a.exports='<div id="{{id}}" class="lui-popover-container" tabindex="-1" qva-focus="autoFocus" ng-style="style"\n\t lui-component x-template="template" x-controller="controller" x-input="input" x-close="close" x-variant="variant" x-arrow="arrow" qva-outside="onOutside($event)" qva-outside-ignore-for="{{outsideIgnore}}"></div>\n'},function(a,b){a.exports='<div lui-class-list="classList">\n\t<ng-transclude></ng-transclude>\n\t<div class="lui-popover__arrow" ng-if="showArrow" ng-style="arrow.style" ng-class="\'lui-popover__arrow--\'+arrow.direction"></div>\n</div>\n'},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},f=c(1),g=d(f),h=c(4),i=c(27),j=c(23),k=c(28),l=d(k),m=c(29),n=d(m),o={opening:0,open:1,closing:2,closed:3},p=g.default.module("leonardo-ui.tooltip",[]),q={template:l.default,scope:{removeOverlay:"=",dock:"=",alignTo:"=",x:"=",y:"=",positionFn:"=",closeOnClick:"=",id:"=",input:"=",openedDeferred:"=",closedDeferred:"=",closingDeferred:"=",template:"=",controller:"="},controller:["$scope","$element","$timeout",function(a,b,c){var d=o.opening,e=void 0,f=void 0;a.fade=!0,a.style={position:"absolute",top:"-99999px",left:"-99999px"},a.arrow={style:{},direction:null},a.exposedApi.close=a.close=function(){d!==o.closing&&d!==o.closed&&(d=o.closing,a.closingDeferred.resolve(),a.fade=!0,e=c(function(){a.removeOverlay()},50))};var h=c(function(){var e=g.default.element(b[0].querySelector(".lui-tooltip-container")),h=e[0],i=void 0;i=a.positionFn?a.positionFn(h,{offset:10,minWindowOffset:10,minEdgeOffset:10}):void 0!==a.alignTo?(0,j.positionToElement)(h,a.alignTo,a.dock,{offset:10,minWindowOffset:10,minEdgeOffset:10}):(0,j.positionToCoordinate)(h,a.x,a.y,a.dock,{offset:10,minWindowOffset:10,minEdgeOffset:10});var k=(0,j.oppositeDock)(i.dock);a.arrow.direction=k,a.style.top=i.position.top+"px",a.style.left=i.position.left+"px",a.style.marginRight="10px",a.style.marginBottom="10px","top"===k||"bottom"===k?a.arrow.style.left=i.toPosition.left-i.position.left+"px":a.arrow.style.top=i.toPosition.top-i.position.top+"px",a.fade=!1,a.closeOnClick&&e.on("click",a.close),a.alignTo&&a.alignTo.setAttribute("aria-describedby",a.id),f=c(function(){d===o.opening?(a.openedDeferred.resolve(),d=o.open):a.openedDeferred.reject()},50)});a.$on("$destroy",function(){a.alignTo&&a.alignTo.removeAttribute("aria-describedby"),d=o.closed,a.closedDeferred.resolve(void 0),c.cancel(e),c.cancel(h),c.cancel(f)})}]};p.service("luiTooltip",["$q","luiOverlay",function(a,b){var c=function(){var a=0;return function(){return"lui-tooltip-"+a++}}();return{show:function(d){if("object"!==(void 0===d?"undefined":e(d)))throw new Error("options must be an object");if(!(d.alignTo&&d.alignTo instanceof HTMLElement))throw new Error("Invalid type for parameter: options.alignTo");var f=a.defer(),g=a.defer(),h=a.defer();return{close:b.show(q,{controller:d.controller||function(){},template:d.template,input:d.input,openedDeferred:f,closedDeferred:g,closingDeferred:h,alignTo:d.alignTo,dock:d.dock,closeOnClick:d.closeOnClick,id:c()}).close,opened:f.promise,closed:g.promise,closing:h.promise}},showToPosition:function(d){if("object"!==(void 0===d?"undefined":e(d)))throw new Error("options must be an object");if("number"!=typeof d.x)throw new Error("options.x must be a number");if("number"!=typeof d.y)throw new Error("options.y must be a number");var f=a.defer(),g=a.defer();return{close:b.show(q,{controller:d.controller||function(){},template:d.template,input:d.input,openedDeferred:f,closedDeferred:g,x:d.x,y:d.y,dock:d.dock,closeOnClick:d.closeOnClick,id:c()}).close,opened:f.promise,closed:g.promise}},showCustom:function(d){if("object"!==(void 0===d?"undefined":e(d)))throw new Error("options must be an object");if("function"!=typeof d.position)throw new Error("options.position must be a function");var f=a.defer(),g=a.defer();return{close:b.show(q,{controller:d.controller||function(){},template:d.template,input:d.input,openedDeferred:f,closedDeferred:g,positionFn:d.position,closeOnClick:d.closeOnClick,id:c()}).close,opened:f.promise,closed:g.promise}}}}]),p.directive("luiTitleTooltip",["$sce","luiTooltip",function(a,b){return{scope:!1,link:function(c,d,e){var f=null,g=null;(0,i.treatAsDesktop)()&&(d.on("mouseover",function(){if(e.title){g=e.title;var c={template:"<lui-tooltip x-arrow='arrow' x-close='close'>"+a.getTrustedHtml(g)+"</lui-tooltip>",controller:[function(){}],alignTo:d[0],closeOnClick:!0,dock:e.dock};e.$set("title",""),f=b.show(c)}}),d.on("mouseout",function(){f&&(f.close(),f=null),null!==g&&(e.$set("title",g),g=null)}))}}}]),p.directive("luiTooltipTrigger",["luiTooltip",function(a){return{scope:!1,link:function(b,c,d){var e=null;c.on("mouseover",function(){var f={template:b.$eval(d.template),controller:b.$eval(d.controller),alignTo:c[0],closeOnClick:!0,dock:d.dock};e=a.show(f)}),c.on("mouseout",function(){e&&(e.close(),e=null)})}}}]),p.directive("luiTooltip",function(){return{restrict:"E",replace:!0,transclude:!0,template:n.default,scope:"=",link:function(a){var b=function(){a.classList=(0,h.bemClassList)("lui-tooltip",{states:{fade:a.fade}})};a.$watch("fade",b)}}})},function(a,b){"use strict";function c(){var a=window.MSPointerEvent||window.PointerEvent;return!(!a||0!==window.navigator.msMaxTouchPoints&&0!==window.navigator.maxTouchPoints)||(!a||!(window.navigator.msMaxTouchPoints>0||window.navigator.maxTouchPoints>0))&&!("ontouchstart"in window)}Object.defineProperty(b,"__esModule",{value:!0}),b.treatAsDesktop=c},function(a,b){a.exports='<div class="lui-tooltip-container" ng-class="{ \'lui-fade\': fade }" ng-style="style">\n\t<div role="tooltip" id="{{id}}" lui-component x-template="template" x-controller="controller" x-input="input" x-close="close" x-arrow="arrow"></div>\n</div>\n'},function(a,b){a.exports='<div lui-class-list="classList">\n\t<div class="lui-tooltip__content" ng-transclude></div>\n\t<div class="lui-tooltip__arrow" ng-show="arrow" ng-style="arrow.style" ng-class="\'lui-tooltip__arrow--\'+arrow.direction"></div>\n</div>\n'},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}var e=c(1),f=d(e),g=c(31),h=d(g),i=c(27),j=c(4),k=f.default.module("leonardo-ui.toast",[]),l={template:h.default,scope:{input:"="},controller:["$scope","$element","$timeout",function(a,b,c){var d=void 0;(0,i.treatAsDesktop)()&&(b.on("mouseenter",function(){a.input.pause()}),b.on("mouseleave",function(){a.input.resume(2e3)})),a.toastAction=function(){a.input.action(),a.input.close()},a.classList=(0,j.bemClassList)("lui-toast",{}),d=c(function(){b[0].getElementsByClassName("lui-toast")[0].focus()},500),a.$on("$destroy",function(){c.cancel(d)})}]};k.service("luiToast",["luiOverlay","toastService",function(a,b){function c(b){var c=a.show(l,{input:b});return d.close=c.close,{close:c.close}}var d={};return d.show=function(a){return b.add(a,c)},d}]),k.service("toastAnimationService",["$timeout",function(a){return{fadeOut:function(a){var b=document.getElementById(a.id);b&&(b.classList.add("lui-toast-hide-animation"),b.classList.remove("lui-toast-show-animation"))},showAnimation:function(b){a(function(){var c=document.getElementById(b);c&&(c.classList.add("lui-toast-prepare-animation"),a(function(){c.classList.add("lui-toast-show-animation"),c.classList.remove("lui-toast-prepare-animation")},250))})}}}]),
k.service("toastService",["$interval","$timeout","toastAnimationService",function(a,b,c){function d(){return m===Number.MAX_VALUE&&(m=1),m++}function e(a,b,c){a&&o[0]&&o[0].remove(e,b||2e3,c),o.length>0&&(l||o[0].show(e))}function f(a){o[0]&&o[0].id===a.id&&(o[0].onClose.close(),o.splice(0,1),l=!1)}function g(a,d){c.fadeOut(a),b(function(){f(a),d()},500)}function h(){k=!0}function i(a){k&&(k=!1,e(!0,a,1))}function j(){i(10)}var k=!1,l=!1,m=0,n=void 0,o=[],p={};return p.add=function(f,m){f.id=d();var p={id:f.id,message:f.message,action:f.action,actionMessage:f.actionMessage,show:function(a){p.onClose=m(o[0]),b(function(){c.showAnimation(o[0].id),l=!0}).then(this.remove(a))},remove:function(b,c,d){n=a(function(){k||o.length>1&&(a.cancel(n),n=null)},c||1e3,d||6),n.then(function(){n=null,k||g(f,b)}).catch(function(){g(f,b)})},pause:h,resume:i,close:j};return o.push(p),e(),function(){if(o[0]===p)p.pause(),p.close();else for(var a=1,b=o.length;a<b;a++)if(o[a]===p){o.splice(a,1);break}}},p}])},function(a,b){a.exports='<div class="lui-toast-service" lui-class-list="classList" id="{{::input.id}}" tabindex="-1">\n\t<div class="lui-toast__text">\n\t\t<span>{{::input.message}}</span>\n\t</div>\n\t<div ng-if="::input.action"\n\t\t role="button"\n\t\t ng-click="toastAction()"\n\t\t qv-enter="toastAction()"\n\t\t class="lui-toast__aside"\n\t\t tabindex="0">\n\t\t<span>{{::input.actionMessage}}</span>\n\t</div>\n</div>\n\n'},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}var e=c(1),f=d(e),g=c(33),h=d(g),i=c(34),j=d(i),k=c(35),l=d(k),m=c(36),n=d(m),o=c(4),p=f.default.module("leonardo-ui.tabview",[]);p.directive("luiTabView",function(){return{restrict:"E",transclude:!0,scope:{},controller:["$scope",function(a){a.activeTab="",a.contents=[],a.classList=["lui-tabview"],this.registerContent=function(b){a.contents.push(b),b.activeTab=a.activeTab},this.unregisterContent=function(b){Array.prototype.forEach.call(a.contents,function(c,d){b===c&&a.contents.splice(d,1)})},this.activateTab=function(b){a.activeTab=b,Array.prototype.forEach.call(a.contents,function(a){a.activeTab=b})}}],template:h.default,replace:!0}}),p.directive("luiTabset",function(){return{require:"^luiTabView",restrict:"E",transclude:!0,scope:{fill:"=?",activeTab:"=?"},link:{pre:function(a,b,c,d){a.activateTab=function(a){d.activateTab(a)};var e=function(){a.classList=(0,o.bemClassList)("lui-tabset",{modifiers:{fill:a.fill}})};a.$watch("fill",e)}},controller:["$scope",function(a){a.tabs=[],a.$watch("activeTab",function(b){b&&Array.prototype.forEach.call(a.tabs,function(c){c.ref===b&&a.select(c)})}),this.select=a.select=function(b){b.selected||(Array.prototype.forEach.call(a.tabs,function(a){a.selected&&a.onTabDeselected&&a.onTabDeselected(),a.selected=!1}),b.selected=!0,b.onTabSelected&&b.onTabSelected(),a.activeTab=b.ref,a.activateTab(b.ref))},this.registerTab=function(b){a.tabs.push(b),1!==a.tabs.length||a.activeTab?b.ref===a.activeTab&&a.select(b):a.activeTab=b.ref},this.unregisterTab=function(b){Array.prototype.forEach.call(a.tabs,function(c,d){b===c&&(a.tabs.splice(d,1),b.selected&&a.tabs.length>0&&(0!==d?a.select(a.tabs[d-1]):a.select(a.tabs[d])))})}}],template:l.default,replace:!0}}),p.directive("luiTab",function(){return{require:"^luiTabset",restrict:"E",transclude:!0,scope:{disabled:"=?",variant:"@?",ref:"@?",onTabAdded:"&?",onTabRemoved:"&?",onTabSelected:"&?",onTabDeselected:"&?"},link:function(a,b,c,d){a.onTabAdded&&a.onTabAdded(),d.registerTab(a),a.select=function(){d.select(a)},a.$on("$destroy",function(){a.onTabRemoved&&a.onTabRemoved(),d.unregisterTab(a)});var e=function(){a.classList=(0,o.bemClassList)("lui-tab",{variant:a.variant,states:{disabled:a.disabled,active:a.selected||a.active}})};a.$watch("variant",e),a.$watch("disabled",e),a.$watch("selected",e),a.$watch("active",e)},controller:["$scope",function(a){a.active=!1,a.onMouseDown=function(){a.active=!0},a.onMouseLeave=function(){a.active=!1}}],template:j.default,replace:!0}}),p.directive("luiTabAside",function(){return{require:"^luiTab",restrict:"E",transclude:!0,scope:{icon:"@?",onActivated:"&?"},controller:["$scope",function(a){a.asideSelected=function(b){b.stopPropagation(),a.onActivated&&a.onActivated()}}],link:function(a){var b=function(){a.classList=(0,o.bemClassList)("lui-icon",{variant:a.icon}),a.classList.push("lui-tab__aside")};a.$watch("icon",b)},template:n.default,replace:!0}}),p.directive("luiTabContent",function(){return{require:"^luiTabView",restrict:"E",transclude:!0,scope:{ref:"@?"},link:function(a,b,c,d){d.registerContent(a),a.$on("$destroy",function(){d.unregisterContent(a)})},template:'<div ng-show="activeTab === ref" ng-transclude></div>',replace:!0}})},function(a,b){a.exports='<div lui-class-list="classList" ng-transclude></div>\n'},function(a,b){a.exports='<div lui-class-list="classList" ng-mousedown="onMouseDown()" ng-mouseleave="onMouseLeave()" ng-click="select( this );" ng-transclude></div>\n\n'},function(a,b){a.exports='<div lui-class-list="classList" ng-transclude ></div>\n\n'},function(a,b){a.exports='<span lui-class-list="classList" ng-mousedown="$event.stopPropagation()"  ng-click="asideSelected( $event )" ng-transclude></span>\n'}])}),define("text!general.components/mobile-menu/mobile-menu.html",[],function(){return'<div id="{{id}}" class="qv-mobile-menu-container" ng-class="{ \'fade\': fade }" tabindex="-1" qva-focus="true"\n\t\t lui-component mm-content-inside-click x-template="template" x-controller="controller" x-close="close" x-variant="variant" x-input="input" qva-outside="onOutside($event)" qva-activate="onInside($event)"></div>\n'}),define("general.components/mobile-menu/mobile-menu",["angular","text!./mobile-menu.html"],function(a,b){"use strict";var c=a.module("qv.mobile-menu",["leonardo-ui.overlay"]),d={opening:0,open:1,closing:2,closed:3},e={template:b,scope:{variant:"=",removeOverlay:"=",openedDeferred:"=",closedDeferred:"=",id:"=",template:"=",controller:"=",input:"="},controller:["$scope","$element","$timeout",function(a,b,c){function e(a){a.stopPropagation(),a.preventDefault()}var f,g,h,i,j=d.opening;a.fade=!1,a.exposedApi.close=a.close=function(b){j!==d.closing&&j!==d.closed&&(j=d.closing,a.fade=!1,g=c(function(){f=b,a.removeOverlay()},100))},a.onOutside=function(b){e(b),a.close()},a.onInside=function(b){b.target.hasAttribute("mm-content-inside-click")&&(e(b),a.close())},h=c(function(){a.fade=!0,i=c(function(){j===d.opening?(a.openedDeferred.resolve(),j=d.open):a.openedDeferred.reject()},100)}),a.$on("$destroy",function(){j=d.closed,a.closedDeferred.resolve(f),c.cancel(g),c.cancel(h),c.cancel(i)})}]};c.service("qvMobileMenu",["$q","luiOverlay",function(a,b){var c=0,d={};return d.show=function(d){if("object"!=typeof d)throw new Error("options must be an object");var f="mobile-menu-"+c++,g=void 0===d.closeOnEscape||d.closeOnEscape,h=a.defer(),i=a.defer();return{close:b.show(e,{controller:d.controller||function(){},template:d.template,variant:d.variant,input:d.input,closeOnEscape:g,openedDeferred:h,closedDeferred:i,id:f}).close,opened:h.promise,closed:i.promise}},d}])}),define("text!general.components/alert-dialog/alert-dialog.html",[],function(){return'<lui-dialog x-variant="{{::variant}}" class="qv-alert-dialog">\n\t<lui-dialog-header ng-if="input.title">\n\t\t<lui-dialog-title>{{input.title}}</lui-dialog-title>\n\t</lui-dialog-header>\n\t<lui-dialog-body>\n\t\t{{input.message}}\n\t</lui-dialog-body>\n\t<lui-dialog-footer>\n\t\t<lui-button x-variant="{{::variant}}" ng-click="close(true);">{{::closeLabel}}</lui-button>\n\t</lui-dialog-footer>\n</lui-dialog>\n'}),define("general.components/alert-dialog/alert-dialog",["angular","translator","text!./alert-dialog.html"],function(a,b,c){a.module("qv.alert-dialog",["leonardo-ui.dialog"]).service("qvAlertDialog",["$q","luiDialog",function(a,d){var e={};return e.show=function(a){if("object"!=typeof a)throw new Error("options must be an object");return d.show({controller:["$scope",function(a){a.closeLabel=a.input.closeLabel||b.get("Common.Close")}],template:c,input:{message:a.message,title:a.title,closeLabel:a.closeLabel},variant:a.variant,closeOnEscape:a.closeOnEscape})},e}])}),define("text!general.components/confirm-dialog/confirm-dialog.html",[],function(){return'<lui-dialog x-variant="{{::variant}}" class="qv-confirm-dialog">\n\t<lui-dialog-header ng-if="input.title">\n\t\t<lui-dialog-title>{{input.title}}</lui-dialog-title>\n\t</lui-dialog-header>\n\t<lui-dialog-body>\n\t\t{{input.message}}\n\t</lui-dialog-body>\n\t<lui-dialog-footer>\n\t\t<lui-button x-variant="{{::variant}}" ng-click="close(false);">{{::cancelLabel}}</lui-button>\n\t\t<lui-button x-variant="{{::variant}}" ng-click="close(true);">{{::okLabel}}</lui-button>\n\t</lui-dialog-footer>\n</lui-dialog>\n'}),define("general.components/confirm-dialog/confirm-dialog",["angular","translator","text!./confirm-dialog.html"],function(a,b,c){a.module("qv.confirm-dialog",["leonardo-ui.dialog"]).service("qvConfirmDialog",["$q","luiDialog",function(a,d){var e={};return e.show=function(a){if("object"!=typeof a)throw new Error("options must be an object");return d.show({controller:["$scope",function(a){a.okLabel=a.input.okLabel||b.get("Common.OK"),a.cancelLabel=a.input.cancelLabel||b.get("Common.Cancel")}],template:c,input:{message:a.message,title:a.title,okLabel:a.okLabel,cancelLabel:a.cancelLabel},variant:a.variant,closeOnEscape:a.closeOnEscape})},e}])}),define("general.utils/shapes/geometry-math",[],function(){"use strict";var a;return a={checkPointsCoincident:function(a,b){return a.x===b.x&&a.y===b.y},checkPointOnLineSegment2:function(b,c,d){var e,f,g,h;return e=d.x-c.x,f=d.y-c.y,0===e?0===f?a.checkPointsCoincident(b,c):b.x===c.x&&((g=(b.y-c.y)/f)>=0&&g<=1):0===f?b.y===c.y&&((g=(b.x-c.x)/e)>=0&&g<=1):(g=(b.x-c.x)/e,h=(b.y-c.y)/f,g>=0&&g<=1&&Math.abs(g-h)<1e-12)},checkPointOnLineSegment:function(b,c){return a.checkPointOnLineSegment2(b,c[0],c[1])},checkLineSegmentIntersectingLineSegment2:function(b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r;if(f=c.x-b.x,g=c.y-b.y,h=e.x-d.x,i=e.y-d.y,j=b.x-d.x,k=b.y-d.y,n=i*f-h*g,l=h*k-i*j,m=f*k-g*j,0===n){if(0===l&&0===m){if(0===f){if(0===g)return a.checkPointOnLineSegment2(b,d,e);q=(d.y-b.y)/g,r=(e.y-b.y)/g}else q=(d.x-b.x)/f,r=(e.x-b.x)/f;return!(q<0&&r<0||q>1&&r>1)}return!1}return o=l/n,p=m/n,o>=0&&o<=1&&p>=0&&p<=1},checkLineSegmentIntersectingLineSegment:function(b,c){return a.checkLineSegmentIntersectingLineSegment2(b[0],b[1],c[0],c[1])},checkPointInsideRectDefinedByMaxMin:function(a,b){return a.x>b.minX&&a.x<b.maxX&&a.y>b.minY&&a.y<b.maxY},checkPointInsideOrOnBoundaryOfRectDefinedByMaxMin:function(a,b){return a.x>=b.minX&&a.x<=b.maxX&&a.y>=b.minY&&a.y<=b.maxY},checkLineSegmentIntersectingRectDefinedByMaxMin:function(b,c){return!(!a.checkPointInsideOrOnBoundaryOfRectDefinedByMaxMin(b[0],c)&&!a.checkPointInsideOrOnBoundaryOfRectDefinedByMaxMin(b[0],c))||(!!a.checkLineSegmentIntersectingLineSegment(b,[{x:c.minX,y:c.minY},{x:c.minX,y:c.maxY}])||(!!a.checkLineSegmentIntersectingLineSegment(b,[{x:c.maxX,y:c.minY},{x:c.maxX,y:c.maxY}])||(!!a.checkLineSegmentIntersectingLineSegment(b,[{x:c.minX,y:c.minY},{x:c.maxX,y:c.minY}])||!!a.checkLineSegmentIntersectingLineSegment(b,[{x:c.minX,y:c.maxY},{x:c.maxX,y:c.maxY}]))))},checkPolylineIntersectingRectDefinedByMaxMin:function(b,c){var d,e,f,g=0,h=1,i=1,j=b?b.length:0;if(0===j)return!1;var k=function(){return f<j};if(b[0].x>b[j-1].x&&(g=j-1,h=j-2,i=-1,k=function(){return f>-1}),e=b[g],e.x>c.maxX)return!1;if(e.x>=c.minX&&e.y>=c.minY&&e.y<=c.maxY)return!0;for(d=e,f=h;k();f+=i){if(e=b[f],e.x>=c.minX&&e.x<=c.maxX&&e.y>=c.minY&&e.y<=c.maxY)return!0;if(Math.min(d.x,e.x)>c.maxX)return!1;if(Math.max(d.x,e.x)<c.minX)d=e;else if(Math.min(d.y,e.y)>c.maxY)d=e;else if(Math.max(d.y,e.y)<c.minY)d=e;else{if(a.checkLineSegmentIntersectingRectDefinedByMaxMin([d,e],c))return!0;d=e}}return!1},checkPolylinesIntersectingRectDefinedByMaxMin:function(b,c){var d,e=b?b.length:0;for(d=0;d<e;d++)if(a.checkPolylineIntersectingRectDefinedByMaxMin(b[d],c))return!0;return!1},calculateBounds:function(a){var b,c,d,e,f,g=Number.MAX_VALUE,h=-Number.MAX_VALUE,i=Number.MAX_VALUE,j=-Number.MAX_VALUE,k=a?a.length:0;if(0===k)return null;for(d=0;d<k;d++)b=a[d],(c=b?b.calculateBounds():void 0)&&c.x!==1/0&&(e=c.getRight(),f=c.getBottom(),e>h&&(h=e),c.x<g&&(g=c.x),f>j&&(j=f),c.y<i&&(i=c.y));return{x:g,y:i,width:h-g,height:j-i}}}}),define("general.utils/shapes/line",["./geometry-math"],function(a){"use strict";function b(a,b,c,d){0===arguments.length?this.set(0,0,0,0):2===arguments.length?this.set(a.x,a.y,b.x,b.y):this.set(a,b,c,d)}return b.prototype={toString:function(){return this.x1+" "+this.y1+" "+this.x2+" "+this.y2},clone:function(){return new b(this.x1,this.y1,this.x2,this.y2)},set:function(a,b,c,d){this.x1=a,this.y1=b,this.x2=c,this.y2=d},intersectsLine:function(b){return a.checkLineSegmentIntersectingLineSegment(this.getPoints(),b.getPoints())},intersectsRect:function(a){return this.intersectsLine(new b(a.x,a.y,a.x+a.width,a.y))||this.intersectsLine(new b(a.x+a.width,a.y,a.x+a.width,a.y+a.height))||this.intersectsLine(new b(a.x,a.y+a.height,a.x+a.width,a.y+a.height))||this.intersectsLine(new b(a.x,a.y,a.x,a.y+a.height))},getPoints:function(){var a=[];return a.push({x:this.x1,y:this.y1}),a.push({x:this.x2,y:this.y2}),a}},b}),define("general.utils/shapes/rect",["./line"],function(a){"use strict";function b(a,b,c,d){0===arguments.length?this.set(0,0,0,0):this.set(a,b,c,d)}return b.prototype={toString:function(){return this.x+" "+this.y+" "+this.width+" "+this.height},clone:function(){return new b(this.x,this.y,this.width,this.height)},set:function(a,b,c,d){c>=0?(this.x=a,this.width=c):(this.x=a+c,this.width=-c),d>=0?(this.y=b,this.height=d):(this.y=b+d,this.height=-d)},setLTRB:function(a,b,c,d){a<=c?(this.x=a,this.width=c-a):(this.x=c,this.width=a-c),b<=d?(this.y=b,this.height=d-b):(this.y=d,this.height=b-d)},equal:function(a){return a&&this.x===a.x&&this.y===a.y&&this.width===a.width&&this.height===a.height},combineWith:function(a){var c,d,e,f,g=Math.max(a.getRight(),this.getRight()),h=Math.max(a.getBottom(),this.getBottom());return c=Math.min(a.x,this.x),d=Math.min(a.y,this.y),e=Math.max(0,g-c),f=Math.max(0,h-d),new b(c,d,e,f)},intersectsWith:function(a){return!!a&&(this.x<=a.getRight()&&a.x<=this.getRight()&&this.y<=a.getBottom()&&a.y<=this.getBottom())},intersectsRect:function(a){return this.intersectsWith(a)},intersection:function(a,c){var d,e,f,g;return this.intersectsWith(a)?(d=Math.max(this.x,a.x),e=Math.max(this.y,a.y),f=Math.min(this.getRight(),a.getRight()),g=Math.min(this.getBottom(),a.getBottom()),new b(d,e,f-d,g-e)):c?null:new b(this.x,this.y,this.width,this.height)},union:function(a){var c,d,e,f;return c=Math.min(this.x,a.x),d=Math.min(this.y,a.y),e=Math.max(this.getRight(),a.getRight()),f=Math.max(this.getBottom(),a.getBottom()),new b(c,d,e-c,f-d)},pointInside:function(a,b){return a>=this.x&&a<=this.getRight()&&b>=this.y&&b<=this.getBottom()},rectInside:function(a){var b,c=a.getPoints();for(b=0;b<4;b++)if(!this.pointInside(c[b].x,c[b].y))return!1;return!0},intersectsLine:function(b){var c=this.getRight(),d=this.getBottom();return!(!this.pointInside(b.x1,b.y1)&&!this.pointInside(b.x2,b.y2))||!!(b.intersectsLine(new a(this.x,this.y,c,this.y))||b.intersectsLine(new a(c,this.y,c,d))||b.intersectsLine(new a(c,d,this.x,d))||b.intersectsLine(new a(this.x,d,this.x,this.y)))},getPoints:function(){var a=[];return a.push({x:this.x,y:this.y}),a.push({x:this.getRight(),y:this.y}),a.push({x:this.getRight(),y:this.getBottom()}),a.push({x:this.x,y:this.getBottom()}),a},getRight:function(){return this.x+this.width},getBottom:function(){return this.y+this.height},getCenterPoint:function(){return{x:this.x+this.width/2,y:this.y+this.height/2}},getBoundingRect:function(){return this},scale:function(a){var b=a-1,c=b*this.width/2,d=b*this.height/2;this.x-=c,this.y-=d,this.width*=a,this.height*=a},hasNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.width)||isNaN(this.height)}},b}),define("general.utils/window-positioner",["jquery","general.utils/shapes/rect"],function(a,b){"use strict";function c(c,d){var e,f,g=a("body").outerHeight();return e=d.y+d.height/2-c.height/2,e=e<0?0:e,g-e-c.height<0&&(e=g-c.height),f=d.x+d.width,new b(f,e,c.width,c.height)}function d(c,d){var e,f,g=a("body").outerWidth();return f=d.x+d.width/2-c.width/2,f=f<0?0:f,g-f-c.width<0&&(f=g-c.width),e=d.y+d.height,new b(f,e,c.width,c.height)}function e(c,d){var e,f,g=a("body").outerHeight();return e=d.y+d.height/2-c.height/2,e=e<0?0:e,g-e-c.height<0&&(e=g-c.height),f=d.x-c.width,new b(f,e,c.width,c.height)}function f(c,d){var e,f,g=a("body").outerWidth();return f=d.x+d.width/2-c.width/2,f=f<0?0:f,g-f-c.width<0&&(f=g-c.width),e=d.y-c.height,new b(f,e,c.width,c.height)}function g(a){var c,d=window.scrollX?window.scrollX:document.documentElement.scrollLeft?document.documentElement.scrollLeft:0,e=window.scrollY?window.scrollY:document.documentElement.scrollTop?document.documentElement.scrollTop:0;if(a[0]===window)c=new b(d,e,a.outerWidth(),a.outerHeight());else{var f=a[0].getBoundingClientRect();c=new b(f.left+d,f.top+e,f.width,f.height)}return c}function h(a,b,g){var h;return h={top:f,right:c,bottom:d,left:e}[g]||c,h.call({},a,b)}function i(a){var b="bottom,bottomLeft,bottomRight,centerLeft,center,centerRight,topLeft,top,topRight,topLeft,left,right".split(",");if(b.indexOf(a)===-1)throw new Error("Not a valid docking position. Try "+b.join(" ,")+".")}function j(a,b,c){return"right"===a?b.getRight()-c.getRight():"left"===a?c.x-b.x:"top"===a?c.y-b.y:"bottom"===a?b.getBottom()-c.getBottom():0}function k(a){return{top:"bottom",right:"left",bottom:"top",left:"right"}[a]}function l(a){return"flip"===a||"flipfit"===a}function m(a){return"fit"===a||"flipfit"===a}function n(a){return{top:"vertical",right:"horizontal",bottom:"vertical",left:"horizontal"}[a]}function o(a){return{vertical:["top","bottom"],horizontal:["left","right"]}[a]}function p(a){return{horizontal:"vertical",vertical:"horizontal"}[a]}function q(a){var b=a.collision.split(" "),c={horizontal:b[0],vertical:b[1]||b[0]},d=n(a.position),e=p(d);return{flipPrimary:l(c[d]),fitPrimary:m(c[d]),fitSecondary:m(c[e])}}function r(a,b,c){var d,e;for(d=0;d<b.length;d++){if("left"===(e=b[d])&&a.x<c.x){a.x=c.x;break}if("right"===e&&a.getRight()>c.getRight()){a.x=c.getRight()-a.width;break}if("top"===e&&a.y<c.y){a.y=c.y;break}if("bottom"===e&&a.getBottom()>c.getBottom()){a.y=c.getBottom()-a.height;break}}return a}function s(a,b,c,d,e,f){if(!c)return a.map(function(a,c){var d=b[c]||b[0];return{align:a,x:d.x,y:d.y}});var g=b[0].x,h=b[0].y,i=function(a){var b,c,f,i,j=a?a.length/2:0,k=new Array(j);for(b=0;b<j;b++)c=a[2*b+1],f=c*g+(1-c)*d,i=c*h+(1-c)*e,k[b]={align:a[2*b],x:f,y:i};return k},j=a[0]+(a[1]?"-"+a[1]:""),k=f>.5?0:.5-f,l=f>.5?.5:.7-.4*f;switch(j){case"top":return i(g>=d?["top",1,"top",.7,"top",.5,"right",.7,"right",.5,"left",.5,"left",.7,"bottom",k,"bottom",l]:["top",1,"top",.7,"top",.5,"left",.7,"left",.5,"right",.5,"right",.7,"bottom",k,"bottom",l]);case"top-right":return i(["top",1,"top",.7,"top",.5,"right",.7,"right",.5,"left",.5,"left",.7,"bottom",k,"bottom",l]);case"top-left":return i(["top",1,"top",.7,"top",.5,"left",.7,"left",.5,"right",.5,"right",.7,"bottom",k,"bottom",l]);case"bottom":return i(g>=d?["bottom",1,"bottom",.7,"bottom",.5,"right",.7,"right",.5,"left",.5,"left",.7,"top",k,"top",l]:["bottom",1,"bottom",.7,"bottom",.5,"left",.7,"left",.5,"right",.5,"right",.7,"top",k,"top",l]);case"bottom-right":return i(["bottom",1,"bottom",.7,"bottom",.5,"right",.7,"right",.5,"left",.5,"left",.7,"top",k,"top",l]);case"bottom-left":return i(["bottom",1,"bottom",.7,"bottom",.5,"left",.7,"left",.5,"right",.5,"right",.7,"top",k,"top",l]);case"left":return i(h<=e?["left",1,"left",.7,"left",.5,"top",.7,"top",.5,"bottom",.5,"bottom",.7,"right",.5,"right",.7]:["left",1,"left",.7,"left",.5,"bottom",.7,"bottom",.5,"top",.5,"top",.7,"right",.5,"right",.7]);case"left-top":return i(["left",1,"left",.7,"left",.5,"top",.7,"top",.5,"bottom",.5,"bottom",.7,"right",.5,"right",.7]);case"left-bottom":return i(["left",1,"left",.7,"left",.5,"bottom",.7,"bottom",.5,"top",.5,"top",.7,"right",.5,"right",.7]);case"right":return i(h<=e?["right",1,"right",.7,"right",.5,"top",.7,"top",.5,"bottom",.5,"bottom",.7,"left",.5,"left",.7]:["right",1,"right",.7,"right",.5,"bottom",.7,"bottom",.5,"top",.5,"top",.7,"left",.5,"left",.7]);case"right-top":return i(["right",1,"right",.7,"right",.5,"top",.7,"top",.5,"bottom",.5,"bottom",.7,"left",.5,"left",.7]);case"right-bottom":return i(["right",1,"right",.7,"right",.5,"bottom",.7,"bottom",.5,"top",.5,"top",.7,"left",.5,"left",.7])}}var t={align:function(b,c,d){if(d=d||{position:"right",collision:"none"},d.position=d.position||"right",d.collision=d.collision||"none",b&&c){var e,f=g(a(window)),i=g(b),l=g(c),m=q(d),s=h(i,l,d.position);e=function(a){var b=h(i,l,k(d.position)),c=j(d.position,a,f);return j(k(d.position),b,f)<c},m.flipPrimary&&j(d.position,s,f)>0&&e(s)&&(s=h(i,l,k(d.position)),d.position=k(d.position)),m.fitPrimary&&(s=r(s,[d.position],f)),m.fitSecondary&&(s=r(s,o(p(n(d.position))),f)),d.limits&&s.y<d.limits.top&&(s.y=d.limits.top),b.offset({top:s.y,left:s.x})}return d.position},alignToCoordinate:function(b,c,d,e,f){i(e);var g,h;e=e||"top",g=function(a,c,d){var e=c,f=d;switch(a){case"topRight":f=d-b.outerHeight();break;case"top":e=c-b.outerWidth()/2,f=d-b.outerHeight();break;case"topLeft":e=c-b.outerWidth(),f=d-b.outerHeight();break;case"right":case"centerRight":f=d-b.outerHeight()/2;break;case"center":e=c-b.outerWidth()/2,f=d-b.outerHeight()/2;break;case"left":case"centerLeft":e=c-b.outerWidth(),f=d-b.outerHeight()/2;break;case"bottom":e=c-b.outerWidth()/2;break;case"bottomLeft":e=c-b.outerWidth();break;case"bottomRight":e=c,f=d}return{x:e,y:f}},h=g(e,c,d);var j,k,l,m,n={},o={};j=a(window),k=10,o.x=j.outerWidth()-b.outerWidth()-k,n.x=k,o.y=j.outerHeight()-b.outerHeight()-k,n.y=k;var p=function(a,b){return b[a]>o[a]?b[a]-o[a]:b[a]<n[a]?n[a]-b[a]:0};if(f){l=p("x",h),m=p("y",h);var q=g(f,c,d);(l>p("x",q)||m>p("y",q))&&(h=q,e=f)}return h.x=Math.max(n.x,Math.min(o.x,h.x)),h.y=Math.max(n.y,Math.min(o.y,h.y)),b.offset({left:h.x,top:h.y}),e},alignToBestCoordinate:function(b,c,d,e,f,h,j){var k=a(window),l=g(k);i(d[0]),c=c instanceof Array?c:[c];var m=c[0].x-l.x,n=c[0].y-l.y;b.offset({left:0,top:0}),b.width("auto"),b.height("auto");var o=k.outerWidth(),p=k.outerHeight(),q=b.outerWidth(),r=b.outerHeight(),t={},u={};j=void 0===j?5:j;var v=(void 0===h?5:h)+j;u.x=o-q-v,t.x=v,u.y=p-r-v,t.y=v,o<q+2*v&&(q=o-2*v,b.width(q),u.x=t.x),p<r+2*v&&(r=p-2*v,b.height(r),u.y=t.y),d=d||["top"];var w,x,y,z,A,B,C,D,E,F,G,H=function(a,b,c){var d=b,e=c;switch(a){case"topRight":e=c-r;break;case"top":d=b-q/2,e=c-r;break;case"topLeft":d=b-q,e=c-r;break;case"right":case"centerRight":e=c-r/2;break;case"center":d=b-q/2,e=c-r/2;break;case"left":case"centerLeft":d=b-q,e=c-r/2;break;case"bottom":d=b-q/2;break;case"bottomLeft":d=b-q;break;case"bottomRight":d=b,e=c}return{x:d,y:e}},I=function(a,b){return b[a]>u[a]?b[a]-u[a]:b[a]<t[a]?b[a]-t[a]:0},J=m,K=n;f&&(z=e.shape.cx+e.targetToPageTranslation.x-l.x,A=e.shape.cy+e.targetToPageTranslation.y-l.y,B=e.shape.innerRadius,C=e.shape.radius,D=0,B>0&&(D=B/C,z+=D*(m-z),A+=D*(n-A))),G=s(d,c,f,z,A,D);return function(){for(w=0;w<G.length;w++)if(x=G[w].align,J=G[w].x-l.x,K=G[w].y-l.y,y=H(x,J,K),E=I("x",y),F=I("y",y),0===E&&0===F||(0!==F||"top"!==x&&"bottom"!==x?0!==E||"left"!==x&&"right"!==x||(y.y-=F,F=0):(y.x-=E,E=0)),0===E&&0===F)return;0===E&&0===F||(x=G[0].align,J=G[0].x-l.x,K=G[0].y-l.y,y=H(x,J,K),E=I("x",y),F=I("y",y),y.x-=E,y.y-=F)}(),y&&b.offset({left:y.x+l.x,top:y.y+l.y}),{position:x,x:J+l.x,y:K+l.y}}};return t.getScrolledRect=g,t}),define("pubsub",[],function(){function a(){this.topics={},this.wildcards=[]}return a.prototype.getTopics=function(a,b){var c=this.topics[a];return void 0===c&&b&&(c=this.topics[a]=[]),c},a.prototype.createMatcher=function(a){return a=a.replace(/\$/g,"\\$"),new RegExp("^"+a.replace(/\*/g,".+?")+"$","i")},a.prototype.subscribe=function(a,b,c){if(a=a.toLowerCase().split("."),"function"!=typeof b)throw"pubsub: Invalid handler";var d={handler:b,topic:a[0],namespace:a[1],context:c||window};a[0].indexOf("*")>-1?(d.matcher=this.createMatcher(a[0]),this.wildcards.push(d)):this.getTopics(a[0],!0).push(d)},a.prototype.subscribeOnce=function(a,b,c){function d(){b.apply(this,arguments),e.unsubscribe(a,b)}var e=this;d.original=b,this.subscribe(a,d,c)},a.prototype.unsubscribe=function(a,b){a=a.toLowerCase(),this["."===a[0]?"unsubscribeNamespace":"unsubscribeTopic"](a,b)},a.prototype.unsubscribeNamespace=function(a){function b(b){return b.namespace!==a}a=a.substr(1);var c;this.wildcards=this.wildcards.filter(b);for(c in this.topics)this.topics[c]=this.topics[c].filter(b),this.topics[c].length||delete this.topics[c]},a.prototype.unsubscribeTopic=function(a,b){function c(c){var d=c.topic!==a[0];return!d&&b&&(d=c.handler.original?c.handler.original!==b:c.handler!==b),d}a=a.split(".");var d=this.getTopics(a[0]);this.wildcards=this.wildcards.filter(c),d&&(d=this.topics[a[0]]=d.filter(c),d.length||delete this.topics[a[0]])},a.prototype.publish=function(a,b){function c(c){(!c.matcher||c.matcher&&c.matcher.test(a[0]))&&c.handler.call(c.context,b,a[0])}a=a.toLowerCase().split(".");var d=this.getTopics(a[0]);this.wildcards.forEach(c),d&&d.forEach(c)},window.pubsub=new a,window.pubsub}),define("general.utils/android-keyboard-fix",[],function(){"use strict";function a(a,b,c){this.lastHeight=null,this.document=c||document,this.window=b||window,this.viewport=a||this.document.querySelector("meta[name=viewport]"),this.viewportContent=this.viewport.getAttribute("content"),this.updateHeight()}return a.prototype.clearHeight=function(){this.viewport.setAttribute("content",this.viewportContent)},a.prototype.setHeight=function(a){this.viewport.setAttribute("content",this.viewportContent+", height="+a)},a.prototype.updateHeight=function(){var a=this.window.innerHeight;return this.lastHeight!==a&&(this.lastHeight=a,this.setHeight(a),!0)},a.prototype.rotate=function(a){var b=function(){this.updateHeight()&&a()}.bind(this);this.document.activeElement&&this.document.activeElement.blur(),this.clearHeight(),this.window.setTimeout(b,500),this.window.setTimeout(b,1e3),this.window.setTimeout(b,1500)},a.isNeeded=function(){return navigator.userAgent.toLowerCase().indexOf("android")>-1},a}),define("core.utils/resize",["touche","pubsub","general.utils/android-keyboard-fix"],function(a,b,c){function d(a){k=!0,f("/resize/start",a)}function e(a){f("/resize/end",a),k=!1}function f(a,c){b.publish(a,{width:window.innerWidth,height:window.innerHeight,element:c.target})}function g(a){a.target!==window&&a.target!==document||(k||d(a),clearTimeout(i),f("/resize/update",a),i=setTimeout(function(){e(a)},j))}function h(a){l?l.rotate(function(){d(a),e(a)}):(d(a),e(a))}var i,j=250,k=!1,l=c.isNeeded()?new c:null;return a.utils.touch&&"ondeviceorientation"in window&&window.addEventListener("orientationchange",h,!1),l||window.addEventListener("resize",g,!1),{on:function(a,c){b.subscribe("/resize/"+a,c)},off:function(a,c){b.unsubscribe("/resize/"+a,c)},force:function(a){a=a||"end",b.publish("/resize/"+a)}}}),define("text!general.components/context-menu/context-menu.ng.html",[],function(){return'<div class="qv-contextmenu" tid="context-menu" qva-outside="close($event)">\n\t<lui-popover>\n\t\t<ul class="lui-list">\n\t\t\t<li ng-if="levels.length" class="lui-list__item lui-list__action back-item" qva-activate="goBack();" tcl="context-menu-item">\n\t\t\t\t<i class="lui-list__aside back-icon lui-icon  lui-icon--triangle-left"></i>\n\t\t\t\t<span class="lui-list__text" q-translation="{{options.goBackTitle}}" tid="context-menu-back"></span>\n\t\t\t</li>\n\t\t\t<li ng-repeat="item in currentItems"\n\t\t\t\tclass="lui-list__item lui-list__action"\n\t\t\t\tng-class="{ \'lui-disabled\': item.disabled, \'qv-contextmenu-has-submenu\': item.hasSubmenu(), \'has-icon\': item.hasIcon() }"\n\t\t\t\tqva-activate="item.disabled || selectItem($event,item)"\n\t\t\t\ttcl="context-menu-item">\n\n\t\t\t\t<i class="lui-list__aside item-icon {{item.icon}}" ng-if="item.hasIcon()"></i>\n\t\t\t\t<span class="lui-list__text" title="{{item.getLabel()}}" tid="{{item.tid}}">{{item.getLabel()}}<span class="fader"></span></span>\n\t\t\t\t<i ng-show="item.hasSubmenu()" class="next-icon lui-list__aside lui-icon lui-icon--triangle-right"></i>\n\t\t\t</li>\n\t\t</ul>\n\t</lui-popover>\n</div>\n'}),define("general.components/context-menu/context-menu",["jquery","general.utils/window-positioner","core.utils/resize","text!./context-menu.ng.html"],function(a,b,c,d){"use strict";function e(a,b,c,d){switch(b){case"BottomLeft":c-=a.outerWidth();break;case"Bottom":c-=a.outerWidth()/2;break;case"BottomRight":break;case"Left":c-=a.outerWidth(),d-=a.outerHeight()/2;break;case"Center":c-=a.outerWidth()/2,d-=a.outerHeight()/2;break;case"Right":d-=a.outerHeight()/2;break;case"Top":d-=a.outerHeight(),c-=a.outerWidth()/2;break;case"TopRight":default:d-=a.outerHeight()}return{left:c,top:d}}function f(b,c){var d=a(window),e=d.outerWidth()-b.outerWidth()-10,f=Math.max(10,Math.min(e,c.left)),g=d.outerHeight()-b.outerHeight()-10;return{left:f,top:Math.max(10,Math.min(g,c.top))}}function g(a,b,c){var d=e(a,b,c.x,c.y);return d=f(a,d),a.offset(d),d}function h(a,b){return b=f(a,b),a.offset(b),b}function i(a,b){a.$$postDigest(function(){a.$$postDigest(b)})}return{template:d,scope:{menu:"=",options:"="},controller:["$scope","$element","$timeout",function(d,e){function f(a){i(d,function(){d.options.alignTo?b.align(l(),d.options.alignTo,{collision:d.options.collision||"flip",position:d.options.docking||"top"}):(a=a||m,m=a?h(l(),a):g(l(),d.options.docking,d.options.position))})}function j(){if(d.levels.length){var a=d.levels.pop();d.currentItems=a.items,f(a.offset)}}function k(a){var b=a.items;d.levels.push({items:d.currentItems,offset:m}),d.currentItems=b,f()}function l(){return e.children().first()}var m=null;d.levels=[],d.currentItems=d.menu.items,d.options.goBackTitle=d.options.goBackTitle||"Common.Back",d.goBack=function(){j()},d.selectItem=function(a,b){a.stopPropagation(),b.hasSubmenu()?k(b):(b.select(b.args),d.close())},d.close=function(){"function"==typeof d.menu.onClosing&&d.menu.onClosing.call(null),d.$destroy()},c.on("start",d.close),e.find(".content").css("max-height",a(window).outerHeight()-40),f(),"function"==typeof d.menu.onOpen&&d.menu.onOpen.call(null),d.$on("$destroy",function(){c.off("start",d.close),"function"==typeof d.destroyComponent?d.destroyComponent():e.off("*").html("").remove()})}]}}),define("general.components/context-menu/context-menu-item",["translator"],function(a){"use strict";var b=function(a){var b=this;Object.keys(a||{}).forEach(function(c){b[c]=a[c]}),this.items=[]};return b.prototype.addItem=function(a){var c=new b(a);return this.items.push(c),c},b.prototype.hasSubmenu=function(){return this.items.length>0},b.prototype.hasIcon=function(){return!!this.icon},b.prototype.getLabel=function(){function b(b){return Array.isArray(b)?a.get(b[0],b.slice(1).join(",")):a.get(b)}return"function"==typeof this.translation?b(this.translation()):this.translation?b(this.translation):"function"==typeof this.label?this.label():this.label?this.label:"Missing translation/label"},b}),define("general.components/context-menu/context-menu-service",["angular","general.components/context-menu/context-menu","general.components/context-menu/context-menu-item"],function(a,b,c){"use strict";a.module("qv.context-menu",["leonardo-ui.overlay"]).service("qvContextMenu",["$q","luiOverlay",function(a,d){var e,f={};return f.show=function(a,c){if(f.close(),0!==a.items.length){var g=c.component||b;return e=d.show(g,{menu:a,options:c})}},f.close=function(){e&&(e.close(),e=null)},f.menu=function(){var a=new c,b={addItem:function(b){return a.addItem(b)}};return Object.defineProperty(b,"items",{get:function(){return a.items}}),b},f
}])}),function(a,b){"use strict";function c(a){return Array.prototype.slice.apply(a)}function d(a){return function(b){var c=i[a];c&&(g("Media query triggered for alias",a),c.forEach(function(a){a(b.matches)}))}}function e(a){var b=matchMedia(k[a]),c=j[a]=d(a);c.mql=b,g("Binding",a),b.addListener(c)}function f(a){var b=j[a];b&&(g("Unbinding",a),b.mql.removeListener(b)),delete i[a],delete j[a]}function g(){if(h){var a=c(arguments);a.unshift("[mqa.js]"),console.log.apply(console,a)}}var h=!1,i={},j={},k={},l=location.origin||location.protocol+"//"+location.hostname+(location.port?":"+location.port:""),m={};m.add=function(a,b){g("Creating alias",a,"with query",b),k[a]=b},m.remove=function(a){g("Removing alias",a);var b=k.hasOwnProperty(a);return b&&(f(a),delete k[a]),b},m.parse=function(){g("Parsing CSS rules"),c(b.styleSheets).forEach(function(a){var b=a.href&&0!==a.href.indexOf("/")&&0!==a.href.indexOf(l);try{if(b||null===a.cssRules)return}catch(a){return}c(a.cssRules).forEach(function(a){if(a&&a instanceof CSSMediaRule){var b=/#-mqa-alias-(\w+)\s*?\{/.exec(a.cssText);b&&m.add(b[1],a.media.mediaText)}})})},m.on=function(a,b){var c=i[a];c||(c=[],e(a)),c.push(b),i[a]=c,g("Added new listener on",a,b)},m.off=function(a,b){var c=i[a];if(c){var d=c.indexOf(b);c.splice(d,1),c.length||f(a)}g("Removed listener from",a,b)},m.match=function(a){var b=k[a],c=!1;return b&&(c=matchMedia(b).matches),c},Object.defineProperty(m,"queries",{get:function(){return JSON.parse(JSON.stringify(k))}}),m.parse(),"function"==typeof define&&define.amd?define("mqa",m):a.mqa=m}(window,document),define("core.utils/notification",[],function(){"use strict";var a,b,c=!1;return a=function(a,b){if(c!==!0)throw new Error("This class can't be instantiated directly.");this.observers=[],this.receiver=a,Object.defineProperty(this,"name",{get:function(){return b}})},a.prototype.bind=function(b){if("function"!=typeof b)throw new Error("Observer must be a function.");if(b===a.prototype.emit)throw new Error("Observer cannot be proxied this way. Use a wrapper function.");this.observers.push(b)},a.prototype.once=function(a){function b(){c.unbind(b),a.apply(c.receiver,arguments)}var c=this;b.onceObserver=a,c.bind(b)},a.prototype.unbind=function(a){var b;(b=this.observers.reduce(function(b,c,d){return b!==-1?b:c===a||c.onceObserver===a?d:-1},-1))!==-1&&this.observers.splice(b,1)},a.prototype.emit=function(){var a=this.receiver,b=Array.prototype.slice.call(arguments);this.observers.slice().forEach(function(c){c.apply(a,b)})},a.prototype.release=function(){var a=this.receiver;delete a[this.name],Object.keys(b.prototype).forEach(function(b){delete a[b]}),this.receiver=null,this.observers=null},a.create=function(b,d){if(!b)throw new Error("Not a valid receiver.");if("string"!=typeof d)throw new Error("Nofification name not optional.");if(!/^([A-Z][a-z]+)+$/.test(d))throw new Error("The notification name must be PascalCased.");if(d in b)throw new Error("A property named '"+d+"' is already present on the receiver.");return c=!0,b[d]=new a(b,d),c=!1,b[d]},a.mixin=function(a){if(!a)throw new Error("Not a valid receiver.");Object.keys(b.prototype).forEach(function(c){if(c in a)throw new Error("A property named '"+c+"' is already present on the receiver.");a[c]=b.prototype[c]})},a.release=function(b){Object.keys(b).forEach(function(c){var d=b[c];d instanceof a&&d.release()})},b={prototype:{notification:function(b){return a.create(this,b)}}},a}),define("general.utils/responsive-state",["mqa","core.utils/notification"],function(a,b){"use strict";var c,d,e={};return e.Orientation={portrait:"portrait",landscape:"landscape"},b.mixin(e),e.notification("ViewChanged"),e.notification("OrientationChanged"),c=a.match("smalldevice"),d=a.match("portrait")?e.Orientation.portrait:e.Orientation.landscape,a.on("smalldevice",function(a){c=a,e.ViewChanged.emit(c)}),void 0===window.orientation?a.on("portrait",function(a){d=a?e.Orientation.portrait:e.Orientation.landscape,e.OrientationChanged.emit(d)}):window.onorientationchange=function(){d=e.Orientation.landscape,0!==window.orientation&&180!==window.orientation||(d=e.Orientation.portrait),e.OrientationChanged.emit(d),c&&d===e.Orientation.landscape&&window.scrollTo&&window.scrollTo(0,0)},Object.defineProperties(e,{isSmallDevice:{get:function(){return c}},orientation:{get:function(){return d}}}),document.body.scrollTop=document.documentElement.scrollTop=0,e}),function(a,b){if("object"==typeof exports&&"object"==typeof module)module.exports=b(require("jquery"),require("angular"),require("general.utils/responsive-state"),require("mqa"),require("general.utils/string-normalization"),require("general.utils/support"));else if("function"==typeof define&&define.amd)define("assets/es2015/client-core.bundle",["jquery","angular","general.utils/responsive-state","mqa","general.utils/string-normalization","general.utils/support"],b);else{var c="object"==typeof exports?b(require("jquery"),require("angular"),require("general.utils/responsive-state"),require("mqa"),require("general.utils/string-normalization"),require("general.utils/support")):b(a.jquery,a.angular,a["general.utils/responsive-state"],a.mqa,a["general.utils/string-normalization"],a["general.utils/support"]);for(var d in c)("object"==typeof exports?exports:a)[d]=c[d]}}(this,function(a,b,c,d,e,f){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="../resources/",b(0)}([function(a,b,c){a.exports=c(5)},,,,,function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.getProductInfo=b.getLicenses=void 0;var d=c(6);Object.defineProperty(b,"getLicenses",{enumerable:!0,get:function(){return d.getLicenses}}),Object.defineProperty(b,"getProductInfo",{enumerable:!0,get:function(){return d.getProductInfo}});var e=c(8),f=function(a){return a&&a.__esModule?a:{default:a}}(e);c(9),c(19),c(30),c(14),c(29),c(11);var g=f.default.module("qv-general",["qv-general.about-dialog","qv-general.factories","qv-general.directives"]).name;b.default=g},function(a,b,c){"use strict";function d(a){return h.default.ajax({method:"GET",url:"../resources/autogenerated/"+a+".json?_="+i,cache:!0,dataType:"json"})}function e(){return d("product-info")}function f(){return d("licenses")}var g=c(7),h=function(a){return a&&a.__esModule?a:{default:a}}(g),i=+new Date;a.exports=f,a.exports=e,a.exports={getLicenses:f,getProductInfo:e}},function(b,c){b.exports=a},function(a,c){a.exports=b},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){var c=void 0,d=void 0;return b.all([(0,n.getLicenses)(),(0,n.getProductInfo)()]).then(function(b){return c=b[0],d=b[1],{licenses:c.sort(function(b,c){var d=a.string(b.name).toLocaleUpperCase(),e=a.string(c.name).toLocaleUpperCase();return d.localeCompare(e)}),productInfo:d}})}var f=c(8),g=d(f),h=c(10),i=d(h),j=c(11),k=d(j),l=c(12),m=d(l),n=c(6);c(13),c(15);var o={},p={close:"Common.Close",about:"Common.About",copyright:"About.Copyright",thirdPartyIntro:"About.3rdPartySoftwareIntro",thirdParty:"About.3rdPartySoftware",licenseAgreement:"About.LicenceAgreement",downloadPdf:"About.Download.PDF"},q={template:i.default,scope:{},controller:["$scope","qvStringNormalizer","$q",function(a,b,c){var d=void 0,f=void 0,h={"background-image":'url("../resources/img/core/about-circles.png")'},i="../resources/img/core";a.logoUrl=o.logoUrl,a.translations=o.translations||p,o.ula?a.dl=o.ula:a.dl=o.personal?"qlik-sense-eula.pdf":"sense-eula.pdf",a.dl="../resources/autogenerated/"+a.dl,f=a.logoUrl,f||(f=o.personal?i+"/about-logo-personal.png":i+"/about-logo.png"),a.showBackground=m.default.match("aboutDialogShowCircles"),a.circleStyle=a.showBackground?h:{},a.updateBackground=function(b){a.showBackground=b,a.circleStyle=b?h:{}},m.default.on("aboutDialogShowCircles",a.updateBackground),a.mainClasses={},a.info={view:"about"},a.isSmallDevice=k.default.isSmallDevice,a.setLogoStyle={"background-image":'url("'+f+'")'},a.setMainClass=function(){var b={};return b[a.info.view]=!0,b},a.setClass=function(b){return b===a.info.view?"active":""},a.view=function(b){return b===a.info.view},a.scrollToLicense=function(a){void 0!==a?g.default.element.find("#about-dialog .license-entry")[a].scrollIntoView(!0):g.default.element.find("#about-dialog .about_licenses__wrapper")[0].scrollTop=0},e(b,c).then(function(b){a.productInfo=b.productInfo,a.licenses=b.licenses,a.versionText=a.productInfo.composition.productName+" "+a.productInfo.composition.releaseLabel,a.senseId=a.productInfo.composition.senseId,a.qlikWebPageUrl=a.productInfo.externalUrls.qlikWebPageUrl}),d=function(b){a.isSmallDevice=b},k.default.ViewChanged.bind(d),a.$on("$destroy",function(){k.default.ViewChanged.unbind(d),m.default.off("aboutDialogShowCircles",a.updateBackground)})}]};g.default.module("qv-general.about-dialog",[]).factory("$aboutDialog",["luiDialog",function(a){return{show:function(b){return o={personal:b.isPersonal,ula:b.ula,logoUrl:b.logoUrl,translations:b.translations},a.show(q)}}}])},function(a,b){a.exports='\n<lui-dialog qv-id="about-dialog" id="about-dialog">\n\t<div class="lui-dialog__header lui-dialog__header--about"></div>\n\t<div class="lui-dialog__body lui-dialog__body--about" ng-class="setMainClass()">\n\t\t<div class="flex-item about__sidepanel">\n\t\t\t<div ng-if="!isSmallDevice" class="about-s-holder">\n\t\t\t\t<a q-translation="{{translations.about}}" ng-click="info.view=\'about\'" class="about-a-style {{setClass(\'about\')}}"></a>\n\t\t\t\t<a q-translation="{{translations.thirdParty}}" ng-click="info.view=\'licenses\'" class="about-a-style {{setClass(\'licenses\')}}"></a>\n\t\t\t</div>\n\n\t\t\t<lui-select ng-if="isSmallDevice" class="about-select" x-model="info.view">\n\t\t\t\t<option value="about" q-translation="{{translations.about}}"></option>\n\t\t\t\t<option value="licenses" q-translation="{{translations.thirdParty}}"></option>\n\t\t\t</lui-select>\n\t\t</div>\n\t\t<div class="about__content about__column" ng-if="view(\'about\')" ng-style="circleStyle" ng-class="{\'about__circles\': showBackground }">\n\t\t\t<div class="about about__wrapper">\n\t\t\t\t<div class="about__wrapper__main">\n\t\t\t\t\t<div class="about-logo" ng-style="setLogoStyle"></div>\n\t\t\t\t\t<div class="about-divider"></div>\n\t\t\t\t\t<div class="about-product-version" ng-click="isSubVersionsToggled=!isSubVersionsToggled">\n\t\t\t\t\t\t<p class="about-product-name">{{versionText}}<span class="about-product-toggle-icon lui-icon  lui-icon--{{isSubVersionsToggled?\'arrow-down\':\'arrow-right\'}}"></span></p>\n\t\t\t\t\t\t<p class="about-product-id">{{senseId}}</p>\n\t\t\t\t\t\t<div ng-if="isSubVersionsToggled">\n\t\t\t\t\t\t\t<ul class="about-version">\n\t\t\t\t\t\t\t\t<li class="about-version-entry" ng-repeat="info in productInfo.components track by info.component">{{info.component}} {{info.version}}</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="about-header-license">{{ ::(translations.licenseAgreement | translate) }}</div>\n\t\t\t\t\t<a target="_blank" ng-href="{{dl}}" class="lui-button lui-button--download">\n\t\t\t\t\t\t<span>{{ ::(translations.downloadPdf | translate ) }}</span>\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="about__wrapper__footer">\n\t\t\t\t<div class="about-copyright" q-translation="{{translations.copyright}}"></div>\n\t\t\t\t<a class="about-link" target="_blank" ng-href="{{qlikWebPageUrl}}">{{qlikWebPageUrl}}</a>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="about__content" ng-if="view(\'licenses\')">\n\t\t\t<div class="about_licenses__wrapper">\n\t\t\t\t<h2 class="about-h2" ng-if="!isSmallDevice" q-translation="{{translations.thirdParty}}"></h2>\n\n\t\t\t\t<p class="about-p" q-translation="{{translations.thirdPartyIntro}}"></p>\n\t\t\t\t<ul class="about-ul">\n\t\t\t\t\t<li class="license-link" ng-repeat="license in licenses">\n\t\t\t\t\t\t<a class="about-a-style" ng-click="scrollToLicense($index)">{{license.name}}</a>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\n\t\t\t\t<div class="license-entry" ng-repeat="license in licenses">\n\t\t\t\t\t<h3>{{license.name}} <button class="lui-button" ng-click="scrollToLicense()"><i class="lui-button__icon  lui-icon  lui-icon--triangle-top"></i></button></h3>\n\t\t\t\t\t<a ng-href="{{license.url}}" target="_blank">{{license.license}}</a>\n\t\t\t\t\t<div class="license-text"><code class="about__code">{{license.text}}</code></div>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\t\t</div>\n\t\t<!--\n\t\t<div ng-if="view(\'ula\')" ng-include src="ulaTemplate"></div>\n\t-->\n\t</div>\n\t<div class="lui-dialog__footer dm-footer">\n\t\t<lui-button ng-click="close()" q-translation="{{translations.close}}" qva-focus="true"></lui-button>\n\t</div>\n</lui-dialog>\n'},function(a,b){a.exports=c},function(a,b){a.exports=d},function(a,b,c){var d,e;d=[c(8),c(14)],void 0!==(e=function(a,b){a.module("qv-general.factories-string-normalizer",[]).factory("qvStringNormalizer",[function(){return b}])}.apply(b,d))&&(a.exports=e)},function(a,b){a.exports=e},function(a,b){},,,,function(a,b,c){"use strict";var d=c(8),e=function(a){return a&&a.__esModule?a:{default:a}}(d);c(20),c(22),c(28),c(13),e.default.module("qv-general.factories",["qv-general.factories-paths","qv-general.factories-loader","qv-general.factories-supports","qv-general.factories-string-normalizer"])},function(a,b,c){var d,e;d=[c(8),c(21)],void 0!==(e=function(a,b){a.module("qv-general.factories-paths",[]).factory("qvPaths",b)}.apply(b,d))&&(a.exports=e)},function(a,b,c){var d,e;d=[],void 0!==(e=function(){var a,b,c,d;return c={___clearCache:function(){d=null},getCached:function(){return d},setDocument:function(b){a=b},setLocation:function(a){b=a},getLocation:function(){return b||window.location},getDocument:function(){return a||window.document},toAbsoluteUrl:function(a){var b,d,e,f=(a.match(/\.\.\//g)||[]).length,g=a.split("/"),h=c.getBaseURI().split("/");for(b=0;b<=f;b++)h.length>3&&h.pop(),0!==b&&g.shift();return d=h.join("/")+"/",e=g.join("/"),d+e},getBaseURI:function(){var a=c.getCached();if(a)return a;var b=c.getDocument(),e=b.baseURI;if(!e){var f=b.createElement("a");f.href="./",e=f.href}return d=e,e},getServerRootPath:function(){var a,b=c.getBaseURI();return b.length-1===b.lastIndexOf("/")&&(b=b.substring(0,b.lastIndexOf("/"))),a=b.split("/"),a.pop(),a.join("/")},stripBasePath:function(a){var b=c.getLocation();return a.replace(c.getBaseURI(),"").replace(/^\.\.\//i,"/").replace(b.protocol+"//"+b.host,"")}},function(){return c}}.apply(b,d))&&(a.exports=e)},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}var e=c(8),f=d(e),g=c(23),h=d(g);c(24);var i=!1;f.default.module("qv-general.factories-loader",[]).factory("qvLoader",["$compile","$rootScope","$document","$timeout","$q",function(a,b,c,d,e){function g(){o.template=h.default,o.hugeLoader=!0,o.bigLoader=!1,o.mediumLoader=!1,o.normalLoader=!1,o.smallLoader=!1,o.tinyLoader=!1}function j(){for(var a in q)o[a]=null,delete o[a];g(),o.ngClasses["qv-fade-in"]=!1,k&&k.off().remove(),k=null,l=null,m&&(m.remove(),m=null)}var k,l,m,n,o=b.$new(),p=c.find("body"),q={};return g(),m=p.find("#qv-init-ui-blocker"),{show:function(b){i=!0;var c;o.fadeOut=!1,d.cancel(n),q=b||{};for(var e in b)o[e]=b[e];o.ngClasses={"qv-loader-huge":o.hugeLoader,"qv-loader-big":o.bigLoader,"qv-loader-medium":o.mediumLoader,"qv-loader-normal":o.normalLoader,"qv-loader-small":o.smallLoader,"qv-loader-tiny":o.tinyLoader,"qv-fade-in":!1},c=o.appendTo?o.appendTo:p,l=f.default.element(o.template),k=a(l)(o).appendTo(c),o.appendTo=null,delete o.appendTo,n=d(function(){o.ngClasses["qv-fade-in"]=!0}),m&&m.length>0&&m.fadeOut(800,function(){m=null})},setMessageObj:function(a){o.messageObj.task=a},isOpen:function(){return i},close:function(a){var b=e.defer();return d.cancel(n),a?(o.fadeOut=!0,j(),i=!1,b.resolve()):d(function(){o.fadeOut=!0,n=d(function(){return j(),i=!1,b.resolve()},950)},750),b.promise}}}])},function(a,b){a.exports='<div class="rain rain-loader qv-block-ui" ng-class="{\'qv-fade-out\': fadeOut, \'qv-transparent-background\': transparentBackground}" tid="3e1f54">\n\t<div class="qv-animate progress-loader qv-loader-container" ng-class="ngClasses">\n\t\t<div class="one">\n\t\t\t<svg xmlns="http://www.w3.org/2000/svg" version="1.1" x="0px" y="0px" viewBox="0 0 210 210" xml:space="preserve" >\n\t\t\t\t<g>\n\t\t\t\t\t<path class="path"\n\t\t\t\t\t\t  d="M105,205c-26.7,0-51.8-10.4-70.7-29.3C15.4,156.8,5,131.7,5,105s10.4-51.8,29.3-70.7C53.2,15.4,78.3,5,105,5 c55.1,0,100,44.9,100,100S160.1,205,105,205z M105,23.7c-44.8,0-81.3,36.5-81.3,81.3c0,44.8,36.5,81.3,81.3,81.3 c44.8,0,81.3-36.5,81.3-81.3C186.3,60.2,149.8,23.7,105,23.7z"/>\n\t\t\t\t</g>\n\t\t\t</svg>\n\t\t</div>\n\t\t<div class="two">\n\t\t\t<svg xmlns="http://www.w3.org/2000/svg" version="1.1" x="0px" y="0px" viewBox="0 0 210 210" xml:space="preserve" >\n\t\t\t\t<g>\n\t\t\t\t\t<path class="path"\n\t\t\t\t\t\t  d="M105,205C49.9,205,5,160.1,5,105C5,49.9,49.9,5,105,5c55.1,0,100,44.9,100,100C205,160.1,160.1,205,105,205z M105,19.4c-47.2,0-85.6,38.4-85.6,85.6c0,47.2,38.4,85.6,85.6,85.6c47.2,0,85.6-38.4,85.6-85.6C190.6,57.8,152.2,19.4,105,19.4z"/>\n\t\t\t\t</g>\n\t\t\t</svg>\n\t\t</div>\n\t\t<div class="three">\n\t\t\t<svg xmlns="http://www.w3.org/2000/svg" version="1.1" x="0px" y="0px" viewBox="0 0 210 210" xml:space="preserve" >\n\t\t\t\t<g>\n\t\t\t\t\t<path class="path"\n\t\t\t\t\t\t  d="M105,205c-26.7,0-51.8-10.4-70.7-29.3C15.4,156.8,5,131.7,5,105s10.4-51.8,29.3-70.7C53.2,15.4,78.3,5,105,5 c55.1,0,100,44.9,100,100S160.1,205,105,205z"/>\n\t\t\t\t</g>\n\t\t\t</svg>\n\t\t</div>\n\t\t<div class="four">\n\t\t\t<svg xmlns="http://www.w3.org/2000/svg" version="1.1" x="0px" y="0px" viewBox="0 0 210 210" xml:space="preserve" >\n\t\t\t\t<g>\n\t\t\t\t\t<path class="path"\n\t\t\t\t\t\t  d="M105,205C49.9,205,5,160.1,5,105C5,49.9,49.9,5,105,5c55.1,0,100,44.9,100,100C205,160.1,160.1,205,105,205z M105,19.4c-47.2,0-85.6,38.4-85.6,85.6c0,47.2,38.4,85.6,85.6,85.6c47.2,0,85.6-38.4,85.6-85.6C190.6,57.8,152.2,19.4,105,19.4z"/>\n\t\t\t\t</g>\n\t\t\t</svg>\n\t\t</div>\n\t\t<div class="five">\n\t\t\t<svg xmlns="http://www.w3.org/2000/svg" version="1.1" x="0px" y="0px" viewBox="0 0 210 210" xml:space="preserve" >\n\t\t\t\t<g>\n\t\t\t\t\t<path class="path"\n\t\t\t\t\t\t  d="M105 205C49.9 205 5 160.1 5 105C5 49.9 49.9 5 105 5c55.1 0 100 44.9 100 100C205 160.1 160.1 205 105 205z M105 10.5c-52.1 0-94.5 42.4-94.5 94.5c0 52.1 42.4 94.5 94.5 94.5c52.1 0 94.5-42.4 94.5-94.5C199.5 52.9 157.1 10.5 105 10.5z"/>\n\t\t\t\t</g>\n\t\t\t</svg>\n\t\t</div>\n\t\t<div class="six">\n\t\t\t<svg xmlns="http://www.w3.org/2000/svg" version="1.1" x="0px" y="0px" viewBox="0 0 210 210" xml:space="preserve" >\n\t\t\t\t<g>\n\t\t\t\t\t<path class="path"\n\t\t\t\t\t\t  d="M105,205c-26.7,0-51.8-10.4-70.7-29.3C15.4,156.8,5,131.7,5,105s10.4-51.8,29.3-70.7C53.2,15.4,78.3,5,105,5 c55.1,0,100,44.9,100,100S160.1,205,105,205z"/>\n\t\t\t\t</g>\n\t\t\t</svg>\n\t\t</div>\n\t\t<div class="seven">\n\t\t\t<svg xmlns="http://www.w3.org/2000/svg" version="1.1" x="0px" y="0px" viewBox="0 0 210 210" xml:space="preserve" >\n\t\t\t\t<g>\n\t\t\t\t\t<path class="path"\n\t\t\t\t\t\t  d="M105,205C49.9,205,5,160.1,5,105C5,49.9,49.9,5,105,5c55.1,0,100,44.9,100,100C205,160.1,160.1,205,105,205z M105,19.4c-47.2,0-85.6,38.4-85.6,85.6c0,47.2,38.4,85.6,85.6,85.6c47.2,0,85.6-38.4,85.6-85.6C190.6,57.8,152.2,19.4,105,19.4z"/>\n\t\t\t\t</g>\n\t\t\t</svg>\n\t\t</div>\n\t</div>\n\t<div class="qv-loader-text" ng-if="messageObj" ng-class="ngClasses">\n\t\t<div ng-show="messageObj.task" q-translation="{{messageObj.task}}"></div>\n\t\t<div ng-show="messageObj.message" q-translation="{{messageObj.message}}"></div>\n\t</div>\n</div>\n'},function(a,b){},,,,function(a,b,c){var d,e;d=[c(8),c(29)],void 0!==(e=function(a,b){a.module("qv-general.factories-supports",[]).factory("qvSupport",["$document",function(a){return{treatAsDesktop:b.treatAsDesktop,isMouse:b.isMouse,init:function(){a.find("html").addClass("touch-"+(b.treatAsDesktop()?"off":"on"))}}}])}.apply(b,d))&&(a.exports=e)},function(a,b){a.exports=f},function(a,b,c){"use strict";function d(a,b){a.$root.$$phase?"function"==typeof b&&b():a.$apply(b)}Object.defineProperty(b,"__esModule",{value:!0});var e=c(8),f=function(a){return a&&a.__esModule?a:{default:a}}(e),g=f.default.module("qv-general.directives",[]);g.directive("qvaFocus",["$timeout",function(a){return{restrict:"A",link:function(b,c,d){b.$watch(d.qvaFocus,function(b){b===!0&&a(function(){c[0].focus()})},!0)}}}]),g.directive("qvaSelect",["$timeout","qvSupport",function(a,b){return{restrict:"A",link:function(c,d,e){0!==e.qvaSelect.length&&"true"!==e.qvaSelect||b.treatAsDesktop()&&a(function(){d[0].select()},100)}}}]),g.directive("qvaBlur",["$parse",function(a){return function(b,c,e){var f=a(e.qvaBlur);c.bind("blur",function(a){d(b,function(){f(b,{$event:a})})})}}]),b.default=g.name}])}),define("assets/dragoman/dragoman-date",["angular","translator","general.utils/responsive-state","assets/external/dragomanjs/dragoman"],function(a,b,c,d){var e=c.isSmallDevice,f={restrict:"E",replace:!0,scope:{date:"=",dateFormat:"@",timeFormat:"@",dateTimeFormat:"@",skeleton:"@",customLangCode:"@",defaultString:"@"},template:'<span class="qv-moment">{{dateToShow}}</span>',link:function(a){var c=void 0!==a.defaultString?b.get(a.defaultString):"",f={},g=void 0!==a.dateFormat,h=void 0!==a.timeFormat,i=void 0!==a.dateTimeFormat,j=void 0!==a.skeleton;g?f.date=a.dateFormat:h?f.time=a.timeFormat:i?f.datetime=a.dateTimeFormat:j&&(f.skeleton=a.skeleton),g||h||i||j||(f.skeleton=e?"yMd":"yMMMdjm"),a.customLangCode&&(f.locale=a.customLangCode),a.dateToShow="1753-01-01T00:00:00.000Z"===a.date||void 0===a.date?c:d.format.date(a.date,f),a.$watch("date",function(){a.dateToShow="1753-01-01T00:00:00.000Z"===a.date||void 0===a.date?c:d.format.date(a.date,f)})}};return a.module("qv-dragoman-date",[]).directive("drmFormatDate",function(){return f}).filter("drmFormatDateFilter",function(){return d.format.date}),{directive:f}}),define("assets/dragoman/dragoman-angular",["angular","assets/dragoman/dragoman-date"],function(a){a.module("qv-dragoman",["qv-dragoman-date"])}),function(a,b){if("object"==typeof exports&&"object"==typeof module)module.exports=b();else if("function"==typeof define&&define.amd)define("sense-about-dialog",[],b);else{var c=b();for(var d in c)("object"==typeof exports?exports:a)[d]=c[d]}}(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="../resources/",b(0)}([function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(12),e=function(a){return a&&a.__esModule?a:{default:a}}(d);b.default=[e.default]},,,,,,,,,,,,function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(13),h=d(g),i=c(14),j=d(i),k=c(15),l=d(k);c(16),c(20),c(22),c(25),b.default=angular.module("qv-modules.about-dialog",[j.default,l.default]).component("qvAboutDialog",{template:h.default,bindings:{},controllerAs:"AD",controller:function(){function a(b,c){"ngInject";e(this,a),this.factory=b,this.data=b.getOptions(),this.activeView="about",this.doc=c[0]}return a.$inject=["qvAboutFactory","$document"],f(a,[{key:"scrollToLicence",value:function(a){void 0!==a?this.doc.getElementsByClassName("about-dialog-licences-entry")[a].scrollIntoView(!0):this.doc.getElementById("about-dialog-section__licences").scrollTop=0}},{key:"close",value:function(){this.factory.close()}},{key:"get",value:function(a){return this.data[a]}},{key:"getSystemInfo",value:function(a){return this.get("systemInfo")[a]}},{key:"getText",value:function(a){return this.get("text")[a]}},{key:"getIconClass",value:function(){return{"lui-icon--arrow-down":this.showVersion,"lui-icon--arrow-right":!this.showVersion}}},{key:"goTo",value:function(a){this.activeView=a}},{key:"isActive",value:function(a){return{"lui-active":a===this.activeView}}}]),a}()}).name},function(a,b){a.exports='<lui-dialog qv-id=about-dialog id=about-dialog> <div class="lui-dialog__header lui-dialog__header--about"></div> <div class="lui-dialog__body lui-dialog__body--about"> <div class=about-dialog__viewpanel> <ul class="lui-list about-dialog-sections--normal"> <li ng-click="AD.activeView = \'about\'" title="{{ ::AD.getText(\'about\') }}" class="lui-list__item lui-list__item--about-dialog" ng-class="AD.isActive(\'about\')"> <span class="lui-list__text lui-list__text--about-dialog">{{ ::AD.getText(\'about\') }}</span> </li> <li ng-click="AD.activeView = \'thirdParty\'" title="{{ ::AD.getText(\'thirdParty\') }}" class="lui-list__item lui-list__item--about-dialog" ng-class="AD.isActive(\'thirdParty\')"> <span class=lui-list__text>{{ ::AD.getText(\'thirdParty\') }}</span> </li> </ul> <lui-select class="about-dialog-sections about-dialog-sections--small" x-model=AD.activeView> <option value=about>{{ ::AD.getText(\'about\') }}</option> <option value=thirdParty>{{ ::AD.getText(\'thirdParty\') }}</option> </lui-select> </div> <div class=about-dialog__contentpanel ng-switch=AD.activeView> <div ng-switch-when=about id=about-dialog-section__about> <div class=about-dialog-section__header> <div class=about-dialog-section__about-cont> <img class=about-dialog-logo ng-src="{{::AD.get(\'logo\')}}" draggable=false> <div class=about-dialog-divider></div> <div class=about-dialog-product-version ng-click="AD.showVersion=!AD.showVersion"> <p class=about-dialog-product-name> {{::AD.getSystemInfo("productName")}} <span class="about-dialog-product-toggle-icon lui-icon" ng-class=AD.getIconClass()></span> </p> <p class=about-dialog-product-id>{{::AD.getSystemInfo("senseId")}}</p> <div ng-if=AD.showVersion> <ul class=about-dialog-version> <li class=about-dialog-version-entry ng-repeat="info in ::AD.get(\'componentsList\') track by info.component">{{info.component}} {{info.version}}</li> </ul> </div> </div> <div class=about-dialog-header-licence>{{ ::AD.getText(\'licenceAgreement\') }}</div> <a target=_blank ng-href="{{ ::AD.get(\'licenceAgreementLink\') }}" class="lui-button lui-button--download"> <span>{{ ::AD.getText(\'downloadPdf\') }}</span> </a> <div class=about-dialog__space></div> </div> </div> <div class=about-dialog-section__footer> <div class=about-copyright>{{ ::AD.getText(\'copyright\') }}</div> <a class=about-link target=_blank ng-href="{{::AD.get(\'webPageUrl\')}}">{{::AD.get(\'webPageUrl\')}}</a> </div> </div> <div ng-switch-when=thirdParty id=about-dialog-section__licences> <div class=about-dialog-licences__wrapper> <h2 class=about-dialog-licences-h2>{{ ::AD.getText(\'thirdParty\') }}</h2> <p class=about-dialog-licences-p>{{ ::AD.getText(\'thirdPartyIntro\') }}</p> <ul class=about-dialog-licences-ul> <li class=about-dialog-licences__link ng-repeat="licence in ::AD.get(\'thirdPartyList\')" ng-show=::licence.name> <a class=about-dialog-licences__a-style ng-click=AD.scrollToLicence($index)>{{licence.name}} {{licence.version}}</a> </li> </ul> <div class=about-dialog-licences-entry ng-repeat="licence in ::AD.get(\'thirdPartyList\')" ng-show=::licence.name> <h3 class=about-dialog-licences-entry__h3>{{licence.name}} {{licence.version}} <button class="lui-button lui-button__about-dialog-licence" ng-click=AD.scrollToLicence()> <i class="lui-button__icon lui-icon lui-icon--triangle-top"></i> </button> </h3> <a class=about-dialog-licences-entry__a ng-href={{licence.url}} target=_blank>{{licence.licence}}</a> <div class=about-dialog-licences-text><code class=about-dialog-licences__code>{{licence.text}}</code></div> </div> </div> </div> </div> </div> <div class="lui-dialog__footer lui-dialog__footer--about"> <button class=lui-button qv-focus ng-click=AD.close()>{{ ::AD.getText(\'close\') }}</button> </div> </lui-dialog> '},function(a,b){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.default=angular.module("qv-modules.about-dialog-factory",["leonardo-ui"]).factory("qvAboutFactory",["luiDialog","$q","qvAboutRestConnect",function(a,b,c){"ngInject";var d={},e=void 0,f=void 0;return d.getOptions=function(){return f||{}},d.show=function(){var d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e){var g=d.text,h=d.logo;return b.all({thirdPartyList:c.thirdParty(),systemInfo:c.systemInfo(),componentsList:c.components(),licenceAgreementLink:c.licenceAgreementLink(),externalUrls:c.externalUrls()}).then(function(b){var c=b.systemInfo,d=b.componentsList,i=b.thirdPartyList,j=b.licenceAgreementLink,k=b.externalUrls,l=k.qlikWebPageUrl;return f={systemInfo:c,componentsList:d,thirdPartyList:i,licenceAgreementLink:j,webPageUrl:l,text:g,logo:h},e=a.show({template:"<qv-about-dialog></qv-about-dialog>",closeOnEscape:!0}),e.closed.then(function(){e=null}),e})}},d.showSync=function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e)return f=b,e=a.show({template:"<qv-about-dialog></qv-about-dialog>",closeOnEscape:!0}),e.closed.then(function(){e=null}),e},d.close=function(){e&&e.close()},d}]).name},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.default=angular.module("qv-modules.about-dialog-factory__restapi",[]).factory("qvAboutRestConnect",["$http","$q",function(a,b){"ngInject";var c="../",d=function(a){return a.data},e=function(b){return b.headers=b.headers?b.headers:{},b.headers["x-qlik-capabilities"]="about",b.method="GET",b.cache=!0,a(b)};return{components:function(){return e({url:c+"api/about/v1/components"}).then(d)},externalUrls:function(){return e({url:c+"api/about/v1/externalUrls"}).then(d)},systemInfo:function(){return e({url:c+"api/about/v1/systemInfo"}).then(d)},thirdParty:function(){return e({url:c+"api/about/v1/thirdParty"}).then(function(a){return d(a).sort(function(a,b){var c=a&&a.name||"",d=b&&b.name||"";return c.toLocaleUpperCase().localeCompare(d.toLocaleUpperCase())})})},licenceAgreementLink:function(){return c+"api/about/v1/licenses/QlikSense.pdf"}}}]).name},function(a,b){},,,,function(a,b){},,function(a,b){},,,function(a,b){}])}),define("assets/qvangular/qvangular-core",["require","jquery","assets/qvangular/qvangular-config","angular-leonardo-ui","touche","angular-animate","angular-sanitize","angular","angular-vs-repeat","general.components/mobile-menu/mobile-menu","general.components/alert-dialog/alert-dialog","general.components/confirm-dialog/confirm-dialog","general.components/context-menu/context-menu-service","assets/qvangular/qvangular-directives","assets/qvangular/qvangular-filters","assets/qvangular/qvangular-locale","assets/es2015/client-core.bundle","assets/dragoman/dragoman-angular","sense-about-dialog"],function(a,b,c,d){function e(a,b){q.isBootstrapped?q[a]=b:(r.push({name:a,fn:b}),q[a]=function(){var a=Array.prototype.slice.call(arguments);s.push({fn:b,args:a})})}function f(a){return function(){var b=Array.prototype.slice.apply(arguments);q.$rootScope.$$phase?a.apply(this,b):q.$rootScope.$apply(function(){a.apply(this,b)})}}var g,h,i,j,k,l,m,n,o,p=window.angular,q={},r=[],s=[];if(d.config({showOverlay:function(b,c){return a("general.services/show-service/show-service").show(b,c)}}),q.bootstrap=function(a,b,c,d,e,f){h=b,i=c,j=d,n=e,o=f,g=a,q.$injector=g,q.$rootScope=h,q.isBootstrapped=!0,r.forEach(function(a){q[a.name]=a.fn}),s.forEach(function(a){a.fn.apply(a.fn,a.args)}),s.length=r.length=0},
q.module=p.module("qlik-angular",["ngAnimate","ngSanitize","leonardo-ui","vs-repeat","qv-dragoman","qv-general","qv-directives","qv-filters","qv-locale","qv.mobile-menu","qv.alert-dialog","qv.confirm-dialog","qv.context-menu","qv-modules.about-dialog"],["$provide","$injector","$compileProvider","$filterProvider","$animateProvider",function(a,b,d,e,f){k=a,l=d,m=e,c.internalOptimizations&&(f.classNameFilter(/\bqv-animate\b/i),a.value("$anchorScroll",function(){}))}]).run(["$injector","$rootScope","$compile","$controller","$timeout","$q",q.bootstrap]),e("directive",function(a,b){l.directive(a,b)}),e("nativeComponent",function(a,b){l.component(a,b)}),q.component=function(a,b){q.directive(a,function(){return{transclude:null==b.transclude||b.transclude,template:b.template,requires:b.requires,scope:null!=b.scope?b.scope:"=",controller:b.controller||function(){},link:b.link||function(){},restrict:"E",replace:!0}})},e("filter",function(a,b){m.register(a,b)}),e("service",function(a,b){return k.service(a,b),g.get(a)}),e("provider",function(a,b){return k.provider(a,b)}),e("injectComponent",function(a,c,d){var e;if(!c)throw"Trying to show undefined component.";if("function"==typeof c)return c.apply({},[a,d]);if(Array.isArray(c)){var f={$element:a,input:d};for(var k in d)d.hasOwnProperty(k)&&(f[k]=d[k]);return g.invoke(c,{},f)}if(c.controller){var l=b(a).scope();return l||(l=h),q.$apply(l,function(){var b=l.$new();b.extractComponent=function(){b.$$destroyed||(b.$destroy(),a.off(".qvangularcoreshowcomponent"),a.html(""))},b.destroyComponent=b.extractComponent;var f={$scope:b,$element:a,$transclude:void 0,input:d};for(var g in d)d.hasOwnProperty(g)&&(f[g]=d[g],b[g]=d[g]);a.html(c.template);var h=i(a.contents());c.controller&&(e=j(c.controller,f),a.contents().data("$ngControllerController",e)),h(b),a.on("remove.qvangularcoreshowcomponent",function(){b.$$destroyed||b.$destroy()})}),e}}),e("componentDirective",function(a,b,c,d){var e={};for(var f in b)b.hasOwnProperty(f)&&(e[f]=b[f]);e[a]="=",e.input="=",e.component="=",q.directive(a,["$http","$templateCache","$compile","$controller",function(b,f,g,h){return{restrict:"EA",replace:!0,terminal:!0,scope:e,link:function(b,e,f){var i,j=0;b.$watch("component",function(k){var l=++j;if(k||(k=c),k&&k.template){if(l!==j)return;i&&i.$destroy(),i=b.$new(),e.html(k.template);var m=g(e.contents()),n={$scope:i,$element:e,$attrs:f};if(b.input&&k.scope&&p.forEach(k.scope,function(a,c){var d;d="string"==typeof a&&"="===a.charAt(0)&&a.length>1?a.substring(1):c,i[d]=b.input[c];var e=i[d];i.$watch(function(){var a=b.input[c];return a!==i[d]&&(a!==e?e=i[d]=a:b.input[c]=e=i[d]),a})}),b.input){for(var o in b.input)b.input.hasOwnProperty(o)&&(n[o]=b.input[o]);n.input=b.input}var q;k.controller&&(q=h(k.controller,n),e.contents().data("$"+a+"Controller",q)),m(i),"function"==typeof d&&("function"==typeof q.onInit?q.onInit().then(function(){d(q,i,e)}):d(q,i,e))}else i&&(i.$destroy(),i=null),e.html("")})}}}])}),s.push({name:"componentDirective",fn:function(){q.componentType=q.componentDirective,q.componentDirective("qvaInclude",{ngModel:"="})}}),c.autoBootstrap){var t=Object.keys(window.qvangularNgModules||[]),u=(window.angular.mock?["ngMock","qlik-angular"]:["qlik-angular"]).concat(t);p.bootstrap(document,u)}return q.$apply=function(a,b){if(!q.isBootstrapped)return b&&b()||null;b?a.$root.$$phase?b&&b():a.$apply(b):(b=a,"function"==typeof b?q.$rootScope.$$phase?b():q.$rootScope.$apply(b):b&&b.$apply&&(q.$rootScope.$$phase||a.$apply()))},q.defer=function(){return o.defer()},q.when=function(a,b,c){return o.when(a,b,c)},q.promise=function(a){return n(function(){return a})},q.getService=function(a){return g.get(a)},b.fn.showComponent=function(a,b){return"string"==typeof a?q.injectComponent(this,{template:a,controller:b||function(){}},{}):q.injectComponent(this,a,b)},q.$applyify=f,window.qvangularGlobal=q,q}),define("core.utils/deferred",["assets/qvangular/qvangular-core"],function(a){var b;return b=function(){return a.getService("$q").defer()},b.resolve=function(b){var c=a.getService("$q").defer();return c.resolve(b),c.promise},b.reject=function(){return a.getService("$q").reject.apply(null,arguments)},b.all=function(){return a.getService("$q").all.apply(null,arguments)},b.when=function(){return a.getService("$q").when.apply(null,arguments)},Object.defineProperty(b,"Promise",{get:function(){return a.getService("$q")}}),b}),define("core.utils/class",[],function(){"use strict";var a=/xyz/.test(function(){})?/\b_super\b/:/.*/,b=function(){};return b.extend=function b(c,d){var e=this.prototype;"string"!=typeof c&&(d=c,c="Class");var f=Object.create(this.prototype);for(var g in d)f[g]="function"==typeof d[g]&&"function"==typeof e[g]&&a.test(d[g])?function(a,b){return function(){var c=this._super;this._super=e[a];var d=b.apply(this,arguments);return this._super=c,d}}(g,d[g]):d[g];if(!/^[_a-z][_a-z\d]*$/i.test(c))throw new Error("Invalid subclass name. Alphanumericals only.");var h=new Function("return (function "+c+"(){ typeof this.init === 'function' && this.init.apply(this, [].slice.call(arguments)) });")();return h.prototype=f,h.prototype.constructor=h,h.extend=b,h},b}),define("objects.views/charts/events/event-launcher",["core.utils/class"],function(a){"use strict";return a.extend({init:function(){this._listeners={}},listen:function(a,b,c){return"function"!=typeof b?this:(this._listeners[a]||(this._listeners[a]=[]),this._listeners[a].push({callback:b,scope:c}),this)},stopListen:function(a,b,c){var d,e=this._listeners[a];if(e)for(d=e.length-1;d>=0;d-=1)b?(c&&c===e[d].scope&&e[d].callback===b||!c&&e[d].callback===b)&&e.splice(d,1):e.splice(d,1);return this},fire:function(a,b){var c,d,e=a;if("string"!=typeof e&&(e=a.getType()),c=this._listeners[e])for(d=c.length-1;d>=0;--d)"string"==typeof a?c[d].callback.apply(c[d].scope?c[d].scope:this,b||[]):c[d].callback.apply(c[d].scope?c[d].scope:this,[a]);return this},hasListener:function(a){var b=a;return"string"!=typeof b&&(b=a.getType()),this._listeners&&this._listeners[b]&&this._listeners[b].length}})}),define("objects.utils/animation-frame",[],function(){var a=function(a){return window.setTimeout(a,1e3/60)},b=function(a){return window.clearTimeout(a)},c=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||a,d=window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.msCancelAnimationFrame||b;return{request:c===a?a:c.bind(window),cancel:d===b?b:d.bind(window)}}),define("objects.views/charts/invalidatable",["core.utils/deferred","./events/event-launcher","objects.utils/animation-frame"],function(a,b,c){"use strict";function d(b,d){var g;if(this._validating=!0,this._invalidatedProperties&&(!b||b&&b.contains("properties"))&&(g=f.call(this))&&"function"==typeof g.then&&this._pendingDfds.push(g),this._invalidatedDisplay&&(!b||b&&b.contains("display"))&&(g=e.call(this))&&"function"==typeof g.then&&this._pendingDfds.push(g),this._validating=!1,this._invalidated=this._invalidatedDisplay||this._invalidatedProperties,this._invalidated){if(!b){var h=this,i=this.dfd;this._timer=c.request(function(){h._validate(null,i)})}}else this._pendingDfds.length?(a.all(this._pendingDfds).then(function(){d.__qvState=1,d.resolve()}),this._pendingDfds=[]):(d.__qvState=1,d.resolve())}function e(){var a=this._updateDisplay();return this._invalidatedDisplay=!1,this.__invalidators.display=[],a}function f(){var a=this._updateProperties();return this._invalidatedProperties=!1,this.__invalidators.properties=[],a}function g(){if(!this._invalidated&&!this._validating&&!this._released){var b,d=this;this._invalidated=!0,b=a(),b.__qvState=0,b.__id=++this._dfdCount,this.dfd=b,this._timer=c.request(function(){d._validate(null,b)})}if(this.dfd)return this.dfd.promise}return b.extend("Invalidatable",{init:function(){this._super(),this.__invalidators={size:[],display:[],properties:[]},this._pendingDfds=[],this._dfdCount=0},invalidate:function(){return this._released?a.reject():g.call(this)},invalidateProperties:function(b){return this._released?a.reject():(this._invalidatedProperties||(this._invalidatedProperties=!0,g.call(this)),this.__invalidators.properties.push(b),this.dfd.promise)},invalidateDisplay:function(b){return this._released?a.reject():(this._invalidatedDisplay||(this._invalidatedDisplay=!0,g.call(this)),this.__invalidators.display.push(b),this.dfd.promise)},validateNow:function(){return this._invalidated=!0,this.updateNow(),this},updateNow:function(a){if(this._invalidated&&!this._validating){var b=a&&a.contains("display")===this._invalidatedDisplay,d=a&&a.contains("properties")===this._invalidatedProperties;(!a||b&&d)&&(c.cancel(this._timer),this._timer=null),this._validate(a,this.dfd)}return this},_update:function(){return this},_updateDisplay:function(){},_updateProperties:function(){},cancel:function(){c.cancel(this._timer),this._invalidatedProperties=!1,this.__invalidators.properties=[],this._invalidatedDisplay=!1,this.__invalidators.display=[],this._invalidated=!1,this.dfd&&(this.dfd.__qvState=2,this.dfd.reject())},release:function(){this._released=!0,this.cancel(),this.dfd=null},_validate:function(a,b){d.call(this,a,b)}})}),define("objects.views/charts/utils/transition-helper",["jquery","core.utils/class","core.utils/deferred"],function(a,b,c){"use strict";function d(b,c,d,g){f.apply(this,[b,c]);var i,j,k,l,m,n=!0,o=!1,p=this;n=h.checkEqual(b,d);for(i in d)void 0===b[i]&&(o=!0);return n?(p._endCallback&&p._endCallback.call(p._scope),void g.resolve()):o?(a.extend(c,d),a.extend(b,d),p._endCallback&&p._endCallback.call(p._scope),void g.resolve()):(j=this._transitionTime,k=Date.now(),this._inAnimation=!0,this._initiateAnimation=!1,this._transitionProgress=0,a.extend(c,e(b,c,d,0)),void(this._animationCallback=setInterval(function(){if((l=(Date.now()-k)/j)>1)clearInterval(p._animationCallback),a.extend(c,e(b,c,d,1)),p._updateCallback&&p._updateCallback.call(p._scope),p._inAnimation=!1,p._lastFrame=!0,p._transitionProgress=1;else{switch(p._transitionCurve){case"linear":m=l;break;case"easeout":m=Math.sin(Math.PI*l/2);break;case"easein":m=1-Math.cos(Math.PI*l/2);break;default:m=(1+Math.cos(Math.PI*(1+l)))/2}p._transitionProgress=m,a.extend(c,e(b,c,d,m)),p._updateCallback&&p._updateCallback.call(p._scope)}l>1&&(c=a.extend({},d),p._endCallback.call(p._scope),g.resolve())},15)))}function e(b,c,d,f){var g=function(b,c){a.extend(b,e(b,d[h][c],f))};if(f<=0)return b;if(f>=1)return d;for(var h in b)b||!d?!b||d?(b[h]instanceof Array?b[h].forEach(g):isNaN(b[h])&&b[h]instanceof Object&&function(a,b,c){b[h]=e(a[h],b[h],c[h],f)}(b,c,d),b[h]&&!d[h]&&(c[h]=d[h]),null===b[h]||null===d[h]||isNaN(b[h])||isNaN(d[h])||(c[h]=b[h]*(1-f)+d[h]*f)):void 0!==b.opacity&&(c.opacity=1-f):(void 0!==d.opacity&&(c.opacity=f),c=a.extend(c,d));return c}function f(b,c){a.extend(b,c),clearInterval(this._animationCallback),this._inAnimation=!1,this._lastFrame=!1}function g(a,b,c,e){this._inAnimation||this._initiateAnimation&&this._transitionEnabled?d.call(this,a,b,c,e):e.resolve()}var h;return h=b.extend("TransitionHelper",{namespace:".transitionhelper",init:function(a,b,c,d){this._updateCallback=a,this._endCallback=b,this._transitionTime=c||500,this._scope=d,this._inAnimation=!1,this._transitionProgress=0,this._lastFrame=!1,this._animationCallback=function(){return null},this._initiateAnimation=!0,this._transitionEnabled=!0,this._transitionDelay=0,this._transitionCurve=""},transition:function(a,b,d,e,h,i){var j=this,k=c();return this._oldValues=a,this._currentValues=b,this._newValues=d,this._updateCallback=h,this._endCallback=e,this._scope=i,f.apply(this,[a,b]),this._initiateAnimation=!0,this._inAnimation||this._lastFrame?k.resolve():this._transitionDelay>0?this._trantisionTimeout=setTimeout(function(){g.apply(j,[a,b,d,k])},this._transitionDelay):g.apply(this,[a,b,d,k]),k.promise},clear:function(){clearInterval(this._animationCallback),clearTimeout(this._trantisionTimeout),this._inAnimation=!1,this._lastFrame=!0,this._transitionProgress=1},setTransitionTime:function(a){this._transitionTime=a},setDelay:function(a){this._transitionDelay=a},setTransitionCurve:function(a){this._transitionCurve=a}}),h.checkEqual=function(a,b){var c;for(c in b){if(!(c in a))return!1;if(typeof b[c]!=typeof a[c])return!1;if(Array.isArray(b[c])){if(!h.checkEqual(a[c],b[c]))return!1}else if(!(b[c]===a[c]||void 0===a[c]||"number"==typeof b[c]&&"number"==typeof a[c]&&isNaN(b[c])&&isNaN(a[c])))return!1}return!0},h}),define("objects.views/charts/utils/node",["core.utils/class"],function(a){var b;return b=a.extend("Node",{init:function(){this._parent=null,this._children=[],this._ancestors=null,this.data={}},detach:function(){return this._parent&&this._parent.removeChild(this),this},each:function(a,b){if("function"!=typeof a||!this._children||!this._children.length)return this;var c,d=this._children.length;for(c=0;c<d;c++)a.call(b,this._children[c],c),this._children[c].isBranch&&this._children[c].each(a,b);return this}}),Object.defineProperties(b.prototype,{parent:{get:function(){return this._parent}},isBranch:{get:function(){return this._children&&this._children.length}},children:{get:function(){return this._children}},siblings:{get:function(){if(!this._parent)return[];var a=this._parent._children.slice();return a.splice(a.indexOf(this),1),a}},ancestors:{get:function(){if(!this._ancestors){var a=this._parent;this._ancestors=a?[a].concat(a.ancestors):[]}return this._ancestors}},descendants:{get:function(){var a,b,c,d=[];for(a=0,b=this._children.length;a<b;a++)c=this._children[a],d.push(c),c._children.length&&(d=d.concat(c.descendants));return d}},leaves:{get:function(){var a,b,c=[],d=this._children.length;for(b=0;b<d;b++)a=this._children[b],a._children&&a._children.length?c=c.concat(a.leaves):c.push(a);return c}}}),b}),define("objects.views/charts/utils/matrix",["core.utils/class"],function(a){var b;return b=a.extend({init:function(){this._elements=[[1,0,0],[0,1,0],[0,0,1]],this._stack=[]},clone:function(){return(new b).multiply(this._elements)},set:function(a){return this._elements=a,this},save:function(){return this._stack.push(this.elements),this},restore:function(){return this._stack.length&&(this._elements=this._stack.pop()),this},add:function(a){var b,c;for(b=0;b<this._elements.length;b++)for(c=0;c<this._elements[b].length;c++)this._elements[b][c]+=a;return this},translate:function(a,b){return this.multiply([[1,0,a],[0,1,b],[0,0,1]]),this},rotate:function(a){var b=Math.cos(-a),c=Math.sin(-a);return this.multiply([[b,c,0],[-c,b,0],[0,0,1]]),this},skew:function(a,b){var c=Math.tan(a),d=Math.tan(b);return this.multiply([[1,c,0],[d,1,0],[0,0,1]]),this},multiply:function(a){var c,d,e,f;if(a instanceof b&&(a=a._elements),Array.isArray(a)){for(e=[[0,0,0],[0,0,0],[0,0,0]],c=0;c<this._elements.length;c++)for(d=0;d<this._elements[c].length;d++)for(f=0;f<3;f++)e[c][d]+=this._elements[c][f]*a[f][d];this._elements=e}else for(c=0;c<this._elements.length;c++)for(d=0;d<this._elements[c].length;d++)this._elements[c][d]*=a;return this},scale:function(a,b){return(arguments.length<2||void 0===b)&&(b=a),this.multiply([[a,0,0],[0,b,0],[0,0,1]]),this},determinant:function(){var a=this._elements[0][0],b=this._elements[0][1],c=this._elements[0][2],d=this._elements[1][0],e=this._elements[1][1],f=this._elements[1][2],g=this._elements[2][0],h=this._elements[2][1],i=this._elements[2][2];return a*e*i+b*f*g+c*d*h-c*e*g-b*d*i-a*f*h},invert:function(){var a=this.determinant(),b=this._elements[0][0],c=this._elements[0][1],d=this._elements[0][2],e=this._elements[1][0],f=this._elements[1][1],g=this._elements[1][2],h=this._elements[2][0],i=this._elements[2][1],j=this._elements[2][2];return this._elements=[[f*j-g*i,d*i-c*j,c*g-d*f],[g*h-e*j,b*j-d*h,d*e-b*g],[e*i-f*h,h*c-b*i,b*f-c*e]],this.multiply(1/a),this},transpose:function(){var a=Object.create(this._elements);return this._elements=[[a[0][0],a[1][0],a[2][0]],[a[0][1],a[1][1],a[2][1]],[a[0][2],a[1][2],a[2][2]]],this},identity:function(){return this._elements=[[1,0,0],[0,1,0],[0,0,1]],this},transformPoint:function(a){var b,c,d=[a.x,a.y,1],e=this._elements,f=[0,0,0];for(b=0;b<this._elements.length;b++)for(c=0;c<this._elements[b].length;c++)f[b]+=d[c]*e[b][c];return{x:f[0],y:f[1]}},transformPoints:function(a){var b,c,d,e,f,g=this._elements,h=[];for(e=0;e<a.length;e++){for(b=[a[e].x,a[e].y,1],f=[0,0,0],c=0;c<this._elements.length;c++)for(d=0;d<this._elements[c].length;d++)f[c]+=b[d]*g[c][d];h.push({x:f[0],y:f[1]})}return h},toString:function(){var a="";return this._elements.forEach(function(b,c,d){a+=b.join("\t")+(c<d.length?"\n":"")}),a},isIdentity:function(){var a=this._elements;return 1===a[0][0]&&0===a[0][1]&&0===a[0][2]&&0===a[1][0]&&1===a[1][1]&&0===a[1][2]&&0===a[2][0]&&0===a[2][1]&&1===a[2][2]},identityIfClose:function(a){var b=this._elements;Math.abs(b[0][0]-1)<a&&Math.abs(b[0][1])<a&&Math.abs(b[0][2])<a&&Math.abs(b[1][0])<a&&Math.abs(b[1][1]-1)<a&&Math.abs(b[1][2])<a&&Math.abs(b[2][0])<a&&Math.abs(b[2][1])<a&&Math.abs(b[2][2]-1)<a&&this.identity()}}),Object.defineProperties(b.prototype,{elements:{get:function(){var a=this._elements;return[[a[0][0],a[0][1],a[0][2]],[a[1][0],a[1][1],a[1][2]],[a[2][0],a[2][1],a[2][2]]]}}}),b}),define("client.utils/property-resolver",["util"],function(a){function b(a){return"object"==typeof a.items&&"array"!==a.type&&("items"===a.type||"items"===a.component||"expandable-items"===a.component||"accordion"===a.component||!a.type&&!a.component)}function c(a,b,c){if("string"!=typeof b)return b;switch(a){case"integer":b=parseInt(b,10),isNaN(b)&&(b=c);break;case"number":b=parseFloat(b),isNaN(b)&&(b=c);break;case"boolean":b="true"===b}return b}function d(a,b){if("function"==typeof b.defaultValue)return b.defaultValue();if(void 0!==b.defaultValue)return b.defaultValue;if(Array.isArray(b.options))return b.options[0].value;switch(a){case"array":return[];case"string":return"";case"integer":case"number":return 0;case"boolean":return!1;default:return null}}function e(c){function e(c){var g,h,i;if(!c.schemaIgnore)if(b(c))for(g=Object.keys(c.items),i=0;i<g.length;i++)(h=c.items[g[i]])&&e(h);else c.ref&&!c.schemaIgnore&&a.setValue(f,c.ref,d(c.type,c))}var f={};return"array"===c.type&&c.items?(f={},e({type:"items",items:c.items})):e(c),f}var f={};return f.invertedBoolean={get:function(a){return!a("boolean")},set:function(a,b){b("boolean",!a)}},f.booleanToSortInteger={get:function(a){return!!a("integer")},set:function(a,b,c){var d;a?(d=c.defaultSort?c.defaultSort:1,b("integer",d)):b("integer",0)}},f.enumToSortInteger={get:function(a){switch(a("integer")){case-1:return"descending";case 1:return"ascending";default:return"disabled"}},set:function(a,b){switch(a){case"descending":b("integer",-1);break;case"ascending":b("integer",1);break;default:b("integer",void 0)}}},f.invertedEnumToSortInteger={get:function(a){switch(a("integer")){case 1:return"descending";case-1:return"ascending";default:return"disabled"}},set:function(a,b){switch(a){case"descending":b("integer",1);break;case"ascending":b("integer",-1);break;default:b("integer",void 0)}}},{getValue:a.getValue,setValue:a.setValue,getTypeValue:c,getDefaultValue:d,getDefaults:e,resolveFunctions:f,isHierarchical:b}}),define("objects.views/charts/utils/node-selector",["client.utils/property-resolver"],function(a){"use strict";var b={className:/^\w[\w-]+/,attr:/^\[\w(?:[\w\._-]+)?(?:[!]?=['\"][\w\s*#_-]*['\"])?\]/},c={className:function(a,b){return b.filter(function(b){var c=b.constructor.name;if(c){var d=a.replace(/(\-[a-z])/g,function(a){return a[1].toUpperCase()});return d=d[0].toUpperCase()+d.slice(1),c===a||c===d}})},attr:function(b,c,d,e){return e.filter(function(e){var f=a.getValue(e,b);if(!c)return void 0!==f;if(void 0===f)return!1;switch(c){case"=":return d===String(f);case"!=":return d!==String(f)}return!1})}};return{find:function(a,b){var c,d,e=[],f=[];return b.isBranch&&(c=this._tokenize(a),d=b.descendants,c.forEach(function(a){var b=d.slice(),c=[],e=!1;a.reverse().forEach(function(a){if(" "===a.type)return c.push(b),b=d.slice(),void(e=!1);b=this._filter(a,b),e=!0},this),e&&c.push(b);var g=c[0].filter(function(a){var b,d,e=a.parent;for(b=1;b<c.length;b++){for(;e&&(d=c[b].indexOf(e))<0;)e=e.parent;if(d<0)return!1}return!0});f.push(g)},this),f.forEach(function(a){a.forEach(function(a){e.indexOf(a)<0&&e.push(a)})})),e||[]},_filter:function(a,b){if(!b||!b.length||!a||"function"!=typeof c[a.type])return[];switch(a.type){case"className":return c[a.type](a.value,b);case"attr":return c[a.type](a.attribute,a.operator,a.attributeValue,b)}return[]},_tokenize:function(a){var c,d,e,f,g=[];return a.split(/\s*,\s*/).forEach(function(a){for(a=a.trim(),c=[];a;){f=!1,e=a.match(/^\s*([>+~]|\s)\s*/),e&&(f=!0,c.push({type:" ",value:e[0]}),a=a.slice(e[0].length));for(var h in b)(e=a.match(b[h]))&&(f=!0,a=a.slice(e[0].length),d={type:h,value:e[0]},"attr"===h&&(e=e[0].match(/\[(\w[\w\._-]+)?(?:([!]?=)['\"]([\w\s#_-]*)['\"])?\]/),d.attribute=e[1],d.operator=e[2],d.attributeValue=e[3]),c.push(d));if(c&&c.length&&g.indexOf(c)<0&&g.push(c),!f)break}}),g}}}),define("objects.views/charts/shapes/display-object",["objects.views/charts/utils/node","objects.views/charts/utils/matrix","general.utils/shapes/rect","objects.views/charts/utils/node-selector"],function(a,b,c,d){"use strict";function e(){this.matrix=new b,this.scale=g.scale,this.rotate=g.rotate,this.translate=g.translate,this._dirtyBounds=!0}var f,g={translate:function(a,b){return this.matrix.translate(a,b),this._dirtyBounds=!0,this.invalidate(),this},rotate:function(a){return this.matrix.rotate(a),this._dirtyBounds=!0,this.invalidate(),this},scale:function(a,b){return this.matrix.scale(a,b),this._dirtyBounds=!0,this.invalidate(),this}};return f=a.extend("DisplayObject",{init:function(){this._super(),this._dirtyBounds=!0,this._bounds=new c(NaN,NaN,NaN,NaN),this._vmBounds=new c(NaN,NaN,NaN,NaN),this._visualBounds=new c(NaN,NaN,NaN,NaN),this._stage=null,this.rData={inherited:{}},this._modelView=null,this._inverseModelView=null,this._inheritedProps={}},find:function(a){return d.find(a,this)},translate:function(a,b){return 0===a&&0===b?this:(e.call(this),g.translate.call(this,a,b))},rotate:function(a){return isNaN(a)||0===a?this:(e.call(this),g.rotate.call(this,a))},scale:function(a,b){return 1===a?this:(e.call(this),g.scale.call(this,a,b))},clearTransform:function(){return this.matrix&&(this.matrix.identity(),this._dirtyBounds=!0,this.invalidate()),this},invalidate:function(){var a=this._stage||this.stage;return a&&a.invalidateObject(this),this._inheritedProps={},this},attr:function(a){return void 0!==this[a]?this[a]:void 0!==this.rData.inherited[a]?this.rData.inherited[a]:void 0},attrs:function(a){for(var b in a)void 0===a[b]?delete this[b]:this[b]=a[b];return this},getBoundingRect:function(){return this._dirtyBounds&&this._calculateBounds(),this._vmBounds},getVisualBounds:function(){return this._dirtyBounds&&this._calculateBounds(),this._visualBounds},getVisualExpansion:function(){var a,b=this.attr("stroke");return b?(a=this.attr("strokeWidth"),a?a/2:0):0},pointInside:function(a,b){if(this.visible===!1)return!1;var c,d=this.getInverseModelView();return d&&this._transformedIncomingPoint!==!0?(c=d.transformPoint({x:a,y:b}),this.containsPoint(c.x,c.y)):this.containsPoint(a,b)},intersectsLine:function(a){if(this.visible===!1)return!1;var b,c,d,e=this.getInverseModelView();return e&&this._transformedIncomingPoint!==!0?(c=e.transformPoint({x:a.x1,y:a.y1}),d=e.transformPoint({x:a.x2,y:a.y2}),a=a.clone(),a.set(c.x,c.y,d.x,d.y),this._transformedIncomingPoint=!0,b=this.intersectsLocalLine(a),delete this._transformedIncomingPoint,b):this.intersectsLocalLine(a)},intersectsRect:function(a){if(this.visible===!1)return!1;var b,c,d=this.getInverseModelView();return d&&this._transformedIncomingPoint!==!0?(this._transformedIncomingPoint=!0,b=this._getTransformedBoundsOfRect(d,a),c=this.intersectsLocalRect(b),delete this._transformedIncomingPoint,c):this.intersectsLocalRect(a)},getPoints:function(){if(this.visible===!1)return[];var a,b,c,d=this.getModelView();if(d){for(a=this.getLocalPoints().slice(),b=0,c=a?a.length:0;b<c;b++)a[b]=d.transformPoint(a[b]);return a}return this.getLocalPoints()},getLocalPoints:function(){return[]},intersectsLocalLine:function(){return!1},intersectsLocalRect:function(a){var b,c="function"==typeof a.getPoints?a.getPoints():[{x:a.x,y:a.y},{x:a.x+a.width,y:a.y},{x:a.x+a.width,y:a.y+a.height},{x:a.x,y:a.y+a.height}],d=c.length;for(b=0;b<d;b++)if(this.containsPoint(c[b].x,c[b].y))return!0;for(c=this.getLocalPoints(),d=c.length,b=0;b<d;b++)if(c[b].x>=a.x&&c[b].x<=a.x+a.width&&c[b].y>=a.y&&c[b].y<=a.y+a.height)return!0;return!1},containsPoint:function(){return!1},getLocalBoundingRect:function(){return this._bounds},invalidateBounds:function(){return this._dirtyBounds=!0,this},clearModelView:function(){this._modelView=null,this._inverseModelView=null,this._isModelViewCalculated=!1,this._dirtyBounds=!0},getModelView:function(){return this._modelView||this._isModelViewCalculated||this._calculateModelView(),this._modelView},getInverseModelView:function(){return this._inverseModelView||this._isModelViewCalculated||this._calculateModelView(),this._inverseModelView},destroy:function(){this._stage=null},_calculateBounds:function(){var a,b=this._bounds,c=this.getLocalBoundingRect(),d=this.getModelView(),e=this.getVisualExpansion();c?(b.set(c.x,c.y,c.width,c.height),d?(a=this._getTransformedBoundsOfRect(d,b),this._vmBounds.set(a.x,a.y,a.width,a.height),a=this._getTransformedBoundsOfRect(d,{x:b.x-e,y:b.y-e,width:b.width+2*e,height:b.height+2*e}),this._visualBounds.set(a.x,a.y,a.width,a.height)):(this._vmBounds.set(c.x,c.y,c.width,c.height),this._visualBounds.set(c.x-e,c.y-e,c.width+2*e,c.height+2*e))):(b.set(NaN,NaN,NaN,NaN),this._vmBounds.set(NaN,NaN,NaN,NaN),this._visualBounds.set(NaN,NaN,NaN,NaN)),this._dirtyBounds=!1},_getTransformedBoundsOfRect:function(a,b){var d,e,f,g,h,i,j;return d=a.transformPoints([{x:b.x,y:b.y},{x:b.x+b.width,y:b.y},{x:b.x+b.width,y:b.y+b.height},{x:b.x,y:b.y+b.height}]),e=d.map(function(a){return a.x}),f=d.map(function(a){return a.y}),g=Math.min.apply(null,e),i=Math.max.apply(null,e),h=Math.min.apply(null,f),j=Math.max.apply(null,f),new c(g,h,i-g,j-h)},_calculateModelView:function(){for(var a=this;a&&!a.rData.vmTransform;)a=a._parent;return this._isModelViewCalculated=!0,!!a&&(a._modelView||(a._modelView=new b,a._inverseModelView=new b),a.rData.dirtyVMTransform&&(a._modelView.set(a.rData.vmTransform),a._inverseModelView.set(a.rData.vmTransform).invert(),delete a.rData.dirtyVMTransform),this._modelView=a._modelView,this._inverseModelView=a._inverseModelView,!0)}}),Object.defineProperties(f.prototype,{stage:{get:function(){return this._parent&&!this._stage?this._stage=this._parent.stage:this._parent||this._stage===this||(this._stage=null),this._stage}}}),f}),define("general.utils/shapes/circle",["./rect"],function(a){"use strict";function b(a,b,c){0===arguments.length?this.set(0,0,0):this.set(a,b,c)}return b.prototype={toString:function(){return this.cx+" "+this.cy+" "+this.r},clone:function(){return new b(this.cx,this.cy,this.r)},set:function(a,b,c){this.cx=a,this.cy=b,this.r=c,this.radius=c},setPosition:function(a,b){this.cx=a,this.cy=b},setRadius:function(a){this.radius=a},combineWith:function(){},intersectsWith:function(a){return a.pointInside(this.cx,this.cy)},intersectsRect:function(a){return a.pointInside(this.cx,this.cy)},intersectsLine:function(a){if(this.pointInside(a.x1,a.y1)||this.pointInside(a.x2,a.y2))return!0;var b,c,d,e,f,g,h;if(b=Math.sqrt(Math.pow(a.x2-a.x1,2)+Math.pow(a.y2-a.y1,2)),c=(a.x2-a.x1)/b,d=(a.y2-a.y1)/b,e=c*(this.cx-a.x1)+d*(this.cy-a.y1),f=c*(this.cx-a.x2)+d*(this.cy-a.y2),e>=0&&f<=1){if(g=e*c+a.x1,h=e*d+a.y1,Math.sqrt(Math.pow(g-this.cx,2)+Math.pow(h-this.cy,2))<=this.r)return!0}else if(f>=0&&f<=1&&(g=f*c+a.x2,h=f*d+a.y2,Math.sqrt(Math.pow(g-this.cx,2)+Math.pow(h-this.cy,2))<=this.r))return!0;return!1},pointInside:function(a,b){return Math.sqrt(Math.pow(this.cx-a,2)+Math.pow(this.cy-b,2))<=this.r},getPoints:function(){return[{x:this.cx,y:this.cy}]},getBoundingRect:function(){return new a(this.cx-this.r,this.cy-this.r,2*this.r,2*this.r)}},b}),define("general.utils/shapes/vector",["core.utils/class"],function(a){var b;return b=a.extend({init:function(a,b){this.x=a||0,this.y=b||0},clone:function(){return new b(this.x,this.y)},add:function(a){this.x+=a.x,this.y+=a.y},dot:function(a){return this.x*a.x+this.y*a.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}}),b.add=function(a,b){return a.clone().add(b)},b}),define("general.utils/shapes/arc",["./line","./circle","./rect","./vector"],function(a,b,c,d){"use strict";function e(a,b,c,d,e,f,g){this.cx=a,this.cy=b,this.innerRadius=c,this.radius=d,this.radianOffset=(g<0?g+2*Math.PI:g)%(2*Math.PI),this.start=e,this.start-=this.start>Math.PI?2*Math.PI:0,this.end=f,this.end-=this.end>Math.PI?2*Math.PI:0,this.arcCenter=(e+f)/2%(2*Math.PI),this.x1=a+d*Math.cos(this.start+this.radianOffset),this.y1=b+d*Math.sin(this.start+this.radianOffset),this.x2=a+d*Math.cos(this.end+this.radianOffset),this.y2=b+d*Math.sin(this.end+this.radianOffset),this.x3=a+c*Math.cos(this.start+this.radianOffset),this.y3=b+c*Math.sin(this.start+this.radianOffset),this.x4=a+c*Math.cos(this.end+this.radianOffset),this.y4=b+c*Math.sin(this.end+this.radianOffset)}var f=["top","left","bottom","right"],g={top:"left",left:"bottom",bottom:"right",right:"top"},h={top:"right",left:"top",bottom:"left",right:"bottom"};return e.prototype={getDistance:function(a,b,c,d){var e=Math.abs(a-c),f=Math.abs(b-d);return Math.sqrt(Math.pow(e,2)+Math.pow(f,2))},getAngle:function(a,b,c,d){var e=a-c,f=b-d,g=Math.atan2(f,e)-this.radianOffset;return g=g<0?g+2*Math.PI:g,g=g>Math.PI?g-2*Math.PI:g},pointInside:function(a,b){var c=this.getAngle(a,b,this.cx,this.cy),d=this.getDistance(a,b,this.cx,this.cy),e=this.start,f=this.end;return!(d>this.radius||d<this.innerRadius)&&(c>=e&&c<=f||e>f&&(c<=f||c>=e))},getDirection:function(a){a+=Math.PI/4,a<0&&(a+=2*Math.PI),a%=2*Math.PI;var b=3;return a>=1.5*Math.PI?b=0:a>=Math.PI?b=1:a>=Math.PI/2&&(b=2),f[b]},getSecondaryDirection:function(a){var b=this.getDirection(a);return a+=Math.PI/4,a%(Math.PI/2)>Math.PI/4?h[b]:g[b]},getPoints:function(){var a=[];return a.push({x:this.x1,y:this.y1},{x:this.x2,y:this.y2},{x:this.x3,y:this.y3},{x:this.x4,y:this.y4}),a},getBoundingRect:function(){var a=Math.min(Math.min(this.x1,this.x2),Math.min(this.x3,this.x4)),b=Math.min(Math.min(this.y1,this.y2),Math.min(this.y3,this.y4)),d=Math.max(Math.max(this.x1,this.x2),Math.max(this.x3,this.x4))-a,e=Math.max(Math.max(this.y1,this.y2),Math.max(this.y3,this.y4))-b;return new c(a,b,d,e)},getRelevantPosition:function(){var a=this.cx+this.radius*Math.cos(this.arcCenter+this.radianOffset),b=this.cy+this.radius*Math.sin(this.arcCenter+this.radianOffset),c=this.getDirection(this.arcCenter+this.radianOffset),d=this.getSecondaryDirection(this.arcCenter+this.radianOffset);return{pos:{x:a,y:b},direction:[c,d].concat(d===g[c]?[h[c],g[d]]:[g[c],h[d]])}},intersectsWith:function(b){return this.intersectsLine(new a(b.x,b.y,b.x+b.width,b.y))||this.intersectsLine(new a(b.x+b.width,b.y,b.x+b.width,b.y+b.height))||this.intersectsLine(new a(b.x,b.y+b.height,b.x+b.width,b.y+b.height))||this.intersectsLine(new a(b.x,b.y,b.x,b.y+b.height))},intersectsLine:function(c){if(this.pointInside(c.x1,c.y1)||this.pointInside(c.x2,c.y2))return!0;if(c.intersectsLine(new a(this.x1,this.y1,this.x4,this.y4))||c.intersectsLine(new a(this.x3,this.y3,this.x2,this.y2)))return!0;var e=new b(this.cx,this.cy,this.innerRadius);if(this.innerRadius>0&&e.pointInside(c.x1,c.y1)&&e.pointInside(c.x2,c.y2))return!1
;var f,g,h,i,j=new d(c.x2-c.x1,c.y2-c.y1),k=new d(c.x1-this.cx,c.y2-this.cy),l=j.dot(j),m=2*k.dot(j),n=k.dot(k)-this.radius*this.radius,o=m*m-4*l*n,p=[];if(o<0)return!1;if(o=Math.sqrt(o),g=(-m-o)/(2*l),h=(-m+o)/(2*l),g>=0&&g<=1&&p.push({x:c.x1+g*j.x,y:c.y1+g*j.y}),h>=0&&h<=1&&p.push({x:c.x1+h*j.x,y:c.y1+h*j.y}),!p.length)return!1;for(f=0;f<p.length;f++){if((i=this.getAngle(p[f].x,p[f].y,this.cx,this.cy))>=this.start&&i<=this.end)return!0;if(this.start>this.end&&(i<=this.end||i>=this.start))return!0}return!1}},e}),define("objects.views/charts/shapes/arc",["objects.views/charts/shapes/display-object","general.utils/shapes/arc"],function(a,b){"use strict";var c,d=Math.PI/2,e=3*Math.PI/2,f=2*Math.PI;return c=a.extend("Arc",{init:function(a,c,d,e,f,g,h){this._super(),b.apply(this,[a,c,d,e,f,g,h])},containsPoint:b.prototype.pointInside,intersectsLocalLine:b.prototype.intersectsLine,getLocalPoints:b.prototype.getPoints,intersectsLocalRect:function(a){return b.prototype.intersectsWith.call(this,a)},getLocalBoundingRect:function(){var a,b,c=[this.x1,this.x2,this.x3,this.x4],g=[this.y1,this.y2,this.y3,this.y4],h=(this.start+this.radianOffset)%f,i=h+this.end-this.start;return(h<f&&i>f||h<0&&i>0)&&c.push(this.cx+this.radius),h<d&&i>d&&g.push(this.cy+this.radius),h<Math.PI&&i>Math.PI&&c.push(this.cx-this.radius),(h<e&&i>e||h<-d&&i>-d)&&g.push(this.cy-this.radius),a=Math.min.apply(null,c),b=Math.min.apply(null,g),{x:a,y:b,width:Math.max.apply(null,c)-a,height:Math.max.apply(null,g)-b}},getRelevantPosition:function(){var a=this.getModelView(),c=b.prototype.getRelevantPosition.call(this);if(a){var d=this.cx+this.radius*Math.cos(this.arcCenter+this.radianOffset),e=this.cy+this.radius*Math.sin(this.arcCenter+this.radianOffset),f={x:d,y:e};f=a.transformPoint(f),c.pos.x=f.x,c.pos.y=f.y}return c},set:function(){b.apply(this,[].slice.call(arguments)),this.invalidateBounds()}}),Object.keys(b.prototype).forEach(function(a){!c.prototype.hasOwnProperty(a)&&["pointInside","intersectsLine","getBoundingRect","getPoints","getRelevantPosition","intersectsRect"].indexOf(a)<0&&(c.prototype[a]=b.prototype[a])}),c}),define("objects.utils/layout",[],function(){"use strict";function a(a,b){var c;for(c=0;c<i;++c)if(a>=f[c][0]&&b>=f[c][1])return f[c][2];return e.SPARK}function b(a){var b;for(b=0;b<i;++b)if(a>=g[b][0])return g[b][1];return e.SPARK}function c(a){var b;for(b=0;b<i;++b)if(a>=h[b][0])return h[b][1];return e.SPARK}function d(a){var b=Object.keys(e).filter(function(b){return e[b]===a})[0];return b&&b.toLowerCase()||""}var e={SPARK:1,XSMALL:3,SMALL:7,MEDIUM:15,FULL:31},f=[[550,450,e.FULL],[400,220,e.MEDIUM],[300,150,e.SMALL],[150,75,e.XSMALL],[0,0,e.SPARK]],g=[[450,e.FULL],[220,e.MEDIUM],[150,e.SMALL],[75,e.XSMALL],[0,e.SPARK]],h=[[550,e.FULL],[400,e.MEDIUM],[300,e.SMALL],[150,e.XSMALL],[0,e.SPARK]],i=f.length;return{LayoutMode:e,getLayoutMode:a,getLayoutModeKey:d,getHorizontalLayoutMode:c,getVerticalLayoutMode:b}}),define("objects.views/charts/components/chart-component",["../invalidatable","objects.views/charts/utils/transition-helper","general.utils/shapes/rect","objects.views/charts/shapes/arc","objects.utils/layout","core.utils/deferred","jquery"],function(a,b,c,d,e,f,g){"use strict";function h(a){if(this._$renderAreaWrap){this.containerRect=new c(this.rect.x*this.layoutToContainerRatios.x||1,this.rect.y*this.layoutToContainerRatios.y||1,this.rect.width*this.layoutToContainerRatios.x||1,this.rect.height*this.layoutToContainerRatios.y||1),this.container.style.left=this.containerRect.x+"px",this.container.style.top=this.containerRect.y+"px",this.container.style.width=this.containerRect.width+"px",this.container.style.height=this.containerRect.height+"px";var b=this.isVisible(a)&&0!==this.rect.width&&0!==this.rect.height?"block":"none";this.container.style.display!==b&&(this.container.style.display=b)}}function i(a,c){return b.checkEqual(a,c)}function j(a){return a?(a=a.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()}),a.replace(/^\-/,"")):""}return a.extend("ChartComponent",{init:function(a,d,e){this._super(),this.testId=e,this.options=g.extend(!0,{},{dock:"center",show:!0,relevantSize:0,showFlag:this.ShowFlags.SPARK,components:{}},d),this.rect=new c,this._transitionHelper=new b,this._transitionHelper.setTransitionCurve("easein"),this._oldProperties={},this._currentProperties={},this._transitionProperties={},this._useTransition=!1,this.outerRect=new c,this.containerRect=new c,this.layoutToContainerRatios={x:1,y:1},this.renderers={},this.dock=this.options.dock,this.show=this.options.show,this.isMini=this.options.isMini,this.relevantSize=this.options.relevantSize,this.showFlag=this.options.showFlag,this.layoutOrder=this.options.order||1,this.reductionOrder=this.options.reductionOrder,this.parentContainer=a,this.components=this.options.components,this.selectionIdentifier=this.options.label,this._selectionIndices=[0],this.chartFormatter=null,this.measureFormatters=[],this._globalAlpha=1,this._hasValidData=!1,this._createRenderArea();try{var f=d&&d.tcl?d.tcl:j(this.constructor.name);f&&this._$renderAreaWrap[0].setAttribute("tcl",f)}catch(a){}this.chartScale=1,this._edgeBleed={top:0,bottom:0,left:0,right:0}},ShowFlags:{SPARK:1,XSMALL:2,SMALL:4,MEDIUM:8,FULL:16},setData:function(a){return this._data=a,this.invalidateProperties("ChartComponent.setData")},getTransformedShape:function(a){var b,e=this.layoutToContainerRatios.x||1,f=this.layoutToContainerRatios.y||1;if(a instanceof c)b=new c(a.x*e,a.y*f,a.width*e,a.height*f);else if(a instanceof d){var g=a.getModelView(),h={x:a.cx*e,y:a.cy*f};g&&(h=g.transformPoint(h)),b=new d(h.x,h.y,Math.min(e,f)*a.innerRadius,Math.min(e,f)*a.radius,a.start,a.end,a.radianOffset)}return b},getTransformedPoint:function(a,b){return{x:a*this.layoutToContainerRatios.x||1,y:b*this.layoutToContainerRatios.y||1}},getOriginalPoint:function(a,b){return{x:a/this.layoutToContainerRatios.x||1,y:b/this.layoutToContainerRatios.y||1}},setLayoutMode:function(a){if(this._layoutMode!==a){this._layoutMode=a;var b=this._layoutMode?" qv-layout-"+e.getLayoutModeKey(a):"";this.container.className.match(/\s*qv-layout-\S+\s*/g)?this.container.className=this.container.className.replace(/\s*qv-layout-\S+/g,b):this.container.className+=b,this.invalidateDisplay("ChartComponent.setLayoutMode")}},getLayoutMode:function(){return this._layoutMode},setVerticalLayoutMode:function(a){this._verticalLayoutMode=a},setHorizontalLayoutMode:function(a){this._horizontalLayoutMode=a},setSelectableShapes:function(a){this._selectableShapes=a},getSelectableShapes:function(){return this._selectableShapes||[]},getSelectedCacheItems:function(){var a,b=this._selectableShapes?this._selectableShapes.length:0,c=[];for(a=0;a<b;a++)this._selectableShapes[a].selected&&c.push(this._selectableShapes[a]);return c},getRect:function(){return this.rect},setRect:function(a,b,c,d){this.rect.set(a,b,c,d)},setUseTransition:function(a){this._useTransition=a},getUseTransition:function(){return this._useTransition},getTransitionHelper:function(){return this._transitionHelper},setOuterRect:function(a,b,c,d){this.outerRect.set(a,b,c,d)},setLayoutToContainerRatios:function(a,b){this.layoutToContainerRatios={x:a,y:b}},setContainerRect:function(a,b,c,d){this.containerRect.set(a,b,c,d)},setSelectionIndices:function(a){if(!(a&&a instanceof Array))throw"invalid input, selectionsIndices has to be an Array";this._selectionIndices=a},getSelectionIndices:function(){return this._selectionIndices},setSelectionLocked:function(a){this._selectionLocked=a},isSelectionLocked:function(a){a=a||this._data;var b=this.getSelectionIndices();return a&&Array.isArray(b)&&b.length?!a.qHyperCube.qDimensionInfo.filter(function(a,c){return b.indexOf(c)!==-1},this).some(function(a){return a.qLocked!==!0}):this._selectionLocked},setYMirrorMode:function(a){this.yMirrorMode=a,this.readDirection=this.yMirrorMode?"rtl":"ltr"},setDock:function(a){switch(a){case"left":case"top":case"right":case"bottom":case"center":break;default:throw a+" invalid parameter"}this.options.dock=a,this.dock=a},getOppositeDock:function(){var a=this.options.dock;switch(a){case"left":return"right";case"top":return"bottom";case"right":return"left";case"bottom":return"top";case"center":return"center";default:throw a+" invalid parameter"}},isHorizontal:function(){switch(this.options.dock){case"top":case"bottom":return!0;default:return!1}},isVertical:function(){switch(this.options.dock){case"left":case"right":return!0;default:return!1}},showComponent:function(){if(this.show=this.options.show,this.renderers)for(var a in this.renderers)this.renderers[a].show()},hideComponent:function(){if(this.show=!1,this.renderers)for(var a in this.renderers)this.renderers[a].hide()},getFormatter:function(){return this._formatter||this.measureFormatters[0]||{format:function(a){return a.toString()}}},isVisible:function(a){void 0===a&&(a=this._layoutMode);var b=this.showFlag,c=a;return"object"==typeof b&&("whenVertical"in b&&(b=this.isVertical()?b.whenVertical:b.whenHorizontal),"vertical"in b)?this.show&&!!(b.vertical&this._verticalLayoutMode)&&!!(b.horizontal&this._horizontalLayoutMode):this.show&&!!(b&c)},setHasValidData:function(a){this._hasValidData=a},hasValidData:function(){return this._hasValidData},calculateRelevantSize:function(){this.relevantSize=this.options.relevantSize},reduceLayoutRect:function(a){switch(this.dock){case"top":a.y+=this.relevantSize,a.height-=this.relevantSize;break;case"bottom":a.height-=this.relevantSize;break;case"left":a.x+=this.relevantSize,a.width-=this.relevantSize;break;case"right":a.width-=this.relevantSize}},insertAdjacentTo:function(a,b){switch(this.dock){case"top":this.rect.x=a.x,this.rect.y=a.y-this.relevantSize,this.rect.width=a.width,this.rect.height=this.isVisible(this._layoutMode)?this.relevantSize:0,b&&(a.y-=this.relevantSize,a.height+=this.relevantSize);break;case"bottom":this.rect.x=a.x,this.rect.y=a.getBottom(),this.rect.width=a.width,this.rect.height=this.isVisible(this._layoutMode)?this.relevantSize:0,b&&(a.height+=this.relevantSize);break;case"left":this.rect.x=a.x-this.relevantSize,this.rect.y=a.y,this.rect.width=this.isVisible(this._layoutMode)?this.relevantSize:0,this.rect.height=a.height,b&&(a.x-=this.relevantSize,a.width+=this.relevantSize);break;case"right":this.rect.x=a.getRight(),this.rect.y=a.y,this.rect.width=this.isVisible(this._layoutMode)?this.relevantSize:0,this.rect.height=a.height,b&&(a.width+=this.relevantSize);break;case"center":this.rect.x=a.x,this.rect.y=a.y,this.rect.width=a.width,this.rect.height=a.height}},_updateProperties:function(){return this._transition()},_updateDisplay:function(){return this.hasValidData()?this.isVisible(this._layoutMode)&&this.rect.width>0&&this.rect.height>0?this.paint(this._layoutMode,this._data):f.resolve():this.clear()},updateSize:function(){h.call(this,this._layoutMode);for(var a in this.renderers)this.renderers[a].setDimensions(0,0,this.rect.width,this.rect.height),this.renderers[a].setDimensionsToContainerRatio(this.layoutToContainerRatios.x,this.layoutToContainerRatios.y);this._windowSizeMultiplier=Math.min(Math.min(this.rect.width,this.rect.height)/600,1)},_transition:function(){this._useTransition?i(this._currentProperties,this._transitionProperties)?this._onAnimatitonEnd():(this._inTransition=!0,this._transitionHelper.transition(this._oldProperties,this._currentProperties,this._transitionProperties,this._onAnimatitonEnd,this._updateDisplay,this)):(g.extend(this._currentProperties,this._transitionProperties),g.extend(this._oldProperties,this._transitionProperties),this.invalidateDisplay("onAnimatitonEnd"))},paint:function(){},setGlobalOpacity:function(a,b){this._globalAlpha=a,b||this.invalidateDisplay("ChartComponent.setGlobalOpacity")},_createRenderArea:function(){this.parentContainer&&(this.container=document.createElement("div"),this._$renderAreaWrap=g(this.container),this._$renderAreaWrap.attr("tid",this.testId),this._$renderAreaWrap.css({position:"absolute"}).addClass("qv-chart-component"),this.parentContainer.appendChild(this.container))},_onAnimatitonEnd:function(){this._inTransition=!1,this._oldProperties=g.extend(!0,{},this._transitionProperties),this.invalidateDisplay("onAnimatitonEnd")},release:function(){if(this._super(),this.renderers)for(var a in this.renderers)this.renderers[a].release();this.container=null,this._$renderAreaWrap=null,this._selectableShapes=null},clear:function(){var a=[];if(this.renderers)for(var b in this.renderers)a.push(this.renderers[b].clear());return f.all(a)},on:function(){this._on=!0},off:function(){this._on=!1}})}),define("general.utils/shapes/polygon",["general.utils/shapes/rect","general.utils/shapes/line"],function(a,b){"use strict";function c(b){var c,d,e=Number.MAX_VALUE,f=-Number.MAX_VALUE,g=Number.MAX_VALUE,h=-Number.MAX_VALUE,i=b?b.length:0;if(!i)return null;for(d=0;d<i;d++)c=b[d],f=c.x>f?c.x:f,e=c.x<e?c.x:e,h=c.y>h?c.y:h,g=c.y<g?c.y:g;return new a(e,g,f-e,h-g)}function d(){this._numPoints=this.points?this.points.length:0,this._closedPolygon=this._numPoints>1&&this.points[0].x===this.points[this._numPoints-1].x&&this.points[0].y===this.points[this._numPoints-1].y,this._closedPolygon?this._numLines=this._numPoints-1:this._numLines=this._numPoints,this._pointsChanged=!0}function e(a){0===arguments.length?this.set([]):this.set(a),this._pointsChanged=!0}return e.prototype={clone:function(){return new e(this.points.map(function(a){return a.clone()}))},set:function(a){this.points=a,d.call(this)},getPoints:function(){return this.points},getNumPoints:function(){return this.points?this.points.length:0},addPoint:function(a){this.points.push(a),d.call(this)},pointInside:function(a,b){if(this.calculateBounds(),!this._bounds)return!1;if(a<this._bounds.x||a>this._bounds.x+this._bounds.width||b<this._bounds.y||b>this._bounds.y+this._bounds.height)return!1;var c,d,e,f,g;for(c=!1,f=-1,d=this.points.length,e=d-1;++f<d;e=f){if(this.points[f].x===a&&this.points[f].y===b)return!0;if(this.points[f].y===this.points[e].y&&this.points[f].y===b&&(a-this.points[f].x)*(a-this.points[e].x)<=0)return!0;if(this.points[f].y<b&&b<=this.points[e].y||this.points[e].y<b&&b<=this.points[f].y){if(g=(this.points[e].x-this.points[f].x)*(b-this.points[f].y)/(this.points[e].y-this.points[f].y)+this.points[f].x,a===g)return!0;a<g&&(c=!c)}}return c},intersectsLine:function(a){if(!a)return!1;if(this.pointInside(a.x1,a.y1)||this.pointInside(a.x2,a.y2))return!0;var c,d;if(0===this._numPoints)return!1;if(1===this._numPoints)return!!a.intersectsLine(new b(this.points[0].x,this.points[0].y,this.points[0].x,this.points[0].y));for(d=this._numPoints-1,c=0;c<d;c++)if(a.intersectsLine(new b(this.points[c].x,this.points[c].y,this.points[c+1].x,this.points[c+1].y)))return!0;return!(this._closedPolygon||!a.intersectsLine(new b(this.points[d].x,this.points[d].y,this.points[0].x,this.points[0].y)))},intersectsLines:function(a){var b,c=a?a.length:0;for(b=0;b<c;b++)if(this.intersectsLine(a[b]))return!0;return!1},intersectsRect:function(a){if(!a)return!1;if(this.calculateBounds(),!this._bounds)return!1;if(a.rectInside(this._bounds))return!0;if(!this._bounds.intersectsWith(a))return!1;var c,d,e,f,g;return c=a.x,d=a.getRight(),e=a.y,f=a.getBottom(),!!(this.pointInside(c,e)||this.pointInside(d,e)||this.pointInside(d,f)||this.pointInside(c,f))||(g=[new b(c,e,d,e),new b(c,f,d,f),new b(c,e,c,f),new b(d,e,d,f)],this.intersectsLines(g))},calculateBounds:function(){return this._pointsChanged&&(this._bounds=c(this.points),this._pointsChanged=!1),this._bounds},getBoundingRect:function(){return this.calculateBounds()},translate:function(a,b){if(a||b){for(var c=0;c<this._numPoints;c++)this.points[c].x+=a,this.points[c].y+=b;this._pointsChanged=!0}},toString:function(){var a,b="",c=this._numPoints-1;for(a=0;a<c;a++)b+=this.points[a].toString()+",";return b+=this.points[c].toString()}},e}),define("objects.views/charts/shapes/polygon",["objects.views/charts/shapes/display-object","general.utils/shapes/polygon","general.utils/shapes/line"],function(a,b){"use strict";var c;return c=a.extend("Polygon",{init:function(a){this._super(),a?this.set(a):this._polygons=[]},getLocalBoundingRect:function(){var a;if(this._polygons&&this._polygons.length)return a=this._polygons.reduce(function(a,b){return a.combineWith(b.getBoundingRect())},this._polygons[0].getBoundingRect()),{x:a.x,y:a.y,width:a.width,height:a.height}},getLocalPoints:function(){return this._polygons&&this._polygons[0]?this._polygons[0].points:[]},getPartialFromRange:function(a,b){for(var d,e=0,f=[],g=this._polygons[0]?this._polygons[0].points:[],h=g.length,i=a<=b;e<h&&(i?g[e].x<a:g[e].x>a);)e++;for(e&&e<h&&(d=(a-g[e-1].x)/(g[e].x-g[e-1].x),f.push({x:a,y:g[e-1].y+d*(g[e].y-g[e-1].y),y_:g[e-1].y_+d*(g[e].y_-g[e-1].y_)}));e<h&&(i?g[e].x<b:g[e].x>b);)f.push({x:g[e].x,y:g[e].y,y_:g[e].y_}),e++;if(e&&e<h&&(d=(b-g[e-1].x)/(g[e].x-g[e-1].x),f.push({x:b,y:g[e-1].y+d*(g[e].y-g[e-1].y),y_:g[e-1].y_+d*(g[e].y_-g[e-1].y_)})),f.length)return new c(f)},set:function(a){var c=a&&a[0]&&Array.isArray(a[0])?a:[a];this._polygons=c.map(function(a){return new b(a)}),this.invalidateBounds()},intersectsLocalLine:function(a){return this._polygons.some(function(b){return b.intersectsLine(a)})},intersectsLocalRect:function(a){return this._polygons.some(function(c){return b.prototype.intersectsRect.call(c,a)})},containsPoint:function(a,b){return this._polygons.some(function(c){return c.pointInside(a,b)})}})}),define("objects.views/charts/utils/tree-node",["objects.views/charts/utils/node"],function(a){"use strict";var b;return a.extend("TreeNode",{addChild:function(c){if(!(c&&c instanceof a))throw new TypeError("Expecting a Node as argument, but got "+c);if(c===this)throw"Can not add itself as child!";if(c._children&&c._children.length&&this.ancestors.indexOf(c)>=0)throw"Can not add an ancestor as child!";return c._parent&&c._parent!==this&&c._parent.removeChild(c),b=this._children.indexOf(c),b>=0&&this._children.splice(b,1),this._children.push(c),c._parent=this,c._ancestors=null,this},addChildren:function(a){var b,c=a?a.length:0;for(b=0;b<c;b++)this.addChild(a[b]);return this},removeChild:function(a){return b=this._children.indexOf(a),b>=0&&(this._children.splice(b,1),a._parent=null,a._ancestors=null),this},removeChildren:function(a){var b,c;if(!this._children)return this;if(a)for(c=a.length,b=0;b<c;b++)this.removeChild(a[b]);else for(;this._children.length;)this.removeChild(this._children[0]);return this}})}),define("objects.views/charts/shapes/container",["objects.views/charts/shapes/display-object","objects.views/charts/utils/tree-node"],function(a,b){"use strict";return a.extend("Container",{init:function(){this._super()},addChild:function(a){b.prototype.addChild.call(this,a),this.doInvalidate&&a.invalidate()},addChildren:b.prototype.addChildren,removeChild:function(a){this.doInvalidate&&a.invalidate(),a._stage=null;var c,d=a.descendants,e=d?d.length:0;for(c=0;c<e;c++)d[c]._stage=null;return b.prototype.removeChild.call(this,a),this},removeChildren:function(a){var b,c,d,e,f;if(!this._children)return this;if(a)for(d=a.length,b=0;b<d;b++)this.removeChild(a[b]);else{for(d=this._children.length,b=0;b<d;b++)for(this._children[b]._parent=null,this._children[b]._ancestors=null,this._children[b]._stage=null,e=this._children[b].descendants,f=e?e.length:0,c=0;c<f;c++)e[c]._stage=null;this._children.length=0}return this},containsPoint:function(a,b){if(this._children&&this._children.length)for(var c=0,d=this._children.length;c<d;c++)if(this._children[c].containsPoint(a,b))return!0;return!1},intersectsLocalRect:function(a){if(this._children&&this._children.length)for(var b=0,c=this._children.length;b<c;b++)if(this._children[b].intersectsLocalRect(a))return!0;return!1},intersectsLocalLine:function(a){if(this._children&&this._children.length)for(var b=0,c=this._children.length;b<c;b++)if(this._children[b].intersectsLocalLine(a))return!0;return!1},getLocalPoints:function(){var a=[];if(this._children&&this._children.length)for(var b=0,c=this._children.length;b<c;b++)a=a.concat(this._children[b].getLocalPoints());return a},getLocalBoundingRect:function(){var a,b,c,d,e,f,g,h=!1;if(this._children&&this._children.length){for(f=0,g=this._children.length;f<g;f++)(e=this._children[f].getVisualBounds())&&!isNaN(e.width+e.height+e.x+e.y)&&(h?(a=Math.min(a,e.x),c=Math.max(c,e.x+e.width),b=Math.min(b,e.y),d=Math.max(d,e.y+e.height)):(a=e.x,c=e.x+e.width,b=e.y,d=e.y+e.height,h=!0));return h?{x:a,y:b,width:c-a,height:d-b}:void 0}},_calculateBounds:function(){var a=this._bounds,b=this.getLocalBoundingRect();b?(a.set(b.x,b.y,b.width,b.height),this._vmBounds.set(b.x,b.y,b.width,b.height),this._visualBounds.set(b.x-0,b.y-0,b.width+0,b.height+0)):(a.set(NaN,NaN,NaN,NaN),this._vmBounds.set(NaN,NaN,NaN,NaN),this._visualBounds.set(NaN,NaN,NaN,NaN)),this._dirtyBounds=!1}})}),define("objects.views/charts/renderers/stage",["objects.views/charts/shapes/container","general.utils/shapes/rect","core.utils/notification"],function(a,b,c){return a.extend("Stage",{init:function(){this._super(),this._stage=this,this._dimensions=new b(0,0,0,0),c.create(this,"Invalid")},invalidateObject:function(a){return this.Invalid.emit(a),this},destroy:function(){this._super(),c.release(this)}})}),define("objects.views/charts/renderers/renderer",["core.utils/class","objects.views/charts/renderers/stage","general.utils/shapes/rect","objects.views/charts/utils/node-selector"],function(a,b,c,d){"use strict";var e;return e=a.extend("Renderer",{init:function(){this._stage=new b,this._stageBinding=function(a){this.invalidateObject(a)}.bind(this),this._stage.Invalid.bind(this._stageBinding),this.scaling={x:1,y:1},this._size=new c,this._extendedSize=new c},find:function(a){return d.find(a,this._stage)},setDimensions:function(a,b,c,d){this._size.set(a,b,c,d)},setDimensionsToContainerRatio:function(a,b){this.scaling={x:a,y:b}},release:function(){this._stage&&this._stage.Invalid&&this._stage.Invalid.unbind(this._stageBinding),this._stage.destroy(),this._stageBinding=null},render:function(){},clear:function(){},invalidateObject:function(){}}),Object.defineProperties(e.prototype,{stage:{get:function(){return this._stage}}}),e}),define("objects.views/charts/shapes/rect",["objects.views/charts/shapes/display-object","general.utils/shapes/rect"],function(a,b){"use strict";var c;return c=a.extend("Rect",{init:function(a,c,d,e,f){this._super(),this._radius=f||0,b.apply(this,[a,c,d,e])},containsPoint:b.prototype.pointInside,intersectsLocalLine:b.prototype.intersectsLine,intersectsLocalRect:b.prototype.intersectsRect,getLocalBoundingRect:b.prototype.getBoundingRect,getLocalPoints:b.prototype.getPoints,set:function(a,c,d,e,f){b.prototype.set.apply(this,[a,c,d,e]),f>=0&&(this._radius=f),this.invalidateBounds()}}),Object.keys(b.prototype).forEach(function(a){!c.prototype.hasOwnProperty(a)&&["pointInside","intersectsLine","getBoundingRect","getPoints","intersectsRect"].indexOf(a)<0&&(c.prototype[a]=b.prototype[a])}),c}),define("objects.views/charts/renderers/canvas/rect",["objects.views/charts/shapes/rect"],function(a){"use strict";return{displayObject:a,render:function(a,b,c){if(this._radius){var d=this.x,e=this.y,f=this.width,g=this.height,h=Math.min(this._radius,f/2,g/2),i=d+f,j=e+g;a.beginPath(),a.moveTo(d+h,e),a.quadraticCurveTo(d,e,d,e+h),a.lineTo(d,j-h),a.quadraticCurveTo(d,j,d+h,j),a.lineTo(i-h,j),a.quadraticCurveTo(i,j,i,j-h),a.lineTo(i,e+h),a.quadraticCurveTo(i,e,i-h,e),a.lineTo(d+h,e),a.closePath(),b&&a.fill(),c&&a.stroke()}else b&&a.fillRect(this.x,this.y,this.width,this.height),c&&a.strokeRect(this.x,this.y,this.width,this.height)}}}),define("objects.views/charts/shapes/circle",["objects.views/charts/shapes/display-object","general.utils/shapes/circle"],function(a,b){"use strict";var c;return c=a.extend("Circle",{init:function(a,c,d){this._super(),b.apply(this,[a,c,d])},containsPoint:b.prototype.pointInside,intersectsLocalLine:b.prototype.intersectsLine,intersectsLocalRect:b.prototype.intersectsRect,getLocalPoints:b.prototype.getPoints,getLocalBoundingRect:function(){return{x:this.cx-this.r,y:this.cy-this.r,width:2*this.r,height:2*this.r}},set:function(){b.prototype.set.apply(this,[].slice.call(arguments)),this.invalidateBounds()}}),Object.keys(b.prototype).forEach(function(a){!c.prototype.hasOwnProperty(a)&&["pointInside","intersectsLine","getBoundingRect","getPoints","intersectsRect"].indexOf(a)<0&&(c.prototype[a]=b.prototype[a])}),c}),define("objects.views/charts/renderers/canvas/circle",["objects.views/charts/shapes/circle"],function(a){"use strict";return{displayObject:a,render:function(a,b,c){a.beginPath(),a.moveTo(this.cx+this.r,this.cy),a.arc(this.cx,this.cy,this.r,0,2*Math.PI,!1),b&&a.fill(),c&&a.stroke()}}}),define("objects.views/charts/shapes/line",["objects.views/charts/shapes/display-object","general.utils/shapes/line","util"],function(a,b,c){"use strict";var d;return d=a.extend("Line",{init:function(a,c,d,e){this._super(),b.apply(this,[a,c,d,e])},containsPoint:function(){return!1},intersectsLocalLine:b.prototype.intersectsLine,intersectsLocalRect:b.prototype.intersectsRect,getLocalPoints:b.prototype.getPoints,getLocalBoundingRect:function(){var a=Math.min(this.x1,this.x2),b=Math.max(this.x1,this.x2),c=Math.min(this.y1,this.y2);return{x:a,y:c,width:b-a,height:Math.max(this.y1,this.y2)-c}},set:function(){b.prototype.set.apply(this,[].slice.call(arguments)),this.invalidateBounds()},getPartialFromRange:function(a,b){if(!(b<this.x1||a>this.x2)){var e=this.x2-this.x1,f=this.y2-this.y1,g=a<=this.x1?0:(a-this.x1)/e,h=b>=this.x2?1:(b-this.x1)/e,i=new d(this.x1+g*e,this.y1+g*f,this.x1+h*e,this.y1+h*f);if(i.data=c.extend({},this.data),!isNaN(this.data.y1_)){var j=this.data.y2_-this.data.y1_;i.data.y1_=this.data.y1_+g*j,i.data.y2_=this.data.y1_+h*j}return i}}}),Object.keys(b.prototype).forEach(function(a){!b.prototype.hasOwnProperty(a)&&["pointInside","intersectsLine","getBoundingRect","getPoints","intersectsRect"].indexOf(a)<0&&(d.prototype[a]=b.prototype[a])}),d}),define("objects.views/charts/renderers/canvas/line",["objects.views/charts/shapes/line"],function(a){"use strict";return{displayObject:a,render:function(a,b,c){c&&(a.beginPath(),a.moveTo(this.x1,this.y1),a.lineTo(this.x2,this.y2),a.stroke())}}}),define("objects.views/charts/renderers/canvas/polygon",["objects.views/charts/shapes/polygon"],function(a){"use strict";return{displayObject:a,render:function(a,b,c){var d,e,f,g,h,i;for(a.beginPath(),h=0;h<this._polygons.length;h++){if(d=this._polygons[h].points,e=d?d.length:0,!(f=d[0]))return;for(i=f,a.moveTo(f.x,f.y),g=1;g<e;g+=1)f=d[g],a.lineTo(f.x,f.y);this.close===!1||!c||i.x===f.x&&i.y===f.y||a.lineTo(i.x,i.y)}this.close!==!1&&a.closePath(),b&&a.fill(),c&&a.stroke()}}}),define("objects.views/charts/renderers/canvas/arc",["objects.views/charts/shapes/arc"],function(a){"use strict";return{displayObject:a,render:function(a,b,c){a.beginPath(),0===this.innerRadius?(a.arc(this.cx,this.cy,this.radius,this.start+this.radianOffset,this.end+this.radianOffset,!1),a.lineTo(this.innerRadius*Math.cos(this.end+this.radianOffset)+this.cx,this.innerRadius*Math.sin(this.end+this.radianOffset)+this.cy)):this.end-this.start==2*Math.PI?(a.arc(this.cx,this.cy,this.radius,this.start+this.radianOffset,this.end+this.radianOffset,!1),a.moveTo(this.cx+this.innerRadius*Math.cos(this.radianOffset+this.start),this.cy+this.innerRadius*Math.sin(this.radianOffset+this.start)),a.arc(this.cx,this.cy,this.innerRadius,this.end+this.radianOffset,this.start+this.radianOffset,!0)):(a.arc(this.cx,this.cy,this.radius,this.start+this.radianOffset,this.end+this.radianOffset,!1),a.lineTo(this.innerRadius*Math.cos(this.end+this.radianOffset)+this.cx,this.innerRadius*Math.sin(this.end+this.radianOffset)+this.cy),a.arc(this.cx,this.cy,this.innerRadius,this.end+this.radianOffset,this.start+this.radianOffset,!0),a.lineTo(this.radius*Math.cos(this.start+this.radianOffset)+this.cx,this.radius*Math.sin(this.start+this.radianOffset)+this.cy)),b&&a.fill(),c&&(a.closePath(),a.stroke())}}}),define("objects.views/charts/shapes/text-helper",[],function(){function a(a,b,c,d){var e,f,g,i,j,k,l=a?a.split(/\n+|\r+|\r\n/):[],m=[],n=a?a.split(/\s+/):[],o=l[0];if("number"!=typeof b||b<=0)return[a];if("number"==typeof d&&l.length>=d)return l.slice(0,d);for(c&&(h.font=c),f=0;f<l.length;f++){for(k=l[f]||"",n=k.split(/\s+/),o=n[0],j="",e=1;e<n.length;e++)if(g=o+" "+n[e],i=h.measureText(g).width,i>b&&("number"!=typeof d||d>m.length)?(m.push(o),o=n[e]):o=g,"number"==typeof d&&m.length>=d){j=n.slice(e+1).join(" ");break}"number"!=typeof d||m.length<d?m.push(o):m[Math.max(0,m.length-1)]=(m[Math.max(0,m.length-1)]||"")+" "+o+" "+j}return m}function b(a,b,d,e,g){if(!a||!a.length)return[];d&&(h.font=d);var i,j,k,l,m=[],n=a.slice();if(n.filter(function(a){return!!a}),"number"!=typeof b||b<0)return a.slice();for(l=0;l<n.length;l++)k=n[l],j=null,k&&(k.length<=1||h.measureText(k).width<=b?m.push(k):(i=f(k,b,void 0,e-m.length),i.length<=1?m.push(i[0]):(j=i.pop(),m=m.concat(i),n[l+1]?h.measureText(j+" "+n[l+1]).width>b&&m.length+n.length-l<=e?n.splice(l+1,0,j):n[l+1]=j+" "+n[l+1]:n.push(j))));return m.forEach(function(a,b,c){c[b]=a?a.trim():a}),m.length>e?(m=m.splice(0,e),m[m.length-1]=c(m[m.length-1],b,d,g).text):(k=m[m.length-1])&&k.length>1&&h.measureText(k).width>b&&(m[m.length-1]=c(k,b,d,g).text),m}function c(a,b,c,d){var e,f,g,j,k=a,l=h.measureText("i").width,m=Math.ceil(b/l);if(d=d||i,c&&(h.font=c),a&&b){if(h.measureText(k).width>b){for(e=Math.min(m,k.length);e>0;e--)if(f=k.substring(0,e-1),g=f.trim()+d,h.measureText(g).width<=b){j=k.substring(e-1),k=g;break}e||(j=k,k=i)}}else j=void 0;return{text:k,rest:j}}function d(a){return"number"==typeof a&&isFinite(a)}function e(a,b,c,f){var g,i,k=a,l="",m=[];if(d(c)&&c<=1)return[a];var n=Math.ceil(b/f),o=Math.min(a.length,n);for(g=o;g>0&&(k=a.substring(0,g),i=a.substring(g-1,g)," "===i?k=a.substring(0,g-1):k+=j,l=a.substring(g),!(h.measureText(k).width<=b));g--);return(!g&&!k||h.measureText(k).width>b)&&(k=a.substring(0,1),l=a.substring(1)),m.push(k),l?(h.measureText(l).width>b?(l=e(l,b,c-1,f),m=m.concat(l)):m.push(l),m.filter(function(a){return""!==a.trim()})):m}function f(a,b,c,d){return a&&b?(c&&(h.font=c),e(a,b,d,Math.max(1,h.measureText("i").width))):[]}function g(c,d,e,f,g){var h;return isNaN(d)?[c]:(h=f>1?a(c,d,e,f):[c],h=b(h,d,e,f,g))}var h=document.createElement("canvas").getContext("2d"),i="…",j="-";return{lineWrap:a,wordWrap:b,splitWord:f,wrap:g,truncate:c}}),define("objects.views/charts/shapes/text",["objects.views/charts/shapes/display-object","objects.views/charts/shapes/text-helper","general.utils/shapes/line"],function(a,b,c){"use strict";function d(a){return 1.5*a.measureText("m").width}function e(a){f.font=this.font;var c,e=d(f),g=(this.lineHeightMultiplicator||1)*e,h="maxWidth"in this?this.maxWidth:this.width,i="maxHeight"in this?this.maxHeight:this.height,j=this.maxNumLines,k=[],l=0,m=[];return this.lineHeight=g,i<e?[]:(c=i?Math.max(1,Math.floor(i/g)):j||1,Array.isArray(j)?(j.forEach(function(a){l+=isNaN(a)||a<=0?0:a}),j.forEach(function(a){k.push(isNaN(a)||a<=0?c-l:a)})):k=[isNaN(j)||j<=0?c:Math.min(c,j)],Array.isArray(a)?a.forEach(function(a,d){m.length<c&&(m=m.concat(b.wrap(a,h,this.font,k[d])))},this):m=b.wrap(a,h,this.font,k[0],this.ellipsis),m)}var f=document.createElement("canvas").getContext("2d");return a.extend("Text",{init:function(){this._super(),this.options={},this.x=0,this.y=0,this.lineHeightMultiplicator=1,this._dirtyMeasures=!0,this._measures={numLines:0,width:0,height:0}},setText:function(a){return this.text=a,this.invalidateBounds(),this},tokenize:function(){return this.lines=e.apply(this,[this.text]),this},measure:function(){if(this.preRender(),this._dirtyMeasures){var a,b=0,c=this.lines;for(f.font!==this.font&&(f.font=this.font),a=0;a<c.length;a++)b=Math.max(b,f.measureText(c[a]).width);this._measures.numLines=c.length,this._measures.width=b,this._measures.height=c.length*this.lineHeight,this._dirtyMeasures=!1}return{numLines:this._measures.numLines,
width:this._measures.width,height:this._measures.height}},getHorizontalAnchor:function(){var a,b=this.x||0;if(this.width>0){if("center"===(a=this.attr("align")))return b+this.width/2;if("right"===a)return b+this.width}return b},getVerticalAnchorFirstLine:function(){var a,b=this.y||0,c=this.attr("baseline");return"middle"===c?(a=this.attr("lineHeight"),b-=(this.lines.length-1)*a/2,this.height>0&&(b+=this.height/2)):"bottom"===c&&(a=this.attr("lineHeight"),b-=(this.lines.length-1)*a,this.height>0&&(b+=this.height)),b},preRender:function(){var a,b="";Array.isArray(this.text)?this.text.forEach(function(a){b+=a+"__"}):b=this.text,a=this.attr("font"),this.font=a;var c=b+a+this.maxWidth+this.width+this.height;return c!==this._renderedID&&(this.tokenize(),this.invalidateBounds(),this._dirtyMeasures=!0,this._renderedID=c),this},getLocalBoundingRect:function(){var a=this.measure(),b=this.x,c=this.y,d=this.attr("align")||"left",e=this.attr("baseline")||"top";return this.height?"middle"===e?c+=this.height/2-a.height/2:"bottom"===e&&(c+=this.height-a.height):"middle"===e?c-=a.height/2:"bottom"===e&&(c-=a.height),this.width?"center"===d?b+=this.width/2-a.width/2:"right"===d&&(b+=this.width-a.width):"center"===d?b-=a.width/2:"right"===d&&(b-=a.width),{x:b,y:c,width:a.width,height:a.height}},containsPoint:function(a,b){var c=this.getLocalBoundingRect();return a>c.x&&a<c.x+c.width&&b>c.y&&b<c.y+c.height},getLocalPoints:function(){var a=this.getLocalBoundingRect();return[{x:a.x,y:a.y},{x:a.x+a.width,y:a.y},{x:a.x+a.width,y:a.y+a.height},{x:a.x,y:a.y+a.height}]},intersectsLocalRect:function(a){if(!a)return!1;var b=this.getLocalBoundingRect();return b.x<=a.x+a.width&&a.x<=b.x+b.width&&b.y<=a.y+a.height&&a.y<=b.y+b.height},intersectsLocalLine:function(a){if(this.containsPoint(a.x1,a.y1)||this.containsPoint(a.x2,a.y2))return!0;var b=this.getLocalBoundingRect();return a.intersectsLine(new c(b.x,b.y,b.x+b.width,b.y))||a.intersectsLine(new c(b.x+b.width,b.y,b.x+b.width,b.y+b.height))||a.intersectsLine(new c(b.x+b.width,b.y+b.height,b.x,b.y+b.height))||a.intersectsLine(new c(b.x,b.y+b.height,b.x,b.y))}})}),define("client.utils/rtl/rtl-util",["jquery"],function(a){function b(){return void 0===m&&h(),m}function c(a){return n.test(a)}function d(a){return o.test(a)||p.test(a)}function e(a){return q.test(a)}function f(a){var b,e,f=a?a.length:0;for(b=0;b<f;b++){if(e=a[b],c(e))return"ltr";if(d(e))return"rtl"}return"ltr"}function g(a){return m?"auto":f(a)}function h(){var a=document.createElement("div"),b=document.getElementsByTagName("body")[0];a.setAttribute("style","position: absolute; width: 1px; height: 1px; top: -999px; overflow: scroll; white-space:nowrap;"),a.setAttribute("dir","rtl"),b.appendChild(a),l=i(a),m=j(a),b.removeChild(a)}function i(a){a.innerHTML="RTL-SCROLL-TEST";var b="reverse";return a.scrollLeft>0?b="default":(a.scrollLeft=1,0===a.scrollLeft&&(b="negative")),b}function j(b){b.innerHTML="لا أحد يحب الألم بذاته، يسعى ورائه أو يبت";var c;switch(l){case"reverse":c=!1;break;case"default":c=b.scrollLeft>0;break;case"negative":a(b).scrollLeft(-1e3),c=b.scrollLeft<0;break;default:c=!1}return c}function k(a,b,c){return c=isNaN(c)?0:c,a&&"reverse"===l?b+c:b-c}var l,m,n=new RegExp("[A-Za-zªµºÀ-ÖØ-öø-ʸʻ-ˁː-ˑˠ-ˤˮͰ-ͳͶ-ͽΆΈ-ϵϷ-҂Ҋ-։ः-हऻऽ-ीॉ-ौॎ-ॐक़-ॡ।-ॿং-হঽ-ীে-ৌৎ-ৡ০-ৱ৴-৺ਃ-ਹਾ-ੀਖ਼-੯ੲ-ੴઃ-હઽ-ીૉ-ૌૐ-ૡ૦-૯ଂ-ହଽ-ାୀେ-ୌୗ-ୡ୦-୷ஃ-ிு-ௌௐ-௲ఁ-ఽు-ౄౘ-ౡ౦-౯౿-ಹಽ-ೋೕ-ೡ೦-ീെ-ൌൎ-ൡ൦-ෆා-ෑෘ-ะา-ำเ-ๆ๏-ະາ-ຳຽ-ໆ໐-༗༚-༴༶༸༾-ཬཿ྅ྈ-ྌ྾-࿅࿇-ာေးျ-ြဿ-ၗၚ-ၝၡ-ၰၵ-ႁႃ-ႄႇ-ႌႎ-ႜ႞-ፚ፠-ᎏᎠ-Ᏼᐁ-ᙿᚁ-ᚚᚠ-ᜑᜠ-ᜱ᜵-ᝑᝠ-ᝰក-ាើ-ៅះ-ៈ។-៚ៜ០-៩᠐-ᢨᢪ-ᤜᤣ-ᤦᤩ-ᤱᤳ-ᤸ᥆-᧚ᨀ-ᨖᨙ-ᩕᩗᩡᩣ-ᩤᩭ-ᩲ᪀-᪭ᬄ-ᬳᬵᬻᬽ-ᭁᭃ-᭪᭴-᭼ᮂ-ᮡᮦ-ᮧ᮪-ᯥᯧᯪ-ᯬᯮ᯲-ᰫᰴ-ᰵ᰻-᱿᳓᳡ᳩ-ᳬᳮ-ᶿḀ-ᾼιῂ-ῌῐ-Ίῠ-Ῥῲ-ῼ‎ⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎ-⅏Ⅰ-ↈ⌶-⍺⎕⒜-ⓩ⚬⠀-⣿Ⰰ-ⳤⳫ-ⳮⴀ-⵰ⶀ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ㆺㇰ-㈜㈠-㉏㉠-㉻㉿-㊰㋀-㋋㋐-㍶㍻-㏝㏠-㏾㐀-䶵一-ꒌꓐ-ꘌꘐ-ꙮꚀ-ꛯ꛲-꛷Ꜣ-ꞇ꞉-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠤꠧ꠰-꠷ꡀ-ꡳꢀ-ꣃ꣎-꣙ꣲ-ꤥ꤮-ꥆꥒ-ꥼꦃ-ꦲꦴ-ꦵꦺ-ꦻꦽ-ꨨꨯ-ꨰꨳ-ꨴꩀ-ꩂꩄ-ꩋꩍ-ꪯꪱꪵ-ꪶꪹ-ꪽꫀꫂ-ꯤꯦ-ꯧꯩ-꯬꯰-ﬗＡ-Ｚａ-ｚｦ-ￜ]"),o=new RegExp("[־׀׃׆א-״߀-ߪߴ-ߵߺ-ࠕࠚࠤࠨ࠰-ࡘ࡞‏יִײַ-ﬨשׁ-ﭏ]"),p=new RegExp("[؈؋؍؛-ي٭-ٯٱ-ەۥ-ۦۮ-ۯۺ-܍ܐܒ-ܯݍ-ޥޱﭐ-ﴽﵐ-﷼ﹰ-ﻼ]"),q=new RegExp('[\t-\r-"&-*;-@[-`{-~¡¦-©«-¬®-¯´¶-¸»-¿×÷ʹ-ʺ˂-ˏ˒-˟˥-˭˯-˿ʹ-͵;-΅·϶֊؆-؇؎-؏۞۩߶-߹௳-௸௺౸-౾༺-༽᎐-᎙᐀ ᚛-᚜៰-᠊᠎᥀-᥅᧞-᧿᾽᾿-῁῍-῏῝-῟῭-`´- ‐-\u2029‵-⁃⁅- ⁼-⁾₌-₎℀-℁℃-℆℈-℉℔№-℘℞-℣℥℧℩℺-℻⅀-⅄⅊-⅍⅐-⅟↉-∑∔-⌵⍻-⎔⎖-⒇⓪-⚫⚭-⟿⤀-⭙⳥-⳪⳹-⳿⸀-〄〈-〠〰〶-〷〽-〿゛-゜゠・㇀-㇣㈝-㈞㉐-㉟㉼-㉾㊱-㊿㋌-㋏㍷-㍺㏞-㏟㏿䷀-䷿꒐-꓆꘍-꘏꙳꙾-ꙿ꜀-꜡ꞈ꠨-꠫꡴-꡷﴾-﴿﷽︐-︙︰-﹏﹑﹔﹖-﹞﹠-﹡﹤-﹨﹫！-＂＆-＊；-＠［-｀｛-･￢-￤￨-�]'),r=String.fromCharCode(8206),s=String.fromCharCode(8207);return h(),{supportDirAuto:b,detectTextDirection:f,getAutoOrAlternativeDirection:g,isLtrChar:c,isRtlChar:d,isNeutralChar:e,lrm:r,rlm:s,scrollImplementation:l,getScrollPos:k}}),define("objects.views/charts/renderers/canvas/text",["objects.views/charts/shapes/text","client.utils/rtl/rtl-util"],function(a,b){"use strict";var c=!b.supportDirAuto();return{displayObject:a,render:function(a,d,e){var f,g,h,i=this.x||0,j=this.y||0,k=this.lines||[],l=k.length,m=[],n=this.lineHeight,o=a.textAlign,p="center"===o&&c;if(i=this.getHorizontalAnchor(),j=this.getVerticalAnchorFirstLine(),d&&m.push("fillText"),e&&(this.strokeFirst?m.unshift("strokeText"):m.push("strokeText")),m.length){for(f=0;f<l;f++)g=b.detectTextDirection(k[f]),a.canvas.dir=g,p&&"rtl"===g?(a.textAlign="left",h=i-a.measureText(k[f]).width/2):(a.textAlign=o,h=i),a[m[0]](k[f],h,j),m[1]&&a[m[1]](k[f],h,j),j+=n;a.textAlign=o}}}}),define("objects.views/charts/renderers/canvas-renderer",["jquery","core.utils/deferred","objects.views/charts/renderers/renderer","objects.views/charts/utils/matrix","objects.utils/animation-frame","general.utils/shapes/rect","objects.views/charts/renderers/canvas/rect","objects.views/charts/renderers/canvas/circle","objects.views/charts/renderers/canvas/line","objects.views/charts/renderers/canvas/polygon","objects.views/charts/renderers/canvas/arc","objects.views/charts/renderers/canvas/text"],function(a,b,c,d,e,f){"use strict";function g(a,b){w.length>100&&delete v[w.shift()],w.push(a),v[a]=b}function h(){var a={dfd:b(),state:u.PENDING};return a.dfd.promise.then(function(){a.state=u.RESOLVED},function(){a.state=u.REJECTED}),a}function i(a,b,c,d,e){return d+e*(a-b)/c}var j,k=1,l=[].slice.call(arguments,6),m={},n=l.length,o=document.createElement("canvas"),p=o.getContext("2d"),q=["fill","stroke","strokeWidth","opacity","font","align","baseline","lineJoin","lineCap"],r=new RegExp(q.join("|")),s=q.length,t={fill:"fillStyle",stroke:"strokeStyle",strokeWidth:"lineWidth",opacity:"globalAlpha",align:"textAlign",baseline:"textBaseline"},u={PENDING:0,RESOLVED:1,REJECTED:2},v={},w=[],x=0;return j=c.extend("CanvasRenderer",{init:function(b,c){this._super(),this._id=++x,this._canvas=document.createElement("canvas"),this._canvas.width=this._size.width,this._canvas.height=this._size.height,this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0",this._bufferCanvas=document.createElement("canvas"),this._bufferCanvas.width=this._canvas.width,this._bufferCanvas.height=this._canvas.height,this._mvMatrix=new d,this._wrapper=document.createElement("div"),this._wrapper.style.position="relative",this._wrapper.style.left="0",this._wrapper.style.top="0",this._wrapper.appendChild(this._canvas),c&&c.name&&a(this._wrapper).attr({tid:c.name}),a(this._wrapper).attr({tcl:"renderer"}).data("_renderer",this),this.container=b,this.container.appendChild(this._wrapper),this._isCompositingEnabled=!0,this._invalidObjects=[],this._transformMatrix=new d,this._storeNewImage=!0},setDimensions:function(a,b,c,d){this._super(a,b,c,d),this._wrapper.style.left=a+"px",this._wrapper.style.top=b+"px"},setCompositingEnabled:function(a){this._isCompositingEnabled=a},getCompositingEnabled:function(){return this._isCompositingEnabled},render:function(a){if(!this._rendering)return this._resetImage(),this._renderDfdObj&&this._renderDfdObj.state===u.PENDING||(this._renderDfdObj=h()),a?this._invalidate(!0,!1):(this._doClear=!1,this._doRender=!0,this._validate()),this._renderDfdObj.dfd.promise},clear:function(a){this._rendering||(a?this._invalidate(!1,!0):(this._doRender=!1,this._doClear=!0,this._validate()))},release:function(){this._super(),this._clearSchedule(),a(this._wrapper).removeData(),this._bufferCanvas=null,this._canvas=null,this.container&&(this.container.removeChild(this._wrapper),this.container=null)},invalidateObject:function(a){this._isCompositingEnabled&&this._invalidObjects.indexOf(a)<0&&this._invalidObjects.push(a),this.render(!0)},transformScene:function(a){return this._transformMatrix=a.clone(),this._invalidate(!0,!1),this},translateScene:function(a,b){return this._transformMatrix.translate(a,b),this._invalidate(!0,!1),this},scaleScene:function(a,b,c){return this._transformMatrix.translate(-a,-b),this._transformMatrix.scale(c,c),this._transformMatrix.translate(a,b),this._invalidate(!0,!1),this},setAttribute:function(a,b){var c;for(c in b)b.hasOwnProperty(c)&&(this._wrapper[a][c]=b[c])},getTextWidth:function(a,b){return j.getTextWidth(a,b,this._canvas.getContext("2d"))},getFontHeight:function(a){return j.getFontHeight(a,this._canvas.getContext("2d"))},_render:function(){if(this._canvas){this._rendering=!0;var a=this._canvas,b=a.getContext("2d"),c=this._mvMatrix,d=[],e=this._isCompositingEnabled&&!this._transformMatrix.isIdentity(),g=j.getDevicePixelToBackingStoreRatio();if(e&&this._storeNewImage&&(this._storeImage(),this._storeNewImage=!1),this._updateSize()||(this._isCompositingEnabled&&(d=this._getInvalidViews().filter(function(a){return!a.hasNaN()}),d.length&&e?d=[]:e&&(b.clearRect(0,0,a.width,a.height),d=d.concat(this._getInvalidImageParts()).filter(function(a){return!a.hasNaN()}))),d.length||b.clearRect(0,0,a.width,a.height)),b.save(),c.save(),this.stage.matrix&&this.stage.matrix.identity(),this.stage.scale(this.scaling.x,this.scaling.y),this.stage.translate(-this._extendedSize.x,-this._extendedSize.y),this.stage.translate(this._transformMatrix.elements[0][2],this._transformMatrix.elements[1][2]),b.setTransform(g,0,0,g,0,0),d.length&&(e&&(b.save(),b.setTransform(1,0,0,1,0,0),this._patchImage(),this._transformMatrix.identity(),b.restore()),b.beginPath(),d.forEach(function(a){b.rect(a.x,a.y,a.width,a.height)}),b.clip(),b.clearRect(0,0,this._extendedSize.width,this._extendedSize.height)),!d.length){var h=new f(0,0,this.scaling.x*this._extendedSize.width,this.scaling.y*this._extendedSize.height);d.push(h)}j._updateTransforms([this.stage],c,{}),j._renderDisplayObjects(b,[this.stage],!!this._isCompositingEnabled&&d,g),c.restore(),b.restore(),this._invalidObjects=[],this._rendering=!1}},_updateSize:function(){var a,b,c,d=this._canvas,e=j.getDevicePixelToBackingStoreRatio(),g=this._extendedSize;return this.edgeBleed?g.set(-this.edgeBleed.left,-this.edgeBleed.top,this._size.width+this.edgeBleed.left+this.edgeBleed.right,this._size.height+this.edgeBleed.top+this.edgeBleed.bottom):g.set(this._size.x,this._size.y,this._size.width,this._size.height),c=new f(Math.round(g.x*this.scaling.x),Math.round(g.y*this.scaling.y),Math.round(g.width*this.scaling.x),Math.round(g.height*this.scaling.y)),a=Math.round(e*c.width),b=Math.round(e*c.height),this._canvas.style.left=c.x+"px",this._canvas.style.top=c.y+"px",(d.width!==a||d.height!==b)&&(d.width=a,d.height=b,d.style.width=c.width+"px",d.style.height=c.height+"px",this._bufferCanvas.width=a,this._bufferCanvas.height=b,!0)},_invalidate:function(a,b){if(this._doRender=a||this._doRender,this._doClear=b||this._doClear,!this._invalidated){var c=this;this._invalidated=!0,this._timer=e.request(function(){c._validate()},this._canvas)}},_validate:function(){this._doClear&&!this._doRender?this._clear():this._doRender&&this._render(),this._renderDfdObj&&this._renderDfdObj.state===u.PENDING&&this._renderDfdObj.dfd.resolve(),this._clearSchedule()},_clear:function(){this._canvas&&(this._canvas.width=this._canvas.width)},_clearSchedule:function(){this._timer&&(e.cancel(this._timer),this._timer=null),this._renderDfdObj&&this._renderDfdObj.state===u.PENDING&&this._renderDfdObj.dfd.reject(),this._doRender=!1,this._doClear=!1,this._invalidated=!1},_getInvalidViews:function(){var a,b,c,d,e,g,h,i,j,k,l,m=this._invalidObjects?this._invalidObjects.length:0,n=new f,o=!1,p=!1,q=new f;for(a=0;a<m;a++)b=this._invalidObjects[a].getVisualBounds(),c=this._invalidObjects[a].rData.oldVisualBounds,!o&&b?(d=b.x,g=b.x+b.width,e=b.y,h=b.y+b.height,o=!0):b&&(d=Math.min(d,b.x),g=Math.max(g,b.x+b.width),e=Math.min(e,b.y),h=Math.max(h,b.y+b.height)),!p&&c?(i=c.x,k=c.x+c.width,j=c.y,l=c.y+c.height,p=!0):c&&(i=Math.min(i,c.x),k=Math.max(k,c.x+c.width),j=Math.min(j,c.y),l=Math.max(l,c.y+c.height));return n.set(Math.floor(d)-1,Math.floor(e)-1,Math.ceil(g-d)+2,Math.ceil(h-e)+2),q.set(Math.floor(i)-1,Math.floor(j)-1,Math.ceil(k-i)+2,Math.ceil(l-j)+2),n.x!==q.x||n.y!==q.y||n.width!==q.width||n.height!==q.height?[n,q]:[n]},_getInvalidImageParts:function(){var a=[],b=this._transformMatrix.elements[0][0],c=this._transformMatrix.elements[0][2],d=this._transformMatrix.elements[1][2];return b&&b>1?a.push(new f(0,0,0,0)):b&&b<1?a.push(new f(0,0,0,0)):(0!==c&&this._size.width>Math.abs(c)&&a.push(new f(c>0?0:this._size.width+c,0,Math.abs(c),this._size.height)),0!==d&&this._size.height>Math.abs(d)&&a.push(new f(0,d>0?0:this._size.height+d,this._size.width,Math.abs(d)))),a},_storeImage:function(){var a=this._bufferCanvas.getContext("2d");a.clearRect(0,0,this._bufferCanvas.width,this._bufferCanvas.height),a.drawImage(this._canvas,0,0)},_patchImage:function(){var a=j.getDevicePixelToBackingStoreRatio(),b=this._transformMatrix.elements[0][0];if(1!==b){var c,d,e,f,g,h,k,l,m={x:0,y:this._size.height},n={x:this._size.width,y:0},o=this._transformMatrix.transformPoint(m),p=this._transformMatrix.transformPoint(n),q=p.x-o.x,r=p.y-o.y,s=o.x/q,t=p.y/r;if(b>1?(k=0,l=0,c=this._size.width,d=this._size.height,e=-s*this._size.width,f=t*this._size.height,g=this._size.width/b,h=this._size.height/b):(e=0,f=0,g=this._size.width,h=this._size.height,c=this._size.width*b,d=this._size.height*b,k=s*c,l=-t*d),g*=a,h*=a,e*=a,f*=a,k*=a,l*=a,c*=a,d*=a,e>this._bufferCanvas.width||e+g<0||f>this._bufferCanvas.height||f+h<0)this._canvas.getContext("2d").drawImage(this._bufferCanvas,0,0,0,0,0,0,0,0);else{var u,v,w,x,y,z,A,B,C,D,E,F;u=Math.max(e,0),v=Math.min(e+g,this._bufferCanvas.width),w=i(u,e,g,k,c),x=i(v,e,g,k,c),C=v-u,E=x-w,y=Math.max(f,0),z=Math.min(f+h,this._bufferCanvas.height),A=i(y,f,h,l,d),B=i(z,f,h,l,d),D=z-y,F=B-A,this._canvas.getContext("2d").drawImage(this._bufferCanvas,u,y,C,D,w,A,E,F)}}else this._canvas.getContext("2d").drawImage(this._bufferCanvas,this._transformMatrix.elements[0][2]*a,this._transformMatrix.elements[1][2]*a)},_resetImage:function(){this._transformMatrix.identity(),this._storeNewImage=!0}}),j.getFontHeightOfContext=function(a){return 1.5*a.measureText("m").width},j.getFontHeight=function(a,b){if("string"!=typeof a)throw new Error("CanvasRenderer.getFontHeight(): Input font is not a string");if(a in v)return v[a];var c;return b=b||p,b.font!==a?(b.save(),b.font=a,c=1.5*b.measureText("m").width,b.restore()):c=1.5*b.measureText("m").width,g(a,c),c},j.getTextWidth=function(a,b,c){var d;return c=c||p,c.save(),c.font=b,d=void 0!==a?Math.ceil(c.measureText(a).width):0,c.restore(),d},j.getDevicePixelToBackingStoreRatio=function(){return(window.devicePixelRatio||1)/(p.webkitBackingStorePixelRatio||p.mozBackingStorePixelRatio||p.msBackingStorePixelRatio||p.oBackingStorePixelRatio||p.backingStorePixelRatio||1)},j.measureText=function(a,b,c){var d,e;return c=c||p,b&&c.font!==b&&(c.save(),c.font=b),e=c.measureText(a).width,b in v?d=v[b]:(d=1.5*c.measureText("m").width,g(b,d)),b&&c.restore(),void 0!==a?{width:e,height:d}:{width:0,height:0}},j._renderDisplayObjects=function(a,b,c,d){var e,f,g,h,i,k,l=c?c.length:0,m=[],n=!0,o=[];for(f=b?b.length:0,e=0;e<f;e++)if(g=b[e],g.visible!==!1&&g.data.isVisible!==!1){if(l){for(n=!1,i=0;i<l;i++)if(c[i].intersectsWith(g.getVisualBounds())){n=!0;break}if(!n)continue}h=j._getRenderFn(b[e]),k=g.children.length>0,("function"==typeof h||k)&&(g.zIndex>0?(m[g.zIndex]||(m[g.zIndex]={index:g.zIndex,objects:[]}),m[g.zIndex].objects.push({object:g,renderFn:h,hasChildren:k})):j._renderObject(a,g,h,k,c,d))}for(m=m.filter(function(a){return a&&a.objects.length}).sort(function(a,b){return a.index-b.index}),e=0;e<m.length;e++)for(o=m[e].objects,f=o.length,i=0;i<f;i++)j._renderObject(a,o[i].object,o[i].renderFn,o[i].hasChildren,c,d)},j._renderObject=function(a,b,c,d,e,f){var g,h,i,k,l;"function"==typeof c&&(h=b.attr("strokeWidth"),void 0===h&&(h=1),i=!!b.attr("fill"),k=!!b.attr("stroke")&&h>0),a.save(),b.rData.stroke=k,b.rData.strokeWidth=h,e&&(l=b.getVisualBounds(),b.rData.oldVisualBounds={x:l.x,y:l.y,width:l.width,height:l.height}),j._applyAttributes(a,b),b.rData.vmTransform&&(g=b.rData.vmTransform,a.setTransform(f*g[0][0],f*g[1][0],f*g[0][1],f*g[1][1],f*g[0][2],f*g[1][2])),b.clip&&(a.beginPath(),a.rect(b.clip.x,b.clip.y,b.clip.width,b.clip.height),a.clip()),(i||k)&&(b.preRender&&b.preRender(),c.apply(b,[a,i,k])),d&&j._renderDisplayObjects(a,b.children,e,f),a.restore()},j._registerRenderFn=function(a,b){var c;if("function"!=typeof a)throw new TypeError("First parameter must be a function");c="function"!=typeof b&&"function"==typeof b.constructor?b.constructor:b,c.__renderFnId="_"+k++,m[c.__renderFnId]=a},j._getRenderFn=function(a){var b=a.__renderFnId||(a.constructor?a.constructor.__renderFnId:void 0);if(b)return m[b];for(var c=0;c<n;c++)if(l[c].displayObject===a.constructor)return j._registerRenderFn(l[c].render,a),l[c].render;for(c=0;c<n;c++)if(a instanceof l[c].displayObject)return j._registerRenderFn(l[c].render,a),l[c].render;a.constructor.__renderFnId="does not exist"},j._updateTransforms=function(a,b,c){var d,e,f,g,h,i={},k=a?a.length:0;for(h in c)r.test(h)&&(i[h]=c[h]);for(d=0;d<k;d++){e=a[d],e.clearModelView(),e.matrix&&(b.save(),b.multiply(e.matrix),e.rData.vmTransform=b.elements,e.rData.dirtyVMTransform=!0),e.rData.inherited={};for(h in i)e.rData.inherited[h]=i[h];if((g=e.children)&&g.length){for(f=0;f<s;f++)e.hasOwnProperty(q[f])&&(i[h]=e[h]);j._updateTransforms(g,b,i)}e.matrix&&b.restore()}},j.Gradient={LINEAR:0,RADIAL:1},j._applyAttributes=function(a,b){var c,d;for(d=0;d<s;d++)(c=q[d])in b&&void 0!==b[c]&&(("fill"===c||"stroke"===c)&&b[c]&&b[c].gradient?b[c].gradient.r?a[t[c]]=j._createGradient(a,b[c].gradient,j.Gradient.RADIAL)||"#000000":a[t[c]]=j._createLinearGradient(a,b[c].gradient)||"#000000":a[t[c]||c]=b[c])},j._createLinearGradient=function(a,b){return j._createGradient(a,b,j.Gradient.LINEAR)},j._createGradient=function(a,b,c){var d,e,f;if(!(isNaN(b.x0)||isNaN(b.y0)||isNaN(b.x1)||isNaN(b.y1))){for(d=c===j.Gradient.RADIAL?a.createRadialGradient(b.x0,b.y0,0,b.x1,b.y1,b.r):a.createLinearGradient(b.x0,b.y0,b.x1,b.y1),f=b.limits.length,e=0;e<f;e++)d.addColorStop(b.limits[e],b.colors[e]);return d}},j.registerRenderObject=function(a){l.push(a),n=l.length},j}),define("extensions.qliktech/barchart/layers/bar-helpers",["objects.views/charts/shapes/rect"],function(a){"use strict";function b(a,b,c,d,e,f,g){var h,i;return f?(h=b,i=c,c=e,b=d,e=h,d=i,c<b&&(h=c,c=b,b=h),b=Math.max(g.x,Math.min(g.x+g.width,b)),c=Math.max(g.x,Math.min(g.x+g.width,c))):(d<e&&(h=e,e=d,d=h),d=Math.max(g.y,Math.min(g.y+g.height,d)),e=Math.max(g.y,Math.min(g.y+g.height,e))),a.set(b,e,c-b,d-e),a}function c(a,b,c,d){var e=[{x:a.x,y:a.y},{x:a.x,y:a.y+a.height},{x:a.x+a.width,y:a.y+a.height},{x:a.x+a.width,y:a.y}];switch(b){case"left":d?e[0].x-=c:e[1].x+=c;break;case"right":d?e[2].x+=c:e[3].x-=c;break;case"top":d?e[3].y-=c:e[0].y+=c;break;case"bottom":d?e[1].y+=c:e[2].y-=c}return e}function d(b,d,e){var f,g=e.pad,h=e.gap,i=e.sharpness,j=b.clone(),k=c,l=[];return"right"===d?(f=new a(j.x+j.width+h,j.y,g-h,j.height),l.push(k(j,"right",i,!0)),l.push(k(f,"left",i,!1,!0)),b.width+=f.width+h):"left"===d?(f=new a(0,j.y,g-h,j.height),l.push(k(j,"left",i,!0)),l.push(k(f,"right",i,!1,!0)),b.x=f.x,b.width+=f.width+h):"down"===d?(f=new a(j.x,j.y+j.height+h,j.width,g-h),l.push(k(j,"bottom",i,!0)),l.push(k(f,"top",i,!1,!0)),b.height+=f.height+h):"up"===d&&(f=new a(j.x,0,j.width,g-h),l.push(k(j,"top",i,!0)),l.push(k(f,"bottom",i,!1,!0)),b.y=f.y,b.height+=f.height+h),l}function e(a,b,c){a.set(d(a.data.hitRect,b,c))}function f(a,b,c){a.set(h(a.data.hitRect,b,c))}function g(a,b,c,d,e){var f=[];return"left"===e?(f.push({x:a,y:b+c/2}),f.push({x:a,y:b-c/2}),f.push({x:a-d,y:b})):"right"===e?(f.push({x:a,y:b+c/2}),f.push({x:a,y:b-c/2}),f.push({x:a+d,y:b})):"up"===e?(f.push({x:a-c/2,y:b}),f.push({x:a+c/2,y:b}),f.push({x:a,y:b-d})):"down"===e&&(f.push({x:a-c/2,y:b}),f.push({x:a+c/2,y:b}),f.push({x:a,y:b+d})),f}function h(a,b,c){var d,e,f;return f=Math.min(a[["left","right"].contains(b)?"height":"width"]/2,8),e=Math.min(f,8),"left"===b?(d=g(c.x+e,a.y+a.height/2,f,e,b),a.width+=e):"right"===b?(d=g(c.x+c.width-e-1,a.y+a.height/2,f,e,b),a.width+=e,a.x-=e):"up"===b?(d=g(a.x+a.width/2,c.y+e,f,e,b),a.height+=e):"down"===b&&(d=g(a.x+a.width/2,c.y+c.height-e-1,f,e,b),a.height+=e,a.y-=e),d}return{updateRectangle:b,getSpike:d,getSlicedPolygon:c,getHint:h,updateSpike:e,updateHint:f}}),define("extensions.qliktech/barchart/layers/bar-layer",["core.utils/class","general.utils/shapes/rect","objects.views/charts/shapes/polygon","objects.views/charts/renderers/canvas-renderer","client.utils/property-resolver","extensions.qliktech/barchart/layers/bar-helpers"],function(a,b,c,d,e,f){"use strict";function g(){var a,d,e,g,h,i,j,k,l,m,n,o,p,q=this.style.shape,r=new b(0,0,0,0),s=this.widthRatio,t=this.isSpikingEnabled,u=this.isHintingEnabled,v=[],w=this.majorAxis.isDiscrete(),x=this.majorAxis.getDiscreteSpacing()*s,y=this.minorAxis.getPlotMax(),z=this.minorAxis.getPlotMin(),A=!this.majorAxis.isVertical(),B=this.minorAxis.getPadding(),C=this.minorAxis.getPositionOfValue(0)-1,D={pad:A?B.top:B.right},E={pad:A?B.bottom:B.left},F=new b;D.gap=.3*D.pad,D.sharpness=.3*D.pad,E.gap=.3*E.pad,E.sharpness=.3*E.pad,F.set(B.left,B.top,this.rect.width-B.left-B.right,this.rect.height-B.top-B.bottom),this._bounds=F;var G=A?this.rect.width:this.rect.height,H=A?this.rect.height:this.rect.width;if(k=this.shapes?this.shapes.length:0,this.isNumeric){w=!1;var I=this.majorAxis._scale.plotRange/(this.majorAxis._scale._dataMax-this.majorAxis._scale._dataMin),J=this.majorAxis._scale._plotSize/90;p=Math.max(J-Math.pow(I,.25)*J,2),isNaN(p)&&(p=2)}for(l=0;l<k;l++)if(i=this.shapes[l],o=i instanceof c||"Polygon"===i.type,j=this.isNumeric?this.majorAxis.getPositionOfValue(i.data.axisNum):this.majorAxis.getPositionOfId(i.data.axisId),h=w?x:p||this.majorAxis.getWidthOfId(i.data.axisId)*s,i.data.isNaN||isNaN(i.data.value)?(i.data.isNaN=!0,e=g=C):(e=this.minorAxis.getPositionOfValue(i.data.start)-1,g=this.minorAxis.getPositionOfValue(i.data.end)-1),a=j-h/2,d=j+h/2,f.updateRectangle(i.data.hitRect,a,d,e,g,!A,F),delete i.data.labelRect,delete i.data.isCutOff,delete i.data.hintDirection,d<0||a>G)i.data.isVisible=!1;else{i.data.isVisible=!0,o?i.set(i.data.hitRect.getPoints()):i.set(i.data.hitRect.x,i.data.hitRect.y,i.data.hitRect.width,i.data.hitRect.height),r.set(i.data.hitRect.x,i.data.hitRect.y,i.data.hitRect.width,i.data.hitRect.height),v.push(i),m=i.data.cacheItem;var K=m.selected;if(i.data.isFakeOtherCell&&i.data.highlightOnGroupSelect&&m.children[0].selected){K=!0;for(var L=0;L<m.children.length;L++)if(!m.children[L].selected){K=!1;break}}this.isNumeric&&this.selectedRanges&&!K&&(K=this.selectedRanges.some(function(a){return i.data.axisNum>=a.min&&(a.maxIncluded?i.data.axisNum<=a.max:i.data.axisNum<a.max)})),n=K&&h>6?q.selected:{border:{color:0,width:0}},i.stroke=n.border.color,i.fill=i.data.isFakeOtherCell?this.othersFillPattern:i.data.fill,i.strokeWidth=n.border.width,i.opacity=K?1:this._globalAlpha;var M=!!u&&this._getHint(e,g,F,A),N=!(!o||M||!t)&&this._getSpike(i.data.end,e,g,F,A,z,y);N?(i.data.labelRect=r.clone(),f.updateSpike(i,A?i.data.end>=0?"up":"down":i.data.end>=0?"right":"left",i.data.end>=0?D:E),i.data.isCutOff=!0):M?(i.fill=q.outOfRange.color,f.updateHint(i,M,F),i.data.hintDirection=M):(e<-1&&g<-1||e>H&&g>H)&&(i.data.isVisible=!1)}this.nodesInView=v}return a.extend("BarLayer",{init:function(a){this.renderer=new d(a,{name:"bar-layer"}),this.widthRatio=.7,this.isSpikingEnabled=!1,this.isHintingEnabled=!1,this.shapes=[],this._globalAlpha=1},release:function(){this.renderer.release(),this.shapes=null,this.minorAxis=null,this.majorAxis=null},update:function(){g.call(this)},render:function(){return this.renderer.render()},clear:function(){this.renderer.clear()},_getStyle:function(a){return{selected:{border:{color:e.getValue(a,"shape.selected.border.color","rgba(0,0,0,0.25)"),width:e.getValue(a,"shape.selected.border.width",1)}}}},_getHint:function(a,b,c,d){if(d){if(b+1<c.y&&a+1<=c.y)return"up";if(b+1>c.y+c.height&&a+1>=c.y+c.height)return"down"}else{if(b+1<c.x&&a+1<=c.x)return"left";if(b+1>c.x+c.width&&a+1>=c.x+c.width)return"right"}return!1},_getSpike:function(a,b,c,d,e,f,g){var h=a>g,i=a<f;return e?(h=h&&c<d.y&&b>d.y,i=i&&c>d.y+d.height&&b<d.y+d.height):(h=h&&c>d.x+d.width&&b<d.x+d.width,i=i&&c<d.x&&b>d.x),h||i}})}),define("objects.views/charts/utils/canvas-renderer",["core.utils/class","general.utils/shapes/rect","objects.utils/animation-frame","jquery","./matrix","core.utils/deferred","client.utils/rtl/rtl-util"],function(a,b,c,d,e,f,g){"use strict";function h(a,b){A.length>100&&delete z[A.shift()],A.push(a),z[a]=b}function i(a){if(a.font in z)return z[a.font];var b=1.5*a.measureText("m").width;return h(a.font,b),b}function j(a,b,c,d,e){var f,g,h=b.shape.points,i=h?h.length:0;if(a.beginPath(),f=h[0]){for(a.moveTo(f.x,f.y),g=1;g<i;g+=1)f=h[g],a.lineTo(f.x,f.y);e&&a.closePath(),c&&a.fill(),d&&a.stroke()}}function k(a,b,c){var d,e,f,g=a?a.replace(/^\s*|\s*$/,"").split(" "):[],h=[],i=g[0];if(!i)return[];for(d=1;d<g.length;d++)e=i+" "+g[d],f=v.measureText(e).width,f>b&&c>h.length?(h.push(i),i=g[d]):i=e;return h.length<c?h.push(i):h[Math.max(0,h.length-1)]?h[Math.max(0,h.length-1)]+=" "+i:h[Math.max(0,h.length-1)]=" "+i,h}function l(a,b,c){if(void 0!==a){var d,e,f,g,h,i,j,k,l=v.measureText("i").width;for(d=0;d<a.length;d++){if(e=a[d],j=Math.ceil(Math.max(0,b/l))+1,j<e.length?(g=e.slice(j),e=e.slice(0,j)):g="",f=e,e&&e.length>1&&v.measureText(e).width>b){for(h=!1,i=e.length;i>0;i--)if(f=f.substring(0,f.length-1),k=f+(d+1<c?"-":"…"),v.measureText(k).width<b){g=e.substring(i-1)+g,e=k,h=!0;break}h||(g=e.substring(1),e=e.substring(0,1)),h||i||(g="",e="…")}a[d]=String(e).trim(),g&&d<a.length-1?a[d+1]=g+" "+a[d+1]:g&&a.length<c&&a.push(g)}}}function m(a,b,c){var d,e=c.maxWidth;return isNaN(e)?[a]:(d=b>1?k(a,e,b):[a],l(d,e,b),d)}function n(a,b,c){var d,e,f,h,j=b.text,k=(b.lineHeight||1)*i(a),l="maxWidth"in b?b.maxWidth:b.width,n="maxHeight"in b?b.maxHeight:b.height,o=b.width,p=b.height,q=b.maxNumLines,r=b.x||0,s=b.y||0,t=a.textAlign,u="center"===t&&B;if(v.font=a.font,isNaN(q)&&(q=n?Math.max(1,Math.floor(n/k)):1),d=m(j,q,{maxWidth:l,maxHeight:n}),c){for(o=0,e=0;e<d.length;e++)o=Math.max(o,a.measureText(d[e]).width);return{lines:d,numLines:d.length,width:o,height:d.length*k,truncated:Array.isArray(/…$/.exec(d[d.length-1]))}}for("middle"===a.textBaseline?void 0!==p?s+=p/2:d.length&&(s-=(d.length-1)*k/2):"bottom"===a.textBaseline&&(void 0!==p?s+=p:s-=(d.length-1)*k),"center"===a.textAlign&&o?r+=o/2:"right"===a.textAlign&&o&&(r+=o),e=0;e<d.length;e++)f=g.detectTextDirection(d[e]),a.canvas.dir=f,u&&"rtl"===f?(a.textAlign="left",h=r-a.measureText(d[e]).width/2):(a.textAlign=t,h=r),a.canvas.dir=g.detectTextDirection(d[e]),a.fillText(d[e],h,s),s+=k;a.textAlign=t}function o(a,b,c,d,e,f){var g,h,i,j,k,l,m;for(g=0;g<c.length;g+=1)if(j=c[g]){if(a.save(),i=j.transform,i&&(b.save(),b.multiply(i)),"opacity"in j&&(a.globalAlpha=j.opacity),j.fill)if(j.fill.gradient){if(m=j.fill.gradient,isNaN(m.x0)||isNaN(m.y0)||isNaN(m.x1)||isNaN(m.y1))return;for(l=a.createLinearGradient(m.x0,m.y0,m.x1,m.y1),h=0;h<m.limits.length;h++)l.addColorStop(m.limits[h],m.colors[h]);a.fillStyle=l}else a.fillStyle=j.fill;if(j.stroke&&0!==j.strokeWidth){if(j.stroke.gradient){for(m=j.stroke.gradient,l=a.createLinearGradient(m.x0,m.y0,m.x1,m.y1),h=0;h<m.limits.length;h++)l.addColorStop(m.limits[h],m.colors[h]);a.strokeStyle=l}else a.strokeStyle=j.stroke;a.lineWidth=j.strokeWidth||1,d>1&&"polygon"!==j.type&&(a.lineWidth/=d)}j.lineJoin&&(a.lineJoin=j.lineJoin),j.lineCap&&(a.lineCap=j.lineCap),k=b.elements,"group"===j.type?(b.save(),j.clip&&(a.beginPath(),a.setTransform(k[0][0],k[1][0],k[0][1],k[1][1],k[0][2],k[1][2]),a.rect(j.clip.rect.x,j.clip.rect.y,j.clip.rect.width,j.clip.rect.height),a.clip()),o(a,b,j.children,void 0,!!j.fill||!!e,!!j.stroke&&0!==j.strokeWidth||!!f),b.restore()):j.type in s&&(a.setTransform(k[0][0],k[1][0],k[0][1],k[1][1],k[0][2],k[1][2]),s[j.type](a,j,!!j.fill||!!e,!!j.stroke&&0!==j.strokeWidth||!!f)),a.globalAlpha=1,i&&b.restore(),a.restore()}}function p(a,b,c){if(c){var d=b.elements;switch(c.type){case"clip":a.save(),a.setTransform(d[0][0],d[1][0],d[0][1],d[1][1],d[0][2],d[1][2]),a.beginPath(),a.rect(c.rect.x,c.rect.y,c.rect.width,c.rect.height),a.clip()}}}function q(a,b){b&&a.restore()}var r,s,t=window.devicePixelRatio||1,u=document.createElement("canvas"),v=u.getContext("2d"),w=document.createElement("span"),x=v.webkitBackingStorePixelRatio||v.mozBackingStorePixelRatio||v.msBackingStorePixelRatio||v.oBackingStorePixelRatio||v.backingStorePixelRatio||1,y=t/x,z={},A=[],B=!g.supportDirAuto();w.innerText="Wj",s={rect:function(a,b,c,d){c&&a.fillRect(b.shape.x||0,b.shape.y||0,b.shape.width||0,b.shape.height||0),d&&a.strokeRect(b.shape.x||0,b.shape.y||0,b.shape.width||0,b.shape.height||0)},roundRect:function(a,b,c,d){a.beginPath(),a.moveTo(b.shape.x+b.shape.radius,b.shape.y),a.lineTo(b.shape.x+b.shape.width-b.shape.radius,b.shape.y),a.quadraticCurveTo(b.shape.x+b.shape.width,b.shape.y,b.shape.x+b.shape.width,b.shape.y+b.shape.radius),a.lineTo(b.shape.x+b.shape.width,b.shape.y+b.shape.height-b.shape.radius),a.quadraticCurveTo(b.shape.x+b.shape.width,b.shape.y+b.shape.height,b.shape.x+b.shape.width-b.shape.radius,b.shape.y+b.shape.height),a.lineTo(b.shape.x+b.shape.radius,b.shape.y+b.shape.height),a.quadraticCurveTo(b.shape.x,b.shape.y+b.shape.height,b.shape.x,b.shape.y+b.shape.height-b.shape.radius),a.lineTo(b.shape.x,b.shape.y+b.shape.radius),a.quadraticCurveTo(b.shape.x,b.shape.y,b.shape.x+b.shape.radius,b.shape.y),a.closePath(),c&&a.fill(),d&&a.stroke()},circle:function(a,b,c,d){if(b.shape&&b.shape.r&&!b.shape.radius&&(b.shape.radius=b.shape.r),!(isNaN(b.shape.cx)||isNaN(b.shape.cy)||isNaN(b.shape.radius)||b.shape.radius<=0)){var e=.551784;a.save(),a.translate(b.shape.cx,b.shape.cy),a.scale(b.shape.radius,b.shape.radius),a.beginPath(),a.moveTo(1,0),a.bezierCurveTo(1,-e,e,-1,0,-1),a.bezierCurveTo(-e,-1,-1,-e,-1,0),a.bezierCurveTo(-1,e,-e,1,0,1),a.bezierCurveTo(e,1,1,e,1,0),a.closePath(),a.restore(),c&&a.fill(),d&&a.stroke()}},line:function(a,b,c,d){d&&(a.beginPath(),a.moveTo(b.shape.x1,b.shape.y1),a.lineTo(b.shape.x2,b.shape.y2),a.stroke())},polygon:function(a,b,c,d){j(a,b,c,d,!0)},polyline:function(a,b,c,d){j(a,b,c,d)},polygons:function(a,b,c,d){var e,f,g,h,i,j,k=b.shape.polygons,l=k?k.length:0;for(a.beginPath(),i=0;i<l;i++)if(e=k[i],f=e.points,0!==(g=f?f.length:0)&&(h=f[0]))for(a.moveTo(h.x,h.y),j=1;j<g;j+=1)h=f[j],a.lineTo(h.x,h.y);c&&a.fill(),d&&a.stroke()},multipolygon:function(a,b,c,d){var e,f,g,h,i,j,k,l,m=b.shape.geopolygons,n=m?m.length:0;for(a.beginPath(),j=0;j<n;j++)for(e=m[j].getPolygons(),f=e?e.length:0,k=0;k<f;k++)if(g=e[k].points,0!==(h=g?g.length:0)&&(i=g[0]))for(a.moveTo(i.x,i.y),l=1;l<h;l+=1)i=g[l],a.lineTo(i.x,i.y);c&&a.fill(),d&&a.stroke()},arc:function(a,b,c,d){var e=b.shape;a.beginPath(),e.end-e.start==2*Math.PI?(a.arc(e.cx,e.cy,e.radius,e.start+e.radianOffset,e.end+e.radianOffset,!1),a.moveTo(e.cx+e.innerRadius*Math.cos(e.radianOffset+e.start),e.cy+e.innerRadius*Math.sin(e.radianOffset+e.start)),a.arc(e.cx,e.cy,e.innerRadius,e.end+e.radianOffset,e.start+e.radianOffset,!0)):(a.arc(e.cx,e.cy,e.radius,e.start+e.radianOffset,e.end+e.radianOffset,!1),isNaN(e.innerRadius)||e.innerRadius===e.radius||(a.lineTo(e.innerRadius*Math.cos(e.end+e.radianOffset)+e.cx,e.innerRadius*Math.sin(e.end+e.radianOffset)+e.cy),
e.innerRadius>0&&a.arc(e.cx,e.cy,e.innerRadius,e.end+e.radianOffset,e.start+e.radianOffset,!0),a.lineTo(e.radius*Math.cos(e.start+e.radianOffset)+e.cx,e.radius*Math.sin(e.start+e.radianOffset)+e.cy))),a.closePath(),c&&a.fill(),d&&a.stroke()},text:function(a,b){b.shape&&b.shape.text&&b.fill&&(b.shape.font&&(a.font=b.shape.font),b.shape.align&&(a.textAlign=b.shape.align),b.shape.baseline&&(a.textBaseline=b.shape.baseline),n(a,b.shape))}},r=a.extend({init:function(a,c){var f=d.extend(!0,{storeObjects:!1},c);this._container=a,this._canvas=document.createElement("canvas"),this._canvas.style.position="absolute",this._canvas.width=0,this._canvas.height=0,f.name&&this._canvas.setAttribute("name",f.name),this.storeRenderedObjects=f.storeObjects===!0,this.scaling={x:1,y:1},this._container&&this._container.appendChild(this._canvas),this.rect=new b(0,0,0,0),this.shapes=[],this._matrix=new e},setDimensions:function(a,b,c,d){this.rect.set(a,b,c,d)},setDimensionsToContainerRatio:function(a,b){this.scaling={x:a,y:b},this.ratios={x:a,y:b}},show:function(){this._canvas.style.display=""},hide:function(){this._canvas.style.display="none"},clear:function(a){if(a){if(!this._clearTimer){var b=this;this._clearTimer=c.request(function(){b._clearTimer&&(b._canvas.width=0,b._clearTimer=0)})}}else c.cancel(this._clearTimer),this._clearTimer=0,this._canvas.width=0,this._canvas.height=0,d(this._canvas).data("shapes",null),this.shapes=[]},render:function(){c.cancel(this._clearTimer),this._clearTimer=0,t=window.devicePixelRatio||1,x=v.webkitBackingStorePixelRatio||v.mozBackingStorePixelRatio||v.msBackingStorePixelRatio||v.oBackingStorePixelRatio||v.backingStorePixelRatio||1,y=t/x;var a,b,e=this._canvas,g=e.getContext("2d"),h=y,i=this._matrix,j=0,k=0;return b=this.rect.height*this.scaling.y,a=this.rect.width*this.scaling.x,this.edgeBleed&&(j=this.edgeBleed.left*this.scaling.x,k=this.edgeBleed.top*this.scaling.y,b+=this.edgeBleed.top*this.scaling.y+this.edgeBleed.bottom*this.scaling.y,a+=this.edgeBleed.left*this.scaling.x+this.edgeBleed.right*this.scaling.x),b=Math.round(b),a=Math.round(a),this._canvas.style.left=-j+"px",this._canvas.style.top=-k+"px",e.width!==a||e.height!==b?(e.width=h*a,e.height=h*b,this._canvas.style.width=a+"px",this._canvas.style.height=b+"px"):g.clearRect(0,0,e.width,e.height),g.save(),i.save(),i.scale(h*this.scaling.x,h*this.scaling.y),i.translate(j/this.scaling.x,k/this.scaling.y),p(g,i,this.viewBox),o(g,i,this.shapes,this.scaling.x),q(g,this.viewBox),g.restore(),i.restore(),this.storeRenderedObjects&&d(this._canvas).data("shapes",this.shapes),f.resolve()},setFont:function(a){this._canvas.getContext("2d").font=a},getFontHeight:function(a){if("string"!=typeof a)throw new Error("CanvasRenderer.getFontHeight(): Input font is not a string");if(a in z)return z[a];var b,c=this._canvas.getContext("2d");return c.font!==a?(c.save(),c.font=a,b=1.5*c.measureText("m").width,c.restore()):b=1.5*c.measureText("m").width,h(a,b),b},getTextWidth:function(a,b){var c,d=this._canvas.getContext("2d");return d.save(),d.font=b,c=void 0!==a?Math.ceil(d.measureText(a).width):0,d.restore(),c},getEMFontWidth:function(a){var b,c=this._canvas.getContext("2d");return c.save(),c.font=a,b=c.measureText("m").width,c.restore(),b},getAverageLetterWidth:function(a){var b="eeeaaaiinnoorsstldumcph";return v.font=a||this._canvas.getContext("2d").font,v.measureText(b).width/b.length},release:function(){d(this._canvas).data("shapes",null),this.shapes=[],this._container&&(this._container.removeChild(this._canvas),this._container=null)},applyTransform:function(){var a;for(a=0;a<this.shapes.length;a+=1)this.shapes[a].type in C&&C[this.shapes[a].type](this.shapes[a].shape,this.ratios)}});var C={rect:function(a,b){a.x*=b.x,a.y*=b.y,a.width*=b.x,a.height*=b.y},line:function(a,b){a.x1*=b.x,a.y1*=b.y,a.x2*=b.x,a.y2*=b.y},circle:function(a,b){a.cx*=b.x,a.cy*=b.y,a.r*=Math.min(b.x,b.y)},polygon:function(a,b){var c,d;for(c=0;c<a.points.length;c++)d=a.points[c],d.x*=b.x,d.y*=b.y},text:function(a,b){a.x*=b.x,a.y*=b.y,a.width*=b.x,a.height*=b.y}};return r.getTextWidth=function(a){return Math.ceil(v.measureText(a).width)},r.setFont=function(a){v.font=a},r.getAverageLetterWidth=function(a){var b="eeeaaaiinnoorsstldumcph";return v.font=a,v.measureText(b).width/b.length},r.measureText=function(a,b){var c,d,e=v;return b&&e.font!==b&&(e.save(),e.font=b),d=e.measureText(a).width,b in z?c=z[b]:(c=1.5*e.measureText("m").width,h(b,c)),b&&e.restore(),void 0!==a?{width:d,height:c}:{width:0,height:0}},r.measureTextObject=function(a){return a.shape.font&&(v.font=a.shape.font),a.shape.align&&(v.textAlign=a.shape.align),a.shape.baseline&&(v.textBaseline=a.shape.baseline),n(v,a.shape,!0)},r.measureDisplayTextObject=function(a){return a.font&&(v.font=a.font),a.align&&(v.textAlign=a.align),a.baseline&&(v.textBaseline=a.baseline),n(v,a,!0)},r.getFontHeight=function(a){var b,c=v;return a in z?z[a]:(a&&(c.save(),c.font=a),b=1.5*c.measureText("m").width,h(a,b),a&&c.restore(),b)},r.getDevicePixelToBackingStoreRatio=function(){return(window.devicePixelRatio||1)/(v.webkitBackingStorePixelRatio||v.mozBackingStorePixelRatio||v.msBackingStorePixelRatio||v.oBackingStorePixelRatio||v.backingStorePixelRatio||1)},r}),define("general.utils/css-colors",[],function(){return{aliceblue:{r:240,g:248,b:255},antiquewhite:{r:250,g:235,b:215},aqua:{r:0,g:255,b:255},aquamarine:{r:127,g:255,b:212},azure:{r:240,g:255,b:255},beige:{r:245,g:245,b:220},bisque:{r:255,g:228,b:196},black:{r:0,g:0,b:0},blanchedalmond:{r:255,g:235,b:205},blue:{r:0,g:0,b:255},blueviolet:{r:138,g:43,b:226},brown:{r:165,g:42,b:42},burlywood:{r:222,g:184,b:135},cadetblue:{r:95,g:158,b:160},chartreuse:{r:127,g:255,b:0},chocolate:{r:210,g:105,b:30},coral:{r:255,g:127,b:80},cornflowerblue:{r:100,g:149,b:237},cornsilk:{r:255,g:248,b:220},crimson:{r:220,g:20,b:60},cyan:{r:0,g:255,b:255},darkblue:{r:0,g:0,b:139},darkcyan:{r:0,g:139,b:139},darkgoldenrod:{r:184,g:134,b:11},darkgray:{r:169,g:169,b:169},darkgreen:{r:0,g:100,b:0},darkgrey:{r:169,g:169,b:169},darkkhaki:{r:189,g:183,b:107},darkmagenta:{r:139,g:0,b:139},darkolivegreen:{r:85,g:107,b:47},darkorange:{r:255,g:140,b:0},darkorchid:{r:153,g:50,b:204},darkred:{r:139,g:0,b:0},darksalmon:{r:233,g:150,b:122},darkseagreen:{r:143,g:188,b:143},darkslateblue:{r:72,g:61,b:139},darkslategray:{r:47,g:79,b:79},darkslategrey:{r:47,g:79,b:79},darkturquoise:{r:0,g:206,b:209},darkviolet:{r:148,g:0,b:211},deeppink:{r:255,g:20,b:147},deepskyblue:{r:0,g:191,b:255},dimgray:{r:105,g:105,b:105},dimgrey:{r:105,g:105,b:105},dodgerblue:{r:30,g:144,b:255},firebrick:{r:178,g:34,b:34},floralwhite:{r:255,g:250,b:240},forestgreen:{r:34,g:139,b:34},fuchsia:{r:255,g:0,b:255},gainsboro:{r:220,g:220,b:220},ghostwhite:{r:248,g:248,b:255},gold:{r:255,g:215,b:0},goldenrod:{r:218,g:165,b:32},gray:{r:128,g:128,b:128},green:{r:0,g:128,b:0},greenyellow:{r:173,g:255,b:47},grey:{r:128,g:128,b:128},honeydew:{r:240,g:255,b:240},hotpink:{r:255,g:105,b:180},indianred:{r:205,g:92,b:92},indigo:{r:75,g:0,b:130},ivory:{r:255,g:255,b:240},khaki:{r:240,g:230,b:140},lavender:{r:230,g:230,b:250},lavenderblush:{r:255,g:240,b:245},lawngreen:{r:124,g:252,b:0},lemonchiffon:{r:255,g:250,b:205},lightblue:{r:173,g:216,b:230},lightcoral:{r:240,g:128,b:128},lightcyan:{r:224,g:255,b:255},lightgoldenrodyellow:{r:250,g:250,b:210},lightgray:{r:211,g:211,b:211},lightgreen:{r:144,g:238,b:144},lightgrey:{r:211,g:211,b:211},lightpink:{r:255,g:182,b:193},lightsalmon:{r:255,g:160,b:122},lightseagreen:{r:32,g:178,b:170},lightskyblue:{r:135,g:206,b:250},lightslategray:{r:119,g:136,b:153},lightslategrey:{r:119,g:136,b:153},lightsteelblue:{r:176,g:196,b:222},lightyellow:{r:255,g:255,b:224},lime:{r:0,g:255,b:0},limegreen:{r:50,g:205,b:50},linen:{r:250,g:240,b:230},magenta:{r:255,g:0,b:255},maroon:{r:128,g:0,b:0},mediumaquamarine:{r:102,g:205,b:170},mediumblue:{r:0,g:0,b:205},mediumorchid:{r:186,g:85,b:211},mediumpurple:{r:147,g:112,b:219},mediumseagreen:{r:60,g:179,b:113},mediumslateblue:{r:123,g:104,b:238},mediumspringgreen:{r:0,g:250,b:154},mediumturquoise:{r:72,g:209,b:204},mediumvioletred:{r:199,g:21,b:133},midnightblue:{r:25,g:25,b:112},mintcream:{r:245,g:255,b:250},mistyrose:{r:255,g:228,b:225},moccasin:{r:255,g:228,b:181},navajowhite:{r:255,g:222,b:173},navy:{r:0,g:0,b:128},oldlace:{r:253,g:245,b:230},olive:{r:128,g:128,b:0},olivedrab:{r:107,g:142,b:35},orange:{r:255,g:165,b:0},orangered:{r:255,g:69,b:0},orchid:{r:218,g:112,b:214},palegoldenrod:{r:238,g:232,b:170},palegreen:{r:152,g:251,b:152},paleturquoise:{r:175,g:238,b:238},palevioletred:{r:219,g:112,b:147},papayawhip:{r:255,g:239,b:213},peachpuff:{r:255,g:218,b:185},peru:{r:205,g:133,b:63},pink:{r:255,g:192,b:203},plum:{r:221,g:160,b:221},powderblue:{r:176,g:224,b:230},purple:{r:128,g:0,b:128},red:{r:255,g:0,b:0},rosybrown:{r:188,g:143,b:143},royalblue:{r:65,g:105,b:225},saddlebrown:{r:139,g:69,b:19},salmon:{r:250,g:128,b:114},sandybrown:{r:244,g:164,b:96},seagreen:{r:46,g:139,b:87},seashell:{r:255,g:245,b:238},sienna:{r:160,g:82,b:45},silver:{r:192,g:192,b:192},skyblue:{r:135,g:206,b:235},slateblue:{r:106,g:90,b:205},slategray:{r:112,g:128,b:144},slategrey:{r:112,g:128,b:144},snow:{r:255,g:250,b:250},springgreen:{r:0,g:255,b:127},steelblue:{r:70,g:130,b:180},tan:{r:210,g:180,b:140},teal:{r:0,g:128,b:128},thistle:{r:216,g:191,b:216},tomato:{r:255,g:99,b:71},turquoise:{r:64,g:224,b:208},violet:{r:238,g:130,b:238},wheat:{r:245,g:222,b:179},white:{r:255,g:255,b:255},whitesmoke:{r:245,g:245,b:245},yellow:{r:255,g:255,b:0},yellowgreen:{r:154,g:205,b:50}}}),define("general.utils/color",["core.utils/class","./css-colors"],function(a,b){var c,d=/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/i,e=/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),(\d(\.\d+)?)\)$/i,f=/^#([A-f0-9]{2})([A-f0-9]{2})([A-f0-9]{2})$/i,g=/^#([A-f0-9])([A-f0-9])([A-f0-9])$/i,h=/^hsl\(\s*(\d+(\.\d+)?)\s*,\s*(\d+(\.\d+)?%?)\s*,\s*(\d+(\.\d+)?%?)\s*\)$/i,i=/^hsla\(\s*(\d+(\.\d+)?)\s*,\s*(\d+(\.\d+)?%?)\s*,\s*(\d+(\.\d+)?%?)\s*,(\d(\.\d+)?)\)$/i,j=Math.floor,k=Math.round;return c=a.extend({init:function(){var a,d,e,f,g,h,i,l,m,n,o,p,q=0,r=0,s=0,t=1;if(this._invalid=!1,arguments[0]instanceof c)q=arguments[0]._r,r=arguments[0]._g,s=arguments[0]._b,t=arguments[0]._a,this._invalid=arguments[0]._invalid;else if(arguments.length<3)if("string"==typeof arguments[0])if(p=arguments[0],o=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/i.exec(p))q=parseInt(o[1],10),r=parseInt(o[2],10),s=parseInt(o[3],10);else if(o=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d(\.\d+)?)\s*\)$/i.exec(p))q=parseInt(o[1],10),r=parseInt(o[2],10),s=parseInt(o[3],10),t=parseFloat(o[4]);else if(o=/^#([A-f0-9]{2})([A-f0-9]{2})([A-f0-9]{2})$/i.exec(p))q=parseInt(o[1],16),r=parseInt(o[2],16),s=parseInt(o[3],16),t=1;else if(o=/^#([A-f0-9])([A-f0-9])([A-f0-9])$/i.exec(p))q=parseInt(o[1]+o[1],16),r=parseInt(o[2]+o[2],16),s=parseInt(o[3]+o[3],16),t=1;else if(o=/^hsl\(\s*(\d+(\.\d+)?)\s*,\s*(\d+(\.\d+)?%?)\s*,\s*(\d+(\.\d+)?%?)\s*\)$/i.exec(p)){switch(a=parseFloat(o[1]),d=parseFloat(o[3]),f=parseFloat(o[5]),a%=360,d/=100,f/=100,a=a<0?0:a>360?360:a,d=d<0?0:d>1?1:d,f=f<0?0:f>1?1:f,h=f<=.5?2*f*d:(2-2*f)*d,i=a/60,l=h*(1-Math.abs(i%2-1)),m=[],i=Math.floor(i)){case 0:m=[h,l,0];break;case 1:m=[l,h,0];break;case 2:m=[0,h,l];break;case 3:m=[0,l,h];break;case 4:m=[l,0,h];break;case 5:m=[h,0,l];break;default:m=[0,0,0]}n=f-.5*h,q=m[0]+n,r=m[1]+n,s=m[2]+n,q=k(255*q),r=k(255*r),s=k(255*s),t=1}else if(o=/^hsla\(\s*(\d+(\.\d+)?)\s*,\s*(\d+(\.\d+)?%?)\s*,\s*(\d+(\.\d+)?%?)\s*,(\d(\.\d+)?)\)$/i.exec(p)){switch(a=parseFloat(o[1]),d=parseFloat(o[3]),f=parseFloat(o[5]),t=parseFloat(o[7]),a%=360,d/=100,f/=100,a=a<0?0:a>360?360:a,d=d<0?0:d>1?1:d,f=f<0?0:f>1?1:f,h=f<=.5?2*f*d:(2-2*f)*d,i=a/60,l=h*(1-Math.abs(i%2-1)),m=[],i=Math.floor(i)){case 0:m=[h,l,0];break;case 1:m=[l,h,0];break;case 2:m=[0,h,l];break;case 3:m=[0,l,h];break;case 4:m=[l,0,h];break;case 5:m=[h,0,l];break;default:m=[0,0,0]}n=f-.5*h,q=m[0]+n,r=m[1]+n,s=m[2]+n,q=k(255*q),r=k(255*r),s=k(255*s)}else if(o=/^hsv\(\s*(\d+(\.\d+)?)\s*,\s*(\d+(\.\d+)?%?)\s*,\s*(\d+(\.\d+)?%?)\s*\)$/i.exec(p)){switch(a=parseFloat(o[1]),d=parseFloat(o[3]),g=parseFloat(o[5]),a%=360,d/=100,g/=100,a=a<0?0:a>360?360:a,d=d<0?0:d>1?1:d,g=g<0?0:g>1?1:g,h=g*d,i=a/60,l=h*(1-Math.abs(i%2-1)),m=[],i=Math.floor(i)){case 0:m=[h,l,0];break;case 1:m=[l,h,0];break;case 2:m=[0,h,l];break;case 3:m=[0,l,h];break;case 4:m=[l,0,h];break;case 5:m=[h,0,l];break;default:m=[0,0,0]}n=g-h,q=m[0]+n,r=m[1]+n,s=m[2]+n,q=k(255*q),r=k(255*r),s=k(255*s),t=1}else b[p.toLowerCase()]?(e=p.toLowerCase(),q=b[e].r,r=b[e].g,s=b[e].b,t=1):this._invalid=!0;else"number"==typeof arguments[0]&&arguments[0]>=0&&"argb"===arguments[1]?(t=(4278190080&arguments[0])>>>24,t/=255,q=(16711680&arguments[0])>>16,r=(65280&arguments[0])>>8,s=255&arguments[0]):"number"==typeof arguments[0]&&arguments[0]>=0?(q=(16711680&arguments[0])>>16,r=(65280&arguments[0])>>8,s=255&arguments[0]):this._invalid=!0;else arguments.length>=3?(q=arguments[0],r=arguments[1],s=arguments[2],t=arguments.length>=4?arguments[3]:1):this._invalid=!0;isNaN(q+r+s+t)&&(this._invalid=!0),this._r=j(q),this._g=j(r),this._b=j(s),this._a=t,this._spaces={}},isInvalid:function(){return this._invalid},setAlpha:function(a){this._a=a,this._spaces={}},getAlpha:function(){return this._a},toRGB:function(){return this._spaces.rgb||(this._spaces.rgb=c.toRGB(this)),this._spaces.rgb},toRGBA:function(){return this._spaces.rgba||(this._spaces.rgba=c.toRGBA(this)),this._spaces.rgba},toString:function(){return this._spaces.rgb||(this._spaces.rgb=c.toRGB(this)),this._spaces.rgb},toHex:function(){return this._spaces.hex||(this._spaces.hex=c.toHex(this)),this._spaces.hex},toHSL:function(a){return this._spaces.hsl||(this._spaces.hsl=c.toHSL(this,a)),this._spaces.hsl},toHSLA:function(a){return this._spaces.hsla||(this._spaces.hsla=c.toHSLA(this,a)),this._spaces.hsla},toHSV:function(){var a=this.toHSVComponents();return"hsv("+a.h+","+a.s+","+a.v+")"},toHSVComponents:function(){return this._spaces.hsvComp||(this._spaces.hsvComp=c.toHSVComponents(this)),this._spaces.hsvComp},toNumber:function(){return this._spaces.num||(this._spaces.num=c.toNumber(this)),this._spaces.num},isDark:function(){return this.isInvalid()||this.getLuminance()<125},getLuminance:function(){return void 0===this._lumi&&(this._lumi=.299*this._r+.587*this._g+.114*this._b),this._lumi},shiftLuminance:function(a){var b,c,d,e,f,g=this.toHSLA();return f=/^hsla\(\s*(\d+(\.\d+)?)\s*,\s*(\d+(\.\d+)?%?)\s*,\s*(\d+(\.\d+)?%?)\s*,(\d(\.\d+)?)\)$/i.exec(g),b=parseFloat(f[1]),c=parseFloat(f[3]),d=parseFloat(f[5]),e=parseFloat(f[7]),d+=a,d=Math.max(0,Math.min(d,100)),"hsla("+b+","+c+","+d+","+e+")"},isEqual:function(a){return a instanceof c?this._r===a._r&&this._g===a._g&&this._b===a._b:(a=new c(a),this._r===a._r&&this._g===a._g&&this._b===a._b)},blend:function(a,b){return"rgba("+[j(this._r+(a._r-this._r)*b),j(this._g+(a._g-this._g)*b),j(this._b+(a._b-this._b)*b),j(this._a+(a._a-this._a)*b)].join(",")+")"},createShiftedColor:function(a){(void 0===a||isNaN(a))&&(a=1);var b=this.getLuminance(),d=this._g<126?1:1+this._g/512,e=this.shiftLuminance(20*(b*d<220?.8+1/(b+1)*4:-(.8+b/255*1))*a);return new c(e)}}),c.toRGB=function(a){return a instanceof c?"rgb("+[a._r,a._g,a._b].join(",")+")":("string"==typeof a&&(a=c.toNumber(a)),"rgb("+((16711680&a)>>16)+","+((65280&a)>>8)+","+(255&a)+")")},c.toRGBA=function(a,b){return a instanceof c?"rgba("+[a._r,a._g,a._b,void 0!==b?b:a._a].join(",")+")":("string"==typeof a&&(a=c.toNumber(a)),"rgba("+((16711680&a)>>16)+","+((65280&a)>>8)+","+(255&a)+","+(void 0!==b?b:a._a)+")")},c.toHex=function(a){var b,d,e;return a instanceof c?(b=a._r.toString(16),d=a._g.toString(16),e=a._b.toString(16),1===b.length&&(b="0"+b),1===d.length&&(d="0"+d),1===e.length&&(e="0"+e),"#"+[b,d,e].join("")):("string"==typeof a&&(a=c.toNumber(a)),b=((16711680&a)>>16).toString(16),d=((65280&a)>>8).toString(16),e=(255&a).toString(16),1===b.length&&(b="0"+b),1===d.length&&(d="0"+d),1===e.length&&(e="0"+e),"#"+b+d+e)},c.toHSL=function(a,b){var d,e,f,g,h,i,j,k,l=0;if("string"==typeof a&&(a=new c(a)),d=a._r/255,e=a._g/255,f=a._b/255,i=Math.max(d,e,f),j=Math.min(d,e,f),h=b?.21*d+.72*e+.07*f:(i+j)/2,i===j)l=g=0;else{switch(k=i-j,g=h>.5?k/(2-i-j):k/(i+j),i){case d:l=(e-f)/k+(e<f?6:0);break;case e:l=(f-d)/k+2;break;case f:l=(d-e)/k+4}l/=6}return"hsl("+360*l+","+100*g+","+100*h+")"},c.toHSLA=function(a,b){var d,e,f,g,h,i,j,k,l,m=0;if("string"==typeof a&&(a=new c(a)),d=a._r/255,e=a._g/255,f=a._b/255,g=a._a,j=Math.max(d,e,f),k=Math.min(d,e,f),i=b?.21*d+.72*e+.07*f:(j+k)/2,j===k)m=h=0;else{switch(l=j-k,h=i>.5?l/(2-j-k):l/(j+k),j){case d:m=(e-f)/l+(e<f?6:0);break;case e:m=(f-d)/l+2;break;case f:m=(d-e)/l+4}m/=6}return"hsla("+360*m+","+100*h+","+100*i+","+g+")"},c.toHSVComponents=function(a){var b,d,e,f,g,h,i,j,k=0;if("string"==typeof a&&(a=new c(a)),b=a._r/255,d=a._g/255,e=a._b/255,h=Math.max(b,d,e),i=Math.min(b,d,e),g=h,h===i)k=f=0;else{switch(j=h-i,f=0===j?0:j/g,h){case b:k=(d-e)/j+(d<e?6:0);break;case d:k=(e-b)/j+2;break;case e:k=(b-d)/j+4}k/=6}return{h:360*k%360,s:100*f,v:100*g}},c.toNumber=function(){if(1===arguments.length&&arguments[0]instanceof c)return(arguments[0]._r<<16)+(arguments[0]._g<<8)+arguments[0]._b;var a,b,d=0,e=0,f=0;return 1===arguments.length&&"string"==typeof arguments[0]&&(b=arguments[0],(a=/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/i.exec(b))?(d=parseInt(a[1],10),e=parseInt(a[2],10),f=parseInt(a[3],10)):(a=/^#([A-f0-9]{2})([A-f0-9]{2})([A-f0-9]{2})$/i.exec(b))?(d=parseInt(a[1],16),e=parseInt(a[2],16),f=parseInt(a[3],16)):(a=/^#([A-f0-9])([A-f0-9])([A-f0-9])$/i.exec(b))&&(d=parseInt(a[1]+a[1],16),e=parseInt(a[2]+a[2],16),f=parseInt(a[3]+a[3],16))),(d<<16)+(e<<8)+f},c.blend=function(a,b,d){a=c.toNumber(a),b=c.toNumber(b);var e=(16711680&a)>>16,f=(65280&a)>>8,g=255&a;return(e+(((16711680&b)>>16)-e)*d<<16)+(f+(((65280&b)>>8)-f)*d<<8)+(g+((255&b)-g)*d)},c.getBlend=function(a,b,d){var e=a._r+(b._r-a._r)*d,f=a._g+(b._g-a._g)*d,g=a._b+(b._b-a._b)*d,h=a._a+(b._a-a._a)*d;return new c(e,f,g,h)},c.isCSSColor=function(a){return!(arguments.length>1||"string"!=typeof a)&&(d.test(a)||e.test(a)||f.test(a)||g.test(a)||h.test(a)||i.test(a)||b[a.toLowerCase()])},c.getBestContrast=function(a,b,c){var d=a.getLuminance();return Math.abs(d-b.getLuminance())>Math.abs(d-c.getLuminance())?b:c},c.getContrast=function(a,b){if(a&&b){var c=a.getLuminance()/100,d=b.getLuminance()/100;return c>d?(c+.05)/(d+.05):(d+.05)/(c+.05)}},c.isDark=function(){var a={getLuminance:c.prototype.getLuminance};return c.prototype.init.apply(a,[].slice.call(arguments)),c.prototype.isDark.call(a)},c.useDarkLabel=function(a,b){return a._a>.5?!a.isDark():!b},c}),define("objects.views/charts/utils/tree-iterator",[],function(){var a={getLevel:function(){if(this&&this.parent!==this){for(var a=this.parent,b=0;a;)b+=1,a=a.parent;return b}},each:function(b){var c,d=this.children;if(d)for(c=0;c<d.length;c+=1){if(b&&b(d[c],c,d.length-1)===!1)return!1;if(a.each.call(d[c],b)===!1)return!1}},getLeaves:function(){if(!this.children||!this.children)return[];var b,c=[];for(b=0;b<this.children.length;b+=1)this.children[b]&&this.children[b].children&&this.children[b].children.length?c=c.concat(a.getLeaves.call(this.children[b])):c.push(this.children[b]);return c}};return a}),define("extensions.qliktech/barchart/layers/label-layer",["core.utils/class","objects.views/charts/utils/canvas-renderer","objects.views/charts/utils/matrix","general.utils/color","objects.views/charts/utils/tree-iterator"],function(a,b,c,d){"use strict";function e(a,b){return a?d.useDarkLabel(b,B)?y.label.dark.color:y.label.light.color:y.label.color}function f(a,b,c,d,e,f,g){return{type:"text",fill:y.label.dark.color,opacity:d||1,data:{value:b,rect:c,labelRect:f,hintDirection:g,color:e},shape:{text:a,maxNumLines:1,align:"center",baseline:"middle"}}}function g(a){var b,c,d,e;if(b=a.descendants.filter(function(a){return!a.isBranch&&a.data.isVisible!==!1}),c=b.map(function(a){return a.data.hitRect}),c.length)return d=c[0],c.length>1&&(d=d.combineWith(c.slice(-1)[0])),e=f(a.data.valueLabel,a.data.sum,d,b[b.length-1].opacity,b[b.length-1].data.color,null,null),e.data.isFillPattern=window.CanvasPattern&&b[b.length-1].fill instanceof window.CanvasPattern,e.data.lastRect=c[c.length-1],e}function h(a,b){var c,d;a.forEach(function(a){c=a.children,a.data.isStack?(d=g(a))&&(d.data.isStack=!0,d.targetShape=a,b.push(d)):c&&c.length?h(c,b):a.data.isVisible!==!1&&(d=f(a.data.valueLabel,a.data.value,a.data.hitRect,a.opacity,a.data.color,a.data.labelRect,a.data.hintDirection),d.targetShape=a,b.push(d))})}function i(a,b){var c;a.forEach(function(a){c=a.children,c&&c.length?i(c,b):a.data.isVisible!==!1&&b.push(a)})}function j(a,b){Object.keys(b).forEach(function(c){a[c]=b[c]})}function k(a){return a.filter(function(a){return!!a.labelBounds})}function l(a,b,c){return a.filter(function(a){return a.labelBounds.x>=b&&a.labelBounds.x+a.labelBounds.width<=c})}function m(a,b){var c,d,e,f=b?b.length:0;for(d=a.labelBounds,c=0;c<f;c++)if(e=b[c].data.hitRect,a.targetShape===b[c]){if(d.y+d.height/2>e.y&&d.width>e.width+8)return!0}else if(e&&d.x<=e.x+e.width&&e.x<=d.x+d.width&&d.y<=e.y+e.height&&e.y<=d.y+d.height)return!0;return!1}function n(a,b){return a.filter(function(a){return!m(a,b)})}function o(a){return a.filter(function(a){return a.data.value<0})}function p(a){return a.filter(function(a){return a.data.value>=0})}function q(a,b){var c,d,e,f=b?b.length:0;for(d=a.labelBounds,c=0;c<f;c++)if(e=b[c].labelBounds,d.x<=e.x+e.width&&e.x<=d.x+d.width&&d.y<=e.y+e.height&&e.y<=d.y+d.height)return!0;return!1}function r(a){var b,c,d,e,f,g=a?a.length:0,h=[];for(b=0;b<g;b++)f=a[b],c=f.data.value,d=0===b?c:a[b-1].data.value,e=b===g-1?c:a[b+1].data.value,f.priority=c>d&&c>e?6:c<d&&c<e?5:c>d&&c===e||c===d&&c>e?4:c<d&&c===e||c===d&&c<e?3:c===d&&c===e?2:1;for(a.sort(function(a,b){return a.priority-b.priority}),b=0;b<g;b++)q(a[b],h)||(h[h.length]=a[b]);return h}function s(){var a,c,d,e,f=[],g=[],j=this.minorAxis.getPlotMin(),m=this.minorAxis.getPlotMax(),q=y.label.font,s=this.bounds;h(this._shapes,f),b.setFont(q),this.renderer.setFont(q),f=f.filter(function(a){return"NaN"===a.data.value||(!(!a.data.labelRect&&!a.data.showHintLabel)||(a.data.value>=0&&m>=a.data.value&&j<=a.data.value||(a.data.value<0&&j<=a.data.value&&m>=a.data.value||!!(a.data.rect.width&&a.data.rect.height&&s.intersectsWith(a.data.rect)))))});var v,x,A;for(this._shapes&&this._shapes.length?(x=this._shapes[0].descendants.filter(function(a){return!a.isBranch})[0],A=x?x.data.hitRect.width:this.majorAxis._discreteSpacing):A=0,v=0,a=f?f.length:0,d=0;d<a;d++)c=f[d],c.shape&&(c.shape.font=q,c.data.labelWidth=b.getTextWidth(c.shape.text),v=Math.max(v,c.data.labelWidth));this._longestLabel=v,e=this._longestLabel<A;var C;for(C=this.minorAxis.isVertical()?e?t:u:w,d=0;d<a;d++)C.call(this,f[d],A);if(this.isNumeric){var D,E;i(this._shapes,g),f=k(f),f=l(f,this.bounds.x-4,this.bounds.x+this.bounds.width+4),f=n(f,g),D=o(f),E=p(f),D=r(D),E=r(E),f=E.concat(D)}f.slice().forEach(function(a){a.fill&&a.backdrop&&(f.unshift({opacity:a.opacity||1,type:"roundRect",fill:z,shape:a.backdrop}),a.fill=B?y.label.light.color:y.label.dark.color)}),this.renderer.shapes=f,this.renderer.render()}function t(a,b){for(var c,d=this.renderer.getFontHeight(y.label.font),f=v.apply(this,[a,!1,b]),g=0;g<f.length;g++)if(j(a.shape,f[g].rect),d<f[g].rect.height){c=f[g];break}if(c){var h=c.rect.width-a.data.labelWidth;j(a.shape,c.rect),a.shape.baseline=c.baseline,a.shape.align=c.align,a.labelBounds={x:c.rect.x+Math.min(h/2,4),y:"top"===c.baseline?c.rect.y:c.rect.y+c.rect.height-16,width:Math.max(c.rect.width-Math.min(h,8)),height:16,containingRect:c.inline?a.shape:void 0},a.data.isStack&&c.inline&&(a.data.lastRect.height<20||a.data.isFillPattern)?a.backdrop={x:a.labelBounds.x,y:a.labelBounds.y,width:a.labelBounds.width,height:a.labelBounds.height,radius:4}:(a.fill=e(c.inline,a.data.color),a.backdrop=!1)}else a.fill=!1}function u(a,d){var f,g,h,i,k=v.apply(this,[a,!0,d]);i=this.bounds.x+this.bounds.width,f="labelWidth"in a.data?a.data.labelWidth:b.getTextWidth(a.shape.text);for(g=0;g<k.length;g++)if(k[g].rect.height>=f){h=k[g];break}if(h||(k.sort(function(a,b){return.8*b.rect.height-a.rect.height}),k[0].rect.height>=8&&(h=k[0])),h){var l=new c;l.translate(h.rect.x,h.rect.y+h.rect.height),l.rotate(-Math.PI/2),j(a.shape,{width:h.rect.height,height:h.rect.width,baseline:h.baseline,align:h.align,x:0,y:0}),a.transform=l.elements,a.labelBounds={x:h.rect.x+h.rect.width/2-8,y:"right"===h.align?h.rect.y-4:h.rect.y+h.rect.height-f-4,width:16,height:f+8},h.rect.x<0&&h.rect.x+h.rect.width>0&&(a.labelBounds.x=Math.max(a.labelBounds.x,this.bounds.x-4)),h.rect.x<i&&h.rect.x+h.rect.width>i&&(a.labelBounds.x=Math.min(a.labelBounds.x,i-a.labelBounds.width)),a.data.isStack&&h.inline&&(a.data.lastRect.height<f+4||a.data.isFillPattern)?a.backdrop={x:a.labelBounds.x,y:a.labelBounds.y,width:a.labelBounds.width,height:a.labelBounds.height,radius:4}:(a.fill=e(h.inline,a.data.color),a.backdrop=!1)}else a.fill=!1}function v(a,b,c){var d,e,f,g,h=b&&a.data.isStack?8:4,i=[];return d=a.data.rect.width,e=a.data.rect.height,f=a.data.rect.x,g=a.data.rect.y,"up"!==a.data.hintDirection&&a.data.value>=0||"down"===a.data.hintDirection?(g-this.bounds.y-2*h>4&&i.push({align:b?"left":"center",baseline:b?"middle":"bottom",rect:{x:f-.5*(c-d),y:this.bounds.y+h,width:c,height:g-this.bounds.y-2*h}}),a.data.labelRect&&(d=a.data.labelRect.width,e=a.data.labelRect.height,f=a.data.labelRect.x,g=a.data.labelRect.y),a.data.hintDirection||i.push({align:b?"right":"center",baseline:b?"middle":"top",inline:!0,rect:{x:f,y:g+h,width:d,height:e-2*h}})):(this.bounds.height-g-e-2*h>0&&i.push({align:b?"right":"center",baseline:b?"middle":"top",rect:{x:f-.5*(c-d),y:g+e+h,width:c,height:this.bounds.height-g-e-2*h}}),a.data.labelRect&&(d=a.data.labelRect.width,e=a.data.labelRect.height,f=a.data.labelRect.x,g=a.data.labelRect.y),a.data.hintDirection||i.push({align:b?"left":"center",baseline:b?"middle":"bottom",inline:!0,rect:{x:f,y:g+h,width:d,height:e-2*h}})),i}function w(a,c){var d,f,g,h;g=x.apply(this,[a,c]),d="labelWidth"in a.data?a.data.labelWidth:b.getTextWidth(a.shape.text);for(f=0;f<g.length;f++)if(g[f].rect.width>=d){h=g[f];break}!h&&g.length&&(g.sort(function(a,b){return.8*b.rect.width-a.rect.width}),g[0].rect.width>=8&&(h=g[0])),h?(a.shape.baseline="middle",a.shape.align=h.align,j(a.shape,h.rect),a.labelBounds={x:("right"===h.align?h.rect.x+h.rect.width-d:h.rect.x)-4,y:h.rect.y+h.rect.height/2-8,width:d+8,height:16},a.data.isStack&&h.inline&&(a.data.lastRect.width<d+8||a.data.isFillPattern)?a.backdrop={x:a.labelBounds.x,y:a.labelBounds.y,width:a.labelBounds.width,height:a.labelBounds.height,radius:4}:(a.fill=e(h.inline,a.data.color),a.backdrop=!1)):a.fill=!1}function x(a){var b,c,d,e,f=a.data.isStack?8:4,g=[];return b=a.data.rect.width,c=a.data.rect.height,d=a.data.rect.x,e=a.data.rect.y,"right"!==a.data.hintDirection&&(this.yMirrorMode?a.data.value<0:a.data.value>=0)||"left"===a.data.hintDirection?(this.bounds.width-d-b-2*f>0&&g.push({align:"left",rect:{x:d+b+f,y:e,width:this.bounds.width-d-b-2*f,height:c}}),a.data.labelRect&&(b=a.data.labelRect.width,c=a.data.labelRect.height,d=a.data.labelRect.x,e=a.data.labelRect.y),a.data.hintDirection||g.push({align:"right",inline:!0,rect:{x:d+f,y:e,width:b-2*f,height:c}})):(d-this.bounds.x-2*f&&g.push({align:"right",rect:{x:this.bounds.x+f,y:e,width:d-this.bounds.x-2*f,height:c}}),a.data.labelRect&&(b=a.data.labelRect.width,c=a.data.labelRect.height,d=a.data.labelRect.x,e=a.data.labelRect.y),a.data.hintDirection||g.push({align:"left",inline:!0,rect:{x:d+f,y:e,width:b-2*f,height:c}})),g}var y,z,A,B;return a.extend("LabelLayer",{init:function(a){this.renderer=new b(a)},setYMirrorMode:function(a){this.yMirrorMode=a},setData:function(a){this._data=a},setMeasureIndices:function(){},setBarData:function(a){this._barData=a},setShapes:function(a){this._shapes=a},show:function(){this.renderer.show()},hide:function(){this.renderer.hide()},clear:function(){this.renderer.clear()},release:function(){this.renderer.release()},render:function(){y=this.style.dataPoints,A=new d(this.style.backgroundColor),B=A.isDark(),z=d.toRGBA(A,.75),s.call(this)}})}),define("core.utils/json-patch",["jquery"],function(a){function b(a){return a&&(a=i({},{val:a}).val),a}function c(a,b){return m(a[b])||"$$"===b.substring(0,2)||"_"===b.substring(0,1)}function d(a,b){var c,d=b.substring(1).split("/").slice(0,-1);return d.forEach(function(b,e){e!==d.length&&(c=+b,a=a[c||b]=l(a[c||b])?isNaN(c)?{}:[]:a[b])}),a}function e(a){Object.keys(a).forEach(function(b){Object.getOwnPropertyDescriptor(a,b).configurable&&!c(a,b)&&delete a[b]})}function f(a,b){var c,d,e=!0;if(j(a)&&j(b))return Object.keys(a).length===Object.keys(b).length&&(Object.keys(a).forEach(function(c){if(!f(a[c],b[c]))return e=!1,!1}),e);if(k(a)&&k(b)){if(a.length!==b.length)return!1;for(c=0,d=a.length;c<d;c++)if(!f(a[c],b[c]))return!1;return!0}return a===b}function g(a,b,c){function d(a,b,c){if(a[c]&&l(a[c].qInfo))return null;if(a[c]&&a[c].qInfo.qId===b)return c;for(var d=0,e=a.length;d<e;d++)if(a[d]&&a[d].qInfo.qId===b)return d;return-1}var e,g,i=[],j=a.slice(),k=-1;if(f(b,j))return i;if(null===b[0]||!l(b[0])&&l(b[0].qInfo))return i.push({op:"replace",path:c,value:b}),i;for(e=j.length-1;e>=0;--e)k=d(b,j[e].qInfo&&j[e].qInfo.qId,e),k===-1?(i.push({op:"remove",path:c+"/"+e}),j.splice(e,1)):i=i.concat(h.generate(j[e],b[k],c+"/"+e));for(e=0,g=b.length;e<g;++e)k=d(j,b[e].qInfo&&b[e].qInfo.qId),k===-1?(i.push({op:"add",path:c+"/"+e,value:b[e]}),j.splice(e,0,b[e])):k!==e&&(i.push({op:"move",path:c+"/"+e,from:c+"/"+k}),j.splice(e,0,j.splice(k,1)[0]));return i}var h={},i=function(){return a.extend.apply(a,[!0].concat(Array.prototype.slice.call(arguments)))},j=a.isPlainObject,k=Array.isArray,l=function(a){return void 0===a},m=function(a){return"function"==typeof a};return h.generate=function(a,d,e){e=e||"";var i=[];return Object.keys(d).forEach(function(m){var n=b(d[m]),o=a[m],p=e+"/"+m;f(n,o)||c(d,m)||(l(o)?i.push({op:"add",path:p,value:n}):j(n)&&j(o)?i=i.concat(h.generate(o,n,p)):k(n)&&k(o)?i=i.concat(g(o,n,p)):i.push({op:"replace",path:e+"/"+m,value:n}))}),Object.keys(a).forEach(function(b){l(d[b])&&!c(a,b)&&i.push({op:"remove",path:e+"/"+b})}),i},h.apply=function(a,b){b.forEach(function(b){var c=d(a,b.path),f=b.path.split("/").splice(-1)[0],g=f&&isNaN(+f)?c[f]:c[+f]||c,h=b.from?b.from.split("/").splice(-1)[0]:null;if("add"===b.op||"replace"===b.op)if(k(c))"-"===f&&(f=c.length),c.splice(+f,"add"===b.op?0:1,b.value);else if(k(g)&&k(b.value)){var l=b.value.slice();g.length=0,g.push.apply(g,l)}else j(g)&&j(b.value)?(e(g),i(g,b.value)):c[f]=b.value;else if("move"===b.op){var m=d(a,b.from);k(c)?c.splice(+f,0,m.splice(+h,1)[0]):(c[f]=m[h],delete m[h])}else"remove"===b.op&&(k(c)?c.splice(+f,1):delete c[f])})},h.clone=function(a){return i({},a)},h.createPatch=function(a,b,c){var d={op:a.toLowerCase(),path:c};return"move"===d.op?d.from=b:void 0!==b&&(d.value=b),d},h.updateObject=function(a,b){if(!Object.keys(a).length)return void i(a,b);h.apply(a,h.generate(a,b))},h}),define("core.utils/permissions",[],function(){function a(a,b){return a.length||(a=["update","publish","export","exportdata","changeowner","delete"]),e&&(a=[]),b=b||{},b.update=a.indexOf("update")!==-1,b.publish=a.indexOf("publish")!==-1,b.export=a.indexOf("export")!==-1,b.exportData=a.indexOf("exportdata")!==-1,b.changeOwner=a.indexOf("changeowner")!==-1,b.remove=a.indexOf("delete")!==-1,b}function b(a,b){b=b||{};for(var c in b)delete b[c];return e?b:(a.forEach(function(a){a.canCreate&&(b["create"+a.resource[0].toUpperCase()+a.resource.substring(1)]=!0)}),b)}function c(c,f){var g={};return c.permissions||Object.defineProperty(c,"permissions",{configurable:!1,enumerable:!1,get:function(){return c&&(f&&(e=c.qReadOnly,b(c.create||d,g)),a(c.privileges||c.qMeta&&c.qMeta.privileges||[],g)),g}}),c}var d=[{resource:"sheet",canCreate:!0},{resource:"bookmark",canCreate:!0},{
resource:"story",canCreate:!0},{resource:"searchhistory",canCreate:!0},{resource:"dimension",canCreate:!0},{resource:"measure",canCreate:!0},{resource:"masterobject",canCreate:!0}],e=!0;return{mapToLayout:c,parse:a,parseCreate:b}}),define("core.utils/model-garbage-collector",["core.utils/notification","core.utils/debug-flags"],function(a,b){function c(a){return a.Invalidated&&a.Invalidated.observers&&0===a.Invalidated.observers.length}function d(){for(var a,d=g.length;d--;)a=g[d],b.RELEASEMODELS&&window.console.info("[DBGFLG:RELEASEMODEL] Checking model (id, handle, model):",a.id,a.handle,a),c(a)&&(e(a),g.splice(d,1))}function e(c){b.RELEASEMODELS&&window.console.info("[DBGFLG:RELEASEMODEL] Releasing model (id):",c.id),a.release(c);for(var d in c)delete c[d]}function f(a){g.push(a)}var g=[];return setInterval(d,1e4),{addToQueue:f}}),define("text!autogenerated/qix/jsonspec.json",[],function(){
return'{\r\n\t"structs": {\r\n\t\t"Field":{\r\n\t\t\t"GetCardinal": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetAndMode": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"SelectValues": {\r\n\t\t\t\t"In": [{ "Name": "qFieldValues","DefaultValue": [{"qText": "", "qIsNumeric": false, "qNumber": 0}] }, { "Name": "qToggleMode","DefaultValue": false, "Optional": true }, { "Name": "qSoftLock","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"Select": {\r\n\t\t\t\t"In": [{ "Name": "qMatch","DefaultValue": "" }, { "Name": "qSoftLock","DefaultValue": false, "Optional": true }, { "Name": "qExcludedValuesMode","DefaultValue": 0, "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"ToggleSelect": {\r\n\t\t\t\t"In": [{ "Name": "qMatch","DefaultValue": "" }, { "Name": "qSoftLock","DefaultValue": false, "Optional": true }, { "Name": "qExcludedValuesMode","DefaultValue": 0, "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"ClearAllButThis": {\r\n\t\t\t\t"In": [{ "Name": "qSoftLock","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"SelectPossible": {\r\n\t\t\t\t"In": [{ "Name": "qSoftLock","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"SelectExcluded": {\r\n\t\t\t\t"In": [{ "Name": "qSoftLock","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"SelectAll": {\r\n\t\t\t\t"In": [{ "Name": "qSoftLock","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"Lock": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"Unlock": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetNxProperties": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qProperties" }]\r\n\t\t\t},\r\n\t\t\t"SetNxProperties": {\r\n\t\t\t\t"In": [{ "Name": "qProperties","DefaultValue": {"qOneAndOnlyOne": false} }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"SetAndMode": {\r\n\t\t\t\t"In": [{ "Name": "qAndMode","DefaultValue": false }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"SelectAlternative": {\r\n\t\t\t\t"In": [{ "Name": "qSoftLock","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"LowLevelSelect": {\r\n\t\t\t\t"In": [{ "Name": "qValues","DefaultValue": [0] }, { "Name": "qToggleMode","DefaultValue": false }, { "Name": "qSoftLock","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"Clear": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t}\r\n\t\t},\r\n\t\t"Variable":{\r\n\t\t\t"GetContent": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qContent" }]\r\n\t\t\t},\r\n\t\t\t"GetRawContent": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"SetContent": {\r\n\t\t\t\t"In": [{ "Name": "qContent","DefaultValue": "" }, { "Name": "qUpdateMRU","DefaultValue": false }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"ForceContent": {\r\n\t\t\t\t"In": [{ "Name": "qs","DefaultValue": "" }, { "Name": "qd","DefaultValue": 0 }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetNxProperties": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qProperties" }]\r\n\t\t\t},\r\n\t\t\t"SetNxProperties": {\r\n\t\t\t\t"In": [{ "Name": "qProperties","DefaultValue": {"qName": "", "qNumberPresentation": {"qType": 0, "qnDec": 0, "qUseThou": 0, "qFmt": "", "qDec": "", "qThou": ""}, "qIncludeInBookmark": false, "qUsePredefListedValues": false, "qPreDefinedList": [""]} }],\r\n\t\t\t\t"Out": []\r\n\t\t\t}\r\n\t\t},\r\n\t\t"GenericObject":{\r\n\t\t\t"GetLayout": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qLayout" }]\r\n\t\t\t},\r\n\t\t\t"GetListObjectData": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qPages","DefaultValue": [{"qLeft": 0, "qTop": 0, "qWidth": 0, "qHeight": 0}] }],\r\n\t\t\t\t"Out": [{ "Name": "qDataPages" }]\r\n\t\t\t},\r\n\t\t\t"GetHyperCubeData": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qPages","DefaultValue": [{"qLeft": 0, "qTop": 0, "qWidth": 0, "qHeight": 0}] }],\r\n\t\t\t\t"Out": [{ "Name": "qDataPages" }]\r\n\t\t\t},\r\n\t\t\t"GetHyperCubeReducedData": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qPages","DefaultValue": [{"qLeft": 0, "qTop": 0, "qWidth": 0, "qHeight": 0}] }, { "Name": "qZoomFactor","DefaultValue": 0 }, { "Name": "qReductionMode","DefaultValue": 0 }],\r\n\t\t\t\t"Out": [{ "Name": "qDataPages" }]\r\n\t\t\t},\r\n\t\t\t"GetHyperCubePivotData": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qPages","DefaultValue": [{"qLeft": 0, "qTop": 0, "qWidth": 0, "qHeight": 0}] }],\r\n\t\t\t\t"Out": [{ "Name": "qDataPages" }]\r\n\t\t\t},\r\n\t\t\t"GetHyperCubeStackData": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qPages","DefaultValue": [{"qLeft": 0, "qTop": 0, "qWidth": 0, "qHeight": 0}] }, { "Name": "qMaxNbrCells","DefaultValue": 0, "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qDataPages" }]\r\n\t\t\t},\r\n\t\t\t"GetHyperCubeContinuousData": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qOptions","DefaultValue": {"qStart": 0, "qEnd": 0, "qNbrPoints": 0, "qMaxNbrTicks": 0, "qMaxNumberLines": 0} }, { "Name": "qReverseSort","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qDataPages" }, { "Name": "qAxisData" }]\r\n\t\t\t},\r\n\t\t\t"GetHyperCubeBinnedData": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qPages","DefaultValue": [{"qLeft": 0, "qTop": 0, "qWidth": 0, "qHeight": 0}] }, { "Name": "qViewport","DefaultValue": {"qWidth": 0, "qHeight": 0, "qZoomLevel": 0} }, { "Name": "qDataRanges","DefaultValue": [{"qLeft": 0, "qTop": 0, "qWidth": 0, "qHeight": 0}] }, { "Name": "qMaxNbrCells","DefaultValue": 0 }, { "Name": "qQueryLevel","DefaultValue": 0 }, { "Name": "qBinningMethod","DefaultValue": 0 }],\r\n\t\t\t\t"Out": [{ "Name": "qDataPages" }]\r\n\t\t\t},\r\n\t\t\t"ApplyPatches": {\r\n\t\t\t\t"In": [{ "Name": "qPatches","DefaultValue": [{"qOp": 0, "qPath": "", "qValue": ""}] }, { "Name": "qSoftPatch","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"ClearSoftPatches": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"SetProperties": {\r\n\t\t\t\t"In": [{ "Name": "qProp","DefaultValue": {"qInfo": {"qId": "", "qType": ""}, "qExtendsId": "", "qMetaDef": {}} }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetProperties": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qProp" }]\r\n\t\t\t},\r\n\t\t\t"GetEffectiveProperties": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qProp" }]\r\n\t\t\t},\r\n\t\t\t"SetFullPropertyTree": {\r\n\t\t\t\t"In": [{ "Name": "qPropEntry","DefaultValue": {"qProperty": {"qInfo": {"qId": "", "qType": ""}, "qExtendsId": "", "qMetaDef": {}}, "qChildren": [], "qEmbeddedSnapshotRef": null} }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetFullPropertyTree": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qPropEntry" }]\r\n\t\t\t},\r\n\t\t\t"GetInfo": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qInfo" }]\r\n\t\t\t},\r\n\t\t\t"ClearSelections": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qColIndices","DefaultValue": [0], "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"ExportData": {\r\n\t\t\t\t"In": [{ "Name": "qFileType","DefaultValue": 0 }, { "Name": "qPath","DefaultValue": "", "Optional": true }, { "Name": "qFileName","DefaultValue": "", "Optional": true }, { "Name": "qExportState","DefaultValue": 0, "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qUrl" }, { "Name": "qWarnings" }]\r\n\t\t\t},\r\n\t\t\t"SelectListObjectValues": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qValues","DefaultValue": [0] }, { "Name": "qToggleMode","DefaultValue": false }, { "Name": "qSoftLock","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"SelectListObjectPossible": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qSoftLock","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"SelectListObjectExcluded": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qSoftLock","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"SelectListObjectAlternative": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qSoftLock","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"SelectListObjectAll": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qSoftLock","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"SelectListObjectContinuousRange": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qRanges","DefaultValue": [{"qMin": 0, "qMax": 0, "qMinInclEq": false, "qMaxInclEq": false}] }, { "Name": "qSoftLock","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"SearchListObjectFor": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qMatch","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"AbortListObjectSearch": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"AcceptListObjectSearch": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qToggleMode","DefaultValue": false }, { "Name": "qSoftLock","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"ExpandLeft": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qRow","DefaultValue": 0 }, { "Name": "qCol","DefaultValue": 0 }, { "Name": "qAll","DefaultValue": false }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"ExpandTop": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qRow","DefaultValue": 0 }, { "Name": "qCol","DefaultValue": 0 }, { "Name": "qAll","DefaultValue": false }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"CollapseLeft": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qRow","DefaultValue": 0 }, { "Name": "qCol","DefaultValue": 0 }, { "Name": "qAll","DefaultValue": false }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"CollapseTop": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qRow","DefaultValue": 0 }, { "Name": "qCol","DefaultValue": 0 }, { "Name": "qAll","DefaultValue": false }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"DrillUp": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qDimNo","DefaultValue": 0 }, { "Name": "qNbrSteps","DefaultValue": 0 }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"Lock": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qColIndices","DefaultValue": [0], "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"Unlock": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qColIndices","DefaultValue": [0], "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"SelectHyperCubeValues": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qDimNo","DefaultValue": 0 }, { "Name": "qValues","DefaultValue": [0] }, { "Name": "qToggleMode","DefaultValue": false }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"SelectHyperCubeCells": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qRowIndices","DefaultValue": [0] }, { "Name": "qColIndices","DefaultValue": [0] }, { "Name": "qSoftLock","DefaultValue": false, "Optional": true }, { "Name": "qDeselectOnlyOneSelected","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"SelectPivotCells": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qSelections","DefaultValue": [{"qType": 0, "qCol": 0, "qRow": 0}] }, { "Name": "qSoftLock","DefaultValue": false, "Optional": true }, { "Name": "qDeselectOnlyOneSelected","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"RangeSelectHyperCubeValues": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qRanges","DefaultValue": [{"qRange": {"qMin": 0, "qMax": 0, "qMinInclEq": false, "qMaxInclEq": false}, "qMeasureIx": 0}] }, { "Name": "qColumnsToSelect","DefaultValue": [0], "Optional": true }, { "Name": "qOrMode","DefaultValue": false, "Optional": true }, { "Name": "qDeselectOnlyOneSelected","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"MultiRangeSelectHyperCubeValues": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qRanges","DefaultValue": [{"qRanges": [{"qRange": {"qMin": 0, "qMax": 0, "qMinInclEq": false, "qMaxInclEq": false}, "qMeasureIx": 0}], "qColumnsToSelect": [0]}] }, { "Name": "qOrMode","DefaultValue": false, "Optional": true }, { "Name": "qDeselectOnlyOneSelected","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"SelectHyperCubeContinuousRange": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }, { "Name": "qRanges","DefaultValue": [{"qRange": {"qMin": 0, "qMax": 0, "qMinInclEq": false, "qMaxInclEq": false}, "qDimIx": 0}] }, { "Name": "qSoftLock","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"GetChild": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetChildInfos": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qInfos" }]\r\n\t\t\t},\r\n\t\t\t"CreateChild": {\r\n\t\t\t\t"In": [{ "Name": "qProp","DefaultValue": {"qInfo": {"qId": "", "qType": ""}, "qExtendsId": "", "qMetaDef": {}} }, { "Name": "qPropForThis","DefaultValue": null, "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qInfo" }]\r\n\t\t\t},\r\n\t\t\t"DestroyChild": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }, { "Name": "qPropForThis","DefaultValue": null, "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"DestroyAllChildren": {\r\n\t\t\t\t"In": [{ "Name": "qPropForThis","DefaultValue": null, "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"SetChildArrayOrder": {\r\n\t\t\t\t"In": [{ "Name": "qIds","DefaultValue": [""] }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetLinkedObjects": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qItems" }]\r\n\t\t\t},\r\n\t\t\t"CopyFrom": {\r\n\t\t\t\t"In": [{ "Name": "qFromId","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"BeginSelections": {\r\n\t\t\t\t"In": [{ "Name": "qPaths","DefaultValue": [""] }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"EndSelections": {\r\n\t\t\t\t"In": [{ "Name": "qAccept","DefaultValue": false }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"ResetMadeSelections": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"EmbedSnapshotObject": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetSnapshotObject": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"Publish": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"UnPublish": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t}\r\n\t\t},\r\n\t\t"GenericDimension":{\r\n\t\t\t"GetLayout": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qLayout" }]\r\n\t\t\t},\r\n\t\t\t"ApplyPatches": {\r\n\t\t\t\t"In": [{ "Name": "qPatches","DefaultValue": [{"qOp": 0, "qPath": "", "qValue": ""}] }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"SetProperties": {\r\n\t\t\t\t"In": [{ "Name": "qProp","DefaultValue": {"qInfo": {"qId": "", "qType": ""}, "qDim": {"qGrouping": 0, "qFieldDefs": [""], "qFieldLabels": [""]}, "qMetaDef": {}} }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetProperties": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qProp" }]\r\n\t\t\t},\r\n\t\t\t"GetInfo": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qInfo" }]\r\n\t\t\t},\r\n\t\t\t"GetDimension": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qDim" }]\r\n\t\t\t},\r\n\t\t\t"GetLinkedObjects": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qItems" }]\r\n\t\t\t},\r\n\t\t\t"Publish": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"UnPublish": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t}\r\n\t\t},\r\n\t\t"GenericBookmark":{\r\n\t\t\t"GetFieldValues": {\r\n\t\t\t\t"In": [{ "Name": "qField","DefaultValue": "" }, { "Name": "qGetExcludedValues","DefaultValue": false }, { "Name": "qDataPage","DefaultValue": {"qStartIndex": 0, "qEndIndex": 0} }],\r\n\t\t\t\t"Out": [{ "Name": "qFieldValues" }]\r\n\t\t\t},\r\n\t\t\t"GetLayout": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qLayout" }]\r\n\t\t\t},\r\n\t\t\t"ApplyPatches": {\r\n\t\t\t\t"In": [{ "Name": "qPatches","DefaultValue": [{"qOp": 0, "qPath": "", "qValue": ""}] }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"SetProperties": {\r\n\t\t\t\t"In": [{ "Name": "qProp","DefaultValue": {"qInfo": {"qId": "", "qType": ""}, "qMetaDef": {}} }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetProperties": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qProp" }]\r\n\t\t\t},\r\n\t\t\t"GetInfo": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qInfo" }]\r\n\t\t\t},\r\n\t\t\t"Apply": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"Publish": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"UnPublish": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t}\r\n\t\t},\r\n\t\t"GenericVariable":{\r\n\t\t\t"GetLayout": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qLayout" }]\r\n\t\t\t},\r\n\t\t\t"ApplyPatches": {\r\n\t\t\t\t"In": [{ "Name": "qPatches","DefaultValue": [{"qOp": 0, "qPath": "", "qValue": ""}] }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"SetProperties": {\r\n\t\t\t\t"In": [{ "Name": "qProp","DefaultValue": {"qInfo": {"qId": "", "qType": ""}, "qMetaDef": {}, "qName": "", "qComment": "", "qNumberPresentation": {"qType": 0, "qnDec": 0, "qUseThou": 0, "qFmt": "", "qDec": "", "qThou": ""}, "qIncludeInBookmark": false, "qDefinition": ""} }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetProperties": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qProp" }]\r\n\t\t\t},\r\n\t\t\t"GetInfo": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qInfo" }]\r\n\t\t\t},\r\n\t\t\t"SetStringValue": {\r\n\t\t\t\t"In": [{ "Name": "qVal","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"SetNumValue": {\r\n\t\t\t\t"In": [{ "Name": "qVal","DefaultValue": 0 }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"SetDualValue": {\r\n\t\t\t\t"In": [{ "Name": "qText","DefaultValue": "" }, { "Name": "qNum","DefaultValue": 0 }],\r\n\t\t\t\t"Out": []\r\n\t\t\t}\r\n\t\t},\r\n\t\t"GenericMeasure":{\r\n\t\t\t"GetLayout": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qLayout" }]\r\n\t\t\t},\r\n\t\t\t"ApplyPatches": {\r\n\t\t\t\t"In": [{ "Name": "qPatches","DefaultValue": [{"qOp": 0, "qPath": "", "qValue": ""}] }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"SetProperties": {\r\n\t\t\t\t"In": [{ "Name": "qProp","DefaultValue": {"qInfo": {"qId": "", "qType": ""}, "qMeasure": {"qLabel": "", "qDef": "", "qGrouping": 0, "qExpressions": [""], "qActiveExpression": 0}, "qMetaDef": {}} }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetProperties": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qProp" }]\r\n\t\t\t},\r\n\t\t\t"GetInfo": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qInfo" }]\r\n\t\t\t},\r\n\t\t\t"GetMeasure": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qMeasure" }]\r\n\t\t\t},\r\n\t\t\t"GetLinkedObjects": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qItems" }]\r\n\t\t\t},\r\n\t\t\t"Publish": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"UnPublish": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t}\r\n\t\t},\r\n\t\t"GenericDerivedFields":{\r\n\t\t\t"SetProperties": {\r\n\t\t\t\t"In": [{ "Name": "qProp","DefaultValue": {"qInfo": {"qId": "", "qType": ""}, "qDerivedDefinitionId": "", "qFieldName": [""], "qMetaDef": {}} }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetProperties": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qProp" }]\r\n\t\t\t},\r\n\t\t\t"GetInfo": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qInfo" }]\r\n\t\t\t},\r\n\t\t\t"GetDerivedFieldData": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qData" }]\r\n\t\t\t},\r\n\t\t\t"GetDerivedField": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qFields" }]\r\n\t\t\t},\r\n\t\t\t"GetListData": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qListData" }]\r\n\t\t\t},\r\n\t\t\t"GetDerivedFields": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qFields" }]\r\n\t\t\t},\r\n\t\t\t"GetDerivedGroups": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qGroups" }]\r\n\t\t\t}\r\n\t\t},\r\n\t\t"Doc":{\r\n\t\t\t"GetField": {\r\n\t\t\t\t"In": [{ "Name": "qFieldName","DefaultValue": "" }, { "Name": "qStateName","DefaultValue": "", "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetFieldDescription": {\r\n\t\t\t\t"In": [{ "Name": "qFieldName","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetVariable": {\r\n\t\t\t\t"In": [{ "Name": "qName","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetLooselyCoupledVector": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qv" }]\r\n\t\t\t},\r\n\t\t\t"SetLooselyCoupledVector": {\r\n\t\t\t\t"In": [{ "Name": "qv","DefaultValue": [0] }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"Evaluate": {\r\n\t\t\t\t"In": [{ "Name": "qExpression","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"EvaluateEx": {\r\n\t\t\t\t"In": [{ "Name": "qExpression","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qValue" }]\r\n\t\t\t},\r\n\t\t\t"ClearAll": {\r\n\t\t\t\t"In": [{ "Name": "qLockedAlso","DefaultValue": false, "Optional": true }, { "Name": "qStateName","DefaultValue": "", "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"LockAll": {\r\n\t\t\t\t"In": [{ "Name": "qStateName","DefaultValue": "", "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"UnlockAll": {\r\n\t\t\t\t"In": [{ "Name": "qStateName","DefaultValue": "", "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"Back": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"Forward": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"ReduceData": {\r\n\t\t\t\t"In": [{ "Name": "qConfirm","DefaultValue": false, "Optional": true }, { "Name": "qDropFieldNames","DefaultValue": [""], "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"RemoveAllData": {\r\n\t\t\t\t"In": [{ "Name": "qConfirm","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"CreateVariable": {\r\n\t\t\t\t"In": [{ "Name": "qName","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"RemoveVariable": {\r\n\t\t\t\t"In": [{ "Name": "qName","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetLocaleInfo": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetTablesAndKeys": {\r\n\t\t\t\t"In": [{ "Name": "qWindowSize","DefaultValue": {"qcx": 0, "qcy": 0} }, { "Name": "qNullSize","DefaultValue": {"qcx": 0, "qcy": 0} }, { "Name": "qCellHeight","DefaultValue": 0 }, { "Name": "qSyntheticMode","DefaultValue": false }, { "Name": "qIncludeSysVars","DefaultValue": false }],\r\n\t\t\t\t"Out": [{ "Name": "qtr" }, { "Name": "qk" }]\r\n\t\t\t},\r\n\t\t\t"GetViewDlgSaveInfo": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"SetViewDlgSaveInfo": {\r\n\t\t\t\t"In": [{ "Name": "qInfo","DefaultValue": {"qPos": {"qLeft": 0, "qTop": 0, "qWidth": 0, "qHeight": 0}, "qCtlInfo": {"qInternalView": {"qTables": [{"qPos": {"qLeft": 0, "qTop": 0, "qWidth": 0, "qHeight": 0}, "qCaption": ""}], "qBroomPoints": [{"qPos": {"qx": 0, "qy": 0}, "qTable": "", "qFields": [""]}], "qConnectionPoints": [{"qPos": {"qx": 0, "qy": 0}, "qFields": [""]}], "qZoomFactor": 0}, "qSourceView": {"qTables": [{"qPos": {"qLeft": 0, "qTop": 0, "qWidth": 0, "qHeight": 0}, "qCaption": ""}], "qBroomPoints": [{"qPos": {"qx": 0, "qy": 0}, "qTable": "", "qFields": [""]}], "qConnectionPoints": [{"qPos": {"qx": 0, "qy": 0}, "qFields": [""]}], "qZoomFactor": 0}}, "qMode": 0} }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetEmptyScript": {\r\n\t\t\t\t"In": [{ "Name": "qLocalizedMainSection","DefaultValue": "", "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"DoReload": {\r\n\t\t\t\t"In": [{ "Name": "qMode","DefaultValue": 0, "Optional": true }, { "Name": "qPartial","DefaultValue": false, "Optional": true }, { "Name": "qDebug","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetScriptBreakpoints": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qBreakpoints" }]\r\n\t\t\t},\r\n\t\t\t"SetScriptBreakpoints": {\r\n\t\t\t\t"In": [{ "Name": "qBreakpoints","DefaultValue": [{"qbufferName": "", "qlineIx": 0, "qEnabled": false}] }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetScript": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qScript" }]\r\n\t\t\t},\r\n\t\t\t"GetTextMacros": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qMacros" }]\r\n\t\t\t},\r\n\t\t\t"SetFetchLimit": {\r\n\t\t\t\t"In": [{ "Name": "qLimit","DefaultValue": 0 }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"DoSave": {\r\n\t\t\t\t"In": [{ "Name": "qFileName","DefaultValue": "", "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetTableData": {\r\n\t\t\t\t"In": [{ "Name": "qOffset","DefaultValue": 0 }, { "Name": "qRows","DefaultValue": 0 }, { "Name": "qSyntheticMode","DefaultValue": false }, { "Name": "qTableName","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qData" }]\r\n\t\t\t},\r\n\t\t\t"GetAppLayout": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qLayout" }]\r\n\t\t\t},\r\n\t\t\t"SetAppProperties": {\r\n\t\t\t\t"In": [{ "Name": "qProp","DefaultValue": {"qTitle": "", "qLastReloadTime": "", "qMigrationHash": "", "qSavedInProductVersion": "", "qThumbnail": {"qUrl": ""}} }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetAppProperties": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qProp" }]\r\n\t\t\t},\r\n\t\t\t"CreateSessionObject": {\r\n\t\t\t\t"In": [{ "Name": "qProp","DefaultValue": {"qInfo": {"qId": "", "qType": ""}, "qExtendsId": "", "qMetaDef": {}} }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"DestroySessionObject": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"CreateObject": {\r\n\t\t\t\t"In": [{ "Name": "qProp","DefaultValue": {"qInfo": {"qId": "", "qType": ""}, "qExtendsId": "", "qMetaDef": {}} }],\r\n\t\t\t\t"Out": [{ "Name": "qInfo" }]\r\n\t\t\t},\r\n\t\t\t"DestroyObject": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"GetObject": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"CloneObject": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qCloneId" }]\r\n\t\t\t},\r\n\t\t\t"CreateDraft": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qDraftId" }]\r\n\t\t\t},\r\n\t\t\t"CommitDraft": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"DestroyDraft": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }, { "Name": "qSourceId","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"Undo": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"Redo": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"ClearUndoBuffer": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"CreateDimension": {\r\n\t\t\t\t"In": [{ "Name": "qProp","DefaultValue": {"qInfo": {"qId": "", "qType": ""}, "qDim": {"qGrouping": 0, "qFieldDefs": [""], "qFieldLabels": [""]}, "qMetaDef": {}} }],\r\n\t\t\t\t"Out": [{ "Name": "qInfo" }]\r\n\t\t\t},\r\n\t\t\t"DestroyDimension": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"GetDimension": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"CloneDimension": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qCloneId" }]\r\n\t\t\t},\r\n\t\t\t"CreateMeasure": {\r\n\t\t\t\t"In": [{ "Name": "qProp","DefaultValue": {"qInfo": {"qId": "", "qType": ""}, "qMeasure": {"qLabel": "", "qDef": "", "qGrouping": 0, "qExpressions": [""], "qActiveExpression": 0}, "qMetaDef": {}} }],\r\n\t\t\t\t"Out": [{ "Name": "qInfo" }]\r\n\t\t\t},\r\n\t\t\t"DestroyMeasure": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"GetMeasure": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"CloneMeasure": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qCloneId" }]\r\n\t\t\t},\r\n\t\t\t"CreateSessionVariable": {\r\n\t\t\t\t"In": [{ "Name": "qProp","DefaultValue": {"qInfo": {"qId": "", "qType": ""}, "qMetaDef": {}, "qName": "", "qComment": "", "qNumberPresentation": {"qType": 0, "qnDec": 0, "qUseThou": 0, "qFmt": "", "qDec": "", "qThou": ""}, "qIncludeInBookmark": false, "qDefinition": ""} }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"DestroySessionVariable": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"CreateVariableEx": {\r\n\t\t\t\t"In": [{ "Name": "qProp","DefaultValue": {"qInfo": {"qId": "", "qType": ""}, "qMetaDef": {}, "qName": "", "qComment": "", "qNumberPresentation": {"qType": 0, "qnDec": 0, "qUseThou": 0, "qFmt": "", "qDec": "", "qThou": ""}, "qIncludeInBookmark": false, "qDefinition": ""} }],\r\n\t\t\t\t"Out": [{ "Name": "qInfo" }]\r\n\t\t\t},\r\n\t\t\t"DestroyVariableById": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"DestroyVariableByName": {\r\n\t\t\t\t"In": [{ "Name": "qName","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"GetVariableById": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetVariableByName": {\r\n\t\t\t\t"In": [{ "Name": "qName","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"MigrateVariables": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"MigrateDerivedFields": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"CheckExpression": {\r\n\t\t\t\t"In": [{ "Name": "qExpr","DefaultValue": "" }, { "Name": "qLabels","DefaultValue": [""], "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qErrorMsg" }, { "Name": "qBadFieldNames" }, { "Name": "qDangerousFieldNames" }]\r\n\t\t\t},\r\n\t\t\t"CheckNumberOrExpression": {\r\n\t\t\t\t"In": [{ "Name": "qExpr","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qErrorMsg" }, { "Name": "qBadFieldNames" }]\r\n\t\t\t},\r\n\t\t\t"AddAlternateState": {\r\n\t\t\t\t"In": [{ "Name": "qStateName","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"RemoveAlternateState": {\r\n\t\t\t\t"In": [{ "Name": "qStateName","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"CreateBookmark": {\r\n\t\t\t\t"In": [{ "Name": "qProp","DefaultValue": {"qInfo": {"qId": "", "qType": ""}, "qMetaDef": {}} }],\r\n\t\t\t\t"Out": [{ "Name": "qInfo" }]\r\n\t\t\t},\r\n\t\t\t"DestroyBookmark": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"GetBookmark": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"ApplyBookmark": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"CloneBookmark": {\r\n\t\t\t\t"In": [{ "Name": "qId","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qCloneId" }]\r\n\t\t\t},\r\n\t\t\t"AddFieldFromExpression": {\r\n\t\t\t\t"In": [{ "Name": "qName","DefaultValue": "" }, { "Name": "qExpr","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"GetAllInfos": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qInfos" }]\r\n\t\t\t},\r\n\t\t\t"Resume": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"AbortModal": {\r\n\t\t\t\t"In": [{ "Name": "qAccept","DefaultValue": false }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"Publish": {\r\n\t\t\t\t"In": [{ "Name": "qStreamId","DefaultValue": "" }, { "Name": "qName","DefaultValue": "", "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"UnPublish": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetMatchingFields": {\r\n\t\t\t\t"In": [{ "Name": "qTags","DefaultValue": [""] }, { "Name": "qMatchingFieldMode","DefaultValue": 0, "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qFieldNames" }]\r\n\t\t\t},\r\n\t\t\t"FindMatchingFields": {\r\n\t\t\t\t"In": [{ "Name": "qFieldName","DefaultValue": "" }, { "Name": "qTags","DefaultValue": [""] }],\r\n\t\t\t\t"Out": [{ "Name": "qFieldNames" }]\r\n\t\t\t},\r\n\t\t\t"Scramble": {\r\n\t\t\t\t"In": [{ "Name": "qFieldName","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"SaveObjects": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetAssociationScores": {\r\n\t\t\t\t"In": [{ "Name": "qTable1","DefaultValue": "" }, { "Name": "qTable2","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qScore" }]\r\n\t\t\t},\r\n\t\t\t"GetMediaList": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qList" }]\r\n\t\t\t},\r\n\t\t\t"GetContentLibraries": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qList" }]\r\n\t\t\t},\r\n\t\t\t"GetLibraryContent": {\r\n\t\t\t\t"In": [{ "Name": "qName","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qList" }]\r\n\t\t\t},\r\n\t\t\t"DoReloadEx": {\r\n\t\t\t\t"In": [{ "Name": "qParams","DefaultValue": {"qMode": 0, "qPartial": false, "qDebug": false}, "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qResult" }]\r\n\t\t\t},\r\n\t\t\t"BackCount": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"ForwardCount": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"SetScript": {\r\n\t\t\t\t"In": [{ "Name": "qScript","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"CheckScriptSyntax": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qErrors" }]\r\n\t\t\t},\r\n\t\t\t"GetFavoriteVariables": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qNames" }]\r\n\t\t\t},\r\n\t\t\t"SetFavoriteVariables": {\r\n\t\t\t\t"In": [{ "Name": "qNames","DefaultValue": [""] }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetIncludeFileContent": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qContent" }]\r\n\t\t\t},\r\n\t\t\t"CreateConnection": {\r\n\t\t\t\t"In": [{ "Name": "qConnection","DefaultValue": {"qId": "", "qName": "", "qConnectionString": "", "qType": "", "qUserName": "", "qPassword": "", "qModifiedDate": "", "qMeta": {"qName": ""}, "qLogOn": 0} }],\r\n\t\t\t\t"Out": [{ "Name": "qConnectionId" }]\r\n\t\t\t},\r\n\t\t\t"ModifyConnection": {\r\n\t\t\t\t"In": [{ "Name": "qConnectionId","DefaultValue": "" }, { "Name": "qConnection","DefaultValue": {"qId": "", "qName": "", "qConnectionString": "", "qType": "", "qUserName": "", "qPassword": "", "qModifiedDate": "", "qMeta": {"qName": ""}, "qLogOn": 0} }, { "Name": "qOverrideCredentials","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"DeleteConnection": {\r\n\t\t\t\t"In": [{ "Name": "qConnectionId","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetConnection": {\r\n\t\t\t\t"In": [{ "Name": "qConnectionId","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qConnection" }]\r\n\t\t\t},\r\n\t\t\t"GetConnections": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qConnections" }]\r\n\t\t\t},\r\n\t\t\t"GetDatabaseInfo": {\r\n\t\t\t\t"In": [{ "Name": "qConnectionId","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qInfo" }]\r\n\t\t\t},\r\n\t\t\t"GetDatabases": {\r\n\t\t\t\t"In": [{ "Name": "qConnectionId","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qDatabases" }]\r\n\t\t\t},\r\n\t\t\t"GetDatabaseOwners": {\r\n\t\t\t\t"In": [{ "Name": "qConnectionId","DefaultValue": "" }, { "Name": "qDatabase","DefaultValue": "", "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qOwners" }]\r\n\t\t\t},\r\n\t\t\t"GetDatabaseTables": {\r\n\t\t\t\t"In": [{ "Name": "qConnectionId","DefaultValue": "" }, { "Name": "qDatabase","DefaultValue": "", "Optional": true }, { "Name": "qOwner","DefaultValue": "", "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qTables" }]\r\n\t\t\t},\r\n\t\t\t"GetDatabaseTableFields": {\r\n\t\t\t\t"In": [{ "Name": "qConnectionId","DefaultValue": "" }, { "Name": "qDatabase","DefaultValue": "", "Optional": true }, { "Name": "qOwner","DefaultValue": "", "Optional": true }, { "Name": "qTable","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qFields" }]\r\n\t\t\t},\r\n\t\t\t"GetDatabaseTablePreview": {\r\n\t\t\t\t"In": [{ "Name": "qConnectionId","DefaultValue": "" }, { "Name": "qDatabase","DefaultValue": "", "Optional": true }, { "Name": "qOwner","DefaultValue": "", "Optional": true }, { "Name": "qTable","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qPreview" }]\r\n\t\t\t},\r\n\t\t\t"GetFolderItemsForConnection": {\r\n\t\t\t\t"In": [{ "Name": "qConnectionId","DefaultValue": "" }, { "Name": "qRelativePath","DefaultValue": "", "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qFolderItems" }]\r\n\t\t\t},\r\n\t\t\t"GuessFileType": {\r\n\t\t\t\t"In": [{ "Name": "qConnectionId","DefaultValue": "" }, { "Name": "qRelativePath","DefaultValue": "", "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qDataFormat" }]\r\n\t\t\t},\r\n\t\t\t"GetFileTables": {\r\n\t\t\t\t"In": [{ "Name": "qConnectionId","DefaultValue": "" }, { "Name": "qRelativePath","DefaultValue": "", "Optional": true }, { "Name": "qDataFormat","DefaultValue": {"qType": 0, "qLabel": "", "qQuote": "", "qComment": "", "qDelimiter": {"qName": "", "qScriptCode": "", "qNumber": 0, "qIsMultiple": false}, "qCodePage": 0, "qHeaderSize": 0, "qRecordSize": 0, "qTabSize": 0, "qIgnoreEOF": false, "qFixedWidthDelimiters": ""} }],\r\n\t\t\t\t"Out": [{ "Name": "qTables" }]\r\n\t\t\t},\r\n\t\t\t"GetFileTableFields": {\r\n\t\t\t\t"In": [{ "Name": "qConnectionId","DefaultValue": "" }, { "Name": "qRelativePath","DefaultValue": "", "Optional": true }, { "Name": "qDataFormat","DefaultValue": {"qType": 0, "qLabel": "", "qQuote": "", "qComment": "", "qDelimiter": {"qName": "", "qScriptCode": "", "qNumber": 0, "qIsMultiple": false}, "qCodePage": 0, "qHeaderSize": 0, "qRecordSize": 0, "qTabSize": 0, "qIgnoreEOF": false, "qFixedWidthDelimiters": ""} }, { "Name": "qTable","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qFields" }, { "Name": "qFormatSpec" }]\r\n\t\t\t},\r\n\t\t\t"GetFileTablePreview": {\r\n\t\t\t\t"In": [{ "Name": "qConnectionId","DefaultValue": "" }, { "Name": "qRelativePath","DefaultValue": "", "Optional": true }, { "Name": "qDataFormat","DefaultValue": {"qType": 0, "qLabel": "", "qQuote": "", "qComment": "", "qDelimiter": {"qName": "", "qScriptCode": "", "qNumber": 0, "qIsMultiple": false}, "qCodePage": 0, "qHeaderSize": 0, "qRecordSize": 0, "qTabSize": 0, "qIgnoreEOF": false, "qFixedWidthDelimiters": ""} }, { "Name": "qTable","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qPreview" }, { "Name": "qFormatSpec" }]\r\n\t\t\t},\r\n\t\t\t"GetFileTablesEx": {\r\n\t\t\t\t"In": [{ "Name": "qConnectionId","DefaultValue": "" }, { "Name": "qRelativePath","DefaultValue": "", "Optional": true }, { "Name": "qDataFormat","DefaultValue": {"qType": 0, "qLabel": "", "qQuote": "", "qComment": "", "qDelimiter": {"qName": "", "qScriptCode": "", "qNumber": 0, "qIsMultiple": false}, "qCodePage": 0, "qHeaderSize": 0, "qRecordSize": 0, "qTabSize": 0, "qIgnoreEOF": false, "qFixedWidthDelimiters": ""} }],\r\n\t\t\t\t"Out": [{ "Name": "qTables" }]\r\n\t\t\t},\r\n\t\t\t"SendGenericCommandToCustomConnector": {\r\n\t\t\t\t"In": [{ "Name": "qProvider","DefaultValue": "" }, { "Name": "qCommand","DefaultValue": "" }, { "Name": "qMethod","DefaultValue": "" }, { "Name": "qParameters","DefaultValue": [""] }, { "Name": "qAppendConnection","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qResult" }]\r\n\t\t\t},\r\n\t\t\t"SearchSuggest": {\r\n\t\t\t\t"In": [{ "Name": "qOptions","DefaultValue": {"qSearchFields": [""], "qContext": 0} }, { "Name": "qTerms","DefaultValue": [""] }],\r\n\t\t\t\t"Out": [{ "Name": "qResult" }]\r\n\t\t\t},\r\n\t\t\t"SearchAssociations": {\r\n\t\t\t\t"In": [{ "Name": "qOptions","DefaultValue": {"qSearchFields": [""], "qContext": 0} }, { "Name": "qTerms","DefaultValue": [""] }, { "Name": "qPage","DefaultValue": {"qOffset": 0, "qCount": 0, "qMaxNbrFieldMatches": 0, "qGroupOptions": [{"qGroupType": 0, "qOffset": 0, "qCount": 0}], "qGroupItemOptions": [{"qGroupItemType": 0, "qOffset": 0, "qCount": 0}]} }],\r\n\t\t\t\t"Out": [{ "Name": "qResults" }]\r\n\t\t\t},\r\n\t\t\t"SelectAssociations": {\r\n\t\t\t\t"In": [{ "Name": "qOptions","DefaultValue": {"qSearchFields": [""], "qContext": 0} }, { "Name": "qTerms","DefaultValue": [""] }, { "Name": "qMatchIx","DefaultValue": 0 }, { "Name": "qSoftLock","DefaultValue": null, "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"SearchResults": {\r\n\t\t\t\t"In": [{ "Name": "qOptions","DefaultValue": {"qSearchFields": [""], "qContext": 0} }, { "Name": "qTerms","DefaultValue": [""] }, { "Name": "qPage","DefaultValue": {"qOffset": 0, "qCount": 0, "qMaxNbrFieldMatches": 0, "qGroupOptions": [{"qGroupType": 0, "qOffset": 0, "qCount": 0}], "qGroupItemOptions": [{"qGroupItemType": 0, "qOffset": 0, "qCount": 0}]} }],\r\n\t\t\t\t"Out": [{ "Name": "qResult" }]\r\n\t\t\t},\r\n\t\t\t"SearchObjects": {\r\n\t\t\t\t"In": [{ "Name": "qOptions","DefaultValue": {"qAttributes": [""]} }, { "Name": "qTerms","DefaultValue": [""] }, { "Name": "qPage","DefaultValue": {"qOffset": 0, "qCount": 0, "qMaxNbrFieldMatches": 0, "qGroupOptions": [{"qGroupType": 0, "qOffset": 0, "qCount": 0}], "qGroupItemOptions": [{"qGroupItemType": 0, "qOffset": 0, "qCount": 0}]} }],\r\n\t\t\t\t"Out": [{ "Name": "qResult" }]\r\n\t\t\t}\r\n\t\t},\r\n\t\t"Global":{\r\n\t\t\t"AbortRequest": {\r\n\t\t\t\t"In": [{ "Name": "qRequestId","DefaultValue": 0 }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"AbortAll": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetProgress": {\r\n\t\t\t\t"In": [{ "Name": "qRequestId","DefaultValue": 0 }],\r\n\t\t\t\t"Out": [{ "Name": "qProgressData" }]\r\n\t\t\t},\r\n\t\t\t"QvVersion": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"OSVersion": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"OSName": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"QTProduct": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetDocList": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qDocList" }]\r\n\t\t\t},\r\n\t\t\t"GetInteract": {\r\n\t\t\t\t"In": [{ "Name": "qRequestId","DefaultValue": 0 }],\r\n\t\t\t\t"Out": [{ "Name": "qDef" }]\r\n\t\t\t},\r\n\t\t\t"InteractDone": {\r\n\t\t\t\t"In": [{ "Name": "qRequestId","DefaultValue": 0 }, { "Name": "qDef","DefaultValue": {"qType": 0, "qTitle": "", "qMsg": "", "qButtons": 0, "qLine": "", "qOldLineNr": 0, "qNewLineNr": 0, "qPath": "", "qHidden": false, "qResult": 0, "qInput": ""} }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetAuthenticatedUser": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetStreamList": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qStreamList" }]\r\n\t\t\t},\r\n\t\t\t"UploadToContentService": {\r\n\t\t\t\t"In": [{ "Name": "qDirectory","DefaultValue": "" }, { "Name": "qAppId","DefaultValue": "" }, { "Name": "qQrsObjects","DefaultValue": [{"qEngineObjectID": "", "qItemID": ""}] }],\r\n\t\t\t\t"Out": [{ "Name": "qUploadedObjects" }]\r\n\t\t\t},\r\n\t\t\t"CreateDocEx": {\r\n\t\t\t\t"In": [{ "Name": "qDocName","DefaultValue": "" }, { "Name": "qUserName","DefaultValue": "", "Optional": true }, { "Name": "qPassword","DefaultValue": "", "Optional": true }, { "Name": "qSerial","DefaultValue": "", "Optional": true }, { "Name": "qLocalizedScriptMainSection","DefaultValue": "", "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qDocId" }]\r\n\t\t\t},\r\n\t\t\t"GetActiveDoc": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"AllowCreateApp": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"CreateApp": {\r\n\t\t\t\t"In": [{ "Name": "qAppName","DefaultValue": "" }, { "Name": "qLocalizedScriptMainSection","DefaultValue": "", "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }, { "Name": "qAppId" }]\r\n\t\t\t},\r\n\t\t\t"DeleteApp": {\r\n\t\t\t\t"In": [{ "Name": "qAppId","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"IsDesktopMode": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetConfiguration": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qConfig" }]\r\n\t\t\t},\r\n\t\t\t"CancelRequest": {\r\n\t\t\t\t"In": [{ "Name": "qRequestId","DefaultValue": 0 }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"ShutdownProcess": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"ReloadExtensionList": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"ReplaceAppFromID": {\r\n\t\t\t\t"In": [{ "Name": "qTargetAppId","DefaultValue": "" }, { "Name": "qSrcAppID","DefaultValue": "" }, { "Name": "qIds","DefaultValue": [""] }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"CopyApp": {\r\n\t\t\t\t"In": [{ "Name": "qTargetAppId","DefaultValue": "" }, { "Name": "qSrcAppId","DefaultValue": "" }, { "Name": "qIds","DefaultValue": [""] }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"ImportApp": {\r\n\t\t\t\t"In": [{ "Name": "qAppId","DefaultValue": "" }, { "Name": "qSrcPath","DefaultValue": "" }, { "Name": "qIds","DefaultValue": [""] }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"ImportAppEx": {\r\n\t\t\t\t"In": [{ "Name": "qAppId","DefaultValue": "" }, { "Name": "qSrcPath","DefaultValue": "" }, { "Name": "qIds","DefaultValue": [""] }, { "Name": "qExcludeConnections","DefaultValue": false }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"ExportApp": {\r\n\t\t\t\t"In": [{ "Name": "qTargetPath","DefaultValue": "" }, { "Name": "qSrcAppId","DefaultValue": "" }, { "Name": "qIds","DefaultValue": [""] }],\r\n\t\t\t\t"Out": [{ "Name": "qSuccess" }]\r\n\t\t\t},\r\n\t\t\t"PublishApp": {\r\n\t\t\t\t"In": [{ "Name": "qAppId","DefaultValue": "" }, { "Name": "qName","DefaultValue": "" }, { "Name": "qStreamId","DefaultValue": "" }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"IsPersonalMode": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetUniqueID": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qUniqueID" }]\r\n\t\t\t},\r\n\t\t\t"OpenDoc": {\r\n\t\t\t\t"In": [{ "Name": "qDocName","DefaultValue": "" }, { "Name": "qUserName","DefaultValue": "", "Optional": true }, { "Name": "qPassword","DefaultValue": "", "Optional": true }, { "Name": "qSerial","DefaultValue": "", "Optional": true }, { "Name": "qNoData","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"CreateSessionApp": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qSessionAppId" }]\r\n\t\t\t},\r\n\t\t\t"CreateSessionAppFromApp": {\r\n\t\t\t\t"In": [{ "Name": "qSrcAppId","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qSessionAppId" }]\r\n\t\t\t},\r\n\t\t\t"ProductVersion": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetAppEntry": {\r\n\t\t\t\t"In": [{ "Name": "qAppID","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qEntry" }]\r\n\t\t\t},\r\n\t\t\t"ConfigureReload": {\r\n\t\t\t\t"In": [{ "Name": "qCancelOnScriptError","DefaultValue": false }, { "Name": "qUseErrorData","DefaultValue": false }, { "Name": "qInteractOnError","DefaultValue": false }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"CancelReload": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetBNF": {\r\n\t\t\t\t"In": [{ "Name": "qBnfType","DefaultValue": 0 }],\r\n\t\t\t\t"Out": [{ "Name": "qBnfDefs" }]\r\n\t\t\t},\r\n\t\t\t"GetFunctions": {\r\n\t\t\t\t"In": [{ "Name": "qGroup","DefaultValue": 0, "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qFunctions" }]\r\n\t\t\t},\r\n\t\t\t"GetOdbcDsns": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qOdbcDsns" }]\r\n\t\t\t},\r\n\t\t\t"GetOleDbProviders": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qOleDbProviders" }]\r\n\t\t\t},\r\n\t\t\t"GetDatabasesFromConnectionString": {\r\n\t\t\t\t"In": [{ "Name": "qConnection","DefaultValue": {"qId": "", "qName": "", "qConnectionString": "", "qType": "", "qUserName": "", "qPassword": "", "qModifiedDate": "", "qMeta": {"qName": ""}, "qLogOn": 0} }],\r\n\t\t\t\t"Out": [{ "Name": "qDatabases" }]\r\n\t\t\t},\r\n\t\t\t"IsValidConnectionString": {\r\n\t\t\t\t"In": [{ "Name": "qConnection","DefaultValue": {"qId": "", "qName": "", "qConnectionString": "", "qType": "", "qUserName": "", "qPassword": "", "qModifiedDate": "", "qMeta": {"qName": ""}, "qLogOn": 0} }],\r\n\t\t\t\t"Out": []\r\n\t\t\t},\r\n\t\t\t"GetDefaultAppFolder": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qPath" }]\r\n\t\t\t},\r\n\t\t\t"GetMyDocumentsFolder": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qFolder" }]\r\n\t\t\t},\r\n\t\t\t"GetLogicalDriveStrings": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qDrives" }]\r\n\t\t\t},\r\n\t\t\t"GetFolderItemsForPath": {\r\n\t\t\t\t"In": [{ "Name": "qPath","DefaultValue": "" }],\r\n\t\t\t\t"Out": [{ "Name": "qFolderItems" }]\r\n\t\t\t},\r\n\t\t\t"GetSupportedCodePages": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qCodePages" }]\r\n\t\t\t},\r\n\t\t\t"GetCustomConnectors": {\r\n\t\t\t\t"In": [{ "Name": "qReloadList","DefaultValue": false, "Optional": true }],\r\n\t\t\t\t"Out": [{ "Name": "qConnectors" }]\r\n\t\t\t},\r\n\t\t\t"EngineVersion": {\r\n\t\t\t\t"In": [],\r\n\t\t\t\t"Out": [{ "Name": "qVersion" }]\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t"enums": {\r\n\t\t"LocalizedMessageCode": {\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_EMPTY_MESSAGE": 0,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_PROGRESS_SAVING_STARTED": 1,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_PROGRESS_BYTES_LEFT": 2,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_PROGRESS_STORING_TABLES": 3,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_PROGRESS_QVD_ROWS_SO_FAR": 4,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_PROGRESS_CONNECTED": 5,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_PROGRESS_CONNECTING_TO": 6,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_PROGRESS_CONNECT_FAILED": 7,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_PROGRESS_QVD_ROWISH": 8,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_PROGRESS_QVD_COLUMNAR": 9,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_ERROR": 10,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_DONE": 11,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_LOAD_EXTERNAL_DATA": 12,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_PROGRESS_OLD_QVD_ISLOADING": 13,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_PROGRESS_QVC_LOADING": 14,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_PROGRESS_QVD_BUFFERED": 15,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_PROGRESS_QVC_PREPARING": 16,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_PROGRESS_QVC_APPENDING": 17,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_REMOVE_SYNTHETIC": 18,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_PENDING_LINKEDTABLE_FETCHING": 19,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_RELOAD": 20,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_LINES_FETCHED": 21,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_SEARCHINDEX_START": 22,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_SEARCHINDEX_FIELD": 23,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_SEARCHINDEX_SUCCESS": 24,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_SEARCHINDEX_FAILURE": 25,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_SEARCHINDEX_STARTABORT": 26,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_SEARCHINDEX_ENDABORT": 27,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_SEARCHINDEX_TIMEOUT": 28,\r\n\t\t\t"LOCMSG_SCRIPTEDITOR_SEARCHINDEX_OUTOFMEMORY": 29\r\n\t\t},\r\n\t\t"QrsChangeType": {\r\n\t\t\t"QRS_CHANGE_UNDEFINED": 0,\r\n\t\t\t"QRS_CHANGE_ADD": 1,\r\n\t\t\t"QRS_CHANGE_UPDATE": 2,\r\n\t\t\t"QRS_CHANGE_DELETE": 3\r\n\t\t},\r\n\t\t"LocalizedErrorCode": {\r\n\t\t\t"LOCERR_INTERNAL_ERROR": -128,\r\n\t\t\t"LOCERR_GENERIC_UNKNOWN": -1,\r\n\t\t\t"LOCERR_GENERIC_OK": 0,\r\n\t\t\t"LOCERR_GENERIC_NOT_SET": 1,\r\n\t\t\t"LOCERR_GENERIC_NOT_FOUND": 2,\r\n\t\t\t"LOCERR_GENERIC_ALREADY_EXISTS": 3,\r\n\t\t\t"LOCERR_GENERIC_INVALID_PATH": 4,\r\n\t\t\t"LOCERR_GENERIC_ACCESS_DENIED": 5,\r\n\t\t\t"LOCERR_GENERIC_OUT_OF_MEMORY": 6,\r\n\t\t\t"LOCERR_GENERIC_NOT_INITIALIZED": 7,\r\n\t\t\t"LOCERR_GENERIC_INVALID_PARAMETERS": 8,\r\n\t\t\t"LOCERR_GENERIC_EMPTY_PARAMETERS": 9,\r\n\t\t\t"LOCERR_GENERIC_INTERNAL_ERROR": 10,\r\n\t\t\t"LOCERR_GENERIC_CORRUPT_DATA": 11,\r\n\t\t\t"LOCERR_GENERIC_MEMORY_INCONSISTENCY": 12,\r\n\t\t\t"LOCERR_GENERIC_INVISIBLE_OWNER_ABORT": 13,\r\n\t\t\t"LOCERR_GENERIC_PROHIBIT_VALIDATE": 14,\r\n\t\t\t"LOCERR_GENERIC_ABORTED": 15,\r\n\t\t\t"LOCERR_GENERIC_CONNECTION_LOST": 16,\r\n\t\t\t"LOCERR_GENERIC_UNSUPPORTED_IN_PRODUCT_VERSION": 17,\r\n\t\t\t"LOCERR_GENERIC_REST_CONNECTION_FAILURE": 18,\r\n\t\t\t"LOCERR_HTTP_400": 400,\r\n\t\t\t"LOCERR_HTTP_401": 401,\r\n\t\t\t"LOCERR_HTTP_402": 402,\r\n\t\t\t"LOCERR_HTTP_403": 403,\r\n\t\t\t"LOCERR_HTTP_404": 404,\r\n\t\t\t"LOCERR_HTTP_405": 405,\r\n\t\t\t"LOCERR_HTTP_406": 406,\r\n\t\t\t"LOCERR_HTTP_407": 407,\r\n\t\t\t"LOCERR_HTTP_408": 408,\r\n\t\t\t"LOCERR_HTTP_409": 409,\r\n\t\t\t"LOCERR_HTTP_410": 410,\r\n\t\t\t"LOCERR_HTTP_411": 411,\r\n\t\t\t"LOCERR_HTTP_412": 412,\r\n\t\t\t"LOCERR_HTTP_413": 413,\r\n\t\t\t"LOCERR_HTTP_414": 414,\r\n\t\t\t"LOCERR_HTTP_415": 415,\r\n\t\t\t"LOCERR_HTTP_416": 416,\r\n\t\t\t"LOCERR_HTTP_417": 417,\r\n\t\t\t"LOCERR_HTTP_500": 500,\r\n\t\t\t"LOCERR_HTTP_501": 501,\r\n\t\t\t"LOCERR_HTTP_502": 502,\r\n\t\t\t"LOCERR_HTTP_503": 503,\r\n\t\t\t"LOCERR_HTTP_504": 504,\r\n\t\t\t"LOCERR_HTTP_505": 505,\r\n\t\t\t"LOCERR_HTTP_509": 509,\r\n\t\t\t"LOCERR_HTTP_COULDNT_RESOLVE_HOST": 700,\r\n\t\t\t"LOCERR_APP_ALREADY_EXISTS": 1000,\r\n\t\t\t"LOCERR_APP_INVALID_NAME": 1001,\r\n\t\t\t"LOCERR_APP_ALREADY_OPEN": 1002,\r\n\t\t\t"LOCERR_APP_NOT_FOUND": 1003,\r\n\t\t\t"LOCERR_APP_IMPORT_FAILED": 1004,\r\n\t\t\t"LOCERR_APP_SAVE_FAILED": 1005,\r\n\t\t\t"LOCERR_APP_CREATE_FAILED": 1006,\r\n\t\t\t"LOCERR_APP_INVALID": 1007,\r\n\t\t\t"LOCERR_APP_CONNECT_FAILED": 1008,\r\n\t\t\t"LOCERR_APP_ALREADY_OPEN_IN_DIFFERENT_MODE": 1009,\r\n\t\t\t"LOCERR_APP_MIGRATION_COULD_NOT_CONTACT_MIGRATION_SERVICE": 1010,\r\n\t\t\t"LOCERR_APP_MIGRATION_COULD_NOT_START_MIGRATION": 1011,\r\n\t\t\t"LOCERR_APP_MIGRATION_FAILURE": 1012,\r\n\t\t\t"LOCERR_APP_SCRIPT_MISSING": 1013,\r\n\t\t\t"LOCERR_CONNECTION_ALREADY_EXISTS": 2000,\r\n\t\t\t"LOCERR_CONNECTION_NOT_FOUND": 2001,\r\n\t\t\t"LOCERR_CONNECTION_FAILED_TO_LOAD": 2002,\r\n\t\t\t"LOCERR_CONNECTION_FAILED_TO_IMPORT": 2003,\r\n\t\t\t"LOCERR_CONNECTION_NAME_IS_INVALID": 2004,\r\n\t\t\t"LOCERR_FILE_ACCESS_DENIED": 3000,\r\n\t\t\t"LOCERR_FILE_NAME_INVALID": 3001,\r\n\t\t\t"LOCERR_FILE_CORRUPT": 3002,\r\n\t\t\t"LOCERR_FILE_NOT_FOUND": 3003,\r\n\t\t\t"LOCERR_FILE_FORMAT_UNSUPPORTED": 3004,\r\n\t\t\t"LOCERR_FILE_OPENED_IN_UNSUPPORTED_MODE": 3005,\r\n\t\t\t"LOCERR_FILE_TABLE_NOT_FOUND": 3006,\r\n\t\t\t"LOCERR_USER_ACCESS_DENIED": 4000,\r\n\t\t\t"LOCERR_USER_IMPERSONATION_FAILED": 4001,\r\n\t\t\t"LOCERR_SERVER_OUT_OF_SESSION_AND_USER_CALS": 5000,\r\n\t\t\t"LOCERR_SERVER_OUT_OF_SESSION_CALS": 5001,\r\n\t\t\t"LOCERR_SERVER_OUT_OF_USAGE_CALS": 5002,\r\n\t\t\t"LOCERR_SERVER_OUT_OF_CALS": 5003,\r\n\t\t\t"LOCERR_SERVER_OUT_OF_NAMED_CALS": 5004,\r\n\t\t\t"LOCERR_SERVER_OFF_DUTY": 5005,\r\n\t\t\t"LOCERR_SERVER_BUSY": 5006,\r\n\t\t\t"LOCERR_SERVER_LICENSE_EXPIRED": 5007,\r\n\t\t\t"LOCERR_SERVER_AJAX_DISABLED": 5008,\r\n\t\t\t"LOCERR_HC_INVALID_OBJECT": 6000,\r\n\t\t\t"LOCERR_HC_RESULT_TOO_LARGE": 6001,\r\n\t\t\t"LOCERR_HC_INVALID_OBJECT_STATE": 6002,\r\n\t\t\t"LOCERR_HC_MODAL_OBJECT_ERROR": 6003,\r\n\t\t\t"LOCERR_CALC_INVALID_DEF": 7000,\r\n\t\t\t"LOCERR_CALC_NOT_IN_LIB": 7001,\r\n\t\t\t"LOCERR_CALC_HEAP_ERROR": 7002,\r\n\t\t\t"LOCERR_CALC_TOO_LARGE": 7003,\r\n\t\t\t"LOCERR_CALC_TIMEOUT": 7004,\r\n\t\t\t"LOCERR_CALC_EVAL_CONDITION_FAILED": 7005,\r\n\t\t\t"LOCERR_CALC_MIXED_LINKED_AGGREGATION": 7006,\r\n\t\t\t"LOCERR_CALC_MISSING_LINKED": 7007,\r\n\t\t\t"LOCERR_CALC_INVALID_COL_SORT": 7008,\r\n\t\t\t"LOCERR_CALC_PAGES_TOO_LARGE": 7009,\r\n\t\t\t"LOCERR_CALC_SEMANTIC_FIELD_NOT_ALLOWED": 7010,\r\n\t\t\t"LOCERR_CALC_VALIDATION_STATE_INVALID": 7011,\r\n\t\t\t"LOCERR_CALC_PIVOT_DIMENSIONS_ALREADY_EXISTS": 7012,\r\n\t\t\t"LOCERR_CALC_MISSING_LINKED_FIELD": 7013,\r\n\t\t\t"LOCERR_CALC_NOT_CALCULATED": 7014,\r\n\t\t\t"LOCERR_LAYOUT_EXTENDS_INVALID_ID": 8000,\r\n\t\t\t"LOCERR_LAYOUT_LINKED_OBJECT_NOT_FOUND": 8001,\r\n\t\t\t"LOCERR_LAYOUT_LINKED_OBJECT_INVALID": 8002,\r\n\t\t\t"LOCERR_PERSISTENCE_WRITE_FAILED": 9000,\r\n\t\t\t"LOCERR_PERSISTENCE_READ_FAILED": 9001,\r\n\t\t\t"LOCERR_PERSISTENCE_DELETE_FAILED": 9002,\r\n\t\t\t"LOCERR_PERSISTENCE_NOT_FOUND": 9003,\r\n\t\t\t"LOCERR_PERSISTENCE_UNSUPPORTED_VERSION": 9004,\r\n\t\t\t"LOCERR_PERSISTENCE_MIGRATION_FAILED_READ_ONLY": 9005,\r\n\t\t\t"LOCERR_PERSISTENCE_MIGRATION_CANCELLED": 9006,\r\n\t\t\t"LOCERR_PERSISTENCE_MIGRATION_BACKUP_FAILED": 9007,\r\n\t\t\t"LOCERR_PERSISTENCE_DISK_FULL": 9008,\r\n\t\t\t"LOCERR_PERSISTENCE_NOT_SUPPORTED_FOR_SESSION_APP": 9009,\r\n\t\t\t"LOCERR_PERSISTENCE_SYNC_SET_CHUNK_INVALID_PARAMETERS": 9510,\r\n\t\t\t"LOCERR_PERSISTENCE_SYNC_GET_CHUNK_INVALID_PARAMETERS": 9511,\r\n\t\t\t"LOCERR_SCRIPT_DATASOURCE_ACCESS_DENIED": 10000,\r\n\t\t\t"LOCERR_RELOAD_IN_PROGRESS": 11000,\r\n\t\t\t"LOCERR_RELOAD_TABLE_X_NOT_FOUND": 11001,\r\n\t\t\t"LOCERR_RELOAD_UNKNOWN_STATEMENT": 11002,\r\n\t\t\t"LOCERR_RELOAD_EXPECTED_SOMETHING_FOUND_UNKNOWN": 11003,\r\n\t\t\t"LOCERR_RELOAD_EXPECTED_NOTHING_FOUND_UNKNOWN": 11004,\r\n\t\t\t"LOCERR_RELOAD_EXPECTED_ONE_OF_1_TOKENS_FOUND_UNKNOWN": 11005,\r\n\t\t\t"LOCERR_RELOAD_EXPECTED_ONE_OF_2_TOKENS_FOUND_UNKNOWN": 11006,\r\n\t\t\t"LOCERR_RELOAD_EXPECTED_ONE_OF_3_TOKENS_FOUND_UNKNOWN": 11007,\r\n\t\t\t"LOCERR_RELOAD_EXPECTED_ONE_OF_4_TOKENS_FOUND_UNKNOWN": 11008,\r\n\t\t\t"LOCERR_RELOAD_EXPECTED_ONE_OF_5_TOKENS_FOUND_UNKNOWN": 11009,\r\n\t\t\t"LOCERR_RELOAD_EXPECTED_ONE_OF_6_TOKENS_FOUND_UNKNOWN": 11010,\r\n\t\t\t"LOCERR_RELOAD_EXPECTED_ONE_OF_7_TOKENS_FOUND_UNKNOWN": 11011,\r\n\t\t\t"LOCERR_RELOAD_EXPECTED_ONE_OF_8_OR_MORE_TOKENS_FOUND_UNKNOWN": 11012,\r\n\t\t\t"LOCERR_RELOAD_FIELD_X_NOT_FOUND": 11013,\r\n\t\t\t"LOCERR_RELOAD_MAPPING_TABLE_X_NOT_FOUND": 11014,\r\n\t\t\t"LOCERR_RELOAD_LIB_CONNECTION_X_NOT_FOUND": 11015,\r\n\t\t\t"LOCERR_RELOAD_NAME_ALREADY_TAKEN": 11016,\r\n\t\t\t"LOCERR_RELOAD_WRONG_FILE_FORMAT_DIF": 11017,\r\n\t\t\t"LOCERR_RELOAD_WRONG_FILE_FORMAT_BIFF": 11018,\r\n\t\t\t"LOCERR_RELOAD_WRONG_FILE_FORMAT_ENCRYPTED": 11019,\r\n\t\t\t"LOCERR_RELOAD_OPEN_FILE_ERROR": 11020,\r\n\t\t\t"LOCERR_RELOAD_AUTO_GENERATE_COUNT": 11021,\r\n\t\t\t"LOCERR_RELOAD_PE_ILLEGAL_PREFIX_COMB": 11022,\r\n\t\t\t"LOCERR_RELOAD_MATCHING_CONTROL_STATEMENT_ERROR": 11023,\r\n\t\t\t"LOCERR_RELOAD_MATCHING_LIBPATH_X_NOT_FOUND": 11024,\r\n\t\t\t"LOCERR_RELOAD_MATCHING_LIBPATH_X_INVALID": 11025,\r\n\t\t\t"LOCERR_RELOAD_MATCHING_LIBPATH_X_OUTSIDE": 11026,\r\n\t\t\t"LOCERR_RELOAD_NO_QUALIFIED_PATH_FOR_FILE": 11027,\r\n\t\t\t"LOCERR_RELOAD_MODE_STATEMENT_ONLY_FOR_LIB_PATHS": 11028,\r\n\t\t\t"LOCERR_RELOAD_INCONSISTENT_USE_OF_SEMANTIC_FIELDS": 11029,\r\n\t\t\t"LOCERR_RELOAD_NO_OPEN_DATABASE": 11030,\r\n\t\t\t"LOCERR_RELOAD_AGGREGATION_REQUIRED_BY_GROUP_BY": 11031,\r\n\t\t\t"LOCERR_RELOAD_CONNECT_MUST_USE_LIB_PREFIX_IN_THIS_MODE": 11032,\r\n\t\t\t"LOCERR_RELOAD_ODBC_CONNECT_FAILED": 11033,\r\n\t\t\t"LOCERR_RELOAD_OLEDB_CONNECT_FAILED": 11034,\r\n\t\t\t"LOCERR_RELOAD_CUSTOM_CONNECT_FAILED": 11035,\r\n\t\t\t"LOCERR_RELOAD_ODBC_READ_FAILED": 11036,\r\n\t\t\t"LOCERR_RELOAD_OLEDB_READ_FAILED": 11037,\r\n\t\t\t"LOCERR_RELOAD_CUSTOM_READ_FAILED": 11038,\r\n\t\t\t"LOCERR_RELOAD_BINARY_LOAD_PROHIBITED": 11039,\r\n\t\t\t"LOCERR_RELOAD_CONNECTOR_START_FAILED": 11040,\r\n\t\t\t"LOCERR_RELOAD_CONNECTOR_NOT_RESPONDING": 11041,\r\n\t\t\t"LOCERR_RELOAD_CONNECTOR_REPLY_ERROR": 11042,\r\n\t\t\t"LOCERR_RELOAD_CONNECTOR_CONNECT_ERROR": 11043,\r\n\t\t\t"LOCERR_PERSONAL_NEW_VERSION_AVAILABLE": 12000,\r\n\t\t\t"LOCERR_PERSONAL_VERSION_EXPIRED": 12001,\r\n\t\t\t"LOCERR_PERSONAL_SECTION_ACCESS_DETECTED": 12002,\r\n\t\t\t"LOCERR_PERSONAL_APP_DELETION_FAILED": 12003,\r\n\t\t\t"LOCERR_USER_AUTHENTICATION_FAILURE": 12004,\r\n\t\t\t"LOCERR_EXPORT_OUT_OF_MEMORY": 13000,\r\n\t\t\t"LOCERR_EXPORT_NO_DATA": 13001,\r\n\t\t\t"LOCERR_SYNC_INVALID_OFFSET": 14000,\r\n\t\t\t"LOCERR_SEARCH_TIMEOUT": 15000,\r\n\t\t\t"LOCERR_DIRECT_DISCOVERY_LINKED_EXPRESSION_FAIL": 16000,\r\n\t\t\t"LOCERR_DIRECT_DISCOVERY_ROWCOUNT_OVERFLOW": 16001,\r\n\t\t\t"LOCERR_DIRECT_DISCOVERY_EMPTY_RESULT": 16002,\r\n\t\t\t"LOCERR_DIRECT_DISCOVERY_DB_CONNECTION_FAILED": 16003,\r\n\t\t\t"LOCERR_DIRECT_DISCOVERY_MEASURE_NOT_ALLOWED": 16004,\r\n\t\t\t"LOCERR_DIRECT_DISCOVERY_DETAIL_NOT_ALLOWED": 16005,\r\n\t\t\t"LOCERR_DIRECT_DISCOVERY_NOT_SYNTH_CIRCULAR_ALLOWED": 16006,\r\n\t\t\t"LOCERR_DIRECT_DISCOVERY_ONLY_ONE_DD_TABLE_ALLOWED": 16007,\r\n\t\t\t"LOCERR_DIRECT_DISCOVERY_DB_AUTHORIZATION_FAILED": 16008,\r\n\t\t\t"LOCERR_SMART_LOAD_TABLE_NOT_FOUND": 17000,\r\n\t\t\t"LOCERR_SMART_LOAD_TABLE_DUPLICATED": 17001,\r\n\t\t\t"LOCERR_VARIABLE_NO_NAME": 18000,\r\n\t\t\t"LOCERR_VARIABLE_DUPLICATE_NAME": 18001,\r\n\t\t\t"LOCERR_VARIABLE_INCONSISTENCY": 18002,\r\n\t\t\t"LOCERR_MEDIA_LIBRARY_LIST_FAILED": 19000,\r\n\t\t\t"LOCERR_MEDIA_LIBRARY_CONTENT_FAILED": 19001,\r\n\t\t\t"LOCERR_MEDIA_BUNDLING_FAILED": 19002,\r\n\t\t\t"LOCERR_MEDIA_UNBUNDLING_FAILED": 19003,\r\n\t\t\t"LOCERR_MEDIA_LIBRARY_NOT_FOUND": 19004,\r\n\t\t\t"LOCERR_FEATURE_DISABLED": 20000,\r\n\t\t\t"LOCERR_JSON_RPC_INVALID_REQUEST": -32600,\r\n\t\t\t"LOCERR_JSON_RPC_METHOD_NOT_FOUND": -32601,\r\n\t\t\t"LOCERR_JSON_RPC_INVALID_PARAMETERS": -32602,\r\n\t\t\t"LOCERR_JSON_RPC_INTERNAL_ERROR": -32603,\r\n\t\t\t"LOCERR_JSON_RPC_PARSE_ERROR": -32700\r\n\t\t},\r\n\t\t"LocalizedWarningCode": {\r\n\t\t\t"LOCWARN_PERSONAL_RELOAD_REQUIRED": 0,\r\n\t\t\t"LOCWARN_PERSONAL_VERSION_EXPIRES_SOON": 1,\r\n\t\t\t"LOCWARN_EXPORT_DATA_TRUNCATED": 1000,\r\n\t\t\t"LOCWARN_COULD_NOT_OPEN_ALL_OBJECTS": 2000\r\n\t\t},\r\n\t\t"GrpType": {\r\n\t\t\t"GRP_NX_NONE": 0,\r\n\t\t\t"GRP_NX_HIEARCHY": 1,\r\n\t\t\t"GRP_NX_COLLECTION": 2\r\n\t\t},\r\n\t\t"ExportFileType": {\r\n\t\t\t"EXPORT_CSV_C": 0,\r\n\t\t\t"EXPORT_CSV_T": 1,\r\n\t\t\t"EXPORT_OOXML": 2\r\n\t\t},\r\n\t\t"ExportState": {\r\n\t\t\t"EXPORT_POSSIBLE": 0,\r\n\t\t\t"EXPORT_ALL": 1\r\n\t\t},\r\n\t\t"DimCellType": {\r\n\t\t\t"NX_DIM_CELL_VALUE": 0,\r\n\t\t\t"NX_DIM_CELL_EMPTY": 1,\r\n\t\t\t"NX_DIM_CELL_NORMAL": 2,\r\n\t\t\t"NX_DIM_CELL_TOTAL": 3,\r\n\t\t\t"NX_DIM_CELL_OTHER": 4,\r\n\t\t\t"NX_DIM_CELL_AGGR": 5,\r\n\t\t\t"NX_DIM_CELL_PSEUDO": 6,\r\n\t\t\t"NX_DIM_CELL_ROOT": 7,\r\n\t\t\t"NX_DIM_CELL_NULL": 8\r\n\t\t},\r\n\t\t"StackElemType": {\r\n\t\t\t"NX_STACK_CELL_NORMAL": 0,\r\n\t\t\t"NX_STACK_CELL_TOTAL": 1,\r\n\t\t\t"NX_STACK_CELL_OTHER": 2,\r\n\t\t\t"NX_STACK_CELL_SUM": 3,\r\n\t\t\t"NX_STACK_CELL_VALUE": 4,\r\n\t\t\t"NX_STACK_CELL_PSEUDO": 5\r\n\t\t},\r\n\t\t"SortIndicatorType": {\r\n\t\t\t"NX_SORT_INDICATE_NONE": 0,\r\n\t\t\t"NX_SORT_INDICATE_ASC": 1,\r\n\t\t\t"NX_SORT_INDICATE_DESC": 2\r\n\t\t},\r\n\t\t"DimensionType": {\r\n\t\t\t"NX_DIMENSION_TYPE_DISCRETE": 0,\r\n\t\t\t"NX_DIMENSION_TYPE_NUMERIC": 1,\r\n\t\t\t"NX_DIMENSION_TYPE_TIME": 2\r\n\t\t},\r\n\t\t"FieldSelectionMode": {\r\n\t\t\t"SELECTION_MODE_NORMAL": 0,\r\n\t\t\t"SELECTION_MODE_AND": 1,\r\n\t\t\t"SELECTION_MODE_NOT": 2\r\n\t\t},\r\n\t\t"FrequencyMode": {\r\n\t\t\t"NX_FREQUENCY_NONE": 0,\r\n\t\t\t"NX_FREQUENCY_VALUE": 1,\r\n\t\t\t"NX_FREQUENCY_PERCENT": 2,\r\n\t\t\t"NX_FREQUENCY_RELATIVE": 3\r\n\t\t},\r\n\t\t"DataReductionMode": {\r\n\t\t\t"DATA_REDUCTION_NONE": 0,\r\n\t\t\t"DATA_REDUCTION_ONEDIM": 1,\r\n\t\t\t"DATA_REDUCTION_SCATTERED": 2,\r\n\t\t\t"DATA_REDUCTION_CLUSTERED": 3,\r\n\t\t\t"DATA_REDUCTION_STACKED": 4\r\n\t\t},\r\n\t\t"HypercubeMode": {\r\n\t\t\t"DATA_MODE_STRAIGHT": 0,\r\n\t\t\t"DATA_MODE_PIVOT": 1,\r\n\t\t\t"DATA_MODE_PIVOT_STACK": 2\r\n\t\t},\r\n\t\t"PatchOperationType": {\r\n\t\t\t"Add": 0,\r\n\t\t\t"Remove": 1,\r\n\t\t\t"Replace": 2\r\n\t\t},\r\n\t\t"SelectionCellType": {\r\n\t\t\t"NX_CELL_DATA": 0,\r\n\t\t\t"NX_CELL_TOP": 1,\r\n\t\t\t"NX_CELL_LEFT": 2\r\n\t\t},\r\n\t\t"MatchingFieldMode": {\r\n\t\t\t"MATCHINGFIELDMODE_MATCH_ALL": 0,\r\n\t\t\t"MATCHINGFIELDMODE_MATCH_ONE": 1\r\n\t\t},\r\n\t\t"ExtEngineDataType": {\r\n\t\t\t"NX_EXT_DATATYPE_STRING": 0,\r\n\t\t\t"NX_EXT_DATATYPE_DOUBLE": 1,\r\n\t\t\t"NX_EXT_DATATYPE_BOTH": 2\r\n\t\t},\r\n\t\t"ExtEngineFunctionType": {\r\n\t\t\t"NX_EXT_FUNCTIONTYPE_SCALAR": 0,\r\n\t\t\t"NX_EXT_FUNCTIONTYPE_AGGR": 1,\r\n\t\t\t"NX_EXT_FUNCTIONTYPE_TENSOR": 2\r\n\t\t},\r\n\t\t"ExtEngineMsgType": {\r\n\t\t\t"NX_EXT_MSGTYPE_FUNCTION_CALL": 1,\r\n\t\t\t"NX_EXT_MSGTYPE_SCRIPT_CALL": 2,\r\n\t\t\t"NX_EXT_MSGTYPE_RETURN_VALUE": 3,\r\n\t\t\t"NX_EXT_MSGTYPE_RETURN_MULTIPLE": 4,\r\n\t\t\t"NX_EXT_MSGTYPE_RETURN_ERROR": 5\r\n\t\t}\r\n\t}\r\n}'
}),define("autogenerated/qix/engine-api",["text!autogenerated/qix/jsonspec.json"],function(a){return JSON.parse(a)}),define("autogenerated/qix/engine-enums",["./engine-api"],function(a){var b=a.enums;for(var c in b)b["Nx"+c]=b[c];return b}),define("core.utils/authentication",["jquery"],function(a){"use strict";var b,c,d,e,f={},g=!1,h=a.Deferred();return f.parse=function(a){b=a.userId,c=a.userDirectory,g=a.mustAuthenticate,e=a.loginUri,d=a.logoutUri,g===!0&&a.loginUri&&(window.location.href=a.loginUri),h.resolve(this)},f.onDataReceived=h.promise(),Object.defineProperties(f,{userId:{get:function(){return b}},userDirectory:{get:function(){return c}},mustAuthenticate:{get:function(){return g}},loginUri:{get:function(){return e}},logoutUri:{get:function(){return d}}}),f}),define("core.models/rpc-base",["core.utils/deferred","core.utils/notification","core.utils/class","core.utils/json-patch","core.utils/debug-flags","core.utils/permissions","core.utils/model-garbage-collector","autogenerated/qix/engine-enums","core.utils/authentication"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(a,b){Array.isArray(b)?d.apply(a,b):d.updateObject(a,b)}var k,l,m=h.NxLocalizedErrorCode,n=["GetLayout","GetAppLayout","AbortModal","DoSave"];i.onDataReceived.then(function(a){"NONE"!==a.userDirectory&&(k=a.userId,l=a.userDirectory)});var o=c.extend("RPCBase",{init:function(a){var c=this;b.mixin(c),c.notification("Validated"),c.notification("Invalidated"),c.notification("Aborted"),c.notification("Validating"),c.notification("Closed"),c.notification("Closing"),c.notification("Cancelled"),c.modelType="RPCBase",c.id=a.id,c.session=a.session,c.handle=a.handle,c.layout={},c._properties={},c.properties={},c.propertyTree={},c.ongoingRequests={},c.needCacheProperties=!0,c._effectiveProperties={},c.effectiveProperties={},c.needCacheEffectiveProperties=!0,c.setState(o.States.INVALID),f.mapToLayout(c.layout,a.checkCreate),"App"!==c.constructor.name&&c.bindToRPC(),c.enigmaModel=a.enigmaModel},bindToRPC:function(){var a=this;a.session.onChange(a.handle,a.changeHandler.bind(a)),a.Aborted.bind(a.clearPending.bind(a)),a.Cancelled.bind(a.clearPending.bind(a))},changeHandler:function(){var a=this;a.clearPending(),a.needCacheProperties=!0,a.needCacheEffectiveProperties=!0,a.isCancelled||a.setState(o.States.INVALID)},clearPending:function(){for(var a in this.ongoingRequests)delete this.ongoingRequests[a]},publish:function(){return this.layout.permissions.publish?this.rpc("Publish"):a.reject("permission denied")},unpublish:function(){var b=this,c=a();return b.getLayout().then(function(a){if(!a.qMeta.published||a.qMeta.approved||a.qMeta.owner.userId!==k||a.qMeta.owner.userDirectory!==l)return c.reject("permission denied");b.rpc("UnPublish").then(function(a){c.resolve(a)})}),c.promise},setState:function(a){var b=this,c=b.state;delete this.__layoutRPCId,b.state=a,c!==b.state&&(a===o.States.INVALID?b.Invalidated.emit():a===o.States.VALID?b.Validated.emit():a===o.States.ABORTED?b.Aborted.emit():a===o.States.VALIDATING?b.Validating.emit():a===o.States.CLOSED?b.Closed.emit():a===o.States.CLOSING?b.Closing.emit():a===o.States.CANCELLED&&b.Cancelled.emit())},getLayout:function(b,c){function d(a){return e.DELTA&&h&&window.console.info("[DBGFLG:DELTA] APPLY ["+g.constructor.name+"]:",a),j(g.layout,a),g.setState(o.States.VALID),g.layout}function f(b){return b.error.code!==m.LOCERR_GENERIC_ABORTED||g.isCancelled||(g.setState(o.States.INVALID),b.error.isHandled=!0),a.reject(b)}var g=this,h=!0;if(g.isValid||g.isCancelled)return a.resolve(g.layout);if(b=b||"GetLayout",c=c||"qLayout",g.isValidating||g.setState(o.States.VALIDATING),g.ongoingRequests[b+h])return g.ongoingRequests[b+h];var i=g.rpc(b,c,[],{delta:h}),k=i.then(d,f);return g.__layoutRPCId=i.rpcId,g.ongoingRequests[b+h]=k,k},getProperties:function(b){var c=this;if(b=b||"GetProperties",c.isValid&&!c.needCacheProperties)return a.resolve(c.properties);if(c.ongoingRequests[b+!1])return c.ongoingRequests[b+!1];var e=c.rpc(b,"qProp",[],{delta:!1}).then(function(a){var b=d.generate(c._properties,a);return c._properties=a,d.apply(c.properties,b),c.isValid&&(c.needCacheProperties=!1),c.properties});return c.ongoingRequests[b+!1]=e,e},getEffectiveProperties:function(){var b=this,c="GetEffectiveProperties";if(b.isValid&&!b.needCacheEffectiveProperties)return a.resolve(b.effectiveProperties);if(b.ongoingRequests[c+!1])return b.ongoingRequests[c+!1];var e=b.rpc(c,"qProp",[],{delta:!1}).then(function(a){var c=d.generate(b._effectiveProperties,a);return b._effectiveProperties=a,d.apply(b.effectiveProperties,c),b.isValid&&(b.needCacheEffectiveProperties=!1),b.effectiveProperties});return b.ongoingRequests[c+!1]=e,e},hasChanges:function(){return d.generate(this._properties,this.properties).length>0},markAsInvalid:function(){this.state=-99,this.setState(o.States.INVALID)},markAsCancelled:function(){this.setState(o.States.CANCELLED)},getFullPropertyTree:function(a){var b=this;return a=a||"GetFullPropertyTree",b.rpc(a,"qPropEntry",[],!1).then(function(a){return b._propertyTree=a,j(b.propertyTree,a),b.propertyTree})},setProperties:function(a,b,c){var e=this;return b=b||"SetProperties",Array.isArray(a)||(a=[a]),this.rpc(b,null,a,c).then(function(){d.updateObject(e._properties,e.properties)})},setFullPropertyTree:function(a,b,c){return b=b||"SetFullPropertyTree",Array.isArray(a)||(a=[a]),this.rpc(b,null,a,c)},save:function(){return this.hasChanges()?this.setProperties(this.properties):a.resolve()},saveTree:function(){return this.setFullPropertyTree(this.propertyTree)},getChildInfos:function(){return this.rpc("GetChildInfos","qInfos",[])},close:function(){var b=this;b.setState(o.States.CLOSING);var c=a.resolve();delete b.session.changeHandlers[b.handle],delete b.session.modelCache[b.id];for(var d in b.ongoingRequests)b.ongoingRequests[d].then&&b.ongoingRequests[d].then(null,function(a){a.error.isHandled=!0});return c.then(function(){b.setState(o.States.CLOSED),g.addToQueue(b)})},rpc:function(b,c,d,e){e=e||{delta:!1,raw:!1};var f=this,g=[].slice.call(arguments);if(!f.handle&&"App"===f.constructor.name)return f.waitForOpen.promise.then(function(){return f.rpc.apply(f,g)});var h={method:b,handle:this.handle,params:d||[]};if(e.delta&&(h.delta=!0),!f.session||f.isClosing||f.isClosed)return a.reject();var i=f.session.rpc(h).then(function(a){return c?a.result[c]:e.raw?a:a.result},function(b){return b.error.code===m.LOCERR_HC_MODAL_OBJECT_ERROR?(b.error.isHandled=!0,f.session.currentApp.abortModal().then(function(){return f.rpc.apply(f,g)})):a.reject(b)});return n.indexOf(b)>-1&&(f.ongoingRequests[b+e.delta]=i,i.finally(function(){delete f.ongoingRequests[b+e.delta]})),i.rpcId=h.id,i}});return o.getModel=function(b,c,d){function e(d){return delete c.modelCache[b],a.reject({error:{code:d&&d.error&&d.error.code,message:"No object with Id "+b+" found",parameter:b}})}var f=c.modelCache[b],g=this;return b?f||(f=d().then(function(a){return a?new g({id:a.id,session:c,handle:a.handle,enigmaModel:a}):e({error:{code:m.LOCERR_GENERIC_NOT_FOUND}})},e),c.modelCache[b]=f,f):a.reject("No ID given to RPCBase#getModel")},o.getLayout=function(a,b){return this.get(a,b).then(function(a){return a.getLayout().then(function(a){return a})})},o.getProperties=function(a,b){return this.get(a,b).then(function(a){return a.getProperties().then(function(){return a})})},o.extend=function(a,b){var d=c.extend.call(this,a,b);return d.bindLayout=o.bindLayout,d.getLayout=o.getLayout,d.getProperties=o.getProperties,d.getModel=o.getModel,d},Object.defineProperties(o.prototype,{isValid:{get:function(){return this.state===o.States.VALID}},isValidating:{get:function(){return this.state===o.States.VALIDATING}},isInvalid:{get:function(){return this.state===o.States.INVALID}},isAborted:{get:function(){return this.state===o.States.ABORTED}},isClosed:{get:function(){return this.state===o.States.CLOSED}},isClosing:{get:function(){return this.state===o.States.CLOSING}},isCancelled:{get:function(){return this.state===o.States.CANCELLED}}}),o.States={VALID:1,INVALID:2,VALIDATING:3,ABORTED:4,CLOSED:5,CLOSING:6,CANCELLED:7},o.bindLayout=function(a,b,c,d){function e(){var c=a.$eval(b);c&&c.Invalidated&&c.Invalidated.unbind(f)}b=b||"model";var f,g,h,i=function(){var d=this,e=this.getLayout();a.__layoutRPCId=e.rpcId,e.then(function(e){a.$eval(b)===d&&c&&c(e)})};return h=a.$on("$destroy",function(){e()}),g=a.$watch(b,function(a,b){b&&b!==a&&b.Invalidated&&b.Invalidated.unbind(f),!a||a.isClosing&&a.isClosed||(d&&d(a),a.getLayout().then(c),f=i.bind(a),a.Invalidated.bind(f))}),function(){e(),g(),h(),c&&(c=null),d&&(d=null)}},o}),define("core.utils/websocket",[],function(){return"undefined"!=typeof window&&"undefined"!=typeof document?window.angular&&window.angular.mock?function(){}:window.WebSocket:require("ws")}),define("qvangular",["assets/qvangular/qvangular-core"],function(a){return a}),define("general.enums/qrs-enums",[],function(){"use strict";return{NxLocalizedErrorCode:{LOCERR_JSON_RPC_ENTITY_NOT_FOUND:-32001,LOCERR_JSON_RPC_ACCESS_DENIED:-32002,LOCERR_JSON_RPC_APP_DUPLICATION_FAILED:-32003}}}),/** @license
 * JS Signals <http://millermedeiros.github.com/js-signals/>
 * Released under the MIT license
 * Author: Miller Medeiros
 * Version: 1.0.0 - Build: 268 (2012/11/29 05:48 PM)
 */
function(a){function b(a,b,c,d,e){this._listener=b,this._isOnce=c,this.context=d,this._signal=a,this._priority=e||0}function c(a,b){if("function"!=typeof a)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",b))}function d(){this._bindings=[],this._prevParams=null;var a=this;this.dispatch=function(){d.prototype.dispatch.apply(a,arguments)}}b.prototype={active:!0,params:null,execute:function(a){var b,c;return this.active&&this._listener&&(c=this.params?this.params.concat(a):a,b=this._listener.apply(this.context,c),this._isOnce&&this.detach()),b},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},d.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(a,c,d,e){var f,g=this._indexOfListener(a,d);if(g!==-1){if(f=this._bindings[g],f.isOnce()!==c)throw new Error("You cannot add"+(c?"":"Once")+"() then add"+(c?"Once":"")+"() the same listener without removing the relationship first.")}else f=new b(this,a,c,d,e),this._addBinding(f);return this.memorize&&this._prevParams&&f.execute(this._prevParams),f},_addBinding:function(a){var b=this._bindings.length;do{--b}while(this._bindings[b]&&a._priority<=this._bindings[b]._priority);this._bindings.splice(b+1,0,a)},_indexOfListener:function(a,b){for(var c,d=this._bindings.length;d--;)if(c=this._bindings[d],c._listener===a&&c.context===b)return d;return-1},has:function(a,b){return this._indexOfListener(a,b)!==-1},add:function(a,b,d){return c(a,"add"),this._registerListener(a,!1,b,d)},addOnce:function(a,b,d){return c(a,"addOnce"),this._registerListener(a,!0,b,d)},remove:function(a,b){c(a,"remove");var d=this._indexOfListener(a,b);return d!==-1&&(this._bindings[d]._destroy(),this._bindings.splice(d,1)),a},removeAll:function(){for(var a=this._bindings.length;a--;)this._bindings[a]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(a){if(this.active){var b,c=Array.prototype.slice.call(arguments),d=this._bindings.length;if(this.memorize&&(this._prevParams=c),d){b=this._bindings.slice(),this._shouldPropagate=!0;do{d--}while(b[d]&&this._shouldPropagate&&b[d].execute(c)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var e=d;e.Signal=d,"function"==typeof define&&define.amd?define("signals",[],function(){return e}):"undefined"!=typeof module&&module.exports?module.exports=e:a.signals=e}(this),/** @license
 * crossroads <http://millermedeiros.github.com/crossroads.js/>
 * Author: Miller Medeiros | MIT License
 * v0.12.0 (2013/01/21 13:47)
 */
function(){var a=function(a){function b(a,b){if(a.indexOf)return a.indexOf(b);for(var c=a.length;c--;)if(a[c]===b)return c;return-1}function c(a,c){var d=b(a,c);d!==-1&&a.splice(d,1)}function d(a,b){return"[object "+b+"]"===Object.prototype.toString.call(a)}function e(a){return d(a,"RegExp")}function f(a){return d(a,"Array")}function g(a){return"function"==typeof a}function h(a){return null===a||"null"===a?null:"true"===a||"false"!==a&&(a===o||"undefined"===a?o:""===a||isNaN(a)?a:parseFloat(a))}function i(a){for(var b=a.length,c=[];b--;)c[b]=h(a[b]);return c}function j(a,b){for(var c,d,e=(a||"").replace("?","").split("&"),f=e.length,g={};f--;)c=e[f].split("="),d=b?h(c[1]):c[1],g[c[0]]="string"==typeof d?decodeURIComponent(d):d;return g}function k(){this.bypassed=new a.Signal,this.routed=new a.Signal,this._routes=[],this._prevRoutes=[],this._piped=[],this.resetState()}function l(b,c,d,f){var g=e(b),h=f.patternLexer;this._router=f,this._pattern=b,this._paramsIds=g?null:h.getParamIds(b),this._optionalParamsIds=g?null:h.getOptionalParamsIds(b),this._matchRegexp=g?b:h.compilePattern(b,f.ignoreCase),this.matched=new a.Signal,this.switched=new a.Signal,c&&this.matched.add(c),this._priority=d||0}var m,n,o;return n=""===/t(.+)?/.exec("t")[1],k.prototype={greedy:!1,greedyEnabled:!0,ignoreCase:!0,ignoreState:!1,shouldTypecast:!1,normalizeFn:null,resetState:function(){this._prevRoutes.length=0,this._prevMatchedRequest=null,this._prevBypassedRequest=null},create:function(){return new k},addRoute:function(a,b,c){var d=new l(a,b,c,this);return this._sortedInsert(d),d},removeRoute:function(a){c(this._routes,a),a._destroy()},removeAllRoutes:function(){for(var a=this.getNumRoutes();a--;)this._routes[a]._destroy();this._routes.length=0},parse:function(a,b){if(a=a||"",b=b||[],this.ignoreState||a!==this._prevMatchedRequest&&a!==this._prevBypassedRequest){var c,d=this._getMatchedRoutes(a),e=0,f=d.length;if(f)for(this._prevMatchedRequest=a,this._notifyPrevRoutes(d,a),this._prevRoutes=d;e<f;)c=d[e],c.route.matched.dispatch.apply(c.route.matched,b.concat(c.params)),c.isFirst=!e,this.routed.dispatch.apply(this.routed,b.concat([a,c])),e+=1;else this._prevBypassedRequest=a,this.bypassed.dispatch.apply(this.bypassed,b.concat([a]));this._pipeParse(a,b)}},_notifyPrevRoutes:function(a,b){for(var c,d=0;c=this._prevRoutes[d++];)c.route.switched&&this._didSwitch(c.route,a)&&c.route.switched.dispatch(b)},_didSwitch:function(a,b){for(var c,d=0;c=b[d++];)if(c.route===a)return!1;return!0},_pipeParse:function(a,b){for(var c,d=0;c=this._piped[d++];)c.parse(a,b)},getNumRoutes:function(){return this._routes.length},_sortedInsert:function(a){var b=this._routes,c=b.length;do{--c}while(b[c]&&a._priority<=b[c]._priority);b.splice(c+1,0,a)},_getMatchedRoutes:function(a){for(var b,c=[],d=this._routes,e=d.length;(b=d[--e])&&((!c.length||this.greedy||b.greedy)&&b.match(a)&&c.push({route:b,params:b._getParamsArray(a)}),this.greedyEnabled||!c.length););return c},pipe:function(a){this._piped.push(a)},unpipe:function(a){c(this._piped,a)},toString:function(){return"[crossroads numRoutes:"+this.getNumRoutes()+"]"}},m=new k,m.VERSION="0.12.0",m.NORM_AS_ARRAY=function(a,b){return[b.vals_]},m.NORM_AS_OBJECT=function(a,b){return[b]},l.prototype={greedy:!1,rules:void 0,match:function(a){return a=a||"",this._matchRegexp.test(a)&&this._validateParams(a)},_validateParams:function(a){var b,c=this.rules,d=this._getParamsObject(a);for(b in c)if("normalize_"!==b&&c.hasOwnProperty(b)&&!this._isValidParam(a,b,d))return!1;return!0},_isValidParam:function(a,c,d){var h=this.rules[c],i=d[c],j=!1,k=0===c.indexOf("?");return null==i&&this._optionalParamsIds&&b(this._optionalParamsIds,c)!==-1?j=!0:e(h)?(k&&(i=d[c+"_"]),j=h.test(i)):f(h)?(k&&(i=d[c+"_"]),j=this._isValidArrayRule(h,i)):g(h)&&(j=h(i,a,d)),j},_isValidArrayRule:function(a,c){if(!this._router.ignoreCase)return b(a,c)!==-1;"string"==typeof c&&(c=c.toLowerCase());for(var d,e=a.length;e--;)if(d=a[e],("string"==typeof d?d.toLowerCase():d)===c)return!0;return!1},_getParamsObject:function(a){for(var c,d,e=this._router.shouldTypecast,f=this._router.patternLexer.getParamValues(a,this._matchRegexp,e),g={},i=f.length;i--;)d=f[i],this._paramsIds&&(c=this._paramsIds[i],0===c.indexOf("?")&&d&&(g[c+"_"]=d,d=j(d,e),f[i]=d),n&&""===d&&b(this._optionalParamsIds,c)!==-1&&(d=void 0,f[i]=d),g[c]=d),g[i]=d;return g.request_=e?h(a):a,g.vals_=f,g},_getParamsArray:function(a){var b=this.rules?this.rules.normalize_:null;return b=b||this._router.normalizeFn,b&&g(b)?b(a,this._getParamsObject(a)):this._getParamsObject(a).vals_},interpolate:function(a){var b=this._router.patternLexer.interpolate(this._pattern,a);if(!this._validateParams(b))throw new Error("Generated string doesn't validate against `Route.rules`.");return b},dispose:function(){this._router.removeRoute(this)},_destroy:function(){this.matched.dispose(),this.switched.dispose(),this.matched=this.switched=this._pattern=this._matchRegexp=null},toString:function(){return'[Route pattern:"'+this._pattern+'", numListeners:'+this.matched.getNumListeners()+"]"}},k.prototype.patternLexer=function(){function a(a,b){var c,d=[];for(a.lastIndex=0;c=a.exec(b);)d.push(c[1]);return d}function b(b){return a(l,b)}function c(b){return a(m.OP.rgx,b)}function d(a,b){return a=a||"",a&&(q===n?a=a.replace(j,""):q===p&&(a=a.replace(k,"")),a=e(a,"rgx","save"),a=a.replace(h,"\\$&"),a=e(a,"rRestore","res"),q===n&&(a="\\/?"+a)),q!==o&&(a+="\\/?"),new RegExp("^"+a+"$",b?"i":"")}function e(a,b,c){var d,e;for(e in m)m.hasOwnProperty(e)&&(d=m[e],a=a.replace(d[b],d[c]));return a}function f(a,b,c){var d=b.exec(a);return d&&(d.shift(),c&&(d=i(d))),d}function g(a,b){if("string"!=typeof a)throw new Error("Route pattern should be a string.");var c=function(a,c){var d;if(c="?"===c.substr(0,1)?c.substr(1):c,null!=b[c]){if("object"==typeof b[c]){var e=[];for(var f in b[c])e.push(encodeURI(f+"="+b[c][f]));d="?"+e.join("&")}else d=String(b[c]);if(a.indexOf("*")===-1&&d.indexOf("/")!==-1)throw new Error('Invalid value "'+d+'" for segment "'+a+'".')}else{if(a.indexOf("{")!==-1)throw new Error("The segment "+a+" is required.");d=""}return d};return m.OS.trail||(m.OS.trail=new RegExp("(?:"+m.OS.id+")+$")),a.replace(m.OS.rgx,m.OS.save).replace(l,c).replace(m.OS.trail,"").replace(m.OS.rRestore,"/")}var h=/[\\.+*?\^$\[\](){}\/'#]/g,j=/^\/|\/$/g,k=/\/$/g,l=/(?:\{|:)([^}:]+)(?:\}|:)/g,m={OS:{rgx:/([:}]|\w(?=\/))\/?(:|(?:\{\?))/g,save:"$1{{id}}$2",res:"\\/?"},RS:{rgx:/([:}])\/?(\{)/g,save:"$1{{id}}$2",res:"\\/"},RQ:{rgx:/\{\?([^}]+)\}/g,res:"\\?([^#]+)"},OQ:{rgx:/:\?([^:]+):/g,res:"(?:\\?([^#]*))?"},OR:{rgx:/:([^:]+)\*:/g,res:"(.*)?"},RR:{rgx:/\{([^}]+)\*\}/g,res:"(.+)"},RP:{rgx:/\{([^}]+)\}/g,res:"([^\\/?]+)"},OP:{rgx:/:([^:]+):/g,res:"([^\\/?]+)?/?"}},n=1,o=2,p=3,q=n;return function(){var a,b;for(a in m)m.hasOwnProperty(a)&&(b=m[a],b.id="__CR_"+a+"__",b.save="save"in b?b.save.replace("{{id}}",b.id):b.id,b.rRestore=new RegExp(b.id,"g"))}(),{strict:function(){q=o},loose:function(){q=n},legacy:function(){q=p},getParamIds:b,getOptionalParamsIds:c,getParamValues:f,compilePattern:d,interpolate:g}}(),m};"function"==typeof define&&define.amd?define("crossroads",["signals"],a):"undefined"!=typeof module&&module.exports?module.exports=a(require("signals")):window.crossroads=a(window.signals)}(),define("general.controllers/route-controller",["crossroads","util"],function(a,b){"use strict";function c(){o.forEach(function(a){a.dispose()}),n.forEach(function(a){e.addRoute(a)})}function d(){window.addEventListener("popstate",function(){var a=b.getParameterByName("app");if(f&&f!==a)return void(location.href=location.href);e.parse()},!1)}if(location.pathname.match(/hub$/i))return void(location.href=location.href+"/");location.hash&&history.replaceState(null,null,location.href.replace("#!/",""));var e={},f=b.getParameterByName("app"),g=b.getParameterByName("language"),h=b.getParameterByName("theme"),i=b.getParameterByName("debug"),j=b.getParameterByName("noData"),k=b.getParameterByName("feature"),l=[],m=[],n=[],o=[];return f&&l.push("app",f),g&&m.push("language",g),h&&m.push("theme",h),i&&m.push("debug",i),j&&m.push("noData",!0),k&&m.push("feature",k),e.isSuffixInUse=function(a){for(var b=0;b<m.length;b++)if(m[b]===a)return!0;return!1},e.removePartialSuffix=function(a){for(var b=!1,d=0;d<m.length;d++)if(m[d]===a){m.splice(d,2),b=!0;break}if(b){var f=location.href,g=new RegExp("/"+a+"/[^/]+","i");c(),g.test(f)&&(f=f.replace(g,""),e.setUrl(f))}return b},e.parse=function(b){a.parse(b||location.pathname)},e.addRoute=function(b){var c=this,d=b.pattern;n.push(b),b.isPartial&&("/"===d&&(d=""),d=c.buildUrl("replaceme").replace(location.protocol+"//"+location.host+"/","").replace("/replaceme",d));var e=a.addRoute(d,function(){c.lastRoute&&c.lastRoute!==b&&c.lastRoute.DeRoute.emit(),c.lastRoute=b,b.Route.emit.apply(b.Route,arguments)});o.push(e)},e.setUrl=function(a,c,d){c=!0,location.href.toLowerCase().indexOf("?x-")>-1&&(a=a.replace(/\?x-.+?=[^&]+/i,"").replace("&","?")),0!==a.indexOf(b.baseURI)?location.href=a:a!==location.href&&(history[c?"replaceState":"pushState"](null,null,a),d||e.parse())},e.start=function(){this.setUrl(location.href),d(),e.parse()},e.buildUrl=function(){var a=Array.apply(null,arguments),c="",d="";if(a[0]===!0?(c=a[1],a=a.slice(2)):a.unshift.apply(a,l),m.length&&a.push.apply(a,m),a=a.map(function(a){return encodeURIComponent(a).replace(/'/g,"%27")}),c){var e=new RegExp("([^/])/"+b.project+"/","i");d=b.baseURI.replace(e,"$1/"+c+"/")}else d=b.baseURI;return d+a.join("/").replace(/[\/]+/g,"/")},e}),define("core.utils/external-urls",["translator","autogenerated/product-info"],function(a,b){var c=b.externalUrls;return a.ready.then(function(){c.serverHelpBaseUrl=c.serverHelpBaseUrl.replace("{language}",a.language),c.personalHelpBaseUrl=c.personalHelpBaseUrl.replace("{language}",a.language)}),Object.defineProperty(c,"gettingStarted",{get:function(){return c.qlikWebPageUrl+"/"+a.language+"-sense-gettingstarted"}}),c}),define("text!general.controllers/expire-dialog.ng.html",[],function(){return"<div>\n\t<p class='dm-pb' ng-class=\"{'dm-pt': noTitle}\" q-translation=\"{{content}}\"></p>\n\t<p><upgrade-msg/></p>\n</div>"}),define("core.utils/help-url",["core.utils/external-urls"],function(a){function b(){var a=location.pathname.split("/").slice(-2,-1)[0];location.pathname.toLowerCase().indexOf("/workbench/")>-1?a="workbench":location.pathname.toLowerCase().indexOf("/dev-hub/")>-1?a="dev-hub":"qmc"!==a.toLowerCase()&&(a="client"),d+=a+"/"}var c={},d=a.serverHelpBaseUrl;return c.setBaseUrl=function(c){d=c?a.personalHelpBaseUrl:a.serverHelpBaseUrl,b()},Object.defineProperty(c,"path",{get:function(){return d}}),b(),c}),define("core.utils/environment",["core.utils/deferred","qvangular","core.utils/help-url"],function(a,b,c){function d(b){var c=new a;return f?f.promise.then(function(a){return a[b]}):(c.reject(),c.promise)}var e={},f=null;return e.setup=function(d){if(!f){f=new a,e.sessionPromise=f.promise;var g=+new Date,h=b.getService("$http"),i=h.get("../resources/autogenerated/product-info.json?_="+g).then(function(a){return a.data.composition&&"CloudSuite"===a.data.composition.deploymentType},function(){return!1}),j=d.rpc({method:"IsPersonalMode",handle:-1,params:[]});a.all({cloud:i,desktop:j}).then(function(a){var d=a.desktop.result.qReturn;b.$rootScope.isPersonalMode=d,c.setBaseUrl(d),f.resolve({isPersonalMode:d,isCloud:a.cloud})})}return f.promise},e.inClient=function(){return document.body.classList.contains("qv-client")},e.isDesktop=function(){return d("isPersonalMode")},e.isCloud=function(){return d("isCloud")},e}),function(){"use strict";define("xsrfplugin",["jquery"],function(a){function b(a){var b,c,d="";for(b=0;b<a;b++)c=Math.floor(62*Math.random()),d+=c<10?c:c>9&&c<36?String.fromCharCode(c+55):String.fromCharCode(c+61);return d}function c(){var c,d;e||(e=!0,c=b(16),d=a.ajax,a.extend({ajax:function(a){if(a.headers||(a.headers={}),a.headers["X-Qlik-XrfKey"]=c,"GET"===a.type)void 0===a.data&&(a.data={}),a.data.xrfkey=c;else if(a.url){var b=a.url.indexOf("?")===-1?"?":"&";a.url+=b+"xrfkey="+c}return d.call(this,a)}}))}function d(){e=!1}var e=!1;return{getRandomString:b,setupXsrfPlugin:c,resetHasBeenSetup:d}})}(),define("general.services/content-api/content-api",["qvangular","core.utils/deferred","translator","xsrfplugin","require"],function(a,b,c,d,e){a.service("$contentApi",["$http",function(f){function g(a){a.headers||(a.headers={})}function h(a){a.params||(a.params={})}function i(a){var b=d.getRandomString(16);return a.headers["X-Qlik-XrfKey"]=b,a.params.xrfkey=b,a}function j(a){var b=e.toUrl(""),c=b.indexOf("/resources");return c>-1&&(b=b.substring(0,c)),a.url=b+a.url,a}function k(a){var b=c.language;return b&&(a.headers["Accept-Language"]="pseudo"!==b?b:"qps-ploc"),a}function l(b){return g(b),h(b),a.$rootScope.isPersonalMode||i(b),j(b),k(b),f(b)}function m(){var a=new b;return l({method:"GET",url:"/qrs/extension/schema"}).then(function(b){var c=b.data;a.resolve(c)}).catch(function(b){var c=b.data;a.reject(c)}),a.promise}return{getExtensions:m,request:l}}])}),define("general.services/sections-toggler/sections-toggler",["qvangular","core.utils/environment","general.services/content-api/content-api"],function(a,b){var c=["HubSection_Home"],d=null;a.service("clientSections",["$contentApi",function(a){function e(){var a={};for(var b in c)a[c[b]]=!0;return a}return{get:function(f){return f=f||function(){},b.sessionPromise?b.sessionPromise.then(function(b){if(b.isPersonalMode)return f(e());var g=function(a){var b={};if(a.data||Array.isArray(a.data)){for(var d in c)a.data.indexOf(c[d])>-1&&(b[c[d]]=!0);return f(b)}};return(d||(d=a.request({method:"POST",url:"/qrs/systemrule/security/evaluatetransientresources",data:c,cache:!0}))).then(g).catch(g)}):f(e())}}}])}),define("text!general.services/delayed-modal/delayed-modal.ng.html",[],function(){return'<div class="qui-delayedModal" on-close-view="closeView( $event )" qv-escape="handleEscButton( $event )" ng-style="modalStyle" tid="errorDialog">\n\t<header class="dm-header" ng-if="title" q-translation="{{title}}"></header>\n\t<main ng-if="!html" class="dm-main"> <p class="dm-p">{{content | translate}}</p></main>\n\t<main ng-if="html" class="dm-main qv-appname"></main>\n\t<footer class="dm-footer">\n\t\t<lui-button x-variant="inverse" qv-delayed-dialog-button ng-if="!buttons.length && showDefaultButton" qva-activate="closeModal( $event, true );" qva-focus="true"\n\t\t\t\t\tq-translation="Common.OK" tid="confirm"></lui-button>\n\t\t<lui-button x-variant="inverse" qv-delayed-dialog-button ng-repeat="button in buttons" qva-focus="button.defaultButton" qva-activate="closeModal( $event );" ng-disabled="button.expression === false"\n\t\t\t\t\tq-translation="{{button.name}}" tid="{{button.tid}}"></lui-button>\n\t</footer>\n</div>\n'}),define("general.services/delayed-modal/delayed-modal",["jquery","core.utils/deferred","qvangular","text!general.services/delayed-modal/delayed-modal.ng.html","angular"],function(a,b,c,d){var e,f=window.angular,g={"max-height":"90%","max-width":"90%","min-height":"180px",width:"400px"},h=!1,i=!1;c.directive("qvDelayedDialogButton",function(){return{replace:!0,restrict:"A",link:function(a){a.button&&a.button.defaultEscButton&&(e=a),a.closeModal=function(b,c){b&&(b.preventDefault(),b.stopPropagation()),a.button&&a.button.callback&&(void 0===a.button.expression||a.button.expression)&&a.button.callback(),(c||a.autoClose||a.button&&!a.button.callback)&&a.destroyModal()}}}}),c.service("$delayedModal",["$compile","$rootScope","$document",function(c,j,k){var l,m,n,o,p,q={},r=d,s={open:function(a){var d,s=new b;l&&(m=l,o=n),l=j.$new(),n=f.element('<div class="qv-modal-container qui-modalbackground-centered" qva-outside-ignore-for="allOutside" ng-style="containerStyle" ng-class="classes"></div>'),l.containerStyle={content:" "},l.classes={},l.modalStyle={};for(var t in g)l.modalStyle[t]=g[t];l.wasDisabled=[],l.showDefaultButton=!0,h=!0,i=!1,q=a,l.failed=!1,l.autoClose=!0;for(t in q)l[t]=q[t];return n.html(r).appendTo(k.find("body")),l.html&&n.find("main").append(l.html),d=l.$watch("element",function(){s.resolve(),d()}),p=c(n)(l),l.destroyModal=this.close.bind(this),l.handleEscButton=function(a){a&&(a.preventDefault(),a.stopPropagation()),l.buttons&&e?e&&e.closeModal():l.destroyModal()},l.$broadcast("delayed-modal-opened"),l.$watchCollection("[width, height]",function(){l.width&&(l.modalStyle.width=l.width),l.height&&(l.modalStyle.height=l.height)}),s.promise},update:function(a){if(h){for(var b in a)l[b]=a[b],q[b]=a[b];(a.html||a.buttons)&&(n.html(r),n.find("main").html(a.html),k.find("body").find(".qui-delayedModal").replaceWith(n.html()),p=c(n)(l))}},close:function(){l&&n&&(l.$broadcast("delayed-modal-closed"),n.remove(),l.$destroy(),l=m||null,n=o||null,m=o=null),h=!1,i=!1},lock:function(){i=!0,l.wasDisabled.length=0,p.find("button, input, textarea, select").each(function(){var b=a(this);b.prop("disabled")?l.wasDisabled.push(this):b.prop("disabled",!0)})},unlock:function(){i=!1,p.find("button, input, textarea, select").each(function(){l.wasDisabled.indexOf(this)===-1&&a(this).prop("disabled",!1)}),l.wasDisabled.length=0}};return Object.defineProperty(s,"isOpened",{get:function(){return h}}),Object.defineProperty(s,"isLocked",{get:function(){return i}}),Object.defineProperty(s,"scope",{get:function(){return l}}),s}])}),define("general.controllers/error-handler-controller",["jquery","qvangular","translator","autogenerated/qix/engine-enums","general.enums/qrs-enums","general.controllers/route-controller","core.utils/external-urls","text!general.controllers/expire-dialog.ng.html","general.services/sections-toggler/sections-toggler","general.services/delayed-modal/delayed-modal"],function(a,b,c,d,e,f,g,h){"use strict";function i(){b.getService("$timeout")(function(){location.reload(!0)})}function j(d){k||b.getService("clientSections").get(function(e){var j=b.getService("$delayedModal");if(k=!0,"OnSessionLoggedOut"===d)return m={title:"ErrorDialog.GoToHub.Title",content:"ErrorDialog.GoToHub.Message",buttons:[{name:e.HubSection_Home?"ErrorDialog.GoToHub.Button":"Common.Refresh",defaultButton:!0,callback:function(){e.HubSection_Home?location.href=f.buildUrl(!0,"hub"):i()}}],showDefaultButton:!1,classes:{"qs-e-dim":!0}},void c.ready.then(function(){b.getService("$delayedModal").open(m),b.getService("$delayedModal").scope.$on("delayed-modal-closed",function(){k=!1})});if(d.code===l.LOCERR_JSON_RPC_INVALID_PARAMETERS)return void(k=!1);var n=[{name:"Common.Close",defaultEscButton:!0,defaultButton:!0,callback:function(){var a=null;2===m.buttons.length&&(a=m.buttons[1]),k=!1,j.scope.$root.$broadcast("errorHandlerClosed",m.content,a)}}];d.buttons?n=d.buttons:"ErrorDialog.AppClosed"===d.message||d.method&&"OnEngineWebsocketFailed"===d.method||d.code===l.LOCERR_APP_NOT_FOUND||d.code===l.LOCERR_APP_CONNECT_FAILED?(n=[{name:"Common.Refresh",callback:i}],e.HubSection_Home&&n.push({name:"ErrorDialog.GoToHub.Button",defaultButton:!0,callback:function(){location.href=f.buildUrl(!0,"hub")}})):d.code===l.LOCERR_SERVER_LICENSE_EXPIRED||d.code===l.LOCERR_SERVER_OUT_OF_SESSION_AND_USER_CALS||d.code===l.LOCERR_SERVER_OUT_OF_SESSION_CALS||d.code===l.LOCERR_SERVER_OUT_OF_USAGE_CALS||d.code===l.LOCERR_SERVER_OUT_OF_CALS||d.code===l.LOCERR_SERVER_OUT_OF_NAMED_CALS||d.code===l.LOCERR_GENERIC_CONNECTION_LOST?(n[0].defaultButton=!1,n.push({name:"Common.Refresh",defaultButton:!0,callback:function(){i();var a=null;2===m.buttons.length&&(a=m.buttons[1]),b.$rootScope.$broadcast("errorHandlerRefresh",m.content,a)}})):d.refreshButton&&(n=[{name:"Common.Refresh",defaultButton:!0,callback:i}]),c.ready.then(function(){if(m=a.extend(!0,{},d,{title:d.title||"ErrorDialog.Title",content:d.code?"ErrorCode."+d.code:d.message,buttons:n,showDefaultButton:!1,classes:{"qs-e-dim":!0}}),d.code===l.LOCERR_PERSONAL_VERSION_EXPIRED){var b=c.get("Info.QlikView.Personal.Upgrade",["<a href='"+g.personalUpgradeUrl+"' target='_blank'>"+g.personalUpgradeBase+"</a>"]),e=h.replace("<upgrade-msg/>",b);m.html=e,m.title="ErrorCode.12001.Sense.Desktop.Expired"}else"ProxyError.OnSessionTimedOut"===d.message&&(m.title="TimeoutDialog.Title");j.open(m),j.scope.$on("delayed-modal-closed",function(){k=!1}),j.scope.$root.$broadcast("errorHandlerOpen")}),document.activeElement&&a(document.activeElement).blur()})}var k=!1,l=a.extend({},d.NxLocalizedErrorCode,e.NxLocalizedErrorCode),m={};return{showDialog:j,isOpen:function(){return k}}}),function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define("enigma",[],b):"object"==typeof exports?exports.enigma=b():a.enigma=b()}(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(b,"__esModule",{value:!0});var e=c(1),f=d(e),g=c(4),h=d(g),i=new f.default,j=new h.default;i.registerService("qix",j.connect.bind(j)),b.default=i,a.exports=i},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(2),h=d(g),i=c(3),j=d(i),k=Object.assign||j.default,l=function(){function a(){e(this,a),this.services=new h.default}return f(a,[{key:"registerService",value:function(a,b){this.services.add(a,b)}},{key:"getService",value:function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];var e=k.apply(void 0,[{}].concat(c));return this.services.get(a)(e)}}]),a}();b.default=l},function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=function(){function a(){c(this,a),this.entries={}}return d(a,[{key:"add",value:function(a,b){if(a+="",void 0!==this.entries[a])throw new Error("Entry already defined with key "+a);this.entries[a]=b}},{key:"set",value:function(a,b){a+="",this.entries[a]=b}},{key:"remove",value:function(a){delete this.entries[a]}},{key:"get",value:function(a){return this.entries[a]}},{key:"getAll",value:function(){var a=this;return Object.keys(this.entries).map(function(b){return{key:b,value:a.entries[b]}})}},{key:"getKey",value:function(a){var b=this;return Object.keys(this.entries).filter(function(c){return b.entries[c]===a})[0]}},{key:"clear",value:function(){this.entries={}}}]),a}();b.default=e},function(a,b){"use strict";var c=Object.prototype.hasOwnProperty,d=Object.prototype.toString,e=function(a){return"function"==typeof Array.isArray?Array.isArray(a):"[object Array]"===d.call(a)},f=function(a){if(!a||"[object Object]"!==d.call(a))return!1;var b=c.call(a,"constructor"),e=a.constructor&&a.constructor.prototype&&c.call(a.constructor.prototype,"isPrototypeOf");if(a.constructor&&!b&&!e)return!1;var f;for(f in a);return void 0===f||c.call(a,f)};a.exports=function a(){var b,c,d,g,h,i,j=arguments[0],k=1,l=arguments.length,m=!1;for("boolean"==typeof j?(m=j,j=arguments[1]||{},k=2):("object"!=typeof j&&"function"!=typeof j||null==j)&&(j={});k<l;++k)if(null!=(b=arguments[k]))for(c in b)d=j[c],g=b[c],j!==g&&(m&&g&&(f(g)||(h=e(g)))?(h?(h=!1,i=d&&e(d)?d:[]):i=d&&f(d)?d:{},j[c]=a(m,i,g)):void 0!==g&&(j[c]=g));return j}},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(5),h=d(g),i=c(9),j=d(i),k=c(10),l=d(k),m=c(2),n=d(m),o=c(12),p=d(o),q=function(){function a(){e(this,a),this.sessions=new n.default}return f(a,[{key:"createSession",value:function(a,b,c,d,e,f,g){return new h.default(a,b,c,d,e,f,g)}},{key:"createRPC",value:function(a,b,c,d){return new l.default(a,b,c,d)}},{key:"buildUrl",value:function(a,b){var c=a.unsecure,d=a.host,e=a.port,f=a.prefix,g=a.subpath,h=a.route,i=a.identity,j=a.reloadURI,k="";return k+=c?"ws":"wss",k+="://",k+=d||"localhost",e&&(k+=":"+e),k+=f||"/",g&&(k+=g+"/"),h?k+=h:b&&""!==b&&(k+="app/"+encodeURIComponent(b)),i&&(k+="/identity/"+encodeURIComponent(i)),k+="?reloadUri="+(j?encodeURIComponent(j):"")}},{key:"getSession",value:function(a){var b=this,c=this.buildUrl(a.session,a.appId),d=a.session.disableCache,e=!d&&this.sessions.get(c);if(!e){var f=this.createRPC(a.Promise,c,a.createSocket,a.session);e=this.createSession(f,a.delta,a.schema,a.JSONPatch,a.Promise,a.listeners,a.responseInterceptors),d||(this.sessions.add(c,e),e.on("closed",function(){return b.sessions.remove(c)}))}return e}},{key:"getGlobal",value:function(a,b){var c=this;return a.connect().then(function(){var d={handle:-1,id:"Global",type:"Global",customType:"Global",delta:b.delta},e=a.getObjectApi(d);return e.openApp=e.openDoc=function(a){var d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",g=arguments.length>4&&void 0!==arguments[4]&&arguments[4];b.session.route="",b.appId=a;var h=c.getSession(b);return h.apiPromise||(h.apiPromise=h.connect().then(function(){return h.send({method:"OpenDoc",handle:-1,params:[a,d,e,f,!!g],delta:!1,outKey:-1})})),h.apiPromise},e}).catch(function(b){throw a.emit("closed",b),b})}},{key:"get",value:function(a,b){return this.getGlobal(a,b).then(function(a){return b.appId?a.openApp(b.appId,b.user,b.password,b.serial,b.noData).then(function(b){return{global:a,app:b}}):{global:a}})}},{key:"connect",value:function(b){a.configureDefaults(b),b.mixins.forEach(function(a){b.schema.registerMixin(a)});var c=this.getSession(b);return this.get(c,b)}}],[{key:"configureDefaults",value:function(a){if(!a.Promise&&"undefined"==typeof Promise)throw new Error("Your environment has no Promise implementation. You must provide a Promise implementation in the config.");a.Promise=a.Promise||Promise,a.session=a.session||{},a.session.host||("undefined"!=typeof location&&"string"==typeof location.hostname?a.session.host=location.hostname:a.session.host="localhost"),a.appId||a.session.route||(a.session.route="app/engineData"),"function"!=typeof a.createSocket&&"function"==typeof WebSocket&&(a.createSocket=function(a){return new WebSocket(a)}),a.schema instanceof j.default||(a.schema=new j.default(a.Promise,a.schema)),a.mixins=a.mixins||[],a.JSONPatch=a.JSONPatch||p.default}}]),a}();b.default=q},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=c(6),i=d(h),j=c(8),k=d(j),l=Object.prototype.hasOwnProperty,m=function(){function a(b,c,d,f,g){var h=this,j=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[];e(this,a),i.default.mixin(this),this.rpc=b,this.delta=c,this.definition=d,this.JSONPatch=f,this.Promise=g,this.apis=new k.default,this.responseInterceptors=[{onFulfilled:this.processErrorInterceptor},{onFulfilled:this.processDeltaInterceptor},{onFulfilled:this.processResultInterceptor},{onFulfilled:this.processOutInterceptor},{onFulfilled:this.processObjectApiInterceptor}],this.responseInterceptors.push.apply(this.responseInterceptors,l),b.on("socket-error",function(a){return h.emit("socket-error",a)}),b.on("closed",function(a){return h.emit("closed",a)}),b.on("notification",function(a){h.emit("notification:*",a.method,a.params),h.emit("notification:"+a.method,a.params)}),b.on("message",function(a){a.change&&a.change.forEach(function(a){return h.emit("handle-changed",a)}),a.close&&a.close.forEach(function(a){return h.emit("handle-closed",a)}),a.suspend&&h.rpc.send({method:"Resume",params:[],handle:a.suspend[0]})}),this.on("handle-changed",function(a){var b=h.apis.getApi(a);b&&b.emit("changed")}),this.on("handle-closed",function(a){var b=h.apis.getApi(a);b&&(b.emit("closed"),h.apis.remove(a))}),this.on("closed",function(){h.removeAllListeners(),h.apis.getApis().forEach(function(a){a.api.emit("closed"),a.api.removeAllListeners()}),h.apis.clear()}),Object.keys(j).forEach(function(a){return h.on(a,j[a])}),this.emit("session-created",this)}return g(a,[{key:"connect",value:function(){return this.rpc.open()}},{key:"send",value:function(b){var c={method:b.method,handle:b.handle,params:b.params,delta:b.delta},d=this.rpc.send(c);b.id=c.id;var e=this.intercept(d,this.responseInterceptors,b);return a.addToPromiseChain(e,"requestId",b.id),e}},{key:"close",value:function(){return this.rpc.close()}},{key:"getObjectApi",value:function(a){var b=a.handle,c=a.id,d=a.type,e=a.customType,f=a.delta,g=void 0===f||f,h=this.apis.getApi(b);return h||(h=this.definition.generate(d).create(this,b,c,g,e),this.apis.add(b,h),h)}},{key:"isPrimitivePatch",value:function(a){return 1===a.length&&["add","replace"].indexOf(a[0].op)!==-1&&this.isPrimitiveValue(a[0].value)&&"/"===a[0].path}},{key:"isPrimitiveValue",value:function(a){return void 0!==a&&null!==a&&"object"!==(void 0===a?"undefined":f(a))&&!Array.isArray(a)}},{key:"getPatchee",value:function(a,b,c){if(this.isPrimitivePatch(b)){var d=b[0].value;return this.apis.setPatchee(a,c,d),d}var e=this.apis.getPatchee(a,c);return this.isPrimitiveValue(e)||(e=e||(b.length&&Array.isArray(b[0].value)?[]:{}),this.applyPatch(e,b)),this.apis.setPatchee(a,c,e),e}},{key:"applyPatch",value:function(a,b){this.JSONPatch.apply(a,b)}},{key:"intercept",value:function(a,b,c){var d=this;return b.reduce(function(a,b){return a.then(b.onFulfilled&&b.onFulfilled.bind(d,c),b.onRejected&&b.onRejected.bind(d,c))},a)}},{key:"processErrorInterceptor",value:function(a,b){return void 0!==b.error?(this.emit("qix-error",b.error),this.Promise.reject(b.error)):b}},{key:"processDeltaInterceptor",value:function(a,b){var c=b.result;if(b.delta){for(var d=Object.keys(c),e=0,f=d.length;e<f;++e){var g=d[e],h=c[g];if(!Array.isArray(h))return this.Promise.reject("Unexpected rpc response, expected array of patches");c[g]=this.getPatchee(a.handle,h,a.method+"-"+g)}return JSON.parse(JSON.stringify(b))}return b}},{key:"processResultInterceptor",value:function(a,b){return b.result}},{key:"processOutInterceptor",value:function(a,b){return l.call(b,"qReturn")?b.qReturn:a.outKey!==-1?b[a.outKey]:b}},{key:"processObjectApiInterceptor",value:function(a,b){if(b.qHandle&&b.qType){var c={handle:b.qHandle,type:b.qType,id:b.qGenericId,customType:b.qGenericType,delta:this.delta};return this.getObjectApi(c)}return null===b.qHandle&&null===b.qType?null:b}}],[{key:"addToPromiseChain",value:function(b,c,d){b[c]=d;var e=b.then
;b.then=function(){for(var b=arguments.length,f=Array(b),g=0;g<b;g++)f[g]=arguments[g];var h=e.apply(this,f);return a.addToPromiseChain(h,c,d),h}}}]),a}();b.default=m},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(7),e=function(a){return a&&a.__esModule?a:{default:a}}(d);b.default={mixin:function(a){Object.keys(e.default.prototype).forEach(function(b){a[b]=e.default.prototype[b]}),e.default.init(a)}}},function(a,b){function c(){c.init.call(this)}var d={};d.isObject=function(a){return"object"==typeof a&&null!==a},d.isNumber=function(a){return"number"==typeof a},d.isUndefined=function(a){return void 0===a},d.isFunction=function(a){return"function"==typeof a},a.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0,c.defaultMaxListeners=10,c.init=function(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(a){if(!d.isNumber(a)||a<0||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},c.prototype.emit=function(a){var b,c,e,f,g,h;if(this._events||(this._events={}),"error"===a&&!this._events.error)throw b=arguments[1],b instanceof Error?b:Error('Uncaught, unspecified "error" event.');if(c=this._events[a],d.isUndefined(c))return!1;if(d.isFunction(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(e=arguments.length,f=new Array(e-1),g=1;g<e;g++)f[g-1]=arguments[g];c.apply(this,f)}else if(d.isObject(c)){for(e=arguments.length,f=new Array(e-1),g=1;g<e;g++)f[g-1]=arguments[g];for(h=c.slice(),e=h.length,g=0;g<e;g++)h[g].apply(this,f)}return!0},c.prototype.addListener=function(a,b){var e;if(!d.isFunction(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,d.isFunction(b.listener)?b.listener:b),this._events[a]?d.isObject(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,d.isObject(this._events[a])&&!this._events[a].warned){var e;e=d.isUndefined(this._maxListeners)?c.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[a].length>e&&(this._events[a].warned=!0,d.isFunction(console.error)&&console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),d.isFunction(console.trace)&&console.trace())}return this},c.prototype.on=c.prototype.addListener,c.prototype.once=function(a,b){function c(){this.removeListener(a,c),e||(e=!0,b.apply(this,arguments))}if(!d.isFunction(b))throw TypeError("listener must be a function");var e=!1;return c.listener=b,this.on(a,c),this},c.prototype.removeListener=function(a,b){var c,e,f,g;if(!d.isFunction(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,e=-1,c===b||d.isFunction(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(d.isObject(c)){for(g=f;g-- >0;)if(c[g]===b||c[g].listener&&c[g].listener===b){e=g;break}if(e<0)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(e,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},c.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],d.isFunction(c))this.removeListener(a,c);else if(Array.isArray(c))for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},c.prototype.listeners=function(a){return this._events&&this._events[a]?d.isFunction(this._events[a])?[this._events[a]]:this._events[a].slice():[]},c.listenerCount=function(a,b){return a._events&&a._events[b]?d.isFunction(a._events[b])?1:a._events[b].length:0}},function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(b,"__esModule",{value:!0});var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)},i=c(2),j=function(a){return a&&a.__esModule?a:{default:a}}(i),k=function(a){function b(){return d(this,b),e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this))}return f(b,a),g(b,[{key:"add",value:function(a,c){var d={api:c,deltaCache:new j.default};return h(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"add",this).call(this,a.toString(),d),d}},{key:"getApi",value:function(a){var b=this.get(a.toString());return b&&b.api}},{key:"getApis",value:function(){return h(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"getAll",this).call(this).map(function(a){return{handle:a.key,api:a.value.api}})}},{key:"getPatchee",value:function(a,b){var c=this.get(a.toString());return c&&c.deltaCache.get(b)}},{key:"addPatchee",value:function(a,b,c){this.get(a.toString()).deltaCache.add(b,c)}},{key:"setPatchee",value:function(a,b,c){this.get(a.toString()).deltaCache.set(b,c)}}]),b}(j.default);b.default=k},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(2),h=d(g),i=c(6),j=d(i),k=["GetProperties","SetProperties","GetFullPropertyTree","SetFullPropertyTree","GetAppProperties","SetAppProperties"],l=function(){function a(b,c){e(this,a),this.Promise=b,this.mixins=new h.default,this.def=c,this.types=new h.default}return f(a,[{key:"registerMixin",value:function(a){var b=this,c=a.types,d=a.type,e=a.extend,f=a.override,g=a.init;Array.isArray(c)||(c=[c]),d&&c.push(d);var h={extend:e,override:f,init:g};c.forEach(function(a){var c=b.mixins.get(a);c?c.push(h):b.mixins.add(a,[h])})}},{key:"generate",value:function(a){var b=this.types.get(a);if(b)return b;if(!this.def.structs[a])throw new Error(a+" not found");var c=this.generateApi(a,this.def.structs[a]);return this.types.add(a,c),c}},{key:"generateApi",value:function(a,b){var c=Object.create({});return this.generateDefaultApi(c,b),this.mixinType(a,c),{create:function(b,d,e,f,g){var h=this,i=Object.create(c);j.default.mixin(i),Object.defineProperties(i,{session:{enumerable:!0,value:b},handle:{enumerable:!0,value:d},id:{enumerable:!0,value:e},delta:{enumerable:!0,value:f}});var k=this.mixins.get(a)||[];return g!==a&&(this.mixinType(g,i),k=k.concat(this.mixins.get(g)||[])),k.forEach(function(a){"function"==typeof a.init&&a.init({Promise:h.Promise,api:i})}),i}.bind(this),def:c}}},{key:"generateDefaultApi",value:function(a,b){Object.keys(b).forEach(function(c){var d=c.substring(0,1).toLowerCase()+c.substring(1),e=b[c].Out&&1===b[c].Out.length?b[c].Out[0].Name:-1,f=k.indexOf(c)===-1&&e!==-1&&"qSuccess"!==e,g=function(){for(var a=arguments.length,b=Array(a),d=0;d<a;d++)b[d]=arguments[d];return this.session.send({method:c,handle:this.handle,params:b,delta:this.delta&&f,outKey:e})};Object.defineProperty(a,d,{enumerable:!0,writable:!0,value:g})})}},{key:"mixinType",value:function(a,b){var c=this.mixins.get(a);c&&c.forEach(function(c){var d=c.extend,e=void 0===d?{}:d,f=c.override,g=void 0===f?{}:f;Object.keys(g).forEach(function(c){if("function"!=typeof b[c]||"function"!=typeof g[c])throw new Error("No function to override. Type: "+a+" function: "+c);!function(){var a=b[c];b[c]=function(){for(var b=arguments.length,d=Array(b),e=0;e<b;e++)d[e]=arguments[e];return g[c].apply(this,[a.bind(this)].concat(d))}}()}),Object.keys(e).forEach(function(c){if("function"==typeof b[c]&&"function"==typeof e[c])throw new Error("Extend is not allowed for this mixin. Type: "+a+" function: "+c);b[c]=e[c]})})}}]),a}();b.default=l},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(6),h=d(g),i=c(11),j=d(i),k=function(){function a(b,c,d,f){e(this,a),h.default.mixin(this),this.Promise=b,this.url=c,this.createSocket=d,this.sessionConfig=f,this.resolvers={},this.requestId=0,this.openedPromise=void 0}return f(a,[{key:"open",value:function(){var a=this;if(this.openedPromise)return this.openedPromise;try{this.socket=this.createSocket(this.url,this.sessionConfig)}catch(a){return this.Promise.reject(a)}return this.socket.onopen=this.onOpen.bind(this),this.socket.onclose=this.onClose.bind(this),this.socket.onerror=this.onError.bind(this),this.socket.onmessage=this.onMessage.bind(this),this.openedPromise=new this.Promise(function(b,c){return a.registerResolver("opened",b,c)}),this.closedPromise=new this.Promise(function(b,c){return a.registerResolver("closed",b,c)}),this.openedPromise}},{key:"onOpen",value:function(){var a=this;this.resolvers.opened.resolveWith(function(){return a.closedPromise})}},{key:"onClose",value:function(a){this.emit("closed",a),this.resolvers.closed.resolveWith(a),this.rejectAllOutstandingResolvers()}},{key:"close",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.socket.close(a,b),this.closedPromise}},{key:"onError",value:function(a){this.resolvers.opened?this.resolvers.opened.rejectWith(a):this.emit("socket-error",a),this.rejectAllOutstandingResolvers()}},{key:"onMessage",value:function(a){var b=JSON.parse(a.data);void 0!==b.id?(this.emit("message",b),this.resolvers[b.id].resolveWith(b)):this.emit(b.params?"notification":"message",b)}},{key:"rejectAllOutstandingResolvers",value:function(){var a=this;Object.keys(this.resolvers).forEach(function(b){if("opened"!==b&&"closed"!==b){a.resolvers[b].rejectWith()}})}},{key:"unregisterResolver",value:function(a){this.resolvers[a].removeAllListeners(),delete this.resolvers[a]}},{key:"registerResolver",value:function(a,b,c){var d=this,e=this.resolvers[a]=new j.default(a,b,c);e.on("resolved",function(a){return d.unregisterResolver(a)}),e.on("rejected",function(a){return d.unregisterResolver(a)})}},{key:"send",value:function(a){var b=this;return this.socket&&this.socket.readyState===this.socket.OPEN?(a.jsonrpc="2.0",a.id=++this.requestId,this.socket.send(JSON.stringify(a)),new this.Promise(function(c,d){return b.registerResolver(a.id,c,d)})):this.Promise.reject(new Error("Not connected"))}}]),a}();b.default=k},function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=c(6),g=function(a){return a&&a.__esModule?a:{default:a}}(f),h=function(){function a(b,c,e){d(this,a),g.default.mixin(this),this.id=b,this.resolve=c,this.reject=e}return e(a,[{key:"resolveWith",value:function(a){this.resolve(a),this.emit("resolved",this.id)}},{key:"rejectWith",value:function(a){this.reject(a),this.emit("rejected",this.id)}}]),a}();b.default=h},function(a,b,c){var d,e,f;!function(g,h){e=[c(3)],d=h,void 0!==(f="function"==typeof d?d.apply(b,e):d)&&(a.exports=f)}(0,function(a){function b(b){return b&&(b=a({},{val:b}).val),b}function c(a,b){return l(a[b])||"$$"===b.substring(0,2)||"_"===b.substring(0,1)}function d(a,b){var c,d=b.substring(1).split("/").slice(0,-1);return d.forEach(function(b,e){e!==d.length&&(c=+b,a=a[c||b]=k(a[c||b])?isNaN(c)?{}:[]:a[b])}),a}function e(a){Object.keys(a).forEach(function(b){Object.getOwnPropertyDescriptor(a,b).configurable&&!c(a,b)&&delete a[b]})}function f(a,b){var c,d,e=!0;if(i(a)&&i(b))return Object.keys(a).length===Object.keys(b).length&&(Object.keys(a).forEach(function(c){if(!f(a[c],b[c]))return e=!1,!1}),e);if(j(a)&&j(b)){if(a.length!==b.length)return!1;for(c=0,d=a.length;c<d;c++)if(!f(a[c],b[c]))return!1;return!0}return a===b}function g(a,b,c){function d(a,b,c){if(a[c]&&k(a[c].qInfo))return null;if(a[c]&&a[c].qInfo.qId===b)return c;for(var d=0,e=a.length;d<e;d++)if(a[d]&&a[d].qInfo.qId===b)return d;return-1}var e,g,i=[],j=a.slice(),l=-1;if(f(b,j))return i;if(!k(b[0])&&k(b[0].qInfo))return i.push({op:"replace",path:c,value:b}),i;for(e=j.length-1;e>=0;--e)l=d(b,j[e].qInfo&&j[e].qInfo.qId,e),l===-1?(i.push({op:"remove",path:c+"/"+e}),j.splice(e,1)):i=i.concat(h.generate(j[e],b[l],c+"/"+e));for(e=0,g=b.length;e<g;++e)l=d(j,b[e].qInfo&&b[e].qInfo.qId),l===-1?(i.push({op:"add",path:c+"/"+e,value:b[e]}),j.splice(e,0,b[e])):l!==e&&(i.push({op:"move",path:c+"/"+e,from:c+"/"+l}),j.splice(e,0,j.splice(l,1)[0]));return i}a=a.bind(null,!0);var h={},i=function(a){return null!=a&&!Array.isArray(a)&&"object"==typeof a},j=Array.isArray,k=function(a){return void 0===a},l=function(a){return"function"==typeof a};return h.generate=function(a,d,e){e=e||"";var l=[];return Object.keys(d).forEach(function(m){var n=b(d[m]),o=a[m],p=e+"/"+m;f(n,o)||c(d,m)||(k(o)?l.push({op:"add",path:p,value:n}):i(n)&&i(o)?l=l.concat(h.generate(o,n,p)):j(n)&&j(o)?l=l.concat(g(o,n,p)):l.push({op:"replace",path:e+"/"+m,value:n}))}),Object.keys(a).forEach(function(b){k(d[b])&&!c(a,b)&&l.push({op:"remove",path:e+"/"+b})}),l},h.apply=function(b,c){c.forEach(function(c){var f=d(b,c.path),g=c.path.split("/").splice(-1)[0],h=g&&isNaN(+g)?f[g]:f[+g]||f,k=c.from?c.from.split("/").splice(-1)[0]:null;if("/"===c.path&&(f=null,h=b),"add"===c.op||"replace"===c.op)if(j(f))"-"===g&&(g=f.length),f.splice(+g,"add"===c.op?0:1,c.value);else if(j(h)&&j(c.value)){var l=c.value.slice();h.length=0,h.push.apply(h,l)}else if(i(h)&&i(c.value))e(h),a(h,c.value);else{if(!f)throw new Error("Patchee is not an object we can patch");f[g]=c.value}else if("move"===c.op){var m=d(b,c.from);j(f)?f.splice(+g,0,m.splice(+k,1)[0]):(f[g]=m[k],delete m[k])}else"remove"===c.op&&(j(f)?f.splice(+g,1):delete f[g])})},h.clone=function(b){return a({},b)},h.createPatch=function(a,b,c){var d={op:a.toLowerCase(),path:c};return"move"===d.op?d.from=b:void 0!==b&&(d.value=b),d},h.updateObject=function(b,c){if(!Object.keys(b).length)return void a(b,c);h.apply(b,h.generate(b,c))},h})}])}),define("core.models/mixins/app-on-child",[],function(){"use strict";return{types:["GenericObject","GenericDimension","GenericMeasure","GenericBookmark","GenericVariable","Field"],init:function(a){var b=a.api;b.app=b.session.app}}}),define("core.models/mixins/app-settings",[],function(){"use strict";var a={qInfo:{qId:"appprops",qType:"appprops"},sheetTitleBgColor:"",sheetTitleGradientColor:"",sheetTitleColor:"",sheetLogoThumbnail:{qStaticContentUrlDef:null},sheetLogoPosition:"",rtl:!1};return{types:"Doc",extend:{getClientAppSettingsObject:function(){return this.getObject(a.qInfo.qId).then(function(b){return b||this.createObject(a)}.bind(this))},getClientAppSettings:function(){return this.getClientAppSettingsObject().then(function(a){return a.getLayout()})},setClientAppSettings:function(a){return this.getClientAppSettingsObject().then(function(b){return b.setProperties(a)})}}}}),define("core.models/mixins/bookmark-list",[],function(){"use strict";var a={qInfo:{qId:"BookmarkList",qType:"BookmarkList"},qBookmarkListDef:{qType:"bookmark",qData:{title:"/qMetaDef/title",description:"/qMetaDef/description",sheetId:"/sheetId",selectionFields:"/selectionFields",creationDate:"/creationDate"}}};return{types:"Doc",extend:{getBookmarkList:function(){return this.getListData(a)},getBookmarkListObject:function(){return this.getListObject(a)}}}}),define("core.models/mixins/current-selections",[],function(){"use strict";function a(a,b,c){return a.getField(b).then(function(a){return a[c]()})}return{types:["CurrentSelection"],extend:{clearField:function(b){return a(this.app,b,"clear")},lockField:function(b){return a(this.app,b,"lock")},unlockField:function(b){return a(this.app,b,"unlock")},clearAll:function(){return this.app.clearAll()},back:function(){return this.app.back()},forward:function(){return this.app.forward()}}}}),define("core.models/mixins/dimension-list",[],function(){"use strict";var a={qInfo:{qId:"DimensionList",qType:"DimensionList"},qDimensionListDef:{qType:"dimension",qData:{title:"/qMetaDef/title",tags:"/qMetaDef/tags",grouping:"/qDim/qGrouping",info:"/qDimInfos"}}};return{types:"Doc",extend:{getDimensionList:function(){return this.getListData(a)},getDimensionListObject:function(){return this.getListObject(a)}}}}),define("core.models/mixins/doc",["core.utils/permissions","core.utils/deferred"],function(a,b){"use strict";var c={qInfo:{qId:"CurrentSelection",qType:"CurrentSelection"},qSelectionObjectDef:{}},d={qInfo:{qId:"UndoInfo",qType:"UndoInfo"},qUndoInfoDef:{}};return{types:"Doc",override:{getContentLibraries:function(a){return a().then(function(a){return a.qItems})},getLibraryContent:function(a,b){return a(b).then(function(a){return a.qItems})}},extend:{getProperties:function(){return this.getAppProperties()},setProperties:function(a){return this.setAppProperties(a)},getListData:function(a){return this.getListObject(a).then(function(a){return a.getLayout()})},getListObject:function(b){var c=Object.keys(b).filter(function(a){return a.indexOf("ListDef")!==-1})[0];if(!c)throw new Error("Invalid list definition");c&&(c=c.replace(/Def$/g,""));var d=b.qInfo.qId;return this._listCache[d]||(this._listCache[d]=this.getObject(d).then(function(a){return a||this.createSessionObject(b)}.bind(this)).then(function(b){var d=b.getLayout.bind(b);return b.getLayout=function(){return d().then(function(b){return b[c].qItems.forEach(function(b){"object"==typeof b&&a.mapToLayout(b)}),b[c].qItems})},b})),this._listCache[d]},getCurrentSelectionObject:function(){var a=this;return this.getObject(c.qInfo.qId).then(function(b){return b||a.createSessionObject(c)})},getUndoInfoObject:function(){var a=this;return a.getObject(d.qInfo.qId).then(function(b){return b||a.createSessionObject(d)})},createSheet:function(a,b,c){return this.createObject({qInfo:{qType:"sheet"},qMetaDef:{title:a||"",description:b||""},rank:-1,thumbnail:{qStaticContentUrlDef:c||null},columns:24,rows:12,cells:[],qChildListDef:{qData:{title:"/title"}}})},createStory:function(){return this.createObject({qInfo:{qType:"story"},qMetaDef:{title:"",description:""},rank:-1,thumbnail:{qStaticContentUrlDef:null},qChildListDef:{qData:{title:"/title",rank:"/rank"}}})},getLayout:function(){return this.getAppLayout().then(function(b){return a.mapToLayout(b,!0),b})},abortModalSelection:function(a){return a=void 0===a||a,this.setModalSelection(null),this.abortModal(a)},switchModalSelection:function(a,c,d){var e;return a=a||null,c=c||"",d=void 0===d||d,e=Array.isArray(c)?c:[c],this.isInModalSelection()&&this.modalSelectionObject.endSelections(d),a&&!a.isClosed?(this.setModalSelection(a),a.beginSelections(e)):(this.setModalSelection(null),b.resolve())},setModalSelection:function(a){this.modalSelectionObject=a},isInModalSelection:function(){return this.modalSelectionObject&&!this.modalSelectionObject.isClosed},getPublishableStreams:function(){return this.Promise.all([this.getLayout(),this.global.getStreamList()]).then(function(a){return a[1].filter(function(b){return a[0].stream?b.qId===a[0].stream.id&&b.privileges.indexOf("publish")!==-1:b.privileges.indexOf("publish")!==-1})})}},init:function(a){var b=a.api;b.Promise=a.Promise,b.session.app=b,b.waitForOpen=b.Promise.defer(),b.waitForOpen.resolve(),b._listCache={}}}}),define("core.models/mixins/export",[],function(){return{types:"GenericObject",override:{exportData:function(a,b,c,d,e){return b=b||"OOXML",c=c||"",d=d||"",e=e||"P",a(b,c,d,e)}}}}),define("core.models/mixins/field-list-object",[],function(){"use strict";function a(){return this.getLayout().then(function(a){for(var b=[],c=0;c<a.length;++c){var d=a[c];if(b.push(d),d.qDerivedFieldData)for(var e=0;e<d.qDerivedFieldData.qDerivedFieldLists.length;++e)for(var f=d.qDerivedFieldData.qDerivedFieldLists[e],g=0;g<f.qFieldDefs.length;++g){var h=f.qFieldDefs[g];b.push({qName:h.qName,qSrcTables:d.qSrcTables,qTags:h.qTags,isDerived:!0,sourceField:d.qName,derivedDefinitionName:f.qDerivedDefinitionName})}}return b})}return{types:["FieldList"],extend:{expand:a}}}),define("core.models/mixins/field-list",[],function(){"use strict";var a={qInfo:{qId:"FieldList",qType:"FieldList"},qFieldListDef:{qShowSystem:!1,qShowHidden:!1,qShowSrcTables:!0,qShowSemantic:!0,qShowDerivedFields:!0}};return{types:"Doc",extend:{getFieldList:function(){return this.getListData(a)},getFieldListObject:function(){return this.getListObject(a)}}}}),define("core.models/mixins/fields-on-the-fly-list",[],function(){"use strict";var a={qInfo:{qId:"FieldOnTheFlyList",qType:"FieldOnTheFlyList"},qFieldListDef:{qShowSystem:!1,qShowHidden:!1,qShowSrcTables:!0,qShowSemantic:!0,qShowDerivedFields:!0,qShowDefinitionOnly:!0}};return{types:"Doc",extend:{getFieldsOnTheFlyList:function(){return this.getListData(a)},getFieldsOnTheFlyListObject:function(){return this.getListObject(a)}}}}),define("core.models/mixins/generic-object",["core.utils/json-patch"],function(a){"use strict";return{types:["GenericObject"],override:{getEffectiveProperties:function(b){return b().then(function(b){return this.effectiveProperties=this.effectiveProperties||b,a.updateObject(this.effectiveProperties,b),this.effectiveProperties}.bind(this))}}}}),define("core.models/mixins/layout-observable",[],function(){"use strict";function a(a){this.getLayout=function(a){this.requestPromise=a.getLayout().then(function(b){this.requestPromise=null,a.isCancelled||this.fn(b)}.bind(this))}.bind(this,a),this.onInvalidated=function(){this.getLayout()}.bind(this),this.api=a,this.fn=null}return a.prototype.subscribe=function(a){if("function"!=typeof a)throw new Error("Observer must be a function");"function"!=typeof this.fn&&(this.fn=a,this.api.Invalidated.bind(this.onInvalidated),this.getLayout())},a.prototype.dispose=function(){this.api.Invalidated.unbind(this.onInvalidated)},a.prototype.cancel=function(){return!!this.requestPromise&&(this.api.app.global.cancelRequest(this.requestPromise.requestId),this.api.markAsCancelled(),this.requestPromise=null,!0)},a.prototype.retry=function(){this.api.isCancelled&&this.getLayout()},{types:["Doc","GenericObject","GenericDimension","GenericMeasure","GenericBookmark","GenericVariable"],extend:{layoutSubscribe:function(b){var c=new a(this);return c.subscribe(b),c}}}}),define("core.models/mixins/master-object-list",[],function(){"use strict";var a={qInfo:{qId:"MasterObjectList",qType:"MasterObjectList"},qAppObjectListDef:{qType:"masterobject",qData:{name:"/qMetaDef/title",visualization:"/visualization",tags:"/qMetaDef/tags"}}};return{types:"Doc",extend:{getMasterObjectList:function(){return this.getListData(a)},getMasterObjectListObject:function(){return this.getListObject(a)}}}}),define("core.models/mixins/measure-list",[],function(){"use strict";var a={qInfo:{qId:"MeasureList",qType:"MeasureList"},qMeasureListDef:{qType:"measure",qData:{title:"/qMetaDef/title",tags:"/qMetaDef/tags"}}};return{types:"Doc",extend:{getMeasureList:function(){return this.getListData(a)},getMeasureListObject:function(){return this.getListObject(a)}}}}),define("core.models/mixins/permissions",["core.utils/permissions"],function(a){"use strict";return{types:["GenericObject"],override:{getLayout:function(b){return b().then(function(b){return a.mapToLayout(b,!1),b})}}}}),define("core.models/mixins/undo-info",[],function(){"use strict";return{types:["UndoInfo"],extend:{undo:function(){return this.layout.qUndoInfo.qUndoCount>0?this.app.undo():this.Promise.resolve()},redo:function(){return this.layout.qUndoInfo.qRedoCount>0?this.app.redo():this.Promise.resolve()},reset:function(){return this.getLayout().then(function(a){if(a.qUndoCount||a.qRedoCount)return this.app.clearUndoBuffer()}.bind(this))}},override:{getLayout:function(a){return a().then(function(a){return a.qUndoInfo})}},init:function(a){a.api.Promise=a.Promise}}}),define("core.models/mixins/variable-list",[],function(){"use strict";var a={qInfo:{qId:"VariableList",qType:"VariableList"},qVariableListDef:{qType:"variable",qShowReserved:!0,qShowConfig:!0,qData:{tags:"/tags"}}};return{types:"Doc",extend:{getVariableList:function(){return this.getListData(a)},getVariableListObject:function(){return this.getListObject(a)}}}}),define("core.models/mixins/search-history-list",["core.utils/deferred"],function(a){"use strict";var b={qInfo:{qId:"SearchHistoryList",qType:"SearchHistoryList"},qAppObjectListDef:{qType:"searchhistory",qData:{title:"/qMetaDef/title",description:"/qMetaDef/description",creationDate:"/creationDate",lastUsedDate:"/lastUsedDate",query:"/query",searchTerms:"/searchTerms"}}};return{types:"Doc",extend:{getSearchHistoryList:function(){return this.getListData(b)},getSearchHistoryListObject:function(){return this.getListObject(b)},createSearchHistoryObject:function(b,c){return this.createObject({qInfo:{qType:"searchhistory"},qMetaDef:{title:"",description:""},searchTerms:c||[],query:b||"",creationDate:(new Date).toISOString(),lastUsedDate:(new Date).toISOString()}).then(function(b){return this.getSearchHistoryList().then(function(c){if(11===c.length){var d,e=(new Date).getTime();return c.forEach(function(a){Date.parse(a.qData.lastUsedDate)<e&&(e=Date.parse(a.qData.lastUsedDate),d=a)}),this.destroyObject(d.qInfo.qId).then(function(){return a.resolve(b)})}return a.resolve(b)}.bind(this))}.bind(this))},updateSearchHistoryObject:function(a,b){return this.getObject(a).then(function(a){return a.getProperties().then(function(c){return b(c),a.setProperties(c)})})},clearSearchHistory:function(){return this.getSearchHistoryList().then(function(b){for(var c=[],d=0;d<b.length;d++)c.push(this.destroyObject(b[d].qInfo.qId));return a.all(c)}.bind(this))}}}}),define("core.models/mixins/search-history",[],function(){"use strict";return{types:["SearchHistoryList"],override:{getLayout:function(a){return a().then(function(a){return a={qAppObjectList:{qItems:a.qAppObjectList.qItems.filter(function(a){return a.qMeta&&!a.qMeta.approved&&!a.qMeta.published})}},this.layout=a,a}.bind(this))}}}}),define("core.models/mixins/sheet-list",[],function(){"use strict";var a={qInfo:{qId:"SheetList",qType:"SheetList"},qAppObjectListDef:{qType:"sheet",qData:{title:"/qMetaDef/title",description:"/qMetaDef/description",thumbnail:"/thumbnail",cells:"/cells",rank:"/rank",columns:"/columns",rows:"/rows"}}};return{types:"Doc",extend:{getSheetList:function(){return this.getListData(a)},getSheetListObject:function(){return this.getListObject(a)}}}}),define("general.utils/visualizations",[],function(){function a(a){return c[a]}function b(a,b){c[a]=b}var c={};return{getType:a,getRegisteredNames:function(){return Object.keys(c)},getLibraryInfo:function(a){return c[a]?c[a].getLibraryInfo():null},getTemplateIconClassName:function(a){return c[a]?c[a].getTemplateIconClassName():null},getIconChar:function(a){return c[a]?c[a].getIconChar():null},registerType:b}}),define("core.models/mixins/sheet",["util","core.utils/deferred","general.utils/visualizations"],function(a,b,c){"use strict";function d(a,b){var c,d;for(c=0;c<a.cells.length;++c)if(d=a.cells[c],d.col===b.col&&d.row===b.row)return c;return-1}function e(a,b,c){var e=d(a,b);if(e===-1){if(c)return null;throw new Error("invalid pos")}return a.cells[e]}function f(a,b){a.col=b.col,a.row=b.row,a.colspan=b.colspan,a.rowspan=b.rowspan}function g(a,b,c,d){var f=e(a,b,!0),g=f?f.name:null;return f?(f.name=c,f.type=d):a.cells.push({name:c,type:d,col:b.col,row:b.row,colspan:b.colspan,rowspan:b.rowspan}),g}function h(a,b){var c={col:a.col,row:a.row,colspan:a.colspan,rowspan:a.rowspan},d={col:a.col,row:a.row,colspan:a.colspan,rowspan:a.rowspan};if("left"===b||"right"===b){var e=Math.ceil(a.colspan/2);c.colspan-=e,d.col+=a.colspan-e,d.colspan=e}if("top"===b||"bottom"===b){var f=Math.ceil(a.rowspan/2);c.rowspan-=f,d.row+=a.rowspan-f,d.rowspan=f}if("top"===b||"left"===b){var g=c;c=d,d=g}return{pos1:c,pos2:d}}function i(a,b,c){var d=e(a,b,!1);if(!d||d.colspan!==b.colspan||d.rowspan!==b.rowspan)return!1;var g=h(d,c);return f(d,g.pos1),g.pos2}function j(a,b){return b.filter(function(b){return b.name===a})[0]}function k(b,c){for(var d=0;d<c.length;d++){var e=c[d];e.qInfo.qId=a.generateId(),b.qChildren.push({qChildren:[],qProperty:e})}}return{types:"sheet",extend:{edit:function(a){var b=this;return b.getProperties().then(function(c){return a(c),b.setProperties(c)})},getObject:function(a,b){return this.getLayout().then(function(c){return e(c,a,b)})},moveObject:function(a,c){return this.edit(function(d){var g=e(d,a);if(c.split&&!(c=i(d,c.pos,c.split)))return b.reject();f(g,c)})},swapObjects:function(a,b){return this.edit(function(c){var d=e(c,a),g=e(c,b,!0);f(d,b),g&&f(g,a)})},addObject:function(d){var e,f=this,h=d.template,j=d.cell.pos,l=c.getType(h),m=d.init,n=d.children||[];return e=m.qExtendsId?b.resolve(a.extend({qInfo:{qType:h}},m)):l.getInitialProperties(m),b.all({initProps:e,props:f.getFullPropertyTree()}).then(function(c){var d=c.initProps,e=c.props;if(j.split&&!(j=i(e.qProperty,j.pos,j.split)))return b.reject();d.qInfo.qId=a.generateId();var h=g(e.qProperty,j,d.qInfo.qId,d.qInfo.qType);if(h){for(var l=0;l<e.qChildren.length;l++)if(e.qChildren[l].qProperty.qInfo.qId===h){e.qChildren[l].qProperty=d,e.qChildren[l].qChildren=[],k(e.qChildren[l],n);break}}else{var m=e.qChildren.push({qChildren:[],qProperty:d});k(e.qChildren[m-1],n)}return f.setFullPropertyTree(e)})},getObjectById:function(a){var b,c,d=this.layout.cells;for(b=0;b<d.length;++b)if(c=d[b],a===c.name)return c;return null},removeObject:function(b){var c=this;return c.getProperties().then(function(e){e=a.extend(!0,{},e);var f=d(e,b),g=e.cells[f].name;if(f===-1)throw new Error("invalid pos");return e.cells.splice(f,1),c.destroyChild(g,e)})},setCloneChildrenInfos:function(a){var c=this;return b.all([c.getChildInfos(),a.getChildInfos(),a.getProperties()]).then(function(b){var c=b[0],d=b[1],e=b[2];return c.forEach(function(a,b){var c=j(a.qId,e.cells);c&&(c.name=d[b].qId)}),a.setProperties(e).then(function(){return a})})},clone:function(){var a=this.app,b=this;return a.cloneObject(this.id).then(function(b){return a.getObject(b)}).then(function(a){return b.setCloneChildrenInfos(a)})},draft:function(){var a=this.app,b=this
;return a.createDraft(this.id).then(function(c){return a.getObject(c).then(function(a){return b.setCloneChildrenInfos(a)})})}},init:function(){}}}),define("core.models/mixins/snapshot-list",[],function(){"use strict";var a={qInfo:{qId:"SnapshotList",qType:"SnapshotList"},qBookmarkListDef:{qType:"snapshot",qData:{title:"/title",libraryTitle:"/qMetaDef/title",description:"/qMetaDef/description",sourceObjectId:"/sourceObjectId",visualizationType:"/visualizationType",timestamp:"/timestamp",snapshotData:"/snapshotData",isClone:"/isClone"}}};return{types:"Doc",extend:{getSnapshotListObject:function(){return this.getListObject(a)}}}}),define("core.models/rpc-states",[],function(){return{VALID:1,INVALID:2,VALIDATING:3,ABORTED:4,CLOSED:5,CLOSING:6,CANCELLED:7}}),define("core.models/mixins/state",["core.utils/notification","core.utils/json-patch","core.models/rpc-states","autogenerated/qix/engine-enums"],function(a,b,c,d){"use strict";var e=d.NxLocalizedErrorCode;return{types:["Doc","GenericObject","GenericDimension","GenericMeasure","GenericBookmark","GenericVariable"],extend:{setState:function(a){var b=this.state;this.state=a,b!==this.state&&(a===c.INVALID?this.Invalidated.emit():a===c.VALID?this.Validated.emit():a===c.ABORTED?this.Aborted.emit():a===c.VALIDATING?this.Validating.emit():a===c.CLOSED?this.Closed.emit():a===c.CLOSING?this.Closing.emit():a===c.CANCELLED&&this.Cancelled.emit())},markAsInvalid:function(){this.state=-99,this.setState(c.INVALID)},markAsCancelled:function(){this.setState(c.CANCELLED)}},override:{getLayout:function(a){return this.isValid&&this.layout?this.Promise.resolve(this.layout):(this.setState(c.VALIDATING),a().then(function(a){return this.layout=this.layout||a,b.updateObject(this.layout,a),this.setState(c.VALID),this.layout}.bind(this)).catch(function(a){return a.code!==e.LOCERR_GENERIC_ABORTED||this.isCancelled||(this.setState(c.INVALID),a.isHandled=!0),this.Promise.reject(a)}.bind(this)))},getProperties:function(a){return a().then(function(a){return this.properties=this.properties||a,b.updateObject(this.properties,a),this.properties}.bind(this))}},init:function(b){var d=b.api;d.Promise=b.Promise,a.mixin(d),d.notification("Validated"),d.notification("Invalidated"),d.notification("Aborted"),d.notification("Validating"),d.notification("Closed"),d.notification("Closing"),d.notification("Cancelled"),d.setState(c.INVALID),d.on("changed",function(){d.setState(c.INVALID)}),d.on("closed",function(){d.setState(c.CLOSED)}),Object.defineProperties(d,{isValid:{get:function(){return this.state===c.VALID}},isValidating:{get:function(){return this.state===c.VALIDATING}},isInvalid:{get:function(){return this.state===c.INVALID}},isAborted:{get:function(){return this.state===c.ABORTED}},isClosed:{get:function(){return this.state===c.CLOSED}},isClosing:{get:function(){return this.state===c.CLOSING}},isCancelled:{get:function(){return this.state===c.CANCELLED}}})}}}),define("core.models/mixins/story-list",[],function(){"use strict";var a={qInfo:{qId:"StoryList",qType:"StoryList"},qAppObjectListDef:{qType:"story",qData:{title:"/qMetaDef/title",description:"/qMetaDef/description",thumbnail:"/thumbnail",rank:"/rank"}}};return{types:"Doc",extend:{getStoryList:function(){return this.getListData(a)},getStoryListObject:function(){return this.getListObject(a)}}}}),define("core.models/mixins/all",["core.models/mixins/app-on-child","core.models/mixins/app-settings","core.models/mixins/bookmark-list","core.models/mixins/current-selections","core.models/mixins/dimension-list","core.models/mixins/doc","core.models/mixins/export","core.models/mixins/field-list-object","core.models/mixins/field-list","core.models/mixins/fields-on-the-fly-list","core.models/mixins/generic-object","core.models/mixins/layout-observable","core.models/mixins/master-object-list","core.models/mixins/measure-list","core.models/mixins/permissions","core.models/mixins/undo-info","core.models/mixins/variable-list","core.models/mixins/search-history-list","core.models/mixins/search-history","core.models/mixins/sheet-list","core.models/mixins/sheet","core.models/mixins/snapshot-list","core.models/mixins/state","core.models/mixins/story-list"],function(){"use strict";return Array.prototype.slice.call(arguments)}),define("core.models/communication",["qvangular","core.utils/authentication","core.utils/deferred","core.utils/websocket","general.controllers/error-handler-controller","enigma","autogenerated/qix/engine-api","autogenerated/qix/engine-enums","util","core.models/mixins/all"],function(a,b,c,d,e,f,g,h,i,j){"use strict";function k(a){b.parse(a)}function l(a){e.showDialog({message:"ProxyError."+a,refreshButton:!0})}function m(a,b){if("OnAuthenticationInformation"==a)return void k(b);s.indexOf(a)!==-1&&l(a)}function n(b){b.code!==h.LocalizedErrorCode.LOCERR_GENERIC_ABORTED&&a.getService("$timeout")(function(){b.isHandled||e.showDialog(b)},1e3)}function o(a){return void 0===a&&(a={}),"string"!=typeof a.host&&(a.host=i.hostname),"string"!=typeof a.port&&(a.port=i.port||void 0),"string"!=typeof a.prefix&&(a.prefix=i.basePath),"boolean"!=typeof a.isSecure?a.unsecure=!i.isSecure:a.unsecure=!a.isSecure,"string"!=typeof a.reloadURI&&(a.reloadURI=i.reloadURI),a}function p(a,b){return b.code===g.enums.LocalizedErrorCode.LOCERR_HC_MODAL_OBJECT_ERROR?(b.isHandled=!0,this.app.abortModalSelection().then(function(){return this.send(a)}.bind(this))):c.reject(b)}function q(b,c,h,i){return f.getService("qix",{Promise:a.getService("$q"),schema:g,session:c,createSocket:function(a){return new d(a)},appId:b,noData:i,mixins:j,listeners:{"session-created":h,"qix-error":n,"notification:*":m},responseInterceptors:[{onRejected:p}]}).catch(function(a){throw(!a||a.srcElement instanceof d)&&(a={method:"OnEngineWebsocketFailed",code:16}),e.showDialog(a),a})}function r(a,b,c){return a=a||i.getParameterByName("app")||"?transient=",b=o(b),q(a,b,c,"true"===i.getParameterByName("noData"))}var s=["OnLicenseAccessDenied","OnLicenseAccessDeniedPendingUserSync","OnNoAppFound","OnEngineWebsocketFailed","OnNoEngineAvailable","OnSessionTimedOut","OnSessionClosed","OnNoDataPrepServiceAvailable","OnDataPrepServiceWebsocketFailed"];return{get:function(a,b,c){return b=o(b),a?this.getApp(a,b,c):this.getGlobal(b,c)},getApp:function(a,b,c){return r(a,b,c).then(function(a){return a.app.global=a.global,a.app})},getAppGlobal:function(a,b,c){return r(a,b,c).then(function(a){return a.global})},getAppAndGlobal:function(a,b,c){return r(a,b,c)},getGlobal:function(a,b){return a=o(a),q(void 0,a,b).then(function(a){return a.global})}}}),define("core.models/rpc-session",["core.utils/websocket","core.utils/notification","core.utils/deferred","core.models/communication","autogenerated/qix/engine-enums"],function(a,b,c,d,e){"use strict";function f(a,b,c,d){a.Send.emit(c),c.outKey=-1;var e=b.send(c);return a.dfdCache[c.id]=d,a.reqCache[c.id]=c,d.id=c.id,d.promise.requestId=e.requestId,d.promise}function g(a){var c=this;b.mixin(c),c.notification("Open"),c.notification("Close"),c.notification("Send"),c.notification("Data"),c.notification("Error"),c.notification("ClosedHandles"),c.notification("ChangedHandles"),c.notification("Notification"),c.notification("Warning"),c.changeHandlers={},c.cacheName=a.cacheName,c.dfdCache={},c.reqCache={},c.modelCache={},c.options=a,c.socket={url:""}}function h(a,b,c,d){c.connect().then(function(){a[b](d)})}function i(a,b){a.__enigmaSession||(b.rpc.on("closed",function(c){h(a,"onClose",b,c)}),b.rpc.on("error-socket",function(c){h(a,"onError",b,c)}),b.rpc.on("message",function(c){h(a,"onData",b,c)}),b.rpc.on("notification",function(c){h(a,"onData",b,c)}))}var j=e.NxLocalizedErrorCode,k=["GetObject","GetLayout","GetAppLayout","GetProperties","GetAppProperties","GetEffectiveProperties","GetFullPropertyTree","GetDimension","GetMeasure","GetVariableById","GetVariableByName","GetBookmark"];g.prototype={open:function(){return this.enigmaPromise},onError:function(a){var b=this;Object.keys(b.dfdCache).forEach(function(c){a.error={err:a,isHandled:!0},b.dfdCache[c].reject(a)}),b.Error.emit(a)},_cleanup:function(){var a=this;if(a.Close){a.Close.emit();for(var c in a.modelCache)a.modelCache[c].then(function(a){a.close(!0)});b.release(a)}},onClose:function(){var a=this;a._isClosed||(delete g.__cache[a.cacheName],g.useTimeoutOnClose?setTimeout(a._cleanup.bind(a),1e3):a._cleanup(),a._isClosed=!0)},onData:function(a){var b=this,c=b.dfdCache[a.id];a.change&&b.handleChanged(a),a.close&&b.handleClosed(a),g.debounceApply(function(){if(a.handle&&!b.changeHandlers[a.handle]&&c)c.reject("No model mapped to handle");else if(a.result)b.Data.emit(a),a.warnings&&b.Warning.emit(a),c&&c.resolve(a);else if(a.params)b.Notification.emit(a),c&&c.resolve(a);else if(a.suspend)b.rpc({method:"Resume",params:[],handle:a.suspend[0]}),c&&c.resolve(a);else if(a.error){var d=b.reqCache[a.id];a.error.code===j.LOCERR_GENERIC_ABORTED&&k.indexOf(d.method)>-1?f(b,b.__enigmaSession,d,c):(c&&c.reject(a),b.Error.emit(a))}delete b.dfdCache[a.id],delete b.reqCache[a.id]})},handleChanged:function(a){var b=this;a.change.forEach(function(a){var c=b.changeHandlers[a];c&&c.forEach(function(a){a()})}),b.ChangedHandles.emit(a.change)},handleClosed:function(a){var b=this;Object.keys(b.modelCache).forEach(function(c){b.modelCache[c].then(function(b){a.close.indexOf(b.handle)>-1&&b.close(!0)})}),b.ClosedHandles.emit(a.close)},close:function(){var a=this;a.enigmaPromise.then(function(){a.__enigmaSession.close()})},rpc:function(a,b){var d=this;return b||(b=new c),d.__enigmaSession?f(d,d.__enigmaSession,a,b):d.enigmaPromise.then(function(){return f(d,d.__enigmaSession,a,b)})},onChange:function(a,b){this.changeHandlers[a]||(this.changeHandlers[a]=[]),this.changeHandlers[a].push(b)},getRequest:function(a){return this.reqCache[a]||null}},g.useTimeoutOnClose=!0,g.__cache={},b.create(g,"NewSessionCreated");var l=g.NewSessionCreated.bind,m=!0,n=null;return g.NewSessionCreated.bind=function(){l.apply(this,arguments),m=!1,n&&!m&&g.NewSessionCreated.emit(n)},g.createSocket=function(b){return new a(b)},g.createInput=function(a,b){return b=b||{},b.appName=a,b.cacheName=g.buildUrl(b),b},g.debounceApply=function(a){a()},g.get=function(a,b){var c=g.createInput(a,b),e=g.getIfCached(a,b);return e||(e=g.__cache[c.cacheName]=new g(c),g.NewSessionCreated.emit(e),n=e,a&&"?transient="!==a&&!b.sessionApp?e.enigmaPromise=d.get(a,b,i.bind(null,e)).then(function(a){e.__enigmaSession=a.session||a.app.session}):("?transient="===a?b.route="app/"+encodeURIComponent(a):b.sessionApp&&b.sessionApp.value&&b.sessionApp.appId&&(b.route="app/"+encodeURIComponent(b.sessionApp.appId)),e.enigmaPromise=d.getGlobal(b,i.bind(null,e)).then(function(a){e.__enigmaSession=a.session}))),e},g.getIfCached=function(a,b){var c=g.createInput(a,b);return g.__cache[c.cacheName]},g.buildUrl=function(a){var b="",c=a.host,d="string"==typeof a.port?a.port:a.isSecure?443:4848;return b+=a.isSecure?"wss":"ws",b+="://",b+=c||"localhost",a.port&&(b+=":",b+=d),b+=a.prefix||"/",a.subpath&&(b+=a.subpath+"/"),a.route?b+=a.route:b+="app/"+encodeURIComponent(a.appName),a.identity&&(b+="/identity/"+encodeURIComponent(a.identity)),b+="?reloadUri="+(a.reloadURI||"")},g}),define("autogenerated/qix/engine-api-def",["./engine-api"],function(a){return a.structs}),define("core.models/engine",["autogenerated/qix/engine-api-def","core.models/communication","util","core.utils/deferred"],function(a,b,c,d){"use strict";function e(a,b){if("object"==typeof b&&(b=c.extend(!0,Array.isArray(b)?[]:{},b)),a&&"qResult"!==a){var d={};return d[a]=b,d}return b}function f(a,b){var c=Object.keys(a),d=b.In.map(function(a){return a.Name});return 0!==c.filter(function(a,b){return a===d[b]}).length}function g(a,b){var c=[];if(Array.isArray(b)&&1===b.length&&"object"==typeof b[0]&&f(b[0],a)&&(b=b[0]),Array.isArray(b)||"object"!=typeof b)Array.isArray(b)?c=b:c.push(b);else for(var d=0;d<a.In.length;++d)b&&void 0!==b[a.In[d].Name]?c.push(b[a.In[d].Name]):a.In[d].Optional&&void 0!==a.In[d].DefaultValue&&c.push(a.In[d].DefaultValue);return c}function h(b){var c={};return Object.keys(a.Doc).forEach(function(d){var f=a.Doc[d],h=1===f.Out.length?f.Out[0].Name:null;d=d.substring(0,1).toLowerCase()+d.substring(1),c[d]=function(){var a=Array.prototype.slice.call(arguments);a=g(f,a);var c=b[d].apply(b,a).then(e.bind(null,h));return c.__protocolRequestId=c.requestId,c}}),c.global=b.global,c}var i={global:void 0,currentApp:void 0};return function(){function c(){return b.getAppGlobal().then(function(a){return d=a,a})}var d;i.global={},Object.keys(a.Global).forEach(function(b){var f=a.Global[b],h=1===f.Out.length?f.Out[0].Name:null;b=b.substring(0,1).toLowerCase()+b.substring(1),i.global[b]=function(){var a=Array.prototype.slice.call(arguments);if(a=g(f,a),i.currentApp&&(d=i.currentApp.global),d){var j=d[b].apply(d,a).then(e.bind(null,h));return j.__protocolRequestId=j.requestId,j}return c().then(function(c){return c[b].apply(c,a)}).then(e.bind(null,h))}}),i.global.getInteract=function(a){var b={method:"GetInteract",handle:-1,params:[a],delta:!1};return d?d.session.rpc.send(b).then(function(a){return a.result}):c().then(function(a){return a.session.rpc.send(b).then(function(a){return a.result})})}}(),i.getCurrentApp=function(){return i.currentApp},i.openApp=function(a,c){return b.getApp(a,c).then(function(b){var d=h(b);return d.name=a,c.transientApp||(i.currentApp=d),{app:b,engineApp:d}})},i.createSessionApp=function(a,c){return b.getGlobal(c).then(function(b){function c(b){var c=h(b);return c.name=a,i.currentApp=c,{app:b,engineApp:c}}return a&&"?transient="!==a?b.createSessionAppFromApp(a).then(function(a){return c(a)}).catch(function(a){return b.getActiveDoc().then(function(a){return c(a)}).catch(function(){return d.reject(a)})}):b.createSessionApp().then(function(a){return c(a)})})},"undefined"!=typeof window&&(window.engineModuleGlobal=i),i}),define("core.models/app",["core.models/rpc-base","core.models/rpc-session","core.models/engine","core.utils/deferred","util","qvangular","general.controllers/error-handler-controller","autogenerated/qix/engine-enums"],function(a,b,c,d,e,f,g,h){"use strict";function i(){f.getService("$timeout")(function(){g.showDialog({code:h.NxLocalizedErrorCode.LOCERR_GENERIC_CONNECTION_LOST})},1e3)}var j,k,l,m={};return j=a.extend("App",{init:function(a,c,e,f){var g=this;e&&k||(k=g);var h=b.get(a,c);if(g.onError=f,h.Close.bind(g.onError||i),h.modelCache[a]=d.resolve(g),g.waitForOpen=new d,g.rpcOptions=c,g._super({id:a,session:h,checkCreate:!0}),g.session.connectedAppHandle)g.handle=g.session.connectedAppHandle,g.bindToRPC(),g.waitForOpen.resolve(g);else try{g.open().then(function(){g.waitForOpen.resolve(g)},function(a){g.waitForOpen.reject({error:a})})}catch(a){g.waitForOpen.reject({isHandled:!1,error:a})}g.session.currentApp=g},open:function(){function a(a){b.session.connectedAppHandle=b.handle=a.app.handle,b.enigmaModel=a.app,b.engineApp=a.engineApp,b.bindToRPC()}var b=this;return b.session.Error.bind(function(a){a.error&&!a.error.isHandled&&window.console.log("Error from Engine:",a)}),b.rpcOptions||(b.rpcOptions={}),b.rpcOptions.sessionApp&&b.rpcOptions.sessionApp.value?c.createSessionApp(b.rpcOptions.sessionApp.appId,b.rpcOptions).then(a):c.openApp(b.id,b.rpcOptions).then(a)},close:function(a){return a?this.onError||g.showDialog({message:"ErrorDialog.AppClosed"}):this.session.Close.unbind(this.onError||i),delete m[this.cacheId],this.session.close(),k===this&&(k=void 0,l=!0),this._super(a)},createSessionObject:function(a){return this.rpc("CreateSessionObject","qReturn",[a])},createSessionVariable:function(a){return this.rpc("CreateSessionVariable","qReturn",[a])},doSave:function(){return this.rpc("DoSave",null)},getLayout:function(){return this._super("GetAppLayout")},getProperties:function(){return this._super("GetAppProperties")},setProperties:function(a){return this._super(a,"SetAppProperties")},checkExpression:function(a,b){var c=[a];return b&&c.push(b),this.rpc("CheckExpression",null,c)},checkNumberOrExpression:function(a){return this.rpc("CheckNumberOrExpression",null,[a])},evaluateExpression:function(a){return this.rpc("Evaluate","qReturn",[a])},getConfiguration:function(){return this.session.rpc({method:"GetConfiguration",handle:-1,params:[]}).then(function(a){return a.result.qConfig})},getVersion:function(){return this.session.rpc({method:"QvVersion",handle:-1,params:[]}).then(function(a){return a.result.qReturn})},getListOfFunctions:function(){return this.session.rpc({method:"GetFunctions",handle:-1,params:[]}).then(function(a){return a.result.qFunctions})},getLocaleInfo:function(){return this.rpc("GetLocaleInfo","qReturn")},getExpressions:function(){return this.rpc("GetExpressions","qExpressions")},getStreams:function(){var a=this;return a.streamsList?d.resolve(a.streamsList):this.session.rpc({method:"GetStreamList",handle:-1,params:[]}).then(function(b){return a.streamsList=b.result.qStreamList,a.streamsList})},getPublishableStreams:function(){var a=this.getLayout(),b=this.getStreams(),c=new d;return d.all({layout:a,streams:b}).then(function(a){var b=a.streams.filter(function(b){return a.layout.stream?b.qId===a.layout.stream.id&&b.privileges.indexOf("publish")!==-1:b.privileges.indexOf("publish")!==-1});c.resolve(b)}),c.promise},getMatchingFields:function(a){return this.rpc("GetMatchingFields",null,[a])},getContentLibraries:function(){return this.rpc("GetContentLibraries").then(function(a){return a.qList.qItems})},getLibraryContent:function(a){return this.rpc("GetLibraryContent",null,[a]).then(function(a){return a.qList.qItems})},getMediaList:function(){return this.rpc("GetMediaList").then(function(a){return a.qList.qItems})},findMatchingFields:function(a,b){return this.rpc("FindMatchingFields",null,[a,b])},abortModal:function(a){return this.enigmaModel.switchModalSelection(a)},switchModal:function(a,b,c){return this.enigmaModel.switchModalSelection(a&&a.enigmaModel,b,c),d.resolve()},setModal:function(a){this.enigmaModel.setModalSelection(a&&a.enigmaModel)},isModal:function(){return this.enigmaModel.isInModalSelection()},publish:function(a){return this.rpc("Publish",null,[a])}}),Object.defineProperty(j,"current",{get:function(){return k}}),j.makeCacheId=function(a,b){var c=a.toLowerCase();return b&&(c+=b.host?"/"+b.host:"/",c+=b.identity?"/"+b.identity:"/",c+=b.openWithoutData?"/openWithoutData":"/",c+=b.port?"/"+b.port:"/",c+=b.prefix?"/"+b.prefix:"/",c+=b.subpath?"/"+b.subpath:"/"),c},j.get=function(a,b,c,e){return!arguments.length&&l?d.reject(new Error("The current app has been closed")):j.getSync(a,b,c,e).waitForOpen.promise},j.getSync=function(a,b,c,d){a=a||e.getParameterByName("app")||"?transient=",void 0===b&&(b={}),"string"!=typeof b.host&&(b.host=e.hostname),"string"!=typeof b.port&&(b.port=e.port),"string"!=typeof b.prefix&&(b.prefix=e.basePath),"boolean"!=typeof b.isSecure&&(b.isSecure=e.isSecure),"string"!=typeof b.reloadURI&&(b.reloadURI=e.reloadURI);var f=j.makeCacheId(a,b),g=m[f]=m[f]||new j(a,b,c,d);return g.cacheId=f,g},j.create=function(a,b){return b.rpc({method:"CreateApp",handle:-1,params:[a]}).then(function(a){return a.result})},j.remove=function(a,b){return b.rpc({method:"DeleteApp",handle:-1,params:[a]}).then(function(a){return a.result})},j.getList=function(a){return a.rpc({method:"GetDocList",handle:-1,params:[]}).then(function(a){return a.result.qDocList})},j}),define("core.models/base-object",["core.models/rpc-base","core.models/app","core.utils/deferred","core.utils/permissions","util"],function(a,b,c,d,e){"use strict";function f(c,e){var f,g,h=c.name+"List",i=Object.keys(e).filter(function(a){if(a.indexOf("ListDef")>-1)return a})[0].replace(/Def$/g,"");if(!i)throw new Error("BaseObject: Tried to create a model without a ListDef in properties");g=a.extend(h,{strippedLayout:{},getLayout:function(){var a=this;return this._super().then(function(b){return a.strippedLayout=b[i].qItems,a.strippedLayout.forEach(function(a){"object"==typeof a&&d.mapToLayout(a)}),a.strippedLayout})}}),e.qInfo={qId:h,qType:h},c.getList=function(a,c){return a=a||b.current,f&&!c?f:f=a.createSessionObject(e).then(function(b){return new g({id:h,handle:b.qHandle,session:a.session})})},c.getListLayout=function(a,b){return this.getList(a,b).then(function(a){return a.getLayout()})}}var g;return g=a.extend("BaseObject",{getInfo:function(){return this.rpc("GetInfo","qInfo")},clone:function(a,c){var d=this;return c=c||b.current,c.rpc(a||"CloneObject","qCloneId",[d.id]).then(function(a){return d.constructor.get(a)})}}),g.get=function(a,c){var d=function(b){function c(){return b.enigmaModel.getObject(a)}return this.getModel(a,b.session,c)}.bind(this);return c?d(c):b.current.waitForOpen.promise.then(function(a){return d(a)})},g.create=function(a,d,f){var g=this;return a.qInfo=a.qInfo||{},a.qInfo.qId=a.qInfo.qId||e.generateId(),a.qInfo.qType=a.qInfo.qType||this.name.toLowerCase(),d=d||"CreateObject",d=d.substring(0,1).toLowerCase()+d.substring(1),f=f||b.current,f.enigmaModel[d](a).then(function(a){return g.getModel(a.id,f.session,function(){return c.resolve(a)})})},g.remove=function(a,c,d,e){var f=[a];return e&&f.push(e),d=d||b.current,c=c||"DestroyObject",d.rpc(c,"qReturn",f)},g.States=a.States,g.extend=function(b,c,d){var e=a.extend.call(this,b,c);return e.extend=g.extend,e.get=g.get,e.create=g.create,e.remove=g.remove,e.States=g.States,d&&d.listProperties&&f(e,d.listProperties),e},g}),define("core.models/generic-object",["core.models/base-object","core.utils/deferred","util"],function(a,b,c){"use strict";var d;return d=a.extend("GenericObject",{createChild:function(a,e,f){var g=this.session,h=[a];return f=f||d,e&&h.push(e),a.qInfo.qId=a.qInfo.qId||c.generateId(),this.enigmaModel.createChild(a).then(function(a){return f.getModel(a.id,g,function(){return b.resolve(a)})})},removeChild:function(a,b){return d.remove(a,"DestroyChild",this,b)},setChildArrayOrder:function(a){var b=[a];return this.rpc("SetChildArrayOrder",null,b)},removeAllChildren:function(a){var b=[];return a&&b.push(a),this.rpc("DestroyAllChildren",null,b)},copyFrom:function(a){return this.rpc("CopyFrom",null,[a])},applyPatches:function(a,b){return this.rpc("ApplyPatches",null,[a,b])},clearSoftPatches:function(){return this.rpc("ClearSoftPatches")},getLinkedObjects:function(){return this.rpc("GetLinkedObjects","qItems",[])},exportData:function(a,b,c,d){a=a||"OOXML",b=b||"",c=c||"",d=d||"P";var e=[a,b,c,d];return this.rpc("ExportData",null,e,{raw:!0})},cancelRequest:function(a){var b=this,c=b.session.getRequest(a);return b.session.rpc({method:"CancelRequest",handle:-1,params:[a]}).then(function(){c&&"GetLayout"===c.method&&b.setState(d.States.CANCELLED)})},selectHyperCubeValues:function(a,b,c,d){return this.rpc("SelectHyperCubeValues",null,[a,b,c,d])},getHyperCubeData:function(a,b){return this.rpc("GetHyperCubeData",null,[a,b])}})}),define("client.models/app-generic-properties",["jquery","core.models/generic-object"],function(a,b){"use strict";var c;return c=b.extend("AppProps",{},{listProperties:{qAppObjectListDef:{qType:"appprops",qData:{sheetTitleBgColor:"/sheetTitleBgColor",sheetTitleGradientColor:"/sheetTitleGradientColor",sheetTitleColor:"/sheetTitleColor",sheetLogoThumbnail:"/sheetLogoThumbnail",sheetLogoPosition:"/sheetLogoPosition",rtl:"/rtl",theme:"/theme"}}}}),c.create=function(d,e){var f={sheetTitleBgColor:"",sheetTitleGradientColor:"",sheetTitleColor:"",sheetLogoThumbnail:{qStaticContentUrlDef:null},sheetLogoPosition:"",rtl:!1,theme:"sense"};return b.create.call(c,a.extend(!0,f,d),e)},c}),define("client.models/app-generic-props-wrapper",["client.models/app-generic-properties","core.utils/notification","core.utils/deferred","util"],function(a,b,c,d){"use strict";function e(b){k=b,a.get(k).then(function(a){a.Invalidated.bind(f)})}function f(){var a;i().then(function(b){a=b,j.UpdateObjProps.emit(a)})}function g(){return a.getList().then(function(b){return b.getLayout().then(function(b){return b&&b.length?e(b[0].qInfo.qId):m?a.create({}).then(function(a){return a.getProperties().then(function(a){return e(a.qInfo.qId)})}):(l=new c,l.resolve(),l.promise)})})}function h(b,c){return a.get(b).then(function(a){m&&a.getLayout(),a.getProperties().then(function(b){var e={};e=d.extend(!0,b,c),a.setProperties(e)})})}function i(){return k?a.get(k).then(function(a){return a.getLayout().then(function(a){return a})}):(l=new c,l.resolve({}),l.promise)}var j={},k=null,l=null,m=!1;return b.mixin(j),j.notification("UpdateObjProps"),j.setProperties=function(a){k?(m=!1,h(k,a)):(m=!0,g().then(function(){h(k,a)}))},j.getProperties=function(){return k?i():(m=!1,g().then(i))},j}),define("core.utils/feature-flags",["util"],function(a){var b={PUBLISH:!1,SMARTSEARCH_OBJECTS:!0,SMARTSEARCH_INDEX_CLOSE:!1,QDM_MULTITABLE:!0,TACC:!0,TABC:!1,CROSS_TABLE:!0,DM_GEOPOINT:!0,MD_CALCULATED_FIELD:!0,DPS_PROGRESS_POLLING:!0,COLORBY:!0,ENT_CONNECT:!1,CARDS:!1,REGIONAL_DATA:!1,DM_GEOINFO:!0,MAGIC2:!0,DM_BUBBLES_FIRST:!0,CONNECTOR_LOGO_PAGE:!0,DM_DLE_SYNC:!0,SEARCH_HISTORY:!1,DEVHUB_TRANSITION:!0,GENERIC_SELECT_FILTER_TABLE:!0,MONKEY:!1,DESKTOP_AUTHENTICATION:!1,ANYCOLOR:!0,THEMING:!1,THEMING_QMC:!1,DM_PERF:!0,MASTER_MEASURE_COLOR:!0,DIM_COLOR:!1,DIM_VALCOL:!1,BOXPLOT:!1,DISTPLOT:!1,DM_CALENDAR_FLAGS:!0,CUSTOM_COMPONENTS:!0};return(a.getParameterByName("feature")||"").split("+").forEach(function(a){a&&(b[a.toUpperCase()]=!0)}),b}),define("client.utils/theme/theme",["jquery","util","translator","core.utils/deferred","core.utils/notification","client.models/app-generic-props-wrapper","text!themes/old/sense/theme.json","require","core.utils/feature-flags"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(a,b){var c=document.createElement("link");return c.setAttribute("rel","stylesheet"),c.setAttribute("href",h.toUrl("themes/old/"+a+"/"+(b||"theme.css"))),document.head.appendChild(c),c}function k(a,c,d){try{a=JSON.parse(a)}catch(b){console.warn("Theme parsing error for theme: "+d+": "+b),a={}}b.extend(!0,u,o,a),c&&t.forEach(function(c){var d=b.getValue(a,c);void 0!==d&&b.setValue(u,c,d)}),r=[],a.customStyles&&a.customStyles.length&&a.customStyles.forEach(function(a){r.push({node:j(d,a.cssRef),cssClass:a.classRef}),l(a.classRef,!0)}),s=a}function l(b,c){a(".qv-client").toggleClass(b,c)}function m(){q.parentNode.removeChild(q),r.forEach(function(a){a.node.parentNode.removeChild(a.node),l(a.cssClass,!1)}),Object.keys(s).forEach(function(a){delete u[a]})}var n,o=JSON.parse(g),p=null,q=null,r=[],s={},t=["palette","colorSchemes.qualitativeScales","colorSchemes.ordinalScales"],u={};e.create(u,"ThemeChanged"),u.getAvailableThemes=function(){return d.resolve({default:[{value:"sense",label:c.get("Themes.Qlik.Classic")},{value:"card",label:c.get("Themes.Qlik.Standard")}]})},Object.defineProperty(u,"name",{iterable:!1,get:function(){return p||"sense"}}),u.getCurrentTheme=function(){return u.name},u.applyTheme=function(a){return!a||a.indexOf("/")>-1?d.resolve():a===p?d.resolve():(n=new d,h(["text!themes/old/"+a+"/theme.json"],function(b){p&&m(),q=j(a),k(b,!0,a),u.ThemeChanged.emit(),p=a,n.resolve()},function(b){console.warn("Failed to load theme: "+a+": "+b.message),n.resolve()}),n.promise)},u.saveTheme=function(){f.setProperties({theme:u.getCurrentTheme()})},Object.defineProperty(u,"currentPalette",{iterable:!1,get:function(){return this.extendedPalette||[]}}),Object.defineProperty(u,"scales",{iterable:!1,get:function(){return this.colorSchemes?this.colorSchemes.ordinalScales||[]:[]}}),Object.defineProperty(u,"dataPalettes",{iterable:!1,get:function(){return this.colorSchemes?this.colorSchemes.qualitativeScales||[]:[]}}),Object.defineProperty(u,"dataColors",{iterable:!1,get:function(){return this.colorSchemes||{}}}),Object.defineProperty(u,"deprecatedPalette",{iterable:!1,get:function(){return v}});var v=["#b0afae","#7b7a78","#545352","#4477aa","#7db8da","#b6d7ea","#46c646","#f93f17","#ffcf02","#276e27","#ffffff","#000000"];return u.resolveColor=function(a,b){return b=b||u.currentPalette,a&&void 0!==a.index?b[a.index]?b[a.index]:a.color?a.color:"none":v[a]?v[a]:a||"none"},u.mapIndex=function(a,b,c){c=c||u.currentPalette;var d=b?c:v;return a=(b?v:c).indexOf(d[a]),a!==-1?a:b?3:6},i.THEMING||(j("sense"),k(g)),u}),define("objects.views/charts/chart-style-service",["core.utils/class","client.utils/theme/theme","general.utils/responsive-state"],function(a,b,c){"use strict";function d(a,b){if("string"==typeof a&&"@"===a[0]){var c=a.substring(1);return b[c]?d(b[c],b):a}return a}function e(a,b,c,d,e){var g,h=b.split("."),i=a,j=e;for(void 0!==i[c]&&(j=i[c]),g=0;g<h.length;++g){if(void 0===i[h[g]])return j;i=i[h[g]],void 0!==i[c]&&(j=i[c])}return void 0!==i[c]&&(j=i[c]),["string","number","boolean","array"].contains(typeof j)?j:j?void 0!==j.default||void 0!==d?f(j,d):e:null}function f(a,b){var c,d,e=a,f=a.default;if(!b)return f;for(c=b.split("."),d=0;d<c.length;++d){if(void 0===e[c[d]])return f;e=e[c[d]],f=e}return f}function g(a){return a=a||{}}function h(a,b){return a=a.substring(0,a.length-2),(a*=b)+"px"}function i(a,b){return b?a+"."+b:a}var j,k;return j=a.extend("ChartStyleService",{init:function(){this._baseStyle=b,this._chartStyles=b,this._fontCache={},this._variables=g(b._variables);var a=this;b.ThemeChanged.bind(function(){a._variables=g(b._variables)})},getValue:function(a,b,c,f,g){return a=a||"",""===a||this._chartStyles[a]?(""!==a&&(a+="."),b&&(a+=b),d(e(this._chartStyles,a,c,f,g),this._variables)):g},getFont:function(a,b,c,d,f,g){if(a=a||"",g=g||1,""===a||this._chartStyles[a]){""!==a&&(a+="."),b&&(a+=b);var j=i(a,c);if(this._fontCache[j]&&1===g&&isNaN(f))return this._fontCache[j];var k=e(this._chartStyles,a,"lineHeight",c),l=e(this._chartStyles,a,"fontFamily",c),m=[e(this._chartStyles,a,"fontStyle",c)||"",e(this._chartStyles,a,"fontVariant",c)||"",e(this._chartStyles,a,"fontWeight",c)||"",e(this._chartStyles,a,"fontStretch",c)||"",f||0===f?f+"px":h(e(this._chartStyles,a,"fontSize",c)||"12px",g),k?"/"+k:"",l?"'"+l+"'":"'Qlikview Sans'"];return m=m.filter(function(a){return""!==a}),1===g?(this._fontCache[j]=m.join(" "),this._fontCache[j]):m.join(" ")}return d}}),k=new j,k.layoutMap={1:"spark",3:"xsmall",7:"small",15:"medium",31:"full",m:"mobile"},k.getLayoutKey=function(a){return c.isSmallDevice?this.layoutMap.m:this.layoutMap[a]},{getInstance:function(){return k}}}),define("text!assets/external/sense-themes-default/theme.json",[],function(){
return'{\n\t"_variables": {\n\t\t"@B20": "#333333",\n\t\t"@B35": "#595959",\n\t\t"@B45": "#737373",\n\t\t"@B50": "#808080",\n\t\t"@B60": "#999999",\n\t\t"@B80": "#cccccc",\n\t\t"@B90": "#e6e6e6",\n\t\t"@B98": "#fbfbfb",\n\t\t"@B100": "#ffffff",\n\t\t"@H1": "24px",\n\t\t"@H2": "18px",\n\t\t"@H3": "14px",\n\t\t"@H4": "13px",\n\t\t"@H5": "12px",\n\t\t"@H6": "10px"\n\t},\n\t"color": "@B20",\n\t"fontSize": "13px",\n\t"backgroundColor": "@B100",\n\t"object": {\n\t\t"line": {\n\t\t\t"highContrast": {\n\t\t\t\t"color": "@B60"\n\t\t\t},\n\t\t\t"major": {\n\t\t\t\t"color": "@B80"\n\t\t\t},\n\t\t\t"minor": {\n\t\t\t\t"color": "@B90"\n\t\t\t}\n\t\t},\n\t\t"title": {\n\t\t\t"main": {\n\t\t\t\t"color": "@B50",\n\t\t\t\t"fontSize": "15px"\n\t\t\t},\n\t\t\t"subTitle": {\n\t\t\t\t"color": "@B50",\n\t\t\t\t"fontSize": "12px"\n\t\t\t},\n\t\t\t"footer": {\n\t\t\t\t"color": "@B50",\n\t\t\t\t"fontSize": "12px",\n\t\t\t\t"backgroundColor": "@100"\n\t\t\t}\n\t\t},\n\t\t"label": {\n\t\t\t"name": {\n\t\t\t\t"color": "@B20",\n\t\t\t\t"fontSize": "13px"\n\t\t\t},\n\t\t\t"value": {\n\t\t\t\t"color": "@B20",\n\t\t\t\t"fontSize": "13px"\n\t\t\t}\n\t\t},\n\t\t"axis": {\n\t\t\t"title": {\n\t\t\t\t"fontSize": "12px",\n\t\t\t\t"color": "@B35"\n\t\t\t},\n\t\t\t"label": {\n\t\t\t\t"name": {\n\t\t\t\t\t"color": "@B35",\n\t\t\t\t\t"fontSize": "12px"\n\t\t\t\t}\n\t\t\t},\n\t\t\t"line": {\n\t\t\t\t"major": {\n\t\t\t\t\t"color": "@B80"\n\t\t\t\t},\n\t\t\t\t"minor": {\n\t\t\t\t\t"color": "@B90"\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t"grid": {\n\t\t\t"line": {\n\t\t\t\t"highContrast": {\n\t\t\t\t\t"color": "@B60"\n\t\t\t\t},\n\t\t\t\t"major": {\n\t\t\t\t\t"color": "@B80"\n\t\t\t\t},\n\t\t\t\t"minor": {\n\t\t\t\t\t"color": "@B90"\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t"referenceLine": {\n\t\t\t"label": {\n\t\t\t\t"name": {\n\t\t\t\t\t"color": "@B20",\n\t\t\t\t\t"fontSize": ".inherit()"\n\t\t\t\t}\n\t\t\t},\n\t\t\t"outOfBounds": {\n\t\t\t\t"color": "@B90",\n\t\t\t\t"backgroundColor": "@B45",\n\t\t\t\t"fontSize": "@H6"\n\t\t\t}\n\t\t},\n\t\t"legend": {\n\t\t\t"title": {\n\t\t\t\t"fontSize": "15px",\n\t\t\t\t"color": "@B20"\n\t\t\t},\n\t\t\t"label": {\n\t\t\t\t"fontSize": "13px",\n\t\t\t\t"color": "@B35"\n\t\t\t}\n\t\t},\n\t\t"barChart": {\n\t\t\t"outOfRange": {\n\t\t\t\t"color": "@B60"\n\t\t\t},\n\t\t\t"label": {\n\t\t\t\t"value": {\n\t\t\t\t\t"color": "@B35",\n\t\t\t\t\t"fontSize": "11px"\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t"gauge": {\n\t\t\t"label": {\n\t\t\t\t"value": {\n\t\t\t\t\t"color": "@B20",\n\t\t\t\t\t"fontSize": "42px"\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t"treemap": {\n\t\t\t"branch": {\n\t\t\t\t"backgroundColor": ".shift(5)",\n\t\t\t\t"label": {\n\t\t\t\t\t"color": ".inherit()",\n\t\t\t\t\t"fontSize": "14px"\n\t\t\t\t}\n\t\t\t},\n\t\t\t"leaf": {\n\t\t\t\t"label": {\n\t\t\t\t\t"fontSize": "12px"\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t"scatterPlot": {\n\t\t\t"label": {\n\t\t\t\t"value": {\n\t\t\t\t\t"color": "@B35",\n\t\t\t\t\t"fontSize": "12px"\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t"lineChart": {\n\t\t\t"outOfRange": {\n\t\t\t\t"color": "@B60"\n\t\t\t},\n\t\t\t"label": {\n\t\t\t\t"value": {\n\t\t\t\t\t"color": "@B35",\n\t\t\t\t\t"fontSize": "12px"\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t"pieChart": {\n\t\t\t"axis": {\n\t\t\t\t"title": {\n\t\t\t\t\t"fontSize": "12px"\n\t\t\t\t}\n\t\t\t},\n\t\t\t"label": {\n\t\t\t\t"name": {\n\t\t\t\t\t"color": "@B20",\n\t\t\t\t\t"fontSize": "14px"\n\t\t\t\t},\n\t\t\t\t"value": {\n\t\t\t\t\t"fontSize": "12px"\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t"straightTable" : {\n\t\t\t"header" : {\n\t\t\t\t"fontSize" : "@H4",\n\t\t\t\t"color": "@B35"\n\t\t\t},\n\t\t\t"content": {\n\t\t\t\t"fontSize": "@H4",\n\t\t\t\t"color": "@B35"\n\t\t\t}\n\t\t},\n\t\t"listBox": {\n\t\t\t"title": {\n\t\t\t\t"main": {\n\t\t\t\t\t"color": "@B35",\n\t\t\t\t\t"fontSize": "13px"\n\t\t\t\t}\n\t\t\t},\n\t\t\t"content": {\n\t\t\t\t"color": "@B35",\n\t\t\t\t"fontSize": "12px"\n\t\t\t}\n\t\t},\n\t\t"boxPlot": {\n\t\t\t"box": {\n\t\t\t\t"whisker": {\n\t\t\t\t\t"stroke": "@B35"\n\t\t\t\t},\n\t\t\t\t"line": {\n\t\t\t\t\t"stroke": "@B35"\n\t\t\t\t},\n\t\t\t\t"box": {\n\t\t\t\t\t"fill": "@B90",\n\t\t\t\t\t"stroke": "@B35"\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t"distributionPlot": {\n\t\t\t"box": {\n\t\t\t\t"fill": "@B90",\n\t\t\t\t"stroke": "none"\n\t\t\t}\n\t\t}\n\t},\n\t"dataColors": {\n\t\t"primaryColor": "#4477aa",\n\t\t"othersColor": "#a5a5a5",\n\t\t"errorColor": "#ff4444",\n\t\t"nullColor": "#d2d2d2",\n\t\t"selectionColor": "#52cc52"\n\t},\n\t"palettes": {\n\t\t"data": [\n\t\t\t{\n\t\t\t\t"name": "12 Colors",\n\t\t\t\t"translation": "properties.colorNumberOfColors.12",\n\t\t\t\t"propertyValue": "12",\n\t\t\t\t"type": "pyramid",\n\t\t\t\t"scale": [\n\t\t\t\t\t[ "#4477aa" ],\n\t\t\t\t\t[ "#4477aa", "#cc6677" ],\n\t\t\t\t\t[ "#4477aa", "#ddcc77", "#cc6677" ],\n\t\t\t\t\t[ "#4477aa", "#117733", "#ddcc77", "#cc6677" ],\n\t\t\t\t\t[ "#332288", "#88ccee", "#117733", "#ddcc77", "#cc6677" ],\n\t\t\t\t\t[ "#332288", "#88ccee", "#117733", "#ddcc77", "#cc6677", "#aa4499" ],\n\t\t\t\t\t[ "#332288", "#44aa99", "#88ccee", "#117733", "#ddcc77", "#cc6677", "#aa4499" ],\n\t\t\t\t\t[ "#332288", "#44aa99", "#88ccee", "#117733", "#999933", "#ddcc77", "#cc6677", "#aa4499" ],\n\t\t\t\t\t[ "#332288", "#44aa99", "#88ccee", "#117733", "#999933", "#ddcc77", "#cc6677", "#882255", "#aa4499" ],\n\t\t\t\t\t[ "#332288", "#44aa99", "#88ccee", "#117733", "#999933", "#ddcc77", "#661100", "#cc6677", "#882255", "#aa4499" ],\n\t\t\t\t\t[ "#332288", "#6699cc", "#44aa99", "#88ccee", "#117733", "#999933", "#ddcc77", "#661100", "#cc6677", "#882255", "#aa4499" ],\n\t\t\t\t\t[ "#332288", "#6699cc", "#88ccee", "#44aa99", "#117733", "#999933", "#ddcc77", "#661100", "#cc6677", "#aa4466", "#882255", "#aa4499" ]\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\t"name": "100 Colors",\n\t\t\t\t"translation": "properties.colorNumberOfColors.100",\n\t\t\t\t"propertyValue": "100",\n\t\t\t\t"type": "row",\n\t\t\t\t"scale": [\n\t\t\t\t\t"#99c867",\n\t\t\t\t\t"#e43cd0",\n\t\t\t\t\t"#e2402a",\n\t\t\t\t\t"#66a8db",\n\t\t\t\t\t"#3f1a20",\n\t\t\t\t\t"#e5aa87",\n\t\t\t\t\t"#3c6b59",\n\t\t\t\t\t"#aa2a6b",\n\t\t\t\t\t"#e9b02e",\n\t\t\t\t\t"#7864dd",\n\t\t\t\t\t"#65e93c",\n\t\t\t\t\t"#5ce4ba",\n\t\t\t\t\t"#d0e0da",\n\t\t\t\t\t"#d796dd",\n\t\t\t\t\t"#64487b",\n\t\t\t\t\t"#e4e72b",\n\t\t\t\t\t"#6f7330",\n\t\t\t\t\t"#932834",\n\t\t\t\t\t"#ae6c7d",\n\t\t\t\t\t"#986717",\n\t\t\t\t\t"#e3cb70",\n\t\t\t\t\t"#408c1d",\n\t\t\t\t\t"#dd325f",\n\t\t\t\t\t"#533d1c",\n\t\t\t\t\t"#2a3c54",\n\t\t\t\t\t"#db7127",\n\t\t\t\t\t"#72e3e2",\n\t\t\t\t\t"#e2c1da",\n\t\t\t\t\t"#d47555",\n\t\t\t\t\t"#7d7f81",\n\t\t\t\t\t"#54ae9b",\n\t\t\t\t\t"#e9daa6",\n\t\t\t\t\t"#3a8855",\n\t\t\t\t\t"#5be66e",\n\t\t\t\t\t"#ab39a4",\n\t\t\t\t\t"#a6e332",\n\t\t\t\t\t"#6c469d",\n\t\t\t\t\t"#e39e51",\n\t\t\t\t\t"#4f1c42",\n\t\t\t\t\t"#273c1c",\n\t\t\t\t\t"#aa972e",\n\t\t\t\t\t"#8bb32a",\n\t\t\t\t\t"#bdeca5",\n\t\t\t\t\t"#63ec9b",\n\t\t\t\t\t"#9c3519",\n\t\t\t\t\t"#aaa484",\n\t\t\t\t\t"#72256d",\n\t\t\t\t\t"#4d749f",\n\t\t\t\t\t"#9884df",\n\t\t\t\t\t"#e590b8",\n\t\t\t\t\t"#44b62b",\n\t\t\t\t\t"#ad5792",\n\t\t\t\t\t"#c65dea",\n\t\t\t\t\t"#e670ca",\n\t\t\t\t\t"#e38783",\n\t\t\t\t\t"#29312d",\n\t\t\t\t\t"#6a2c1e",\n\t\t\t\t\t"#d7b1aa",\n\t\t\t\t\t"#b1e7c3",\n\t\t\t\t\t"#cdc134",\n\t\t\t\t\t"#9ee764",\n\t\t\t\t\t"#56b8ce",\n\t\t\t\t\t"#2c6323",\n\t\t\t\t\t"#65464a",\n\t\t\t\t\t"#b1cfea",\n\t\t\t\t\t"#3c7481",\n\t\t\t\t\t"#3a4e96",\n\t\t\t\t\t"#6493e1",\n\t\t\t\t\t"#db5656",\n\t\t\t\t\t"#747259",\n\t\t\t\t\t"#bbabe4",\n\t\t\t\t\t"#e33f92",\n\t\t\t\t\t"#d0607d",\n\t\t\t\t\t"#759f79",\n\t\t\t\t\t"#9d6b5e",\n\t\t\t\t\t"#8574ae",\n\t\t\t\t\t"#7e304c",\n\t\t\t\t\t"#ad8fac",\n\t\t\t\t\t"#4b77de",\n\t\t\t\t\t"#647e17",\n\t\t\t\t\t"#b9c379",\n\t\t\t\t\t"#8da8b0",\n\t\t\t\t\t"#b972d9",\n\t\t\t\t\t"#786279",\n\t\t\t\t\t"#7ec07d",\n\t\t\t\t\t"#916436",\n\t\t\t\t\t"#2d274f",\n\t\t\t\t\t"#dce680",\n\t\t\t\t\t"#759748",\n\t\t\t\t\t"#dae65a",\n\t\t\t\t\t"#459c49",\n\t\t\t\t\t"#b7934a",\n\t\t\t\t\t"#51c671",\n\t\t\t\t\t"#9ead3f",\n\t\t\t\t\t"#969a5c",\n\t\t\t\t\t"#b9976a",\n\t\t\t\t\t"#46531a",\n\t\t\t\t\t"#c0f084",\n\t\t\t\t\t"#76c146",\n\t\t\t\t\t"#bad0ad"\n\t\t\t\t]\n\t\t\t}\n\t\t],\n\t\t"ui": [\n\t\t\t{\n\t\t\t\t"name": "Palette",\n\t\t\t\t"colors": [\n\t\t\t\t\t"none",\n\t\t\t\t\t"#ffffff",\n\t\t\t\t\t"#46c646",\n\t\t\t\t\t"#276e27",\n\t\t\t\t\t"#b6d7ea",\n\t\t\t\t\t"#7db8da",\n\t\t\t\t\t"#4477aa",\n\t\t\t\t\t"#8e477d",\n\t\t\t\t\t"#ffcf02",\n\t\t\t\t\t"#f8981d",\n\t\t\t\t\t"#f93f17",\n\t\t\t\t\t"#633d0c",\n\t\t\t\t\t"#b0afae",\n\t\t\t\t\t"#7b7a78",\n\t\t\t\t\t"#545352",\n\t\t\t\t\t"#000000"\n\t\t\t\t]\n\t\t\t}\n\t\t]\n\t},\n\t"scales": [\n\t\t{\n\t\t\t"name": "Sequential Gradient",\n\t\t\t"translation": "properties.colorScheme.sequential",\n\t\t\t"type": "gradient",\n\t\t\t"propertyValue": "sg",\n\t\t\t"scale": [ "#662506", "#993404", "#cc4c02", "#ec7014", "#fb9a29", "#fec44f", "#fee391", "#fff7bc" ]\n\t\t},\n\t\t{\n\t\t\t"name": "Sequential Classes",\n\t\t\t"translation": "properties.colorScheme.sequentialC",\n\t\t\t"propertyValue": "sc",\n\t\t\t"type": "class",\n\t\t\t"scale": [ "#662506", "#993404", "#cc4c02", "#ec7014", "#fb9a29", "#fec44f", "#fee391" ]\n\t\t},\n\t\t{\n\t\t\t"name": "Diverging gradient",\n\t\t\t"translation": "properties.colorScheme.diverging",\n\t\t\t"propertyValue": "dg",\n\t\t\t"type": "gradient",\n\t\t\t"scale": [ "#ae1c3e", "#d24d3e", "#ed875e", "#f9bd7e", "#e6f5fe", "#b4ddf7", "#77b7e5", "#3a89c9", "#3d52a1" ]\n\t\t},\n\t\t{\n\t\t\t"name": "Diverging Classes",\n\t\t\t"translation": "properties.colorScheme.divergingC",\n\t\t\t"propertyValue": "dc",\n\t\t\t"type": "class",\n\t\t\t"scale": [ "#ae1c3e", "#d24d3e", "#ed875e", "#f9bd7e", "#ffe3aa", "#e6f5fe", "#b4ddf7", "#77b7e5", "#3a89c9", "#3d52a1" ]\n\t\t}\n\t]\n}\n'}),define("text!assets/external/sense-themes-default/default-themes.json",[],function(){return'{\r\n\t"_description": "List of themes available in the sense client, specified as a value and label.",\r\n\t"default": [\r\n\t\t{\r\n\t\t\t"value": "sense",\r\n\t\t\t"label": "Themes.Qlik.Classic"\r\n\t\t},\r\n\t\t{\r\n\t\t\t"value": "card",\r\n\t\t\t"label": "Themes.Qlik.Standard"\r\n\t\t},\r\n\t\t{\r\n\t\t\t"value": "breeze",\r\n\t\t\t"label": "Themes.Qlik.Breeze"\r\n\t\t}\r\n\t]\r\n}\r\n'}),define("client.utils/theme/modern/theme-loader",["qvangular","translator","require","core.utils/deferred","general.services/content-api/content-api"],function(a,b,c,d){"use strict";var e,f,g,h,i,j={};return j._isThemeExtension=function(a,b){return a.hasOwnProperty(b)&&a[b].type&&"theme"===a[b].type},j._sortAlphabetically=function(a){return a.sort(function(a,b){return a.label.localeCompare(b.label)})},j._translateLabels=function(a){return a.forEach(function(a){a.label=b.get(a.label)}),a},j._resolveDefaultConfiguration=function(a){var b=JSON.parse(a);e=j._translateLabels(b.default),g.resolve(e)},j._requireDefaultJSON=function(){c(["text!assets/external/sense-themes-default/default-themes.json"],j._resolveDefaultConfiguration)},j._getThemeExtensions=function(){a.getService("$contentApi").getExtensions().then(function(a){f=[];for(var b in a)j._isThemeExtension(a,b)&&f.push({value:b,label:a[b].name});h.resolve(j._sortAlphabetically(f))})},j._getPageFromList=function(a,b,c){var d=a||a>0?a:0,e=d*c,f=(d+1)*c;return b.length<f&&(f=b.length),b.slice(e,f)},j._calculateNbrOfPages=function(a,b){return Math.ceil(a.length/b)},j.getThemeDef=function(a,b,d,e){var f="text!"+j.getThemePath(b)+encodeURIComponent(a)+"/theme.json";return c([f],d,e)},j.getThemePath=function(a){return a?"assets/external/sense-themes-default/":"extensions/"},j.loadDefaultConfiguration=function(){return b.get("Themes.Qlik.Breeze"),e?d.resolve(e):g?g.promise:(g=new d,j._requireDefaultJSON(),g.promise)},j.loadExtensions=function(){return f?d.resolve(f):h?h.promise:(h=new d,j._getThemeExtensions(),h.promise)},j.loadExtensionsPage=function(a){var b,c;return i&&i<a?d.resolve([]):(b=new d,j.loadExtensions().then(function(d){c=j._getPageFromList(a,d,20),b.resolve(c)}),b.promise)},j.getPagesTotal=function(){var a;return i?d.resolve(i):(a=new d,j.loadExtensions().then(function(b){i=j._calculateNbrOfPages(b,20),a.resolve(i)}),a.promise)},j}),define("general.utils/color-cache",["./color"],function(a){function b(a,b){return function(){var c,d,e=function(){};return e.prototype=a.prototype,c=new e,d=a.apply(c,b),Object(d)===d?d:c}}function c(){j++}function d(){var d,e,f,k;if(arguments.length<3)"string"==typeof arguments[0]?d=arguments[0]:"number"==typeof arguments[0]&&arguments[0]>=0&&(d=arguments[0]+"");else if(arguments.length>=3)for(d=arguments[0],f=0;f>arguments.length;f++)d+=","+arguments[f];if(d&&g[d])return g[d];if(k=b(a,arguments)(),e=k.isInvalid()?"INVALID":k._r+","+k._g+","+k._b+","+k._a,h[e])k=h[e];else{if(j>=i)return k;h[e]=k,c()}return d&&(g[d]=k),k}function e(d,e,f){var g,l,m=k(d._r+(e._r-d._r)*f),n=k(d._g+(e._g-d._g)*f),o=k(d._b+(e._b-d._b)*f),p=k(d._a+(e._a-d._a)*f);if(g=m+","+n+","+o+","+p,h[g])l=h[g];else{if(l=b(a,[m,n,o,p])(),j>=i)return l;h[g]=l,c()}return l}function f(){g={},h={},j=0}var g={},h={},i=5e3,j=0,k=Math.floor;return{retriveColor:d,retriveBlend:e,clear:f}}),define("objects.views/charts/representation/color-scale",["core.utils/class","general.utils/color-cache"],function(a,b){"use strict";function c(a,b,c){var d;if(a=h(g(a,1e-12),.999999999999),c){for(var e=0;e<c.length&&c[e]<=a;)e++;d=c.length-(e+(a-c[e-1])/(c[e]-c[e-1]))}else d=b-a*b;return d}function d(a){return a=a||this._startLevel,h(a,this._colorParts.length-1)}function e(a){a.forEach(function(a){a.forEach(function(a){a.reverse()}),a.reverse()})}var f,g=Math.max,h=Math.min,i=b.retriveColor(13816530);return f=a.extend({init:function(){this._colorParts=[],this._startLevel=0,this._reverse=!1,this._max=1,this._min=0,this._span=1,this._invalidSpan=!1},addColorPart:function(a,c,d){d=d||0,this._startLevel=g(d,this._startLevel),this._colorParts[d]||(this._colorParts[d]=[]),this._colorParts[d].push([b.retriveColor(a),b.retriveColor(c)])},setLimits:function(a){if(!a)return this._limits=null,void(this._expandedLimits=null);this._limits=a,this._expandedLimits=[0].concat(a,[1])},setMaxMinValues:function(a,b){if(!(a>=b)||isNaN(a)||isNaN(b))throw"Incorrect arguments to color-scale->setMaxMinValues";this._max=a,this._min=b,this._span=a-b},setReverse:function(a){this._reverse!==a&&(this._reverse=a,e(this._colorParts))},getColor:function(a,e){var f,g,h,j,k,l,m=0===this._span?.5:(a-this._min)/this._span;return isNaN(m)?i:(e=d.apply(this,[e]),f=c(m,this._colorParts[e].length,this._expandedLimits),g=Math.floor(f),g=g===f?g-1:g,j=this._colorParts[e][g],k=j[0],l=j[1],a===this._min?l:a===this._max?k:(h=f-g,b.retriveBlend(k,l,h)))},getColors:function(a){var b,c=[];for(b=0;b<a.length;b++)c.push(this.getColor(a[b]));return c},getLegendParts:function(a){var b,c,e,f=[];for(a=d.apply(this,[a]),c=this._colorParts[a].length,b=0;b<c;++b)e=this._colorParts[a][b],f.push({grad:e,color:e[0],solid:e[0]===e[1],index:b});return f}}),f._limitFunction=c,f}),define("client.utils/theme/modern/theme-scale-generator",["objects.views/charts/representation/color-scale","general.utils/color"],function(a,b){"use strict";function c(a,b,c){var d=.25+(b+1)/c*.25,e=.5-d;return e+a/1*(.5+d-e)}function d(b,c){var d=[],e=new a;d.push(b[0]),c||d.push(b[0]);for(var f=1;f<b.length-1;f++)d.push(b[f]),d.push(b[f]);d.push(b[f]),c||d.push(b[f]);for(var g=0;g<d.length;g+=2)e.addColorPart(d[g],d[g+1]);return e}function e(a,d,e){for(var f=[],g=0;g<d+1;g++){var h;switch(d){case 0:h=a.getColor(.5);break;default:var i=c(1/d*g,d,e);h=a.getColor(i)}f.push(new b(h).toHex())}return f}function f(a,b,c){for(var f=d(a,!0),g=e(f,b-1,b),h=d(g,c),i=[null],j=0;j<b;j++)i.push(e(h,j,b));return i}function g(a){a.forEach(function(a){if("class"===a.type){var b=f(a.scale,Math.max(a.scale.length,7),!1);a.scale=b,a.type="class-pyramid"}})}function h(a,b){var c={},d=[];return a.forEach(function(a,e){b?["pyramid","row"].indexOf(a.type)===-1&&d.push("Improper type for data palette: "+a.name):["class","class-pyramid","gradient"].indexOf(a.type)===-1&&d.push("Improper type for data scale: "+a.name),["pyramid","class-pyramid"].indexOf(a.type)!==-1?Array.isArray(a.scale)&&Array.isArray(a.scale[a.scale.length-1])&&"string"==typeof a.scale[a.scale.length-1][0]||d.push("Improper scale structure for: "+a.name):Array.isArray(a.scale)&&"string"==typeof a.scale[0]||d.push("Improper scale structure for: "+a.name),a.propertyValue||(a.propertyValue="scale"+e),c[a.propertyValue]?d.push("Duplicate property values for: "+a.name):c[a.propertyValue]=!0}),d}return{createPyramidFromColors:f,generateScales:g,validatePalettesOrScales:h}}),define("client.utils/theme/modern/theme-parser",["jquery","util","require","client.utils/theme/modern/theme-scale-generator"],function(a,b,c,d){"use strict";function e(a,b){for(var c in a)"object"==typeof a[c]&&null!==a[c]?e(a[c],b):"string"==typeof a[c]&&"@"===a[c].charAt(0)&&(a[c]=b[a[c]])}function f(a){d.generateScales(a)}function g(a,b){var c;a&&(c=d.validatePalettesOrScales(a))&&c.length&&c.forEach(function(a){console.warn("Theme parsing error, scale declaration: "+a)}),b&&(c=d.validatePalettesOrScales(b,!0))&&c.length&&c.forEach(function(a){console.warn("Theme parsing error, scale declaration: "+a)})}function h(a){a.forEach(function(a){if(a.colors)for(var b=0;b<a.colors.length;b++)a.colors[b]&&(a.colors[b]=a.colors[b].toLowerCase())})}var i=["palette","colorSchemes.qualitativeScales","colorSchemes.ordinalScales","scales","palettes.data","palettes.ui"],j={};return j.injectStyleNode=function(a,b,d){var e=document.createElement("link");return e.setAttribute("rel","stylesheet"),e.setAttribute("href",c.toUrl(b+encodeURIComponent(a)+"/"+(d||"theme.css"))),document.head.appendChild(e),e},j.injectExtraStyleNodes=function(a,b,c){var d=[];return a.customStyles&&a.customStyles.length&&a.customStyles.forEach(function(a){d.push({node:j.injectStyleNode(c,b,a.cssRef),cssClass:a.classRef}),j.toggleCssClass(a.classRef,!0)}),d},j.toggleCssClass=function(b,c){a(".qv-client").toggleClass(b,c)},j.parseTheme=function(a,c,d,j){var k={};try{a=JSON.parse(a)}catch(b){console.warn("Theme parsing error for theme: "+j+": "+b),a={}}return e(a,a._variables),e(c,c._variables),a._inherit===!1?b.extend(!0,k,a):b.extend(!0,k,c,a),d&&i.forEach(function(c){var d=b.getValue(a,c);void 0!==d&&b.setValue(k,c,d)}),k.scales&&f(k.scales),k.palettes&&k.palettes.ui&&h(k.palettes.ui),g(k.scales,k.palettes?k.palettes.data:null),k},j}),define("client.utils/theme/modern/theme-style-resolver",["core.utils/class","general.utils/color"],function(a,b){"use strict";function c(a,b,d,e,f){var g=h(b,d,e);return"."===g.charAt(0)?(b.shift(),a.apply(null,[c(a,b,d,e,f)].concat(f))):g}function d(a,b,d,e,f,h){return c(a,g(""===b?null:b.split("."),f),d,e,h)}function e(a,b){for(var c=a,d=0;d<b.length;d++){if(!c[b[d]])return null;c=c[b[d]]}return c}function f(a,b,c){var e=a.substring(1).split("(")[0],f=/\(\s*([^)]+?)\s*\)/.exec(a);f=f&&f[1]?f[1].split(/\s*,\s*/):[];try{return d(m[e],b,c,this._theme,this._basePathSteps,f)}catch(a){console.warn("Cound not execute function: "+e+", function might not be implemented or arguments are incorrect.")}}function g(a,b){var c,d,e=[];if(a)for(var f=a.length;f>=0;){for(c=b.slice(),d=c.length;d>=0;)e.push(c.concat(a)),c.pop(),d--;a.pop(),f--}else for(c=b.slice(),d=c.length;d>=0;)e.push(c.concat()),c.pop(),d--;return e}function h(a,b,c){for(var d=0;d<a.length;d++){var f=e(c,a[d]);if(null!==f&&f[b])return f[b]}}function i(a,b,c){var d;if(""===a)d=g(null,c);else{d=g(a.split("."),c)}return h(d,b,this._theme)}function j(){for(var a="",b=0;b<arguments.length;b++)arguments[b]&&arguments[b].length&&(a+=(""!==a?".":"")+arguments[b]);return a}function k(a,b){n._cache[a]=b}function l(a){return n._cache[a]}var m={shift:function(a,c){var d=new b(a),e=d.isDark()?parseInt(c):-parseInt(c);return new b(d.shiftLuminance(e)).toHex()},fontSize:function(a,b){var c=parseInt(a);return c*=parseInt(b)/100,Math.ceil(c)+"px"},inherit:function(a){return a},alpha:function(a,c){var d=new b(a);return d.setAlpha(c/100),d.toRGBA()}},n=a.extend("ThemeStyleResolver",{init:function(a,b,c){this._basePath=a,this._basePathSteps=a.split("."),this._theme=c,this._id=b,this.layoutMap={1:"spark",3:"xsmall",7:"small",15:"medium",31:"full",m:"mobile"}},setTheme:function(a,b){this._theme=b,this._id=a},setBasePath:function(a){this._basePath=a,this._basePathSteps=a.split(".")},getStyle:function(a,b){var c=l(j(this._id,this._basePath,a,b));if(void 0!==c)return c;var d=this._basePathSteps.concat(),e=i.call(this,a,b,d);return e&&e.charAt&&"."===e.charAt(0)&&(e=f.call(this,e,a,b)),e&&k(j(this._id,this._basePath,a,b),e),e},scaleFontSize:function(a,b,c){if("string"==typeof b)switch(b){case"large":b=31;break;case"medium":b=15;break;case"small":b=7;break;case"tiny":b=1;break;default:b=15}var d={spark:.75,xsmall:.8,small:.95,full:".discrete"===c?1:1.2};return d[this.layoutMap[b]]?Math.floor(parseInt(a)*d[this.layoutMap[b]])+"px":parseInt(a)+"px"}});return n._cache={},n.clearCache=function(){n._cache={}},n}),define("client.utils/theme/modern/theme",["core.utils/deferred","core.utils/notification","client.models/app-generic-props-wrapper","text!assets/external/sense-themes-default/theme.json","client.utils/theme/modern/theme-loader","client.utils/theme/modern/theme-parser","client.utils/theme/modern/theme-style-resolver","core.utils/feature-flags"],function(a,b,c,d,e,f,g,h){"use strict";function i(){o.parentNode.removeChild(o),p.forEach(function(a){a.node.parentNode.removeChild(a.node),f.toggleCssClass(a.cssClass,!1)}),p=[]}function j(a,b){var c=!1;return a&&a.forEach(function(a){a.value===b&&(c=!0)}),c}function k(){var a=u.currentPalette,b=!0;a.forEach(function(a,c){w[c]&&w[c].toLowerCase()===a.toLowerCase()||(b=!1)}),s=b}var l,m=JSON.parse(d),n=null,o=null,p=[],q={},r={},s=!0,t=!0,u={};b.create(u,"ThemeChanged"),u.getCurrentTheme=function(){return n||"sense"},u.applyTheme=function(b){return!b||b.indexOf("/")>-1?a.resolve():b===n?a.resolve():(l=new a,e.loadDefaultConfiguration().then(function(a){t=!h.THEMING_QMC||j(a,b),e.getThemeDef(b,t,function(a){var c=f.parseTheme(a,m,!0,b);n&&i(),o=f.injectStyleNode(b,e.getThemePath(t)),p=f.injectExtraStyleNodes(c,e.getThemePath(t),b),q=c,n=b,Object.keys(r).forEach(function(a){r[a].setTheme(n,q)}),k(),u.ThemeChanged.emit(),l.resolve()},function(a){console.warn("Failed to load theme: "+b+": "+a.message),l.resolve()})}),l.promise)},u.saveTheme=function(){c.setProperties({theme:u.getCurrentTheme()})},u.getAvailableThemes=function(b){return h.THEMING_QMC?a.all({default:e.loadDefaultConfiguration(),custom:b?e.loadExtensions():e.loadExtensionsPage(0)}):a.all({default:e.loadDefaultConfiguration()})},u.loadCustomPage=function(a){return e.loadExtensionsPage(a)},u.getPagesTotal=function(){return e.getPagesTotal()},Object.defineProperty(u,"currentPalette",{iterable:!1,get:function(){return q.palettes&&q.palettes.ui&&q.palettes.ui[0]?q.palettes.ui[0].colors:m.palettes.ui[0].colors}}),Object.defineProperty(u,"deprecatedPalette",{iterable:!1,get:function(){return v}}),Object.defineProperty(u,"scales",{iterable:!1,get:function(){return q.scales||m.scales}}),Object.defineProperty(u,"dataPalettes",{iterable:!1,get:function(){return q.palettes?q.palettes.data||m.palettes.data:m.palettes.data}}),Object.defineProperty(u,"dataColors",{iterable:!1,get:function(){return q.dataColors||m.dataColors}}),u.initializeService=function(a){return r[a]||(r[a]=new g(a,n,q)),r[a]},u.getMatch=function(a){var b={linechart:"lineChart",barchart:"barChart",scatterplot:"scatterPlot",piechart:"pieChart",straightable:"straightTable",pivottable:"pivotTable",table:"straightTable","pivot-table":"pivotTable",listbox:"listBox",referenceline:"referenceLine",datacolors:"dataColors","text-image":"textImage",boxplot:"boxPlot"};return b[a.toLowerCase()]?b[a.toLowerCase()]:a};var v=["#b0afae","#7b7a78","#545352","#4477aa","#7db8da","#b6d7ea","#46c646","#f93f17","#ffcf02","#276e27","#ffffff","#000000"],w=["none","#ffffff","#46c646","#276e27","#b6d7ea","#7db8da","#4477aa","#8e477d","#ffcf02","#f8981d","#f93f17","#633d0c","#b0afae","#7b7a78","#545352","#000000"];return u.resolveColor=function(a,b){return b=b||u.currentPalette,a&&void 0!==a.index?b[a.index]?b[a.index]:a.color?a.color:"none":s&&v[a]?v[a]:b[a]?b[a]:a||"none"},u.mapIndex=function(a,b,c){c=c||u.currentPalette;var d=b?c:v;return a=(b?v:c).indexOf(d[a]),a!==-1?a:b?3:6},h.THEMING&&(f.injectStyleNode("sense",e.getThemePath(t)),q=f.parseTheme(d,m,!0,"default")),u}),define("extensions.qliktech/linechart/layers/layer",["core.utils/class","objects.views/charts/renderers/canvas-renderer","core.utils/deferred"],function(a,b,c){return a.extend("layer",{init:function(a,c){this.wrapper=document.createElement("div"),this.wrapper.style.position="absolute",this.renderer=new b(this.wrapper,c),this.minorAxis=null,this.majorAxis=null,a.appendChild(this.wrapper)},update:function(){},release:function(){this.wrapper&&this.wrapper.parentNode&&this.wrapper.parentNode.removeChild(this.wrapper),this.wrapper=null,this.renderer.release(),this.minorAxis=null,this.majorAxis=null},show:function(){this.wrapper.style.display="block"},hide:function(){this.wrapper.style.display="none"},render:function(){return"none"!==this.wrapper.style.display?this.renderer.render():c.resolve()},clear:function(){this.renderer.clear()}})}),define("client.utils/theme/theme-module",["client.utils/theme/theme","client.utils/theme/modern/theme","core.utils/feature-flags"],function(a,b,c){var d={};return d.get=function(){return c.THEMING?b:a},d.init=function(){return c.THEMING?b.applyTheme("sense"):null},d.getTheme=function(){return c.THEMING?b.getCurrentTheme():a.name},d.setTheme=function(d){c.THEMING?b.applyTheme(d):a.applyTheme(d)},d}),define("extensions.qliktech/linechart/layers/selection-highlight-layer",["./layer","objects.views/charts/shapes/rect","client.utils/theme/theme-module","general.utils/color"],function(a,b,c,d){var e=c.get();return a.extend("SelectionHighlightLayer",{init:function(){this._super.apply(this,arguments),this.ranges=[],this.color=d.toRGBA(e.dataColors.selectionColor,.2)},setRanges:function(a){this.ranges=a},update:function(a){var c=this.ranges.map(function(c){var d=a.getPositionOfValue(c.min),e=a.getPositionOfValue(c.max),f=new b(d,0,e-d,this.rect.height);return f.fill=this.color,f},this);this.renderer.stage.removeChildren(),c.length?(this.renderer.stage.addChildren(c),this.show()):this.hide()}})}),define("extensions.qliktech/barchart/style",[],function(){return{dataPoint:{label:{dark:{color:"#666"},light:{color:"#eee"},font:"11px 'QlikView Sans'"}},shape:{selected:{border:{color:"#333",width:2}},unselected:{opacity:.5},highlighted:{border:{dark:{color:"rgba( 26, 26, 26, 0.75 )"},light:{color:"rgba( 230, 230, 230, 0.75)"},width:1}}}}}),define("extensions.qliktech/barchart/bararea",["objects.views/charts/components/chart-component","./layers/bar-layer","./layers/label-layer","general.utils/color","general.utils/shapes/rect","objects.views/charts/shapes/container","objects.views/charts/shapes/polygon","objects.views/charts/shapes/rect","objects.views/charts/chart-style-service","client.utils/theme/modern/theme","core.utils/deferred","extensions.qliktech/linechart/layers/selection-highlight-layer","core.utils/feature-flags","./style"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";function n(a){return q.width=5,q.height=5,r.save(),r.fillStyle=d.toRGBA(a,.8),r.scale(1,1),r.fillRect(0,0,1,1),r.fillRect(0,1,1,1),r.fillRect(1,0,1,1),r.fillRect(4,1,1,1),r.fillRect(4,2,1,1),r.fillRect(3,2,1,1),r.fillRect(3,3,1,1),r.fillRect(2,3,1,1),r.fillRect(2,4,1,1),r.fillRect(1,4,1,1),r.restore(),r.createPattern(q,"repeat")}function o(a,b){var c=a.layoutMap[b]||"medium";return m.THEMING?{shape:{selected:{border:{color:"#333333",width:2}},outOfRange:{color:a.getStyle("outOfRange","color")}},dataPoints:{label:{font:"normal "+a.getStyle("label.value","fontSize")+" 'QlikView Sans'",color:a.getStyle("label.value","color"),dark:{color:"#595959"},light:{color:"#E6E6E6"}},backgroundColor:a.getStyle("","backgroundColor")},backgroundColor:a.getStyle("","backgroundColor")}:{shape:{selected:{border:{color:a.getValue(p,"shape.border","color","selected"),width:a.getValue(p,"shape.border","width","selected")}},outOfRange:{color:"#999999"}},dataPoints:{label:{font:a.getFont(p,"value",c),color:a.getValue(p,"value","color","dark"),dark:{color:a.getValue(p,"value","color","dark")},light:{color:a.getValue(p,"value","color","light")}}},backgroundColor:a.getValue(p,null,"backgroundColor")}}var p="barChart",q=document.createElement("canvas"),r=q.getContext("2d");return a.extend("BarArea",{init:function(){this._super.apply(this,arguments),this._data=null,this._layoutMode=null,this._selectableShapes=[],this._shapes=[],this._barData=[],this._showDataPoints=!0,this._colorMap=null,this._groupingMode="grouped",this._globalAlpha=1,m.THEMING?this._styleService=j.initializeService("object.barChart"):this._styleService=i.getInstance(),this._edgeBleed=0,this._barLayer=new b(this.container),this._barLayer.isMini=this.isMini,this.layers=[this._barLayer],this.isMini?(this._rangeSelectionLayer=new l(this.container),this.layers.push(this._rangeSelectionLayer)):(this._labelLayer=new c(this.container),this.layers.push(this._labelLayer))},setYMirrorMode:function(a){this._super(a),this._labelLayer&&this._labelLayer.setYMirrorMode(a)},beforeBarsAddedToRenderer:function(){},barsAddedToRenderer:function(){},labelAddedToRenderer:function(){},afterPaint:function(){return k.resolve()},setColorMap:function(a){this._colorMap=a},getColorMap:function(){return this._colorMap},setShowDataPoints:function(a){this._showDataPoints=a,this.invalidateDisplay("BarArea.setShowDataPoints")},getShowDataPoints:function(){return this._showDataPoints},getMeasureIndices:function(){return this._measureIndices},setMeasureIndices:function(a){this._measureIndices=a},setMajorAxis:function(a){this._majorAxis=a,this._majorAxis.listen("changed",function(){this.invalidateDisplay("BarArea.setMajorAxis")},this)},setMinorAxis:function(a){this._minorAxis=a,this._minorAxis.listen("changed",function(){this._localFormatting&&(this._areLabelsFormatted=!1),this.invalidateDisplay("BarArea.setMinorAxis")},this)},setTimeAxis:function(a){this.timeAxis=a,this.timeAxis.listen("changed",function(){this.invalidateDisplay()},this)},setContinuousAxis:function(a){this.continuousAxis=a,this.continuousAxis.listen("changed",function(){this.invalidateDisplay()},this)},setActiveDimensionAxis:function(a){this._activeDimAxis=a},setIsDimensionContinuous:function(a){this.isDimensionContinuous=a,this._edgeBleed=this.isDimensionContinuous?5:0},setDimensionTree:function(a){this._tree=a},setGroupingMode:function(a){this._groupingMode=a},_updateSize:function(){this.invalidateDisplay("BarArea._updateSize")},insertAdjacentTo:function(a,b){if(this._super(a,b),this._minorAxis&&this._minorAxis.isHorizontal())switch(this._minorAxis.dock){case"bottom":this.rect.height-=1}},getMajorAxisData:function(){return this._majorAxisData},getMinorAxisData:function(){return this._minorAxisData},setCacheItems:function(a){this._cacheItems=a},getCacheItems:function(){return this._cacheItems},createAxisData:function(a,b,c,d){d||(this._cacheIndex=0,this._outerCacheIndex=0);var e,f=b.stackLevel===d+1,g=a.children,h=b.numLevels-b.numMeasures;return"measure"===b.types[d]&&this._measureIndices&&(g=g.filter(function(a,b){return this._measureIndices.indexOf(b)>=0},this)),g.map(function(a){var g;if("dimension"===b.types[d]){if(g={label:a.data.qText,group:"dimension"===b.types[d+1]||"measure"===b.types[d+1]&&b.numMeasures>1,id:a.data.id,cacheIndex:[]},"measure"===b.types[d+1])for(e=0;e<b.numMeasures;e++)g.cacheIndex.push(this._cacheIndex++);else h>1&&0===d&&a.children.forEach(function(a){a.children[0].isBranch&&(a.data.qElemNo!==-2&&g.cacheIndex.push(this._outerCacheIndex),this._outerCacheIndex++)},this);!f&&("dimension"===b.types[d+1]||"measure"===b.types[d+1]&&b.numMeasures>1)&&(g.children=this.createAxisData(a,b,c,d+1))}else"measure"===b.types[d]&&(g={
label:a.data.qText,id:a.data.id});return g},this)},_createMeasureDisplayNode:function(a,b){if(a.isBranch){var c=this.isMini===!0||this._isStacked?new h:new g,d=a.children,f=d[0].data,i=a.parent.cacheItem,j=new e(0,0,0,0),k=this.measureFormatters[b],l=void 0!==f.qValue?f.qValue:f.qNum,m=a.ancestors.filter(function(a){return"qElemNo"in a.data}).map(function(a){return a.data.qElemNo}).reverse();return c.data={qText:a.data.qText,measureIndex:b,value:l,start:0,end:l,valueLabel:a.children[0].data.qText,formatted:!k||"U"!==k.type,hitRect:j,cacheItem:i,color:this._colorMap.getColor(m,l,b,a.data.rowIndex)},i.addShape("dataArea",j,!0),i.calculateTooltipPosition=!0,c.data.fill=c.data.color.toRGBA(),c.fill=c.data.fill,c.data.isFillColorDark=c.data.color.isDark(),c}},_createDimensionDisplayNode:function(a){var b=new f;return b.data={qText:a.data.qText,qElemNo:a.data.qElemNo,qMaxPos:a.data.qMaxPos,qMinNeg:a.data.qMinNeg,qType:a.data.qType},b},_createStackNode:function(){var a=new f;return a.data={stack:!0},a},_createOtherNode:function(a,b){var c=new h,d=new e(0,0,0,0),f=this.measureFormatters[0];return c.data={measureIndex:0,value:b-a,start:a,end:b,isFakeOtherCell:!0,highlightOnGroupSelect:0===this._selectionIndices[0],valueLabel:"valueLabel",formatted:!f||"U"!==f.type,hitRect:d,cacheItem:{},color:this._colorMap.getColor([-3],b-a,0,0)},c.data.fill=c.data.color.toRGBA(),c.fill=c.data.fill,c.data.isFillColorDark=c.data.color.isDark(),c},_addOtherNode:function(a,b,c){var d=this._createDimensionDisplayNode({data:{qMaxPos:0,qMinNeg:0,qElemNo:-3,qType:"O"}}),e=this._createOtherNode(a.data.sum,b);return e.data.axisId=c.data.id,e.data.cacheItem=c.cacheItem,d.addChild(e),a.data.sum=b,a.addChild(d),e},_stackNodes:function(a,b,c,d){var e,f,g,h,i,j=this._createStackNode(),k=this._createStackNode(),l=!1,m=!1,n=0,o=0;j.data.isStack=!0,k.data.isStack=!0,a.forEach(function(a){e=b,g=a.children&&a.children[0]?a.children[0].data:a.data,g.value>=0?(e=j,g.start=n,n+=g.value,g.end=n,f=n,h=!0,e.addChild(a),"O"===a.data.qType&&(l=!0)):isNaN(g.value)||(e=k,g.start=o,o+=g.value,g.end=o,f=o,i=!0,e.addChild(a),"O"===a.data.qType&&(m=!0)),e.data.sum=f}),void 0===b.data.qMaxPos||l||n===b.data.qMaxPos||(d.push(this._addOtherNode(j,b.data.qMaxPos,c)),n=j.data.sum,h=n>0),void 0===b.data.qMinNeg||m||o===b.data.qMinNeg||(d.push(this._addOtherNode(k,b.data.qMinNeg,c)),o=k.data.sum,i=o<0),h&&(j.data.valueLabel=this.combinedMeasuresFormatter?this.combinedMeasuresFormatter.formatValue(j.data.sum):j.data.sum+"",b.addChild(j)),i&&(k.data.valueLabel=this.combinedMeasuresFormatter?this.combinedMeasuresFormatter.formatValue(k.data.sum):k.data.sum+"",b.addChild(k)),b.data.sum={positive:n,negative:o}},getRenderTree:function(a,b,c,d){var e,f,g,h,i,j,k,l=b.stackLevel===d+1,m=[];for(g=a.children,"measure"===b.types[d]&&this._measureIndices&&(g=g.filter(function(a,b){return this._measureIndices.indexOf(b)>=0},this)),i=g.length,h=0;h<i;h++)if(k=g[h],"dimension"===b.types[d])j=this._createDimensionDisplayNode(k),f=this.getRenderTree(k,b,c,d+1),l?(this._stackNodes(f,j,k,c.otherShapes),c.globalPositiveSum=Math.max(c.globalPositiveSum,j.data.sum.positive),c.globalNegativeSum=Math.min(c.globalNegativeSum,j.data.sum.negative)):j.addChildren(f),j.isBranch&&m.push(j);else if("measure"===b.types[d]){if(!(j=this._createMeasureDisplayNode(k,this._measureIndices?this._measureIndices[h]:h)))continue;e=k,b.numMeasures<=1&&(e=e.parent),b.stackLevel===d&&(e=e.parent),j.data.axisId=e.data.id,j.data.axisNum=1===d?e.data.qNum:e._parent.data.qNum,c.shapes.push(j),m.push(j)}return m},_applyIds:function(a,b,c,d){var e;a.children.forEach(function(f,g){e=a.data.id?a.data.id+";"||"":"","dimension"===c[d]?(f.data.id=e+b[d]+":"+f.data.qElemNo,this._applyIds(f,b,c,d+1)):"measure"===c[d]&&(f.data.id=e+b[d+g])}.bind(this))},renderRangeSelections:function(){return this._rangeSelectionLayer.update(this._activeDimAxis),this._rangeSelectionLayer.render()},updateRangeSelection:function(a){this._rangeSelectionLayer&&(this._rangeSelectionLayer.setRanges(a),this.renderRangeSelections()),this.isMini||(this._barLayer.selectedRanges=a)},_updateProperties:function(){if(this._data&&this._tree){this._barLayer.renderer.stage.removeChildren();var a=this._data.qHyperCube.qDimensionInfo.length,b=this._measureIndices?this._measureIndices.length:this._data.qHyperCube.qMeasureInfo.length,c="stacked"===this._groupingMode&&(a>1||b>1),d=a+1,e=-2,f=[],g=new Array(a).join(",").split(",").map(function(){return"dimension"}),h=this._data.qHyperCube.qDimensionInfo.concat(this._data.qHyperCube.qMeasureInfo).map(function(a){return a.cId}),i=this._data.qHyperCube.qDimensionInfo.map(function(a){return a.qApprMaxGlyphCount});if(g.push("measure"),i.push(this._data.qHyperCube.qMeasureInfo.reduce(function(a,b){return Math.max(a,b.qApprMaxGlyphCount)},0)),c)e=b>1?a:a-1;else if(a>1){var j=this._data.qHyperCube.qDimensionInfo[0].qStateCounts.qOption+this._data.qHyperCube.qDimensionInfo[0].qStateCounts.qSelected,k=this._data.qHyperCube.qSize.qcy/j;f.push(k),f.push(b)}else f.push(b),f.push(1);this._isStacked=c;var l={columns:[],shapes:[],shapesToLabel:[],otherShapes:[],globalPositiveSum:0,globalNegativeSum:0},m={colIds:h,types:g,numLevels:d,numMeasures:b,stackLevel:e};a>1&&this._allowInnerSelection&&!this._data.qHyperCube.qDimensionInfo[1].qLocked?(this.setSelectionIndices([1]),this._majorAxis.setSelectionIndices([1]),this._majorAxis.setCurrentDataIndices([1])):(this.setSelectionIndices([0]),this._majorAxis.setSelectionIndices([0]),this._majorAxis.setCurrentDataIndices([0])),this._applyIds(this._tree,h,g,0);var n=this.getRenderTree(this._tree,m,l,0);this._objects=n,this._formatted=this._isStacked||this.measureFormatters.every(function(a,b){return!(!this._measureIndices||this._measureIndices.indexOf(b)>=0)||"U"!==a.type},this),this._shapes=l.shapes;var o=l.shapes.map(function(a){return a.data.cacheItem});this._shapes=this._shapes.concat(l.otherShapes),n.forEach(function(a){this._barLayer.renderer.stage.addChild(a)}.bind(this));var p=this.createAxisData(this._tree,m,l,0),q=g.map(function(a,b){return{qApprMaxGlyphCount:i[b],show:b<g.length-1,groupSize:f[b]}});this._majorAxisData={data:p,info:q},this._numDimensions=a,this._numMeasures=b,this._minorAxisData=c?{min:l.globalNegativeSum,max:l.globalPositiveSum}:null,this.setSelectableShapes(o)}},hasValidData:function(){return this._super()&&this._majorAxis&&this._minorAxis&&this._data&&this._tree&&(this._data.qHyperCube.qStackedDataPages.length>0||this._data.qHyperCube.qDataPages.length>0)},updateSize:function(){this._super(),this.layers.forEach(function(a){a.rect=this.rect,a.renderer.setDimensionsToContainerRatio(this.layoutToContainerRatios.x,this.layoutToContainerRatios.y),a.renderer.setDimensions(0,0,this.rect.width,this.rect.height)},this)},paint:function(){this._super(this._layoutMode,this._data),this._majorAxis.updateNow(),this._minorAxis.updateNow(),this._activeDimAxis&&this._activeDimAxis.updateNow();var a=this._minorAxis.getPadding(),b=new e,c=this;this._style=o(this._styleService,this._layoutMode),b.set(a.left,a.top,this.rect.width-a.left-a.right,this.rect.height-a.top-a.bottom),this.layers.forEach(function(a){a.minorAxis=this._minorAxis,a.majorAxis=this.isDimensionContinuous?this._activeDimAxis:this._majorAxis,a.isNumeric=this.isDimensionContinuous,a.shapes=this._shapes,a.othersFillPattern=n(this._colorMap.getColor([-3])),a.groupingMode=this._groupingMode,a.widthRatio=this._numDimensions<=1&&this._numMeasures<=1||"stacked"===this._groupingMode?.7:.95,a.isSpikingEnabled=!(this.isMini||"stacked"===this._groupingMode&&(this._numDimensions>1||this._numMeasures>1)),a.isHintingEnabled=!this.isMini&&("grouped"===this._groupingMode||"stacked"===this._groupingMode&&this._numDimensions+this._numMeasures<=2),a.style=this._style,a._globalAlpha=this._globalAlpha},this),this._barLayer.renderer.edgeBleed={left:this._edgeBleed,right:this._edgeBleed,top:0,bottom:0},this._barLayer.colorMap=this._colorMap,this._barLayer.update(),this.nodesInView=this._barLayer.nodesInView,this.barsAddedToRenderer(),this._labelLayer&&(this._labelLayer.renderer.edgeBleed={left:this._edgeBleed,right:this._edgeBleed,top:0,bottom:0},this._labelLayer.setShapes(this._objects),this._labelLayer.bounds=b,this._labelLayer._longestLabel=20,this._layoutMode>this.ShowFlags.XSMALL&&this._showDataPoints?(this._formatLabels(),this._labelLayer.show(),this._labelLayer.render()):this._labelLayer.hide());var d=[this._barLayer.render()];return this._rangeSelectionLayer&&d.push(this.renderRangeSelections()),k.all(d).then(function(){return c.afterPaint()})},_formatLabels:function(){if(!this._isStacked&&!this._formatted){var a,b,c=this.nodesInView?this.nodesInView.length:0;for(a=0;a<c;a++)b=this.nodesInView[a].data,b.formatted||(b.formatted=!0,b.valueLabel=this.measureFormatters[b.measureIndex]?this.measureFormatters[b.measureIndex].formatValue(b.value):b.valueLabel)}},preRelevantSizeCalculation:function(){this.perpendicularlyRelevantSpacing={left:this._edgeBleed,right:this._edgeBleed,top:0,bottom:0}},clear:function(){this._super(),this.layers.forEach(function(a){a.clear()})},release:function(){this.layers.forEach(function(a){a.release()}),this._super(),this._majorAxis&&this._majorAxis.stopListen("changed",null,this),this._minorAxis&&this._minorAxis.stopListen("changed",null,this),this.timeAxis&&this.timeAxis.stopListen("changed",null,this),this.continuousAxis&&this.continuousAxis.stopListen("changed",null,this)}})}),define("objects.views/charts/utils/time-utils",[],function(){return{hasTimeTag:function(a){return a&&a.qTags&&a.qTags.some(function(a){return["$date","$timestamp","$time"].indexOf(a)>=0})},isTimeDimension:function(a,b){return!(!b||!a)&&(!!this.hasTimeTag(b)||b.qNumFormat&&["D","TS","T"].contains(b.qNumFormat.qType))},maxNumberOfLines:12}}),define("objects.utils/continuous-utils",["objects.views/charts/utils/time-utils"],function(a){return{isContinuousChart:function(b){if(!b.qHyperCube)return!1;var c=this.canBeContinuousChart(b),d=a.isTimeDimension(c,b.qHyperCube.qDimensionInfo[0]);return b.dimensionAxis&&b.dimensionAxis.continuousAuto?d&&"linechart"===b.visualization:c&&b.preferContinuousAxis},canBeContinuousChart:function(a){if(!a.qHyperCube||a.qHyperCube.qDimensionInfo.length<1)return!1;var b=a.qHyperCube.qDimensionInfo[0].qTags||[];return a.qHyperCube.qDimensionInfo[0].qContinuousAxes&&b.indexOf("$numeric")>=0}}}),define("extensions.qliktech/barchart/barchart-properties",["client.utils/property-resolver","objects.utils/continuous-utils"],function(a,b){function c(c){return{get:function(a,d,e){return b.isContinuousChart(e.layout)?c:a(d.type)},set:function(b,c,d){var e=a.getDefaultValue(d.type,d);c(d.type,b,e)}}}var d,e,f;return d={uses:"settings",items:{presentation:{type:"items",translation:"properties.presentation",grouped:!0,items:{grouping:{ref:"barGrouping.grouping",type:"string",component:"item-selection-list",defaultValue:"grouped",horizontal:!0,items:[{icon:"∫",component:"icon-item",labelPlacement:"bottom",translation:"properties.grouping.grouped",value:"grouped"},{icon:"ª",component:"icon-item",labelPlacement:"bottom",translation:"properties.grouping.stacked",value:"stacked"}],show:function(a){return a.qHyperCubeDef.qMeasures.length+a.qHyperCubeDef.qDimensions.length>2},change:function(a,b){b.getDimensions().length>1&&"stacked"===a.barGrouping.grouping?(a.qHyperCubeDef.qMode="K",a.qHyperCubeDef.qAlwaysFullyExpanded=!0):a.qHyperCubeDef.qMode="S"},readOnly:function(a,c,d){return b.isContinuousChart(d.layout)},resolveFunctions:c("stacked")},orientation:{ref:"orientation",type:"string",component:"item-selection-list",defaultValue:"vertical",horizontal:!0,items:[{component:"icon-item",icon:"º",labelPlacement:"bottom",translation:"properties.orientation.vertical",value:"vertical"},{icon:"Ω",component:"icon-item",labelPlacement:"bottom",translation:"Common.Horizontal",value:"horizontal"}],readOnly:function(a,c,d){return b.isContinuousChart(d.layout)},resolveFunctions:c("vertical")},scrollStartPos:{ref:"scrollStartPos",type:"number",translation:"properties.ScrollAlignment",component:"dropdown",defaultValue:0,options:[{value:0,translation:"properties.ScrollAlignStart"},{value:1,translation:"properties.ScrollAlignEnd"}],show:function(a,c,d){return!b.isContinuousChart(d.layout)}},gridLines:{type:"items",snapshot:{tid:"property-gridLines"},items:{showGridLines:{ref:"gridLine.auto",type:"boolean",translation:"properties.gridLine.spacing",component:"switch",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}]},gridSpacing:{ref:"gridLine.spacing",type:"number",component:"dropdown",defaultValue:2,options:[{value:0,translation:"properties.gridLine.noLines"},{value:1,translation:"properties.gridLine.wide"},{value:2,translation:"properties.gridLine.medium"},{value:3,translation:"properties.gridLine.narrow"}],show:function(a){return a.gridLine&&!a.gridLine.auto}}}},showLabels:{ref:"dataPoint.showLabels",type:"boolean",translation:"properties.dataPoints.labelmode",component:"switch",defaultValue:!1,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],snapshot:{tid:"property-dataPoints"}}}},colorsAndLegend:{uses:"colorsAndLegend",items:{legend:{items:{show:{snapshot:{tid:"property-legend"}}}}}},dimensionAxis:{uses:"axis.dimensionAxis"},measureAxis:{uses:"axis.flippableMeasureAxis"}}},e={type:"items",translation:"properties.sorting",items:{noContinuousSortingMessage:{component:"text",translation:"properties.sorting.noContinuousSortingMessage",show:function(a,c,d){return b.isContinuousChart(d.layout)}},defaultSorting:{show:function(a,c,d){return!b.isContinuousChart(d.layout)},uses:"sorting",items:{dimensions:{locked:function(a,b,c){return 1===c.getMeasures().length&&2===c.getDimensions().length&&0===a}}}}}},f={type:"items",component:"expandable-items",translation:"properties.addons",items:{dataHandling:{uses:"dataHandling"},refLines:{uses:"reflines"}}},{type:"items",component:"accordion",items:{data:{uses:"data",items:{dimensions:{items:{nullSuppression:{show:function(a,c,d){return!b.isContinuousChart(d.layout)}}}}}},sorting:e,addons:f,settings:d}}}),define("general.utils/array-util",[],function(){function a(a){return a&&"[object Array]"===Object.prototype.toString.call(a)}function b(a){return a&&"function"==typeof a}function c(c,d){var e,f;if(!a(c))throw"No valid items were specified.";if(!b(d))throw"No valid action function was specified.";if(Array.prototype.forEach)c.forEach(d);else for(e in c)f=c[e],d(f)}function d(b,c){if(!a(b))throw"No valid items were specified.";if(Array.prototype.indexOf)return b.indexOf(c)!==-1;for(var d=b.length;d--;)if(b[d]===c)return!0;return!1}function e(a,b){if(!(a&&b&&a.length&&b.length))return!1;var c,d=b.length;for(c=0;c<d;c++)if(a.indexOf(b[c])>-1)return!0;return!1}function f(a,b){if(!(a&&b&&a.length&&b.length))return!1;var c=a.indexOf(b[0]);if(c!==-1){for(var d=0;d<b.length;d++){var e=a.indexOf(b[d]);if(c>e)return!1;c=e}return!0}return!1}function g(a,b,c){if(c>=a.length)for(var d=c-a.length;1+d--;)a.push(void 0);a.splice(c,0,a.splice(b,1)[0])}function h(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function i(a,b){var c;for(c=0;c<a.length;++c)a[c]>=0&&a[c]>=b&&++a[c];a.push(b)}function j(a,b,c){var d;for(d=0;d<a.length;++d)a[d]>=0&&a[d]>=b&&++a[d];a.splice(c,0,b)}function k(a,b){var c,d=0;for(c=0;c<a.length;++c)a[c]>b?--a[c]:a[c]===b&&(d=c);return a.splice(d,1),d}function l(a,b){return a.length>b?a.slice(0,b):a}function m(a){if(!(a instanceof Array))throw new Error("Argument is not an Array.");return a.slice(0)}return{forEach:c,contains:d,move:g,swap:h,limit:l,indexAdded:i,indexAddedAt:j,indexRemoved:k,intersects:e,isOrderedSubset:f,copy:m}}),define("objects.utils/data-properties/listobject-util",["util"],function(a){"use strict";return{autoSortDimension:function(a,b){return a.qDef.qSortCriterias=[],a.qDef.autoSort=!0,b?b.forEach(function(b,c){a.qDef.qSortCriterias[c]={qSortByState:1,qSortByLoadOrder:1,qSortByNumeric:1,qSortByAscii:1}}):a.qDef.qSortCriterias[0]={qSortByState:1,qSortByLoadOrder:1,qSortByNumeric:1,qSortByAscii:1},a},createFieldDimension:function(a){return{qDef:{qFieldDefs:[a],qFieldLabels:[a],qSortCriterias:[]}}},createLibraryDimension:function(a){return{qLibraryId:a,qDef:{qSortCriterias:[]}}},createDefaultListBox:function(b,c){var d,e=a.extend(!0,{},b);for(e.qShowAlternatives=!0,d=0;d<e.qDef.qSortCriterias.length;++d)e.qDef.qSortCriterias[d].qSortByState=1;return c=c||(b.qDef.qFieldLabels&&b.qDef.qFieldLabels.length?b.qDef.qFieldLabels[0]:""),{qInfo:{qType:"listbox"},qListObjectDef:e,title:c,visualization:"listbox"}}}}),define("client.assets/tab-contents/fields/assets-directdiscovery-service",[],function(){"use strict";function a(a){return!!a.qTags&&a.qTags.indexOf("$dd_measure")!==-1}function b(a){return!!a.qTags&&a.qTags.indexOf("$dd_details")!==-1}function c(a){return!!a.qTags&&a.qTags.indexOf("$dd_dimension")!==-1}function d(a){return!!a.qTags&&a.qTags.indexOf("$directdiscovery")!==-1}function e(c){var d=c;return c&&(d=c.filter(function(c){return!a(c)&&!b(c)})),d}function f(d){var e="",f={qTags:d};return a(f)?e="DirectDiscovery.Measure":b(f)?e="DirectDiscovery.Details":c(f)&&(e="DirectDiscovery.Dimension"),e}return{isMeasure:a,isDetails:b,isDimension:c,removeMeasureAndDetailsFields:e,getTypeTranslationKey:f,isDirectDiscoveryField:d}}),define("client.assets/tab-contents/fields/derived-field-formatter-service",[],function(){function a(a){return a?a.split(b).join(""):""}var b=".autoCalendar";return{trimAutoCalendarName:a}}),define("client.assets/tab-contents/fields/assets-field-list-model",["objects.utils/data-properties/listobject-util","client.assets/tab-contents/fields/assets-directdiscovery-service","client.assets/tab-contents/fields/derived-field-formatter-service"],function(a,b,c){"use strict";function d(b){var d;return d=a.createFieldDimension(b.qName),a.autoSortDimension(d,[b]),{id:"newObject",args:{template:"filterpane",children:[a.createDefaultListBox(d,c.trimAutoCalendarName(b.qName))],init:{}}}}function e(a){for(var b=[],d=0;d<a.length;++d){var e=a[d];if(e.isDateField=g(e),e.isGeoField=h(e),b.push(e),e.qDerivedFieldData)for(var f=0;f<e.qDerivedFieldData.qDerivedFieldLists.length;++f)for(var i=e.qDerivedFieldData.qDerivedFieldLists[f],j=0;j<i.qFieldDefs.length;++j){var k=i.qFieldDefs[j];b.push({qName:k.qName,displayName:c.trimAutoCalendarName(k.qName),qSrcTables:e.qSrcTables,qTags:k.qTags,isDerived:!0,isDerivedFromDate:e.isDateField,sourceField:e.qName,derivedDefinitionName:i.qDerivedDefinitionName})}}return b}function f(a,b,e){var f=[];if(b)for(var g=0;g<b.qDerivedFieldLists.length;++g)for(var h=b.qDerivedFieldLists[g],i=0;i<h.qFieldDefs.length;++i){var j=h.qFieldDefs[i];f.push({id:j.qName,qName:j.qMethod,name:j.qName,displayName:c.trimAutoCalendarName(j.qName),qSrcTables:a.qSrcTables,srcTables:a.qSrcTables,qTags:j.qTags,tags:j.qTags,type:"field",isDerived:!0,isDerivedFromDate:e,getDropOption:d.bind(null,j),sourceField:a.qName,derivedDefinitionName:h.qDerivedDefinitionName})}return f}function g(a){return!!a.qDerivedFieldData&&(a.qTags.indexOf("$date")>-1||a.qTags.indexOf("$timestamp")>-1)}function h(a){return a.qTags.indexOf("$geoname")>-1}return{create:function(a){return a.map(function(a){var c=g(a),e=h(a);return{id:a.qName,name:a.qName,type:"field",isDateField:c,isGeoField:e,srcTables:a.qSrcTables,sourceField:a.sourceField,calendarTemplateName:a.derivedDefinitionName,getDropOption:d.bind(null,a),tags:a.qTags,icon:b.isDirectDiscoveryField(a)?"directdiscovery":"",iconTooltip:b.getTypeTranslationKey(a.qTags),derivedFields:a.qDerivedFieldData?f(a,a.qDerivedFieldData,c):[]}})},expand:e,createFromArray:function(a,b){var c,e=[];for(c=0;c<a.length;c++)b&&(a[c].qName=a[c][b]),e.push({name:a[c].qName,type:"field",getDropOption:d.bind(null,a[c])});return e},getTables:function(a){var b,c,d,e=a;for(d=[],b=0;b<e.length;++b)for(c=0;c<e[b].qSrcTables.length;++c)d.indexOf(e[b].qSrcTables[c])===-1&&d.push(e[b].qSrcTables[c]);return d}}}),define("objects.utils/data-properties/library-utils",["general.utils/array-util","client.assets/tab-contents/fields/assets-field-list-model"],function(a,b){"use strict";function c(c,d){var e,f,g=b.expand(a.copy(d));if(g)for(e=0;e<g.length;e++)if(f=g[e],f.qName===c)return f;return null}function d(a,b){var c,d;if(b)for(c=0;c<b.length;c++)if(d=b[c],d.qInfo.qId===a)return d;return null}function e(a,b){var c,d;if(b)for(c=0;c<b.length;c++)if(d=b[c],d.qInfo.qId===a)return d;return null}function f(c){return c.getFieldList().then(function(c){return b.expand(a.copy(c)).sort(function(a,b){return a.qName.toLowerCase().localeCompare(b.qName.toLowerCase())})})}function g(b){return b.getDimensionList().then(function(b){return a.copy(b).sort(function(a,b){return a.qData.title.toLowerCase().localeCompare(b.qData.title.toLowerCase())})})}function h(b){return b.getMeasureList().then(function(b){return a.copy(b).sort(function(a,b){return a.qData.title.toLowerCase().localeCompare(b.qData.title.toLowerCase())})})}return{findField:c,findLibraryDimension:e,findLibraryMeasure:d,getSortedFields:f,getSortedDimensions:g,getSortedMeasures:h}}),define("general.models/library/dimension",["core.models/base-object","core.models/app"],function(a,b){"use strict";var c;return c=a.extend("Dimension",{clone:function(){return this._super("CloneDimension")},getLinkedObjects:function(){return this.rpc("GetLinkedObjects","qItems",[])}},{listProperties:{qDimensionListDef:{qType:"dimension",qData:{title:"/qMetaDef/title",tags:"/qMetaDef/tags",grouping:"/qDim/qGrouping",info:"/qDimInfos"}}}}),c.get=function(a,c){function d(){return c.enigmaModel.getDimension(a)}return c=c||b.current,this.getModel(a,c.session,d)},c.create=function(b,d){return a.create.call(c,b,"CreateDimension",d)},c.remove=function(b,c){return a.remove(b,"DestroyDimension",c)},c}),define("extensions.qliktech/barchart/barchart-data",["core.utils/deferred","client.utils/property-resolver","objects.utils/data-properties/library-utils","general.models/library/dimension"],function(a,b,c,d){function e(b){function e(a){a>10?1!==b.getSorting()[0]&&b.changeSorting(1,0):0!==b.getSorting()[0]&&b.changeSorting(1,0)}var f,g=b.getDimensions(),h=b.getMeasures();if(1===g.length&&1===h.length){var i=g[0];return i.qLibraryId?d.getLayout(i.qLibraryId).then(function(a){if(a&&a.qDimInfos&&a.qDimInfos[0]){e(a.qDimInfos[0].qCardinal)}return i}):b.app.getFieldList().then(function(a){var b=c.findField(i.qDef.qFieldDefs[0],a);if(b){e(b.qCardinal)}return i})}return g.length>1&&1===h.length&&0!==(f=b.getSorting().indexOf(0))&&b.changeSorting(f,0),a.resolve()}function f(a){var b;a.getDimensions().length>1&&1===a.getMeasures().length&&0!==(b=a.getSorting().indexOf(0))&&a.changeSorting(b,0)}function g(a,c){var d=c.getDimensions(),e=c.getMeasures(),f=b.getValue(a,"color.mode");d.length>1&&a.color?a.color.persistent=!0:"byDimension"===f&&e.length>1?b.setValue(a,"color.mode","byMultiple"):"byExpression"===f&&0===e.length&&b.setValue(a,"color.mode","primary")}function h(a){return a>=2?1:15}return{measures:{min:1,max:h,add:function(a,b,c){return e(c).then(function(){return a.qSortBy.qSortByNumeric=-1,g(b,c),a})},move:function(a,b,c){f(c),g(b,c)},remove:function(a,b,c){var d=c.getDimensions();g(b,c),d.length>1&&"stacked"===b.barGrouping.grouping?(b.qHyperCubeDef.qMode="K",b.qHyperCubeDef.qAlwaysFullyExpanded=!0):1===d.length&&(b.qHyperCubeDef.qMode="S")}},dimensions:{min:1,max:function(a){return a>=2?1:2},add:function(a,b,c){return c.getDimensions().length>1&&"stacked"===b.barGrouping.grouping&&(b.qHyperCubeDef.qMode="K",b.qHyperCubeDef.qAlwaysFullyExpanded=!0),e(c).then(function(){return g(b,c),a})},move:function(a,b,c){c.getDimensions().length>1&&"stacked"===b.barGrouping.grouping&&(b.qHyperCubeDef.qMode="K",b.qHyperCubeDef.qAlwaysFullyExpanded=!0),f(c),g(b,c)},remove:function(a,b,c){var d=c.getDimensions();g(b,c),1===d.length&&(b.qHyperCubeDef.qMode="S")}}}}),define("client.utils/property-hypercube-helper",["client.utils/property-resolver"],function(a){return{getDimensions:function(b){return a.getValue(b,"qHyperCubeDef.qDimensions",[])},getNumDimensions:function(b){return a.getValue(b,"qHyperCubeDef.qDimensions.length",0)},getMeasures:function(b){return a.getValue(b,"qHyperCubeDef.qMeasures",[])},getNumMeasures:function(b){return a.getValue(b,"qHyperCubeDef.qMeasures.length",0)},getDimensionLayouts:function(b,c){var d=a.getValue(b,c?c+".qHyperCube":"qHyperCube",null);return d?d.qDimensionInfo:[]},getDimensionLayout:function(a,b,c){return this.getDimensionLayouts(b,c).filter(function(b){return a===b.cId})[0]},getMeasureLayouts:function(b,c){var d=a.getValue(b,c?c+".qHyperCube":"qHyperCube",null);return d?d.qMeasureInfo:[]},getMeasureLayout:function(a,b,c){return this.getMeasureLayouts(b,c).filter(function(b){return a===b.cId})[0]}}}),define("extensions.qliktech/barchart/barchart-explore-properties",["client.utils/property-hypercube-helper","objects.utils/continuous-utils"],function(a,b){return{type:"items",component:"accordion",items:{data:{uses:"data"},sort:{uses:"sort",show:function(a,c){return!b.isContinuousChart(c)},items:{dimensions:{locked:function(b,c){return 1===a.getNumMeasures(c)&&2===a.getNumDimensions(c)&&0===b}}}},presentation:{uses:"presentation",items:{showLabels:{ref:"dataPoint.showLabels",type:"boolean",translation:"properties.dataPoints.labelmode",component:"switch",options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}]},grouping:{ref:"barGrouping.grouping",type:"string",component:"item-selection-list",horizontal:!0,items:[{icon:"∫",component:"icon-item",labelPlacement:"bottom",translation:"properties.grouping.grouped",value:"grouped"},{icon:"ª",component:"icon-item",labelPlacement:"bottom",translation:"properties.grouping.stacked",value:"stacked"}],show:function(a,c){return a.qHyperCubeDef.qMeasures.length+a.qHyperCubeDef.qDimensions.length>2&&!b.isContinuousChart(c)},change:function(a){a.qHyperCubeDef.qDimensions.length>1&&"stacked"===a.barGrouping.grouping?(a.qHyperCubeDef.qMode="K",a.qHyperCubeDef.qAlwaysFullyExpanded=!0):a.qHyperCubeDef.qMode="S"}},orientation:{ref:"orientation",type:"string",component:"item-selection-list",horizontal:!0,items:[{component:"icon-item",icon:"º",labelPlacement:"bottom",translation:"properties.orientation.vertical",value:"vertical"},{icon:"Ω",component:"icon-item",labelPlacement:"bottom",translation:"Common.Horizontal",value:"horizontal"}],show:function(a,c){return!b.isContinuousChart(c)}}}},color:{uses:"color",items:{dimension:{items:{dimensionId:{ref:"color.dimensionId",type:"string",component:"dimension-radio-list",translation:"properties.colorDimensionId",show:function(b){return a.getNumDimensions(b)>1},change:function(a){a.color.mode="byDimension",a.color.auto=!1}}}}}}}}}),define("objects.views/charts/layout-engine",["general.utils/shapes/rect"],function(a){function b(){this._layoutComponents=[],this._componentSizes=[]}function c(a){var b=this._componentSizes.filter(function(b){return b.component===a})[0];b||(b={component:a},this._componentSizes.push(b)),b.rect=a.rect.clone()}function d(a){return this._componentSizes.filter(function(b){return b.component===a})[0]}function e(a,b,c,d,e){var f,g=this._layoutComponents.slice(),h=[{fn:"_reduceComponentRectBySpacingV",dock:["left","right"]},{fn:"_reduceComponentRectBySpacingH",dock:["top","bottom"]}];for("vertical"===d&&h.reverse(),g.sort(function(a,b){return(a.reductionOrder||1e3)-(b.reductionOrder||1e3)}),f=0;f<g.length;f++)g[f].perpendicularlyRelevantSpacing={top:0,left:0,right:0,bottom:0},g[f].preRelevantSizeCalculation&&g[f].preRelevantSizeCalculation();var i=a.clone();h.forEach(function(a){this._reducePreliminaryLayoutRectForComponents(g,i,b,c,function(b){return b&&a.dock.indexOf(b.dock)>=0})},this),h.forEach(function(a){this[a.fn](i,b,g,c)},this),e&&e()&&(i=a.clone(),h.forEach(function(a){this._reducePreliminaryLayoutRectForComponents(g,i,b,c,function(b){return b&&a.dock.indexOf(b.dock)>=0}),this[a.fn](i,b,g,c)},this)),h.forEach(function(d){this._reduceLayoutRectForComponents(g,a,b,i,c,function(a){return a&&d.dock.indexOf(a.dock)>=0})},this),h.forEach(function(d){this[d.fn](a,b,g,c)},this)}return b.prototype={addComponent:function(a){var b;b=this._layoutComponents,this.removeComponent(a),b.push(a)},removeComponent:function(a){var b,c;for(c=this._layoutComponents,b=0;b<c.length;++b)if(c[b]===a)return void c.splice(b,1)},_reduceLayoutRectForComponents:function(a,b,c,d,e,f){var g;for(g=0;g<a.length;++g)a[g]&&["left","right","bottom","top"].contains(a[g].dock)&&f(a[g])&&(a[g].calculateRelevantSize(b,c,d),a[g].isVisible(e)&&(a[g].relevantSize=Math.round(a[g].relevantSize),a[g].reduceLayoutRect(b)))},_reducePreliminaryLayoutRectForComponents:function(a,b,c,d,e){var f;for(f=0;f<a.length;++f)a[f]&&["left","right","bottom","top"].contains(a[f].dock)&&e(a[f])&&(a[f].calculatePreliminaryRelevantSize?a[f].calculatePreliminaryRelevantSize(b,c):a[f].calculateRelevantSize(b,c),a[f].isVisible(d)&&a[f].reduceLayoutRect(b))},_reduceComponentRectBySpacingH:function(a,b,c,d){var e,f;for(e=0;e<c.length;++e)(f=c[e].perpendicularlyRelevantSpacing)&&c[e].isVisible(d)&&(f.left>a.x&&a.x>=0&&(a.width-=f.left-a.x,a.x=f.left),f.right>b.width-a.x-a.width&&(a.width-=f.right-(b.width-a.x-a.width-b.x)))},_reduceComponentRectBySpacingV:function(a,b,c,d){var e,f;for(e=0;e<c.length;++e)(f=c[e].perpendicularlyRelevantSpacing)&&c[e].isVisible(d)&&(f.top>a.y&&a.y>=0&&(a.height-=f.top-a.y,a.y=f.top),f.bottom>b.height-a.y-a.height&&(a.height-=f.bottom-(b.height-a.y-a.height-b.y)))},_layoutComponent:function(a,b,c,d){a&&a.insertAdjacentTo(a.dock&&"center"!==a.dock?a.isVertical()?c.x:c.y:d,a.isVisible(b))},layout:function(b,f,g,h,i){b=new a(b.x,b.y,b.width,b.height),g=new a(g.x,g.y,g.width,g.height);var j,k,l,m,n,o=g.width/b.width,p=g.height/b.height;for(k=this._layoutComponents,k.sort(function(a,b){return"center"===a.dock?"center"===b.dock?0:-1:"center"===b.dock?1:a.layoutOrder-b.layoutOrder}),b=new a(b.x,b.y,b.width-4,b.height-4),l=new a(b.x,b.y,b.width,b.height),m={x:new a,y:new a},e.apply(this,[l,b,f,h,i]),l.x+=2,l.y+=2,m.x.set(l.x,l.y,l.width,l.height),m.y.set(l.x,l.y,l.width,l.height),j=0;j<k.length;++j)k[j].setLayoutToContainerRatios(o,p),this._layoutComponent(k[j],f,m,l),n=d.call(this,k[j]),k[j].updateSize(!n||n.rect.width!==k[j].rect.width||n.rect.height!==k[j].rect.height),c.call(this,k[j])}},b}),define("objects.views/charts/components/data-area",["./chart-component"],function(a){return a.extend({paint:function(a){this._super(a)}})}),define("objects.views/charts/components/axis/radial-axis-helper",["objects.views/charts/utils/matrix","general.utils/shapes/rect"],function(a){function b(b,e,j){var k,l,m,n,o,p,q,r,s=b.length>0?b[0].positions:[],t=e._style,u=e._radialOptions,v=new a,w=t.ticks.major.length*j,x=t.label.offset*j*20,y="far"===e.getAlignment()?"left":"right",z=[],A=Math.min(e.rect.height,e.rect.width),B=[],C=e._radius;if(m="left"===y?1:-1,w*=m,k=m>0?0:e.rect.width,l=0,k+=1*m/2,l+=e._padding.top,e.getShowLine()&&z.push({stroke:t.line.color,shape:{cx:e._centerPoint.x,cy:e._centerPoint.y,radius:C,radianOffset:0,start:u.start,end:u.end},type:"arc"}),e.getShowLabels())for(r=0;r<s.length;r++)n=(s[r]-0)/(A-0),p=g(n,e),q=h(p),q.r=q.r+x,q=i(q,e._centerPoint),o=f(n,e),q.angle=o,B.push(q),v.save(),v.translate(p.x+e._centerPoint.x,p.y+e._centerPoint.y),v.rotate(o),z.push({stroke:t.ticks.major.color,opacity:e.ticks[r].opacity,transform:v.elements,shape:{x1:0,x2:-w,y1:0,y2:0},type:"line"}),v.restore();if(k+=t.ticks.major.length*m,e._showLabels&&e._layoutMode>1)for(r=0;r<b.length;r++)z=z.concat(c(b[r],B,k,e)),k+=b[r].labelSpace*m;e._showTitle&&e._layoutMode>1&&(z=z.concat(d(e,t))),e._renderer.shapes=z,e._renderer.render()}function c(a,b,c,d){var e,f,g,h,i,j,k,l,m=a.labels,n=b,o=a.opacities,p=[],q=d._style;if(0!==(h=m?m.length:0)){for(i=h-1,l=0;l<h;l++)j=d.yMirrorMode?m[i-l]:m[l],e=d._renderer.getTextWidth(j,q.label.font),k=n[l],g=k.angle,
f=g-.1<3*Math.PI/2&&g+.1>3*Math.PI/2?"center":g<Math.PI/2||g>3*Math.PI/2?"left":"right",p.push({type:"text",fill:q.label.color,opacity:o?o[l]:1,shape:{text:j,x:k.x,y:k.y,maxWidth:k.x-e<0?k.x:k.x+e>d.rect.width?d.rect.width-k.x:e,height:void 0,maxNumLines:1,font:q.label.font,align:f,baseline:"middle"}});return p}}function d(a,b){var c=[],d=Math.min(a.rect.width,a.rect.height),f=e(a);return c.push({type:"text",fill:b.title.color,opacity:1,shape:{text:a._title,x:f.x,y:f.y+d*(.06+Math.min(d-300,0)/-300*.04),maxWidth:1.4*a._radius,maxNumLines:1,font:b.title.font,align:"center",baseline:"middle"}}),c}function e(a){return{x:a.rect.width/2,y:a.rect.height/2}}function f(a,b){var c=b._radialOptions;return Math.max(Math.min(a,1),0)*(c.end-c.start)+c.start}function g(a,b,c){var d=b._radialOptions;return i({a:a*(d.end-d.start)+d.start,r:b._radius},c)}function h(a){return{r:Math.sqrt(a.x*a.x+a.y*a.y),a:Math.atan2(a.y,a.x)}}function i(a,b){return b||(b={x:0,y:0}),{x:b.x+a.r*Math.cos(a.a),y:b.y+a.r*Math.sin(a.a)}}return{renderRadial:b,getPointOfValue:g,getPolPos:h,getCartPos:i,getAngleOfNormalizedValue:f}}),define("objects.views/charts/components/axis/axis",["jquery","../chart-component","objects.views/charts/components/axis/radial-axis-helper","objects.views/charts/utils/canvas-renderer","objects.views/charts/utils/matrix","general.utils/shapes/rect","general.utils/shapes/polygon","objects.views/charts/chart-style-service","client.utils/theme/modern/theme","core.utils/feature-flags"],function(a,b,c,d,e,f,g,h,i,j){"use strict";function k(){var a,b=this;if(a=this.getLevels()||[],!a.length&&!this._showTitle_internal)return void this._renderer.clear();this._cacheItems&&this._cacheItems.length&&(this._cacheItems[0].objectShapes?this._cacheItems.forEach(function(a){a.objectShapes[b.selectionIdentifier]=null}):this._cacheItems.forEach(function(a){a.clearShapes(b.selectionIdentifier)})),this.isRadial()?c.renderRadial(a,this,this._windowSizeMultiplier):this.isVertical()?p.apply(this,[a]):s.apply(this,[a,this.indicators])}function l(a,b,c,d){var f,h,i,j,k,l,m,n,o,p,q=a.labels,r=a.positions,s=Math.abs(this._fontHeight*Math.sin(c)),v=a.labelSpace,w=Math.abs(v/Math.sin(c)),x=Math.cos(c),y=this.yMirrorMode?-Math.PI/2:Math.PI/2,z=(new e).skew(y-c,0).scale(this._discreteSpacing*(this._groupSize||1)/this._fontHeight,1).translate(0,-d*this._fontHeight/2).rotate(-y),A=[],B=c<0?"right":"left";for(p="middle","near"===this.getAlignment()&&"center"!==B&&(B="left"===B?"right":"left"),o=0;o<q.length;o++)(f=r[o])<0||f>this.rect.width||(m=new e,m.translate(r[o],b+d*s/2),m.rotate(c),l="right"===B?Math.min((f+this._edgeBleed.left)/x,w):Math.min((this.rect.width-f+this._edgeBleed.right)/x,w),l-=2*s,A.push({type:"text",fill:this._style.label.color,opacity:a.opacities[o],transform:m.elements,shape:{text:q[o]||"",font:this._style.label.font,maxWidth:l,align:B,baseline:p}}),t(this._cacheItems,this.isDiscrete(),a.indecies,o)&&(h="left"===B?0:-Math.abs(v),i=this._fontHeight/2,j=[{x:h,y:-i},{x:h+v,y:-i},{x:h+v,y:i},{x:h,y:i}],n=new e,n.translate(r[o]-a.offsets[o],b+d*s/2),n.multiply(z),k=new g(n.transformPoints(j)),u(this._cacheItems,a.indecies[o],this.selectionIdentifier,k)));return A}function m(a,b){return a<b/2?a+=b/2-a:b/2>this._plotSize-a+this._padding.left&&(a-=b/2-(this._plotSize-a+this._padding.left)),a}function n(a,b,c){var e,g,h,i,j,k,l,n,o="near"===this.getAlignment()?"bottom":"top",p=a.align||"center",q=a.labels,r=a.positions,s=a.opacities,v=a.labelMode,x=this._style,y=a.widths,z=[];for(e=0;e<q.length;e++){if(n=y[e],a.labelsBetweenTicks){if(this.yMirrorMode&&(r[e+1]>this.rect.width||r[e]<0))continue;if(!this.yMirrorMode&&(r[e+1]<0||r[e]>this.rect.width))continue;if(k=Math.min(this.rect.width,Math.max(0,r[e])),l=Math.min(this.rect.width,Math.max(0,r[e+1]||(this.yMirrorMode?Number.MIN_VALUE:Number.MAX_VALUE))),g=k+("left"===p?this._labelPadding:-this._labelPadding),(n=Math.min(n,Math.abs(k-l)-this._labelPadding))<this._labelPadding+20)continue}else if((g=r[e])<-.5||g>this.rect.width+.5)continue;!this.isDiscrete()||v!==w||0!==e&&e!==q.length-1||(h=d.measureTextObject({type:"text",shape:{text:q[e]||"",x:g,y:b,maxWidth:y[e]-this._labelPadding,font:this._style.label.font,align:p,baseline:o}}).width,0===e&&g<h/2?g+=h/2-g:e===q.length-1&&h/2>this._plotSize-g&&(g-=h/2-(this._plotSize-g))),j=b+(v===w?0:1.5*this._fontHeight*(e%2)*c),t(this._cacheItems,this.isDiscrete(),a.indecies,e)&&(i=new f(r[e]-a.offsets[e]-a.fullWidths[e]/2,j-("bottom"===o?this._fontHeight*x.label.lineHeight:0),a.fullWidths[e],this._fontHeight*x.label.lineHeight),u(this._cacheItems,a.indecies[e],this.selectionIdentifier,i)),z.push({type:"text",fill:this._style.label.color,opacity:s?s[e]:1,_index:e,shape:{text:q[e]||"",x:g,y:j,maxWidth:n-this._labelPadding,font:this._style.label.font,align:p,baseline:o}})}if(!this.isDiscrete()&&z.length>0&&!a.labelsBetweenTicks){var A=z[0];h=d.measureTextObject(A).width,A.shape.x=m.apply(this,[A.shape.x,h]),A=z[z.length-1],h=d.measureTextObject(A).width,A.shape.x=m.apply(this,[A.shape.x,h])}return z}function o(a,b,c){var d,e,g,h,i,j=a.labels,k=a.positions,l=a.opacities,m=a.labelSpace,n=[],o=this._style;for(d=this._renderer.getFontHeight(o.label.font),h=k.length>1?Math.abs(k[0]-k[1]):this.rect.height,this.isDiscrete()||(h=0),g=0;g<j.length;g++)e=k[g],(e=Math.max(d/2,Math.min(this._padding.top+this._plotSize-d/2,e)))-.5<0||e+.5>this.rect.height||(t(this._cacheItems,this.isDiscrete(),a.indecies,g)&&(i=new f(b-("right"===c?m:0),k[g]-a.fullWidths[g]/2-a.offsets[g],m,a.fullWidths[g]),u(this._cacheItems,a.indecies[g],this.selectionIdentifier,i)),n.push({type:"text",fill:o.label.color,opacity:l?l[g]:1,shape:{text:j[g],x:b,y:e-h/2,maxWidth:m,height:h,maxNumLines:1,font:o.label.font,align:c,baseline:"middle"}}));return n}function p(a){var b,c,d,f,g=a[0]?a[0].positions:[],h=a[0]?a[0].opacities:[],i=this._style,j=this.isDiscrete()?0:i.ticks.major.length,k=new e,l="far"===this.getAlignment()?"left":"right",m=[];if(d="left"===l?1:-1,j*=d,b=d>0?0:this.rect.width,c=0,b+=1*d/2,c+=this._padding.top,this._showLine_internal&&m.push({stroke:i.line.color,shape:{x1:b,x2:b,y1:c-1,y2:c+this._plotSize},type:"line"}),!this.isDiscrete()&&this._showLabels_internal){if(this._showLabels_internal)for(f=0;f<g.length;f++)g[f]>=0&&g[f]<=this.rect.height&&m.push({stroke:i.ticks.major.color,opacity:h[f],shape:{x1:b,x2:b+j,y1:g[f],y2:g[f]},type:"line"});b+=i.ticks.major.length*d}if(this._showLabels_internal){for(b+=i.label.margin*d,a.reverse(),f=0;f<a.length;f++)a[f].labelMode!==v&&(m=m.concat(o.apply(this,[a[f],b,l])),b+=a[f].labelSpace*d);a.reverse()}this._showTitle_internal&&(k=new e,k.translate((d>0?b:0)+(d>0?this.rect.width-b:b)/2,this._padding.top+this._plotSize/2),k.rotate(.5*Math.PI*("right"===l?-1:1)),m.push({type:"text",fill:i.title.color,transform:k.elements,shape:{text:this._title||"",maxWidth:this._plotSize,font:i.title.font,align:"center",baseline:"middle"}})),this._renderer.shapes=m,this._renderer.render()}function q(a,b,c,d,e){if(b)for(var f=0;f<b.positions.length;f++)b.positions[f]>=0&&b.positions[f]<=this.rect.width&&a.push({stroke:e,opacity:b.opacities[f],shape:{x1:b.positions[f],x2:b.positions[f],y1:c,y2:c+d},type:"line"})}function r(a,b){var c=this._padding.left||0;a.push({stroke:this._style.line.color,shape:{x1:c-1,x2:c+this._plotSize,y1:b,y2:b},type:"line"})}function s(a,b){var c,d,e,f,g,h=!!a[0]&&a[0].labelsBetweenTicks,i=this._style.ticks.major.length,j="far"===this.getAlignment()?1:-1,k=[];if(i*=j,c=this._padding.left||0,d="near"===this.getAlignment()?this.rect.height-1:this.isDiscrete()&&this.isHorizontal()?-1:0,d+=y/2*j,r.call(this,k,d),this.isDiscrete()||(d+=y*j/2,h||(q.call(this,k,a[0],d,i,this._style.ticks.major.color),d+=i)),this._showLabels_internal)for(q.call(this,k,b,d,3,this._style.ticks.major.color),d+=this._style.label.margin*j,e=0;e<a.length;e++)a[e].labelMode!==v&&(h&&(i=a[0].labelSpace*j*(e+(a[e].outOfSyncWithLevelBelow?0:1)),f=d-this._style.label.margin*j-(a[e].outOfSyncWithLevelBelow?0:a[0].labelSpace*j*e),g=a.length>1&&e<a.length-1?this._style.ticks.minor.color:this._style.ticks.major.color,q.call(this,k,a[e],f,i,g)),k=a[e].labelMode===x?k.concat(l.apply(this,[a[e],d,a[e].radians,j])):k.concat(n.apply(this,[a[e],d,j])),a[e].labelSpace&&(d+=a[e].labelSpace*j));this._showTitle_internal&&k.push({type:"text",fill:this._style.title.color,shape:{x:c,y:j>0?d:0,width:this._plotSize,height:j>0?this.rect.height-d:d,text:this._title||"",font:this._style.title.font,align:"center",baseline:"middle"}}),this._renderer.shapes=k,this._renderer.render()}function t(a,b,c,d){return b&&a&&c&&a[c[d][0]]}function u(a,b,c,d){Array.isArray(b)?b.forEach(function(b){a[b].addShape(c,d)}):a[b].addShape(c,d)}var v=0,w=1,x=3,y=1;return b.extend("Axis",{init:function(b,c,e){this._super.apply(this,[b,a.extend(!0,{},{components:{title:{show:!0,showFlag:c.showFlag},labels:{show:!1,showFlag:c.showFlag}}},c),e]),this._fontHeight=20,this._titleShowFlag=c.titleShowFlag||null,this._showLabels=!0,this._showLabels_internal=!0,this._showLine=!0,this._showLine_internal=!0,this._showTitle=!1,this._dataIndex=0,this._radial=!1,this._relevantAngle=0,this._labelPadding=4,this._cacheItems=null,j.THEMING?this._styleService=i.initializeService("object."+c.parentType):this._styleService=h.getInstance(),this._style=this._getStyleObject(this._styleService),this._padding={top:0,bottom:0,left:0,right:0},this._renderer=new d(this.container),this._$renderAreaWrap&&this._$renderAreaWrap.addClass("qv-chart-component-axis"),this.innerRect=new f(0,0,0,0),this.renderers={axis:this._renderer},this.isDimension=c.isDimension},getLevels:function(){return[]},setSelectableShapes:function(a){this._cacheItems=a},setSelectedRanges:function(){},calculateValuePositionMappingInfo:function(){},_calculatePlotSize:function(a){var b,c,d=0;this.isRadial()?(b=Math.min(a.height,a.width),c=.4*b,this._relevantAngle=Math.abs(this._radialOptions.end-this._radialOptions.start),d=Math.tan(-this._relevantAngle/4+Math.PI/2)*b*.02,this._radius=c+d,this._centerPoint={x:a.width/2,y:a.height/2+4*d}):b=this.isVertical()?a.height-this._padding.top-this._padding.bottom:a.width-this._padding.left-this._padding.right,this._plotSize,this._plotSize=b},_calculateEdgeBleedAndPlotSize:function(a){this._edgeBleed={top:(this.isVertical(),1),bottom:this.isVertical()?1:0,left:this.isVertical()?1:Math.max(a.x,1),right:this.isVertical()?0:Math.max(0,this.outerRect.width-a.width-a.x)},this._calculatePlotSize(a)},preRelevantSizeCalculation:function(){this._isSizing=!0,this.updateNow(["properties"]),this._isVertical=this.isVertical(),this._style=this._getStyleObject(this._styleService,this._layoutMode,this.isDiscrete()),this._fontHeight=Math.ceil(this._renderer.getFontHeight(this._style.label.font));var a=this._isVertical;this._showTitle_internal=b.prototype.isVisible.call({show:this._showTitle&&!!this._title,_verticalLayoutMode:this._verticalLayoutMode,_horizontalLayoutMode:this._horizontalLayoutMode,isVertical:function(){return a},showFlag:null!==this._titleShowFlag?this._titleShowFlag:this.showFlag<<1},this._layoutMode),this._showTitle_internal&&(this._titleFontHeight=this._renderer.getFontHeight(this._style.title.font),this.relevantSize+=this._titleFontHeight*this._style.title.lineHeight)},calculatePreliminaryRelevantSize:function(a,b){var c,d=0,e=0,f=a[this.isVertical()?"height":"width"];this._isSizing=!0,this.relevantSize=0,this.preliminaryRelevantSize=0,this._preliminaryStatics=0,f<=0||(c=this.calculatePreliminaryLabelSpace(a,b),d=c.relevantLabelSize||0,e=c.relevantSpacing||0,this.isDiscrete()?this._preliminaryStatics+=y:this._preliminaryStatics+=this._style.ticks.major.length,d&&(this.preliminaryRelevantSize+=d,this.preliminaryRelevantSize+=this._style.label.margin),this._showTitle_internal&&(this._preliminaryStatics+=this._titleFontHeight*this._style.title.lineHeight),this.preliminaryRelevantSize+=this._preliminaryStatics,this.preliminaryRelevantSize=Math.ceil(this.preliminaryRelevantSize),this.perpendicularlyRelevantSpacing={top:0,left:this.yMirrorMode&&"near"===this.getAlignment()||!this.yMirrorMode&&"far"===this.getAlignment()?e:0,right:this.yMirrorMode&&"far"===this.getAlignment()||!this.yMirrorMode&&"near"===this.getAlignment()?e:0,bottom:0},this.relevantSize=this.preliminaryRelevantSize)},calculateRelevantSize:function(a,b,c){this._isSizing=!0,this._isVertical=this.isVertical(),this.relevantSize=0;var d=c||a,e=0,f=0;if(this.rect.set(d.x,d.y,d.width,d.height),this._calculationSize=d[this.isVertical()?"height":"width"],this.isVertical()?this._calculationSize-=this._padding.top+this._padding.bottom:this._calculationSize-=this._padding.left+this._padding.right,this._plotSize=this._calculationSize,0!==d.width){var g=this.calculateLabelSpace(a,b,c);return e=g.relevantLabelSize||0,f=g.relevantSpacing||0,e&&(this.relevantSize+=e,this.relevantSize+=this._style.label.margin),this.relevantSize+=this._preliminaryStatics,this.relevantSize=Math.ceil(this.relevantSize),this.perpendicularlyRelevantSpacing={top:0,left:this.yMirrorMode&&"near"===this.getAlignment()||!this.yMirrorMode&&"far"===this.getAlignment()?f:0,right:this.yMirrorMode&&"far"===this.getAlignment()||!this.yMirrorMode&&"near"===this.getAlignment()?f:0,bottom:0},this._isSizing=!1,this}},insertAdjacentTo:function(a,b){if(this._super(a,b),!this.isDiscrete())switch(this.dock){case"top":this.rect.y+=1;break;case"bottom":this.rect.y-=1}},_getStyleObject:function(a,b,c){var d=a.layoutMap[b]||"medium",e=c?".discrete":"";return j.THEMING?{backgroundColor:a.getStyle("","backgroundColor"),label:{lineHeight:1.4,color:a.getStyle("axis.label.name","color"),margin:4,offset:1,font:"normal "+a.scaleFontSize(a.getStyle("axis.label.name","fontSize"),b,e)+" 'QlikView Sans'"},ticks:{major:{color:a.getStyle("axis.line.major","color"),length:8},minor:{color:a.getStyle("axis.line.minor","color"),length:8}},line:{color:a.getStyle("axis.line.major","color")},title:{lineHeight:1.4,font:"normal "+a.getStyle("axis.title","fontSize")+" 'QlikView Sans'",color:a.getStyle("axis.title","color")}}:{backgroundColor:a.getValue("",null,"backgroundColor"),label:{lineHeight:1.4,color:a.getValue("","axis.label","color"),margin:a.getValue("","axis.label","margin"),offset:1,font:a.getFont("","axis.label"+e,d)},ticks:{major:{color:a.getValue("","axis.tick.major","color"),length:a.getValue("","axis.tick.major","length")},minor:{color:a.getValue("","axis.tick.minor","color"),length:a.getValue("","axis.tick.minor","length")}},line:{color:a.getValue("","axis.line","color")},title:{lineHeight:1.4,font:a.getFont("","axis.title",d),color:a.getValue("","axis.title","color")}}},isVisible:function(){return this._super.apply(this,[].slice.call(arguments))&&this._showSubcomponents},setShowLabels:function(a){this._showLabels_internal=a,this._showLabels=a},getShowLabels:function(){return this._showLabels},getSpacingMode:function(){},setShowLine:function(a){this._showLine_internal=a,this._showLine=a},getShowLine:function(){return this._showLine},setShowStrategy:function(a){this._showSubcomponents="none"!==a,this._showTitle=["all","title"].contains(a),this._showTitle_internal=this._showTitle,this.components.title.show=this._showSubcomponents&&["all","title"].contains(a),this._showLabels=["all","labels"].contains(a),this._showLabels_internal=this._showLabels,this.components.labels.show=this._showSubcomponents&&["all","labels"].contains(a)},getShowStrategy:function(){return this._showSubcomponents},setTitle:function(a){this._title=a},setLabelMode:function(a){this._explicitLabelMode=a},setLabels:function(a){this._explicitLabels=a},setCurrentDataIndices:function(a){this._currentDataIndices=Array.isArray(a)?a:[a]},setDataIndices:function(a){this._dataIndices=Array.isArray(a)?a:[a]},setDataRange:function(){},setOffset:function(){},setInnerOffset:function(){},getInnerOffset:function(){},getNumDiscreteUnits:function(){},setNumDiscreteUnits:function(){},getNumDiscreteUnitsInView:function(){},setMaxDiscreteUnitSize:function(){},setMinDiscreteUnitSize:function(){},setUnitAlignment:function(){},_updateProperties:function(){var a=this.getType().indices;return this._formatter=1===a.length&&this.measureFormatters.length?this.measureFormatters[a[0]]:this.combinedMeasuresFormatter||this._defaultFormatter,this.container.setAttribute("data-type",this.isDiscrete()?"discrete":"continuous"),this},updateSize:function(){this._super(),this._calculateEdgeBleedAndPlotSize(this.rect),this._renderer.edgeBleed=this._edgeBleed,this.innerRect=new f(this.rect.x+this._padding.left,this.rect.y+this._padding.top,this.rect.width-this._padding.left-this._padding.right,this.rect.height-this._padding.top-this._padding.bottom),this._isVertical=this.isVertical()},paint:function(){return k.apply(this,[]),this.fire("rendered"),this},isDiscrete:function(){return!1},getPositionOfValue:function(){},getAngleOfValue:function(){},getValueOfPosition:function(){},getType:function(){return{type:this.isDimension||this.isDiscrete()?"dimension":"measure",indices:this._dataIndices||[0],current:this._currentDataIndices||[0]}},setPadding:function(a,b,c,d){this._padding={top:a>0?a:0,right:b>0?b:0,bottom:c>0?c:0,left:d>0?d:0}},getPadding:function(){return this._padding},isVertical:function(){switch(this.options.dock){case"left":case"right":return!0;case"center":return"vertical"===this._orientation;default:return!1}},setOrientation:function(a){this._orientation=a},setAlignment:function(a){this._align=a},getAlignment:function(){switch(this.options.dock){case"left":case"top":return"near";case"center":return this._align;default:return"far"}},setRadial:function(a,b){this._radial=a,this._radialOptions=b},isRadial:function(){return this._radial}})}),define("objects.views/charts/components/axis/discrete-axis",["./axis","general.utils/shapes/rect"],function(a,b){"use strict";function c(a){var b=this._cacheItems;return b&&a&&a.some(function(a){return b[a]&&b[a].selected})?1:this._globalAlpha}function d(a,b,d){var e,f,g=this.isHorizontal(),h=[],i=[],j=[],k=[],l=[],m=[],n=[];for(e=0;e<a.length;e+=1)if(f={center:this.getPositionOfValue(e,b),width:this.getWidthOfValue(e,b)},!(f.width>=2*this._discreteSpacing&&(f.center-this._discreteSpacing+f.width/2<0||f.center+this._discreteSpacing-f.width/2>d)||f.width<2*this._discreteSpacing&&(f.center<0||f.center>d))){if(k.push(f.width),g&&f.center+f.width/2>d?h.push(Math.min(d,d-(f.center-f.width/2))):g&&f.center-f.width/2<0?h.push(Math.min(d,f.width/2+f.center)):h.push(Math.min(d,f.width)),f.width>this._discreteSpacing){var o=Math.max(1,Math.min(f.center,d-1));i.push(o),j.push(o-f.center)}else i.push(f.center),j.push(0);l.push(a[e].label),m.push(a[e].cacheIndex?a[e].cacheIndex:0),n.push(c.apply(this,[a[e].cacheIndex]))}return{labels:l,widths:h,positions:i,indecies:m,opacities:n,offsets:j,fullWidths:k}}function e(a){var b=a.match(/[\u4E00-\u9FFF]/g);return b=b?b.length:0,{latin:a.length-b,cjk:b}}function f(a,b,c,d,g,h){if(!a||!a.length)return[];var i,j,k,l,m,n,o=[];for(i=0;i<a.length;i++)j=a[i],k={},l="",m=null,"object"==typeof j?(l=j.label,m=j.children?f(j.children,b,c+1,k,g,h):null,k.cacheIndex="cacheIndex"in a[i]?a[i].cacheIndex:[],k.group=j.group===!0,j.id&&(h[j.id]=k)):l=j,k.label=l||"",k.parent=d,n=e(k.label),m&&m.length&&(k.children=m),o.push(k),b[c]||(b[c]={data:[]},b[c].show=!(g&&g[c]&&g[c].show===!1||b[c].silo),b[c].qApprMaxGlyphCount=g&&g[c]&&g[c].qApprMaxGlyphCount||10,b[c].characterRatios={latin:0,cjk:0},b[c].groupSize=g&&g[c]?g[c].groupSize:void 0),b[c].data.push(k),b[c].characterRatios.latin+=n.latin,b[c].characterRatios.cjk+=n.cjk;return o}function g(a){for(var b=a.parent,c=[];b;)b.collapseChildren||c.push(b),b=b.parent;return c}function h(a,b){var c,d,e,f,h,i,j,k,l=a[a.length-1].data;for(l[0].distanceFrom=b/2,l[0].distanceTo=l[0].distanceFrom+1,c=g(l[0]),j=c.filter(function(a){return a.group})[0],f=1;f<l.length;f++){if(i=l[f-1].distanceTo,d=g(l[f]),(k=d.filter(function(a){return a.group})[0])!==j){for(h=0;h<d.length&&(d[h]!==c[h]||!(d[h]<0||d[h].group));h++);i+=b*h,j=k,c=d}l[f].distanceFrom=i,l[f].distanceTo=l[f].distanceFrom+1}if(a.length>1)for(f=a.length-2;f>=0;f--)for(e=a[f].data,h=0;h<e.length;h++)e[h].distanceFrom=e[h].children[0].distanceFrom,e[h].distanceTo=e[h].children[e[h].children.length-1].distanceTo}function i(a,b,c,d){var e=b.getTextWidth("客",c),f=a<=24?b.getTextWidth("m",c):b.getAverageLetterWidth(c);return d?a*(e*d.cjk+f*d.latin):a*f}return a.extend("DiscreteAxis",{init:function(){this._super.apply(this,[].slice.call(arguments)),this._unitsOffset=0,this._innerOffset=0,this._shrinkToFitThreshold=arguments[1]&&null!==arguments[1].shrinkToFitThreshold?arguments[1].shrinkToFitThreshold:.85,this._maxDiscreteUnitSize=null,this._minDiscreteUnitSize=null,this._alignmentOffset=0,this._unitAlignment="center",this._angle1=-40,this._angle2=-90},setYMirrorMode:function(a){this._super(a),a?(this._angle1=40,this._angle2=90):(this._angle1=-40,this._angle2=-90)},updateSize:function(){this._super(),1===this._numDiscrete?this._discreteSpacing=Math.min(this._discreteSpacing,this._plotSize/this._numDiscrete):this._discreteSpacing-=(this._preliminarySize-this._plotSize)/(this._numUnitsInView||1),this._alignmentOffset=this._getAlignmentOffset(this._unitAlignment,this._plotSize),this.extendedRect=new b(this.rect.x-this._edgeBleed.left,this.rect.y-this._edgeBleed.top,this.rect.width+this._edgeBleed.left+this._edgeBleed.right,this.rect.height+this._edgeBleed.top+this._edgeBleed.bottom)},updateLevels:function(){var a=this._oldLevels;this._levels.forEach(function(b,c){b.labelSpace=a[c].labelSpace,b.labelMode=a[c].labelMode,b.radians=a[c].radians,b.show=a[c].show})},setLabelLevelVisibility:function(a){this._labelLevelVisibility=a,this._levels&&this._levels.forEach(function(b,c){b.show=a[c]!==!1})},_getPerpendicularExtensionForTiltedLabels:function(a,b,c,d){var e,f=this._angle1*Math.PI/180,g=Math.abs(Math.sin(f))*a.longestLabelWidth,h=0;return g=Math.min(d,g),e=Math.abs(Math.cos(f))*g,e=Math.max(e-this._discreteSpacing/2,0),"bottom"===this.dock?(e=Math.max(e-this._alignmentOffset,0))>b.x&&(h=e-b.x):"top"===this.dock&&(e=Math.max(e-("center"===this._unitAlignment?this._alignmentOffset:this._getAlignmentOffset("far"===this._unitAlignment?"near":"far")),0))>c.width-b.x-b.width&&(h=e-(c.width-c.x-b.x-b.width)),h},_getLabelMode:function(a,b,c){var d,e=a.qApprMaxGlyphCount;return this._showLabels&&"none"!==this._explicitLabelMode?this._explicitLabelMode&&"auto"!==this._explicitLabelMode?"none"===this._explicitLabelMode?0:"tilted"===this._explicitLabelMode?3:1:b&&this.isHorizontal()&&a.data&&a.data.length&&(d=i(e,this._renderer,this._style.label.font,a.characterRatios),a.groupSize&&(c*=a.groupSize),c<d)?3:1:0},preRelevantSizeCalculation:function(){this._super();var a,b=this._levels?this._levels.filter(function(a){return a.show!==!1}):[],c=b.length,d=this.outerRect[this.isVertical()?"width":"height"]/4,e=0,f=0;if(this.isVisible()){for(a=0;a<c;a++)b[a].longestLabelWidth=i(b[a].qApprMaxGlyphCount,this._renderer,this._style.label.font,b[a].characterRatios),e+=b[a].longestLabelWidth;for(a=0;a<c;a++)b[a].labelSizeRatio=Math.min(1/c,b[a].longestLabelWidth/Math.min(e,d)),f+=b[a].labelSizeRatio;f<1&&c>1?b[0].labelSizeRatio===1/c?b[0].labelSizeRatio+=1-f:b[1].labelSizeRatio===1/c&&(b[1].labelSizeRatio+=1-f):1===c&&(b[0].labelSizeRatio=1)}},calculatePreliminaryLabelSpace:function(a,b){var c,d=this._hideMyLabels,e=this._levels?this._levels.filter(function(a){return a.show!==!1&&!d}):[],f=e.length,g=this.outerRect[this._isVertical?"width":"height"]/4,h=this._fontHeight*this._style.label.lineHeight,i=0,j=0,k=0;if(this._preliminarySize=a[this._isVertical?"height":"width"],this._calculateDiscreteUnits(this._preliminarySize),this.isVisible())for(c=0;c<f;c++){e[c].labelMode=this._getLabelMode(e[c],c===e.length-1,this._discreteSpacing);var l=0;switch(e[c].labelMode){case 1:var m=Math.min(e[c].labelSizeRatio*g,e[c].longestLabelWidth);e[c].labelSpace=this.isHorizontal()?h:Math.min(e[c].labelSizeRatio*g,e[c].longestLabelWidth),j=Math.max(0,m-e[c].labelSpace);break;case 3:e[c].radians=this._angle1*Math.PI/180,l=this._getPerpendicularExtensionForTiltedLabels(e[c],a,b,g*e[c].labelSizeRatio),l>a.width/5&&(e[c].radians=this._angle2*Math.PI/180),e[c].labelSpace=Math.abs(Math.sin(e[c].radians))*e[c].longestLabelWidth+Math.abs(this._fontHeight*Math.sin(e[c].radians)*2),e[c].labelSpace=Math.min(j+e[c].labelSizeRatio*g+Math.abs(this._fontHeight*Math.sin(e[c].radians)/2),e[c].labelSpace);break;default:e[c].labelSpace=0}3===e[c].labelMode&&(i=Math.max(i,Math.min(a.width/3,Math.ceil(Math.cos(e[c].radians)*e[c].labelSpace))),i=Math.max(i-this._discreteSpacing/2,0),"bottom"===this.dock?i=Math.max(i-this._alignmentOffset,0):"top"===this.dock&&(i=Math.max(i-("center"===this._unitAlignment?this._alignmentOffset:this._getAlignmentOffset("far"===this._unitAlignment?"near":"far")),0)),i=Math.ceil(i)),k+=e[c].labelSpace}return i>0&&("bottom"===this.dock&&i>a.x?this._preliminarySize=this._preliminarySize-(i-a.x):"top"===this.dock&&i>b.width-a.x-a.width&&(this._preliminarySize=this._preliminarySize-(i-(b.width-b.x-a.x-a.width))),this._calculateDiscreteUnits(this._preliminarySize)),this.fire("numDiscreteUnitsChanged"),this.fire("numDiscreteUnitsInViewChanged"),this._showLabels_internal=this._showLabels&&e&&e.some(function(a){return 0!==a.labelMode}),this._preliminaryRelevantSize={relevantLabelSize:k,relevantSpacing:i},this._preliminaryRelevantSize},calculateLabelSpace:function(){return this.updateNow(["properties"]),this._preliminaryRelevantSize},setDataRange:function(a,b){var c,d,e,g;if(this._levels&&this._levels.length&&(this._oldLevels=this._levels.map(function(a){return{labelMode:a.labelMode,labelSpace:a.labelSpace,radians:a.radians,show:a.show,groupSize:a.groupSize}})),this._levels=[],this._labelIds={},f(a,this._levels,0,-1,b,this._labelIds),e=this._levels.length>1?1:0,this._levels&&this._levels.length){h(this._levels,e);for(var i=0;i<this._levels.length;i++)this._levels[i].characterRatios&&(g=this._levels[i].characterRatios.latin+this._levels[i].characterRatios.cjk||1,this._levels[i].characterRatios.latin=this._levels[i].characterRatios.latin/g,this._levels[i].characterRatios.cjk=this._levels[i].characterRatios.cjk/g);c=this._levels[this._levels.length-1].data,d=c[c.length-1].distanceTo+e/2,this._numDiscrete=c.length,this._numDiscrete=d||0,this._explicitNumDiscrete&&(this._numDiscrete=this._explicitNumDiscrete,this._numDiscrete=this._explicitNumDiscrete)}return this},setOffset:function(a){if(this._unitsOffset!==a)return this._unitsOffset=a,this.invalidateProperties(),this.invalidateDisplay("setOffset"),this.fire("changed"),this},getOffset:function(){return this._unitsOffset},setInnerOffset:function(a){this._innerOffset=a},getInnerOffset:function(){return this._innerOffset||0},getNumDiscreteUnits:function(){return this._numDiscrete},setNumDiscreteUnits:function(a){this._explicitNumDiscrete=a},getNumDiscreteUnitsInView:function(){return this._numUnitsInView},setMaxDiscreteUnitSize:function(a){this._maxDiscreteUnitSize=a},setMinDiscreteUnitSize:function(a){this._minDiscreteUnitSize=a},setUnitAlignment:function(a){this._unitAlignment=a},isDiscrete:function(){return!0},setLockedInfo:function(a){this._lockedInfo=a},getLevels:function(){var a,b,c=[];if(this._levels&&this._levels.length)for(b=0;b<this._levels.length;b++)this._levels[b].show&&(a=d.call(this,this._levels[b].data,b,this._plotSize),a.labelMode=this._levels[b].labelMode,a.labelSpace=this._levels[b].labelSpace,a.radians=this._levels[b].radians,c.push(a));return c},calculateValuePositionMappingInfo:function(){this._calculateDiscreteUnits(this._plotSize)},getDiscreteSpacing:function(){return this._discreteSpacing},getPositionOfValue:function(a,b){var c,d,e=this._levels.length-1;void 0!==b&&(e=Math.min(this._levels.length-1,Math.max(0,b))),c=this._levels[e].data,d=c[a];var f=d.distanceFrom+.5*(d.distanceTo-d.distanceFrom)+this._innerOffset-this._unitsOffset,g=f*this._discreteSpacing+this._alignmentOffset;return!this._isVertical&&this.yMirrorMode?this._plotSize-g:g},getWidthOfValue:function(a,b){var c,d=this._levels.length-1;return void 0!==b&&(d=Math.min(this._levels.length-1,Math.max(0,b))),c=this._levels[d].data,(c[a].distanceTo-c[a].distanceFrom)*this._discreteSpacing},getPositionOfId:function(a){var b=this._labelIds[a]||this._labelIds[a.split(";").reverse().slice(-1).reverse().join(";")];if(!b)return 0;var c=b.distanceFrom+.5*(b.distanceTo-b.distanceFrom)+this._innerOffset-this._unitsOffset,d=c*this._discreteSpacing+this._alignmentOffset;return!this._isVertical&&this.yMirrorMode?this._plotSize-d:d},getWidthOfId:function(a){var b=this._labelIds[a]||this._labelIds[a.split(";").reverse().slice(-1).reverse().join(";")];return b?(b.distanceTo-b.distanceFrom)*this._discreteSpacing:0},getValueOfPosition:function(a){var b,c,d,e,f=this._levels[0].data,g=f.length;for(a=!this._isVertical&&this.yMirrorMode?this._plotSize-a:a,d=0;d<g;d+=1)if(e=f[d],b=(e.distanceFrom+this._innerOffset-this._unitsOffset)*this._discreteSpacing,c=b+(e.distanceTo-e.distanceFrom)*this._discreteSpacing,a>=b&&a<=c)return e.label;return""},_calculateDiscreteUnits:function(a){this._discreteSpacing=Math.max(null!==this._minDiscreteUnitSize?this._minDiscreteUnitSize:0,a/this._numDiscrete),null!==this._maxDiscreteUnitSize&&(this._discreteSpacing=Math.min(this._maxDiscreteUnitSize,this._discreteSpacing)),(1===this._numDiscrete||this._numDiscrete*this._discreteSpacing>a&&this._numDiscrete*this._discreteSpacing*this._shrinkToFitThreshold<a)&&(this._discreteSpacing=Math.min(this._discreteSpacing,a/this._numDiscrete)),this._alignmentOffset=this._getAlignmentOffset(this._unitAlignment,a),this._numUnitsInView=Math.min(this._numDiscrete,Number((a/this._discreteSpacing).toFixed(5)))},_getAlignmentOffset:function(a,b){var c=null!==this._maxDiscreteUnitSize&&this._discreteSpacing<b/this._numDiscrete?.5*(b-this._numDiscrete*this._discreteSpacing):0;return"near"===a?0:"far"===a?2*c:c}})}),define("objects.views/charts/utils/scale-utils",[],function(){"use strict";function a(){var a,b,c,d;a=0===this.explicitPlotMax?1:y.getMagnitude(this.explicitPlotMax),b=this.explicitPlotMax,c=this.maxNumIntervals<2?b-a:b-2*a,c=Math.ceil(c/a)*a,d=b-c,this.tickDataSpacing=Math.max(d/this.maxNumIntervals,this.minTickDataSpacing),this.tickDataSpacingNN=Math.max(a/10,y.getNiceNumber(this.tickDataSpacing)),this.plotMax=b,this.plotMin=c,this.plotRange=d,this.maxNumIntervals<1&&(this.tickBaseValue=this.plotMin)}function b(){var a,b,c,d;a=0===this.explicitPlotMin?1:y.getMagnitude(this.explicitPlotMin),c=this.explicitPlotMin,b=this.maxNumIntervals<2?c+a:c+2*a,b=Math.floor(b/a)*a,d=b-c,this.tickDataSpacing=Math.max(d/this.maxNumIntervals,this.minTickDataSpacing),this.tickDataSpacingNN=Math.max(a/10,y.getNiceNumber(this.tickDataSpacing)),this.plotMax=b,this.plotMin=c,this.plotRange=d,this.maxNumIntervals<1&&(this.tickBaseValue=this.plotMax-this.tickDataSpacingNN)}function c(){null!==this.explicitPlotMax&&this.explicitPlotMax<this.usedDataMin?a.call(this):null!==this.explicitPlotMin&&this.explicitPlotMin>this.usedDataMax&&b.call(this)}function d(){this.plotMax=this.plotMin=this.tickBaseValue=this.usedDataMin,this.plotRange=0,this.tickDataSpacing=this.tickDataSpacingNN=0===this.usedDataMin?1:Math.abs(this.usedDataMin),this.tickMaxIndex=this.tickMinIndex=0}function e(){if(0===this.usedDataMax)this.maxNumIntervals<2?(this.plotMin=0,this.plotMax=1):(this.plotMin=-1,this.plotMax=1),this.plotRange=this.plotMax-this.plotMin,this.tickDataSpacing=Math.max(this.plotRange/this.maxNumIntervals,this.minTickDataSpacing),this.tickDataSpacingNN=Math.max(.1,y.getNiceNumber(this.tickDataSpacing)),this.tickMinIndex=Math.ceil(this.plotMin/this.tickDataSpacingNN),this.tickMaxIndex=Math.floor(this.plotMax/this.tickDataSpacingNN);else{var a=h(Math.abs(this.usedDataMax),this.maxNumIntervals);this.usedDataMax>0?(this.plotMax=a.max,this.plotMin=a.min,this.tickBaseValue=a.tickBaseValue):(this.plotMax=-a.min,this.plotMin=-a.max,
this.tickBaseValue=-a.tickBaseValue),this.plotRange=this.plotMax-this.plotMin,this.tickDataSpacing=Math.max(this.plotRange/this.maxNumIntervals,this.minTickDataSpacing),this.tickDataSpacingNN=Math.max(a.magnitude/10,y.getNiceNumber(this.tickDataSpacing)),this.tickMinIndex=Math.floor((this.plotMin-this.tickBaseValue)/this.tickDataSpacingNN),this.tickMaxIndex=Math.floor((this.plotMax-this.tickBaseValue)/this.tickDataSpacingNN)}}function f(){0===this.explicitPlotMax?(this.plotMax=0,this.plotMin=-1,this.plotRange=this.plotMax-this.plotMin,this.tickDataSpacingNN=Math.max(.1,y.getNiceNumber(this.plotRange/this.maxNumIntervals))):a.call(this)}function g(){0===this.explicitPlotMin?(this.plotMax=1,this.plotMin=0,this.plotRange=this.plotMax-this.plotMin,this.tickDataSpacingNN=Math.max(.1,y.getNiceNumber(this.plotRange/this.maxNumIntervals))):b.call(this)}function h(a,b){var c,d,e=y.getMagnitude(a),f=a/e,g=Math.floor(f),h=Math.round(f),i=0;return b<2?(c=g*e,d=(g+1)*e,b<1&&(i=c)):(c=(h-1)*e,d=(h+1)*e),{min:c,max:d,tickBaseValue:i,magnitude:e}}function i(){null!==this.explicitPlotMin&&null!==this.explicitPlotMax?d.call(this):null===this.explicitPlotMin&&null===this.explicitPlotMax?e.call(this):null===this.explicitPlotMin&&null!==this.explicitPlotMax?f.call(this):g.call(this)}function j(a,b,c){void 0===a&&(a=null!==this.explicitPlotMin),void 0===b&&(b=null!==this.explicitPlotMax),this.tickDataSpacingNN=c?y.getGoodNumber(this.tickDataSpacing):y.getNiceNumber(this.tickDataSpacing),u.apply(this,[a,b])}function k(){var a,b,c,d;if(j.call(this),a=this.tickMaxIndex-this.tickMinIndex,b=(this.plotMaxCanBeTuned?this.usedDataMax:this.plotMax)-(this.plotMinCanBeTuned?this.usedDataMin:this.plotMin),this.spaceUseFactor=b/this.plotRange,(d=this.plotSize*this.tickDataSpacingNN/this.plotRange<this.minTickSpacingInPixel||this.spaceOptimizingEnabled&&this.spaceUseFactor<this.spaceUseLimit)&&this.maxNumIntervals>=5){for(c=0;this.tickDataSpacing<=this.absMax&&d;)this.tickDataSpacing=Math.max(1.1*this.tickDataSpacingNN,this.minTickDataSpacing),j.call(this),b=(this.plotMaxCanBeTuned?this.usedDataMax:this.plotMax)-(this.plotMinCanBeTuned?this.usedDataMin:this.plotMin),this.spaceUseFactor=b/this.plotRange,d=this.plotSize*this.tickDataSpacingNN/this.plotRange<this.minTickSpacingInPixel||this.spaceOptimizingEnabled&&this.spaceUseFactor<this.spaceUseLimit,c++;if(!d)return}for(this.tickDataSpacing=Math.max(this.usedDataRange/this.maxNumIntervals,this.minTickDataSpacing),(d||a<=2&&this.maxNumIntervals>=2*a)&&j.apply(this,[void 0,void 0,!0]),b=(this.plotMaxCanBeTuned?this.usedDataMax:this.plotMax)-(this.plotMinCanBeTuned?this.usedDataMin:this.plotMin),this.spaceUseFactor=b/this.plotRange,d=this.plotSize*this.tickDataSpacingNN/this.plotRange<this.minTickSpacingInPixel||this.spaceOptimizingEnabled&&this.spaceUseFactor<this.spaceUseLimit,c=0;this.tickDataSpacing<=this.absMax&&d;)this.tickDataSpacing=Math.max(1.1*this.tickDataSpacingNN,this.minTickDataSpacing),j.apply(this,[void 0,void 0,!0]),b=(this.plotMaxCanBeTuned?this.usedDataMax:this.plotMax)-(this.plotMinCanBeTuned?this.usedDataMin:this.plotMin),this.spaceUseFactor=b/this.plotRange,d=this.plotSize*this.tickDataSpacingNN/this.plotRange<this.minTickSpacingInPixel||this.spaceOptimizingEnabled&&this.spaceUseFactor<this.spaceUseLimit,c++}function l(a){a?(this.tickDataSpacingNN=y.getGoodNumber(this.absMax),this.tickBaseValue=-this.tickDataSpacingNN,this.plotMin=null===this.explicitPlotMin?-this.tickDataSpacingNN:this.explicitPlotMin,this.plotMax=null===this.explicitPlotMax?this.tickDataSpacingNN:this.explicitPlotMax,this.tickMinIndex=null===this.explicitPlotMin?0:1,this.tickMaxIndex=(this.explicitPlotMax,1),this.tickDataSpacingNN=2*this.tickDataSpacingNN):(this.plotMax=this.usedDataMax,this.plotMin=this.usedDataMin,this.plotRange=this.plotMax-this.plotMin,this.tickMinIndex=0,this.tickMaxIndex=0,this.tickDataSpacingNN=y.getNiceNumber(this.absMax),this.tickDataSpacingNN===this.absMax&&(this.tickDataSpacingNN=y.getNiceNumber(1.1*this.absMax)))}function m(){var a;this.tickDataSpacingNN=y.getNiceNumber(this.tickDataSpacing),this.plotMin=this.usedDataMin,this.plotMax=this.usedDataMax,this.plotRange=this.plotMax-this.plotMin,this.tickMinIndex=0,this.tickMaxIndex=0,(this.usedDataMax<0||this.usedDataMin>0)&&(a=y.getSmallNiceNumber(this.plotRange),this.tickBaseValue=Math.ceil(this.plotMin/a)*a)}function n(){var a,b,c,d,e,f;for(c=this.usedDataMax>=-this.usedDataMin,a=c||null!==this.explicitPlotMin,b=!c||null!==this.explicitPlotMax,j.apply(this,[a,b,!0]),e=0,f=(this.absMax+(1-this.spaceUseLimit)*this.absMin)/this.spaceUseLimit*1.0001;this.tickDataSpacing<=f&&this.plotSize*this.tickDataSpacingNN/this.plotRange<this.minTickSpacingInPixel;)this.tickDataSpacing=Math.max(1.1*this.tickDataSpacingNN,this.minTickDataSpacing),j.apply(this,[a,b,!0]),e++;d=(this.plotMaxCanBeTuned?this.usedDataMax:this.plotMax)-(this.plotMinCanBeTuned?this.usedDataMin:this.plotMin),this.spaceUseFactor=d/this.plotRange,this.spaceOptimizingEnabled&&this.spaceUseFactor<this.spaceUseLimit&&l.call(this)}function o(){k.call(this);var a=(this.plotMaxCanBeTuned?this.usedDataMax:this.plotMax)-(this.plotMinCanBeTuned?this.usedDataMin:this.plotMin);this.spaceUseFactor=a/this.plotRange,this.spaceOptimizingEnabled&&this.spaceUseFactor<this.spaceUseLimit&&(this.tickDataSpacing=Math.max(this.usedDataRange/this.maxNumIntervals,this.minTickDataSpacing),n.call(this))}function p(){var a,b,c,d,e,f,g,h,i,j=y.getNiceNumber(this.tickDataSpacingNN);this.tickDataSpacingNN!==j&&0===this.tickBaseValue&&(a=this.tickDataSpacingNN,d=this.tickMinIndex,e=this.tickMaxIndex,f=e-d,b=this.plotMin,c=this.plotMax,this.tickDataSpacingNN=j,u.apply(this,[null!==this.explicitPlotMin,null!==this.explicitPlotMax]),g=(this.plotMaxCanBeTuned?this.usedDataMax:this.plotMax)-(this.plotMinCanBeTuned?this.usedDataMin:this.plotMin),this.spaceUseFactor=g/this.plotRange,h=this.plotSize*this.tickDataSpacingNN/this.plotRange<this.minTickSpacingInPixel||this.spaceOptimizingEnabled&&this.spaceUseFactor<this.spaceUseLimit,i=this.tickMaxIndex-this.tickMinIndex,!h&&(i===f||i>=10||i>=3&&1.5*i>=f)||(this.tickDataSpacingNN=a,this.tickMinIndex=d,this.tickMaxIndex=e,this.plotMin=b,this.plotMax=c,this.plotRange=this.plotMax-this.plotMin))}function q(){this.niceNumberEnabled&&this.plotMax!==this.plotMin&&0!==this.plotSize?(this.minTickValue=this.tickBaseValue+this.tickMinIndex*this.tickDataSpacingNN,this.maxTickValue=this.tickBaseValue+this.tickMaxIndex*this.tickDataSpacingNN):(this.minTickValue=this.plotMin,this.maxTickValue=this.plotMax)}function r(){var a,b,c;if(this.mainTickValues=[],this.secondaryTickValues=[],q.call(this),0!==this.plotSize)if(this.niceNumberEnabled){if(a=this.tickBaseValue,!((c=this.tickMaxIndex-this.tickMinIndex)<1)){for(b=0;b<=c;b++)this.mainTickValues.push(a+(b+this.tickMinIndex)*this.tickDataSpacingNN);for(a=this.tickBaseValue+this.tickDataSpacingNN/2,b=0;b<c;b++)this.secondaryTickValues.push(a+(b+this.tickMinIndex)*this.tickDataSpacingNN)}}else{for(this.numIntervals=Math.floor(this.maxNumIntervals),this.tickDataSpacing=Math.max(this.usedDataRange/this.numIntervals,this.minTickDataSpacing),a=this.usedDataMin,b=0;b<=this.numIntervals;b++)this.mainTickValues.push(a+b*this.tickDataSpacing);for(a=this.usedDataMin+this.tickDataSpacing/2,b=0;b<this.numIntervals;b++)this.secondaryTickValues.push(a+b*this.tickDataSpacing)}}function s(){var a,b,c,d,e=[.5];for(a=this.mainTickValues[0],d=0;d<e.length;d++)if(b=a-this.tickDataSpacingNN*e[d],c=this.plotMax-b,this.plotSize*this.tickDataSpacingNN/c>3*this.fontHeight)return this.plotMin=b,this.plotRange=c,void this.mainTickValues.splice(0,0,b)}function t(){var a,b,c,d,e=[.5];for(a=this.mainTickValues[this.mainTickValues.length-1],d=0;d<e.length;d++)if(b=a+this.tickDataSpacingNN*e[d],c=b-this.plotMin,this.plotSize*this.tickDataSpacingNN/c>3*this.fontHeight)return this.plotMax=b,this.plotRange=c,void this.mainTickValues.push(b)}function u(a,b){this.tickMinIndex=a?Math.ceil(this.usedDataMin/this.tickDataSpacingNN):Math.floor(this.usedDataMin/this.tickDataSpacingNN),this.tickMaxIndex=b?Math.floor(this.usedDataMax/this.tickDataSpacingNN):Math.ceil(this.usedDataMax/this.tickDataSpacingNN),this.plotMin=a?this.usedDataMin:this.tickMinIndex*this.tickDataSpacingNN,this.plotMax=b?this.usedDataMax:this.tickMaxIndex*this.tickDataSpacingNN,this.plotRange=this.plotMax-this.plotMin}function v(){var a,b,c,d,e,f=this.plotMin,g=this.plotMax,h=this.tickMinIndex,i=this.tickMaxIndex,j=this.tickDataSpacingNN,k=this.tickMaxIndex-this.tickMinIndex,l=null!==this.explicitPlotMin,m=null!==this.explicitPlotMax,n=!0,o=2*this.fontHeight,p=k;if(d=this.mainTickValues?this.mainTickValues.length:0,b=this.mainTickValues[0],c=this.mainTickValues[d-1],null===this.explicitPlotMin&&b>this.dataMin&&p++,null===this.explicitPlotMax&&c<this.dataMax&&p++,p!==k){for(e=0;n&&e<10;)this.tickDataSpacingNN=y.getSmallNiceNumber(.99*this.tickDataSpacingNN),u.apply(this,[l,m]),a=this.tickMaxIndex-this.tickMinIndex,a>p&&(n=!1),e++;for(n=!0,e=0;this.tickDataSpacingNN<j&&n&&e<10;)this.tickDataSpacingNN=y.getGoodNumber(1.1*this.tickDataSpacingNN),u.apply(this,[l,m]),a=this.tickMaxIndex-this.tickMinIndex,a===p&&this.plotSize*this.tickDataSpacingNN/this.plotRange>o&&(n=!1),e++;n?(this.plotMin=f,this.plotMax=g,this.tickMinIndex=h,this.tickMaxIndex=i,this.tickDataSpacingNN=j):r.call(this)}}function w(){var a,b,c;c=this.mainTickValues?this.mainTickValues.length:0,a=this.mainTickValues[0],b=this.mainTickValues[c-1],null===this.explicitPlotMin&&a>this.dataMin&&null===this.explicitPlotMax&&b<this.dataMax?Math.abs(this.dataMin)<=Math.abs(this.dataMax)?(s.call(this),t.call(this)):(t.call(this),s.call(this)):null===this.explicitPlotMin&&a>this.dataMin?s.call(this):null===this.explicitPlotMax&&b<this.dataMax&&t.call(this)}function x(){return{plotMin:this.plotMin,plotMax:this.plotMax,tickSpacing:this.tickDataSpacingNN,tickBaseValue:this.tickBaseValue,tickMinIndex:this.tickMinIndex,tickMaxIndex:this.tickMaxIndex,minTickValue:this.minTickValue,maxTickValue:this.maxTickValue,mainTickValues:this.mainTickValues,secondaryTickValues:this.secondaryTickValues}}var y,z=Math.log(10);return y={log:function(a,b){return a<=0||b<=0?NaN:Math.log(a)/Math.log(b)},log10:function(a){return a<=0?NaN:Math.log(a)/z},eliminateFloatingError:function(a){var b=Math.round(a);return Math.abs(a-b)<1e-12&&(a=b),a},getNiceNumber:function(a){var b,c;return 0===a?0:(b=Math.floor(Math.log(Math.abs(a))/z),c=a/Math.pow(10,b),(c<=1?1:c<=2?2:c<=5?5:10)*Math.pow(10,b)*(a<0?-1:1))},getSmallNiceNumber:function(a){var b,c,d;return 0===a?0:(b=Math.floor(Math.log(Math.abs(a))/z),c=a/Math.pow(10,b),c<1?(d=5,b--):d=c<2?1:c<5?2:5,d*Math.pow(10,b)*(a<0?-1:1))},getMagnitude:function(a){var b;return 0===a?0:(b=Math.floor(Math.log(Math.abs(a))/z),Math.pow(10,b))},getFraction:function(a){var b;return 0===a?0:(b=Math.floor(Math.log(Math.abs(a))/z),a/Math.pow(10,b))},getGoodNumber:function(a){var b,c,d;return 0===a?0:(b=Math.floor(Math.log(Math.abs(a))/z),c=a/Math.pow(10,b),d=Math.ceil(c),7!==d&&9!==d||d++,c>1&&c<=1.5?d=1.5:c>2&&c<=2.5&&(d=2.5),d*Math.pow(10,b)*(a<0?-1:1))},calculateTicks:function(a,b,d,e,f,g,h,j,q,s,t,u){var y,z=!1;return void 0===t&&(t=!1),isNaN(e)&&(e=null),isNaN(f)&&(f=null),b>d&&(y=b,b=d,d=y),null!==e&&null!==f&&e>f&&(y=e,e=f,f=y),this.plotSize=a,this.dataMin=b,this.dataMax=d,this.explicitPlotMin=e,this.explicitPlotMax=f,this.minTickSpacingInPixel=g,this.usedDataMin=null===this.explicitPlotMin?this.dataMin:this.explicitPlotMin,this.usedDataMax=null===this.explicitPlotMax?this.dataMax:this.explicitPlotMax,this.absMax=Math.max(Math.abs(this.usedDataMax),Math.abs(this.usedDataMin)),this.absMin=Math.min(Math.abs(this.usedDataMax),Math.abs(this.usedDataMin)),this.usedDataRange=this.usedDataMax-this.usedDataMin,this.maxNumIntervals=this.plotSize/this.minTickSpacingInPixel,this.maxNumTicks=this.maxNumIntervals+1,this.minTickDataSpacing=u||0,this.tickDataSpacing=Math.max(this.usedDataRange/this.maxNumIntervals,this.minTickDataSpacing),this.fontHeight=h,this.niceNumberEnabled=j,this.tickBaseValue=0,this.spaceUseLimit=void 0===s?.6:s,this.spaceOptimizingEnabled=q,this.plotMaxCanBeTuned=null===this.explicitPlotMax&&this.usedDataMax>0,this.plotMinCanBeTuned=null===this.explicitPlotMin&&this.usedDataMin<0,j&&0!==a?(null!==this.explicitPlotMax&&this.explicitPlotMax<this.usedDataMin||null!==this.explicitPlotMin&&this.explicitPlotMin>this.usedDataMax?(z=!0,c.call(this)):0===this.usedDataRange?i.call(this):this.maxNumIntervals<1?m.call(this):(this.usedDataMax>0&&this.usedDataMin<0?1===this.maxNumIntervals?l.call(this,!0):this.maxNumIntervals>=5?k.call(this):this.maxNumIntervals<2?n.call(this):o.call(this):k.call(this),this.tickMaxIndex<this.tickMinIndex?(this.tickDataSpacing=Math.max(this.usedDataRange/this.maxNumIntervals,this.minTickDataSpacing),m.call(this)):p.call(this)),r.call(this),t&&this.maxNumIntervals>=1&&!z&&(v.call(this),w.call(this)),x.call(this)):(this.plotMin=this.usedDataMin,this.plotMax=this.usedDataMax,this.tickDataSpacingNN=this.tickDataSpacing,r.call(this),x.call(this))}}}),define("objects.views/charts/components/axis/linear-scale",["core.utils/class","../../utils/scale-utils"],function(a,b){"use strict";return a.extend("LinearScale",{init:function(){this.plotMin=null,this.plotMax=null,this.plotRange=null,this.tickMin=this.plotMin,this.tickMax=this.plotMax,this.mainValues=[],this.secondaryValues=[],this._plotSize=0,this._calculationSize=0},setSize:function(a){this._plotSize=a},getPositionOfValue:function(a){return(a-this.plotMin)/this.plotRange*this._plotSize},getValueOfPosition:function(a){return this.plotMin+this.plotRange*a/this._plotSize},getNormalizedValue:function(a){return(a-this.plotMin)/this.plotRange},calculateLimits:function(){this._usedDataMin=isNaN(this._realDataMin)?this._dataMin:this._realDataMin,this._usedDataMax=isNaN(this._realDataMax)?this._dataMax:this._realDataMax,this.plotMin=null===this._explicitPlotMin||isNaN(this._explicitPlotMin)?this._usedDataMin:this._explicitPlotMin,this.plotMax=null===this._explicitPlotMax||isNaN(this._explicitPlotMax)?this._usedDataMax:this._explicitPlotMax,this.plotRange=this.plotMax-this.plotMin},calculateTicks:function(){var a,c,d,e,f;d=isNaN(this._realDataMin)?this._dataMin:this._realDataMin,c=isNaN(this._realDataMax)?this._dataMax:this._realDataMax,a=b.calculateTicks(this._calculationSize,d,c,this._explicitPlotMin,this._explicitPlotMax,this._minTickSpacingInPixel,this._fontHeight,this._niceNumberEnabled,this._whiteSpaceOptimizingEnabled,.6,this._showExplicitMinMax,this._minTickDataSpacing),this._tickSpacing=a.tickSpacing,this.plotMin=a.plotMin,this.plotMax=a.plotMax,this.plotRange=this.plotMax-this.plotMin,this.tickMin=a.tickMinValue,this.tickMax=a.tickMaxValue,this.mainValues=a.mainTickValues,this.secondaryValues=a.secondaryTickValues,0===this.mainValues.length&&this.mainValues.push(a.minTickValue),0===this._tickSpacing&&(this._tickSpacing=1),this._showExplicitMinMax&&(f=this.mainValues[0],this.mainValues[0]=a.plotMin,f-a.plotMin>=a.tickSpacing/2&&this.mainValues.splice(1,0,f),e=a.mainTickValues[a.mainTickValues.length-1],a.plotMax-e<=a.tickSpacing/2?this.mainValues[a.mainTickValues.length-1]=a.plotMax:this.mainValues.push(a.plotMax))},getValues:function(){return{mainValues:this.mainValues,secondaryValues:this.secondaryValues}}})}),define("objects.views/charts/utils/scale-log-utils",["objects.views/charts/utils/scale-utils"],function(a){"use strict";function b(a,b,c){var d,e=a?a.length:0,f=void 0===b?Number.MAX_VALUE:a[0]/b;for(d=1;d<e;d++)f=Math.min(f,a[d]/a[d-1]);void 0!==c&&(f=Math.min(f,c/a[e-1])),a.splice(0,0,f)}function c(a,c,d){var e,f=a?a.length:0;for(e=0;e<f;e++)b(a[e],c,d)}function d(){var a,b,c,d,e,f,g,h=!0,i=0;for(a=this.tickDataSpacingLog,g=0;h&&i<5;)a=0===i?Math.ceil(this.tickDataSpacingLog):Math.ceil(1.01*a),b=this.minIsStrict?Math.ceil(this.usedDataMinLog/a):Math.floor(this.usedDataMinLog/a),c=this.maxIsStrict?Math.floor(this.usedDataMaxLog/a):Math.ceil(this.usedDataMaxLog/a),d=this.minIsStrict?this.explicitPlotMinLog:b*a,e=this.maxIsStrict?this.explicitPlotMaxLog:c*a,f=e-d,h=a/f*this.plotSize<this.minTickSpacingInPixel,i++;return h&&(a=Math.ceil(this.tickDataSpacingLog),b=this.minIsStrict?Math.ceil(this.usedDataMinLog/a):Math.floor(this.usedDataMinLog/a),c=this.maxIsStrict?Math.floor(this.usedDataMaxLog/a):Math.ceil(this.usedDataMaxLog/a),d=this.minIsStrict?this.explicitPlotMinLog:b*a,e=this.maxIsStrict?this.explicitPlotMaxLog:c*a),{plotMinLog:d,plotMaxLog:e,tickMinIndex:b,tickMaxIndex:c,tickDataSpacingNNLog:a,tickBaseValueLog:g,success:!h}}function e(){var a,b,c,d,e,f,g,h=!0,i=0;for(a=this.tickDataSpacingLog,b=0,g=this.usedDataMinLogFloor;h&&i<5;)a=0===i?Math.ceil(this.tickDataSpacingLog):Math.ceil(1.01*a),b=this.minIsStrict?Math.ceil((this.usedDataMinLog-g)/a):Math.floor((this.usedDataMinLog-g)/a),c=this.maxIsStrict?Math.floor((this.usedDataMaxLog-g)/a):Math.ceil((this.usedDataMaxLog-g)/a),d=this.minIsStrict?this.explicitPlotMinLog:b*a+g,e=this.maxIsStrict?this.explicitPlotMaxLog:c*a+g,f=e-d,h=a/f*this.plotSize<this.minTickSpacingInPixel,i++;return h&&(a=0===i?Math.ceil(this.tickDataSpacingLog):Math.ceil(1.01*a),b=this.minIsStrict?Math.ceil((this.usedDataMinLog-g)/a):Math.floor((this.usedDataMinLog-g)/a),c=this.maxIsStrict?Math.floor((this.usedDataMaxLog-g)/a):Math.ceil((this.usedDataMaxLog-g)/a),d=this.minIsStrict?this.explicitPlotMinLog:b*a+g,e=this.maxIsStrict?this.explicitPlotMaxLog:c*a+g),{plotMinLog:d,plotMaxLog:e,tickMinIndex:b,tickMaxIndex:c,tickDataSpacingNNLog:a,tickBaseValueLog:g,success:!h}}function f(){var a,b,c,f,g,h,i;return b=e.call(this),b.success?(c=this.usedDataMaxLog-this.usedDataMinLog,1===(g=c/(b.plotMaxLog-b.plotMinLog))?b:(a=d.call(this),a.success?(f=c/(a.plotMaxLog-a.plotMinLog),h=a.tickMaxIndex-a.tickMinIndex,i=b.tickMaxIndex-b.tickMinIndex,i>h||i===h&&g>f||i===h&&g===f&&b.plotMinLog<a.plotMinLog?b:a):b)):a=d.call(this)}function g(b,c,d,e,f){var g=a.getNiceNumber(1.1*f),h=b?Math.ceil(d/g):Math.floor(d/g),i=c?Math.floor(e/g):Math.ceil(e/g);return{plotMin:b||0===h?d:h*g,plotMax:c?e:i*g,tickSpacing:g,tickBaseValue:0}}function h(a,b){var c;for(c=0;c<a.length;c++)if(a[c]>=b)return c-1}function i(a,b){var c;for(c=a.length-1;c>=0;c--)if(a[c]<=b)return c+1}function j(a,b,c,d,e){var f,g;f=h(a,b),g=i(a,c),!d&&void 0!==a[f+1]&&a[f+1]>b&&(f-=1),!e&&g>0&&void 0!==a[g-1]&&a[g-1]<c&&(g+=1),g<a.length&&a.splice(g,a.length-g),f>=0&&a.splice(0,f+1)}function k(b,c,d,e){var f,g,h,i,j=Number.MAX_VALUE,k=-Number.MAX_VALUE,l=a.log10(d),m=a.log10(c),n=l-m;for(g=b?b.length:0,h=new Array(g),(null===e||isNaN(e))&&(e=1.71),f=0;f<g;f++)h[f]=a.log10(b[f]);for(f=1;f<g;f++)i=h[f]-h[f-1],j=Math.min(j,i),k=Math.max(k,i);return k=Math.max(k,Math.abs(h[0]-m)),k=Math.max(k,Math.abs(l-h[g-1])),j/n*this.plotSize>=this.minTickSpacingInPixel-B&&k/j<=e&&b.length-1<=this.maxNumIntervals}function l(b){var c,d,e,f,g=Number.MAX_VALUE,h=-Number.MAX_VALUE,i=b.mainTickValues;for(d=i?i.length:0,e=new Array(d),c=0;c<d;c++)e[c]=a.log10(i[c]);for(c=1;c<d;c++)f=e[c]-e[c-1],g=Math.min(g,f),h=Math.max(h,f);b.maxTickSpacing=h,b.minTickSpacing=g,b.tickSpacingRatio=h/g,b.spaceUseFactor=this.usedDataRange/(b.plotMax-b.plotMin),b.factor=b.spaceUseFactor/(b.tickSpacingRatio*b.tickSpacingRatio)}function m(b,c,d,e,f){var g,h,i,j,k;return g=(e+d)/2,void 0===f?(h=Math.round(g))>=d&&h<=e?Math.pow(10,h):(i=Math.floor(g))>=d&&i<=e?Math.pow(10,i):(j=Math.ceil(g))>=d&&j<=e?Math.pow(10,j):(k=a.getSmallNiceNumber(Math.max(1,c-b)),Math.ceil(b/k)*k):(i=Math.pow(10,Math.floor(g)),j=Math.pow(10,Math.ceil(g)),Math.abs(i-f)<Math.abs(j-f)?i:j)}function n(a,b,c,d,e,f){var g,h=e?Math.ceil((a-c)/d):Math.floor((a-c)/d),i=f?Math.floor((b-c)/d):Math.ceil((b-c)/d),j=[];for(g=h;g<=i;g++)g*d+c>0&&j.push(g*d+c);return j}function o(a,b,c,d){a.mainTickValues=b,a.plotMin=c,a.plotMax=d}function p(){return this.usedDataMax>=10*this.usedDataMin?1:this.usedDataMaxLogFloor===this.usedDataMinLogFloor?this.maxIsStrict&&this.minIsStrict?2:3:1}function q(a){a.sort(function(a,b){return a-b})}function r(a,b,c,d,e,f,g){var h,i,l,m,n,o,p,r=0,s=[];for(r=0;r<a.length;r++)if(b<=a[r][0]+B){for(n=c.concat(),h=d;h<e;h++)for(i=1;i<a[r].length;i++)n.push(a[r][i]*Math.pow(10,h*f+g));q(n),j(n,this.usedDataMin,this.usedDataMax,this.minIsStrict,this.maxIsStrict),o=this.minIsStrict?this.explicitPlotMin:n[0],p=this.maxIsStrict?this.explicitPlotMax:n[n.length-1],k.apply(this,[n,o,p])&&s.push({mainTickValues:n,plotMin:o,plotMax:p})}if(0===s.length)return n=c,j(n,this.usedDataMin,this.usedDataMax,this.minIsStrict,this.maxIsStrict),o=this.minIsStrict?this.explicitPlotMin:n[0],p=this.maxIsStrict?this.explicitPlotMax:n[n.length-1],{mainTickValues:n,plotMin:o,plotMax:p};if(1===s.length)return s[0];for(m=c.length-1,r=0;r<s.length;r++)if(l=s[r].mainTickValues.length-1,s[r].mainTickValues[0]===c[0]&&s[r].mainTickValues[l]===c[m])return s[r];return s[0]}function s(a,b){var c,d,e,f,g,h,i=!0,j=Math.ceil(this.fractionMinLog),l=Math.floor(this.fractionMaxLog),n=0;if(a[j]&&a[j][l])for(g=a[j][l],g instanceof Array||(g=a[j][g]),h=g.length;n<h&&i;){if(b<=g[n][0]+B&&g[n].length-2<=this.maxNumIntervals){for(d=[],c=1;c<g[n].length;c++)d.push(g[n][c]*this.dataMinMagnitude);i=!k.apply(this,[d,this.usedDataMin,this.usedDataMax])}i&&n++}return i&&(d=[m(this.usedDataMin,this.usedDataMax,this.usedDataMinLog,this.usedDataMaxLog)]),e=this.minIsStrict?this.explicitPlotMin:d[0],f=this.maxIsStrict?this.explicitPlotMax:d[d.length-1],{mainTickValues:d,plotMin:e,plotMax:f}}function t(a,b){var c,d,e,f,g,h,i,l,n,p,q,r,s,t,u,v=this.minIsStrict?Math.ceil(this.fractionMinLog):Math.floor(this.fractionMinLog),w=this.maxIsStrict?Math.floor(this.fractionMaxLog):Math.ceil(this.fractionMaxLog),x={};if(F[v]&&F[v][w])for(i=F[v][w],l=i instanceof Array?i.length/2:0,x.mainTickValues=[],c=0;c<l;c++)if(n=i[2*c],p=i[2*c+1],a[n]&&a[n][p])for(q=a[n][p],r=q.length,d=0;d<r;d++)if(s=b<=q[d][0]+B&&q[d].length-2<=this.maxNumIntervals,t=q[d][1]*this.dataMinMagnitude,u=q[d][q[d].length-1]*this.dataMinMagnitude,s=this.minIsStrict?s&&t>=this.usedDataMin:s&&t<=this.usedDataMin,s=this.maxIsStrict?s&&u<=this.usedDataMax:s&&u>=this.usedDataMax){for(f=[],e=1;e<q[d].length;e++)f.push(q[d][e]*this.dataMinMagnitude);if(j(f,this.usedDataMin,this.usedDataMax,this.minIsStrict,this.maxIsStrict),g=this.minIsStrict?this.explicitPlotMin:f[0],h=this.maxIsStrict?this.explicitPlotMax:f[f.length-1],k.apply(this,[f,g,h])){x.mainTickValues.length<f.length&&o(x,f,g,h);break}}return x.mainTickValues&&0!==x.mainTickValues.length||(x.mainTickValues=[m(this.usedDataMin,this.usedDataMax,this.usedDataMinLog,this.usedDataMaxLog)]),f=x.mainTickValues,x.plotMin=this.minIsStrict?this.explicitPlotMin:f[0],x.plotMax=this.maxIsStrict?this.explicitPlotMax:f[f.length-1],x}function u(a,b,c){var d,e=a.length;if(c){for(d=e-1;d>=0;d--)if(Math.abs(a[d]-b[d]*this.dataMinMagnitude)>B)return!1;return!0}for(d=0;d<e;d++)if(Math.abs(a[d]-b[d]*this.dataMinMagnitude)>B)return!1;return!0}function v(a){var b,c,d=a.mainTickValues,e=d.length;if(!(e<2||e>4))return c=5*this.dataMinMagnitude,(this.minIsStrict&&this.usedDataMin<=c||!this.minIsStrict&&this.usedDataMin>=c)&&(u.apply(this,[d,[6,10,20,40]])||u.apply(this,[d,[4,10,20,40]]))?(b=d[0],d[0]=c,a.plotMin=this.minIsStrict?this.explicitPlotMin:d[0],void(k.apply(this,[d,a.plotMin,a.plotMax])||(d[0]=b,a.plotMin=this.minIsStrict?this.explicitPlotMin:d[0]))):(c=80*this.dataMinMagnitude,(this.maxIsStrict&&this.usedDataMax>=c||!this.maxIsStrict&&this.usedDataMax<=c)&&u.apply(this,[d,[10,20,40,60],!0])?(b=d[e-1],d[e-1]=c,a.plotMax=this.maxIsStrict?this.explicitPlotMax:d[e-1],void(k.apply(this,[d,a.plotMin,a.plotMax])||(d[e-1]=b,a.plotMax=this.maxIsStrict?this.explicitPlotMax:d[e-1]))):void 0)}function w(b,c,d,e,f,h,i,j,l,m){var o,p,q,r,s=a.calculateTicks(b,c,d,e,f,h,i,j,l,m),t=null!==e,u=null!==f,v=t?e:c,w=u?f:d,x=1;for(0===s.plotMin&&(s.plotMin=t?e:c),o=s.mainTickValues,p=t?e:Math.min(c,o[0]),q=u?f:Math.max(o[o.length-1],d);!k.apply(this,[o,p,q])&&x<=20;)s=g(t||s.tickSpacing>v,u,v,w,s.tickSpacing),o=n(v,w,s.tickBaseValue,s.tickSpacing,t,u),p=t?e:Math.min(c,o[0]),q=u?f:Math.max(o[o.length-1],d),x++;return k.apply(this,[o,p,q])?(r=a.getFraction(o[0])/2,2===o.length&&o[1]/o[0]==2&&o[0]/2>=p&&r===Math.floor(r)&&(o.splice(0,0,o[0]/2),r=a.getFraction(o[0])/2,o[0]/2>=p&&r===Math.floor(r)&&o.splice(0,0,o[0]/2))):o=[],s.mainTickValues=o,s.numLoops=x,s}function x(){var a,b,c,d,e,g,h,i,l,n,q,u,w,x,y,z={};if(this.maxIsStrict&&this.explicitPlotMax<=this.usedDataMin?(this.dataMinLog=Math.ceil(this.explicitPlotMaxLog-(this.maxNumIntervals<2?1:2)),this.dataMin=Math.pow(10,this.dataMinLog)):this.minIsStrict&&this.explicitPlotMin>=this.usedDataMax?(this.dataMaxLog=Math.floor(this.explicitPlotMinLog+(this.maxNumIntervals<2?1:2)),this.dataMax=Math.pow(10,this.dataMaxLog)):this.usedDataMin===this.usedDataMax&&(c=this.usedDataMin,this.dataMinLog=Math.floor(this.dataMinLog),this.dataMaxLog=this.dataMinLog+1,this.dataMin=Math.pow(10,this.dataMinLog),this.dataMax=Math.pow(10,this.dataMaxLog)),this.usedDataMin=this.minIsStrict?this.explicitPlotMin:this.dataMin,this.usedDataMax=this.maxIsStrict?this.explicitPlotMax:this.dataMax,this.usedDataMinLog=this.minIsStrict?this.explicitPlotMinLog:this.dataMinLog,this.usedDataMaxLog=this.maxIsStrict?this.explicitPlotMaxLog:this.dataMaxLog,this.maxNumIntervals<1)return o(z,[m(this.usedDataMin,this.usedDataMax,this.usedDataMinLog,this.usedDataMaxLog,c)],this.usedDataMin,this.usedDataMax),z;if(this.tickDataSpacingLog=(this.usedDataMaxLog-this.usedDataMinLog)/this.maxNumIntervals,this.usedDataMinLogFloor=Math.floor(this.usedDataMinLog),this.usedDataMaxLogFloor=Math.floor(this.usedDataMaxLog),this.dataMinMagnitude=Math.pow(10,this.usedDataMinLogFloor),this.fractionMinLog=this.usedDataMin/this.dataMinMagnitude,this.fractionMaxLog=this.usedDataMax/this.dataMinMagnitude,a=Math.ceil(this.usedDataMaxLog),this.usedDataMinLog===this.usedDataMinLogFloor&&this.usedDataMaxLog===a&&this.maxNumIntervals>=2&&this.maxNumIntervals<3&&this.tickDataSpacingLog>1&&this.tickDataSpacingLog-Math.floor(this.tickDataSpacingLog)<C&&(b=Math.floor((this.usedDataMinLogFloor+a)/2),w=[Math.pow(10,this.usedDataMinLogFloor),3*Math.pow(10,b),Math.pow(10,a)],j(w,this.usedDataMin,this.usedDataMax,this.minIsStrict,this.maxIsStrict),x=this.minIsStrict?this.explicitPlotMin:w[0],y=this.maxIsStrict?this.explicitPlotMax:w[w.length-1],w.length>=2&&k.apply(this,[w,x,y])))return o(z,w,x,y),z;if(h=f.call(this),!h.success)return o(z,[m(this.usedDataMin,this.usedDataMax,this.usedDataMinLog,this.usedDataMaxLog)],this.usedDataMin,this.usedDataMax),z;for(i=h.tickMinIndex,l=h.tickMaxIndex,e=h.tickDataSpacingNNLog,g=h.tickBaseValueLog,this.minIsStrict&&i--,this.maxIsStrict&&l++,q=[],n=i;n<=l;n++)q.push(Math.pow(10,n*e+g));return d=Math.pow(10,this.tickDataSpacingLog),2===(u=p.call(this))?s.apply(this,[E,d]):3===u?t.apply(this,[E,d]):(z=r.apply(this,[D,d,q,i,l,e,g]),v.call(this,z),z)}function y(){var a,b,c,d,e={};for(this.plotMin=this.usedDataMin,this.plotMax=this.usedDataMax,b=Math.floor(this.maxNumIntervals),c=(this.dataMaxLog-this.dataMinLog)/b,d=[this.usedDataMin],a=0;a<b;a++)d.push(Math.pow(10,this.dataMinLog+(a+1)*c));return o(e,d,this.plotMin,this.plotMax),e}var z,A=Math.log(10),B=1e-12,C=Math.log(3)/A,D=[[2,4,6],[2,4],[3]],E=[,[,,[[1,2]],[[1,2,3],[1,3]],[[1,2,4],[1,4]],[[1,2,4],[1,5]],[[1,2,4,6],[2,4,6],[1,3,6],[1,6]],[[1,2,4,6],[2,4,6],[1,3,6],[1,7]],[[1,2,4,8],[2,4,8],[1,8]],[[1,2,4,8],[2,4,8],[1,3,9],[1,9]],[[1,2,4,6,10],[1,2,4,10],[1,3,10],[3,10],[1,10]]],[,,,[[2,3]],[[2,3,4],[2,4]],[[2,3,4],[2,4],[2,5]],[[2,4,6],[2,6]],[[2,4,6],[2,6],[2,7]],[[2,4,8],[2,8]],[[2,4,8],[2,8],[2,9]],[[2,4,6,10],[2,4,10],[5,10],[3,10]]],[,,,,[[3,4]],[[3,4,5],[3,5]],[[3,4,5,6],[3,6]],[[3,4,5,6],[3,5,7],[3,7]],[[3,4,5,6,8],[3,5,7],[4,8],[3,8]],[[3,4,5,6,8],[3,4,6,9],[3,4,6,8],[3,6,9],[4,8],[3,9]],[[4,6,10],[5,10],[3,10]]],[,,,,,[[4,5]],[[4,5,6],[4,6]],[[4,5,6,7],[4,5,6],[4,6]],[[4,5,6,7,8],[4,5,6,7],[4,6,8],[4,8]],[[4,5,6,7,8],[4,6,9],[4,6,8],[4,8]],[[4,6,10],[5,7,9],[5,10],[4,10]]],[,,,,,,[[5,6]],[[5,6,7],[5,7]],[[5,6,7,8],[5,6,7],[6,8]],[[5,6,7,8,9],[5,6,7,8],[5,7,9],[5,9]],[[6,8,10],[5,10]]],[,,,,,,,[[6,7]],[[6,7,8],[6,8]],[[6,7,8,9],[6,7,8],[6,9]],[[6,7,8,9,10],[6,8,10],[6,10]]],[,,,,,,,,[[7,8]],[[7,8,9],[7,9]],[[7,8,9,10],[8,10],[7,10],[7,9]]],[,,,,,,,,,[[8,9]],[[8,9,10],[8,10]]],[,,,,,,,,,,[[9,10]]]],F=[,[,,[1,2],[1,3],[1,4],[1,5,1,6],[1,6],[1,10,1,8,1,7],[1,8,1,10],[1,10,1,9]],[,,,[2,3],[2,4],[2,6,2,5],[2,6,2,8],[2,8,2,7],[2,8,1,10],[1,10,2,10,2,9],[1,10,2,10]],[,,,,[3,4,2,4],[3,6,3,5],[3,6,2,6],[2,8,3,8,3,7],[2,8,3,8,3,9],[2,10,3,10,3,9]],[,,,,,[4,5,4,6,3,5],[4,6],[4,8,4,7],[4,8],[4,10,4,9,3,9],[4,10]],[,,,,,[5,6,4,6],[5,7,4,8],[4,8,5,8,5,10],[5,10,4,10,5,9],[5,10,4,10]],[,,,,,,[6,7,6,8],[6,8],[6,10,5,10,6,9],[6,10,5,10]],[,,,,,,,[7,8,6,8],[7,9,6,10],[6,10,7,10]],[,,,,,,,,[8,10,8,9],[8,10]],[,,,,,,,,,[9,10]]];return function(){var a,b;for(c(D,1,10),a=0;a<E.length;a++)if(E[a])for(b=0;b<E[a].length;b++)E[a][b]instanceof Array&&c(E[a][b])}(),z={calculateTicksLogPositive:function(b,c,d,e,f,g,h,i,j){var k,m,n,p={};return isNaN(e)&&(e=null),isNaN(f)&&(f=null),c>d&&(k=c,c=d,d=k),null!==e&&null!==f&&e>f&&(k=e,e=f,f=k),this.plotSize=b,this.dataMin=c,this.dataMax=d,this.explicitPlotMin=e,this.explicitPlotMax=f,this.minTickSpacingInPixel=g,this.minIsStrict=null!==e,this.maxIsStrict=null!==f,this.usedDataMin=this.minIsStrict?e:c,this.usedDataMax=this.maxIsStrict?f:d,this.usedDataRange=this.usedDataMax-this.usedDataMin,this.maxNumIntervals=b/g,this.maxNumTicks=this.maxNumIntervals+1,this.explicitPlotMinLog=this.minIsStrict?a.eliminateFloatingError(a.log10(e)):null,this.explicitPlotMaxLog=this.maxIsStrict?a.eliminateFloatingError(a.log10(f)):null,this.dataMinLog=a.eliminateFloatingError(a.log10(c)),this.dataMaxLog=a.eliminateFloatingError(a.log10(d)),i&&0!==b?this.minIsStrict&&this.maxIsStrict&&this.explicitPlotMin===this.explicitPlotMax?(o(p,[this.explicitPlotMin],this.explicitPlotMin,this.explicitPlotMax),p):(n=x.call(this),this.usedDataMax>=10*this.usedDataMin?n:(m=w.apply(this,[b,c,d,e,f,g,h,i,j]),m.mainTickValues.length<2?n:n.mainTickValues.length<2?m:m.mainTickValues.length===n.mainTickValues.length?(l.call(this,m),l.call(this,n),m.factor>n.factor?m:n):m.mainTickValues.length-1>=1.5*(n.mainTickValues.length-1)&&m.mainTickValues.length>n.mainTickValues.length?m:n)):y.call(this)},calculateTicks:function(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,o,p;if(isNaN(d)&&(d=null),isNaN(e)&&(e=null),b>c&&(j=b,b=c,c=j),null!==d&&null!==e&&d>e&&(j=d,d=e,e=j),b*c<=0&&(b=null===d?b:d,c=null===e?c:e),b>0&&c>0&&(null===d||d>0)&&(null===e||e>0))return k=z.calculateTicksLogPositive(a,b,c,d,e,f,g,h,i),k.sign=1,k;if(b<0&&c<0&&(null===d||d<0)&&(null===e||e<0)){for(l=z.calculateTicksLogPositive(a,-c,-b,null===e?null:-e,null===d?null:-d,f,g,h,i),k={},k.plotMin=-l.plotMax,k.plotMax=-l.plotMin,n=l.mainTickValues,o=n?n.length:0,m=new Array(o),p=0;p<o;p++)m[p]=-n[o-1-p];return k.mainTickValues=m,k.sign=-1,k}return{plotMin:null===d?b:d,plotMax:null===e?c:e,mainTickValues:[]}}}}),define("objects.views/charts/components/axis/log-scale",["core.utils/class","../../utils/scale-utils","../../utils/scale-log-utils"],function(a,b,c){return a.extend("LogScale",{init:function(){this.plotMin=null,this.plotMax=null,this.plotRange=null,this.tickMin=this.plotMin,this.tickMax=this.plotMax,this.mainValues=[],this.secondaryValues=[],this._plotSize=0,this._calculationSize=0},setSize:function(a){this._plotSize=a},getPositionOfValue:function(a){return 0===a?this._usedDataMin>0?0:this._plotSize:((a>0?b.log10(a):-b.log10(-a))-this._plotMinLog10)/this._plotRangeLog10*this._plotSize},getNormalizedValue:function(a){return 0===a?this._usedDataMin>0?0:1:((a>0?b.log10(a):-b.log10(-a))-this._plotMinLog10)/this._plotRangeLog10},getValueOfPosition:function(a){var b;return 0===a?0:(b=this._plotMinLog10+this._plotRangeLog10*a/this._plotSize,this._usedDataMin>0?Math.pow(10,b):-Math.pow(10,-b))},calculateLimits:function(){
this._usedDataMin=isNaN(this._realDataMin)?this._dataMin:this._realDataMin,this._usedDataMax=isNaN(this._realDataMax)?this._dataMax:this._realDataMax,this.plotMin=null===this._explicitPlotMin||isNaN(this._explicitPlotMin)?this._usedDataMin:this._explicitPlotMin,this.plotMax=null===this._explicitPlotMax||isNaN(this._explicitPlotMax)?this._usedDataMax:this._explicitPlotMax,this.plotRange=this.plotMax-this.plotMin,this._plotMinLog10=b.log10(Math.abs(this.plotMin))*(this.plotMin<0?-1:1),this._plotMaxLog10=b.log10(Math.abs(this.plotMax))*(this.plotMax<0?-1:1),this._plotRangeLog10=this._plotMaxLog10-this._plotMinLog10},calculateTicks:function(){var a;a=c.calculateTicks(this._calculationSize,this._usedDataMin,this._usedDataMax,this._explicitPlotMin,this._explicitPlotMax,this._minTickSpacingInPixel,this._fontHeight,this._niceNumberEnabled,this._whiteSpaceOptimizingEnabled),this.plotMin=a.plotMin,this.plotMax=a.plotMax,this.plotRange=this.plotMax-this.plotMin,this.tickMin=a.tickMin,this.tickMax=a.tickMax,this.mainValues=a.mainTickValues,this.secondaryValues=[],this._dataSign=a.sign,this._tickSpacing=this.mainValues.length>1?this.mainValues[1]-this.mainValues[0]:this.plotMax-this.plotMin,this._plotMinLog10=this._dataSign*b.log10(Math.abs(this.plotMin)),this._plotMaxLog10=this._dataSign*b.log10(Math.abs(this.plotMax)),this._plotRangeLog10=this._plotMaxLog10-this._plotMinLog10,0===this.mainValues.length&&this.mainValues.push(a.minTickValue),0===this._tickSpacing&&(this._tickSpacing=1)},getValues:function(){return{mainValues:this.mainValues,secondaryValues:this.secondaryValues}}})}),define("objects.views/charts/utils/tween",["core.utils/class","objects.utils/animation-frame"],function(a,b){"use strict";function c(){i.tick()&&(j=b.request(c))}function d(a){k.push(a),a._isRunning=!0,null===j&&(j=b.request(c))}function e(a,b){for(var c in a)this._props[c]||(this._props[c]={}),this._props[c][b]=Array.isArray(a[c])?a[c].slice():a[c]}function f(){var a,b,c,d;for(a in this._props)if(d=this._props[a],b="from"in d?d.from:this._target[a],c=d.to,d.from=b,Array.isArray(b)){var e=b.map(function(a){return a.value}),f=c.map(function(a){return a.value});d.fresh=c.filter(function(a){return e.indexOf(a.value)<0}),d.rotten=b.filter(function(a){return f.indexOf(a.value)<0}),d.ripe=c.filter(function(a){return e.indexOf(a.value)>=0}),d.combined=d.rotten.concat(d.ripe).concat(d.fresh),d.isArray=!0}else isNaN(b)||isNaN(d.to)||(d.change=d.to-b)}function g(a){var b;for(b in a)if(a[b].isArray){if(a[b].fresh.length||a[b].rotten.length)return!0}else if(a[b].change)return!0;return!1}function h(a,b,c){var d,e,f,g,h,i,j;for(e in a){if(f=a[e],g=f.to,h=f.from,f.isArray){for(i=f.fresh,j=f.rotten,f.value=c?f.to:f.combined,d=0;d<i.length;d++)i[d].opacity=b;for(d=0;d<j.length;d++)j[d].opacity=1-b;c&&(delete f.combined,delete f.fresh,delete f.rotten,delete f.ripe)}else f.value=!c&&"change"in f?h+f.change*b:g;c&&delete a[e].from}}var i,j=null,k=[],l=!0,m=Math.PI,n=Math.cos;i=a.extend("Tween",{init:function(a,b,c,e){var h,j,k,l={},m=!0;this._target=a,this._enabled=!0;for(h in b)j=Array.isArray(a[h])?a[h].slice():a[h],k=Array.isArray(b[h])?b[h].slice():b[h],l[h]={from:j,to:k};this._props=l,f.call(this),"object"==typeof c?(this._duration=c.duration||200,this._easing="function"==typeof c.easing?c.easing:i.easing[c.easing||"linear"],m=c.autoStart!==!1):(this._duration=c||200,this._easing="function"==typeof e?e:i.easing[e||"linear"]),this._dfd=new o,this._pos=0,this._isRunning=!1,m&&(g(this._props)?(this._startTime=Date.now(),d(this)):this._step(!0))},from:function(a){return this._isRunning||e.call(this,a,"from"),this},to:function(a){return this._isRunning||e.call(this,a,"to"),this},start:function(){return!this._isRunning&&this._enabled&&l&&(f.call(this),g(this._props)?this._start():this._dfd.resolve()),this},willStart:function(){return!(this._isRunning||!this._enabled||!l||(f.call(this),!g(this._props)))},stop:function(){return this._isRunning&&(this._isRunning=!1,k.splice(k.indexOf(this),1)),this},end:function(){return this._isRunning&&this._step(!0),this},then:function(){return this._dfd.then.apply(this._dfd,[].slice.call(arguments)),this},progress:function(){return this._dfd.progress.apply(this._dfd,[].slice.call(arguments)),this},isRunning:function(){return this._isRunning},on:function(){this._enabled=!0},off:function(){this._enabled=!1},destroy:function(){this.stop(),this._dfd.destroy()},_update:function(){var a;for(a in this._props)this._target[a]=this._props[a].value},_step:function(a){var b,c=Date.now()-this._startTime;if(c>=this._duration||a)return this._pos=1,this._isRunning=!1,b=k.indexOf(this),b>=0&&k.splice(b,1),h(this._props,this._pos,!0),this._update(),this._dfd.notify(c,c/this._duration,this._pos),void this._dfd.resolve();this._pos=this._easing(c/this._duration),h(this._props,this._pos,!1),this._update(),this._dfd.notify(c,c/this._duration,this._pos)},_start:function(){this._startTime=Date.now(),d(this),this._step()}}),i.off=function(){l=!1},i.on=function(){l=!0},i.tick=function(){var a,c,d=k.slice(),e=d.length;for(a=0;a<e;a++)c=d[a],c._step();return!!k.length||(b.cancel(j),j=null,!1)},i.clear=function(){},i.easing={linear:function(a){return a},easeInOut:function(a){return.5*(1-n(a*m))}},i.tweens=k;var o=function(){this._onSuccess=[],this._onProgress=[],this._isResolved=!1};return o.prototype={then:function(a){this._onSuccess.push(a),this._isResolved&&a.call(null,[].slice.apply(arguments))},progress:function(a){this._onProgress.push(a)},resolve:function(){this._isResolved=!0;var a,b=this._onSuccess.length;for(a=0;a<b;a++)this._onSuccess[a].apply(null,[].slice.call(arguments))},notify:function(){var a,b=this._onProgress.length;for(a=0;a<b;a++)this._onProgress[a].apply(null,[].slice.call(arguments))},destroy:function(){this._onSuccess=[],this._onProgress=[]}},i}),define("objects.views/charts/components/axis/axis-utils",[],function(){return{getAxisUnitAlignment:function(a,b){return["near","far"].contains(a)?b?a:"near"===a?"far":"near":b?"left"===a?"near":"far":"bottom"===a?"far":"near"},roundToHalf:function(a){var b=Math.round(a);return b-a>=0?b-.5:b+.5},getTicks:function(a){var b=[];return a&&a.forEach(function(a){b.push({position:0,value:a,opacity:1})}),b},getAvgTickWidth:function(a){return!a||a.length<2?0:Math.abs(a[a.length-1]-a[0])/(a.length-1)}}}),define("objects.views/charts/components/axis/continuous-axis",["./axis","./linear-scale","./log-scale","objects.views/charts/components/axis/radial-axis-helper","util","objects.views/charts/utils/tween","./axis-utils","general.utils/shapes/rect","general.utils/shapes/polygon"],function(a,b,c,d,e,f,g){"use strict";function h(a,b){var c,d,e=0,f=a[this._isVertical?"height":"width"],g=0,h=this._style;if(this._isVertical?f-=this._padding.top+this._padding.bottom:f-=this._padding.left+this._padding.right,this.isRadial())e=2*Math.sin(this._relevantAngle/4)*this._fontHeight*h.label.lineHeight;else if(this._isVertical){if(this._calculateScale(f),c=this._formatter,d=this._renderer,c){var i=this._scale.getValues().mainValues.map(function(a){return d.getTextWidth(c.formatValue(a)+"ml",h.label.font)});g=Math.max.apply(null,i.length?i:[0])}e=Math.min(b[this._isVertical?"width":"height"]/3,g<this.outerRect.width/2?g:this.outerRect.width/3)}else e=this._fontHeight*h.label.lineHeight;return this._wantedLabelSpacePerLevel=e,e}function i(){if(this._useTimeScaling)return 0;var a,b,c,d;switch(a=this._formatter,b=a.pattern,c=a.thousandDelimiter,d=a.decimalDelimiter,b){case"#"+c+"##0":return 1;case"#"+c+"##0"+d+"0":return.1;case"#"+c+"##0"+d+"00":case"0%":return.01;case"0"+d+"0%":return.001;case"0"+d+"00%":return 1e-4}return 0}var j={autoStart:!1,duration:500,easing:"easeInOut"},k={onProgress:function(){this._updateTickPositions(),this.invalidateDisplay(),this.fire("changed")},on:function(){this._tickTween.on(),this._linearTween.on()},off:function(){this._tickTween.off(),this._linearTween.off()},to:function(){this._linearTween.stop().to({plotMin:this._scale.plotMin,plotMax:this._scale.plotMax,plotRange:this._scale.plotRange}),this._tickTween.stop().to({ticks:this.ticks})},from:function(){this._linearTween.stop().from({plotMin:this._scale.plotMin,plotMax:this._scale.plotMax,plotRange:this._scale.plotRange}),this._tickTween.stop().from({ticks:this.ticks})},start:function(){this._useTransition&&this._linearTween.willStart()&&(this._tickTween.start(),this._linearTween.start())},end:function(){this._useTransition&&(this._tickTween.end(),this._linearTween.end())},stop:function(){this._tickTween.stop(),this._linearTween.stop()}};return a.extend("ContinuousAxis",{init:function(){this._super.apply(this,[].slice.call(arguments)),this._scaleDetails={showExplicitMinMax:!0,niceNumberEnabled:!0,tickMultiplier:1},this.ticks=[],this.minorTicks=null,this._tickDates=[],this._minorTickDates=[],this._explicitLabels=[],this._defaultFormatter={formatValue:function(a){return String(a)},format:function(a){return String(a)}},this._formatter=this._defaultFormatter,this._useLogScaleIfPossible=!1,this._cacheItems=null,this._useTransition=!1,this._selectedRanges=[],this._initScales(),this._linearTween=new f(this._scale,{},j).progress(k.onProgress.bind(this)),this._tickTween=new f(this,{},j)},_initScales:function(){this._logarithmicScale=new c,this._scale=this._linearScale=new b},setSelectableShapes:function(a){this._cacheItems=a},getDiscreteSpacing:function(){return 4},updateSize:function(){this._super(),this._calculationSize=this._plotSize,this._updateScaleAndTicks(),this._scale.setSize(this._plotSize),this._updateTickPositions(),k.to.call(this),this._changed?(this._changed=!1,k.start.call(this)):k.end.call(this)},getPlotSize:function(){return this._plotSize},calculateValuePositionMappingInfo:function(){this._scale.setSize(this._plotSize),this._scale._calculationSize=this._plotSize,this._scale.calculateLimits()},setUseTransition:function(a){this._super(a),k[a?"on":"off"].call(this)},preRelevantSizeCalculation:function(){this._super(),this._areLabelsVisible=this.isVisible(this._layoutMode)&&this._showLabels},calculatePreliminaryLabelSpace:function(a){var b=0;return this._areLabelsVisible&&(b=h.call(this,a,a)),{relevantLabelSize:b||0,relevantSpacing:0}},calculateLabelSpace:function(a,b,c){var d=0;return this._calculateScale(this._calculationSize),this._areLabelsVisible&&(d=h.call(this,c||a,a)),{relevantLabelSize:d||0,relevantSpacing:0}},_getLabels:function(a,b){var c,d,e,f=a?a.length:0,h=[],i=[],j=[],k=[],l=[],m=[];if(a.forEach(function(a){d=this.getPositionOfValue(a.value),d=g.roundToHalf(d),k.push(d),j.push(a.value),l.push("opacity"in a?a.opacity:1),h.push(a.value+""),i.push(a.qualifiedLabel)},this),f<=1)m=[this._plotSize];else if(b){for(e=this.yMirrorMode?this._padding.left+this._plotSize-k[0]:k[0],m[0]=Math.abs(k[1]-k[0])+e,c=1;c<a.length-1;c++)m.push(Math.abs(k[c]-k[c-1]));m[c]=this.yMirrorMode?k[c]:this._padding.left+this._plotSize-k[c]}else{for(e=this.yMirrorMode?this._padding.left+this._plotSize-k[0]:k[0],m[0]=Math.abs(k[1]-k[0])/2+e,c=1;c<a.length-1;c++)m.push(Math.abs(k[c]-k[c-1])/2+Math.abs(k[c+1]-k[c])/2);e=this.yMirrorMode?k[c]:this._padding.left+this._plotSize-k[c],m[c]=Math.abs(k[c]-k[c-1])/2+e}return{values:j,widths:m,positions:k,opacities:l,labels:h,labelMode:1,labelSpace:this._wantedLabelSpacePerLevel,qualifiedLabels:i[0]?i:null,labelsBetweenTicks:b}},_updateTickPositions:function(){var a,b;for(b=0;b<this.ticks.length;b++)a=this.getPositionOfValue(this.ticks[b].value),this.ticks[b].position=g.roundToHalf(a);for(b=0;b<this.minorTicks.length;b++)a=this.getPositionOfValue(this.minorTicks[b].value),this.minorTicks[b].position=g.roundToHalf(a);if(this._initLevels(),this._updateTickFormatting(this._levels,this._formatter),this.indicators)for(b=0;b<this.indicators.positions.length;b++)a=this.getPositionOfValue(this.indicators.values[b]),this.indicators.positions[b]=g.roundToHalf(a);this._snapTicksAvgWidth=g.getAvgTickWidth(this.indicators?this.indicators.positions:this._levels[0].positions)||this._plotSize},_initLevels:function(){this._levels=[this._getLabels(this.ticks,!1)]},_calculateScale:function(a){if(0!==a){var b,c=this._scaleDetails,d=isNaN(c.realDataMin)?c.dataMin:c.realDataMin,e=isNaN(c.realDataMax)?c.dataMax:c.realDataMax,f=isNaN(c.explicitPlotMin)||null===c.explicitPlotMin?d:c.explicitPlotMin,g=isNaN(c.explicitPlotMax)||null===c.explicitPlotMax?e:c.explicitPlotMax;b=this.isRadial()?96:Math.max(96,this._getApproximateLabelWidth(f,g));var h=this.isVertical()?4*this._fontHeight:b;h=a/(Math.max(2,a/h/c.tickMultiplier+1)-1),this._useLogScaleIfPossible&&f*g>0&&d*e>0?(this._scale=this._logarithmicScale,this.setUseTransition(!1)):this._scale=this._linearScale,c.usedDataMin=d,c.usedDataMax=e,c.minTickSpacingInPixel=h,c.minTickDataSpacing=i.call(this),c.plotSize=this._plotSize,c.calculationSize=void 0!==a?a:this._calculationSize,c.fontHeight=this._fontHeight,Object.keys(c).forEach(function(a){this._scale["_"+a]=c[a]},this),this._scale.calculateTicks()}},_getApproximateLabelWidth:function(a,b,c){var d=this._formatter,e=this._renderer,f=this._style.label.font;return d?Math.max.apply(null,[a,b,(b-a)/2].map(function(a){return e.getTextWidth(d.formatValue(a,c),f)})):0},_generateTickObjects:function(a,b){var c=a.getValues();this.ticks=g.getTicks(c.mainValues,this._padding,b),this.minorTicks=g.getTicks(c.secondaryValues,this._padding,b),this._tickDates=c.mainDates,this._minorTickDates=c.secondaryDates},_updateTickFormatting:function(a,b){for(var c=0;a[0]&&c<a[0].values.length;c++)a[0].labels[c]=b.formatValue(a[0].values[c])},setPlotMin:function(a){this._scaleDetails.explicitPlotMin="number"==typeof a?a:null,this.invalidateProperties("setPlotMin")},getPlotMin:function(){return this._scale.plotMin},setPlotMax:function(a){this._scaleDetails.explicitPlotMax="number"==typeof a?a:null,this.invalidateProperties("setPlotMax")},getPlotMax:function(){return this._scale.plotMax},setTickMultiplier:function(a){this._scaleDetails.tickMultiplier=a||1,this.invalidateProperties("setTickMultiplier")},setSpacingMode:function(a){this._scaleDetails.spacingMode=a,this.invalidateProperties("setSpacingMode")},getSpacingMode:function(){return this._scaleDetails.spacingMode},setShowExplicitMinMax:function(a){this._scaleDetails.showExplicitMinMax=a,this.invalidateProperties("setShowExplicitMinMax")},setLogScale:function(a){this._useLogScaleIfPossible=a,this.invalidateProperties("setLogScale")},getLogScale:function(){return this._scale===this._logarithmicScale},numberFormat:function(a,b){return this._discrete?a:e.numberFormat(a,b||this._precision,this._exponentUsed)},format:function(a){return this._discrete||!this._formatter?a+"":this._formatter.format(a,this._formatPattern)},formatValue:function(a){return this._discrete||!this._formatter?a+"":this._formatter.formatValue(a)},_transition:function(){this._onAnimatitonEnd()},setDataRangeTransition:function(a){this._transitionEnabled=a},setDataRange:function(a,b){return this._scaleDetails.dataMin=a,this._scaleDetails.dataMax=b,this.invalidateDisplay("setDataRange"),this.invalidateProperties("setDataRange"),this},setRealDataRange:function(a,b){this._scaleDetails.realDataMin=a,this._scaleDetails.realDataMax=b,this.invalidateProperties("setRealDataRange")},getDataMin:function(){return this._scaleDetails.dataMin},getDataMax:function(){return this._scaleDetails.dataMax},setNiceNumberEnabled:function(a){this._scaleDetails.niceNumberEnabled!==a&&(this._scaleDetails.niceNumberEnabled=a,this.invalidateProperties("setNiceNumberEnabled"))},setWhiteSpaceOptimizingEnabled:function(a){this._scaleDetails.whiteSpaceOptimizingEnabled=a,this.invalidateProperties("setWhiteSpaceOptimizingEnabled")},getLevels:function(){return this._levels},updateFormatter:function(){if(this.isDimension)this._formatter=this.dimensionFormatter||this._defaultFormatter;else{var a=this.getType().indices;this._formatter=1===a.length&&this.measureFormatters.length?this.measureFormatters[a[0]]:this.combinedMeasuresFormatter||this._defaultFormatter}this._formatter.prepare&&this._formatter.prepare()},_onAnimatitonEnd:function(){this._super(),this.rect.width>0&&this.calculateLabelSpace(this.rect)},_updateProperties:function(){k.from.call(this),this._changed=this._oldIsVertical===this.isVertical()&&"number"==typeof this._scale.plotRange&&!isNaN(this._scale.plotRange),this._oldIsVertical=this.isVertical(),this.updateFormatter(),this._isSizing||this._updateScaleAndTicks()},_updateScaleAndTicks:function(){this._calculateScale(this._calculationSize),this._generateTickObjects(this._scale,this._plotSize),this._updateTickPositions()},clear:function(){this._linearTween.end(),this._tickTween.end(),this._super()},getWidthOfValue:function(){return 1},getSnapTicksAvgWidth:function(){return this._snapTicksAvgWidth},getPositionOfValue:function(a){var b,c=this._scale.plotMin;return b=0===this._scale.plotRange?a>c?100*this._plotSize:a<c?100*-this._plotSize:this._plotSize/2:this._scale.getPositionOfValue(a),(this._isVertical&&!this._reverse||!this._isVertical&&(this._reverse||this.yMirrorMode))&&(b=this._plotSize-b),b+this._padding[this._isVertical?"top":"left"]},getNormalizedValue:function(a){var b=this._scale.plotMin;return 0===this._scale.plotRange?a>b?1:a<b?0:.5:this._scale.getNormalizedValue(a)},getPositionOfNormalizedValue:function(a){var b=this._scale.plotMin,c=this._scale.plotMax;return this.getPositionOfValue(a*(c-b)+b)},getValueOfPosition:function(a){return this._plotSize<=0?NaN:(a-=this._padding[this._isVertical?"top":"left"],(this._isVertical&&!this._reverse||!this._isVertical&&(this._reverse||this.yMirrorMode))&&(a=this._plotSize-a),this._scale.getValueOfPosition(a))},getAngleOfValue:function(a){return d.getAngleOfNormalizedValue((a-this._scale.plotMin)/(this._scale.plotMax-this._scale.plotMin),this)},getAngleOfNormalizedValue:function(a){return d.getAngleOfNormalizedValue(a,this)},isLabelSelected:function(a,b){return this._selectedRanges.some(function(c){return c.min<=a&&c.max>=b})},setSelectedRanges:function(a){this._selectedRanges=a,this._updateTickPositions()},getLabelFromPoint:function(a){if(this.isVertical())return null;var b="far"===this.getAlignment()?1:-1,c=(1+this._style.label.margin)*b,d="near"===this.getAlignment()?this.rect.height-1:0;d+=c;for(var e=null,f=0;f<this._levels.length;++f)if(d+=this._levels[f].labelSpace*b,a.y*b<d*b){e=this._levels[f];break}if(!e)return null;for(f=0;f<e.labels.length;++f){var g=e.positions[f],h=e.positions[f+1];if(a.x>=g&&a.x<h||a.x<=g&&a.x>h)return{label:e.labels[f],start:e.values[f],end:e.values[f+1]}}return null}})}),define("objects.views/charts/components/legend/legend-data",["objects.views/charts/utils/canvas-renderer"],function(a){function b(a){return a.label?a.label:a.min&&a.max?a.min+" - "+(a.isMax?"":"<")+a.max:a.max?"<"+a.max:">"+a.min}function c(a){for(var b=0;a&&a.parent;)b++,a=a.parent;return b}function d(a,b,d){var e={};if(a){var f,g,h,i,j=a.length,k=c(a[0])-b;for(f=0;f<j;f++)if(h=a[f]){for(g=0;g<k&&h.parent;)h=h.parent,g--;i=!isNaN(d)&&d>=0?h.getAttributeDimensions(d):h.id,e[i]?e[i].push(a[f]):e[i]=[a[f]]}}return e}function e(c,e,f,g,m,n,q){var r,s,t,u,v,w,x=[],y=0,z=i,A=Math.min(p,c.length);n=n||0,w=d(e,n,q),f=f||{font:"13px 'QlikView Sans'"},v=a.getAverageLetterWidth(f.font)*l,g>(v+h)*c.length&&(v=g/c.length-h-o);var B={type:"text",fill:0,opacity:1,shape:{text:null,font:f.font,maxWidth:v,align:"left",baseline:"middle",maxNumLines:2}};for(r=0;r<A;r++){var C=c[r];s=C.color.toHex(),B.shape.text=b(C);var D=a.measureTextObject(B);D.height=Math.ceil(D.height),y=Math.max(y,D.width),z=Math.max(z,D.height),"range"===C.type?x.push({text:D.lines.join(" "),height:Math.max(D.height,i)*m,tipText:C.label,marker:"rect",color:s,isDimensionValue:!0,locked:!1,id:C.id,index:C.index,isMax:C.isMax,type:C.type}):x.push({text:D.lines.join(" "),tipText:C.label,height:Math.max(D.height,i)*m,marker:C.marker||"rect",color:s,isDimensionValue:!0,locked:!1,id:C.id,index:C.index,cacheItems:w[C.id],type:C.type})}return t=z,u=Math.max(y+h,j),{viewItems:x,cellHeight:t,cellWidth:u+o+2*k}}function f(b,c,d){var e,f=[],g=0;for(a.setFont(c.font),e=b.length-1;e>=0;e--){var h=b[e],i={colorFrom:h.grad[0].toHex(),colorTo:h.grad[1].toHex(),maxText:d.formatValue(h.max),minText:d.formatValue(h.min),max:h.id[0],min:h.id[1]};f.push(i),g=Math.max(g,a.getTextWidth(i.maxText.substr(0,n)),a.getTextWidth(i.minText.substr(0,n)))}return{viewItems:f,labelHeight:a.getFontHeight(c.font),maxLabelWidth:g+1}}function g(b,c){var d=a.getAverageLetterWidth(c.font)*m,e={type:"text",fill:0,opacity:1,shape:{text:b,font:c.font,maxWidth:d,align:"left",baseline:"middle",maxNumLines:2}},f=a.measureTextObject(e);return{text:f.lines.join(" "),fullText:b,height:f.height,width:f.width+o}}var h=26,i=26,j=54,k=4,l=20,m=15,n=10,o=1,p=100;return{prepareDiscreteData:e,prepareContinousData:f,prepareLegendTitle:g,Modes:{DISCRETE:"discrete",CONTINOUS:"continous"},constants:{PADDING:k}}}),define("client.utils/state",["core.utils/notification","general.controllers/route-controller"],function(a,b){"use strict";var c,d,e,f,g,h,i={};return i.States={analysis:0,edit:1,play:2,editstory:3},i.Views={overview:0,sheet:1,story:2,object:3,masterObject:4,dataManager:7,dataSpaceScriptEditor:8,dataSpaceAssociations:9,dataSpaceDataModel:10},a.mixin(i),i.notification("StateChanged"),i.notification("SheetChanged"),i.notification("StoryChanged"),i.setState=function(a){a!==d&&(g=d,d=a,i.StateChanged.emit(c,d,h,g),c===i.Views.sheet||c===i.Views.object||c===i.Views.masterObject?b.setUrl(b.buildUrl("sheet",e.layout.qInfo.qId,"state",Object.keys(i.States)[a])):c===i.Views.story&&b.setUrl(b.buildUrl("story",e.layout.qInfo.qId,"state",Object.keys(i.States)[a],"slide",f)))},i.setView=function(a){a!==c&&(h=c,c=a,a===i.Views.overview&&(e=null),i.StateChanged.emit(c,d,h,g))},i.setSheet=function(a,b){var f=!1;a!==e&&(e=a,h=c,c=i.Views.sheet,i.SheetChanged.emit(a),f=!0),i.States[b]!==d&&(g=d,d=i.States[b]||i.States.analysis,f=!0),f&&i.StateChanged.emit(c,d,h,g)},i.setStory=function(a,b,j){var k=!1;a!==e&&(e=a,h=c,c=i.Views.story,i.StoryChanged.emit(a),k=!0),f=j,i.States[b]!==d&&(g=d,d=i.States[b]||i.States.editstory,k=!0),k&&i.StateChanged.emit(c,d,h,g)},i.isInAnalysisMode=function(){return d===i.States.analysis},i.isInEditMode=function(){return d===i.States.edit},i.inStoryPlayState=function(){return i.inStorytelling()&&d===i.States.play},i.inStorytelling=function(){return c===i.Views.story},i.inAppOverView=function(){return c===i.Views.overview},i.inDataManager=function(){return c===i.Views.dataManager},i.inDataSpaceScriptEditor=function(){return c===i.Views.dataSpaceScriptEditor},i.inDataSpaceDataModel=function(){return c===i.Views.dataSpaceDataModel},i.inSheetView=function(){return c===i.Views.sheet},i.inObjectView=function(){return c===i.Views.object},i.inMasterObjectView=function(){return c===i.Views.masterObject},i.getModel=function(){return i.model},Object.defineProperties(i,{state:{get:function(){return d}},view:{get:function(){return c}},model:{get:function(){return e},set:function(a){e=a}}}),i}),define("objects.views/charts/components/chart-component-angular",["jquery","qvangular","./chart-component"],function(a,b,c){"use strict";return c.extend({init:function(c,d,e,f){this._super(c,d,e);var g=b.getService("$compile");this._innerContainer=a(f).appendTo(a(this.container)),g(this._innerContainer)(a(this.container).scope().$new()),this._innerScope=this._innerContainer.scope()},getInnerContainer:function(){return this._innerContainer},setYMirrorMode:function(a){this._super(a),this._innerScope.options.direction=this.readDirection},getInnerContainerScope:function(){return this._innerScope},release:function(){this._super(),this._innerContainer.remove(),this._innerContainer=null,this._innerScope.$destroy(),this._innerScope=null}})}),define("text!objects.views/charts/components/legend/color-legend.ng.html",[],function(){return'<div qva-direction x-dir-setting="{{options.yMirrorMode ? \'rtl\' : \'ltr\'}}" class="color-legend">\n    <div qv-discrete-legend\n         ng-if="discrete && visible"\n         view-items="viewItems"\n         options="options">\n    </div>\n\n\t<div qv-continous-legend\n\t\t ng-if="!discrete && visible"\n\t\t view-items="viewItems"\n\t\t options="options"></div>\n</div>\n'}),/**
 * @preserve IntegraXor Web SCADA - JavaScript Number Formatter
 * http://www.integraxor.com/
 * author: KPL, KHL
 * (c)2011 ecava
 * Dual licensed under the MIT or GPL Version 2 licenses.
 */
define("assets/external/numberformatter/format",[],function(){return function(a,b){if(!a||isNaN(+b))return b;var b="-"==a.charAt(0)?-b:+b,c=b<0?b=-b:0,d=a.match(/[^\d\-\+#]/g),e=d&&d[d.length-1]||".",f=d&&d[1]&&d[0]||",",a=a.split(e);b=b.toFixed(a[1]&&a[1].length),b=+b+"";var g=a[1]&&a[1].lastIndexOf("0"),h=b.split(".");(!h[1]||h[1]&&h[1].length<=g)&&(b=(+b).toFixed(g+1));var i=a[0].split(f);a[0]=i.join("");var j=a[0]&&a[0].indexOf("0");if(j>-1)for(;h[0].length<a[0].length-j;)h[0]="0"+h[0];else 0==+h[0]&&(h[0]="");b=b.split("."),b[0]=h[0];var k=i[1]&&i[i.length-1].length;if(k){for(var l=b[0],m="",n=l.length%k,o=0,p=l.length;o<p;o++)m+=l.charAt(o),!((o-n+1)%k)&&o<p-k&&(m+=f);b[0]=m}return b[1]=a[1]&&b[1]?e+b[1]:"",(c?"-":"")+b[0]+b[1]}}),define("objects.utils/number-formatter",["core.utils/class","util","assets/external/numberformatter/format"],function(a,b,c){"use strict";function d(a,b,c,d){return a=a.toString(b),c[1]===c[1].toUpperCase()&&(a=a.toUpperCase()),a.length-a.indexOf(".")>10&&(a=a.slice(0,a.indexOf(".")+11)),a.replace(".",d||".")}function e(a,b,c){var e;return m.test(b)?a=d(a,Number(/\d{2}/.exec(b)[0]),b,c):n.test(b)?a=d(a,8,b,c):o.test(b)?a=d(a,10,b,c):p.test(b)?a=d(a,16,b,c):q.test(b)?a=d(a,2,b,c):r.test(b)&&(e="",a<0&&(e="-",a=-a),a=Math.floor(a),0===a?a="0":a<=5e5?(a=f(a,b),a=e+a):a=b+e+a.toExponential(0)),a}function f(a,b){for(var c,d="",e=Number(String(a).slice(-3)),f=(a-e)/1e3,g=[0,1,4,5,9,10,40,50,90,100,400,500,900].reverse(),h=["0","I","IV","V","IX","X","XL","L","XC","C","CD","D","CM"].reverse();e>0;)for(c=0;c<g.length;c++)if(g[c]<=e){d+=h[c],e-=g[c];break}for(c=0;c<f;c++)d="M"+d;return b[1]!==b[1].toUpperCase()&&(d=d.toLowerCase()),d}function g(a,b,c){var d,e,f,g,j,k,m,n,o,p=a.pattern;p.indexOf("A")>=0&&(p=p.replace("A",""),a.abbreviate=!0),o=i(b,c),f=p.match(o),f=f?f[0]:"",g=f?p.substr(0,p.indexOf(f)):p,j=f?p.substring(p.indexOf(f)+f.length):"",f||(f=p?"#":"##########"),b&&b===c&&(d=f.split(c),e=d.pop(),f=d.join("")+c+e,b=""),k=b,b=/,/.test(c)?"¤":",",k&&(f=f.replace(h(k,"g"),b)),m=c,c=".",m&&(f=f.replace(h(m,"g"),c)),n=f.match(/#/g),n=n?n.length:0,a.prefix=g||"",a.postfix=j||"",a.pattern=p,a.percentage=l.test(p),a.numericPattern=f||"",a.numericRegex=new RegExp(h(b,null,!0)+"|"+h(c,null,!0),"g"),a.groupTemp=k,a.decTemp=m,a.t=b,a.d=c,a.temp=n}function h(a,c,d){var e=b.escapeRegExp(a);return d?e:new RegExp(e||"",c)}function i(a,c){return c&&(c=b.escapeRegExp(c)),a&&(a=b.escapeRegExp(a)),new RegExp("(?:[#0]+"+a+")?[#0]+(?:"+c+"[#0]+)?")}var j,k={3:"k",6:"M",9:"G",12:"T",15:"P",18:"E",21:"Z",24:"Y","-3":"m","-6":"μ","-9":"n","-12":"p","-15":"f","-18":"a","-21":"z","-24":"y"},l=/%$/,m=/^\(r(0[2-9]|[12]\d|3[0-6])\)/i,n=/^\(oct\)/i,o=/^\(dec\)/i,p=/^\(hex\)/i,q=/^\(bin\)/i,r=/^\(rom\)/i,s=/^(\(rom\)|\(bin\)|\(hex\)|\(dec\)|\(oct\)|\(r(0[2-9]|[12]\d|3[0-6])\))/i;return j=a.extend("NumberFormatter",{init:function(a,b,c,d,e){this.localeInfo=a,this.pattern=b,this.thousandDelimiter=c||",",this.decimalDelimiter=d||".",this.type=e||"numeric",this.prepare()},clone:function(){var a=new j(this.localeInfo,this.pattern,this.thousandDelimiter,this.decimalDelimiter,this.type);return a.subtype=this.subtype,a},format:function(a,b,c,d){return this.prepare(b,c,d),this.formatValue(a)},prepare:function(a,b,c){var d,e;if(void 0===a&&(a=this.pattern),void 0===b&&(b=this.thousandDelimiter),void 0===c&&(c=this.decimalDelimiter),!a)return void(this._prepared={pattern:!1});this._prepared={positive:{d:c,t:b,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""},negative:{d:c,t:b,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""}},d=this._prepared,a=a.split(";"),d.positive.pattern=a[0],d.negative.pattern=a[1],s.test(a[0])&&(d.positive.isFunctional=!0),a[1]?s.test(a[1])&&(d.negative.isFunctional=!0):d.negative=!1,(e=d.positive.isFunctional&&(!d.negative||d.negative&&d.negative.isFunctional))||(g(d.positive,b,c),d.negative&&g(d.negative,b,c))},formatValue:function(a){var b,d,f,g,h,i,j,l,m,n=this._prepared,o="",p="";if(isNaN(a))return a;if(n.pattern===!1)return a.toString();if(a<0&&n.negative?(n=n.negative,a=-a):n=n.positive,h=n.d,i=n.t,n.isFunctional)a=e(a,n.pattern,h);else{if(n.percentage&&(a*=100),n.abbreviate&&(d=Number(Number(a).toExponential().split("e")[1]),(d-=d%3)in k&&(o=k[d],a/=Math.pow(10,d))),f=Math.abs(a),b=n.temp,l=n.numericPattern,m=l.split(h)[1],"I"===this.type&&(a=Math.round(a)),g=a,m||"#"!==l.slice(-1)[0])if(f>=1e15||f>0&&f<=1e-14)a=f?f.toExponential(15).replace(/\.?0+(?=e)/,""):"0";else{var q=Number(a.toFixed(Math.min(20,m?m.length:0)).split(".")[0]),r=l.split(h)[0];if(r+=h,a=c(r,q)||"0",m){var s=Math.max(0,Math.min(14,m.length)),t=m.replace(/#+$/,"").length,u=(f%1).toFixed(s).slice(2).replace(/0+$/,"");for(j=u.length;j<t;j++)u+="0";u&&(a+=h+u)}else 0===q&&(g=0)}else if(f>=Math.pow(10,b)||f<1||f<1e-4)0===a?a="0":f<1e-4||f>=1e20?(a=g.toExponential(Math.max(1,Math.min(14,b))-1),a=a.replace(/\.?0+(?=e)/,""),p=""):(a=a.toPrecision(Math.max(1,Math.min(14,b))),a.indexOf(".")>=0&&(a=a.replace(a.indexOf("e")<0?/0+$/:/\.?0+(?=e)/,""),a=a.replace(".",h)));else{for(l+=h,b=Math.max(0,Math.min(20,b-Math.ceil(Math.log(f)/Math.log(10)))),j=0;j<b;j++)l+="#";a=c(l,a)}a=a.replace(n.numericRegex,function(a){return a===i?n.groupTemp:a===h?n.decTemp:""}),g<0&&!/^\-/.test(a)&&(a="-"+a)}return n.prefix+a+p+o+n.postfix}}),window.NumberFormatter=j,j.getStaticFormatter=function(){return{prepare:function(){},formatValue:function(a){return a+""}}},j}),define("text!objects.views/charts/components/legend/continous-legend.ng.html",[],function(){return'<div class="qv-continous-color-legend"\n\t ng-class="cclOrientationClass"\n\t ng-style="options.titleStyle">\n\t<div class="cl-title ccl-title"\n\t\t ng-if="options.legendTitle"\n\t\t ng-class="cclOrientationClass">\n\t\t<div qva-direction x-dir-text="{{options.legendTitle}}" x-dir-setting="{{options.yMirrorMode ? \'rtl\' : \'ltr\'}}" class="ccl-title-inner"\n\t\t\t title="{{options.legendTitleTooltip}}">{{options.legendTitle}}</div>\n\t</div>\n    <div class="ccl-gradient"\n\t\t ng-class="cclOrientationClass"\n\t\t tid="ccl.gradient">\n        <div class="ccl-axis" ng-class="cclOrientationClass"  ng-style="options.labelStyle">\n\t\t\t<div ng-repeat="axisVal in axisValues track by $index" class="ccl-axis-value" ng-class="{\'first\': $first, \'last\':$last}" dir="ltr">{{axisVal}}</div>\n            <!--\n                <div class="ccl-axis-top-value">{{axisValues[1]}}</div>\n                <div class="ccl-axis-bottom-value">{{axisValues[0]}}</div>\n                -->\n        </div>\n\t\t<div class="ccl-gradient-color"\n\t\t\t ng-class="cclOrientationClass"\n\t\t\t qva-apply-style="cclGradientStyle">\n\t\t</div>\n\t\t<div dir="ltr" class="ccl-range"\n\t\t\t ng-show="selectionEnabled && !isLocked"\n\t\t\t ng-style="cclRangeStyle"\n\t\t\t ng-class="cclOrientationClass">\n\t\t\t<div ng-show="active" class="ccl-range-inner"\n\t\t\t\t ng-class="cclOrientationClass"\n\t\t\t\t ng-style="rangeStyle">\n\t\t\t\t<div class="ccl-axis-cover"\n\t\t\t\t\t ng-style="active && cclCoverStyle"\n\t\t\t\t\t tid="ccl.cover"\n\t\t\t\t\t ng-class="{\'active\' : activeOptions.cover}"></div>\n\t\t\t\t<div class="ccl-far-edge"\n\t\t\t\t\t tid="ccl.edge.far"\n\t\t\t\t\t ng-class="{\'active\' : activeOptions.far}">\n\t\t\t\t</div>\n\t\t\t\t<div class="ccl-near-edge"\n\t\t\t\t\t tid="ccl.edge.near"\n\t\t\t\t\t ng-class="{\'active\' : activeOptions.near}">\n\t\t\t\t</div>\n\t\t\t\t<div class="ccl-outer-bubble-wrapper"\n\t\t\t\t\t ng-class="active && cclOrientationClass">\n                    <qva-range-selection-bubble visible="active" active-component="fakeAxis" handle-points="handlePoints" horizontal="!options.vertical" far="false" data="values.start" active="activeOptions.near" tid="ccl.bubble.near"> </qva-range-selection-bubble>\n                    <qva-range-selection-bubble visible="active" active-component="fakeAxis" handle-points="handlePoints" horizontal="!options.vertical" far="true" data="values.end" active="activeOptions.far" tid="ccl.bubble.far"> </qva-range-selection-bubble>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'}),define("general.utils/shapes/point",[],function(){"use strict";function a(a,b){0===arguments.length?this.set(0,0):this.set(a,b)}return a.prototype={toString:function(){return this.x+" "+this.y},clone:function(){return new a(this.x,this.y)},set:function(a,b){this.x=a,this.y=b},equal:function(a){return this.x===a.x&&this.y===a.y},closeTo:function(a,b){return!!a&&(Math.abs(this.x-a.x)<b&&Math.abs(this.y-a.y)<b)},distanceTo:function(a){return a?Math.sqrt(Math.pow(this.x-a.x,2)+Math.pow(this.y-a.y,2)):NaN}},a}),define("general.directives/apply-style",["jquery","qvangular"],function(a,b){b.directive("qvaApplyStyle",function(){return{restrict:"A",link:function(b,c,d){b.$watch(d.qvaApplyStyle,function(b){"string"===a.type(b)&&c.attr("style",b)},!1)}}})}),define("objects.views/charts/components/legend/qv-continous-legend",["touche","qvangular","text!./continous-legend.ng.html","general.utils/shapes/point","general.directives/apply-style"],function(a,b,c,d){function e(a,b,c){var d,e,f,g=c?o:p;if(e="",f=")",b)for(d=a.length-1;d>0;d--)e+=", "+a[d]+" "+100/(a.length-1)*(a.length-1-d)+"%";else for(d=0;d<a.length;d++)e+=", "+a[d]+" "+100/(a.length-1)*d+"%";return"background:"+a[a.length/2]+"; background:"+g.moz+e+f+"; background:"+g.webkit+e+f+"; background:"+g.opera+e+f+"; background:"+g.ie+e+f+"; background:"+g.w3c+e+f}function f(a,b,c){return b?a[0][c]>a[1][c]?0:1:a[0][c]<a[1][c]?0:1}function g(a){return["left","bottom"].contains(a)}function h(a,b,c){var d=c?b.height():b.width(),e=c?"y":"x";a[0][e]=m(n(a[0][e],0),d),a[1][e]=m(n(a[1][e],0),d)}function i(a,b,c,e){var f=[];return c?(f[b]=new d(a[b].x,a[b].y+e),f[1^b]=a[1^b]):(f[b]=new d(a[b].x+e,a[b].y),f[1^b]=a[1^b]),f}function j(a,b){var c=a.find(".ccl-axis");return b?c.outerWidth():c.outerHeight()}function k(a,b){return{vertical:a.options.vertical,direction:a.options.vertical?"y":"x",grt:a.options.vertical?b:!b}}var l=".legendRangeSelection",m=Math.min,n=Math.max,o={moz:"-moz-linear-gradient(bottom",webkit:"-webkit-linear-gradient(bottom",opera:" -o-linear-gradient(bottom",ie:"-ms-linear-gradient(bottom",w3c:"linear-gradient(to top"},p={moz:"-moz-linear-gradient(left",webkit:"-webkit-linear-gradient(left",opera:" -o-linear-gradient(left",ie:"-ms-linear-gradient(left",w3c:"linear-gradient(to right"};b.directive("qvContinousLegend",function(){return{template:c,replace:!0,scope:!0,link:function(b,c){function m(a){if(b.positionToFormattedValue&&a){var c,d;return b.options.vertical?(c=y.rangeElement.height(),d=1-a.y/c):(c=y.rangeElement.width(),d=a.x/c),b.positionToFormattedValue(d)}return a+""}function n(){if(!x&&b.selectionEnabled){x=!0;var c,e="hey";a(y.gradient[0]).swipe({id:l,options:{preventDefault:!0},start:function(d,e){if(!b.isLocked){var f=e.pagePoints[0];c=u(f.x,f.y),a.preventGestures(this.gestureHandler),q(d,e)}},update:function(a,d){if(!b.isLocked){b.active=!0,b.swiping=!0;var e=d.pagePoints[0];b.handlePoints=[c,u(e.x,e.y)],b.updateHandlePoints(b.handlePoints),b.$digest()}},end:function(){if(b.isLocked)return void r();b.swiping=!1,t()}}),a(y.axisCover[0]).tap({id:l,options:{preventDefault:!0},start:function(){a.preventGestures(this.gestureHandler)}}).swipe({id:l,options:{preventDefault:!0},start:function(c,d){e=b.handlePoints,a.preventGestures(this.gestureHandler),q(c,d),b.activeOptions.cover=!0},update:function(a,c){var f=b.options.vertical?c.swipe.deltaY:0,g=b.options.vertical?0:c.swipe.deltaX;b.handlePoints=[new d(e[0].x+g,e[0].y+f),new d(e[1].x+g,e[1].y+f)],b.updateHandlePoints(b.handlePoints),b.$digest()},end:function(){t(),b.activeOptions.cover=!1}}),a.utils.touch||(o(y.farEdge[0],!1),o(y.nearEdge[0],!0)),b.$broadcast("on")}}function o(c,d){var e,g,h,j=k(b,d);a(c).tap({id:l,options:{preventDefault:!0},start:function(){a.preventGestures(this.gestureHandler)}}).swipe({id:l,options:{radiusThreshold:0},start:function(c,h){j=k(b,d),g=f(b.handlePoints,j.grt,j.direction),e=b.handlePoints,a.preventGestures(this.gestureHandler),q(c,h)},update:function(a,c){b.handlePoints=i(e,g,j.vertical,j.vertical?c.swipe.deltaY:c.swipe.deltaX),b.updateHandlePoints(b.handlePoints),b.activeOptions.near=b.activeOptions.far=!1,h=f(b.handlePoints,j.grt,j.direction)?"far":"near",b.activeOptions[h]=!0,b.$digest()},end:function(){t(b.handlePoints),b.activeOptions.near=b.activeOptions.far=!1,b.$digest()}})}function p(){b.active=!1,Object.keys(y).forEach(function(b){a(y[b][0]).off("*",l)}),x=!1,b.$broadcast("off")}function q(a,c){b.$emit("rangeStart",a,c)}function r(){b.$emit("selectWhileLocked")}function s(a,c){b.$emit("rangeUpdate",a,b.options.vertical?y.rangeElement.height():y.rangeElement.width(),c)}function t(){var a;b.options.vertical&&b.handlePoints[0].y<b.handlePoints[1].y?(a=[],a[1]=b.handlePoints[0],a[0]=b.handlePoints[1],b.handlePoints=a):!b.options.vertical&&b.handlePoints[0].x>b.handlePoints[1].x&&(a=[],a[1]=b.handlePoints[0],a[0]=b.handlePoints[1],b.handlePoints=a),b.$emit("rangeEnd")}function u(a,b){var c=y.rangeElement.offset();return new d(a-c.left,b-c.top)}function v(a,d,e){y.nearBubbleWrapper||(y.nearBubbleWrapper=c.find(".ccl-outer-bubble-wrapper .bubble-wrapper.near"),y.nearBubble=c.find(".ccl-outer-bubble-wrapper .bubble-wrapper.near .bubble"),y.farBubbleWrapper=c.find(".ccl-outer-bubble-wrapper .bubble-wrapper.far"),y.farBubble=c.find(".ccl-outer-bubble-wrapper .bubble-wrapper.far .bubble")),y.nearBubbleWrapper.css(b.cclBubbleNearStyle),y.farBubbleWrapper.css(b.cclBubbleFarStyle);var f=w(a,e);f=f>0?f:0,e?y.nearBubble.css({"margin-left":Math.round(f)+"px"}):y.farBubble.css({"margin-right":Math.round(f)+"px"})}function w(a,b){return a?0:b?c.offset().left-(y.nearBubbleWrapper.offset().left-.5*y.nearBubbleWrapper.width()-5):y.farBubbleWrapper.offset().left-c.offset().left+1.5*y.farBubbleWrapper.width()+5-c.width()}var x=!1,y={gradient:c.find(".ccl-gradient"),rangeElement:c.find(".ccl-range"),rangeInner:c.find(".ccl-range-inner"),axisCover:c.find(".ccl-axis-cover"),nearEdge:c.find(".ccl-near-edge"),farEdge:c.find(".ccl-far-edge")};b.fakeAxis={getPositionOfValue:function(a){var c=b.viewItems[0].min,d=b.viewItems[b.viewItems.length-1].max,e=(a-c)/(d-c),f=b.options.vertical?y.rangeElement.height():y.rangeElement.width();return(b.options.vertical||!b.options.vertical&&b.options.yMirrorMode)&&(e=1-e),e*f},isDiscrete:function(){return!1}},b.activeOptions={far:!1,near:!1,cover:!1},b.values={start:{},end:{}},b.setRangeStyle=function(a){if(a&&2===a.length){b.relevantSize=j(c,b.options.vertical);var d=a[0],e=a[1],f=b.options.vertical?"y":"x";b.options.vertical?b.rangeStyle={height:Math.abs(d[f]-e[f]),top:Math.min(d[f],e[f])}:b.rangeStyle={width:Math.abs(d[f]-e[f]),left:Math.min(d[f],e[f])}}},b.updateHandleValues=function(a,c){if(h(a,y.rangeElement,b.options.vertical),b.setRangeStyle(a),b.active){var d=b.options.vertical?"y":"x",e=b.options.vertical?y.rangeElement.height():y.rangeElement.width(),i=a[f(b.handlePoints,b.options.vertical,d)],j=a[f(b.handlePoints,!b.options.vertical,d)];if(b.values.start.text=b.cclNearValueLabel=m(i),b.values.end.text=b.cclFarValueLabel=m(j),c){if(c.switch){var k=b.values.start.value;b.values.start.value=b.values.end.value,b.values.end.value=k}var l=b.viewItems[0].min,n=b.viewItems[b.viewItems.length-1].max;0===c.index?b.values.start.value=Math.max(Math.min(c.value,n),l):b.values.end.value=Math.max(Math.min(c.value,n),l)}else b.options.vertical?(b.values.start.value=b.positionToValue((e-i[d])/e),b.values.end.value=b.positionToValue((e-j[d])/e)):(b.values.start.value=b.positionToValue(i[d]/e),b.values.end.value=b.positionToValue(j[d]/e))}if(b.active&&b.options){var o=g(b.options.dock);v(b.options.vertical,o,!1),v(b.options.vertical,o,!0)}},b.updateHandlePoints=function(a){a&&(b.updateHandleValues(a),s(b.handlePoints))},b.$on("rangeUpdate",function(a,c,d,e){isNaN(d)&&(b.handlePoints=[c[0],c[1]],b.updateHandleValues(b.handlePoints,e),b.$digest(),s(c,e),a.stopPropagation())}),b.$watchCollection("[viewItems, options.yMirrorMode, options.vertical]",function(a){var c=a[0],d=a[1],f=a[2],g=d&&!f;if(c&&c.length){for(var h=[c[0].colorTo],i=0;i<c.length;i++)h.push(c[i].colorFrom);b.cclGradientStyle=e(h,g,f);var j=[c[0].minText,c[c.length-1].maxText];f&&j.reverse(),b.axisValues=j}});var z={right:"",bottom:""},A={right:"0px",bottom:""},B={bottom:"0px",right:""};b.$watchCollection("[options.vertical, options.dock, relevantSize]",function(a){var c=a[0],d=g(a[1]),e=a[2];b.cclOrientationClass={vertical:c,horizontal:!c,near:d,far:!d},d?(b.cclCoverStyle=c?{left:"0px",width:e+"px"}:{bottom:"0px",height:e+"px"},b.cclBubbleNearStyle=c?z:B,b.cclBubbleFarStyle=c?z:B):(b.cclCoverStyle=c?{right:"0px",width:e+"px"}:{top:"0px",height:e+"px"},b.cclBubbleNearStyle=c?A:z,b.cclBubbleFarStyle=c?A:z)}),n.call(this),b.$watch("selectionEnabled",function(a){a?n.call():p.call()}),b.$on("$destroy",function(){p.call()}),b.$on("cancelSelection",function(){b.active=!1})}}})}),define("text!objects.views/charts/components/legend/discrete-legend.ng.html",[],function(){return'<div class="qv-discrete-color-legend"\n\t ng-class="{ \'vertical\': options.vertical }"\n\t ng-style="options.labelStyle">\n\t<div class="cl-title dcl-title"\n\t\t ng-if="options.legendTitle && options.legendTitle.length"\n\t\t ng-style="options.titleStyle"\n\t\t ng-class="{\'vertical\': options.vertical }">\n\t\t<div class="dcl-title-inner" title="{{options.legendTitleTooltip}}" qva-direction x-dir-text="{{options.legendTitle}}" x-dir-setting="{{options.yMirrorMode ? \'rtl\' : \'ltr\'}}">{{options.legendTitle}}</div>\n\t</div>\n\t<div class="dcl-flex" ng-class="{\'align\': align, \'vertical\': options.vertical, \'in-selections\': selectionsApi.active }"\n\t\t qv-selections-toggle-dimension-value="{ selector: \'.color-item\', itemKey: \'item\' }"\n\t\t qv-selections-on-toggle-dimension-value="selectionEnabled && !isScrolling && select($event, item)">\n\t\t<div ng-repeat="item in viewItems track by $index"\n\t\t\t ng-style="{\'height\':item.height,  \'width\': (options.vertical ? \'auto\' : options.cellWidth)}"\n\t\t\t class="color-item" ng-class="{\'selected\': item.selected}"\n\t\t\t tid="dcl.item">\n\t\t\t<div class="marker">\n\t\t\t\t<div ng-style="item.markerClass[\'glyph-triangle\']  ? {\'border-bottom-color\': item.color} : ( item.markerClass[\'glyph-inverse-triangle\'] ? {\'border-top-color\': item.color} : {background: item.color} )" ng-class="item.markerClass"></div>\n\t\t\t</div>\n\t\t\t<div qva-direction x-dir-text="{{item.text}}" class="text"\n\t\t\t\t title="{{item.tipText}}">{{item.text}}</div>\n\t\t</div>\n\t</div>\n\t<div class="dcl-buttons-v" ng-show="options.vertical && overflow">\n\t\t<!--DOWN-->\n\t\t<button class="dcl-down lui-fade-button" ng-disabled="!interactionEnabled || scrollAtEnd" tid="dcl.down">\n\t\t\t<span class="lui-button__icon lui-icon lui-icon--triangle-bottom"></span>\n\t\t</button>\n\t\t<!--UP-->\n\t\t<button class="dcl-up lui-fade-button" ng-disabled="!interactionEnabled || scrollAtStart" tid="dcl.up">\n\t\t\t<span class="lui-button__icon lui-icon lui-icon--triangle-top"></span>\n\t\t</button>\n\t</div>\n\t<div class="dcl-buttons-h" ng-show="!options.vertical && overflow">\n\t\t<!--RIGHT-->\n\t\t<button class="dcl-right lui-fade-button" ng-disabled="!interactionEnabled || scrollAtEnd" tid="dcl.right">\n\t\t\t<span class="lui-button__icon lui-icon lui-icon--triangle-right"></span>\n\t\t</button>\n\t\t<!--LEFT-->\n\t\t<button class="dcl-left lui-fade-button" ng-disabled="!interactionEnabled || scrollAtStart" tid="dcl.left">\n\t\t\t<span class="lui-button__icon lui-icon lui-icon--triangle-left"></span>\n\t\t</button>\n\t</div>\n</div>\n'}),define("objects.utils/event-utils",["qvangular","touche"],function(a){"use strict";function b(a,b){a.gestures.forEach(function(c){c!==b&&a.cancelGesture(c)})}function c(a){var b=0,c=0,d=0;return a.wheelDelta&&(b=a.wheelDelta/60),a.detail&&(b=-a.detail/3),d=b,void 0!==a.axis&&a.axis===a.HORIZONTAL_AXIS&&(d=0,c=-1*b),void 0!==a.wheelDeltaY&&(d=a.wheelDeltaY/60),void 0!==a.wheelDeltaX&&(c=-1*a.wheelDeltaX/60),{delta:b,deltaX:c,deltaY:d,x:a.pageX,y:a.pageY}}function d(a,b,c){var d,e;return function(){var f=c||this,g=+new Date,h=arguments;d&&g<d+b?(clearTimeout(e),e=setTimeout(function(){d=g,a.apply(f,h)},b)):(d=g,a.apply(f,h))}}function e(a,b,c){return function(){var d,e=this,g=arguments;c=c||i,f(c),d=setTimeout(function(){a.apply(e,g)},b),c.debounceTimer=d}}function f(a){a=a||i,a.debounceTimer&&clearTimeout(a.debounceTimer),a.debounceTimer=null}function g(b){b&&(b=b.map(function(a){return a.qGroupFieldDefs?a.qGroupFieldDefs[a.qGroupPos||0]:a.qFallbackTitle}),a.$rootScope.$broadcast("locked-feedback",[b]),e(function(){a.$rootScope.$broadcast("locked-feedback",[b,!0])},100)())}var h=Touche.Gesture.augment(function(a){function b(){a.apply(this,arguments)}return this.defaults={which:2,radiusThreshold:3},this.start=function(a,b){Touche.utils.touch||Touche.utils.msPointer&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType||this.isValidMouseButton(a,this.options.which)&&(this.initiated=!0,b.startPoint=b.points[0],this.binder.start.call(this,a,b))},this.update=function(a,b){!this.started&&b.startPoint&&b.startPoint.distanceTo(b.points[0])>=this.options.radiusThreshold?(this.started=!0,this.binder.update.call(this,a,b)):this.started&&this.binder.update.call(this,a,b)},this.end=function(a,b){this.initiated&&(this.binder.end.call(this,a,b),this.initiated=!1)},b});Touche.gestures.add("wheelswipe",h);var i={debouceTimer:null};return{getMouseWheelData:c,cancelGestures:b,throttle:d,debounce:e,cancelDebounce:f,showLockedFeedback:g}}),define("objects.grid/directives/selections",["qvangular","jquery","touche"],function(a,b,c){"use strict";a.directive("qvSelectionsToggleValue",["$parse",function(a){return{restrict:"A",link:function(c,d,e){var f=a(e.qvSelectionsToggleValue)(),g=f.selector,h="."+c.$id+"-toggle-value",i=f.itemKey||"cell";d.on("qv-activate"+h,g,function(a){var d=b(a.target).closest(g),f=d.scope()[i];d.length&&f&&c.$apply(function(){var b={$event:a};b[i]=f,c.$eval(e.qvSelectionsOnToggleValue,b)})}),c.$on("$destroy",function(){d.off(h)})}}}]),a.directive("qvSelectionsToggleDimensionValue",["$parse",function(a){return{restrict:"A",link:function(c,d,e){var f=a(e.qvSelectionsToggleDimensionValue)(),g=f.selector,h="."+c.$id+"-toggle-dimension-value",i=f.itemKey||"cell";d.on("qv-activate"+h,g,function(a){var d=b(a.target).closest(g),f=d.scope()[i];if(!c.$eval(e.qvSelectionsExcludeToggleDimensionValue,{$event:a})&&f&&f.isDimensionValue)return f.locked?void c.$eval(e.qvSelectionsSelectWhileLocked):void c.$apply(function(){var b={$event:a};b[i]=f,c.$eval(e.qvSelectionsOnToggleDimensionValue,b)})}),c.$on("$destroy",function(){d.off(h)})}}}]),a.directive("qvSelectionsMultiselect",["$parse",function(a){return{restrict:"A",controller:function(){},link:function(d,e,f,g){function h(){return c(e[0]).tap({id:q,options:{preventDefault:!1},start:function(a){l=b(a.target).closest(o)}}),c(e[0]).swipe({id:q,options:{radiusThreshold:4,preventDefault:!1},start:function(a){var b,e;return c.utils.isMouse(a)&&l.length?(b=l.scope()[p],b.isDimensionValue?b.locked?(d.$eval(f.qvSelectionsSelectWhileLocked),void this.cancel()):(m=b,e={$event:a},e[p]=b,void d.$apply(d.$eval(f.qvSelectionsStartMultiselect,e))):void this.cancel()):void this.cancel()},update:function(a){var c,e=b(a.target).closest(o);e.length&&(c=e.scope()[p],d.$apply(d.$eval(f.qvSelectionsUpdateMultiselect,{start:m,current:c,dataColIx:c.dataColIx})))},end:function(a){d.$apply(d.$eval(f.qvSelectionsEndMultiselect,{$event:a}))}}),function(){c(e[0]).off("*",q)}}function i(){return c(e[0]).tap({id:r,options:{touches:2,preventDefault:!1},end:function(a,c){var e,g,h,i,j,k,l,m=c.pagePoints[0],n=c.pagePoints[1];if(e=m?b(document.elementFromPoint(m.x,m.y)):void 0,g=n?b(document.elementFromPoint(n.x,n.y)):void 0,h=e?e.closest(o).scope():void 0,i=g?g.closest(o).scope():void 0,j=h?h[p]:void 0,k=i?i[p]:void 0,j&&k&&j.isDimensionValue&&k.isDimensionValue)return j.locked||k.locked?void d.$eval(f.qvSelectionsSelectWhileLocked):void d.$apply(function(){l={offsetLeft:e[0].offsetLeft,width:e[0].clientWidth,$event:a},l[p]=j,d.$eval(f.qvSelectionsStartMultiselect,l),d.$eval(f.qvSelectionsUpdateMultiselect,{start:j,current:k,dataColIx:j.dataColIx}),d.$eval(f.qvSelectionsEndMultiselect,{$event:a})})}}),function(){c(e[0]).off("*",r)}}var j,k,l,m,n=a(f.qvSelectionsMultiselect)(),o=n.selector,p=n.itemKey||"cell",q=d.$id+"-multiselect",r=d.$id+"-2finger-multiselect";g.on=function(){j||(j=h()),k||(k=i())},g.off=function(){j&&(j(),j=void 0),k&&(k(),k=void 0)},d.$watch("interactive",function(a){void 0!==a&&(a?g.on():g.off())}),d.$on("$destroy",function(){g.off()})}}}])}),define("objects.views/charts/components/legend/qv-discrete-legend",["assets/qvangular/qvangular-core","text!./discrete-legend.ng.html","touche","objects.utils/event-utils","client.utils/rtl/rtl-util","objects.grid/directives/selections"],function(a,b,c,d,e){var f=".discretelegend";a.directive("qvDiscreteLegend",["$timeout",function(a){return{template:b,replace:!0,scope:!0,link:function(b,g){function h(a,c){var d=b.viewItems;if(!d)return 0;var e,f=0,g=0;if(c)for(;g!==a&&g<d.length;)e=d[g],f+=e.height,g++;else f=a*b.options.cellWidth;return f}function i(){return b.options.vertical?q.scrollTop():q.scrollLeft()}function j(a){k(i(),a*(b.options.vertical?1:-1))}function k(a,c,d){var f;f=b.options.vertical?{scrollTop:a+c+"px"}:{scrollLeft:e.getScrollPos("rtl"===b.options.direction,a,c)+"px"},q.animate(f,d?200:0)}function l(a,c){var d=b.viewItems;if(!d)return null;var f,g,h=d[0],i=0,j=0;if(c){for(;i<a&&j<d.length;)h=d[j],i+=h.height,j++;a+q.height()>=q[0].scrollHeight?(i=a,f=!0):Math.abs(a-i)>Math.abs(a-(i-h.height))&&(j--,i-=h.height),g=j<=0}else i=Math.round(a/b.options.cellWidth)*b.options.cellWidth,j=Math.abs(Math.round(a/b.options.cellWidth)),a+q.width()>=q[0].scrollWidth&&(i=a,j++),"rtl"!==b.options.direction||"default"===e.scrollImplementation?(f=q.width()/b.options.cellWidth>=d.length/Math.floor(q.height()/b.options.cellHeight)-j,g=i<=0):(g=q.width()/b.options.cellWidth>=d.length/Math.floor(q.height()/b.options.cellHeight)-j,f=j>=0);return{position:i,index:j,end:f,start:g}}function m(c,d,e){e=e||0;var f=i(),g=l(f+e,c);g&&(g.position!==f&&(q.stop(!0),k(g.position,0,d)),a(function(){b.scrollAtEnd=g.end,b.scrollAtStart=g.start}),b.$emit("scrollPositionChanged",g.index))}function n(a,d,e){var h=!1,i=g.find(a).first();c(g.find(a)[0]).longtap({id:f,options:{timeThreshold:1e4},update:function(a,f){f.percentage>2&&b.interactionEnabled&&(o(d*(e?5:10)),h=!0,i.addClass("lui-active"),c.preventGestures(this.gestureHandler))},end:function(){h=!1,i.removeClass("lui-active"),c.preventGestures(this.gestureHandler)},cancel:function(){i.removeClass("lui-active"),c.preventGestures(this.gestureHandler)}}).tap({end:function(){b.interactionEnabled&&(h?m(e,!0):(o(d*(e?b.options.cellHeight:b.options.cellWidth)),m(e,!1)),h=!1)}})}function o(a){j(a)}function p(a){c(q[0]).off(),c(a.find(".dcl-up")[0]).off(),c(a.find(".dcl-down")[0]).off(),c(a.find(".dcl-left")[0]).off(),c(a.find(".dcl-right")[0]).off()}var q=g.find(".dcl-flex");b.$watch("viewItems",function(a){a&&a.forEach(function(a){for(var b={},c=Array.isArray(a.marker)?a.marker:[a.marker],d=0;d<c.length;d++)switch(c[d]){case"line":case"!line":b["glyph-line"]=!0;break;case"triangle":case"!triangle":b["glyph-triangle"]=!0;break;case"inverse-triangle":case"!inverse-triangle":b["glyph-inverse-triangle"]=!0;break;case"diamond":case"!diamond":b["glyph-diamond"]=!0;break;case"circle":case"!circle":b["glyph-circle"]=!0;break;case"rect":case"!rect":default:b["glyph-rect"]=!0}a.markerClass=b})}),b.$on("clearSelection",function(){if(b.viewItems){b.selectedValues=[];for(var a=0;a<b.viewItems.length;a++)b.viewItems[a].selected=!1}}),b.$on("invalidateSelections",function(){if(b.viewItems){b.selectedValues=[];for(var a=0;a<b.viewItems.length;a++){var c=b.viewItems[a];"dimension"===c.type&&(b.selectionsCache?c.selected=b.selectionsCache.isValueSelected(c.id[0]):"dimension"===c.type&&c.cacheItems&&c.cacheItems[0]&&(c.selected=c.cacheItems[0].selected))}}b.$digest()}),b.select=function(a,c){"others"!==c.type&&("range"===c.type&&(c.selected=!c.selected),b.$emit("toggleSelect",a,[c]),"dimension"===c.type&&b.selectionsCache&&(c.selected=b.selectionsCache.isValueSelected(c.id[0])))},b.$on("$destroy",function(){p(g)}),b.$watch("explicitScrollPosition",function(a){b.explicitScrollPosition=a}),b.$on("updateSize",function(){if(m(b.options.vertical,!0),void 0!==b.explicitScrollPosition){var a=h(b.explicitScrollPosition,b.options.vertical);b.options.vertical?q.scrollTop(a):q.scrollLeft(a)}b.options.vertical?b.overflow=q.height()<q[0].scrollHeight:b.overflow=q.width()<q[0].scrollWidth}),function(a,b){var e=null,g=d.throttle(function(a){if(b.interactionEnabled){var c,e=d.getMouseWheelData(a.originalEvent);c=(e.delta>0?-1:1)*(b.options.vertical?b.options.cellHeight:b.options.cellWidth),b.options.yMirrorMode&&!b.options.vertical&&(c=-c),m(b.options.vertical,!1,c)}},20);q.on("mousewheel"+f+" DOMMouseScroll"+f,function(a){g(a),a.preventDefault(),a.stopPropagation()}),n(".dcl-up",-1,!0),n(".dcl-down",1,!0),n(".dcl-left",-1,!1),n(".dcl-right",1,!1),c(q[0]).swipe({options:{useMomentum:!0,inertia:.7,preventDefault:!0},start:function(a){b.interactionEnabled&&(e=i(),b.isScrolling=!0,c.preventGestures(this.gestureHandler),a.preventDefault())},update:function(a,c){if(null!==e&&c.swipe){var d=c.swipe.distance;b.options.vertical?"up"===c.swipe.direction?k(e,-d):"down"===c.swipe.direction&&k(e,d):"left"===c.swipe.direction?k(e,d):"right"===c.swipe.direction&&k(e,-d)}},end:function(){null!==e&&(m(b.options.vertical,!0),b.isScrolling=!1,e=null)}})}(0,b)}}}])}),define("objects.views/charts/components/legend/basic-color-legend",["jquery","translator","./legend-data","client.utils/state","../chart-component-angular","text!./color-legend.ng.html","objects.utils/number-formatter","objects.views/charts/chart-style-service","core.utils/feature-flags","client.utils/theme/theme-module","./qv-continous-legend","./qv-discrete-legend"],function(a,b,c,d,e,f,g,h,i,j){function k(a,b){return"normal "+parseInt(a)*b+"px 'QlikView Sans'"}function l(a,b){return i.THEMING?{backgroundColor:a.getStyle("legend","backgroundColor"),label:{font:k(a.getStyle("legend.label","fontSize"),b),lineHeight:"1em"},scaledLabel:{font:k(a.getStyle("legend.label","fontSize"),b),color:a.getStyle("legend.label","color"),lineHeight:"1em"},ticks:{color:"#a6a6a6",length:8},line:{color:"#666666"},title:{font:k(a.getStyle("legend.title","fontSize"),b),lineHeight:"1em"},scaledTitle:{font:k(a.getStyle("legend.title","fontSize"),b),color:a.getStyle("legend.title","color"),lineHeight:"1.2em"}}:{backgroundColor:a.getValue(t,null,"backgroundColor"),label:{font:a.getFont(t,"label"),lineHeight:"1em"},scaledLabel:{font:a.getFont(t,"label",null,null,null,b),color:a.getValue(t,"label","color"),lineHeight:"1em"},ticks:{color:"#a6a6a6",length:8},line:{color:"#666666"},title:{font:a.getFont(t,"title"),lineHeight:"1em"},scaledTitle:{font:a.getFont(t,"title",null,null,null,b),color:a.getValue(t,"title","color"),lineHeight:"1.2em"}}}function m(a){return a&&"primary"!==a.colorMode}function n(a,b,c){var d={};return d.maxItemsPerRow=Math.floor((a.width-(c.show?c.width:0))/b.cellWidth),d.numRows=Math.ceil(b.viewItems.length/d.maxItemsPerRow),d.itemsPerRow=Math.ceil(b.viewItems.length/d.numRows),d.w=d.itemsPerRow*b.cellWidth,d.h=Math.ceil(Math.max(c.height,Math.min(b.cellHeight*r,d.numRows*b.cellHeight))),d}function o(a,b,c){return(c?Math.max(a.width,b.maxLabelWidth+s):Math.max(b.labelHeight+s,a.height))+20}function p(a){return d.state===d.States.analysis||d.state===d.States.play&&(!a||!a.isSnapshot)}var q,r=2,s=17,t="legend",u=j.get();return q=e.extend("BasicColorLegend",{init:function(){var a=Array.prototype.slice.call(arguments);a.push(f),this._super.apply(this,a),
i.THEMING?this._styleService=u.initializeService("object."+this.options.parentType):this._styleService=h.getInstance(),this._legendContainer=this.getInnerContainer(),this._dataInvalid=!0,this.$scope=this.getInnerContainerScope(),this._scrollPosition=0,this._mode={}},release:function(){this._super(),this.$scope=null,this._legendContainer=null},setColorMap:function(a){this._colorMap=a,this.invalidateProperties("Legend.setColorMap"),this.invalidateDisplay("Legend.setColorMap")},getColorMap:function(){return this._colorMap},setProperties:function(a){return this._legendProperties=a,this._dataInvalid=!0,this.invalidateProperties("BasicColorMap.setProperties")},setExternalColorItems:function(a){if(a&&a[0]&&a[0].qMatrix&&this._colorMap){this._externalDataPage=a;var c=a[0].qMatrix,d=[];this._colorDataInfo=this._colorMap.getColorDataInfo(),c.forEach(function(a,b){d.push({id:[a[1].qNum],index:b,label:a[0].qText,type:"dimension"})},this),this._colorDataInfo&&this._colorDataInfo.hasOthers&&d.push({id:[-3],index:d.length,label:b.get("properties.dimensionLimits.others"),type:"others"}),this._externalColorItems=d}else this._externalColorItems=null;this.invalidateProperties("Legend.setExternalColorItems")},getExternalDataPage:function(){return this._externalDataPage},isVisible:function(a){return this._super(a)&&this.hasValidData()&&m(this._mode)&&this._legendProperties&&this._legendProperties.show},updateSize:function(){this._super(),this.invalidateProperties("LegendLight.calculateRelevantSize"),this.updateNow(["properties"]),this._dataInvalid=!0},_updateProperties:function(){if(!this._colorMap||!this._legendProperties)return this._clearScope(this.$scope),!1;if(this._colorDataInfo=this._colorMap.getColorDataInfo(),this._mode=this._colorDataInfo.legendMode||{},this._marker=this._colorMap.getLegendDataProvider()?this._colorMap.getLegendDataProvider().getLegendMarker():"rect",!this._mode.colorMode||this._colorDataInfo.altMode&&!this._externalColorItems&&"dimension"===this._mode.colorMode)return this._clearScope(this.$scope),!1;var b,d=l(this._styleService,this.chartScale);return this._externalColorItems&&"dimension"===this._mode.colorMode?(b=this._externalColorItems,b.forEach(function(a){a.color=this._colorMap.getColorFromPreScaledValue(a.id[0]),a.marker=this._marker}.bind(this)),b=b.filter(function(a){return!a.color.isInvalid()})):b=this._colorMap.getColorMapping().concat(),this._mode.showTitle=this._data.legend.showTitle,this.isVisible()&&b&&b.length?(this.$scope.visible=!0,this.$scope.selectionEnabled=!1,this.$scope.interactionEnabled=p(this.backendApi),this._mode.showTitle?(this._titleMetrics=c.prepareLegendTitle(this._colorMap.getLegendTitle(),d.title),this._titleMetrics.show=this._mode.showTitle):this._titleMetrics={show:!1,width:0,height:0},this._mode.discrete?(this._legendMetrics=c.prepareDiscreteData(b,this._selectableShapes,d.label,this.rect.width-(this._mode.showTitle&&this.isHorizontal()?this._titleMetrics.width:0),this.chartScale,this._colorMap.getDimensionIndex()[0],this._colorDataInfo.attrIndex),this.$scope.viewItems=this._legendMetrics.viewItems):(this._formatter=this._colorMap.getValueFormatter()||g.getStaticFormatter(),this._formatter.prepare(),this._legendMetrics=c.prepareContinousData(b,d.label,this._formatter),this.$scope.viewItems=this._legendMetrics.viewItems),this.isHorizontal()&&(this._horizontalMetrics=n(this.rect,this._legendMetrics,this._titleMetrics),this.$scope.align=this._horizontalMetrics.numRows>=r),this.$scope.discrete=this._mode.discrete,this.$scope.options.vertical=this.isVertical(),this.$scope.options.labelStyle=d.scaledLabel,this.isDiscrete()?(this.$scope.options.titleStyle=a.extend(!0,{width:Math.ceil(this._titleMetrics.width*this.chartScale)+"px"},d.scaledTitle),this.$scope.options.titleHeight=(Math.max(this._titleMetrics.height,12)+12)*this.chartScale,this.$scope.options.legendTitle=this._titleMetrics.show?this._titleMetrics.text:null):(this.$scope.options.titleStyle=d.scaledTitle,this.$scope.options.legendTitle=this._titleMetrics.text),this.$scope.options.legendTitleTooltip=this._titleMetrics.fullText,this.$scope.options.cellWidth=Math.ceil(this._legendMetrics.cellWidth*this.chartScale),this.$scope.options.cellHeight=Math.ceil(this._legendMetrics.cellHeight*this.chartScale),this.$scope.options.yMirrorMode=this.yMirrorMode,this.$scope.options.dock=this.dock,this.$scope.isLocked=this.isSelectionLocked(),this._dataInvalid=!1,!0):(this._clearScope(this.$scope),!1)},paint:function(){this.$scope.$broadcast("invalidateSelections"),this.$scope.$broadcast("updateSize")},calculateRelevantSize:function(a){if(this._super(),this.relevantSize=0,this.invalidateProperties("Legend.calculateRelevantSize"),this.updateNow(["properties"]),this.isVisible()&&this._titleMetrics&&this._legendMetrics)if(this.isDiscrete())if(this.isHorizontal()){var b=n(a,this._legendMetrics,this._titleMetrics);this.relevantSize=b.h+(b.numRows>r?r:b.numRows)+2*c.constants.PADDING}else this.relevantSize=Math.max(this._legendMetrics.cellWidth,this._titleMetrics.width);else this.relevantSize=o(this._titleMetrics,this._legendMetrics,this.isVertical(),this._values)},isDiscrete:function(){return this._mode.discrete},clear:function(){this._super()},isSelectionLocked:function(){return this._colorDataInfo.altMode&&this._colorDataInfo.internalMode===(this._colorMap?this._colorMap.DIMENSION:"dimension")?this._colorDataInfo.altLocked:this._super()},getAttributeDimensionInfo:function(){return this._colorMap&&this._colorMap.hasAttributeDimension()?this._colorMap.getAttributeDimensionInfo():[]},_clearScope:function(a){a.visible=!1,a.viewItems=null,this._titleMetrics=null,this._legendMetrics=null},on:function(){this._super(),this.$scope.interactionEnabled=p(this.backendApi)},off:function(){this._super(),this.$scope.interactionEnabled=!1}}),Object.defineProperty(q.prototype,"className",{value:"BasicColorLegend"}),q}),define("objects.views/charts/components/legend/color-legend",["./basic-color-legend","objects.utils/number-formatter"],function(a,b){function c(a,b,c,d,e,f){var g,h,i=d[0].min,j=d[d.length-1].max,k=j-i;return c?(g=1-Math.max(a[0].y,a[1].y)/b,h=1-Math.min(a[0].y,a[1].y)/b):e?(g=1-Math.min(a[0].x,a[1].x)/b,h=1-Math.max(a[0].x,a[1].x)/b):(g=Math.min(a[0].x,a[1].x)/b,h=Math.max(a[0].x,a[1].x)/b),g=0===g?i:g*k+i,h=1===h?j:h*k+i,{idx:f,startVal:g,updateVal:h,isMax:!0}}function d(a,b,c){var d=b[0].min,e=b[b.length-1].max,f=e-d;return c&&(a=1-a),0===a?d:1===a?e:a*f+d}function e(a,b,c){for(var d,e=[],f=0;f<b.length;f++)d=b[f],e.push({idx:c,startVal:d.id[0],updateVal:d.id[1],isMax:d.isMax});return e}function f(a){return!("measure"===a.colorMode&&"item"===a.boxType)}function g(a,d,g){if(d.selectionEnabled=!!a._mode.selectionEnabled&&!!g&&a._on&&!g.handler._disableSelections,!g||!d.selectionEnabled)return a._watchers&&a._watchers.forEach(function(a){a()}),void(a._watchers=null);a._watchers||(a._watchers=[],a._watchers.push(d.$on("toggleSelect",function(b,c,h){if(g.initComponent(null,a),f(a._mode)){if("range"===a._mode.boxType){g.rangeStart();var i=e(d.viewItems,h,a._mode.rangeSelectionIndex);g.indices=[a._mode.rangeSelectionIndex],g.rangeUpdate(i,!0),g.rangeEnd()}else{if(a.$scope.isLocked)a.selections.selectWhileLocked(a._mode.altMode?g.activeComponent.getAttributeDimensionInfo():void 0);else{var j,k=h.map(function(a){return a.id[0]}),l=[],m=h.length;for(j=0;j<m;j++)h[j].cacheItems&&(l=l.concat(h[j].cacheItems));g.updateFromItems(c,l,a._mode.altMode,k)}a._mode.altMode||a.selections._selectedShapes.length||a.selectionsApi.clear()}b.preventDefault()}})),a._watchers.push(d.$on("rangeStart",function(c,d,e){e&&g.initComponent(e.pagePoints[0]),a._formatter=a._colorMap.getValueFormatter()||b.getStaticFormatter(),a._formatter.prepare(),g.rangeStart(!0),c.preventDefault()})),a._watchers.push(d.$on("rangeUpdate",function(b,d,e,f){var h=c(d,e,a.isVertical(),a.$scope.viewItems,a.yMirrorMode,a._mode.rangeSelectionIndex);g.indices=[a._mode.rangeSelectionIndex],f&&(0===f.index?h.startVal=f.value:h.updateVal=f.value),g.rangeUpdate([h]),b.preventDefault()})),a._watchers.push(d.$on("rangeEnd",function(a){g.rangeEnd(),a.preventDefault()})),a._watchers.push(d.$on("rangeEditChanged",function(b,c){a._nrEditing=c?a._nrEditing+1:a._nrEditing-1,a._nrEditing>1&&(g.confirmEdit(),a._nrEditing=1,b.targetScope.onEditBubble()),a._editing=a._nrEditing>0,g.setIsEditing(a._editing,a.$scope)})),a._watchers.push(d.$on("scrollPositionChanged",function(b,c){a._scrollPosition=c})),a._watchers.push(d.$on("selectWhileLocked",function(){a.selections&&a.selections.selectWhileLocked()})))}var h;return h=a.extend("ColorLegend",{init:function(){var a=Array.prototype.slice.call(arguments);this._super.apply(this,a),this._nrEditing=0,this.$scope.options={};var b=this;this.formatValue=function(a){return b._formatter.formatValue(a)},this.$scope.positionToFormattedValue=function(a){return b.formatValue(d(a,b.$scope.viewItems,b.yMirrorMode&&!b.isVertical()))},this.$scope.positionToValue=function(a){return d(a,b.$scope.viewItems,b.yMirrorMode&&!b.isVertical())}},setData:function(a){this._super(a),this.setProperties(a.legend)},getSelectionIndices:function(){return this._colorMap.getSelectionIndices()},setSelectableShapes:function(a){this._super(a),this._dataInvalid=!0,this.invalidateProperties("Legend.setSelectableShapes")},setHasValidData:function(a){this._super(a),a||(this.clear(),this._clearScope(this.$scope))},_updateProperties:function(){if(!this._super())return!1;this.$scope.selectionEnabled=!this.options._disableSelections&&this._mode.selectionEnabled&&this.$scope.interactionEnabled&&!!this.selections,this.$scope.selectionsApi=this.selectionsApi,this.$scope.selectionsCache=this._colorDataInfo&&this._colorDataInfo.altMode&&this.attributeSelectionsCache,g(this,this.$scope,this.selections)},on:function(){this._super(),g(this,this.$scope,this.selections)},off:function(){this._super(),g(this,this.$scope,this.selections)},getType:function(){return this.selections},getSelectionMode:function(){return this._mode.legend},clearSelection:function(){this.$scope.$broadcast("clearSelection"),this.$scope.$broadcast("cancelSelection")},cancelSelection:function(){this.$scope.$broadcast("cancelSelection")},getScrollPosition:function(){return this._scrollPosition},setScrollPosition:function(a){this.$scope.explicitScrollPosition=a}}),Object.defineProperties(h.prototype,{selections:{get:function(){return this._selections},set:function(a){this._selections=a,g(this,this.$scope,this.selections)}}}),Object.defineProperty(h.prototype,"className",{value:"ColorLegend"}),h}),define("objects.views/selections/cache-item-base",["core.utils/class"],function(a){"use strict";function b(a){var b=a.getBoundingRect();return isNaN(b.x+b.y+b.width+b.height)}var c=a.extend({init:function(a,b,c,d,e,f,g){if(a&&!(a instanceof Array)||b&&!(b instanceof Array)||c&&!(b instanceof Array)||d&&!(c instanceof Array))throw"The dimensions, measures and values input must be undefined or arrays";this.selected=!1,this.highlighted=!1,this.values=c||[],this.labels=d||[],this.row=e,this.col=f,this.id=g,this.parent=void 0,this.children=[],this._dimensions=a||[],this._measures=b||[],this._attrDims=[],this._attrDimTypes=[],this._objectShapes={},this._shapes=[],this._tooltipShape=void 0,this._tooltipShapeComponent=void 0},get siblings(){return this._parent?this._parent.children:[]},clearShapes:function(a){a&&this._objectShapes[a]&&(this._objectShapes[a]=[]),this._shapes=[];for(var b in this._objectShapes)this._shapes=this._shapes.concat(this._objectShapes[b])},getShapes:function(a){return a?this._objectShapes[a]||(this._objectShapes[a]=[]):this._shapes},getShapeBounds:function(a,c){if(this._calculateTooltipPosition&&a){var d=this.getShapes(a),e=d.map(function(a){var b=a.getBoundingRect();return a.clearModelView||(b=b.clone(),b.set(b.x*c,b.y*c,b.width*c,b.height*c)),b});if(e=e.filter(function(a){return!b(a)}),e.length){return e.reduce(function(a,b){return a.combineWith(b)},e[0])}return null}return null},addShape:function(a,b,c){if(b instanceof Array&&(!b[0].pointInside||!b[0].getBoundingRect)||!b.pointInside||!b.getBoundingRect)throw"The shape must implement a `pointInside` function";this._objectShapes[a]instanceof Array||(this._objectShapes[a]=[]),this._objectShapes[a].push(b),this._shapes.push(b),c&&(this._tooltipShape=b,this._tooltipShapeComponent=a)},addMeasure:function(a,b,c){this.values.push(b),this.labels.push(c),this._measures.push(a)},getMeasures:function(){return this._measures},getMeasuresIndecies:function(){return this._measures.map(function(a,b){return b})},addDimension:function(a){this._dimensions.push(a)},getDimensions:function(){return this._dimensions},addAttributeDimension:function(a,b,c){this._attrDims.push({value:a,label:b,name:c})},getAttributeDimensions:function(a){return this._attrDims.length?isNaN(a)?this._attrDims.map(function(a){return a.value}):[this._attrDims[a].value]:null},getValue:function(a){return a=a||0,this.values[a]},getPreformattedLabel:function(a){return a=a||0,this.labels[a]},getCombinedElementID:function(){for(var a=this,b=[a.id];a.parent;)a=a.parent,b.push(a.id);return b.reverse(),b.join(",")}});return c.prototype.isCacheItem=!0,Object.defineProperties(c.prototype,{tooltipShape:{get:function(){return this._tooltipShape}},calculateTooltipPosition:{set:function(a){this._calculateTooltipPosition=a},get:function(){return this._calculateTooltipPosition}},interactPosition:{set:function(a){this._interactPosition=a},get:function(){return this._interactPosition}},tooltipShapeComponent:{get:function(){return this._tooltipShapeComponent}},label:{get:function(){throw new Error("CacheItem: label: Removed functionality")}},shape:{get:function(){throw new Error("CacheItem: shape: Removed functionality")}},value:{get:function(){throw new Error("CacheItem: value: Removed functionality")}}}),c}),define("objects.views/selections/cache-item-combo",["./cache-item-base"],function(a){"use strict";return a.extend({addShape:function(a,b,c,d){this._super(a,b,c),void 0!==d&&(this._shapeMeasures||(this._shapeMeasures=[]),this._shapeMeasures.push(d))},getMeasuresIndecies:function(a){if(this._shapeMeasures&&void 0!==this._shapeMeasures[this._shapes.indexOf(a)]){var b=this._shapeMeasures[this._shapes.indexOf(a)];return void 0!==b?[b]:[]}return this._super()}})}),define("objects.views/charts/chart-data-helper",["objects.views/charts/utils/tree-node","objects.views/selections/cache-item-combo"],function(a,b){function c(a,b){var c=a?d(a):null;if(c){var e=c.getDimensions();if(e.length)return b.qText+","+e.join(",")}return b.qText}function d(a){return"P"===a.data.qType&&a.parent?a.parent.cacheItem:a.cacheItem}function e(b,c,d){var e,l=new a,m=[],n=[];return b&&b.length?(g=0,h=0,i=c&&c.length<2,j=c,k=d,l.data.qApprMaxGlyphCount=k[0]?k[0].qApprMaxGlyphCount:0,e=f(b[0].qSubNodes,l,m,n,0),{dimensionTree:e,cacheItems:m}):{dimensionTree:l,cacheItems:[]}}function f(e,m,n,o,p){var q,r,s,t,u,v;for(o[h]||(o[h]={}),s=0;s<e.length;s++){var w=[];if("T"!==e[s].qType){if(q=new a,q.data.qType=e[s].qType,q.data.qMaxPos=e[s].qMaxPos,q.data.qMinNeg=e[s].qMinNeg,"P"===e[s].qType&&(l=e[s]),"V"===e[s].qType||"E"===e[s].qType||"P"===e[s].qType?(q.data.qText=e[s].qText,q.data.qNum=e[s].qNum,q.data.qValue=e[s].qValue,q.data.rowIndex=0,i?(r=new a,r.data.qType="_M",r.data.qMaxPos=q.data.qMaxPos,r.data.qMinNeg=q.data.qMinNeg,r.data.qText=j[0].qFallbackTitle,r.data.rowIndex=e[s].qRow,r.addChild(q),q=r):q.data.rowIndex=e[s].qRow):(q.data.qText="O"===e[s].qType&&k[p]?k[p].othersLabel||"":e[s].qText,k[p+1]&&(q.data.qApprMaxGlyphCount=k[p+1].qApprMaxGlyphCount),q.data.qElemNo=e[s].qElemNo,q.data.rowIndex=e[s].qRow),m.addChild(q),"V"!==e[s].qType&&"P"!==e[s].qType){var x=c(m,e[s]);if(o[h][x]&&l)u=o[h][x],q.cacheItem=u;else{u=new b(null,null,null,null,e[s].qRow,h),q.cacheItem=u,u.addDimension(q.data.qText),u.id=e[s].qElemNo,"U"!==e[s].qType&&(e[s].qAttrDims&&e[s].qAttrDims.qValues.forEach(function(a,b){u.addAttributeDimension(a.qElemNo,a.qText,k[p].qAttrDimInfo[b].label)}),e[s].qAttrExps&&e[s].qAttrExps.qValues.forEach(function(a,b){w.push({value:a.qNum,label:k[p].qAttrExprInfo[b].label})}));var y=d(m);if(y){u=q.cacheItem,u.parent=y,y.children.push(u),v=u.parent.getDimensions();for(t in v)u.addDimension(v[t])}o[h][x]=u}}"V"===e[s].qType&&(u=d(m))&&(u.addMeasure(l?l.qText:q.data.qText,e[s].qValue,e[s].qText),n.contains(u)||n.push(u)),e[s].qSubNodes&&e[s].qSubNodes.length>0&&(h++,q=f(e[s].qSubNodes,q,n,o,p+("V"!==e[s].qType?1:0))),w.forEach(function(a){u.addMeasure(a.label,a.value)})}}return 0==--h&&g++,m}var g,h,i,j,k,l;return{prepareData:e}}),define("objects.views/charts/chart-context",["./events/event-launcher","objects.views/charts/utils/tree-node","objects.views/charts/chart-data-helper","objects.views/selections/cache-item-combo"],function(a,b,c,d){"use strict";function e(a,c,d,e){var f=new b;return f.text=a,f.title=c,f.id=d,f.idx=e,f}function f(a,c){var d,e=new b;e.data.qApprMaxGlyphCount=0;for(d in c)e.data[d]=c[d];return a&&a.addChild(e),e}return a.extend({init:function(a){this._super(),this._properties={},a&&this.refresh(a)},refresh:function(a){this._data=a,this._qDataObject=a.qHyperCube?a.qHyperCube:a.qListObject;var b;if("K"===this._qDataObject.qMode&&this._qDataObject.qStackedDataPages&&this._qDataObject.qStackedDataPages.length>0)b=this._generatePivotTree();else{if(!("S"===this._qDataObject.qMode&&this._qDataObject.qDataPages&&this._qDataObject.qDataPages.length>0))return;b=this._generateDimensionTree()}this._dimensionTree=b?b.dimensionTree:null,this._cacheItems=b?b.cacheItems:null,this.fire("dimensionTreeChanged")},bindProperty:function(){throw new Error("ChartContext bindProperty: Deprecated")},unBindProperty:function(){throw new Error("ChartContext unBindProperty: Deprecated")},releaseAll:function(){throw new Error("ChartContext releaseAll: Deprecated")},release:function(){this._data=null,this._dimensionTree=null,this._cacheItems=null,this._qDataObject=null},_generateDimensionTree:function(){var a,c,g,h,i,j,k,l,m,n,o,p,q,r,s=e(),t=this.getDataMatrix(),u=this._qDataObject,v=u.qMeasureInfo,w=u.qDimensionInfo,x=u.qDataPages[0].qArea.qTop,y=u.qDataPages[0].qTails,z=v.length,A=w.length,B=t&&t[0]?t[0].length:0,C=[],D=[];for(l=0,k=0;k<A;k++)w[k].qError||(C[l]=k,l++);if(0===(A=l))return null;for(o=function(a,b){for(var c=0;c<a.length;c++)if(a[c].data.qElemNo===b)return c;return-1},k=0;k<t.length;k++){a=t[k],h=s;var E=[];for(l=0;l<A;l++){if(c=a[l],g=w[C[l]],!c)return;if((n=c.qIsOtherCell?void 0===h.data.othersIndex?-1:h.data.othersIndex:o(h.children,c.qElemNumber))===-1){if(i=f(h,{qElemNo:a[l].qElemNumber,qText:a[l].qText,rowIndex:x+k,type:"dimension"}),void 0!==typeof a[l].qNum&&(i.data.qNum=a[l].qNum),c.qIsOtherCell&&(i.data.qIsOtherCell=!0,i.data.qText=g.othersLabel||""),c.qIsTotalCell&&(i.data.qIsTotalCell=!0),h.data.qApprMaxGlyphCount=g.qApprMaxGlyphCount,c.qIsOtherCell&&(h.data.othersIndex=h.children.length-1),p=new d([i.data.qText],null,null,null,x+k,l,i.data.qElemNo),c.qAttrDims&&g.qAttrDimInfo&&g.qAttrDimInfo.length&&c.qAttrDims.qValues.forEach(function(a,b){p.addAttributeDimension(a.qElemNo,a.qText,g.qAttrDimInfo[b].label)}),c.qAttrExps&&g.qAttrExprInfo&&g.qAttrExprInfo.length&&c.qAttrExps.qValues.forEach(function(a,b){E.push({value:a.qNum,label:g.qAttrExprInfo[b].label})}),h.cacheItem){p.parent=h.cacheItem,p.parent.children.push(p),q=p.parent.getDimensions();for(r in q)p.addDimension(q[r])}i.cacheItem=p,h=i}else h=h.children[n]}for(p=h.cacheItem,D.push(p),m=0;m<z&&A+m<B;m++)i=f(h,{qText:v[m].qFallbackTitle,qNum:a[A+m].qNum,rowIndex:x+k,type:"measure"}),h.data.qApprMaxGlyphCount=Math.max(h.qApprMaxGlyphCount,v[m].qApprMaxGlyphCount),p.addMeasure(i.data.qText,i.data.qNum,a[A+m].qText),j=new b,j.data={qText:a[A+m].qText,qNum:a[A+m].qNum,qElemNo:a[A+m].qElemNumber,qState:a[A+m].qState},i.addChild(j);E.forEach(function(a){p.addMeasure(a.label,a.value)})}return y&&y[0]&&(y[0].qUp>0||y[0].qDown>0)&&(s.children[s.children.length-1].incomplete=!0),{dimensionTree:s,cacheItems:D}},_generatePivotTree:function(){return c.prepareData(this._qDataObject.qStackedDataPages[0].qData,this._qDataObject.qMeasureInfo,this._qDataObject.qDimensionInfo)},_extractProperties:function(){throw new Error("ChartContext _extractProperties: Deprecated")},_updateProperty:function(){throw new Error("ChartContext _updateProperty: Deprecated")},getDataMatrix:function(){return this._qDataObject.qDataPages[0].qMatrix},getDimensionTree:function(){return this._dimensionTree},getCacheItems:function(){return this._cacheItems}})}),define("objects.views/charts/representation/legend-data-provider",["translator","core.utils/class","objects.views/charts/utils/tree-iterator"],function(a,b,c){function d(b,d){var e,f,i,j,k,l,m,n=[],o={},p=this._qDataObject,q=this._legendMarker?this._legendMarker:"rect",r=p?p.qDimensionInfo instanceof Array?p.qDimensionInfo:[p.qDimensionInfo]:null,s=this._colorMap;if(d=void 0===d?r.length-1:d[0],e=this._dimensionTree,b)for(k=p.qMeasureInfo,l=k.length,i=0;i<l;i++)n.push({label:k[i].qFallbackTitle,color:s.getColor(0,0,i),id:[-1],type:"measure",marker:this._legendMarker?this._legendMarker:this._measureLegendTypes?this._measureLegendTypes[i]||"box":"box"});else c.each.call(e,function(b){(m=c.getLevel.call(b))-1===d&&b.data.qElemNo!==h&&void 0!==b.data.qText&&void 0===o[b.data.qText]&&(j=[],j[d]=b.data.qElemNo,f={label:b.data.qElemNo!==g?b.data.qText:a.get("properties.dimensionLimits.others"),color:s.getColorFromPreScaledValue(b.data.qElemNo),id:[b.data.qElemNo],index:b.data.rowIndex,type:b.data.qElemNo!==g?"dimension":"others",marker:q},n.push(f),o[b.data.qText]=f)});return n}function e(a,b){var c,d,e,f,i,j,k,l=[],m={},n=this._data.qListObject.qDataPages[0].qMatrix,o=this._qDataObject,p=o?o.qDimensionInfo instanceof Array?o.qDimensionInfo:[o.qDimensionInfo]:null,q=this._colorMap;if(b=void 0===b?p.length-1:b[0],a)for(c=this._data.qListObject.qMeasureInfo,d=c.length,f=0;f<d;f++)l.push({label:c[f].qFallbackTitle,color:q.getColor(0,0,f),id:[-1],type:"measure"});else for(e=0;e<n.length;e++)i=n[e][b],i.qElemNumber!==g&&i.qElemNumbero!==h&&void 0===m[i.qText]&&(j=[],j[b]=i.qElemNumber,k={label:i.qText,color:q.getColor(j,0,0,e),id:[i.qElemNumber],type:"dimension"},l.push(k),m[i.qText]=k);return l}function f(a){return a.discrete+","+a.boxType+","+a.colorMode}var g=-3,h=-2;return b.extend({init:function(a){this._data=a,this._colorMappings={}},setColorMap:function(a){this._colorMap=a},getColorMap:function(){return this._colorMap},getColorMapping:function(){if(!this._colorMap||!this._data)return[];var a,b=this._colorMap.getColorDataInfo().legendMode;return"primary"===b.colorMode?[]:this._colorMappings[f(b)]?this._colorMappings[f(b)]:(a=b.discrete&&"range"===b.boxType||!b.discrete?this._colorMap.generateScaleBasedMapping():this._data.qListObject?e.apply(this,["measure"===b.colorMode,this._colorMap.getDimensionIndex()]):d.apply(this,["measure"===b.colorMode,this._colorMap.getDimensionIndex()]),this._colorMappings[f(b)]=a,a)},setData:function(a){var b=a.qHyperCube?a.qHyperCube:a.qListObject,c=a.qHyperCube?a.qHyperCube.qDimensionInfo:[a.qListObject.qDimensionInfo];this._qDataObject=b,this._data=a,a&&b.qDataPages.length?this._others=b.qDataPages[0].qMatrix.some(function(a){return c&&c.length&&a[c.length-1].qIsOtherCell===!0}):this._others=!1,this._colorMappings={}},setDimensionTree:function(a){this._dimensionTree=a,this._colorMappings={}},setMeasureLegendTypes:function(a){this._measureLegendTypes=a},setLegendMarker:function(a){this._legendMarker=a},getLegendMarker:function(){return this._legendMarker},release:function(){this._colorMap=null,this._dimensionTree=null,this._data=null,this._qDataObject=null}})}),define("objects.views/charts/representation/sequential-color-map",["jquery","client.utils/theme/theme-module","general.utils/color-cache","core.utils/class","objects.views/charts/representation/color-scale"],function(a,b,c,d,e){"use strict";function f(a,b){var c,d,f,g=new e;if(b){for(d=0;d<a.length;d++)if(f=a[d])for(c=0;c<f.length;c+=2)g.addColorPart(f[c],f[c+1],d)}else for(c=0;c<a.length;c+=2)g.addColorPart(a[c],a[c+1]);return g}function g(a,b,c,d,e){var f,h,i,j,k=0,l=[];if(0===(f=(a-b)/(d+1)))return 1;for(h=0;h<c.length;h++)i=.99*(c[h]-b),j=c[h]>a?Math.floor(a/f):c[h]<b?0:Math.floor(i/f),isNaN(j)||(l[j]?l[j]++:l[j]=1);for(h=0;h<l.length;h++)l[h]&&k++;return k<=d||k>=e?Math.max(k,d):g(a,b,c,++d,e)}function h(a){var b,c=[];for(b=0;b<a.length;b++)a[b]?c.push(i(a[b],!1)):c.push(null);return c}function i(a,b){var c=1,d=[];for(d.push(a[0]),b||d.push(a[0]);c<a.length-1;c++)d.push(a[c]),d.push(a[c]);return c<a.length&&(d.push(a[c]),b||d.push(a[c])),d}function j(a){var b=this._sequentialScales={},c=0;a.scales.forEach(function(a){b[a.propertyValue]={type:a.type,scale:f("class-pyramid"===a.type?h(a.scale):i(a.scale,"gradient"===a.type),"class-pyramid"===a.type)},c=Math.max(a.scale.length,c)}),this._largestScaleSize=c,this._wrangled=[],this._defaultScaleObj=this._sequentialScales[a.scales[0].propertyValue],this._activeScale=this._defaultScaleObj.scale}var k=b.get();return d.extend({init:function(a){j.call(this,k),this._themeChangeWatcher=function(){j.call(this,k)}.bind(this),k.ThemeChanged.bind(this._themeChangeWatcher),this._measure=0,this.setData(a)},release:function(){k.ThemeChanged.unbind(this._themeChangeWatcher)},setData:function(a,b){if(this._data=a,this._colorDataInfo=b,a){if(!b.valid)return this._legendTitle="",void(this._wrangled=[]);var c=a.color||{},d=a.qHyperCube?a.qHyperCube:a.qListObject;if(this._qDataObject=d,this._validColorInformation=this._colorDataInfo.valid&&!this._colorDataInfo.allNaN,this._byExpression="byExpression"===c.mode,this._legendTitle=this._colorDataInfo.legendTitle,void 0!==c.measureScheme){this._classes=!1,this._invalidSpan=!1;var e=this._sequentialScales[c.measureScheme]||this._defaultScaleObj;this._activeScale=e.scale,this._classes="class-pyramid"===e.type,void 0!==c.reverseScheme&&this._activeScale.setReverse(c.reverseScheme===!0);var f=this._getMinMax();this._invalidSpan=!f,!this._invalidSpan&&this._validColorInformation&&(this._activeScale.setMaxMinValues(f.max,f.min),this._wrangled=this._colorDataInfo.wrangled,this._numUsedColors=this._colorDataInfo.persistentColors?[Math.min(this.getLargestScaleSize(),this._colorDataInfo.dimSize)]:[g(f.max,f.min,this._wrangled,1,this.getLargestScaleSize())])}}},getColor:function(a,b,d,e){var f=Array.isArray(a)?a[this._colorDataInfo.dimIndex]:a;return e=this._byExpression||void 0===this._wrangled[b]?e:this._wrangled[b],f===-3||Array.isArray(a)&&a.indexOf(-3)!==-1?c.retriveColor(k.dataColors.othersColor):f===-2?c.retriveColor(k.dataColors.nullColor):this._byExpression||!this._invalidSpan&&!isNaN(e)&&this._validColorInformation?this._activeScale.getColor(e,this._getNumUsedColors(0)):c.retriveColor(k.dataColors.nullColor)},getColorFromPreScaledValue:function(a){return this._activeScale.getColor(a,this._getNumUsedColors(0))},getActiveScale:function(){return this._activeScale},getLargestScaleSize:function(){return this._largestScaleSize||0},generateScaleBasedMapping:function(){var b,c,d,e,f,g,h,i,j,k,l=this.getValueFormatter();if(k=this._activeScale,j=[],h=k.getLegendParts(this._getNumUsedColors(0)),!(b=this._getMinMax()))return j;if(c=b.max-b.min,isNaN(c))return j;for(f=h.length,e=c/f,g=b.max,!isNaN(b.measureMax)&&this._classes&&(i=a.extend(!0,{},h[0]),i.isMax=!0,i.min=l.formatValue(g),i.id=[b.measureMax,g],i.type="range",j.push(i)),d=0;d<f-1;d++)i=h[d],i.isMax=0===d,i.max=l.formatValue(g),i.min=l.formatValue(g-e),i.id=[g,g-e],i.type="range",g-=e,j.push(i);return i=h[d],i.max=l.formatValue(g),i.min=l.formatValue(b.min),i.id=[g,b.min],i.type="range",j.push(i),!isNaN(b.measureMin)&&this._classes&&(i=a.extend(!0,{},h[d]),i.max=l.formatValue(b.min),i.min=void 0,i.id=[b.min,b.measureMin],i.type="range",j.push(i)),j},getColorMapping:function(){return this.generateScaleBasedMapping()},getLegendMode:function(){return[this._classes?"box":"scale",this._classes?"range":"item","measure"]},getLegendTitle:function(){return this._legendTitle},setMeasureFormatters:function(a){this._measureFormatters=a},setGenericFormatter:function(a){this._formatter=a},getValueFormatter:function(){return this._measureFormatters&&this._measureFormatters[0]&&!this._byExpression?this._measureFormatters[0]:{formatValue:function(a){return a}}},_getMinMax:function(){var a;return this._data.color.autoMinMax===!1?(a={min:this._data.color.measureMin||0,max:this._data.color.measureMax||10},a.max>=a.min?a:null):this._validColorInformation&&this._colorDataInfo.minMax?a=this._colorDataInfo.minMax:null},_getNumUsedColors:function(a){return this._numUsedColors?this._numUsedColors[a]:0},calculateNumberOfUsedColors:g})}),define("objects.views/charts/representation/color-map-data-wrangler",[],function(){function a(b,c,d){if(c===d)return[b];var e=[];return"U"!==b.qType&&"O"!==b.qType&&"T"!==b.qType&&b.qSubNodes.forEach(function(b){e=e.concat(a(b,c+1,d))}),e}function b(a){return a.some(function(a){return a.qIsNull||a.qElemNumber===e||a.qElemNumber===d})}function c(c,d,e,f,g,h,i){d=d||0,e=e||0,h=h||e,i=i!==!1;var j,k=0,l=[],m=[];if(c){if(c.qDataPages[0]){var n=c.qDataPages[0].qMatrix;k=c.qDataPages[0].qArea.qTop||k,n.forEach(function(a,c){!g&&b(a)||(m[c]=a[e])}),j=g?f?"qElemNo":"qElemNumber":"qNum"}else if(c.qStackedDataPages[0]){var o=c.qStackedDataPages[0].qData[0];m=a(o,0,e+1);var p=[];h>e?m.forEach(function(b){a(b,0,h-e).forEach(function(a){p[a.qRow]=b})}):(p=[],m.forEach(function(a){p[a.qRow]=a})),m=p,j=g?"qElemNo":f?"qNum":"qValue"}f?i?m.forEach(function(a,b){l[k+b]=a[f].qValues[d][j]}):m.forEach(function(a,b){l[k+b]=a[f].qValues[d]}):i?m.forEach(function(a,b){l[k+b]=a[j]}):m.forEach(function(a,b){l[k+b]=a})}return l}var d=-3,e=-2;return{wrangleData:c}}),define("general.utils/attribute-expression-util",[],function(){return{getById:function(a,b,c){return!!a&&(c=c||"id",a.filter(function(a){return a[c]===b})[0])},getIndexById:function(a,b,c){var d=-1;return a&&(c=c||"id",a.forEach(function(a,e){a[c]===b&&(d=e)})),d},moveById:function(a,b,c,d){var e=this.getIndexById(a,c,d);b=b||[];var f=this.getIndexById(b,c,d);if(e!==-1&&f===-1){var g=a.splice(e,1);b.push(g[0])}return b},moveByIdFromGroup:function(a,b,c,d,e){c=c||"qAttributeExpressions",e=e||"id";for(var f=0;f<a.length;f++){var g=a[f][c],h=b.length;if(this.moveById(g,b,d,e),h!==b.length)return b}return b},clean:function(a){return a.filter(function(a){return a&&a.id})},IDMAP:{CELL_BACKGROUND_COLOR:"cellBackgroundColor",CELL_FOREGROUND_COLOR:"cellForegroundColor",COLOR_BY_ALTERNATIVE:"colorByAlternative",COLOR_BY_EXPRESSION:"colorByExpression",CELL_URL_LABEL:"urlLabel"}}});define("objects.utils/date-formatter",["core.utils/class"],function(a){"use strict";function b(a,b){for(var c=a.length;c<b;c++)a="0"+a;return a}function c(a,b){var c=a.getHours(),d=a.getDay()-1;return b&&((c%=12)||(c=12)),d<0&&(d=6),{year:a.getFullYear(),month:a.getMonth(),day:d,date:a.getDate(),h:c,m:a.getMinutes(),s:a.getSeconds(),f:a.getMilliseconds(),t:a.getHours()>=12?"pm":"am"}}function d(a){var b=a.toString().split(".");return b[1]?b=Number("0."+b[1]):0}function e(a){var b=a,c=24*d(b),e=60*d(c),f=60*d(e),g=1e3*d(f);return{d:Math.floor(b),h:Math.floor(c),m:Math.floor(e),s:Math.floor(f),f:Math.round(g)}}function f(a,b){var c,d=e(a),f=d.d,g=d.h,h=d.m,i=d.s,j=d.f,k=0;return/w+|t+/gi.test(b)&&(c=new Date(1899,11,30+Math.floor(a),0,0,86400*(a-Math.floor(a))),isNaN(c.getTime())&&(c=null)),/D+/gi.test(b)||(g+=24*f),/h+/gi.test(b)||(h+=60*g),/m+/gi.test(b)||(i+=60*h),/w+/gi.test(b)&&(k=c?c.getDay()-1:0)<0&&(k=6),{year:0,month:0,day:k,date:f,h:g,m:h,s:i,f:j,t:c?c.getHours()>=12?"pm":"am":""}}function g(a,c){return{"Y+|y+":{Y:Number((c.year+"").slice(-2))+"",YY:b((c.year+"").slice(-2),2),YYY:b((c.year+"").slice(-3),3),def:function(a){return b(c.year+"",a.length)}},"M+":{M:c.month+1,MM:b(c.month+1+"",2),MMM:a.locale_months_abbr[c.month],def:a.locale_months[c.month]},"W+|w+":{W:c.day,WW:b(c.day+"",2),WWW:a.locale_days_abbr[c.day],
def:a.locale_days[c.day]},"D+|d+":{D:c.date,def:function(a){return b(c.date+"",a.length)}},"h+|H+":{h:c.h,def:function(a){return b(c.h+"",a.length)}},"m+":{m:c.m,def:function(a){return b(c.m+"",a.length)}},"s+|S+":{s:c.s,def:function(a){return b(c.s+"",a.length)}},"f+|F+":{def:function(a){var b=c.f+"",d=a.length-b.length;if(d>0)for(var e=0;e<d;e++)b+="0";else d<0&&(b=b.slice(0,a.length));return b}},"t{1,2}|T{1,2}":{def:function(a){var b=c.t;return a[0].toUpperCase()===a[0]&&(b=b.toUpperCase()),b=b.slice(0,a.length)}}}}var h,i=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],j=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],k=["January","February","March","April","May","June","July","August","September","October","November","December"],l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return h=a.extend({init:function(a,b){var c=a||{};c.qCalendarStrings||(c.qCalendarStrings={qLongDayNames:i,qDayNames:j,qLongMonthNames:k,qMonthNames:l}),this.localeInfo=c,this.locale_days=c.qCalendarStrings.qLongDayNames.slice(),this.locale_days_abbr=c.qCalendarStrings.qDayNames.slice(),this.locale_months=c.qCalendarStrings.qLongMonthNames.slice(),this.locale_months_abbr=c.qCalendarStrings.qMonthNames.slice(),this.pattern=b},clone:function(){var a=new h(this.localeInfo,this.pattern);return a.subtype=this.subtype,a},format:function(a,b){b||(b=this.pattern?this.pattern:"YYYY-MM-DD hh:mm:ss"),b=b.replace(/\[.+\]|\[|\]/g,"");var d,e=/t+/gi.test(b);d=a instanceof Date?c(a,e):f(a,b);var h=g(this,d),i=[];for(var j in h)i.push(j);var k=new RegExp(i.join("|"),"g");return b.replace(k,function(a){var b;for(var c in h)if(b=new RegExp(c),b.test(a))break;if(!b)return"";var d;for(var e in h[c])if(e===a||e.toLowerCase()===a){d=h[c][e],void 0===d&&(d=h[c][e.toLowerCase()]);break}return void 0===d&&(d=h[c].def),"function"==typeof d&&(d=d(a)),d})}}),h.parseInterval=e,h}),define("objects.utils/num-date-time-formatter",["objects.utils/number-formatter","objects.utils/date-formatter"],function(a,b){"use strict";function c(a){if(isNaN(a)||!isFinite(a))return 1;var b=Number(a).toExponential(),c=b.split("e"),d=1;return"+"===c[1][0]&&(d+=Number(c[1])),d}function d(a){if(isNaN(a)||!isFinite(a))return 0;var b,c=Number(a).toExponential(),d=c.split("e"),e=0;return"-"===d[1][0]?(e=Math.abs(Number(d[1])),d=d[0].split("."),d[1]&&(e+=d[1].length)):(b=Number(d[1]),d=d[0].split("."),e=d[1]?d[1].length-b:0),e}var e,f={AUTO:"U",INTEGER:"I",NUMBER:"R",FIXED_TO:"F",MONEY:"M",DATE:"D",TIME:"T",DATE_TIME:"TS",INTERVAL:"IV"};return e=a.extend("QFormatter",{init:function(c,d,e,g,h){var i=c||{};this.localeInfo=i,this.pattern=d||"",this.decimalDelimiter="string"==typeof g?g:"string"==typeof i.qDecimalSep?i.qDecimalSep:".",this.thousandDelimiter="string"==typeof e?e:"string"==typeof i.qThousandSep&&this.decimalDelimiter!==i.qThousandSep?i.qThousandSep:"",this.type=h||f.AUTO,h===f.AUTO&&(this.pattern="#"+this.decimalDelimiter+"##A"),this._numberFormatter=new a(c),this._dateFormatter=new b(c),this.prepare()},clone:function(){return new e(this.localeInfo,this.pattern,this.thousandDelimiter,this.decimalDelimiter,this.type)},prepare:function(a,b,c){if(a||(a=this.pattern),!a)switch(this.type){case f.INTEGER:a="##############";break;case f.NUMBER:a=Array(this.localeInfo.qnDec||11).join("#");break;case f.FIXED_TO:a="#"+this.localeInfo.qDecimalSep||"."+Array(this.localeInfo.qnDec||4).join("#");break;case f.MONEY:a=this.localeInfo.qMoneyFmt,c||(c=this.localeInfo.qMoneyDecimalSep||"."),b||c===this.localeInfo.qMoneyThousandSep||(b=this.localeInfo.qMoneyThousandSep);break;case f.DATE:a=this.localeInfo.qDateFmt||"YYYY-MM-DD";break;case f.DATE_TIME:a=this.localeInfo.qTimestampFmt||"YYYY-MM-DD hh:mm:ss";break;case f.TIME:case f.INTERVAL:a=this.localeInfo.qTimeFmt||"hh:mm:ss";break;default:a="##########"}this._numberFormatter.pattern=this.pattern,this._dateFormatter.pattern=this.pattern,this._numberFormatter.thousandDelimiter=this.thousandDelimiter,this._numberFormatter.decimalDelimiter=this.decimalDelimiter,this._numberFormatter.type=this.type,this._numberFormatter.prepare(a,b,c),this._prepared={pattern:a,t:b,d:c}},formatValue:function(a,b){var c,d=this._prepared;if("NaN"===a||"number"==typeof a&&isNaN(a))return"-";if(isNaN(a)||"number"!=typeof a)return a+"";switch(this.type){case f.DATE:case f.TIME:case f.DATE_TIME:return c=new Date(1899,11,30+Math.floor(a),0,0,86400*(a-Math.floor(a))),isNaN(c.getTime())?this._numberFormatter.format(a,"0",d.t,d.d):this._dateFormatter.format(c,b||d.pattern);case f.INTERVAL:return this._dateFormatter.format(a,d.pattern);default:return this._numberFormatter.formatValue(a)}},format:function(a,b,c,d){return"NaN"===a||"number"==typeof a&&isNaN(a)?"-":isNaN(a)||"number"!=typeof a?a+"":(this.prepare(b,c,d),this.formatValue(a))},createPatternFromRange:function(a,b,c){var d,e,f,g="",h=Number(Number(a).toExponential().split("e")[1]),i=Number(Number(b).toExponential().split("e")[1]),j=Math.min(Math.abs(h),Math.abs(i)),k=Math.abs(b-a),l=Number(Number(k/50).toExponential().split("e")[1]);if(f=Math.abs(l),0===k)return"0"+this.decimalDelimiter+"##"+(c?"A":"");if(l>=0?f=c?Math.max(2,j-l):0:(e=(c?j-j%3:0)*(i<0?1:-1),f-=e),this.thousandDelimiter?g+="#"+this.thousandDelimiter+"##0":g+="0",f)for(g+=this.decimalDelimiter,d=0;d<f;d++)g+="#";return g+(c?"A":"")}}),e.getSignificantIntegers=function(a){return c(a)},e.getSignificantDecimals=function(a){return d(a)},e}),define("objects.views/charts/representation/expression-color-map",["client.utils/theme/theme-module","general.utils/color-cache","objects.views/charts/representation/sequential-color-map","objects.views/charts/representation/color-map-data-wrangler","general.utils/attribute-expression-util","objects.utils/num-date-time-formatter","translator"],function(a,b,c,d,e,f,g){"use strict";function h(a,b){var c,d=-Number.MAX_VALUE,e=Number.MAX_VALUE,f=!0;return b.color.autoMinMax===!1?{min:b.color.measureMin||0,max:b.color.measureMax||10}:a?(a.forEach(function(a){c=a.value,isNaN(c)||(d=Math.max(d,c),e=Math.min(e,c),f=!1)}),f?null:{min:e,max:d}):null}function i(a){var c=[];return a.forEach(function(a,d){c[d]={color:b.retriveColor(isNaN(a.qNum)?a.qText:a.qNum,"argb"),value:a.qNum}}),c}var j=a.get();return c.extend({init:function(a){this._formatter=new f(null),this._super(a)},setData:function(a,b){if(this._super(a,b),this._wrangledMapping=[],a){var c=a.color||{},f=a.qHyperCube?a.qHyperCube:a.qListObject;if(this._qDataObject=f,this._data=a,this._isColorExpression=c.expressionIsColor!==!1,this._byExpression="byExpression"===c.mode,this._expressionLabel=c.expressionLabel&&""!==c.expressionLabel?c.expressionLabel:g.get("Object.ChartTooltip.ColorExpression"),this._byExpression){var j=-1,k=-1,l=!1;if(f.qDimensionInfo.concat(f.qMeasureInfo).forEach(function(a,b){a.qAttrExprInfo&&a.qAttrExprInfo.every(function(a,c){a.id!==e.IDMAP.COLOR_BY_EXPRESSION||l||(j=b,k=c,l=!0)})}),!(j>=0&&k>=0))return;var m=d.wrangleData(f,k,j,"qAttrExps",j<f.qDimensionInfo.length,f.qDimensionInfo.length-1,!1);if(this._wrangledMapping=i(m),this._minMax=h(this._wrangledMapping,a),!this._minMax)return;var n=this._wrangledMapping;this._numUsedColors=[this.calculateNumberOfUsedColors(this._minMax.max,this._minMax.min,n.map(function(a){return a.value}),1,this.getLargestScaleSize())],this._formatter.pattern=this._formatter.createPatternFromRange(this._minMax.min,this._minMax.max,!0),this._formatter.prepare(),this._activeScale.setMaxMinValues(this._minMax.max,this._minMax.min)}else this._minMax=null,this._mapping=null,this._formatter.pattern=this._formatter.createPatternFromRange(0,1,!0),this._formatter.prepare()}},getColor:function(a,c,d,e){if(!this._byExpression)return this._super(a,c,d,e);var f;if((f=Array.isArray(a)?this._dimIndex>=0?a[this._dimIndex]:void 0:a)===-3||void 0===f&&Array.isArray(a)&&a.indexOf(-3)!==-1)return b.retriveColor(j.dataColors.othersColor);if(f===-2)return b.retriveColor(j.dataColors.nullColor);var g=this._wrangledMapping?this._wrangledMapping[c]:null;return!g||g.color.isInvalid()&&this._isColorExpression?b.retriveColor(j.dataColors.nullColor):this._isColorExpression?g.color:this._super(a,c,0,g.value)},getExpressionValue:function(a){return!this._wrangledMapping[a]||this._isColorExpression?void 0:this._wrangledMapping[a].value},getLegendTitle:function(){return this._byExpression?this._expressionLabel:this._super()},getLegendMode:function(){return this._byExpression?this._isColorExpression?["box","item","primary",!0]:[this._classes?"box":"scale",this._classes?"range":"item","measure",!0]:this._super()},getValueFormatter:function(){return this._colorDataInfo&&this._colorDataInfo.altMode&&void 0!==this._colorDataInfo.matchingDataMeasure?this._measureFormatters&&this._measureFormatters[this._colorDataInfo.matchingDataMeasure]?this._measureFormatters[this._colorDataInfo.matchingDataMeasure]:this._formatter:this._byExpression||this._colorDataInfo&&this._colorDataInfo.altMode?this._formatter:this._measureFormatters&&this._measureFormatters[0]?this._measureFormatters[0]:this._formatter},setGenericFormatter:function(a){this._super(a),this._byExpression&&this._minMax?(this._formatter.pattern=this._formatter.createPatternFromRange(this._minMax.min,this._minMax.max,!0),this._formatter.prepare()):this._formatter.pattern=this._formatter.createPatternFromRange(0,1,!0),this._formatter.prepare()},getGenericFormatter:function(){return this._formatter},_getMinMax:function(a,b){return this._byExpression?this._minMax?{min:this._minMax.min,max:this._minMax.max}:null:this._super(a,b)}})}),define("objects.views/charts/representation/qualitative-color-map",["translator","client.utils/theme/theme-module","general.utils/color-cache","core.utils/class","core.utils/feature-flags"],function(a,b,c,d,e){"use strict";function f(a,b){return l.resolveColor(b||a)}function g(a,b){var c=b||0,d=[];return a.forEach(function(a){void 0===d[a]&&a>=0&&(d[a]=c,c++)}),d}function h(a){return this._persistColors||this._measureMode?a:this._reMappedIndeces[a]}function i(){j={},l.dataPalettes.forEach(function(a){j[a.propertyValue]={type:a.type,scale:a.scale}})}var j,k,l=b.get();return d.extend({init:function(a,b){b=b||{},this._primaryColorMode=b.colorBy||"auto",this._autoMode=b.autoMode||"auto",this._primaryColor=l.dataColors.primaryColor,this._persistColors=!0,this._wrangled=[],this._dimIndex=0,i(),this._themeChangeWatcher=function(){i()},l.ThemeChanged.bind(this._themeChangeWatcher),k=j[l.dataPalettes[0].propertyValue],a&&this.setData(a)},release:function(){l.ThemeChanged.unbind(this._themeChangeWatcher)},setData:function(b,c){if(this._data=b,this._colorDataInfo=c,!c.valid)return this._dimLabel="",void(this._wrangled=[]);var d=b.color||{},h=b.qHyperCube?b.qHyperCube:b.qListObject,i=h&&h.qMeasureInfo?h.qMeasureInfo.length:0;this._colorMode=d.auto?"auto":d.mode||"primary",this._internalMode=this._colorDataInfo.internalMode,e.DIM_COLOR?this._measureMode="multiple"===this._internalMode||"byMultiple"===this._colorMode||"meas_master"===this._internalMode||"dim_master"===this._internalMode:this._measureMode="multiple"===this._internalMode||"byMultiple"===this._colorMode||"master"===this._internalMode,this._persistColors=this._colorDataInfo.persistentColors,this._dimIndex=this._colorDataInfo.dimIndex||0,this._measureMode?this._dimLabel=a.get("Common.Measures"):this._dimLabel=this._colorDataInfo.legendTitle,this._wrangled=this._colorDataInfo.wrangled,this._dimSize=this._measureMode?i:this._colorDataInfo.dimSize,this._persistColors||(this._reMappedIndeces=g(this._wrangled,this._colorDataInfo.top)),void 0!==d.singleColor&&(this._primaryColor=f(d.singleColor,d.paletteColor),"none"===this._primaryColor&&(this._primaryColor="rgba(0,0,0,0)"));var l=this._colorDataInfo.dimensionScheme&&j[this._colorDataInfo.dimensionScheme]||k;if("pyramid"===l.type){var m=Math.max(Math.min(l.scale.length-1,this._dimSize-1)%l.scale.length,0);this._qualitativeScale=l.scale[m]}else this._qualitativeScale=l.scale},getColor:function(a,b,d){var e=Array.isArray(a)?this._dimIndex>=0?a[this._dimIndex]:void 0:a,f=this._measureMode?d:this._wrangled[b];return e===-3||Array.isArray(a)&&a.indexOf(-3)!==-1?c.retriveColor(l.dataColors.othersColor):e===-2?c.retriveColor(l.dataColors.nullColor):"primary"===this._internalMode&&"auto"===this._colorMode?c.retriveColor(l.dataColors.primaryColor):"primary"===this._internalMode?c.retriveColor(this._primaryColor):isNaN(f)||f===-2?c.retriveColor(l.dataColors.nullColor):(f=h.call(this,f),c.retriveColor(this._qualitativeScale[f%this._qualitativeScale.length]))},getLegendMode:function(){var a;return a=e.DIM_COLOR?"primary"===this._internalMode||"dim_master"===this._internalMode?"primary":"measure"===this._autoMode||"measure"===this._primaryColorMode||this._measureMode?"measure":"dimension":"primary"===this._internalMode?"primary":"measure"===this._autoMode||"measure"===this._primaryColorMode||this._measureMode?"measure":"dimension",["box","item",a,"measure"===a]},getColorFromPreScaledValue:function(a){return isNaN(a)?c.retriveColor(l.dataColors.errorColor):a===-3?c.retriveColor(l.dataColors.othersColor):a===-2?c.retriveColor(l.dataColors.nullColor):(a=h.call(this,a),c.retriveColor(this._qualitativeScale[a%this._qualitativeScale.length]))},getDimensionIndex:function(){return this._colorDataInfo?this._dimIndex:0},getLegendTitle:function(){return this._dimLabel}})}),define("objects.views/charts/representation/combo-color-map-tooltip-util",[],function(){function a(a,b){return'<div class="color-template-wrapper"><div class="color-dot" style="background:'+b+'"></div><span>'+a+"</span></div>"}return{createLegendTemplate:a}}),define("client.utils/base-color-support",[],function(){var a=["scatterplot","map"],b=["map"];return{isSupported:function(b){return b&&b.length&&a.indexOf(b)===-1},isDimSupported:function(a){return a&&a.length&&b.indexOf(a)!==-1}}}),define("objects.views/charts/representation/combo-color-map",["translator","core.utils/class","objects.views/charts/representation/legend-data-provider","objects.views/charts/representation/expression-color-map","objects.views/charts/representation/qualitative-color-map","objects.views/charts/representation/combo-color-map-tooltip-util","objects.views/charts/representation/color-map-data-wrangler","general.utils/attribute-expression-util","general.utils/color-cache","client.utils/theme/theme-module","client.utils/base-color-support","core.utils/feature-flags"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a,b,c,d,e,f){var g,h,i,j=Array.isArray(d.qDimensionInfo)?d.qDimensionInfo.length:1,m=d.qMeasureInfo?d.qMeasureInfo.length:0;return l.DIM_COLOR?(h=l.MASTER_MEASURE_COLOR&&"measure"===e&&s(d.qMeasureInfo),i=l.DIM_COLOR&&"dimension"===e&&s(d.qDimensionInfo),g=h||i):g=l.MASTER_MEASURE_COLOR&&"measure"===e&&s(d.qMeasureInfo),l.DIM_COLOR?(a&&a!==x?"byMultiple"===a?a=g?D:C:"byDimension"===a?a=z:"byMeasure"===a?a=A:"byExpression"===a?a=B:a===y&&(i?a=E:h&&(a=F)):a=!s(d.qDimensionInfo)||1!==j&&!k.isDimSupported(f)||!(m<=1||b===y)||b!==y&&c!==x?s(d.qMeasureInfo)&&(b===y||c===x&&j<=1)&&k.isSupported(f)?F:b===y||c===x&&j<=1&&m<=1?y:m>1&&c!==z&&a!==y?C:z:E,a===D&&(a=h?F:E)):a&&a!==x?"byMultiple"===a?a=g?D:C:"byDimension"===a?a=z:"byMeasure"===a?a=A:"byExpression"===a?a=B:a===y&&(a=g?D:y):a=l.MASTER_MEASURE_COLOR&&s(d.qMeasureInfo)&&(b===y||c===x&&j<=1)&&k.isSupported(f)?D:b===y||c===x&&j<=1&&m<=1?y:m>1&&c!==z&&a!==y?C:z,a}function n(a){var b=Number.MIN_VALUE,c=Number.MAX_VALUE,d=!0;return a.forEach(function(a){isNaN(a)||(b=Math.max(a,b),c=Math.min(a,c),d=!1)}),{min:d?0:c,max:d?10:b}}function o(a){return a&&a.length?(a=a.filter(function(a){return"N"===a.qType}),1===a.length&&"V"!==a[0].qSubNodes[0].qType?1+o(a[0].qSubNodes):0):0}function p(a,b,c,d,e){var f=0,g=Array.isArray(b),h=g?b.length:1;if(c&&!a)for(f;f<h;++f)if((g?b[f].cId:b.cId)===c)return f;var i=e.qStackedDataPages&&e.qStackedDataPages.length&&e.qStackedDataPages[0].qData&&e.qStackedDataPages[0].qData.length?e.qStackedDataPages[0].qData[0].qSubNodes:null;return d===G?o(i):h-1}function q(a,b,c,d,e){return b===z?a||c.qDimensionInfo.length>1||e&&c.qSize.qcy>d.qArea.qHeight:b===A&&("K"===c.qMode||c.qSize.qcy>d.qMatrix.length)}function r(a,b,c){var d=0;if(0===c){for(;a&&a.parent;)a=a.parent;return a}for(;b;){if(a.getDimensions().length-1===c)return a;if(a.getDimensions().length-1-d===c)return b;b=b.parent,d++}}function s(a){return a.filter(function(a){return a.baseColor&&a.baseColor.color}).length>0}function t(a,b,c){if(!l.MASTER_MEASURE_COLOR)return!1;c=Array.isArray(c)?c:[c];var d=a.qHyperCube.qMeasureInfo;return!(c.indexOf(H)!==-1||c.indexOf(I)!==-1)&&k.isSupported(a.visualization)&&void 0!==b&&d[b].baseColor&&d[b].baseColor.color}function u(a,b){if(!l.DIM_COLOR)return!1;b=Array.isArray(b)?b:[b];var c=b.indexOf(H)!==-1||b.indexOf(I)!==-1,d=a.qHyperCube.qDimensionInfo.filter(function(a){return!(!a.baseColor||!a.baseColor.color)}).length>0;return!c&&d}function v(a){return a.filter(function(a){return!(!a.baseColor||!a.baseColor.color)})[0].baseColor}var w,x="auto",y="primary",z="dimension",A="measure",B="expression",C="multiple",D="master",E="dim_master",F="meas_master",G="first",H=-3,I=-2,J=j.get();return w=b.extend({init:function(a,b){b=b||{},this._primaryColorMode=b.colorBy||x,this._autoMode=b.autoMode||x,this._multiDimScheme=b.multiDimScheme||"last",this._qualitativeMap=new e(null,b),this._sequentialMap=new d(null,b),this._legendDataProvider=new c(a),this._legendDataProvider.setColorMap(this),this._enableAltMode=!0,this._colorDataInfo={dimIndex:0,wrangled:[],valid:!1},this._title="DEBUG",a&&this.setData(a)},getColor:function(a,b,c,d){if("error"===this._colorDataInfo.internalMode)return this._qualitativeMap.getColor(I);if("measure"===this._colorMode||"expression"===this._colorMode)return this._sequentialMap.getColor(a,d,c,b);if(l.DIM_COLOR){if(this._colorDataInfo.internalMode===F&&t(this._data,c,a))return i.retriveColor(J.resolveColor(this._data.qHyperCube.qMeasureInfo[c].baseColor));if(this._colorDataInfo.internalMode===E&&u(this._data,a))return i.retriveColor(J.resolveColor(v(this._data.qHyperCube.qDimensionInfo)))}else if(this._colorDataInfo.internalMode===D&&t(this._data,c,a))return i.retriveColor(J.resolveColor(this._data.qHyperCube.qMeasureInfo[c].baseColor));return this._qualitativeMap.getColor(a,d,c,b)},getColorFromPreScaledValue:function(a){return"measure"===this._colorMode||"expression"===this._colorMode?this._sequentialMap.getColorFromPreScaledValue(a):this._qualitativeMap.getColorFromPreScaledValue(a)},getTooltipContent:function(b,c){var d,e,g,h,i=null;if(this._colorDataInfo.valid)if("expression"===this._colorMode&&void 0!==(d=this._sequentialMap.getExpressionValue(void 0===c?b.row:c))&&(this._sequentialMap.getValueFormatter&&(e=this._sequentialMap.getValueFormatter())&&(d=e.formatValue(d)),i={label:this.getLegendTitle(),template:f.createLegendTemplate(d,this._sequentialMap.getColor(b.id,void 0===c?b.row:c,0,d))}),this._colorDataInfo.altMode){var j=!0;if("dimension"===this._colorDataInfo.internalMode){var k=b._attrDims[this._colorDataInfo.attrIndex];if(!k)return;if(b.id===H)h=b.id===H?a.get("properties.dimensionLimits.others"):k.label?k.label:"",g=this._qualitativeMap.getColorFromPreScaledValue(H);else{if(k.value===I)return;h=k.label?k.label:"",g=this._qualitativeMap.getColorFromPreScaledValue(k.value)}}else"measure"===this._colorDataInfo.internalMode&&(d=void 0!==c?this._colorDataInfo.wrangled[c]:b.values[this._colorDataInfo.legendMode.rangeSelectionIndex],j=void 0!==d,h=this._sequentialMap.getGenericFormatter&&(e=this._sequentialMap.getGenericFormatter())?e.formatValue(d):d,g=this._sequentialMap.getColorFromPreScaledValue(d));j&&(i={label:this.getLegendTitle(),value:h+"",template:f.createLegendTemplate(h,g)})}else if("dimension"===this._colorDataInfo.internalMode){var l=b.getDimensions(),m=l[l.length-this._colorDataInfo.dimIndex-1];if(!m)return;h=m;var n=r(b,b,this._colorDataInfo.dimIndex);g=this._qualitativeMap.getColorFromPreScaledValue(n.id),i={label:this.getLegendTitle(),template:f.createLegendTemplate(h,g)}}return i},getColorMapping:function(){return this._legendDataProvider.getColorMapping()},generateScaleBasedMapping:function(){return this._sequentialMap.generateScaleBasedMapping()},getSelectionIndices:function(){return this.getDimensionIndex()},getLegendTitle:function(){return"measure"===this._colorMode||"expression"===this._colorMode?this._sequentialMap.getLegendTitle():this._qualitativeMap.getLegendTitle()},getDimensionIndex:function(){return"measure"===this._colorMode?[0]:[this._qualitativeMap.getDimensionIndex()]},setData:function(a,b){if(this._colorMode="qualitative",this._data=a,this._colorDataInfo={dimIndex:0,wrangled:[],valid:!1},a.color){var c=a.color,d=a.qHyperCube,e="";e=a.qInfo&&a.qInfo.qType?a.qInfo.qType:b,this._colorDataInfo.internalMode=m(c.auto?x:c.mode||x,this._autoMode,this._primaryColorMode,d,c.useBaseColors,e);var f,i,j=this._data.qHyperCube.qDimensionInfo.length-1,k=this._data.qHyperCube.qDataPages[0]||this._data.qHyperCube.qStackedDataPages[0]||{qArea:{qHeight:0},qMatrix:[]},o=a.qHyperCube.qDimensionInfo[j],r=a.qHyperCube.qMeasureInfo[0],s=j,t=j,u=-1;this._colorDataInfo.internalMode!==z||c.auto?this._colorDataInfo.internalMode===A&&(u=h.getIndexById(o.qAttrExprInfo,h.IDMAP.COLOR_BY_ALTERNATIVE),f=u!==-1?o.qAttrExprInfo[u]:null,i="qAttrExps"):(u=h.getIndexById(o.qAttrDimInfo,h.IDMAP.COLOR_BY_ALTERNATIVE),f=u!==-1?o.qAttrDimInfo[u]:null,i="qAttrDims"),this._colorDataInfo.altMode=this._enableAltMode&&!!f&&j>=0&&u>=-1;var v=!this._colorDataInfo.altMode&&this._colorDataInfo.internalMode===A&&!r;if(this._colorDataInfo.valid=(this._colorDataInfo.altMode&&f&&!f.qError||!this._colorDataInfo.altMode&&!!o)&&!v,!this._colorDataInfo.valid)return this._colorDataInfo.internalMode="error",void(this._colorDataInfo.allNaN=!0);if(this._colorDataInfo.dimIndex=j,this._colorDataInfo.attrIndex=u,this._colorDataInfo.hasOthers=!!a.qHyperCube.qHasOtherValues,this._colorDataInfo.persistentColors=q(c.persistent,this._colorDataInfo.internalMode,d,k,this._colorDataInfo.altMode),this._colorDataInfo.top=k.qArea.qTop,this._colorDataInfo.altMode?(this._colorDataInfo.internalMode===A?(this._colorDataInfo.minMax={min:f.qMin||0,max:f.qMax||10},this._colorDataInfo.matchingDataMeasure=f.matchMeasure,this._colorDataInfo.dimSize=c.autoMinMax===!1?o.qCardinal:a.qHyperCube.qSize.qcy):this._colorDataInfo.internalMode===z&&(this._colorDataInfo.dimSize=this._colorDataInfo.persistentColors?f.qCardinal:f.qSize.qcy),this._colorDataInfo.legendTitle=f.label||f.qFallbackTitle):this._colorDataInfo.internalMode===A?(s=j+1,this._colorDataInfo.minMax=isNaN(r.qMin)||isNaN(r.qMax)?null:{min:r.qMin||0,max:r.qMax||10},this._colorDataInfo.legendTitle=r.qFallbackTitle,this._colorDataInfo.dimSize=c.autoMinMax===!1?o.qCardinal:a.qHyperCube.qSize.qcy):this._colorDataInfo.internalMode===z?(this._colorDataInfo.dimIndex=j=s=p(c.auto,d.qDimensionInfo,c.dimensionId,this._multiDimScheme,d),o=a.qHyperCube.qDimensionInfo[j],this._colorDataInfo.legendTitle=o.qFallbackTitle,this._colorDataInfo.dimSize=this._colorDataInfo.persistentColors?o.qCardinal:a.qHyperCube.qSize.qcy):this._colorDataInfo.internalMode===B&&(this._colorDataInfo.dimSize=c.autoMinMax===!1?o.qCardinal:a.qHyperCube.qSize.qcy),this._colorDataInfo.internalMode!==A&&this._colorDataInfo.internalMode!==z||(this._colorDataInfo.wrangled=g.wrangleData(a.qHyperCube,u,s,!(!this._colorDataInfo.altMode||!this._colorDataInfo.valid)&&i,this._colorDataInfo.internalMode===z,t),this._colorDataInfo.allNaN=this._colorDataInfo.altMode&&0===this._colorDataInfo.wrangled.filter(function(a){return a!==I&&!isNaN(a)}).length),this._colorDataInfo.internalMode!==A||this._colorDataInfo.persistentColors||(this._colorDataInfo.minMax=n(this._colorDataInfo.wrangled)),a.color.auto)this._colorMode="auto";else switch(this._colorDataInfo.internalMode){case A:this._colorMode="measure";break;case B:this._colorMode="expression";break;case y:this._colorMode="primary"}this._colorDataInfo.dimensionScheme=a.color.dimensionScheme,l.DIM_COLOR?this._colorDataInfo.internalMode!==F&&this._colorDataInfo.internalMode!==E||(this._colorDataInfo.dimensionScheme=J.dataPalettes[0].propertyValue):this._colorDataInfo.internalMode===D&&(this._colorDataInfo.dimensionScheme=J.dataPalettes[0].propertyValue);var w,C;"measure"===this._colorMode||"expression"===this._colorMode?(this._sequentialMap.setData(a,this._colorDataInfo),w=this._sequentialMap.getLegendMode()):(this._qualitativeMap.setData(a,this._colorDataInfo),w=this._qualitativeMap.getLegendMode()),C=l.DIM_COLOR?this._colorDataInfo.internalMode===F&&1===this._data.qHyperCube.qMeasureInfo.length||this._colorDataInfo.internalMode===E&&1===this._data.qHyperCube.qDimensionInfo.length?y:w[2]:this._colorDataInfo.internalMode===D&&1===this._data.qHyperCube.qMeasureInfo.length?y:w[2],this._colorDataInfo.legendMode={discrete:"scale"!==w[0],boxType:w[1],colorMode:C,selectionEnabled:!w[3],altMode:this._colorDataInfo.altMode,rangeSelectionIndex:this._colorDataInfo.altMode?this._data.qHyperCube.qMeasureInfo.length:0},this._colorDataInfo.altMode&&this._colorDataInfo.internalMode===z&&this._colorDataInfo.valid&&"dimension"===this._colorDataInfo.legendMode.colorMode&&(this._colorDataInfo.legendPath="/qHyperCubeDef/qDimensions/"+j+"/qAttributeDimensions/"+u,this._colorDataInfo.legendPages=[{qTop:0,qLeft:0,qWidth:2,qHeight:99}],this._colorDataInfo.altLocked=f.qLocked,this._colorDataInfo.attrInfo=f),this._legendDataProvider.setData(a)}},hasAttributeDimension:function(){return this._colorDataInfo.altMode&&!!this._colorDataInfo.legendPath},getAttributeDimensionInfo:function(){return this.hasAttributeDimension()?[this._colorDataInfo.attrInfo]:[]},getColorDataInfo:function(){return this._colorDataInfo},setAltModeEnabled:function(a){this._enableAltMode=a},determineInternalMode:m,setMeasureFormatters:function(a){this._measureFormatters=a,this._sequentialMap.setMeasureFormatters(a)},setGenericFormatter:function(a){this._sequentialMap.setGenericFormatter(a)},getValueFormatter:function(){return this._measureFormatters?this._measureFormatters[0]:null},setDimensionTree:function(a){this._dimensionTree=a,this._legendDataProvider.setDimensionTree(a)},getLegendDataProvider:function(){return this._legendDataProvider},release:function(){this._qualitativeMap.release&&this._qualitativeMap.release(),this._sequentialMap.release&&this._sequentialMap.release(),this._legendDataProvider.release&&this._legendDataProvider.release(),this._dimensionTree=null,this._legendDataProvider=null,this._sequentialMap=null,this._qualitativeMap=null}}),Object.defineProperties(w.prototype,{mode:{get:function(){return this._colorMode}}}),Object.defineProperties(w,{AUTO:{value:"auto",writable:!1},PRIMARY:{value:"primary",writable:!1},MEASURE:{value:"measure",writable:!1},EXPRESSION:{value:"expression",writable:!1},QUALITATIVE:{value:"qualitative",writable:!1},DIMENSION:{value:z,writable:!1}}),Object.defineProperties(w.prototype,{AUTO:{value:"auto",writable:!1},PRIMARY:{value:"primary",writable:!1},MEASURE:{value:"measure",writable:!1},EXPRESSION:{value:"expression",writable:!1},QUALITATIVE:{value:"qualitative",writable:!1},DIMENSION:{value:z,writable:!1}}),w}),define("objects.views/charts/events/chart-event",["core.utils/class"],function(a){"use strict";return a.extend({init:function(a){this._type=a},getType:function(){return this._type}})}),define("objects.views/charts/events/property-change-event",["objects.views/charts/events/chart-event"],function(a){"use strict";return a.extend({init:function(a,b,c){this._super("propertyChange"),this.property=a,this.oldValue=b,this.newValue=c}})}),define("objects.views/charts/utils/binding",["core.utils/class","objects.views/charts/events/event-launcher","objects.views/charts/events/property-change-event"],function(a,b,c){function d(){var a,b,c,d,f,j,k,l;for(4===arguments.length?(c=new h(arguments[0]),a=arguments[1],b=arguments[2],j=arguments[3]):(c=new h(arguments[0],arguments[1]),a=arguments[2],b=arguments[3],j=arguments[4]),d=b.split("."),f=d[0],l=0;l<d.length;l++)k=new g(a,f),c.add(k),a=a&&"function"==typeof a[e(f)]?a[e(f)]():void 0,f=d[l+1];return c.startObserving(j),new i(c)}function e(a){return"get"+a.substring(0,1).toUpperCase()+a.substring(1)}function f(a,b){var d,e,f=b.substring(0,1).toUpperCase()+b.substring(1);"function"==typeof a["set"+f]&&(a[k]||(a[k]={}),void 0===a[k][b]?(d=a["set"+f],e=a.hasOwnProperty("set"+f),a["set"+f]=function(e){var g="function"==typeof a["get"+f]?a["get"+f]():void 0;if("function"==typeof a["get"+f]&&e===g)return void d.call(a,e);d.call(a,e),a.fire(new c(b,g,e))},a[k][b]={observers:1,original:d,isOriginalOwn:e,keep:!1}):a[k][b].observers++)}var g,h,i,j,k="__setters";return g=b.extend("Link",{init:function(a,b){this._super(),this._property=b,this._host=a},setHost:function(a){this._host===a&&this._hostObserved||(this.unobserve(),this._host=a,this.observe())},observe:function(a){if(!this._host)return void this.fire("hostPropertyValueChanged",[void 0]);f(this._host,this._property);var b=this,c=e(this._property);this._callback=function(a){a.property===b._property&&b.fire("hostPropertyValueChanged",[a.newValue])},this._callbackSimple=function(){"function"==typeof this[c]&&b.fire("hostPropertyValueChanged",[this[c]()])},a||"function"!=typeof this._host[c]||b.fire("hostPropertyValueChanged",[this._host[c]()]),this._host.listen("propertyChange",this._callback),this._host.listen(this._property+"Changed",this._callbackSimple),this._hostObserved=!0},unobserve:function(){if(this._host){if(this._callback&&this._host.stopListen("propertyChange",this._callback),this._callbackSimple&&this._host.stopListen(this._property+"Changed",this._callbackSimple),this._host[k]&&this._host[k][this._property]){var a,b=this._host[k][this._property];b.observers--,b.observers<=0&&(a="set"+this._property.substring(0,1).toUpperCase()+this._property.substring(1),b.isOriginalOwn?this._host[a]=b.original:(this._host[a]=null,delete this._host[a]),b.original=null,this._host[k][this._property]=null,delete this._host[k][this._property])}this._host=void 0,this._callback=void 0,this._callbackSimple=void 0,this._hostObserved=!1}}}),h=a.extend("Chain",{init:function(a,b){this._links=[],1===arguments.length&&"function"==typeof a?this._setter=a:(this._wannabe=a,this._wannabeProp=b)},add:function(a){var b,c=this;a.listen("hostPropertyValueChanged",function(a){if((b=c._links.indexOf(this))===c._links.length-1)if(c._setter)c._setter(a);else{var d="set"+c._wannabeProp.substring(0,1).toUpperCase()+c._wannabeProp.substring(1);"function"==typeof c._wannabe[d]&&c._wannabe[d](a)}else c._links[b+1].setHost(a)}),this._links.push(a)},startObserving:function(a){this._links[0].observe(a)},isBroken:function(){return this._isBroken},unwatch:function(){for(var a=this._links.pop();a;)a.unobserve(),a.stopListen("hostPropertyValueChanged"),a=this._links.pop();this._setter=void 0,this._wannabe=void 0,this._wannabeProp=void 0}}),i=a.extend("ChangeWatcher",{init:function(a){this._chain=a},unbind:function(){this._chain.unwatch()}}),j={},j.bindProperty=function(a,b,c,e,f){return d(a,b,c,e,f)},j.bindSetter=function(a,b,c,e){return d(a,b,c,e)},j.getter=e,j}),define("objects.views/charts/components/mini-chart",["./chart-component","../components/axis/continuous-axis","../components/data-area","../chart-context","objects.views/charts/representation/combo-color-map","objects.views/charts/utils/binding","general.utils/color","core.utils/deferred"],function(a,b,c,d,e,f,g,h){function i(a){var b=[],c=[];return a.qHyperCube.qMeasureInfo.forEach(function(a){a.series&&"bar"!==a.series.type&&1===a.series.axis?c.push(a):b.push(a)}),{primaryMeasures:b,secondaryMeasures:c}}function j(a,b){var c,d={};if(b)for(c in a)d[c]="qHyperCube"===c?{qDataPages:[],qDimensionInfo:a.qHyperCube.qDimensionInfo.slice(),qMeasureInfo:a.qHyperCube.qMeasureInfo.slice(),qStackedDataPages:[],qMode:"S",qSize:{qcx:2,qcy:0}}:a[c];else{if(!a.reducedHyperCube)return a;d={}
;for(c in a)d[c]="qHyperCube"===c?a.reducedHyperCube:a[c]}return d}var k;return k=a.extend("MiniChart",{init:function(a,b){this._super.apply(this,Array.prototype.slice.call(arguments)),this.components={},this.options=b,this._chartContext=new d,this._createComponents();this._colorMap=void 0,this._constantColorMap={getColorByNode:function(){return new g(12303291)},getColor:function(){return new g(12303291)}},this.components.dataArea.setColorMap&&this.components.dataArea.setColorMap(this._constantColorMap),this.components.continuousAxis&&this.components.dataArea.setContinuousAxis(this.components.continuousAxis),this.components.dataArea.setLayoutMode(3),f.bindProperty(this.components.dataArea,"dimensionTree",this._chartContext,"dimensionTree"),this._logScale=!1},setYMirrorMode:function(a){if(this.yMirrorMode!==a){this.yMirrorMode=a;for(var b in this.components)this.components[b].setYMirrorMode(a)}},setData:function(a,b){if(!a||!a.qHyperCube)return h.resolve();if(this.isDimensionContinuous=b,this.components.dataArea.setIsDimensionContinuous&&this.components.dataArea.setIsDimensionContinuous(b),b)return this._data=a,this.invalidateProperties();this._data=null;var c,d,e=a.qHyperCube,f=this,g=Math.min(2e3,1e4/(e.qMeasureInfo.length+1)),i=("linechart"===a.visualization||"barchart"===a.visualization&&a.barGrouping&&"stacked"===a.barGrouping.grouping)&&e.qDimensionInfo.length>1&&"K"===e.qMode?1:0;return"function"!=typeof this.backendApi.getReducedData?(this._data=j(a),this.invalidateProperties()):(c=j(a,!0),a.reducedHyperCube=c.qHyperCube,d=a.reducedHyperCube,this.backendApi.getReducedData([{qTop:0,qLeft:i,qWidth:a.qHyperCube.qDimensionInfo.length+a.qHyperCube.qMeasureInfo.length+i,qHeight:g}],-1).then(function(a){return d.qDataPages=a,f._data=c,i&&a&&(a[0].isReduced||a[0].qIsReduced)&&(d.qDimensionInfo=e.qDimensionInfo.slice(0,1),d.qMeasureInfo=[e.qMeasureInfo[0],e.qMeasureInfo[0]]),f.invalidateProperties()}))},calculateRelevantSize:function(){this.relevantSize=Math.max(30,Math.min(40,this.outerRect[this.isVertical()?"width":"height"]/8))},setRect:function(a,b,c,d){this.rect.width===c&&this.rect.height===d||this.invalidateDisplay(),this._super(a,b,c,d);for(var e in this.components)this.components[e].setRect(0,0,c,d);this.updateSize()},setOuterRect:function(a,b,c,d){this._super(a,b,c,d);for(var e in this.components)this.components[e].setOuterRect(a,b,c,d)},setLayoutToContainerRatios:function(a,b){this._super(a,b);for(var c in this.components)this.components[c].setLayoutToContainerRatios(a,b)},setContainerRect:function(a,b,c,d){this._super(a,b,c,d);for(var e in this.components)this.components[e].setContainerRect(a,b,c,d)},updateSize:function(){this._super();for(var a in this.components)this.components[a].updateSize()},isVisible:function(a){return this._super(a)&&this.rect&&this.rect.width>0&&this.rect.height>0},setLogScale:function(a){this._logScale=a,this._logScale!==!0&&(this._logScale=!1)},getLogScale:function(){return this._logScale},setHasValidData:function(a){this._super(a),Object.keys(this.components).forEach(function(b){this.components[b].setHasValidData(a)},this)},setDock:function(a){this._super(a),this.isVertical()?(this.components.measureAxis.setDock("top"),this.components.dimensionAxis.setDock("left")):(this.components.measureAxis.setDock("left"),this.components.dimensionAxis.setDock("bottom"))},paint:function(a,b){if(!b||!this.isVisible())return h.resolve();this._super(a,b);var c,d=[];this.components.dataArea.rect=this.rect.clone(),this.components.dimensionAxis.rect=this.components.dataArea.rect,this.components.measureAxis.rect=this.components.dataArea.rect,this.components.dataArea.rect.x=0,this.components.dataArea.rect.y=0,this.components.dimensionAxis.invalidateProperties("MiniChart.paint"),this.components.dimensionAxis.updateNow(["properties"]),this.components.measureAxis.invalidateProperties("MiniChart.paint"),this.components.measureAxis.updateNow(["properties"]),this.components.dimensionAxis.calculateValuePositionMappingInfo(),this.components.measureAxis.calculateValuePositionMappingInfo();for(c in this.components)d.push(this.components[c].invalidateDisplay("MiniChart.paint"));return h.all(d)},_createComponents:function(){var a=this.components,d=this.options;Object.keys(d.components).forEach(function(e){var f,g=[this.testId||"component",e].join("."),h=d.components[e];if(h.label=e,"function"==typeof d.components[e].clazz)f=d.components[e].clazz;else switch(e){case"dataArea":f=c;break;case"yAxis":case"measureAxis":f=b}f&&(a[e]=new f(this.container,h,g)),a[e].setUseTransition&&a[e].setUseTransition(!1)},this)},updateColorMap:function(a){if(a&&a.qHyperCube&&a.qHyperCube.qDimensionInfo[0]){var b=a.qHyperCube.qDataPages[0]&&a.qHyperCube.qDataPages[0].qIsReduced;this.components.dataArea.setColorMap&&(this.isDimensionContinuous||!b&&(a.color.auto||"byExpression"!==a.color.mode)?(this._miniColorMap||(this._miniColorMap=new e),this._colorMap&&(a.color.persistent=!!this._colorMap.getColorDataInfo().persistentColors),this._miniColorMap.setDimensionTree(this._chartContext.getDimensionTree()),this._miniColorMap.setData(a),this.components.dataArea.setColorMap(this._miniColorMap)):this.components.dataArea.setColorMap(this._constantColorMap))}},setActiveDimensionAxis:function(a){this.components[a]&&(this._activeDimAxis=this.components[a],this.components.dataArea&&this.components.dataArea.setActiveDimensionAxis(this.components[a]))},updateAxis:function(a){var b,c,d,e,f,g,h,j,k;"combochart"===a.visualization?(h=i(a),j=h.primaryMeasures,k=h.secondaryMeasures,f=Math.min.apply(this,k.filter(function(a){return!isNaN(a.qMin)}).map(function(a){return a.qMin})),g=Math.max.apply(this,k.filter(function(a){return!isNaN(a.qMax)}).map(function(a){return a.qMax})),this.components.secondaryMeasureAxis.setDataRange(f,g),f=Math.min.apply(this,j.filter(function(a){return!isNaN(a.qMin)}).map(function(a){return a.qMin})),g=Math.max.apply(this,j.filter(function(a){return!isNaN(a.qMax)}).map(function(a){return a.qMax}))):(f=Math.min.apply(this,a.qHyperCube.qMeasureInfo.filter(function(a){return!isNaN(a.qMin)}).map(function(a){return a.qMin})),g=Math.max.apply(this,a.qHyperCube.qMeasureInfo.filter(function(a){return!isNaN(a.qMax)}).map(function(a){return a.qMax}))),b=this.components.measureAxis,c=this.components.dimensionAxis,b.setNiceNumberEnabled(!1),b.setLogScale(this._logScale),"barchart"===a.visualization&&(g=Math.max(0,g),f=Math.min(0,f)),e=this.components.dataArea.getMinorAxisData(),e&&(g=e.max,f=e.min),f===g&&0===g||isNaN(f)&&isNaN(g)?(g=10,f=-10,b.setDataRange(f,g)):(e||this.isDimensionContinuous)&&b.setDataRange(f,g),this.isDimensionContinuous?a.qHyperCube.qDimensionInfo&&(f=a.qHyperCube.qDimensionInfo[0].qMin,g=a.qHyperCube.qDimensionInfo[0].qMax,this._activeDimAxis.setDataRange(f,g),this._activeDimAxis.setPlotMin(f),this._activeDimAxis.setPlotMax(g)):(d=this.components.dataArea.getMajorAxisData(),d?c.setDataRange(d.data,d.info):c.setDataRange([],[]))},setBackendApi:function(a){this.backendApi=a},setColorMap:function(a){this._colorMap=a},getColorMap:function(){return this._colorMap},setOrientation:function(a){this._orientation=a||"horizontal"},_updateProperties:function(){if(this._data){var a=this._data;this._chartContext.refresh(a),this.updateColorMap(a),this.components.dataArea.setData(a),this.components.dataArea.updateNow(["properties"]),this.updateAxis(a),this.invalidateDisplay("MiniChart._updateProperties")}},clear:function(){Object.keys(this.components).forEach(function(a){this.components[a].clear()},this)},release:function(){this._super(),Object.keys(this.components).forEach(function(a){this.components[a].release()},this),this._miniColorMap&&this._miniColorMap.release()},showComponent:function(){if(this._super.apply(this),this.components.dataArea&&this.components.dataArea.renderers)for(var a in this.components.dataArea.renderers)this.components.dataArea.renderers[a].show()},hideComponent:function(){if(this._super.apply(this),this.components.dataArea&&this.components.dataArea.renderers)for(var a in this.components.dataArea.renderers)this.components.dataArea.renderers[a].hide()}}),Object.defineProperty(k.prototype,"className",{value:"MiniChart"}),k}),define("objects.views/charts/utils/chart-formatting",["core.utils/class","objects.utils/num-date-time-formatter","objects.utils/number-formatter"],function(a,b){"use strict";function c(a){return!!a.qIsAutoFormat&&["M","D","T","TS","IV"].indexOf(a.qNumFormat.qType)<0}return a.extend("ChartFormatting",{init:function(a,b){this.localeInfo=a,this.measureFormatters=this.getFormattersForMeasures(b),this.combinedMeasuresFormatter=this.getFormatterFromFormatters(this.measureFormatters)},createFormatter:function(){return new b(this.localeInfo)},getLocaleInfo:function(){return this.localeInfo||{}},getFormatters:function(){return this.measureFormatters||[]},getMeasureFormatter:function(a){if(this.measureFormatters[a])return this.measureFormatters[a]},getCombinedMeasuresFormatter:function(){return this.combinedMeasuresFormatter},formatMeasure:function(a,b){var c=this.measureFormatters[b];return c?c.format(a):a},getFormatterFromFormatters:function(a){var c,d,e,f,g,h=0,i=0,j=0,k=a?a.filter(function(a){return!!a.values&&!isNaN(a.values.range)}):[];return a&&a.length&&(a.forEach(function(a){return"U"===a.type||a.values&&isNaN(a.values.range)?i++:["D","T","TS","IV"].contains(a.type)?h=1:j=1,a.prepare(),a}),k.length&&(c=k.reduce(function(a,b){return Math.min(b.values.min,a)},k[0].values.min),d=k.reduce(function(a,b){return Math.max(b.values.max,a)},k[0].values.max),e=Math.abs(d-c)),h+j>1?(g=a.filter(function(a){return"datetime"!==a.type})[0]||{},f=new b(this.localeInfo,g.pattern,g.thousandDelimiter,g.decimalDelimiter,"U"),isNaN(e)||(f.pattern=f.createPatternFromRange(c,d,!0))):h+j===1&&0===i?(g=a[0]||{},f=new b(this.localeInfo,g.pattern,g.thousandDelimiter,g.decimalDelimiter,g.type)):(g=a.filter(function(a){return"U"!==a.type}),g=g.length?g[0]:a[0]||{},f=new b(this.localeInfo,g.pattern,g.thousandDelimiter,g.decimalDelimiter,g.type),isNaN(e)||"U"!==g.type||(f.pattern=f.createPatternFromRange(c,d,!0))),f.prepare()),f||(f=new b(this.localeInfo,"0")),f},getFormattersForMeasures:function(a,d){var e,f=[];return a&&a.length&&(e=d?a.filter(function(a,b){return d.indexOf(b)>=0}):a,f=e.map(function(a){var d=c(a),e=new b(this.localeInfo,a.qNumFormat.qFmt,a.qNumFormat.qThou,a.qNumFormat.qDec,d?"U":a.qNumFormat.qType),f=Math.abs(a.qMax-a.qMin),g=isNaN(f);return e.values={min:a.qMin,max:a.qMax,range:f},!g&&d&&(e.pattern=e.createPatternFromRange(a.qMin,a.qMax,!0)),e.prepare(),e},this)),f}})}),define("objects.extension/base-view",["core.utils/class","core.utils/deferred"],function(a,b){"use strict";return a.extend({init:function(a,b,c,d){this.$scope=a,this.$element=b,this.options=c,this.backendApi=d},prePaint:function(){},paint:function(){return b.resolve()},resize:function(a,b){return this.paint(a,b)},setFreeResize:function(a){this.options.freeResize=a},setBackendApi:function(a){this.backendApi=a},updateData:function(){return b.resolve()},setInteractionState:function(a){this.options.interactionState=a},setDirection:function(a){this.options.direction=a},getContextMenu:function(){},getViewState:function(){return{}},destroy:function(){},getPreferredSize:function(){}})}),define("objects.views/selections/cache-item",[],function(){"use strict";function a(a,b,c,d,e,f,g){if(a instanceof Array&&!a[0].pointInside&&!a.pointInside)throw"The shape must implement a `pointInside` function";this.setShape(a),this.selected=!!b,this.value=c,this.parent=d,this.index=e,this.objectShapes={},f&&(this.parent=f.parent,this.node=f,this.rowIndex=f.data.rowIndex,this.label=f.data.qText,this.id=f.data.qElemNo),g&&a&&(this.objectShapes[g]=a instanceof Array?a:[a])}return a.prototype={getShapes:function(a){return(a||0===a)&&this.objectShapes&&this.objectShapes[a]?this.objectShapes[a]:this.shapes?this.shapes:[this.shape]},addShape:function(a,b){this.objectShapes[a]instanceof Array||(this.objectShapes[a]=[]),this.objectShapes[a].push(b),this.shapes.push(b)},setShape:function(a){this.shape=a instanceof Array?a[0]:a,this.shapes=a?a instanceof Array?a:[a]:[]},addValue:function(a){void 0===this.value&&(this.value=[]),this.value instanceof Array||(this.value=[this.value]),this.value.push(a)}},a}),define("objects.extension/default-selection-toolbar",["core.utils/class"],function(a){"use strict";return a.extend("SelectionToolbar",{menuButtons:[],init:function(a,b,c,d,e,f){this.backendApi=a,this.selectionsApi=b,this.showMenu=c,this.showLock=d,e=e||[],this.menuButtons=f||[];var g=[{name:"Tooltip.clearSelection",tid:"selection-toolbar.clear",isIcon:!0,buttonClass:"clear",iconClass:"lui-icon lui-icon--clear-selections",action:function(){this.selectionsApi.clear()},isDisabled:function(){return!this.selectionsApi.selectionsMade}},{clazz:"sel-toolbar-separator",buttonClass:"sel-toolbar-icon-separator",isDisabled:function(){return!0}}];g.push({name:"Tooltip.CancelSelections",tid:"selection-toolbar.undo",isIcon:!1,iconClass:"lui-icon lui-icon--close",buttonClass:"sel-toolbar-cancel",action:function(){this.selectionsApi.cancel()}}),g.push({name:"Tooltip.ConfirmSelections",tid:"selection-toolbar.refresh",iconClass:"lui-icon lui-icon--tick",buttonClass:"sel-toolbar-confirm",action:function(){this.selectionsApi.confirm()},isDisabled:function(){return!this.selectionsApi.selectionsMade}}),this.buttons=e.concat(g)},hasState:function(a){if(!a)return!0;for(var b=this.backendApi.getDimensionInfos(),c=0;c<b.length;++c)for(var d=0;d<a.length;++d)if(b[c].qStateCounts[a[d]]>0)return!0;return!1}})}),define("objects.utils/interaction-states",[],function(){"use strict";return{STATIC:0,ANALYSIS:1,EDIT:2}}),define("objects.extension/default-view",["objects.extension/base-view","core.utils/deferred","qvangular","general.utils/shapes/rect","objects.views/selections/cache-item","objects.extension/default-selection-toolbar","objects.utils/interaction-states"],function(a,b,c,d,e,f,g){"use strict";var h;return h=a.extend("DefaultView",{$scope:null,$element:null,containerRect:null,options:null,selections:null,backendApi:null,activeDimensions:[0],selectedShapes:[],init:function(a,b,c,d){this._super(a,b,c,d),a.selectValues=this.selectValues.bind(this)},on:function(){this.selections&&this.selections.on(),this.tooltips&&this.tooltips.on(),this.options&&this.options.selections===!1?this.selectionsEnabled=!1:this.selectionsEnabled=!0,this._on=!0},off:function(){this.selections&&this.selections.off(),this.tooltips&&this.tooltips.off(),this.selectionsEnabled=!1,this._on=!1},isOn:function(){return this._on},suppressOnPaint:function(a){return this.$scope.object._forcePaint?(this.$scope.object._forcePaint=!1,!1):a.qSelectionInfo&&a.qSelectionInfo.qInSelections},paint:function(){return b.resolve(!1)},destroy:function(){this.$scope.selectValues=null},initialize:function(){this.selections&&this.initSelections(),this.options&&(isNaN(this.options.interactionState)||this.setInteractionState(this.options.interactionState),this.options.direction&&this.setDirection(this.options.direction)),this.tooltips&&this.initTooltips()},setSelections:function(a){this.selections=a},initSelections:function(){this.selections&&(this.selections._disableSelections=this.options._disableSelections,this.selections.types.dataArea.setComponent("dataArea",{rect:new d(0,0,this.$element.width(),this.$element.height())}),this.options._disableSelections||(this.selections.Select.bind(function(a,b){this.onSelect(a,b)}.bind(this)),this.selections.ToggleShape.bind(function(a){var b=this.selectedShapes.indexOf(a);b!==-1?this.selectedShapes.splice(b,1):this.selectedShapes.push(a),this.onToggleShape(a)}.bind(this)),this.selections.Deactivated.bind(function(){this.selectedShapes=[]}.bind(this)),this.selections.Clear.bind(function(){this.selectedShapes=[]}.bind(this))))},setTooltips:function(a){this.tooltips=a},initTooltips:function(){},refreshSelections:function(){this.selections&&(this.containerRect=this.$element[0].getBoundingClientRect(),this.selections.cache.clear())},onToggleShape:function(a){a.$element[this.isSelected(a.value)?"addClass":"removeClass"]("selected")},onSelect:function(a,b){if(a.length){var c=this.selectedShapes.map(function(a){return a.value});c.length>0&&this.activeDimensions.length>0?this.backendApi.select(c,this.activeDimensions,b):1!==a.length||a[0].selected||this.backendApi.clearSelections()}},onRangeSelect:function(){},addToSelectionCache:function(a,b){if(this.selections){var c=this.containerRect,f=a[0].getBoundingClientRect(),g=new e(new d(f.left-c.left,f.top-c.top,f.right-f.left,f.bottom-f.top),!1,b);g.$element=a,this.selections.cache.add(g)}},isSelected:function(a){return this.selectedShapes.filter(function(b){return b.value===a}).length},setSnapshotData:function(){},getSelectionToolbar:function(){var a=this;return new f(this.$scope.backendApi,this.$scope.selectionsApi,!1,!1,[{name:"Tooltip.ToggleOnLassoSelection",tid:"selection-toolbar.toggleLasso",isIcon:!0,buttonClass:"sel-toolbar-icon-toggle",iconClass:"lui-icon lui-icon--lasso",action:function(){a.toggleLasso=!a.toggleLasso},isActive:function(){return this.name=a.toggleLasso?"Tooltip.ToggleOffLassoSelection":"Tooltip.ToggleOnLassoSelection",a.toggleLasso},isDisabled:function(){return!(!a.isLassoDisabled||!a.isLassoDisabled())}}],[])},selectValues:function(a,b,c){if(this.selectionsEnabled){if(!this.backendApi.inSelections()){var d=this.$scope,e=this;d.selectionsApi.confirm=function(){d.backendApi.endSelections(!0),d.selectionsApi.deactivated()},d.selectionsApi.cancel=function(){d.backendApi.endSelections(!1),d.selectionsApi.deactivated()},d.selectionsApi.deactivate=function(){this.deactivated()},d.selectionsApi.clear=function(){e.clearSelectedValues(e.$element),d.backendApi.clearSelections(),d.selectionsApi.selectionsMade=!1,e.selectedArrays={}},this.getSelectionToolbar=function(){return new f(this.$scope.backendApi,this.$scope.selectionsApi,!1,!1,[],[])},this.backendApi.beginSelections(),d.selectionsApi.activated(),this.selectedArrays={}}if(this.$scope.selectionsApi.selectionsMade=!0,this.selectedArrays[a]||(this.selectedArrays[a]=[]),c)for(var g=0;g<b.length;g++){var h=this.selectedArrays[a].indexOf(b[g]);h===-1?this.selectedArrays[a].push(b[g]):this.selectedArrays[a].splice(h,1)}else this.selectedArrays[a]=this.selectedArrays[a].concat(b);this.backendApi.selectValues(a,this.selectedArrays[a],!1)}},clearSelectedValues:function(a){a.find(".selected").removeClass("selected")},setInteractionState:function(a){this._interactionState=a,this._inEditState=a===g.EDIT,this._inAnalysisState=a===g.ANALYSIS,this._inAnalysisState&&!this._on?this.on():!this._inAnalysisState&&this._on&&this.off()},setDirection:function(a){this.$scope.options.direction=a,this.options.direction=a,this.selections&&this.selections.options&&this.selections.options.range&&(this.selections.options.range.rtl="rtl"===a,this.selections.types.range.setDirection(a))},inAnalysisState:function(){return this._inAnalysisState},inEditState:function(){return this._inEditState},getPreferredSize:function(){}}),Object.defineProperties(h.prototype,{toggleLasso:{set:function(a){this.selections&&(this.selections.lassoEnabled=a,c.$apply(function(){this.options.lassoEnabled=a}.bind(this)))},get:function(){return this.selections&&this.selections.lassoEnabled}}}),h}),define("objects.views/selections/selections-cache",["core.utils/class"],function(a){function b(a,b,c){var d=b.indexOf(a);d===-1&&c!==!1?b.push(a):d===-1||c||b.splice(d,1)}function c(a){var b,c=[];return a.forEach(function(a){a.split(";").forEach(function(a){b=a.split(":"),c[+b[0]]||(c[+b[0]]=[]),c[b[0]].indexOf(+b[1])===-1&&c[b[0]].push(+b[1])})}),c}function d(a){a._dirty&&(a.columns=c(a.values)),a._dirty=!1}function e(a,b){var c=[];do{b&&b.indexOf(a.col)===-1||c.push(a.col+":"+a.id)}while((a=a.parent)&&void 0!==a.col&&void 0!==a.id);return c.join(";")}var f,g={ROW:1,VALUE:2};return f=a.extend({init:function(){this.rows=[],this.values=[],this.columns=[],this.indicesToTrack=null,this._dirty=!1,this.selectionMode=g.ROW|g.VALUE},clear:function(){this.clearRows(),this.clearValues()},toggle:function(a,b){this.toggleRow(a.row,b),this.toggleValue(a.value,a.col,b)},toggleByCacheItem:function(a){this.toggleRow(a.rowIndex||a.row||0,a.selected);var c=e(a,this.indicesToTrack);c&&b(c,this.values,a.selected),this._dirty=!0},toggleRow:function(a,c){b(a,this.rows,c)},toggleValue:function(a,c,d){b((c||0)+":"+a,this.values,d),this._dirty=!0},isRowSelected:function(a){return!!(this.selectionMode&g.ROW)&&this.rows.indexOf(a)!==-1},isValueSelected:function(a,b){return!!(this.selectionMode&g.VALUE)&&(d(this),void 0!==this.columns[b||0]&&this.columns[b||0].indexOf(a)!==-1)},isValueChainSelected:function(a){if(!(this.selectionMode&g.VALUE))return!1;if(this.indicesToTrack){d(this);var b=e(a,this.indicesToTrack).split(";");return b.length&&!b.some(function(a){var b=a.split(":");return!(void 0!==this.columns[+b[0]||0]&&this.columns[+b[0]||0].indexOf(+b[1])!==-1)},this)}return this.values.indexOf("string"==typeof a?a:e(a,this.indicesToTrack))!==-1},isCacheItemSelected:function(a){return this.isValueChainSelected(a)||this.isRowSelected(a.rowIndex||a.row||0)},hasSelections:function(){return!!(this.selectionMode&g.ROW)&&this.rows.length>0||!!(this.selectionMode&g.VALUE)&&this.values.length>0},setRows:function(a){this.rows=a.slice()},setValues:function(a,b){this.values=a.map(function(a){return(b||0)+":"+a}),this._dirty=!0},getSelectedColumns:function(){d(this);var a=this.columns;return a.filter(function(a){return void 0!==a}).map(function(b){return a.indexOf(b)})},getSelectedValuesInColumn:function(a){return d(this),this.columns[a||0]||[]},getSelectedValues:function(){return d(this),this.columns},clearRows:function(){this.rows.length=0},clearValues:function(){this.values=[],this.columns.length=0,this._dirty=!1},setSelectionMode:function(a){this.selectionMode=a},trackByIndices:function(a){this.indicesToTrack=Array.isArray(a)?a.slice():null}}),f.SELECTION_MODE=f.prototype.SELECTION_MODE=g,f}),define("objects.views/selections/attribute-selections-cache",["objects.views/selections/selections-cache"],function(a){return a.extend("AttributeSelectionsCache",{isCacheItemSelected:function(a){var b=a.getAttributeDimensions();return b&&1===b.length&&this.isValueSelected(b[0])}})}),define("objects.views/selections/cache-collection",[],function(){function a(a){this.collection=a||[]}return a.prototype={clear:function(){this.collection.forEach(function(a){a.clear()})},add:function(a){this.collection.indexOf(a)===-1&&this.collection.push(a)},remove:function(a){var b=this.collection.indexOf(a);b!==-1&&this.collection.splice(b,1)},isCacheItemSelected:function(a){return this.collection.some(function(b){return b.isCacheItemSelected(a)})}},a}),define("text!objects.views/charts/disclaimers/chart-disclaimer.ng.html",[],function(){return'<div class="qv-viz-disclaimer"\n\t ng-if="visible && (attributes.limitedData || attributes.onlyNullColor || attributes.hasNegativeOrZeroData || attributes.hasDataRangeIncludingZero) && !attributes.doesNotFit"\n\t ng-style="getDisclaimerStyle(attributes.chartScale)"\n\t qva-direction x-dir-setting="{{direction}}" x-dir-text="{{languageString}}">\n\t<span class="ltr-star">*</span>\n\t<span ng-if="attributes.limitedData" q-translation="Object.Disclaimer.LimitedData" q-title-translation="Object.Disclaimer.LimitedData"></span>\n\t<span ng-if="attributes.onlyNullColor" q-translation="Object.Disclaimer.OnlyNanColor" q-title-translation="Object.Disclaimer.OnlyNanColor"></span>\n\t<span ng-if="attributes.hasNegativeOrZeroData" q-translation="Object.Disclaimer.NegativeOrZeroValues" q-title-translation="Object.Disclaimer.NegativeOrZeroValues"></span>\n\t<span ng-if="attributes.hasDataRangeIncludingZero" q-translation="Object.Disclaimer.DataRangeIncludingZero" q-title-translation="Object.Disclaimer.DataRangeIncludingZero"></span>\n\t<span class="rtl-star">*</span>\n</div>\n'}),define("objects.views/charts/disclaimers/chart-disclaimer-directive",["qvangular","text!./chart-disclaimer.ng.html","translator"],function(a,b,c){a.directive("qvaChartDisclaimer",function(){return{template:b,scope:{attributes:"=",visible:"=",direction:"="},link:function(a){a.getDisclaimerStyle=function(a){return a=Math.min(1,a||1),{"font-size":1*a+"em"}},a.languageString=c.get("Object.Disclaimer.LimitedData")}}})}),define("objects.views/charts/chart",["jquery","./events/event-launcher","./layout-engine","./components/data-area","./components/axis/axis","./components/axis/discrete-axis","./components/axis/continuous-axis","./components/legend/color-legend","./components/legend/basic-color-legend","./components/mini-chart","./representation/combo-color-map","./chart-context","general.utils/shapes/rect","objects.utils/layout","objects.views/charts/utils/binding","objects.views/charts/utils/chart-formatting","objects.extension/default-view","objects.utils/event-utils","core.utils/deferred","objects.views/selections/selections-cache","objects.views/selections/attribute-selections-cache","objects.views/selections/cache-collection","objects.views/charts/disclaimers/chart-disclaimer-directive"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){"use strict";function w(a){this._chartScale!==a&&(this._chartScale=a,this.$scope.dataAttributes.chartScale=a,Object.keys(this.components).forEach(function(a){this.components[a].chartScale=this._chartScale},this))}function x(){var a,b,c,d,e,f,g,h,i=this.container.parentElement,j="",k="";if(i.style.height="100%",i.style.width="",i.style.left="",i.style.top="",!this._readStoredData||this.options.freeResize)return void w.call(this,1);a=this.container.clientWidth,b=this.container.clientHeight,g=this._data.snapshotData.content.size,c=g.w,d=g.h;var l=c/d;l<=a/b?(h=b/d,e=b*l/a,a=100*e+"%",b="100%",j=50*(1-e)+"%"):(h=a/c,f=a/l/b,b=100*f+"%",a="",k=50*(1-f)+"%"),w.call(this,h),i.style.width=a,i.style.height=b,i.style.left=j,i.style.top=k}function y(){this._sizeChanged=!1,x.call(this);var a,b,c=this.rect,d=this.container.clientWidth,e=this.container.clientHeight,f=new m(0,0,d,e);if(this.containerRect=new m(0,0,d,e),this._readStoredData&&!this.options.freeResize&&(b={width:this._data.snapshotData.content.size.w,height:this._data.snapshotData.content.size.h}),b&&(f=new m(0,0,b.width,b.height)),!c||c.width!==f.width||c.height!==f.height){for(a in this.components)this.components[a].setOuterRect(f.x+1,f.y+1,f.width-2,f.height-2);this.rect=f,this._updateLayoutMode(this.rect.width,this.rect.height),this._sizeChanged=!0}}function z(a,b){Object.keys(this.components).forEach(function(c){["colorLegend","xAxis","dimensionAxis","timeAxis","continuousAxis","dataArea"].contains(c)&&this.components[c].setGlobalOpacity(a,b||!1)},this)}function A(){var a;this.chartFormatter=new p(this.backendApi.localeInfo,this._data.qHyperCube.qMeasureInfo);for(a in this.components)this.components[a].chartFormatter=this.chartFormatter,this.components[a].measureFormatters=this.chartFormatter.getFormatters(),this.components[a].combinedMeasuresFormatter=this.chartFormatter.getCombinedMeasuresFormatter()}function B(){var a=this;this.backendApi.clearSelections(),this.components.dataArea.getSelectableShapes().forEach(function(b){b.selected=!1,a.onSelection.ToggleShape.call(a,b)}),this.selectionsCacheCollection.clear(),this.onSelection.scheduleInvalidation.call(this)}var C,D;return C={debug:!0,components:{}},D=q.extend(function(){var a,c={};for(a in b.prototype)b.prototype.hasOwnProperty(a)&&"init"!==a&&(c[a]=b.prototype[a]);return c}()),D.extend({refreshSelections:function(){this.specialCaseForSingleSelect=!1},initialize:function(){this._super(),this._initiateBindings()},init:function(d,e,f,g,h){b.prototype.init.call(this),f=a.extend(!0,f||{},{},C);var i=e.find(".qv-viz");this._super(d,i,f,g),this.container=i[0],this.backendApi=g,this.selectionsApi=h,this.layoutEngine=new c,this.components={},this.providers={},this._changeWatchers=[],this._createComponents(),this._createProviders(),this._chartScale=1,this.chartFormatter=new p(this.backendApi.localeInfo),this.selectionsCache=new t,this.attributeSelectionsCache=new u,this.selectionsCacheCollection=new v([this.selectionsCache,this.attributeSelectionsCache]),this.selectionsCache.setSelectionMode(t.SELECTION_MODE.VALUE),this._chartContext=new l,this._layoutMode=n.LayoutMode.FULL,this.$scope.dataAttributes={},this.resize(),this.specialCaseForSingleSelect=!1,this._navigation=f.navigation},clearSelections:B,selectionModeAlpha:.5,getVerticalComponents:function(){var a=[];return this._data&&this._data.legend&&this.components&&this.components.colorLegend&&this.components.colorLegend.isVertical()&&a.push({comp:this.components.colorLegend,dock:this._data.legend.dock}),a},setYMirrorMode:function(a){if(this.yMirrorMode!==a){this.yMirrorMode=a;for(var b in this.components)this.components[b].setYMirrorMode(a);this.tooltips&&(this.tooltips.yMirrorMode=a),this.updateVerticalComponentsDock()}},updateVerticalComponentsDock:function(){var a,b,c,d,e;for(this._verticalComponents=this.getVerticalComponents(),b=this._verticalComponents?this._verticalComponents.length:0,a=0;a<b;a++)c=this._verticalComponents[a],d=c.comp,"far"!==c.dock&&"near"!==c.dock&&"auto"!==c.dock||(e="far"===c.dock||"auto"===c.dock,d.setDock(this.yMirrorMode?e?"left":"right":e?"right":"left"))},setMinimumRequirements:function(a,b){this._requirements={dimensions:{min:a},measures:{min:b}}},onToggleLasso:function(a){this.toggleLasso=a},isLassoDisabled:function(){return!this.selections.allowLasso},onSelection:{ToggleShape:function(a){var b=this.$scope.layout.layers?this.$scope.layout.layers[0]:this.$scope.layout,c=b.qListObject?b.qListObject:b.qHyperCube;if(!a.selected&&1===c.qSize.qcy)return void(this.specialCaseForSingleSelect=!0);this.toggleCacheItem?this.toggleCacheItem(a):this.onSelection.scheduleInvalidation.call(this),(a.id<-2||a.id>-1)&&(this.selections.getActiveType().activeComponent&&this.selectionsCache.trackByIndices(this.selections.getActiveType().activeComponent.getSelectionIndices()),this.selectionsCache.toggleByCacheItem(a)),this.specialCaseForSingleSelect=!1,this._haveToggledShapes=this.selectionsCache.hasSelections()},Activated:function(){z.apply(this,[this.selectionModeAlpha]),this._haveToggledShapes=!1},Deactivated:function(){z.apply(this,[1]),this.selectionsCacheCollection.clear(),this.toggleLasso=!1},Select:function(a,b,c,d){var e=this;if(!this.specialCaseForSingleSelect){var f=Array.isArray(c)?c:[c||0];if(this.selectionsCache.hasSelections()){var g,h=this.selectionsCache.getSelectedValuesInColumn(f[0]),i=-1;"K"===this._data.qHyperCube.qMode&&(i=h.indexOf(-3)),g=1===f.length&&i===-1?this.backendApi.selectValues(f[0],h,!1):this.backendApi.select(this.selectionsCache.rows,f,d),g.then(function(a){a||B.call(e)}).catch(function(a){a.isHandled=!0})}else a.length&&a.every(function(a){return!a.selected})&&this.selectionsApi.clear()}},SelectAttributeDim:function(a,b){var c,d,e=this;a.forEach(function(a){this.attributeSelectionsCache.toggleValue(a,!!b&&void 0)},this),c=this.attributeSelectionsCache.getSelectedValuesInColumn(0),(d=this.providers.colorMap&&this.providers.colorMap.getColorDataInfo())&&d.legendPath&&this.backendApi.selectValues(0,c,!1,d.legendPath).then(function(a){a||B.call(e)})},SelectRange:function(a,b){var c=this;a&&0!==a.length?"dimension"===a[0].type?this.backendApi.selectDimensionRange(a).then(function(a){a||B.call(c)}):this.backendApi.selectRange(a,b).then(function(a){a||B.call(c)}):this.selectionsApi.clear()},Confirm:function(){},Cancel:function(){this.selectionsCacheCollection.clear()},Clear:function(){this.selectionsCacheCollection.clear()},scheduleInvalidation:function(){var a=this;this._invalidationTimer||(this._invalidationTimer=setTimeout(function(){a.onSelection.invalidate.call(a),a._invalidationTimer=null},10))},cancelInvalidation:function(){clearTimeout(this._invalidationTimer),this._invalidationTimer=null},invalidate:function(){
this.components.dataArea.invalidateDisplay("Chart.onSelection.invalidate"),this.components.colorLegend&&this.components.colorLegend.invalidateDisplay("Chart.onSelection.invalidate"),Object.keys(this.components).forEach(function(a){(this.components[a]instanceof f||this.components[a]instanceof g&&this.components[a].isDimension)&&this.components[a].invalidateDisplay("Chart.onSelection.invalidate")},this)}},getLayoutMode:function(){return this._layoutMode},getVerticalLayoutMode:function(){return this._verticalLayoutMode},getHorizontalLayoutMode:function(){return this._horizontalLayoutMode},setLayoutMode:function(a){this._explicitLayoutMode=a,this._layoutMode!==a&&(this._layoutMode=a,this.fire("layoutModeChanged"))},getSnapshotSize:function(){return this.rect?{w:this.rect.width,h:this.rect.height}:{w:0,h:0}},_updateLayoutMode:function(a,b){this._explicitLayoutMode||(this._layoutMode=n.getLayoutMode(a,b),this._horizontalLayoutMode=n.getHorizontalLayoutMode(a),this._verticalLayoutMode=n.getVerticalLayoutMode(b),this.fire("layoutModeChanged"),this.fire("verticalLayoutModeChanged"),this.fire("horizontalLayoutModeChanged"))},_createProviders:function(){var a=this.options;a.providers.colorMap&&(this.providers.colorMap="function"==typeof a.providers.colorMap.clazz?new a.providers.colorMap.clazz(void 0,a.providers.colorMap):new k,this.components.dataArea&&this.components.dataArea.setColorMap(this.providers.colorMap),this.components.colorLegend&&this.components.colorLegend.setColorMap(this.providers.colorMap))},_initiateBindings:function(){this._changeWatchers||(this._changeWatchers=[]),Object.keys(this.components).forEach(function(a){this._changeWatchers.push(o.bindProperty(this.components[a],"layoutMode",this,"layoutMode")),this._changeWatchers.push(o.bindProperty(this.components[a],"verticalLayoutMode",this,"verticalLayoutMode")),this._changeWatchers.push(o.bindProperty(this.components[a],"horizontalLayoutMode",this,"horizontalLayoutMode"))},this),this.components.dataArea&&this._changeWatchers.push(o.bindSetter(this._updateSelectionCache.bind(this),this.components.dataArea,"selectableShapes"))},_updateSelectionCache:function(a){var b=this.selections&&this.selections.cache||this.tooltips&&this.tooltips.cache;if(b){a=a||this.components.dataArea.getSelectableShapes();var c=this.selectionsCacheCollection,d=!(!this.selections||!this.selections.getActiveType)&&this.selections.getActiveType(),f=!!d;b.clear(),a.forEach(function(a){b.add(a)}),f&&(/^item/.test(d.getActiveMode())?a.forEach(function(a){a.selected=c.isCacheItemSelected(a)}):(d.activeComponent instanceof e&&"range.measure"===d.getActiveMode()||d.activeComponent instanceof h&&"range"===d.getActiveMode())&&d.updateShapesState()),Object.keys(this.components).forEach(function(b){["colorLegend","xAxis","dimensionAxis"].contains(b)&&this.components[b].setSelectableShapes(a)},this)}},_createComponents:function(){var a,b,c,e=this,f=this.components,g=this.options;Object.keys(g.components).map(function(a){return{sortKey:g.components[a].sortKey||0,cmpKey:a}}).sort(function(a,b){return a.sortKey-b.sortKey}).forEach(function(k){var l=k.cmpKey;if(a=["component",l].join("."),b=g.components[l],b.label=l,c=null,"function"==typeof g.components[l].clazz)c=g.components[l].clazz;else switch(l){case"dataArea":case"dataArea2":c=d;break;case"colorLegend":c=h;break;case"basicColorLegend":c=i}c&&(b.parentType=e.constructor.name.charAt(0).toLowerCase()+e.constructor.name.slice(1),b._disableSelections=g._disableSelections,f[l]=new c(this.container,b,a),f[l].selectionsApi=e.selectionsApi,f[l].backendApi=e.backendApi,f[l]instanceof j||this.layoutEngine.addComponent(f[l]))},this)},preLayout:function(){},layout:function(a,b){this.layoutEngine.layout(this.rect,this._layoutMode,this.containerRect,a,b)},resize:function(){return this._data&&this.isDataValid(this._data)?(this.prePaint(this._data),this._paint()):s.resolve()},setSnapshotData:function(a,b){var c=this.getSnapshotSize(),d={};Object.keys(this.components).forEach(function(a){d[a]={visible:this.components[a].isVisible(),dock:this.components[a].dock,size:{w:this.components[a].rect.width,h:this.components[a].rect.height}}},this),a.snapshotData.content={chartData:this.getSnapshotChartData(b),size:{w:c.w,h:c.h},components:d,v:.96}},getSnapshotChartData:function(){var a={};if(this.components.colorLegend){a.legendScrollOffset=this.components.colorLegend.getScrollPosition();var b=this.components.colorLegend.getExternalDataPage();b&&(a.legendDataPage=b)}return a},getSnapshotStoredChartData:function(){if(this._data&&this._data.snapshotData&&this._data.snapshotData.content)return this._data.snapshotData.content.chartData},setInteractionState:function(a,b){this._super(a,b);var c=this;Object.keys(this.components).forEach(function(a){c.components[a].setUseTransition(c._navigation&&(c._inAnalysisState||c._inEditState))})},_postResize:function(){this._data.legend&&this.components.colorLegend&&this._updateLegendDock(this.components.colorLegend,this._data)},_paint:function(){if(!this.isValid(this._data))return this.clear().then(function(){return{invalid:!0}});var a=this.getSnapshotStoredChartData();return this.components.colorLegend&&(this.components.colorLegend.pagingMode=this._pagingMode||0,this._readStoredData&&a&&this.components.colorLegend.setScrollPosition(a.legendScrollOffset||0)),y.call(this),this.$scope.dataAttributes.doesNotFit=this.rect.height<10,this._sizeChanged&&this._postResize(),s.resolve()},paint:function(a){return a.qSelectionInfo&&a.qSelectionInfo.qInSelections||!this.isValid(this._data)?s.resolve():this._paint()},suppressOnPaint:function(a){var b=this._super(a);return b&&this.prePaint(a),b},prePaint:function(){return this.$scope.dataAttributes.layoutMode=this._layoutMode,this.$scope.dataAttributes.layoutMode=this._layoutMode,this.$scope.dataAttributes.onlyNullColor=!1,this._super()},updateData:function(a){this._data=a;var b,c=this.isValid(a);for(b in this.components)this.components[b].setHasValidData(c);if(!c)return this.updateSelectableState(a),this._updateSelectionCache([]),this.clear();var d=this._updateData(a);this.setYMirrorMode(this.options&&"rtl"===this.options.direction&&!(this._data&&this._data.reverseRtl));var e=this,f=function(){if(this.providers.colorMap){var a=this.providers.colorMap.getColorDataInfo();return this.components.colorLegend&&a&&a.legendPath?this._readStoredData?(e.components.colorLegend.setExternalColorItems(e._data.snapshotData.content.chartData.legendDataPage),s.resolve()):s.all([this.backendApi.getData(a.legendPages,a.legendPath).then(function(a){e.components.colorLegend.setExternalColorItems(a)})]):(this.components.colorLegend.setExternalColorItems(null),s.resolve())}return s.resolve()}.bind(this);return d&&"function"==typeof d.then?d.then(f):d=f()},_updateData:function(a){var b;this._data=a,this._readStoredData=this.options._readStoredData||a&&a.snapshotData&&a.snapshotData.content,this.selectionsCacheCollection.clear(),a.legend&&this.components.colorLegend&&(this.components.colorLegend[(a.legend.auto||a.legend.show?"show":"hide")+"Component"](),this.components.colorLegend.attributeSelectionsCache=this.attributeSelectionsCache,this._updateLegendDock(this.components.colorLegend,a)),A.call(this),this.providers.colorMap&&(this.providers.colorMap.setMeasureFormatters(this.chartFormatter.getFormatters()),this.providers.colorMap.setGenericFormatter(this.chartFormatter.createFormatter())),this.tooltips&&(this.tooltips.measureFormatters=this.chartFormatter.getFormatters(),this.tooltips.parentScope=this.$scope,this.tooltips.colorMap=this.providers.colorMap),this._chartContext.refresh(a);var c=this.isValid(this._data);for(b in this.components)this.components[b]._hasValidData=c;this.updateSelectableState()},_updateLegendDock:function(a,b){b.legend&&b.legend.dock&&"auto"!==b.legend.dock?a.setDock(b.legend.dock):a.setDock(a.outerRect.height/a.outerRect.width<1?this.yMirrorMode?"left":"right":"bottom")},destroy:function(){for(this.off();this._changeWatchers.length;)this._changeWatchers.pop().unbind();var a;for(a in this.components)this.components[a].release();for(a in this.providers)this.providers[a].release&&this.providers[a].release();this.$scope.dataAttributes={},this.selections&&(this.selections.cache.clear(),this.selections.release(),this.selections=null),this.tooltips&&(this.tooltips.release(),this.tooltips=null),this._chartContext.release(),this._super.apply(this,arguments)},clear:function(){var a=[];return Object.keys(this.components).forEach(function(b){a.push(this.components[b].clear())},this),s.all(a)},isValid:function(a){return this.isDataValid(a)},isDataValid:function(a){return!!a&&!!a.qHyperCube&&a.qHyperCube.qDimensionInfo.length&&!a.qHyperCube.qDimensionInfo.some(function(a){return!!a.qError})&&a.qHyperCube.qMeasureInfo.length&&!a.qHyperCube.qMeasureInfo.some(function(a){return!!a.qError})},isDataSelectable:function(a,b){return!(!this.isValid(this._data)||!this._inAnalysisState)&&(void 0!==b?a.qHyperCube.qDimensionInfo[b].qLocked!==!0:a.qHyperCube.qDimensionInfo.some(function(a){return a.qLocked!==!0}))},updateSelectableState:function(a){if(this.selections){var b=!this.isDataSelectable(a||this._data);Object.keys(this.components).forEach(function(a){this.components[a].setSelectionLocked(b)},this),this.selections&&this.selections.setLocked(b)}},on:function(){this._navigation&&Object.keys(this.components).forEach(function(a){this.components[a].on()},this),this._super(),this.updateSelectableState(this._data)},off:function(){this._navigation&&Object.keys(this.components).forEach(function(a){this.components[a].off()},this),this._super()},selectWhileLocked:function(a){r.showLockedFeedback(a||this._data.qHyperCube.qDimensionInfo)},getPreferredSize:function(){return this._super()}})}),define("objects.views/charts/components/ref-lines",["./chart-component","client.utils/theme/theme-module","objects.views/charts/utils/canvas-renderer"],function(a,b,c){"use strict";function d(a){return Number(void 0!==a.value?a.value:a)}function e(a){return i.resolveColor(a)}function f(){if(!this._numRefLinesDataAxes||!this._numAxes)return!1;var a,b,c,e,f,g,h;for(a=0;a<this._numAxes;a+=1)for(c=this._axes[a],g=c.getPlotMin(),h=c.getPlotMax(),this._axisPlotMinValues[a]=g,this._axisPlotMaxValues[a]=h,e=this._data[a]||[],b=0;b<e.length;b+=1)if(f=d(e[b].refLineExpr),e[b]&&e[b].show&&void 0!==e[b].refLineExpr&&null!==f&&!isNaN(f)&&f>=g&&f<=h)return!0;return!1}function g(){var a,b,c,d;for(a=0;a<this._numAxes;a+=1)if(b=this._axes[a],c=b.getPlotMin(),d=b.getPlotMax(),this._axisPlotMinValues[a]!==c||this._axisPlotMaxValues[a]!==d)return!0;return!1}function h(){var a,b;for(a=0;a<this._numAxes;a+=1)b=this._axes[a],this._axisPlotMinValues[a]=b.getPlotMin(),this._axisPlotMaxValues[a]=b.getPlotMax()}var i=b.get();return a.extend("RefLines",{init:function(){this._super.apply(this,arguments),this.renderer=new c(this.container),this.renderer.edgeBleed={top:1,left:1,right:0,bottom:0},this._$renderAreaWrap.addClass("qv-chart-component-reflines"),this._hasVisibleRefLines=!1,this._numAxes=0,this.renderers={lines:this.renderer}},setData:function(){this._super.apply(this,arguments),this._numRefLinesDataAxes=void 0===this._data?0:this._data.length,this._hasVisibleRefLines=f.call(this),h.call(this)},setAxes:function(a){var b=this;this._axes=a,this._axes.forEach(function(a){a.listen("changed",function(){this.invalidateDisplay()},b)}),this._numAxes=void 0===a?0:a.length,void 0!==this._axisPlotMinValues&&this._axisPlotMinValues.length===this._numAxes||(this._axisPlotMinValues=new Array(this._numAxes)),void 0!==this._axisPlotMaxValues&&this._axisPlotMaxValues.length===this._numAxes||(this._axisPlotMaxValues=new Array(this._numAxes))},isVisible:function(){return!!(this._super.apply(this,arguments)&&this._numAxes&&this._numRefLinesDataAxes)},hasValidData:function(){return this._super()&&this._numRefLinesDataAxes&&this._numAxes},paint:function(){if(this._super.apply(this,[].slice.call(arguments)),g.call(this)&&(this._hasVisibleRefLines=f.call(this),h.call(this)),!this._hasVisibleRefLines)return this.renderer.shapes=[],void this.renderer.clear();var a,b,c,d,i,j,k,l,m,n,o,p,q,r=[];for(a=0;a<this._numRefLinesDataAxes;a+=1)for(c=this._data[a],d=this._axes[a],i=this._axisPlotMinValues[a],j=this._axisPlotMaxValues[a],b=0;b<c.length;b+=1)c[b].show&&void 0!==c[b].refLineExpr&&(null===(k=this._currentProperties["value"+a+b])||isNaN(k)||k>j||k<i||(l=d.getPositionOfValue(k),l=Math.floor(l)-.5,d.isVertical()?(m=0,n=l,o=this.rect.width,p=l):(m=l,n=0,o=l,p=this.rect.height),q=void 0!==c[b].color?e(c[b].color):"#333",r.push({type:"line",stroke:q,strokeWidth:1,shape:{x1:m,y1:n,x2:o,y2:p}})));this.renderer.shapes=r,this.renderer.render()},_updateProperties:function(){if(this._data){var a,b,c=this._data,d=c.length;for(a=0;a<d;a++)if(void 0!==c[a])for(b=0;b<c[a].length;b++)this._transitionProperties["value"+a+b]=c[a][b].refLineExpr.value;this._super()}}})}),define("objects.views/charts/components/data-title/data-title-handler",["core.models/generic-object","objects.views/charts/renderers/canvas-renderer","core.utils/deferred"],function(a,b,c){function d(a,b,c){var d,e,f,g=[],h="dimension"===b?a.qDimensionInfo:a.qMeasureInfo,i=!1;if(b){for(f=0;f<h.length;f++)d=h[f],i=d.qGroupFallbackTitles&&d.qGroupFallbackTitles.length>1,e=i?d.qGroupFallbackTitles.slice(0,d.qGroupPos+1):[d.qFallbackTitle],g.push({labels:e,label:e[e.length-1],locked:d.qLocked&&c,isDrill:i&&c,currentDrillDownLevels:d.qGroupPos,wrapperStyle:{},index:f});return g}}function e(b,d){if(!b||!b.getProperties)return c.resolve();var e="dimension"===d?"qDimensions":"qMeasures";return b.getProperties().then(function(b){return b.qExtendsId?a.get(b.qExtendsId).then(function(a){return a.getProperties()}):b}).then(function(a){return i.hasAlternatives(a.qHyperCubeDef&&a.qHyperCubeDef.qLayoutExclude,e)})}function f(a,b){return a&&a.qHyperCubeDef&&a.qHyperCubeDef[b].length>0}function g(a,b,c,d){if(b.width()){"top-to-bottom"===c||"bottom-to-top"===c?(a.width=b.height(),a.height=b.width(),"top-to-bottom"===c?(a.marginTop=-a.width+a.height,a.marginLeft=a.height):(a.marginTop=a.width+a.height,a.marginLeft=0)):(a.width=b.width(),a.height=b.height(),a.marginLeft=0,a.marginTop=0);var e=d?d.map(function(a){return a.label}):[];i.getTitlesApproxWidth(e,a.font)>a.width?(a.justifyContent="flex-start",a.minWidth=70):(a.justifyContent="center",a.minWidth="auto")}}function h(a,c){var d=0;return a.forEach(function(a){"string"==typeof a&&(d+=b.getTextWidth(a,c))}),d||null}var i={hasAlternatives:f,getTitlesApproxWidth:h};return{getTitleDataFromHyperCube:d,modelHasAlternatives:e,setWrapperStyle:g,getTitlesApproxWidth:h,hasAlternatives:f}}),define("text!objects.views/charts/components/data-title/data-title.ng.html",[],function(){return'<div ng-show="visible"\n     class="qva-chart-data-title">\n     <div class="qva-chart-data-title-rotate" ng-style="fontStyle" ng-class="direction" qva-direction x-dir-setting="{{options.direction}}">\n          <div class="qva-chart-data-title-align ellips-text">\n               <div class="qva-chart-data-title-wrapper ellips-text" ng-repeat-start="titleData in titles" ng-style="titleData.wrapperStyle" >\n                    <qva-breadcrumb-bar ng-if="titleData.isDrill" data="titleData" model="model" disabled="disabled || object.selectionsApi.active" type="type" dock="dock" column-index="$index" options="options"></qva-breadcrumb-bar>\n                    <qva-default-data-title ng-if="!titleData.isDrill" data="titleData" model="model" disabled="disabled || object.selectionsApi.active" type="type" dock="dock" options="options"></qva-default-data-title>\n               </div>\n               <span ng-repeat-end ng-if="!$last">, &nbsp;</span>\n          </div>\n\n     </div>\n</div>\n'}),define("text!objects.views/charts/components/data-title/default-data-title.ng.html",[],function(){return'<div class="default-data-title-wrapper ellips-text">\n     <qva-simple-data-title ng-if="!data.hasAlternatives" label="data.label" locked="data.locked" options="options"></qva-simple-data-title>\n     <qva-dropdown-data-title ng-if="data.hasAlternatives" data="data" model="model" disabled="disabled" type="type" dock="dock" options="options"></qva-dropdown-data-title>\n</div>'}),define("text!objects.views/charts/components/data-title/simple-data-title.ng.html",[],function(){return'<div class="chart-data-title ellips-text" qva-direction x-dir-text="{{label}}" x-dir-setting="{{options.direction}}" >\n     <i ng-if="locked" class="icon-toolbar-locked" title="{{lockedTooltip}}"></i>\n     <span class="chart-data-title-label" title="{{label}}" qva-direction x-dir-text="{{label}}" x-dir-setting="{{options.direction}}">{{label}}</span>\n</div>'}),define("text!objects.views/charts/components/data-title/dropdown-data-title/dropdown-data-title.ng.html",[],function(){return'<div class="qva-dropdown-data-title">\n     <div class="dropdown-data-title-wrapper" ng-class="{\'interactive\' : !disabled, \'active\': isMenuOpen}" qva-activate="openAlternativePopover()" qva-outside-ignore-for="{{\'dataTitle-\' + $id}}">\n          <qva-simple-data-title locked="data.locked" label="data.label" options="options"></qva-simple-data-title>\n          <span class="dropdown-arrow"></span>\n     </div>\n</div>'}),define("text!objects.views/charts/components/data-title/dropdown-data-title/dropdown-data-title-popover.ng.html",[],function(){return'<lui-popover class="qva-alternative-data-picker"\n\t\t\t\t\t  align-to="alignTo"\n\t\t\t\t\t  position="position"\n\t\t\t\t\t  collision="\'flip fit\'"\n\t\t\t\t\t  height="\'auto\'"\n\t\t\t\t\t  on-close-view="closePopover();"\n\t\t\t\t\t  qva-outside-ignore-for="{{qvaOutsideIgnoreFor}}">\n\t<div class="em-section-content em-alternative-data qva-alternative-data-picker-list" qva-direction x-dir-setting="{{options.direction}}">\n\t\t<div hypercube-data-item ng-repeat="alternative in item.alternatives" item="item"></div>\n\t</div>\n</lui-popover>\n'}),define("client.utils/default-property-logic",["client.utils/theme/theme-module","core.utils/feature-flags","client.utils/property-resolver","client.utils/property-hypercube-helper","general.utils/attribute-expression-util","client.utils/base-color-support"],function(a,b,c,d,e,f){function g(a){return c.getValue(a,"color.reverseScheme")!==!0}function h(a){return"byExpression"===c.getValue(a,"color.mode")&&c.getValue(a,"color.expressionIsColor")===!1}function i(a){return"byExpression"===c.getValue(a,"color.mode")&&c.getValue(a,"color.expressionIsColor")===!0}function j(a){var b=d.getDimensionLayouts(a)[0];return b&&b.qCardinal>p}function k(){var a=[];return q.dataPalettes.forEach(function(b){if("true"!==b.disabled){var c={type:"classes",component:"color-scale",translation:b.translation||b.name,value:b.propertyValue};"pyramid"===b.type?c.colors=b.scale[b.scale.length-1]:c.colors=b.scale,a.push(c)}}),a}function l(){var a=[];return q.scales.forEach(function(b){if(!b.disabled){var c={component:"color-scale",reverse:this.helpers.schemeIsReverse,translation:b.translation||b.name,value:b.propertyValue};"class-pyramid"===b.type?(c.colors=b.scale[b.scale.length-1],c.type="classes"):(c.colors=b.scale,c.type="gradient"),a.push(c)}},this),a}function m(a){return c.getValue(a,"layout.qHyperCube.qMeasureInfo",[]).filter(function(a){return!(!a.baseColor||!a.baseColor.color)}).length>0}function n(a){var b=c.getValue(a,"layout.layers",!1);return b?b.filter(function(a){return c.getValue(a,"qHyperCube.qDimensionInfo",[]).filter(function(a){return!(!a.baseColor||!a.baseColor.color)}).length>0}).length>0:c.getValue(a,"layout.qHyperCube.qDimensionInfo",[]).filter(function(a){return!(!a.baseColor||!a.baseColor.color)}).length>0}function o(a,b){return(w[a]||r)[b]||r[b]}var p=1e3,q=a.get(),r={showLegend:function(a){var b=c.getValue(a,"color.auto"),e=c.getValue(a,"color.mode"),f=c.getValue(a,"color.expressionIsColor"),g=d.getNumDimensions(a),h=d.getNumMeasures(a);return b&&(g>1||h>1)||!b&&"primary"!==e&&("byExpression"!==e||!f)},colorModeOptions:{primary:function(){return!0},dimension:function(a){return d.getNumMeasures(a)<=1},multiColor:function(a){return d.getNumMeasures(a)>1},measure:function(){return!0},expression:function(a){return d.getNumMeasures(a)>=1}},persistentColorsShow:function(a){return!c.getValue(a,"color.auto")&&"byDimension"===c.getValue(a,"color.mode")&&d.getNumMeasures(a)<=1},expressionLabelChange:function(a){var b=c.getValue(a,"qHyperCubeDef.qMeasures.0.qAttributeExpressions.0"),d=c.getValue(a,"color");b&&(b.label=c.getValue(a,"color.expressionLabel"),d&&(d.colorExpression=b.qExpression))},attributeExpressionChange:function(a){var b=c.getValue(a,"qHyperCubeDef.qMeasures.0.qAttributeExpressions.0"),d=c.getValue(a,"color");b&&(b.id="colorByExpression",d&&(d.colorExpression=b.qExpression))},attributeExpressionGlobalChange:function(a){var b,d,e,f=c.getValue(a,"qHyperCubeDef.qMeasures",[]),g=c.getValue(a,"qHyperCubeDef.qLayoutExclude.qHyperCubeDef.qMeasures",[]),h=null,i=function(a,b){"colorByExpression"===a.id&&(d=b)};if(f.length+g.length>1){for(b=g.length-1;b>=0;--b)e=g[b].qAttributeExpressions||[],d=-1,e.every(i),d>=0&&(h=e.splice(d,1)[0]);for(b=f.length-1;b>=0;--b)e=f[b].qAttributeExpressions||[],d=-1,e.every(i),d>=0&&(h=e.splice(d,1)[0]);f.length&&(!f[0].qAttributeExpressions&&h&&(f[0].qAttributeExpressions=[]),h&&f[0].qAttributeExpressions.splice(0,0,h))}var j=c.getValue(a,"color.colorExpression");1!==f.length||f[0].qAttributeExpressions&&0!==f[0].qAttributeExpressions.length||!j||(f[0].qAttributeExpressions=[{qExpression:j,id:"colorByExpression"}])},colorByGlobalChange:function(a,b,d){var f,g,h,i=c.getValue(a,"color.mode"),j=c.getValue(a,"color.auto"),k=c.getValue(a,d+"qDimensions",[]),l=c.getValue(a,d+"qMeasures",[]),m=c.getValue(a,d+"qLayoutExclude.qHyperCubeDef.qDimensions",[]);if(!j&&"byDimension"===i&&k.length){if(!(f=c.getValue(a,"color.byDimDef"))||!f.key){g=k[k.length-1];var n=d.split(".");if(2===k.length&&"map"===c.getValue(a,"visualization")&&"point"===a.layers[Number(n[1])].type&&(g=k[0]),h=e.getById(g.qAttributeDimensions,e.IDMAP.COLOR_BY_ALTERNATIVE))return void(h.qLibraryId?b.setColorByDef({type:"dimension",name:h.qLibraryId,id:h.qLibraryId}):b.setColorByDef({type:"field",name:h.label||h.qDef,id:h.qDef}));g.qLibraryId?b.setColorByDef({type:"dimension",name:g.qLibraryId,id:g.qLibraryId}):b.setColorByDef({type:"field",name:g.qDef.qFieldDefs[0],label:""!==g.qDef.qFieldLabels[0]?g.qDef.qFieldLabels[0]:g.qDef.qFieldDefs[0]})}b.setColorByItem(!0,k,m,c.getValue(a,"color.byDimDef.label"))}else if(!j&&"byMeasure"===i&&k.length){if((!(f=c.getValue(a,"color.byMeasureDef"))||!f.key)&&l.length){var o=l[0];if(g=k[k.length-1],h=e.getById(g.qAttributeExpressions,e.IDMAP.COLOR_BY_ALTERNATIVE))return void(h.qLibraryId?b.setColorByDef({type:"measure",name:h.qLibraryId,id:h.qLibraryId}):b.setColorByDef({type:"expression",name:h.label||h.qExpression,id:h.qExpression}));o.qLibraryId?b.setColorByDef({type:"measure",name:o.qLibraryId,id:o.qLibraryId}):b.setColorByDef({type:"expression",name:o.qDef.qDef,label:o.qDef.qLabel||o.qDef.qDef})}b.setColorByItem(!1,k,m,c.getValue(a,"color.byMeasureDef.label"),l)}else"byMultiple"===i&&l.length<2&&c.setValue(a,"color.mode","primary"),b.clearColorByItem(k,m)}},s={showLegend:function(a){var b=c.getValue(a,"color.auto"),d=c.getValue(a,"color.expressionIsColor"),e=c.getValue(a,"color.mode");return!(!b&&"primary"===e||!b&&"byExpression"===e&&(d||void 0===d))}},t={colorModeOptions:{primary:function(){return!0},dimension:function(){return!0},multiColor:function(){return!1},measure:function(){return!0},expression:function(a){return d.getNumMeasures(a)>=1}},showLegend:function(a){return"primary"!==c.getValue(a,"color.mode")&&!c.getValue(a,"color.auto")},persistentColorsShow:function(a){return!c.getValue(a,"color.auto")&&"byDimension"===c.getValue(a,"color.mode")}},u={colorModeOptions:{primary:function(){return!0},dimension:function(a){return d.getNumDimensions(a)>1},multiColor:function(a){return d.getNumMeasures(a)>1},measure:function(a){return d.getNumDimensions(a)<=1},expression:function(a){return d.getNumMeasures(a)>=1}}},v={colorModeOptions:{primary:function(){return!0},dimension:function(a){return d.getNumDimensions(a)>=1},multiColor:function(a){return d.getNumMeasures(a)>1},measure:function(a){return d.getNumDimensions(a)>=1},expression:function(a){return d.getNumDimensions(a)>=1}}},w={scatterplot:t,piechart:s,linechart:u,map:v},x=function(a,e){var p=o(e,"colorModeOptions"),r=o(e,"persistentColorsShow"),s=o(e,"expressionLabelChange"),t=o(e,"attributeExpressionChange"),u=o(e,"attributeExpressionGlobalChange"),v=o(e,"colorByGlobalChange");this.helpers={schemeIsReverse:g,showCompressionResolution:j,colorModeOptions:p,getMeasureSchemeOptions:l.bind(this),getDimensionSchemeOptions:k},this.color={colorMode:{options:function(b){var c=[];return"explore"===a&&c.push({value:"auto",translation:"Common.Auto"}),p.primary(b)&&c.push({value:"primary",translation:"properties.colorMode.primary"}),p.multiColor(b)&&c.push({value:"byMultiple",translation:"properties.colorMode.multicolored"}),p.dimension(b)&&c.push({value:"byDimension",translation:"properties.colorMode.byDimension"}),p.measure(b)&&c.push({value:"byMeasure",translation:"properties.colorMode.byMeasure"}),p.expression(b)&&"explore"!==a&&c.push({value:"byExpression",translation:"properties.colorMode.byExpression"}),c},show:function(a){return!c.getValue(a,"color.auto")}},singleColor:{show:function(){return!1}},paletteColor:{show:function(a,d){if(!c.getValue(a,"color.paletteColor")){var e=q.resolveColor(c.getValue(a,"color.singleColor")),g={index:-1,color:e};c.setValue(a,"color.paletteColor",g)}return!c.getValue(a,"color.auto")&&"primary"===c.getValue(a,"color.mode")&&!(b.MASTER_MEASURE_COLOR&&f.isSupported(a.visualization)&&m(d)&&"measure"===c.getValue(a,"color.useBaseColors")||n(d)&&"dimension"===c.getValue(a,"color.useBaseColors"))},change:function(a){var b=c.getValue(a,"color.paletteColor");c.setValue(a,"color.singleColor",q.mapIndex(b.index,!0))},defaultValue:function(){var a=q.dataColors.primaryColor,b=q.currentPalette.indexOf(a);return{index:b===-1?Math.min(6,q.currentPalette.length-1):b}}},colorBy:{globalChange:v,dimension:{show:function(a){return!c.getValue(a,"color.auto")&&"byDimension"===c.getValue(a,"color.mode")}},measure:{show:function(a){return!c.getValue(a,"color.auto")&&"byMeasure"===c.getValue(a,"color.mode")}},label:{show:function(a){return!c.getValue(a,"color.auto")&&("byDimension"===c.getValue(a,"color.mode")&&"libraryItem"!==c.getValue(a,"color.byDimDef.type")||"byMeasure"===c.getValue(a,"color.mode")&&"libraryItem"!==c.getValue(a,"color.byMeasureDef.type"))}}},baseColor:{show:function(a,d){var e=c.getValue(a,"color.mode");return b.MASTER_MEASURE_COLOR&&!c.getValue(a,"color.auto")&&("byMultiple"===e||"primary"===e)&&(m(d)&&f.isSupported(a.visualization)||b.DIM_COLOR&&n(d))},showColors:function(a,d){return b.MASTER_MEASURE_COLOR&&!c.getValue(a,"color.auto")&&"byMultiple"===c.getValue(a,"color.mode")&&"measure"===c.getValue(a,"color.useBaseColors")&&f.isSupported(a.visualization)&&d.layout.qHyperCube.qMeasureInfo.length>1&&m(d)},hasMeasureColor:function(a){return m(a)},hasDimensionColor:function(a){return n(a)},isSupported:function(a){return f.isSupported(a)}},persistentColors:{show:r,readOnly:function(a){return c.getValue(a,"qHyperCubeDef.qDimensions.length")>1}},attributeExpression:{change:t,globalChange:u,show:function(a){return!c.getValue(a,"color.auto")&&"byExpression"===c.getValue(a,"color.mode")&&d.getNumMeasures(a)>0}},expressionIsColor:{show:function(a){return!c.getValue(a,"color.auto")&&"byExpression"===c.getValue(a,"color.mode")&&d.getNumMeasures(a)>0}},expressionLabel:{change:s,show:function(a){return!c.getValue(a,"color.auto")&&h(a)&&d.getNumMeasures(a)>0}},colorSchemeMeasure:{show:function(a){return!c.getValue(a,"color.auto")&&("byMeasure"===c.getValue(a,"color.mode")||h(a))}},reverseScheme:{show:function(a){return!c.getValue(a,"color.auto")&&("byMeasure"===c.getValue(a,"color.mode")||h(a))}},colorSchemeDimension:{show:function(a,d){return!(c.getValue(a,"color.auto")||"byDimension"!==c.getValue(a,"color.mode")&&"byMultiple"!==c.getValue(a,"color.mode")||b.MASTER_MEASURE_COLOR&&"measure"===c.getValue(a,"color.useBaseColors")&&f.isSupported(a.visualization)&&m(d)&&("byMultiple"===c.getValue(a,"color.mode")||c.getValue(a,"color.auto")&&d.layout.qHyperCube.qMeasureInfo.length>1))}},customRange:{show:function(a){return!c.getValue(a,"color.auto")},autoMinMax:{show:function(a){return"byMeasure"===c.getValue(a,"color.mode")||h(a)}},min:{show:function(a){return("byMeasure"===c.getValue(a,"color.mode")||h(a))&&c.getValue(a,"color.autoMinMax")===!1},invalid:function(a){return"minMax"===c.getValue(a,"color.minMax")&&c.getValue(a,"color.measureMin")>=c.getValue(a,"color.measureMax")}},max:{show:function(a){return("byMeasure"===c.getValue(a,"color.mode")||h(a))&&c.getValue(a,"color.autoMinMax")===!1},invalid:function(a){return"minMax"===c.getValue(a,"color.minMax")&&c.getValue(a,"color.measureMin")>=c.getValue(a,"color.measureMax")}}}};var w=o(e,"showLegend");this.legend={show:w,showTitle:{show:function(a){return c.getValue(a,"legend.show")&&w(a)&&!i(a)}},dock:{show:function(a){return c.getValue(a,"legend.show")&&w(a)}}}};return{getLogicFor:function(a,b){return new x(a,b)}}}),define("client.soft-property-panel/default-explore-properties",["client.utils/property-resolver","client.utils/default-property-logic","client.utils/property-hypercube-helper"],function(a,b,c){var d,e,f,g,h=b.getLogicFor("explore","default");return g={translation:"properties.data",type:"items",component:"hypercube-data",icon:"database",items:{dimensions:{ref:"qHyperCubeDef.qDimensions",alternativeRef:"qHyperCubeDef.qLayoutExclude.qHyperCubeDef.qDimensions",type:"items"},measures:{ref:"qHyperCubeDef.qMeasures",alternativeRef:"qHyperCubeDef.qLayoutExclude.qHyperCubeDef.qMeasures",type:"items"}}},d={translation:"properties.sorting",type:"items",component:"sort",sortIndexRef:"qHyperCubeDef.qInterColumnSortOrder",icon:"ascending",items:{dimensions:{ref:"qHyperCubeDef.qDimensions",type:"items",items:{sortOptions:{component:"radio-list",type:"number",diffs:["qDef.qSortCriterias.0.qSortByExpression","qDef.qSortCriterias.0.qSortByNumeric","qDef.qSortCriterias.0.qSortByAscii"],options:function(){return[{value:1,translation:"properties.sorting.ascending"},{value:-1,translation:"properties.sorting.descending"}]},setPropertyValue:function(b,c){a.setValue(b,"qDef.qSortCriterias.0.qSortByExpression",0),a.setValue(b,"qDef.qSortCriterias.0.qSortByNumeric",0),a.setValue(b,"qDef.qSortCriterias.0.qSortByAscii",c)},getValue:function(b){return 0===a.getValue(b,"qDef.qSortCriterias.0.qSortByExpression",0)&&0===a.getValue(b,"qDef.qSortCriterias.0.qSortByNumeric",0)?a.getValue(b,"qDef.qSortCriterias.0.qSortByAscii",0):0}}}},measures:{ref:"qHyperCubeDef.qMeasures",type:"items",items:{sortOptions:{component:"radio-list",type:"number",ref:"qSortBy.qSortByNumeric",options:function(){return[{value:1,translation:"properties.sorting.ascending"},{value:-1,translation:"properties.sorting.descending"}]}}}}}},e={component:"items",translation:"properties.colorsAndLegend",icon:"palette",grouped:!0,items:{mode:{component:"radio-list",type:"string",options:h.color.colorMode.options,diffs:["color.mode","color.auto"],setPropertyValue:function(a,b){"auto"===b?a.color.auto=!0:(a.color.auto=!1,a.color.mode=b)},getValue:function(a){return a.color.auto?"auto":a.color.mode}},dimension:{type:"items",show:function(a){return!a.color.auto&&"byDimension"===a.color.mode},items:{colorScheme:{translation:"properties.colorScheme",type:"string",component:"item-selection-list",horizontal:!0,showLabels:!1,ref:"color.dimensionScheme",items:h.helpers.getDimensionSchemeOptions,show:function(a,b){if(1===c.getNumDimensions(a)&&c.getNumMeasures(a)<=1){var d=c.getDimensionLayouts(b)[0];return!(d&&d.qCardinal<=12)}return c.getNumMeasures(a)<=1||c.getNumMeasures(a)>12}},
dimensionId:{ref:"color.dimensionId",type:"string",component:"dimension-radio-list",translation:"properties.colorDimensionId",show:!1},persistentColors:{ref:"color.persistent",translation:"properties.colorPersistence",type:"boolean",show:function(a){return c.getNumMeasures(a)<=1&&c.getNumDimensions(a)<=1},readOnly:h.color.persistentColors.readOnly}}},measure:{type:"items",show:function(a){return!a.color.auto&&"byMeasure"===a.color.mode},items:{sequential:{component:"item-selection-list",translation:"properties.colorScheme",horizontal:!0,showLabels:!1,type:"string",ref:"color.measureScheme",items:h.helpers.getMeasureSchemeOptions}}},legend:{ref:"legend.show",type:"boolean",translation:"properties.legend.show",component:"switch",options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],show:function(a,b){return!a.color.auto&&h.legend.show(a,b)}}}},f={translation:"properties.presentation",type:"items",icon:"view",grouped:!0,items:{}},{data:g,sort:d,color:e,colorsAndLegend:void 0,presentation:f}}),define("assets/client/soft-property-panel/soft-property-handler",["core.utils/class","util","core.utils/json-patch","core.utils/deferred"],function(a,b,c,d){return a.extend({init:function(a){this._model=a},setModel:function(a){this._model=a},saveSoftProperties:function(a,e){if(!this._model)return d.resolve(!1);var f=c.generate(a,e);return b.extend(!0,a,e),f&&f.length?(f=f.map(function(a){return{qOp:a.op,qValue:JSON.stringify(a.value),qPath:a.path}}),this._model.applyPatches(f,!0).then(function(){return!0})):d.resolve(!1)},mergeSoftPatches:function(){if(!this._model)return d.resolve();var a=this;return d.all({properties:this._model.getProperties(),effective:this._model.getEffectiveProperties()}).then(function(b){if(!b.properties.qExtendsId){var d=c.generate(b.properties,b.effective);c.apply(b.properties,d),a._model.setProperties(b.properties).then(function(){a._model.clearSoftPatches()})}})}})}),define("text!client.soft-property-panel/components/hypercube-data/hypercube-data-item.ng.html",[],function(){return'<li class="em-item lui-list__item" qva-activate="alternativeItemClicked($event,item,alternative);">\n\t<i ng-if="alternative.hasIcon" class="em-item-icon lui-icon icon-tick lui-list__aside" ng-class="{\'em-invisible\': !alternative.selected}"></i>\n\t<span class="lui-list__text lui-list__text--ellipsis" qva-direction x-dir-text="{{alternative.title()}}"  title="{{alternative.title()}}">{{alternative.title()}}&nbsp;</span>\n</li>'}),define("client.soft-property-panel/components/hypercube-data/hypercube-data-handler",["qvangular","core.utils/class","client.utils/property-resolver","client.utils/property-hypercube-helper","objects.utils/data-properties/library-utils","general.utils/attribute-expression-util","translator","text!./hypercube-data-item.ng.html"],function(a,b,c,d,e,f,g,h){return a.directive("hypercubeDataItem",function(){return{restrict:"A",template:h,replace:!0}}),b.extend({init:function(a,b,c){this._props=a,this._app=b,this._hyperCubePath=c,this.libraryTitles={}},setProperties:function(a){this._props=a},updateAlternativeItem:function(a,b,d,e,g){var h=c.getValue(this._props,e,[]),i=c.getValue(this._props,d,[]),j=h[b.index];if(!b.selected){b.original&&(j=c.getValue(this._props,d,[])[b.index]),j.qAttributeExpressions=f.moveById(a.data.qAttributeExpressions,j.qAttributeExpressions,f.IDMAP.COLOR_BY_EXPRESSION),j.qAttributeExpressions=f.moveById(a.data.qAttributeExpressions,j.qAttributeExpressions,f.IDMAP.COLOR_BY_ALTERNATIVE),j.qAttributeDimensions=f.moveById(a.data.qAttributeDimensions,j.qAttributeDimensions,f.IDMAP.COLOR_BY_ALTERNATIVE);var k,l,m,n;if(g)for(k=0;k<g.length;k++)n=g[k],l=c.getValue(i[a.index],n.path,[]),m=c.getValue(h[b.index],n.path,[]),l&&l.hasOwnProperty(n.property)&&m&&m.hasOwnProperty(n.property)&&(m[n.property]=l[n.property]);h.splice(b.index,1,i[a.index]),i.splice(a.index,1,j)}},getDimensionOptions:function(a,b,c,e,f){var g=this;return a.concat(b).filter(function(a){return a.qDef.cId===c.qDef.cId||!d.getDimensionLayout(a.qDef.cId,e,g._hyperCubePath)}).map(function(d){return{id:d.qDef.cId,index:a.indexOf(d)!==-1?a.indexOf(d):b.indexOf(d),original:a.indexOf(d)!==-1,ref:"dimensions",selected:d.qDef.cId===c.qDef.cId,hasIcon:f,title:function(){return g.getTitle(d,!0)}}})},getMeasureOptions:function(a,b,c,e,f){var g=this;return a.concat(b).filter(function(a){return a.qDef.cId===c.qDef.cId||!d.getMeasureLayout(a.qDef.cId,e,g._hyperCubePath)}).map(function(d){return{id:d.qDef.cId,index:a.indexOf(d)!==-1?a.indexOf(d):b.indexOf(d),original:a.indexOf(d)!==-1,ref:"measures",selected:d.qDef.cId===c.qDef.cId,hasIcon:f,title:function(){return g.getTitle(d,!1)}}})},getTitle:function(a,b){var c=a.qLibraryId,d=this,f=g.get(b?"Object.ErrorMessage.MissingDimension":"Object.ErrorMessage.MissingMeasure");return c?void 0!==this.libraryTitles[c]?null===this.libraryTitles[c]?f:"string"!=typeof this.libraryTitles[c]?"":this.libraryTitles[c]:(this.libraryTitles[c]=function(){return b?d._app.getDimensionList().then(function(a){return e.findLibraryDimension(c,a)}):d._app.getMeasureList().then(function(a){return e.findLibraryMeasure(c,a)})}().then(function(a){return a?(d.libraryTitles[c]=a.qData.title,d.libraryTitles[c]):(d.libraryTitles[c]=null,f)}),this.libraryTitles[c]):b?a.qDef.qFieldLabels[0]||a.qDef.qFieldDefs[0]:a.qDef.qLabel||a.qDef.qDef}})}),define("client.property-panel/component-utils",["qvangular","client.utils/property-resolver","core.utils/deferred","util","translator"],function(a,b,c,d,e){var f={defineValue:function(c,d,e,g){function h(a){var c=b.getValue(e(),d.ref);return void 0===c?void 0!==d.undefinedValue?d.undefinedValue:b.getDefaultValue(a,d):c}function i(c,g,h){var i=b.getTypeValue(c,g,h),j=e();d.rollbackInvalid?f.validateType(i,d,j)?b.setValue(j,d.ref,i):a.getService("$timeout")(function(){a.$rootScope.$broadcast("pp-revalidate")}):b.setValue(j,d.ref,i)}var j,k,l;d.resolveFunctions?"object"==typeof d.resolveFunctions?(k=function(){return d.resolveFunctions.get(h,d,c.args)},l=function(a){return d.resolveFunctions.set(a,i,d)}):(k=function(){return b.resolveFunctions[d.resolveFunctions].get(h,d)},l=function(a){return b.resolveFunctions[d.resolveFunctions].set(a,i,d)}):(k=function(){return h(d.type)},l=function(a){var c=b.getDefaultValue(d.type,d);i(d.type,a,c)}),j=void 0!==g?g:"value",Object.defineProperty(c,j,{get:k,set:l})},defineExpression:function(a,c){var d=a.definition.expression,e=a.definition.expressionType,f="optional"===d||"always"===d,g=c?"qValueExpression":"qStringExpression";!e&&f&&(e=c?"ValueExpression":"StringExpression"),a.expressionType=e,a.isExpressionDefinition=f,Object.defineProperty(a,"displayValue",{get:function(){var b=a.value;return b&&"object"==typeof b&&(b=b[g].qExpr)&&"="!==b[0]&&(b="="+b),b},set:function(b){var c,d=f&&b&&0===b.indexOf("=");b&&d?(c={},c[g]={qExpr:b.substr(1)}):c=b,a.value=c}}),a.isExpression=function(){if("always"===d)return!0;if("optional"===d){return"object"==typeof b.getValue(a.data,a.definition.ref)}return!!e},a.isLocked=function(){if(f){var b=a.value;return"object"==typeof b&&(b=b[g].qExpr),!(!b||c&&"number"==typeof b)&&(b&&(b.indexOf("\n")!==-1||b.length>a.maxlength))}return!1}},defineChange:function(a,b){function c(){a.$emit("saveProperties",a.data)}a.change=function(){if("function"==typeof a.definition.change){var d=a.definition.change(a.data,b,a.args.properties,a.args);"object"==typeof d&&d.then?d.then(function(a){a!==!1&&c()}):d!==!1&&c()}else c()}},defineVisible:function(a,b){var c=a.definition.show;"function"==typeof c?Object.defineProperty(a,"visible",{get:function(){return c(a.data,b,a.args)}}):a.visible="boolean"!=typeof c||c},defineReadOnly:function(a,b){var c=a.definition.readOnly;"function"==typeof c?Object.defineProperty(a,"readOnly",{get:function(){return c(a.data,b,a.args)}}):a.readOnly="boolean"==typeof c&&c},definePlaceholder:function(a,b){b.placeholderTranslation?a.placeholder=e.get(b.placeholderTranslation):b.placeholder&&(a.placeholder=b.placeholder)},defineLabel:function(a,b,c,d){return b.translation?a.label=e.get(b.translation):"function"==typeof b.label?Object.defineProperty(a,"label",{get:function(){return b.label(c(),d)}}):b.label&&(a.label=b.label),""},defineCustom:function(a,b,c){var d=a.definition[c];"function"==typeof d?Object.defineProperty(a,c,{get:function(){return d(a.data,b,a.args)}}):d&&(a[c]=d)},fillOptions:function(a,b,d,f,g){function h(a){return a.map(function(a){var b={value:a.value};return a.translation?b.label=e.get(a.translation):a.label?b.label=a.label:b.label=a.value,a.tooltipTranslation?b.tooltip=e.get(a.tooltipTranslation):a.tooltip&&(b.tooltip=a.tooltip),b})}var i=new c;return function(){var e=a.options;return"function"==typeof e&&(e=a.options.call(null,b,d,g)),"object"==typeof e&&"function"==typeof e.then?e:c.resolve(e)}().then(function(a){a=h(a),f.splice(0,f.length);for(var b=0;b<a.length;++b)f.push(a[b]);i.resolve()},i.reject),i.promise},validateType:function(a,b,c,e){var f=!1;return"boolean"==typeof b.invalid&&(f=f||b.invalid),"function"==typeof b.invalid&&(f=f||b.invalid.call(null,c,e.properties,e)),"number"===b.type&&(d.isNumeric(a)?("number"==typeof b.max&&a>b.max&&(f=!0),"number"==typeof b.min&&a<b.min&&(f=!0)):f=!0),"integer"===b.type&&(d.isInteger(a)?("number"==typeof b.max&&a>b.max&&(f=!0),"number"==typeof b.min&&a<b.min&&(f=!0)):f=!0),"string"===b.type&&(void 0!==b.maxlength&&(f=f||a.length>b.maxlength),void 0!==b.minlength&&(f=f||a.length<b.minlength)),!f}};return f}),define("general.utils/expression-validator",["core.utils/notification","core.utils/class","core.models/app"],function(a,b,c){var d={Expression:0,NumberOrExpression:1};return{ExpressionValidator:b.extend("ExpressionValidator",{init:function(b,e){this.currentExpr=null,this.nextExpr=null,this.hasOutstandingCall=!1,this.app=b||c.current,this.mode=e||d.Expression,a.create(this,"Update")},onResponse:function(a){var b,c,d,e,f;if(this.hasOutstandingCall=!1,this.nextExpr)b=this.nextExpr,c=this.nextLabels,this.nextExpr=null,this.nextLabels=null,this.callEngine(b,c);else{for(b=this.currentExpr,d=!a.qErrorMsg&&0===a.qBadFieldNames.length,e=0;e<a.qBadFieldNames.length;e++)f=a.qBadFieldNames[e],f.name=b.substr(f.qFrom||0,f.qCount);this.Update.emit({valid:d,data:{error:a.qErrorMsg,bad:a.qBadFieldNames}})}},callEngine:function(a,b){var c=this;if(this.hasOutstandingCall)throw new Error("Invalid state");this.currentExpr=a,this.hasOutstandingCall=!0;var e;e=this.mode===d.NumberOrExpression?this.app.checkNumberOrExpression(a):this.app.checkExpression(a,b),e.then(function(a){c.onResponse(a)},function(){c.onResponse({qErrorMsg:"Error",qBadFieldNames:[]})})},validate:function(a,b){this.hasOutstandingCall?(this.nextExpr=a,this.nextLabels=b):this.callEngine(a,b)}}),Modes:d}}),define("text!general.components/info-popover/info-popover.ng.html",[],function(){return'<immidiate-contextual align-to="alignTo" position="position" collision="fit" on-close-view="closeView()" qv-dialog-escape="closeView()">\n\t<span class="info-popover-message" ng:show="translationKey" q-translation="{{translationKey}}"></span>\n\t<span class="info-popover-message" ng:show="text">{{text}}</span>\n</immidiate-contextual>\n'}),define("general.components/info-popover/info-popover",["text!./info-popover.ng.html"],function(a){return{scope:{translationKey:"=",text:"=",alignTo:"=",position:"="},template:a,controller:["$scope",function(a){a.closeView=function(){a.destroyComponent(),a.onClose()}}]}}),define("general.services/show-service/show-service",["jquery","assets/qvangular/qvangular-core","core.utils/deferred"],function(a,b,c){"use strict";function d(){if(!j){var b=a("<div id='show-service-popup-dialog'></div>");a("body").append(b),b.showComponent(l,{views:k}),j=!0}}function e(a,b){function e(){var a=k.indexOf(g);a>=0&&k.splice(a,1)}d();var f=new c,g={component:a,input:b,deferredResult:f,exposedApi:{destroy:e,resultPromise:f.promise}};return k.push(g),g.exposedApi}function f(c,d){var e={$element:a("body"),input:d};for(var f in d)d.hasOwnProperty(f)&&(e[f]=d[f]);return b.$injector.invoke(c,{},e)}function g(a,b){return"function"==typeof a||Array.isArray(a)?f(a,b):e(a,b)}function h(){return k.length>0}function i(){k.forEach(function(a){a.exposedApi.destroy()})}var j,k=[];b.componentDirective("qvShowServiceView",{destroyComponent:"&",input:"=",deferredResult:"=",exposedApi:"="});var l={template:"<div><div ng-repeat='view in views' qv-show-service-view component='view.component' data-input='view.input' data-deferred-result='view.deferredResult' destroy-component='unshow(view)' data-exposed-api='view.exposedApi'></div></div>",controller:["$scope",function(a){a.unshow=function(b){var c=a.views.indexOf(b);c>=0&&a.views.splice(c,1)}}]};return{show:g,isViewShowing:h,closeAll:i}}),define("text!assets/client/dialogs/expression-dialog/expression-dialog.ng.html",[],function(){return'<qv-modal-dialog qv-id="expression-editor-dialog" qv-cancel="cancel()" qv-confirm="confirm()">\n\t<div id="expression-editor-wrapper">\n\t\t<section id="expression-editor-content">\n\t\t\t<h1 class="dm-header" q-translation="{{input.title}}"></h1>\n\t\t\t<main class="dm-main">\n\n\t\t\t\t<div id="expression-editor-container">\n\t\t\t\t\t<div qv-extract="resizeCounter" id="expression-editor-stage" data-help="Panel.Stage" ng-class="{ invalid: !validity.expression }">\n\t\t\t\t\t\t<qv-codearea\n\t\t\t\t\t\t\t\tdata-show-breakpoint-gutter="false"\n\t\t\t\t\t\t\t\tdata-disabled="false"\n\t\t\t\t\t\t\t\tdata-resize-trigger="resizeCounter"\n\t\t\t\t\t\t\t\tdata-mode="qlikviewReloadScriptMode"\n\t\t\t\t\t\t\t\tqv-codearea-code-container="codearea"\n\t\t\t\t\t\t\t\tqv-codearea-exposed-context-api="codearea.contextApi"\n\t\t\t\t\t\t\t\tqv-codearea-function-tip="functionTipOptions"\n\t\t\t\t\t\t\t\tqv-codearea-limit="stringLimits.expression"\n\t\t\t\t\t\t\t\tqv-codearea-autocomplete="autocompleteOptions"\n\t\t\t\t\t\t\t\tqv-codearea-help-mode="false"\n\t\t\t\t\t\t\t\tqv-codearea-help-mode-options="helpModeOptions"\n\t\t\t\t\t\t\t></qv-codearea>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div id="expression-editor-status" ng-class="info.status" >\n\t\t\t\t\t<i ng-class="{ disabled: !info.extraErrorMsg }"\n\t\t\t\t\t\tclass="icon-info"\n\t\t\t\t\t\tqva-activate="showErrorMessage( info.extraErrorMsg, $event )"></i>\n\t\t\t\t\t<span translate="info.errorMsg" ng-show="info.errorMsg"></span>\n\t\t\t\t</div>\n\n\t\t\t</main>\n\t\t</section>\n\t\t<section id="expression-editor-panel" class="qribby-accordion-pp">\n\t\t\t<section class="qribby-accordion-section">\n\t\t\t\t<header class="qribby-accordion-section-header">\n\t\t\t\t\t<h1 q-translation="Common.Fields"></h1>\n\t\t\t\t</header>\n\t\t\t\t<div class="qribby-accordion-section-content">\n\n\t\t\t\t\t<div id="expression-editor-toolbar-table">\n\t\t\t\t\t\t<label q-translation="Assets.FieldsTab.Table"></label>\n\t\t\t\t\t\t<lui-select\n\t\t\t\t\t\t\tid="expression-dialog-fields-tab-select-field"\n\t\t\t\t\t\t\tx-model="controller.selectedTable"\n\t\t\t\t\t\t\tx-options="table for table in controller.tableNames">\n\t\t\t\t\t\t</lui-select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div id="expression-editor-toolbar-field">\n\t\t\t\t\t\t<label q-translation="Common.Field"></label>\n\t\t\t\t\t\t<lui-select\n\t\t\t\t\t\t\tid="expression-dialog-functions-common-select-field"\n\t\t\t\t\t\t\tx-model="controller.selectedField"\n\t\t\t\t\t\t\tx-options="field for field in controller.fieldNames">\n\t\t\t\t\t\t</lui-select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div id="expression-editor-toolbar-functions">\n\t\t\t\t\t\t<lui-select id="expression-dialog-fields-tab-select-aggregation" x-model="controller.selectedCommonFunction">\n\t\t\t\t\t\t\t<option q-translation="ExpressionEditor.FieldsTab.SelectAggregationHint" value=""></option>\n\t\t\t\t\t\t\t<option ng-repeat="func in controller.commonFunctions" value="{{func}}">{{func}}</option>\n\t\t\t\t\t\t</lui-select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div id="expression-editor-toolbar-insert">\n\t\t\t\t\t\t<lui-button\n\t\t\t\t\t\t\tng-disabled="!controller.previewText()"\n\t\t\t\t\t\t\ttype="button"\n\t\t\t\t\t\t\tqva-activate="insertTextHandler($event)"\n\t\t\t\t\t\t\tq-title-translation="Tooltip.ExpressionEditor.InsertExpression">\n\t\t\t\t\t\t\t<span q-translation="ExpressionEditor.Insert"></span>\n\t\t\t\t\t\t</lui-button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t</section>\n\t</div>\n\t<qv-confirm-cancel-footer qv-confirm="confirm()" qv-cancel="cancel()" qv-confirm-label="Common.Apply"></qv-confirm-cancel-footer>\n</qv-modal-dialog>\n'}),define("assets/client/dialogs/expression-dialog/expression-dialog-controller",["util"],function(a){"use strict";function b(){return["Sum","Count","Avg","Min","Max"]}function c(){var b;return b=this.selectedField||"",b=a.escapeField(b),this.selectedCommonFunction?this.selectedCommonFunction+"("+b+")":b}function d(a){return a.map(function(a){return a.qName})}function e(a,b){return a.filter(function(a){return a.qSrcTables.indexOf(b)!==-1})}function f(a,b){return a.toLowerCase().localeCompare(b.toLowerCase())}function g(a){var b,c,d=[];for(b=0;b<a.length;++b)for(c=0;c<a[b].qSrcTables.length;++c)d.indexOf(a[b].qSrcTables[c])===-1&&d.push(a[b].qSrcTables[c]);return d.sort(f),d}function h(a,b,c){c!==a.allTablesText&&(b=e(b,c)),a.fieldNames=d(b),i(a)}function i(a){a.fieldNames.indexOf(a.selectedField)===-1&&(a.selectedField=a.fieldNames[0])}function j(a){var e=a.translator,f=a.fields.slice();f.sort(function(a,b){return a.qName.toLowerCase().localeCompare(b.qName.toLowerCase())});var j=e.get("Common.All.Tables"),k={allTablesText:j,commonFunctions:b(),selectedCommonFunction:"",setTableFilter:function(a){h(k,f,a)},selectedTable:j,tableNames:[j].concat(g(f)),fieldNames:d(f),selectedField:"",previewText:c};return i(k),k}return{create:j}}),define("assets/client/dialogs/expression-dialog/expression-validation-info",[],function(){"use strict";function a(a,b){if(a.status=b.valid?e:f,a.errorMsg=b.valid?"Common.OK":"Expression.Validation.InvalidExpression",a.extraErrorMsg="",b.data)if(b.data.bad.length>0){var c=b.data.bad.map(function(a){return a.name});a.errorMsg={id:"Expression.Validation.BadFieldName",value:[c.join(", ")]}}else b.data.error&&(a.extraErrorMsg=b.data.error)}function b(a,b,c,e){""!==c.replace(/\s+/g,"")?(a.status=d,b.validate(c,e)):(a.status=f,a.errorMsg="",a.extraErrorMsg="")}function c(c){var e=c.validator,f={errorMsg:"",extraErrorMsg:"",status:d,setExpr:function(a){b(f,e,a,c.labels)}};return e.Update.bind(function(b){a(f,b)}),f}var d="validating",e="valid",f="invalid";return{create:c}}),define("general.utils/string-limits",[],function(){"use strict";var a={};return Object.defineProperties(a,{name:{value:255,writable:!1},description:{value:512,writable:!1},expression:{value:8192,writable:!1},script:{value:5e4,writable:!1},textImage:{value:12e3,writable:!1}}),a}),define("client.services/validation",[],function(){function a(a){return a.replace(/^=+/,"")}function b(a,b){return a.validity.name=!!a.name&&!!a.name.trim()&&a.name.length<=b.name,a.description?a.validity.description=a.description.length<=b.description:a.validity.description=!0,a.validity.name&&a.validity.description}function c(b,c){var d=b.expression,e="string"==typeof d&&d.trim().length>0&&d.length<=c.expression;return d&&(b.expression=a(d)),b.validity.expression=e,e}function d(a){var b=a.selectedFields,c=!1;return!!b&&("single"===a.type?c=1===b.length:"drilldown"===a.type&&(c=b.length>1),a.validity.selectedFields=c,c)}return{validateMetadata:b,validateExpr:c,validateFieldsInDimension:d}}),define("text!general.components/function-tip-view/function-tip-view.html",[],function(){return'<qui-float qui-offset="offset" qui-resize-on-change="content" class="qv-function-tip-container">\n\t<div class=\'qv-function-tip-view\' ng-show=\'content\'>{{content}}</div>\n</qui-float>\n'}),define("general.components/function-tip-view/function-tip-view",["text!./function-tip-view.html"],function(a){"use strict";return{scope:{offset:"=",content:"="},template:a,controller:[function(){}]}}),define("lz-string",[],function(){var a={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(b){if(null==b)return"";var c,d,e,f,g,h,i,j="",k=0;for(b=a.compress(b);k<2*b.length;)k%2==0?(c=b.charCodeAt(k/2)>>8,d=255&b.charCodeAt(k/2),e=k/2+1<b.length?b.charCodeAt(k/2+1)>>8:NaN):(c=255&b.charCodeAt((k-1)/2),(k+1)/2<b.length?(d=b.charCodeAt((k+1)/2)>>8,e=255&b.charCodeAt((k+1)/2)):d=e=NaN),k+=3,f=c>>2,g=(3&c)<<4|d>>4,h=(15&d)<<2|e>>6,i=63&e,isNaN(d)?h=i=64:isNaN(e)&&(i=64),j=j+a._keyStr.charAt(f)+a._keyStr.charAt(g)+a._keyStr.charAt(h)+a._keyStr.charAt(i);return j},decompressFromBase64:function(b){if(null==b)return"";var c,d,e,f,g,h,i,j,k="",l=0,m=0,n=a._f;for(b=b.replace(/[^A-Za-z0-9\+\/\=]/g,"");m<b.length;)g=a._keyStr.indexOf(b.charAt(m++)),h=a._keyStr.indexOf(b.charAt(m++)),i=a._keyStr.indexOf(b.charAt(m++)),j=a._keyStr.indexOf(b.charAt(m++)),d=g<<2|h>>4,e=(15&h)<<4|i>>2,f=(3&i)<<6|j,l%2==0?(c=d<<8,64!=i&&(k+=n(c|e)),64!=j&&(c=f<<8)):(k+=n(c|d),64!=i&&(c=e<<8),64!=j&&(k+=n(c|f))),l+=3;return a.decompress(k)},compressToUTF16:function(b){if(null==b)return"";var c,d,e,f="",g=0,h=a._f;for(b=a.compress(b),c=0;c<b.length;c++)switch(d=b.charCodeAt(c),g++){case 0:f+=h(32+(d>>1)),e=(1&d)<<14;break;case 1:f+=h(e+(d>>2)+32),e=(3&d)<<13;break;case 2:f+=h(e+(d>>3)+32),e=(7&d)<<12;break;case 3:f+=h(e+(d>>4)+32),e=(15&d)<<11;break;case 4:f+=h(e+(d>>5)+32),e=(31&d)<<10;break;case 5:f+=h(e+(d>>6)+32),e=(63&d)<<9;break;case 6:f+=h(e+(d>>7)+32),e=(127&d)<<8;break;case 7:f+=h(e+(d>>8)+32),e=(255&d)<<7;break;case 8:f+=h(e+(d>>9)+32),e=(511&d)<<6;break;case 9:f+=h(e+(d>>10)+32),e=(1023&d)<<5;break;case 10:f+=h(e+(d>>11)+32),e=(2047&d)<<4;break;case 11:f+=h(e+(d>>12)+32),e=(4095&d)<<3;break;case 12:f+=h(e+(d>>13)+32),e=(8191&d)<<2;break;case 13:f+=h(e+(d>>14)+32),e=(16383&d)<<1;break;case 14:f+=h(e+(d>>15)+32,32+(32767&d)),g=0}return f+h(e+32)},decompressFromUTF16:function(b){if(null==b)return"";for(var c,d,e="",f=0,g=0,h=a._f;g<b.length;){switch(d=b.charCodeAt(g)-32,f++){case 0:c=d<<1;break;case 1:e+=h(c|d>>14),c=(16383&d)<<2;break;case 2:e+=h(c|d>>13),c=(8191&d)<<3;break;case 3:e+=h(c|d>>12),c=(4095&d)<<4;break;case 4:e+=h(c|d>>11),c=(2047&d)<<5;break;case 5:e+=h(c|d>>10),c=(1023&d)<<6;break;case 6:e+=h(c|d>>9),c=(511&d)<<7;break;case 7:e+=h(c|d>>8),c=(255&d)<<8;break;case 8:e+=h(c|d>>7),c=(127&d)<<9;break;case 9:e+=h(c|d>>6),c=(63&d)<<10;break;case 10:e+=h(c|d>>5),c=(31&d)<<11;break;case 11:e+=h(c|d>>4),c=(15&d)<<12;break;case 12:e+=h(c|d>>3),c=(7&d)<<13;break;case 13:e+=h(c|d>>2),c=(3&d)<<14;break;case 14:e+=h(c|d>>1),c=(1&d)<<15;break;case 15:e+=h(c|d),f=0}g++}return a.decompress(e)},compress:function(b){if(null==b)return"";var c,d,e,f={},g={},h="",i="",j="",k=2,l=3,m=2,n="",o=0,p=0,q=a._f;for(e=0;e<b.length;e+=1)if(h=b.charAt(e),Object.prototype.hasOwnProperty.call(f,h)||(f[h]=l++,g[h]=!0),i=j+h,Object.prototype.hasOwnProperty.call(f,i))j=i;else{if(Object.prototype.hasOwnProperty.call(g,j)){if(j.charCodeAt(0)<256){for(c=0;c<m;c++)o<<=1,15==p?(p=0,n+=q(o),o=0):p++;for(d=j.charCodeAt(0),c=0;c<8;c++)o=o<<1|1&d,15==p?(p=0,n+=q(o),o=0):p++,d>>=1}else{for(d=1,c=0;c<m;c++)o=o<<1|d,15==p?(p=0,n+=q(o),o=0):p++,d=0;for(d=j.charCodeAt(0),c=0;c<16;c++)o=o<<1|1&d,15==p?(p=0,n+=q(o),o=0):p++,d>>=1}k--,0==k&&(k=Math.pow(2,m),m++),delete g[j]}else for(d=f[j],c=0;c<m;c++)o=o<<1|1&d,15==p?(p=0,n+=q(o),o=0):p++,d>>=1;k--,0==k&&(k=Math.pow(2,m),m++),f[i]=l++,j=String(h)}if(""!==j){if(Object.prototype.hasOwnProperty.call(g,j)){if(j.charCodeAt(0)<256){for(c=0;c<m;c++)o<<=1,15==p?(p=0,n+=q(o),o=0):p++;for(d=j.charCodeAt(0),c=0;c<8;c++)o=o<<1|1&d,15==p?(p=0,n+=q(o),o=0):p++,d>>=1}else{for(d=1,c=0;c<m;c++)o=o<<1|d,15==p?(p=0,n+=q(o),o=0):p++,d=0;for(d=j.charCodeAt(0),c=0;c<16;c++)o=o<<1|1&d,15==p?(p=0,n+=q(o),o=0):p++,d>>=1}k--,0==k&&(k=Math.pow(2,m),m++),delete g[j]}else for(d=f[j],c=0;c<m;c++)o=o<<1|1&d,15==p?(p=0,n+=q(o),o=0):p++,d>>=1;k--,0==k&&(k=Math.pow(2,m),m++)}for(d=2,c=0;c<m;c++)o=o<<1|1&d,15==p?(p=0,n+=q(o),o=0):p++,d>>=1;for(;;){if(o<<=1,15==p){n+=q(o);break}p++}return n},decompress:function(b){if(null==b)return"";if(""==b)return null;var c,d,e,f,g,h,i,j=[],k=4,l=4,m=3,n="",o="",p=a._f,q={string:b,val:b.charCodeAt(0),position:32768,index:1};for(c=0;c<3;c+=1)j[c]=c;for(e=0,g=Math.pow(2,2),h=1;h!=g;)f=q.val&q.position,q.position>>=1,0==q.position&&(q.position=32768,q.val=q.string.charCodeAt(q.index++)),e|=(f>0?1:0)*h,h<<=1;switch(e){case 0:for(e=0,g=Math.pow(2,8),h=1;h!=g;)f=q.val&q.position,q.position>>=1,0==q.position&&(q.position=32768,q.val=q.string.charCodeAt(q.index++)),e|=(f>0?1:0)*h,h<<=1;i=p(e);break;case 1:for(e=0,g=Math.pow(2,16),h=1;h!=g;)f=q.val&q.position,q.position>>=1,0==q.position&&(q.position=32768,q.val=q.string.charCodeAt(q.index++)),e|=(f>0?1:0)*h,h<<=1;i=p(e);break;case 2:return""}for(j[3]=i,d=o=i;;){if(q.index>q.string.length)return"";for(e=0,g=Math.pow(2,m),h=1;h!=g;)f=q.val&q.position,q.position>>=1,0==q.position&&(q.position=32768,q.val=q.string.charCodeAt(q.index++)),e|=(f>0?1:0)*h,h<<=1;switch(i=e){case 0:for(e=0,g=Math.pow(2,8),h=1;h!=g;)f=q.val&q.position,q.position>>=1,0==q.position&&(q.position=32768,q.val=q.string.charCodeAt(q.index++)),e|=(f>0?1:0)*h,h<<=1;j[l++]=p(e),i=l-1,k--;break;case 1:for(e=0,g=Math.pow(2,16),h=1;h!=g;)f=q.val&q.position,q.position>>=1,0==q.position&&(q.position=32768,q.val=q.string.charCodeAt(q.index++)),e|=(f>0?1:0)*h,h<<=1;j[l++]=p(e),i=l-1,k--;break;case 2:return o}if(0==k&&(k=Math.pow(2,m),m++),j[i])n=j[i];else{if(i!==l)return null;n=d+d.charAt(0)}o+=n,j[l++]=d+n.charAt(0),k--,d=n,0==k&&(k=Math.pow(2,m),m++)}}};return a}),define("general.models/bnf-model",["core.models/engine","lz-string","core.utils/deferred"],function(a,b,c){"use strict";function d(a){function b(a){return a.replace(/\s+/g," ").replace(/\s+(\)|\]|,)/g,"$1").replace(/(\(|\[|,)\s+/g,"$1")}function c(){a.forEach(e),[{qStr:"must_include",qBnfLiteral:!0}].forEach(e)}function d(){function a(a,b){return{text:b,type:a}}u.functions.length<1&&c();var b=u.notFunctions.map(a.bind(null,"keyword")),d=u.functions.map(a.bind(null,"function"));u.autocompleteList=b.concat(d)}function e(a){a.qBnfLiteral===!0&&(u.keywords.indexOf(a.qStr)===-1&&u.keywords.push(a.qStr),a.qStr&&(u.keywordsAsLowerCase.push(a.qStr.toLowerCase()),u.mapping[a.qStr.toLowerCase()]=a.qNbr,a.qAggrFunc||a.qQvFunc?(u.functions.indexOf(a.qStr)===-1&&u.functions.push(a.qStr),t[a.qStr.toLowerCase()]="function"):a.qFieldFlag||(u.notFunctions.indexOf(a.qStr)===-1&&u.notFunctions.push(a.qStr),t[a.qStr.toLowerCase()]="keyword")))}function f(b){if(b=parseInt(b,10),u.bnfEntries[b])return u.bnfEntries[b];var c=a.filter(function(a){return parseInt(a.qNbr,10)===b});return u.bnfEntries[b]=c[0],c[0]||!1}function g(a){return u.keywords.length<1&&c(),a=a.toLowerCase(),f(u.mapping[a])}function h(a){var b="",c=f(a);return a>=0&&a<=56?b=c.qStr||"":c&&(b=c.qStr||c.qName),b}function i(a){return a&&!a.signature&&(a.qBnf&&a.qBnf.length>0?a.signature=a.qBnf.map(h).join(" ").trim():a.qPNbr&&(a.signature=i(f(a.qPNbr))),a.signature=b(a.signature)),a.signature||""}function j(){return u.keywords.length<1&&c(),u.keywords}function k(){return u.keywordsAsLowerCase.length<1&&c(),u.keywordsAsLowerCase}function l(){return u.autocompleteList||d(),u.autocompleteList}function m(a){var b=g(a);return b!==!1?i(b):""}function n(){return a.filter(function(a){return a.qHelpId&&a.qHelpId>0}).map(function(a){return a.qStr})}function o(a){return"function"===t[a.toLowerCase()]}function p(){return!1}function q(){return!1}function r(a){return!!t[a.toLowerCase()]}function s(){return u.functions.length<1&&c(),u.functions}var t={},u={keywords:[],keywordsAsLowerCase:[],functions:[],notFunctions:[],bnfEntries:[],mapping:{}};return c(),{getBnfEntry:f,getLiteralString:h,getAllKeywords:j,getAllKeywordsAsLowerCase:k,getAutocompleteList:l,getKeywordsWithHelp:n,getSignatureFromKeyword:m,getFunctionTip:m,isFunction:o,isField:p,isKeyword:r,isVariable:q,getAllFunctions:s}}function e(e){var f="BNF_CACHE_DATA_"+e,g="BNF_CACHE_VERSION_"+e;return a.global.qvVersion().then(function(h){var i=new c,j=localStorage.getItem(g),k=j===h,l=k?localStorage.getItem(f):void 0;if(l)try{var m=JSON.parse(b.decompressFromUTF16(l));return i.resolve(d(m)),i.promise}catch(a){}return a.global.getBNF(e).then(function(a){var c=a.qBnfDefs;localStorage.setItem(f,b.compressToUTF16(JSON.stringify(c))),localStorage.setItem(g,h),i.resolve(d(c))}),i.promise})}function f(a){return i[a]||(i[a]=e(a)),i[a]}function g(){return f("S")}function h(){return f("E")}var i={};return{createBnfModel:d,getReloadScriptBnfModel:g,getExpressionBnfModel:h}}),define("assets/client/dialogs/expression-dialog/expression-bnf",["core.utils/deferred","client.assets/tab-contents/fields/assets-field-list-model","general.models/bnf-model","util"],function(a,b,c,d){function e(a,b){return"field"===a?{text:b,type:a,value:d.escapeField(b)}:{text:b,type:a}}function f(a){function b(a){return j.isFunction(a)}function c(a){return j.getFunctionTip(a)}function d(a){return!!l[a.toLowerCase()]||b(a)}function f(a){return!!m[a]}function h(a){return!!n[a]}function i(){return s}var j=a.bnf,l=g(),m=a.fields,n=a.variables,o=k.map(e.bind(null,"keyword")),p=Object.keys(n).map(e.bind(null,"variable")),q=Object.keys(m).map(e.bind(null,"field")),r=j.getAllFunctions().map(e.bind(null,"function")),s=o.concat(p,q,r);return{getAutocompleteList:i,getFunctionTip:c,isFunction:b,isField:f,isKeyword:d,isVariable:h}}function g(){for(var a={},b=0;b<k.length;++b){a[k[b]]=!0}return a}function h(a){return a.enigmaModel.getFieldList().then(function(a){a=b.expand(a);for(var c={},d=0;d<a.length;++d){c[a[d].qName]=!0}return c})}function i(a){return a.enigmaModel.getVariableList().then(function(a){for(var b={},c=0;c<a.length;++c){b[a[c].qName]=!0}return b})}function j(b){return a.all({bnf:c.getExpressionBnfModel(),fields:h(b),variables:i(b)}).then(f)}var k=["like","not","and","or","xor","follows","precedes","bitnot","bitand","bitor","bitxor","$","$1","$2","$3","$4","$5","$_1","$_2","$_3","$_4","$_5","total","distinct","nodistinct","all","include","must_include"];return{get:j}}),define("general.services/aligner/aligner",[],function(){function a(a){this.container=a.container,this.body=a.body,this.alignAgainst=a.alignAgainst}return a.prototype.showTranscluded=function(a){a(function(a){this.container.appendTo(this.body).append(a)}.bind(this))},a.prototype.showContent=function(a){this.container.appendTo(this.body).append(a)},a.prototype.update=function(){var a=this.alignAgainst.offset();this.container.css({top:a.top,left:a.left,width:this.alignAgainst.width(),height:this.alignAgainst.height(),zIndex:1021})},a.prototype.hide=function(){this.container.remove()},a}),define("general.components/extract",["jquery","qvangular","core.utils/resize","general.services/aligner/aligner"],function(a,b,c,d){b.directive("qvExtract",["$timeout","$parse",function(b,e){return{restrict:"A",transclude:!0,link:function(f,g,h,i,j){function k(){l.update(),++n,m.assign&&m.assign(f,n)}var l=new d({container:a("<div style='position:absolute'>"),body:document.body,alignAgainst:g}),m=e(h.qvExtract),n=0;l.showTranscluded(j),l.update(),b(function(){k()}),c.on("end",k),f.$on("$destroy",function(){l.hide(),c.off("end",k)})}}}])}),function(a){if("object"==typeof exports&&"object"==typeof module)module.exports=a();else{if("function"==typeof define&&define.amd)return define("cm",[],a);(this||window).CodeMirror=a()}}(function(){"use strict";function a(c,d){if(!(this instanceof a))return new a(c,d);this.options=d=d?Ke(d):{},Ke($f,d,!1),n(d);var e=d.value;"string"==typeof e&&(e=new wg(e,d.mode,null,d.lineSeparator)),this.doc=e;var f=new a.inputStyles[d.inputStyle](this),g=this.display=new b(c,e,f);g.wrapper.CodeMirror=this,j(this),h(this),d.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),d.autofocus&&!Cf&&g.input.focus(),r(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,
delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new De,keySeq:null,specialChars:null};var i=this;sf&&tf<11&&setTimeout(function(){i.display.input.reset(!0)},20),Qb(this),We(),ub(this),this.curOp.forceUpdate=!0,Xd(this,e),d.autofocus&&!Cf||i.hasFocus()?setTimeout(Le(qc,this),20):rc(this);for(var k in _f)_f.hasOwnProperty(k)&&_f[k](this,d[k],ag);w(this),d.finishInit&&d.finishInit(this);for(var l=0;l<eg.length;++l)eg[l](this);wb(this),uf&&d.lineWrapping&&"optimizelegibility"==getComputedStyle(g.lineDiv).textRendering&&(g.lineDiv.style.textRendering="auto")}function b(a,b,c){var d=this;this.input=c,d.scrollbarFiller=Pe("div",null,"CodeMirror-scrollbar-filler"),d.scrollbarFiller.setAttribute("cm-not-content","true"),d.gutterFiller=Pe("div",null,"CodeMirror-gutter-filler"),d.gutterFiller.setAttribute("cm-not-content","true"),d.lineDiv=Pe("div",null,"CodeMirror-code"),d.selectionDiv=Pe("div",null,null,"position: relative; z-index: 1"),d.cursorDiv=Pe("div",null,"CodeMirror-cursors"),d.measure=Pe("div",null,"CodeMirror-measure"),d.lineMeasure=Pe("div",null,"CodeMirror-measure"),d.lineSpace=Pe("div",[d.measure,d.lineMeasure,d.selectionDiv,d.cursorDiv,d.lineDiv],null,"position: relative; outline: none"),d.mover=Pe("div",[Pe("div",[d.lineSpace],"CodeMirror-lines")],null,"position: relative"),d.sizer=Pe("div",[d.mover],"CodeMirror-sizer"),d.sizerWidth=null,d.heightForcer=Pe("div",null,null,"position: absolute; height: "+Hg+"px; width: 1px;"),d.gutters=Pe("div",null,"CodeMirror-gutters"),d.lineGutter=null,d.scroller=Pe("div",[d.sizer,d.heightForcer,d.gutters],"CodeMirror-scroll"),d.scroller.setAttribute("tabIndex","-1"),d.wrapper=Pe("div",[d.scrollbarFiller,d.gutterFiller,d.scroller],"CodeMirror"),sf&&tf<8&&(d.gutters.style.zIndex=-1,d.scroller.style.paddingRight=0),uf||pf&&Cf||(d.scroller.draggable=!0),a&&(a.appendChild?a.appendChild(d.wrapper):a(d.wrapper)),d.viewFrom=d.viewTo=b.first,d.reportedViewFrom=d.reportedViewTo=b.first,d.view=[],d.renderedView=null,d.externalMeasured=null,d.viewOffset=0,d.lastWrapHeight=d.lastWrapWidth=0,d.updateLineNumbers=null,d.nativeBarWidth=d.barHeight=d.barWidth=0,d.scrollbarsClipped=!1,d.lineNumWidth=d.lineNumInnerWidth=d.lineNumChars=null,d.alignWidgets=!1,d.cachedCharWidth=d.cachedTextHeight=d.cachedPaddingH=null,d.maxLine=null,d.maxLineLength=0,d.maxLineChanged=!1,d.wheelDX=d.wheelDY=d.wheelStartX=d.wheelStartY=null,d.shift=!1,d.selForContextMenu=null,d.activeTouch=null,c.init(d)}function c(b){b.doc.mode=a.getMode(b.options,b.doc.modeOption),d(b)}function d(a){a.doc.iter(function(a){a.stateAfter&&(a.stateAfter=null),a.styles&&(a.styles=null)}),a.doc.frontier=a.doc.first,Na(a,100),a.state.modeGen++,a.curOp&&Jb(a)}function e(a){a.options.lineWrapping?(Yg(a.display.wrapper,"CodeMirror-wrap"),a.display.sizer.style.minWidth="",a.display.sizerWidth=null):(Xg(a.display.wrapper,"CodeMirror-wrap"),m(a)),g(a),Jb(a),hb(a),setTimeout(function(){s(a)},100)}function f(a){var b=sb(a.display),c=a.options.lineWrapping,d=c&&Math.max(5,a.display.scroller.clientWidth/tb(a.display)-3);return function(e){if(vd(a.doc,e))return 0;var f=0;if(e.widgets)for(var g=0;g<e.widgets.length;g++)e.widgets[g].height&&(f+=e.widgets[g].height);return c?f+(Math.ceil(e.text.length/d)||1)*b:f+b}}function g(a){var b=a.doc,c=f(a);b.iter(function(a){var b=c(a);b!=a.height&&_d(a,b)})}function h(a){a.display.wrapper.className=a.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+a.options.theme.replace(/(^|\s)\s*/g," cm-s-"),hb(a)}function i(a){j(a),Jb(a),setTimeout(function(){v(a)},20)}function j(a){var b=a.display.gutters,c=a.options.gutters;Qe(b);for(var d=0;d<c.length;++d){var e=c[d],f=b.appendChild(Pe("div",null,"CodeMirror-gutter "+e));"CodeMirror-linenumbers"==e&&(a.display.lineGutter=f,f.style.width=(a.display.lineNumWidth||1)+"px")}b.style.display=d?"":"none",k(a)}function k(a){var b=a.display.gutters.offsetWidth;a.display.sizer.style.marginLeft=b+"px"}function l(a){if(0==a.height)return 0;for(var b,c=a.text.length,d=a;b=od(d);){var e=b.find(0,!0);d=e.from.line,c+=e.from.ch-e.to.ch}for(d=a;b=pd(d);){var e=b.find(0,!0);c-=d.text.length-e.from.ch,d=e.to.line,c+=d.text.length-e.to.ch}return c}function m(a){var b=a.display,c=a.doc;b.maxLine=Yd(c,c.first),b.maxLineLength=l(b.maxLine),b.maxLineChanged=!0,c.iter(function(a){var c=l(a);c>b.maxLineLength&&(b.maxLineLength=c,b.maxLine=a)})}function n(a){var b=Ge(a.gutters,"CodeMirror-linenumbers");b==-1&&a.lineNumbers?a.gutters=a.gutters.concat(["CodeMirror-linenumbers"]):b>-1&&!a.lineNumbers&&(a.gutters=a.gutters.slice(0),a.gutters.splice(b,1))}function o(a){var b=a.display,c=b.gutters.offsetWidth,d=Math.round(a.doc.height+Sa(a.display));return{clientHeight:b.scroller.clientHeight,viewHeight:b.wrapper.clientHeight,scrollWidth:b.scroller.scrollWidth,clientWidth:b.scroller.clientWidth,viewWidth:b.wrapper.clientWidth,barLeft:a.options.fixedGutter?c:0,docHeight:d,scrollHeight:d+Ua(a)+b.barHeight,nativeBarWidth:b.nativeBarWidth,gutterWidth:c}}function p(a,b,c){this.cm=c;var d=this.vert=Pe("div",[Pe("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),e=this.horiz=Pe("div",[Pe("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");a(d),a(e),Cg(d,"scroll",function(){d.clientHeight&&b(d.scrollTop,"vertical")}),Cg(e,"scroll",function(){e.clientWidth&&b(e.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,sf&&tf<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}function q(){}function r(b){b.display.scrollbars&&(b.display.scrollbars.clear(),b.display.scrollbars.addClass&&Xg(b.display.wrapper,b.display.scrollbars.addClass)),b.display.scrollbars=new a.scrollbarModel[b.options.scrollbarStyle](function(a){b.display.wrapper.insertBefore(a,b.display.scrollbarFiller),Cg(a,"mousedown",function(){b.state.focused&&setTimeout(function(){b.display.input.focus()},0)}),a.setAttribute("cm-not-content","true")},function(a,c){"horizontal"==c?ec(b,a):dc(b,a)},b),b.display.scrollbars.addClass&&Yg(b.display.wrapper,b.display.scrollbars.addClass)}function s(a,b){b||(b=o(a));var c=a.display.barWidth,d=a.display.barHeight;t(a,b);for(var e=0;e<4&&c!=a.display.barWidth||d!=a.display.barHeight;e++)c!=a.display.barWidth&&a.options.lineWrapping&&F(a),t(a,o(a)),c=a.display.barWidth,d=a.display.barHeight}function t(a,b){var c=a.display,d=c.scrollbars.update(b);c.sizer.style.paddingRight=(c.barWidth=d.right)+"px",c.sizer.style.paddingBottom=(c.barHeight=d.bottom)+"px",c.heightForcer.style.borderBottom=d.bottom+"px solid transparent",d.right&&d.bottom?(c.scrollbarFiller.style.display="block",c.scrollbarFiller.style.height=d.bottom+"px",c.scrollbarFiller.style.width=d.right+"px"):c.scrollbarFiller.style.display="",d.bottom&&a.options.coverGutterNextToScrollbar&&a.options.fixedGutter?(c.gutterFiller.style.display="block",c.gutterFiller.style.height=d.bottom+"px",c.gutterFiller.style.width=b.gutterWidth+"px"):c.gutterFiller.style.display=""}function u(a,b,c){var d=c&&null!=c.top?Math.max(0,c.top):a.scroller.scrollTop;d=Math.floor(d-Ra(a));var e=c&&null!=c.bottom?c.bottom:d+a.wrapper.clientHeight,f=be(b,d),g=be(b,e);if(c&&c.ensure){var h=c.ensure.from.line,i=c.ensure.to.line;h<f?(f=h,g=be(b,ce(Yd(b,h))+a.wrapper.clientHeight)):Math.min(i,b.lastLine())>=g&&(f=be(b,ce(Yd(b,i))-a.wrapper.clientHeight),g=i)}return{from:f,to:Math.max(g,f+1)}}function v(a){var b=a.display,c=b.view;if(b.alignWidgets||b.gutters.firstChild&&a.options.fixedGutter){for(var d=y(b)-b.scroller.scrollLeft+a.doc.scrollLeft,e=b.gutters.offsetWidth,f=d+"px",g=0;g<c.length;g++)if(!c[g].hidden){a.options.fixedGutter&&c[g].gutter&&(c[g].gutter.style.left=f);var h=c[g].alignable;if(h)for(var i=0;i<h.length;i++)h[i].style.left=f}a.options.fixedGutter&&(b.gutters.style.left=d+e+"px")}}function w(a){if(!a.options.lineNumbers)return!1;var b=a.doc,c=x(a.options,b.first+b.size-1),d=a.display;if(c.length!=d.lineNumChars){var e=d.measure.appendChild(Pe("div",[Pe("div",c)],"CodeMirror-linenumber CodeMirror-gutter-elt")),f=e.firstChild.offsetWidth,g=e.offsetWidth-f;return d.lineGutter.style.width="",d.lineNumInnerWidth=Math.max(f,d.lineGutter.offsetWidth-g)+1,d.lineNumWidth=d.lineNumInnerWidth+g,d.lineNumChars=d.lineNumInnerWidth?c.length:-1,d.lineGutter.style.width=d.lineNumWidth+"px",k(a),!0}return!1}function x(a,b){return String(a.lineNumberFormatter(b+a.firstLineNumber))}function y(a){return a.scroller.getBoundingClientRect().left-a.sizer.getBoundingClientRect().left}function z(a,b,c){var d=a.display;this.viewport=b,this.visible=u(d,a.doc,b),this.editorIsHidden=!d.wrapper.offsetWidth,this.wrapperHeight=d.wrapper.clientHeight,this.wrapperWidth=d.wrapper.clientWidth,this.oldDisplayWidth=Va(a),this.force=c,this.dims=H(a),this.events=[]}function A(a){var b=a.display;!b.scrollbarsClipped&&b.scroller.offsetWidth&&(b.nativeBarWidth=b.scroller.offsetWidth-b.scroller.clientWidth,b.heightForcer.style.height=Ua(a)+"px",b.sizer.style.marginBottom=-b.nativeBarWidth+"px",b.sizer.style.borderRightWidth=Ua(a)+"px",b.scrollbarsClipped=!0)}function B(a,b){var c=a.display,d=a.doc;if(b.editorIsHidden)return Lb(a),!1;if(!b.force&&b.visible.from>=c.viewFrom&&b.visible.to<=c.viewTo&&(null==c.updateLineNumbers||c.updateLineNumbers>=c.viewTo)&&c.renderedView==c.view&&0==Pb(a))return!1;w(a)&&(Lb(a),b.dims=H(a));var e=d.first+d.size,f=Math.max(b.visible.from-a.options.viewportMargin,d.first),g=Math.min(e,b.visible.to+a.options.viewportMargin);c.viewFrom<f&&f-c.viewFrom<20&&(f=Math.max(d.first,c.viewFrom)),c.viewTo>g&&c.viewTo-g<20&&(g=Math.min(e,c.viewTo)),Jf&&(f=td(a.doc,f),g=ud(a.doc,g));var h=f!=c.viewFrom||g!=c.viewTo||c.lastWrapHeight!=b.wrapperHeight||c.lastWrapWidth!=b.wrapperWidth;Ob(a,f,g),c.viewOffset=ce(Yd(a.doc,c.viewFrom)),a.display.mover.style.top=c.viewOffset+"px";var i=Pb(a);if(!h&&0==i&&!b.force&&c.renderedView==c.view&&(null==c.updateLineNumbers||c.updateLineNumbers>=c.viewTo))return!1;var j=Se();return i>4&&(c.lineDiv.style.display="none"),I(a,c.updateLineNumbers,b.dims),i>4&&(c.lineDiv.style.display=""),c.renderedView=c.view,j&&Se()!=j&&j.offsetHeight&&j.focus(),Qe(c.cursorDiv),Qe(c.selectionDiv),c.gutters.style.height=c.sizer.style.minHeight=0,h&&(c.lastWrapHeight=b.wrapperHeight,c.lastWrapWidth=b.wrapperWidth,Na(a,400)),c.updateLineNumbers=null,!0}function C(a,b){for(var c=b.viewport,d=!0;(d&&a.options.lineWrapping&&b.oldDisplayWidth!=Va(a)||(c&&null!=c.top&&(c={top:Math.min(a.doc.height+Sa(a.display)-Wa(a),c.top)}),b.visible=u(a.display,a.doc,c),!(b.visible.from>=a.display.viewFrom&&b.visible.to<=a.display.viewTo)))&&B(a,b);d=!1){F(a);var e=o(a);Ia(a),s(a,e),E(a,e)}b.signal(a,"update",a),a.display.viewFrom==a.display.reportedViewFrom&&a.display.viewTo==a.display.reportedViewTo||(b.signal(a,"viewportChange",a,a.display.viewFrom,a.display.viewTo),a.display.reportedViewFrom=a.display.viewFrom,a.display.reportedViewTo=a.display.viewTo)}function D(a,b){var c=new z(a,b);if(B(a,c)){F(a),C(a,c);var d=o(a);Ia(a),s(a,d),E(a,d),c.finish()}}function E(a,b){a.display.sizer.style.minHeight=b.docHeight+"px",a.display.heightForcer.style.top=b.docHeight+"px",a.display.gutters.style.height=b.docHeight+a.display.barHeight+Ua(a)+"px"}function F(a){for(var b=a.display,c=b.lineDiv.offsetTop,d=0;d<b.view.length;d++){var e,f=b.view[d];if(!f.hidden){if(sf&&tf<8){var g=f.node.offsetTop+f.node.offsetHeight;e=g-c,c=g}else{var h=f.node.getBoundingClientRect();e=h.bottom-h.top}var i=f.line.height-e;if(e<2&&(e=sb(b)),(i>.001||i<-.001)&&(_d(f.line,e),G(f.line),f.rest))for(var j=0;j<f.rest.length;j++)G(f.rest[j])}}}function G(a){if(a.widgets)for(var b=0;b<a.widgets.length;++b)a.widgets[b].height=a.widgets[b].node.parentNode.offsetHeight}function H(a){for(var b=a.display,c={},d={},e=b.gutters.clientLeft,f=b.gutters.firstChild,g=0;f;f=f.nextSibling,++g)c[a.options.gutters[g]]=f.offsetLeft+f.clientLeft+e,d[a.options.gutters[g]]=f.clientWidth;return{fixedPos:y(b),gutterTotalWidth:b.gutters.offsetWidth,gutterLeft:c,gutterWidth:d,wrapperWidth:b.wrapper.clientWidth}}function I(a,b,c){function d(b){var c=b.nextSibling;return uf&&Df&&a.display.currentWheelTarget==b?b.style.display="none":b.parentNode.removeChild(b),c}for(var e=a.display,f=a.options.lineNumbers,g=e.lineDiv,h=g.firstChild,i=e.view,j=e.viewFrom,k=0;k<i.length;k++){var l=i[k];if(l.hidden);else if(l.node&&l.node.parentNode==g){for(;h!=l.node;)h=d(h);var m=f&&null!=b&&b<=j&&l.lineNumber;l.changes&&(Ge(l.changes,"gutter")>-1&&(m=!1),J(a,l,j,c)),m&&(Qe(l.lineNumber),l.lineNumber.appendChild(document.createTextNode(x(a.options,j)))),h=l.node.nextSibling}else{var n=R(a,l,j,c);g.insertBefore(n,h)}j+=l.size}for(;h;)h=d(h)}function J(a,b,c,d){for(var e=0;e<b.changes.length;e++){var f=b.changes[e];"text"==f?N(a,b):"gutter"==f?P(a,b,c,d):"class"==f?O(b):"widget"==f&&Q(a,b,d)}b.changes=null}function K(a){return a.node==a.text&&(a.node=Pe("div",null,null,"position: relative"),a.text.parentNode&&a.text.parentNode.replaceChild(a.node,a.text),a.node.appendChild(a.text),sf&&tf<8&&(a.node.style.zIndex=2)),a.node}function L(a){var b=a.bgClass?a.bgClass+" "+(a.line.bgClass||""):a.line.bgClass;if(b&&(b+=" CodeMirror-linebackground"),a.background)b?a.background.className=b:(a.background.parentNode.removeChild(a.background),a.background=null);else if(b){var c=K(a);a.background=c.insertBefore(Pe("div",null,b),c.firstChild)}}function M(a,b){var c=a.display.externalMeasured;return c&&c.line==b.line?(a.display.externalMeasured=null,b.measure=c.measure,c.built):Ld(a,b)}function N(a,b){var c=b.text.className,d=M(a,b);b.text==b.node&&(b.node=d.pre),b.text.parentNode.replaceChild(d.pre,b.text),b.text=d.pre,d.bgClass!=b.bgClass||d.textClass!=b.textClass?(b.bgClass=d.bgClass,b.textClass=d.textClass,O(b)):c&&(b.text.className=c)}function O(a){L(a),a.line.wrapClass?K(a).className=a.line.wrapClass:a.node!=a.text&&(a.node.className="");var b=a.textClass?a.textClass+" "+(a.line.textClass||""):a.line.textClass;a.text.className=b||""}function P(a,b,c,d){if(b.gutter&&(b.node.removeChild(b.gutter),b.gutter=null),b.gutterBackground&&(b.node.removeChild(b.gutterBackground),b.gutterBackground=null),b.line.gutterClass){var e=K(b);b.gutterBackground=Pe("div",null,"CodeMirror-gutter-background "+b.line.gutterClass,"left: "+(a.options.fixedGutter?d.fixedPos:-d.gutterTotalWidth)+"px; width: "+d.gutterTotalWidth+"px"),e.insertBefore(b.gutterBackground,b.text)}var f=b.line.gutterMarkers;if(a.options.lineNumbers||f){var e=K(b),g=b.gutter=Pe("div",null,"CodeMirror-gutter-wrapper","left: "+(a.options.fixedGutter?d.fixedPos:-d.gutterTotalWidth)+"px");if(a.display.input.setUneditable(g),e.insertBefore(g,b.text),b.line.gutterClass&&(g.className+=" "+b.line.gutterClass),!a.options.lineNumbers||f&&f["CodeMirror-linenumbers"]||(b.lineNumber=g.appendChild(Pe("div",x(a.options,c),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+d.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+a.display.lineNumInnerWidth+"px"))),f)for(var h=0;h<a.options.gutters.length;++h){var i=a.options.gutters[h],j=f.hasOwnProperty(i)&&f[i];j&&g.appendChild(Pe("div",[j],"CodeMirror-gutter-elt","left: "+d.gutterLeft[i]+"px; width: "+d.gutterWidth[i]+"px"))}}}function Q(a,b,c){b.alignable&&(b.alignable=null);for(var d,e=b.node.firstChild;e;e=d){var d=e.nextSibling;"CodeMirror-linewidget"==e.className&&b.node.removeChild(e)}S(a,b,c)}function R(a,b,c,d){var e=M(a,b);return b.text=b.node=e.pre,e.bgClass&&(b.bgClass=e.bgClass),e.textClass&&(b.textClass=e.textClass),O(b),P(a,b,c,d),S(a,b,d),b.node}function S(a,b,c){if(T(a,b.line,b,c,!0),b.rest)for(var d=0;d<b.rest.length;d++)T(a,b.rest[d],b,c,!1)}function T(a,b,c,d,e){if(b.widgets)for(var f=K(c),g=0,h=b.widgets;g<h.length;++g){var i=h[g],j=Pe("div",[i.node],"CodeMirror-linewidget");i.handleMouseEvents||j.setAttribute("cm-ignore-events","true"),U(i,j,c,d),a.display.input.setUneditable(j),e&&i.above?f.insertBefore(j,c.gutter||c.text):f.appendChild(j),xe(i,"redraw")}}function U(a,b,c,d){if(a.noHScroll){(c.alignable||(c.alignable=[])).push(b);var e=d.wrapperWidth;b.style.left=d.fixedPos+"px",a.coverGutter||(e-=d.gutterTotalWidth,b.style.paddingLeft=d.gutterTotalWidth+"px"),b.style.width=e+"px"}a.coverGutter&&(b.style.zIndex=5,b.style.position="relative",a.noHScroll||(b.style.marginLeft=-d.gutterTotalWidth+"px"))}function V(a){return Kf(a.line,a.ch)}function W(a,b){return Lf(a,b)<0?b:a}function X(a,b){return Lf(a,b)<0?a:b}function Y(a){a.state.focused||(a.display.input.focus(),qc(a))}function Z(a,b,c,d,e){var f=a.doc;a.display.shift=!1,d||(d=f.sel);var g=a.state.pasteIncoming||"paste"==e,h=f.splitLines(b),i=null;if(g&&d.ranges.length>1)if(Mf&&Mf.join("\n")==b){if(d.ranges.length%Mf.length==0){i=[];for(var j=0;j<Mf.length;j++)i.push(f.splitLines(Mf[j]))}}else h.length==d.ranges.length&&(i=He(h,function(a){return[a]}));for(var j=d.ranges.length-1;j>=0;j--){var k=d.ranges[j],l=k.from(),m=k.to();k.empty()&&(c&&c>0?l=Kf(l.line,l.ch-c):a.state.overwrite&&!g&&(m=Kf(m.line,Math.min(Yd(f,m.line).text.length,m.ch+Fe(h).length))));var n=a.curOp.updateInput,o={from:l,to:m,text:i?i[j%i.length]:h,origin:e||(g?"paste":a.state.cutIncoming?"cut":"+input")};zc(a.doc,o),xe(a,"inputRead",a,o)}b&&!g&&_(a,b),Lc(a),a.curOp.updateInput=n,a.curOp.typing=!0,a.state.pasteIncoming=a.state.cutIncoming=!1}function $(a,b){var c=a.clipboardData&&a.clipboardData.getData("text/plain");if(c)return a.preventDefault(),b.isReadOnly()||b.options.disableInput||Db(b,function(){Z(b,c,0,null,"paste")}),!0}function _(a,b){if(a.options.electricChars&&a.options.smartIndent)for(var c=a.doc.sel,d=c.ranges.length-1;d>=0;d--){var e=c.ranges[d];if(!(e.head.ch>100||d&&c.ranges[d-1].head.line==e.head.line)){var f=a.getModeAt(e.head),g=!1;if(f.electricChars){for(var h=0;h<f.electricChars.length;h++)if(b.indexOf(f.electricChars.charAt(h))>-1){g=Nc(a,e.head.line,"smart");break}}else f.electricInput&&f.electricInput.test(Yd(a.doc,e.head.line).text.slice(0,e.head.ch))&&(g=Nc(a,e.head.line,"smart"));g&&xe(a,"electricInput",a,e.head.line)}}}function aa(a){for(var b=[],c=[],d=0;d<a.doc.sel.ranges.length;d++){var e=a.doc.sel.ranges[d].head.line,f={anchor:Kf(e,0),head:Kf(e+1,0)};c.push(f),b.push(a.getRange(f.anchor,f.head))}return{text:b,ranges:c}}function ba(a){a.setAttribute("autocorrect","off"),a.setAttribute("autocapitalize","off"),a.setAttribute("spellcheck","false")}function ca(a){this.cm=a,this.prevInput="",this.pollingFast=!1,this.polling=new De,this.inaccurateSelection=!1,this.hasSelection=!1,this.composing=null}function da(){var a=Pe("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),b=Pe("div",[a],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return uf?a.style.width="1000px":a.setAttribute("wrap","off"),Bf&&(a.style.border="1px solid black"),ba(a),b}function ea(a){this.cm=a,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new De,this.gracePeriod=!1}function fa(a,b){var c=_a(a,b.line);if(!c||c.hidden)return null;var d=Yd(a.doc,b.line),e=Ya(c,d,b.line),f=de(d),g="left";if(f){g=jf(f,b.ch)%2?"right":"left"}var h=cb(e.map,b.ch,g);return h.offset="right"==h.collapse?h.end:h.start,h}function ga(a,b){return b&&(a.bad=!0),a}function ha(a,b,c){var d;if(b==a.display.lineDiv){if(!(d=a.display.lineDiv.childNodes[c]))return ga(a.clipPos(Kf(a.display.viewTo-1)),!0);b=null,c=0}else for(d=b;;d=d.parentNode){if(!d||d==a.display.lineDiv)return null;if(d.parentNode&&d.parentNode==a.display.lineDiv)break}for(var e=0;e<a.display.view.length;e++){var f=a.display.view[e];if(f.node==d)return ia(f,b,c)}}function ia(a,b,c){function d(b,c,d){for(var e=-1;e<(k?k.length:0);e++)for(var f=e<0?j.map:k[e],g=0;g<f.length;g+=3){var h=f[g+2];if(h==b||h==c){var i=ae(e<0?a.line:a.rest[e]),l=f[g]+d;return(d<0||h!=b)&&(l=f[g+(d?1:0)]),Kf(i,l)}}}var e=a.text.firstChild,f=!1;if(!b||!Ug(e,b))return ga(Kf(ae(a.line),0),!0);if(b==e&&(f=!0,b=e.childNodes[c],c=0,!b)){var g=a.rest?Fe(a.rest):a.line;return ga(Kf(ae(g),g.text.length),f)}var h=3==b.nodeType?b:null,i=b;for(h||1!=b.childNodes.length||3!=b.firstChild.nodeType||(h=b.firstChild,c&&(c=h.nodeValue.length));i.parentNode!=e;)i=i.parentNode;var j=a.measure,k=j.maps,l=d(h,i,c);if(l)return ga(l,f);for(var m=i.nextSibling,n=h?h.nodeValue.length-c:0;m;m=m.nextSibling){if(l=d(m,m.firstChild,0))return ga(Kf(l.line,l.ch-n),f);n+=m.textContent.length}for(var o=i.previousSibling,n=c;o;o=o.previousSibling){if(l=d(o,o.firstChild,-1))return ga(Kf(l.line,l.ch+n),f);n+=m.textContent.length}}function ja(a,b,c,d,e){function f(a){return function(b){return b.id==a}}function g(b){if(1==b.nodeType){var c=b.getAttribute("cm-text");if(null!=c)return""==c&&(c=b.textContent.replace(/\u200b/g,"")),void(h+=c);var k,l=b.getAttribute("cm-marker");if(l){var m=a.findMarks(Kf(d,0),Kf(e+1,0),f(+l));return void(m.length&&(k=m[0].find())&&(h+=Zd(a.doc,k.from,k.to).join(j)))}if("false"==b.getAttribute("contenteditable"))return;for(var n=0;n<b.childNodes.length;n++)g(b.childNodes[n]);/^(pre|div|p)$/i.test(b.nodeName)&&(i=!0)}else if(3==b.nodeType){var o=b.nodeValue;if(!o)return;i&&(h+=j,i=!1),h+=o}}for(var h="",i=!1,j=a.doc.lineSeparator();g(b),b!=c;)b=b.nextSibling;return h}function ka(a,b){this.ranges=a,this.primIndex=b}function la(a,b){this.anchor=a,this.head=b}function ma(a,b){var c=a[b];a.sort(function(a,b){return Lf(a.from(),b.from())}),b=Ge(a,c);for(var d=1;d<a.length;d++){var e=a[d],f=a[d-1];if(Lf(f.to(),e.from())>=0){var g=X(f.from(),e.from()),h=W(f.to(),e.to()),i=f.empty()?e.from()==e.head:f.from()==f.head;d<=b&&--b,a.splice(--d,2,new la(i?h:g,i?g:h))}}return new ka(a,b)}function na(a,b){return new ka([new la(a,b||a)],0)}function oa(a,b){return Math.max(a.first,Math.min(b,a.first+a.size-1))}function pa(a,b){if(b.line<a.first)return Kf(a.first,0);var c=a.first+a.size-1;return b.line>c?Kf(c,Yd(a,c).text.length):qa(b,Yd(a,b.line).text.length)}function qa(a,b){var c=a.ch;return null==c||c>b?Kf(a.line,b):c<0?Kf(a.line,0):a}function ra(a,b){return b>=a.first&&b<a.first+a.size}function sa(a,b){for(var c=[],d=0;d<b.length;d++)c[d]=pa(a,b[d]);return c}function ta(a,b,c,d){if(a.cm&&a.cm.display.shift||a.extend){var e=b.anchor;if(d){var f=Lf(c,e)<0;f!=Lf(d,e)<0?(e=c,c=d):f!=Lf(c,d)<0&&(c=d)}return new la(e,c)}return new la(d||c,c)}function ua(a,b,c,d){Aa(a,new ka([ta(a,a.sel.primary(),b,c)],0),d)}function va(a,b,c){for(var d=[],e=0;e<a.sel.ranges.length;e++)d[e]=ta(a,a.sel.ranges[e],b[e],null);Aa(a,ma(d,a.sel.primIndex),c)}function wa(a,b,c,d){var e=a.sel.ranges.slice(0);e[b]=c,Aa(a,ma(e,a.sel.primIndex),d)}function xa(a,b,c,d){Aa(a,na(b,c),d)}function ya(a,b,c){var d={ranges:b.ranges,update:function(b){this.ranges=[];for(var c=0;c<b.length;c++)this.ranges[c]=new la(pa(a,b[c].anchor),pa(a,b[c].head))},origin:c&&c.origin};return Fg(a,"beforeSelectionChange",a,d),a.cm&&Fg(a.cm,"beforeSelectionChange",a.cm,d),d.ranges!=b.ranges?ma(d.ranges,d.ranges.length-1):b}function za(a,b,c){var d=a.history.done,e=Fe(d);e&&e.ranges?(d[d.length-1]=b,Ba(a,b,c)):Aa(a,b,c)}function Aa(a,b,c){Ba(a,b,c),ke(a,a.sel,a.cm?a.cm.curOp.id:NaN,c)}function Ba(a,b,c){(Be(a,"beforeSelectionChange")||a.cm&&Be(a.cm,"beforeSelectionChange"))&&(b=ya(a,b,c)),Ca(a,Ea(a,b,c&&c.bias||(Lf(b.primary().head,a.sel.primary().head)<0?-1:1),!0)),c&&c.scroll===!1||!a.cm||Lc(a.cm)}function Ca(a,b){b.equals(a.sel)||(a.sel=b,a.cm&&(a.cm.curOp.updateInput=a.cm.curOp.selectionChanged=!0,Ae(a.cm)),xe(a,"cursorActivity",a))}function Da(a){Ca(a,Ea(a,a.sel,null,!1),Jg)}function Ea(a,b,c,d){for(var e,f=0;f<b.ranges.length;f++){var g=b.ranges[f],h=b.ranges.length==a.sel.ranges.length&&a.sel.ranges[f],i=Ga(a,g.anchor,h&&h.anchor,c,d),j=Ga(a,g.head,h&&h.head,c,d);(e||i!=g.anchor||j!=g.head)&&(e||(e=b.ranges.slice(0,f)),e[f]=new la(i,j))}return e?ma(e,b.primIndex):b}function Fa(a,b,c,d,e){var f=Yd(a,b.line);if(f.markedSpans)for(var g=0;g<f.markedSpans.length;++g){var h=f.markedSpans[g],i=h.marker;if((null==h.from||(i.inclusiveLeft?h.from<=b.ch:h.from<b.ch))&&(null==h.to||(i.inclusiveRight?h.to>=b.ch:h.to>b.ch))){if(e&&(Fg(i,"beforeCursorEnter"),i.explicitlyCleared)){if(f.markedSpans){--g;continue}break}if(!i.atomic)continue;if(c){var j,k=i.find(d<0?1:-1);if((d<0?i.inclusiveRight:i.inclusiveLeft)&&(k=Ha(a,k,-d,k&&k.line==b.line?f:null)),k&&k.line==b.line&&(j=Lf(k,c))&&(d<0?j<0:j>0))return Fa(a,k,b,d,e)}var l=i.find(d<0?-1:1);return(d<0?i.inclusiveLeft:i.inclusiveRight)&&(l=Ha(a,l,d,l.line==b.line?f:null)),l?Fa(a,l,b,d,e):null}}return b}function Ga(a,b,c,d,e){var f=d||1,g=Fa(a,b,c,f,e)||!e&&Fa(a,b,c,f,!0)||Fa(a,b,c,-f,e)||!e&&Fa(a,b,c,-f,!0);return g||(a.cantEdit=!0,Kf(a.first,0))}function Ha(a,b,c,d){return c<0&&0==b.ch?b.line>a.first?pa(a,Kf(b.line-1)):null:c>0&&b.ch==(d||Yd(a,b.line)).text.length?b.line<a.first+a.size-1?Kf(b.line+1,0):null:new Kf(b.line,b.ch+c)}function Ia(a){a.display.input.showSelection(a.display.input.prepareSelection())}function Ja(a,b){for(var c=a.doc,d={},e=d.cursors=document.createDocumentFragment(),f=d.selection=document.createDocumentFragment(),g=0;g<c.sel.ranges.length;g++)if(b!==!1||g!=c.sel.primIndex){var h=c.sel.ranges[g];if(!(h.from().line>=a.display.viewTo||h.to().line<a.display.viewFrom)){var i=h.empty();(i||a.options.showCursorWhenSelecting)&&Ka(a,h.head,e),i||La(a,h,f)}}return d}function Ka(a,b,c){var d=nb(a,b,"div",null,null,!a.options.singleCursorHeightPerLine),e=c.appendChild(Pe("div"," ","CodeMirror-cursor"));if(e.style.left=d.left+"px",e.style.top=d.top+"px",e.style.height=Math.max(0,d.bottom-d.top)*a.options.cursorHeight+"px",d.other){var f=c.appendChild(Pe("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));f.style.display="",f.style.left=d.other.left+"px",f.style.top=d.other.top+"px",f.style.height=.85*(d.other.bottom-d.other.top)+"px"}}function La(a,b,c){function d(a,b,c,d){b<0&&(b=0),b=Math.round(b),d=Math.round(d),h.appendChild(Pe("div",null,"CodeMirror-selected","position: absolute; left: "+a+"px; top: "+b+"px; width: "+(null==c?k-a:c)+"px; height: "+(d-b)+"px"))}function e(b,c,e){function f(c,d){return mb(a,Kf(b,c),"div",l,d)}var h,i,l=Yd(g,b),m=l.text.length;return _e(de(l),c||0,null==e?m:e,function(a,b,g){var l,n,o,p=f(a,"left");if(a==b)l=p,n=o=p.left;else{if(l=f(b-1,"right"),"rtl"==g){var q=p;p=l,l=q}n=p.left,o=l.right}null==c&&0==a&&(n=j),l.top-p.top>3&&(d(n,p.top,null,p.bottom),n=j,p.bottom<l.top&&d(n,p.bottom,null,l.top)),null==e&&b==m&&(o=k),(!h||p.top<h.top||p.top==h.top&&p.left<h.left)&&(h=p),(!i||l.bottom>i.bottom||l.bottom==i.bottom&&l.right>i.right)&&(i=l),n<j+1&&(n=j),d(n,l.top,o-n,l.bottom)}),{start:h,end:i}}var f=a.display,g=a.doc,h=document.createDocumentFragment(),i=Ta(a.display),j=i.left,k=Math.max(f.sizerWidth,Va(a)-f.sizer.offsetLeft)-i.right,l=b.from(),m=b.to();if(l.line==m.line)e(l.line,l.ch,m.ch);else{var n=Yd(g,l.line),o=Yd(g,m.line),p=rd(n)==rd(o),q=e(l.line,l.ch,p?n.text.length+1:null).end,r=e(m.line,p?0:null,m.ch).start;p&&(q.top<r.top-2?(d(q.right,q.top,null,q.bottom),d(j,r.top,r.left,r.bottom)):d(q.right,q.top,r.left-q.right,q.bottom)),q.bottom<r.top&&d(j,q.bottom,null,r.top)}c.appendChild(h)}function Ma(a){if(a.state.focused){var b=a.display;clearInterval(b.blinker);var c=!0;b.cursorDiv.style.visibility="",a.options.cursorBlinkRate>0?b.blinker=setInterval(function(){b.cursorDiv.style.visibility=(c=!c)?"":"hidden"},a.options.cursorBlinkRate):a.options.cursorBlinkRate<0&&(b.cursorDiv.style.visibility="hidden")}}function Na(a,b){a.doc.mode.startState&&a.doc.frontier<a.display.viewTo&&a.state.highlight.set(b,Le(Oa,a))}function Oa(a){var b=a.doc;if(b.frontier<b.first&&(b.frontier=b.first),!(b.frontier>=a.display.viewTo)){var c=+new Date+a.options.workTime,d=gg(b.mode,Qa(a,b.frontier)),e=[];b.iter(b.frontier,Math.min(b.first+b.size,a.display.viewTo+500),function(f){if(b.frontier>=a.display.viewFrom){var g=f.styles,h=f.text.length>a.options.maxHighlightLength,i=Hd(a,f,h?gg(b.mode,d):d,!0);f.styles=i.styles;var j=f.styleClasses,k=i.classes;k?f.styleClasses=k:j&&(f.styleClasses=null);for(var l=!g||g.length!=f.styles.length||j!=k&&(!j||!k||j.bgClass!=k.bgClass||j.textClass!=k.textClass),m=0;!l&&m<g.length;++m)l=g[m]!=f.styles[m];l&&e.push(b.frontier),f.stateAfter=h?d:gg(b.mode,d)}else f.text.length<=a.options.maxHighlightLength&&Jd(a,f.text,d),f.stateAfter=b.frontier%5==0?gg(b.mode,d):null;if(++b.frontier,+new Date>c)return Na(a,a.options.workDelay),!0}),e.length&&Db(a,function(){for(var b=0;b<e.length;b++)Kb(a,e[b],"text")})}}function Pa(a,b,c){for(var d,e,f=a.doc,g=a.doc.mode.preciseStartState||c?-1:b-(a.doc.mode.innerMode?1e3:100),h=b;h>g;--h){if(h<=f.first)return f.first;var i=Yd(f,h-1);if(i.stateAfter&&(!c||h<=f.frontier))return h;var j=Mg(i.text,null,a.options.tabSize);(null==e||d>j)&&(e=h-1,d=j)}return e}function Qa(a,b,c){var d=a.doc,e=a.display;if(!d.mode.startState)return!0;var f=Pa(a,b,c),g=f>d.first&&Yd(d,f-1).stateAfter;return g=g?gg(d.mode,g):hg(d.mode),d.iter(f,b,function(c){Jd(a,c.text,g);var h=f==b-1||f%5==0||f>=e.viewFrom&&f<e.viewTo;c.stateAfter=h?gg(d.mode,g):null,++f}),c&&!a.doc.mode.noUpdateFrontier&&(d.frontier=f),g}function Ra(a){return a.lineSpace.offsetTop}function Sa(a){return a.mover.offsetHeight-a.lineSpace.offsetHeight}function Ta(a){if(a.cachedPaddingH)return a.cachedPaddingH;var b=Re(a.measure,Pe("pre","x")),c=window.getComputedStyle?window.getComputedStyle(b):b.currentStyle,d={left:parseInt(c.paddingLeft),right:parseInt(c.paddingRight)};return isNaN(d.left)||isNaN(d.right)||(a.cachedPaddingH=d),d}function Ua(a){return Hg-a.display.nativeBarWidth}function Va(a){return a.display.scroller.clientWidth-Ua(a)-a.display.barWidth}function Wa(a){return a.display.scroller.clientHeight-Ua(a)-a.display.barHeight}function Xa(a,b,c){var d=a.options.lineWrapping,e=d&&Va(a);if(!b.measure.heights||d&&b.measure.width!=e){var f=b.measure.heights=[];if(d){b.measure.width=e;for(var g=b.text.firstChild.getClientRects(),h=0;h<g.length-1;h++){var i=g[h],j=g[h+1];Math.abs(i.bottom-j.bottom)>2&&f.push((i.bottom+j.top)/2-c.top)}}f.push(c.bottom-c.top)}}function Ya(a,b,c){if(a.line==b)return{map:a.measure.map,cache:a.measure.cache};for(var d=0;d<a.rest.length;d++)if(a.rest[d]==b)return{map:a.measure.maps[d],cache:a.measure.caches[d]};for(var d=0;d<a.rest.length;d++)if(ae(a.rest[d])>c)return{map:a.measure.maps[d],cache:a.measure.caches[d],before:!0}}function Za(a,b){b=rd(b);var c=ae(b),d=a.display.externalMeasured=new Hb(a.doc,b,c);d.lineN=c;var e=d.built=Ld(a,d);return d.text=e.pre,Re(a.display.lineMeasure,e.pre),d}function $a(a,b,c,d){return bb(a,ab(a,b),c,d)}function _a(a,b){if(b>=a.display.viewFrom&&b<a.display.viewTo)return a.display.view[Mb(a,b)];var c=a.display.externalMeasured;return c&&b>=c.lineN&&b<c.lineN+c.size?c:void 0}function ab(a,b){var c=ae(b),d=_a(a,c);d&&!d.text?d=null:d&&d.changes&&(J(a,d,c,H(a)),a.curOp.forceUpdate=!0),d||(d=Za(a,b));var e=Ya(d,b,c);return{line:b,view:d,rect:null,map:e.map,cache:e.cache,before:e.before,hasHeights:!1}}function bb(a,b,c,d,e){b.before&&(c=-1);var f,g=c+(d||"");return b.cache.hasOwnProperty(g)?f=b.cache[g]:(b.rect||(b.rect=b.view.text.getBoundingClientRect()),b.hasHeights||(Xa(a,b.view,b.rect),b.hasHeights=!0),f=db(a,b,c,d),f.bogus||(b.cache[g]=f)),{left:f.left,right:f.right,top:e?f.rtop:f.top,bottom:e?f.rbottom:f.bottom}}function cb(a,b,c){for(var d,e,f,g,h=0;h<a.length;h+=3){var i=a[h],j=a[h+1];if(b<i?(e=0,f=1,g="left"):b<j?(e=b-i,f=e+1):(h==a.length-3||b==j&&a[h+3]>b)&&(f=j-i,e=f-1,b>=j&&(g="right")),null!=e){if(d=a[h+2],i==j&&c==(d.insertLeft?"left":"right")&&(g=c),"left"==c&&0==e)for(;h&&a[h-2]==a[h-3]&&a[h-1].insertLeft;)d=a[2+(h-=3)],g="left";if("right"==c&&e==j-i)for(;h<a.length-3&&a[h+3]==a[h+4]&&!a[h+5].insertLeft;)d=a[(h+=3)+2],g="right";break}}return{node:d,start:e,end:f,collapse:g,coverStart:i,coverEnd:j}}function db(a,b,c,d){var e,f=cb(b.map,c,d),g=f.node,h=f.start,i=f.end,j=f.collapse;if(3==g.nodeType){for(var k=0;k<4;k++){for(;h&&Oe(b.line.text.charAt(f.coverStart+h));)--h;for(;f.coverStart+i<f.coverEnd&&Oe(b.line.text.charAt(f.coverStart+i));)++i
;if(sf&&tf<9&&0==h&&i==f.coverEnd-f.coverStart)e=g.parentNode.getBoundingClientRect();else if(sf&&a.options.lineWrapping){var l=Qg(g,h,i).getClientRects();e=l.length?l["right"==d?l.length-1:0]:Qf}else e=Qg(g,h,i).getBoundingClientRect()||Qf;if(e.left||e.right||0==h)break;i=h,h-=1,j="right"}sf&&tf<11&&(e=eb(a.display.measure,e))}else{h>0&&(j=d="right");var l;e=a.options.lineWrapping&&(l=g.getClientRects()).length>1?l["right"==d?l.length-1:0]:g.getBoundingClientRect()}if(sf&&tf<9&&!h&&(!e||!e.left&&!e.right)){var m=g.parentNode.getClientRects()[0];e=m?{left:m.left,right:m.left+tb(a.display),top:m.top,bottom:m.bottom}:Qf}for(var n=e.top-b.rect.top,o=e.bottom-b.rect.top,p=(n+o)/2,q=b.view.measure.heights,k=0;k<q.length-1&&!(p<q[k]);k++);var r=k?q[k-1]:0,s=q[k],t={left:("right"==j?e.right:e.left)-b.rect.left,right:("left"==j?e.left:e.right)-b.rect.left,top:r,bottom:s};return e.left||e.right||(t.bogus=!0),a.options.singleCursorHeightPerLine||(t.rtop=n,t.rbottom=o),t}function eb(a,b){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!$e(a))return b;var c=screen.logicalXDPI/screen.deviceXDPI,d=screen.logicalYDPI/screen.deviceYDPI;return{left:b.left*c,right:b.right*c,top:b.top*d,bottom:b.bottom*d}}function fb(a){if(a.measure&&(a.measure.cache={},a.measure.heights=null,a.rest))for(var b=0;b<a.rest.length;b++)a.measure.caches[b]={}}function gb(a){a.display.externalMeasure=null,Qe(a.display.lineMeasure);for(var b=0;b<a.display.view.length;b++)fb(a.display.view[b])}function hb(a){gb(a),a.display.cachedCharWidth=a.display.cachedTextHeight=a.display.cachedPaddingH=null,a.options.lineWrapping||(a.display.maxLineChanged=!0),a.display.lineNumChars=null}function ib(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function jb(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function kb(a,b,c,d){if(b.widgets)for(var e=0;e<b.widgets.length;++e)if(b.widgets[e].above){var f=yd(b.widgets[e]);c.top+=f,c.bottom+=f}if("line"==d)return c;d||(d="local");var g=ce(b);if("local"==d?g+=Ra(a.display):g-=a.display.viewOffset,"page"==d||"window"==d){var h=a.display.lineSpace.getBoundingClientRect();g+=h.top+("window"==d?0:jb());var i=h.left+("window"==d?0:ib());c.left+=i,c.right+=i}return c.top+=g,c.bottom+=g,c}function lb(a,b,c){if("div"==c)return b;var d=b.left,e=b.top;if("page"==c)d-=ib(),e-=jb();else if("local"==c||!c){var f=a.display.sizer.getBoundingClientRect();d+=f.left,e+=f.top}var g=a.display.lineSpace.getBoundingClientRect();return{left:d-g.left,top:e-g.top}}function mb(a,b,c,d,e){return d||(d=Yd(a.doc,b.line)),kb(a,d,$a(a,d,b.ch,e),c)}function nb(a,b,c,d,e,f){function g(b,g){var h=bb(a,e,b,g?"right":"left",f);return g?h.left=h.right:h.right=h.left,kb(a,d,h,c)}function h(a,b){var c=i[b],d=c.level%2;return a==af(c)&&b&&c.level<i[b-1].level?(c=i[--b],a=bf(c)-(c.level%2?0:1),d=!0):a==bf(c)&&b<i.length-1&&c.level<i[b+1].level&&(c=i[++b],a=af(c)-c.level%2,d=!1),d&&a==c.to&&a>c.from?g(a-1):g(a,d)}d=d||Yd(a.doc,b.line),e||(e=ab(a,d));var i=de(d),j=b.ch;if(!i)return g(j);var k=jf(i,j),l=h(j,k);return null!=eh&&(l.other=h(j,eh)),l}function ob(a,b){var c=0,b=pa(a.doc,b);a.options.lineWrapping||(c=tb(a.display)*b.ch);var d=Yd(a.doc,b.line),e=ce(d)+Ra(a.display);return{left:c,right:c,top:e,bottom:e+d.height}}function pb(a,b,c,d){var e=Kf(a,b);return e.xRel=d,c&&(e.outside=!0),e}function qb(a,b,c){var d=a.doc;if((c+=a.display.viewOffset)<0)return pb(d.first,0,!0,-1);var e=be(d,c),f=d.first+d.size-1;if(e>f)return pb(d.first+d.size-1,Yd(d,f).text.length,!0,1);b<0&&(b=0);for(var g=Yd(d,e);;){var h=rb(a,g,e,b,c),i=pd(g),j=i&&i.find(0,!0);if(!i||!(h.ch>j.from.ch||h.ch==j.from.ch&&h.xRel>0))return h;e=ae(g=j.to.line)}}function rb(a,b,c,d,e){function f(d){var e=nb(a,Kf(c,d),"line",b,j);return h=!0,g>e.bottom?e.left-i:g<e.top?e.left+i:(h=!1,e.left)}var g=e-ce(b),h=!1,i=2*a.display.wrapper.clientWidth,j=ab(a,b),k=de(b),l=b.text.length,m=cf(b),n=df(b),o=f(m),p=h,q=f(n),r=h;if(d>q)return pb(c,n,r,1);for(;;){if(k?n==m||n==lf(b,m,1):n-m<=1){for(var s=d<o||d-o<=q-d?m:n,t=d-(s==m?o:q);Oe(b.text.charAt(s));)++s;return pb(c,s,s==m?p:r,t<-1?-1:t>1?1:0)}var u=Math.ceil(l/2),v=m+u;if(k){v=m;for(var w=0;w<u;++w)v=lf(b,v,1)}var x=f(v);x>d?(n=v,q=x,(r=h)&&(q+=1e3),l=u):(m=v,o=x,p=h,l-=u)}}function sb(a){if(null!=a.cachedTextHeight)return a.cachedTextHeight;if(null==Nf){Nf=Pe("pre");for(var b=0;b<49;++b)Nf.appendChild(document.createTextNode("x")),Nf.appendChild(Pe("br"));Nf.appendChild(document.createTextNode("x"))}Re(a.measure,Nf);var c=Nf.offsetHeight/50;return c>3&&(a.cachedTextHeight=c),Qe(a.measure),c||1}function tb(a){if(null!=a.cachedCharWidth)return a.cachedCharWidth;var b=Pe("span","xxxxxxxxxx"),c=Pe("pre",[b]);Re(a.measure,c);var d=b.getBoundingClientRect(),e=(d.right-d.left)/10;return e>2&&(a.cachedCharWidth=e),e||10}function ub(a){a.curOp={cm:a,viewChanged:!1,startHeight:a.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Sf},Rf?Rf.ops.push(a.curOp):a.curOp.ownsGroup=Rf={ops:[a.curOp],delayedCallbacks:[]}}function vb(a){var b=a.delayedCallbacks,c=0;do{for(;c<b.length;c++)b[c].call(null);for(var d=0;d<a.ops.length;d++){var e=a.ops[d];if(e.cursorActivityHandlers)for(;e.cursorActivityCalled<e.cursorActivityHandlers.length;)e.cursorActivityHandlers[e.cursorActivityCalled++].call(null,e.cm)}}while(c<b.length)}function wb(a){var b=a.curOp,c=b.ownsGroup;if(c)try{vb(c)}finally{Rf=null;for(var d=0;d<c.ops.length;d++)c.ops[d].cm.curOp=null;xb(c)}}function xb(a){for(var b=a.ops,c=0;c<b.length;c++)yb(b[c]);for(var c=0;c<b.length;c++)zb(b[c]);for(var c=0;c<b.length;c++)Ab(b[c]);for(var c=0;c<b.length;c++)Bb(b[c]);for(var c=0;c<b.length;c++)Cb(b[c])}function yb(a){var b=a.cm,c=b.display;A(b),a.updateMaxLine&&m(b),a.mustUpdate=a.viewChanged||a.forceUpdate||null!=a.scrollTop||a.scrollToPos&&(a.scrollToPos.from.line<c.viewFrom||a.scrollToPos.to.line>=c.viewTo)||c.maxLineChanged&&b.options.lineWrapping,a.update=a.mustUpdate&&new z(b,a.mustUpdate&&{top:a.scrollTop,ensure:a.scrollToPos},a.forceUpdate)}function zb(a){a.updatedDisplay=a.mustUpdate&&B(a.cm,a.update)}function Ab(a){var b=a.cm,c=b.display;a.updatedDisplay&&F(b),a.barMeasure=o(b),c.maxLineChanged&&!b.options.lineWrapping&&(a.adjustWidthTo=$a(b,c.maxLine,c.maxLine.text.length).left+3,b.display.sizerWidth=a.adjustWidthTo,a.barMeasure.scrollWidth=Math.max(c.scroller.clientWidth,c.sizer.offsetLeft+a.adjustWidthTo+Ua(b)+b.display.barWidth),a.maxScrollLeft=Math.max(0,c.sizer.offsetLeft+a.adjustWidthTo-Va(b))),(a.updatedDisplay||a.selectionChanged)&&(a.preparedSelection=c.input.prepareSelection())}function Bb(a){var b=a.cm;null!=a.adjustWidthTo&&(b.display.sizer.style.minWidth=a.adjustWidthTo+"px",a.maxScrollLeft<b.doc.scrollLeft&&ec(b,Math.min(b.display.scroller.scrollLeft,a.maxScrollLeft),!0),b.display.maxLineChanged=!1),a.preparedSelection&&b.display.input.showSelection(a.preparedSelection),(a.updatedDisplay||a.startHeight!=b.doc.height)&&s(b,a.barMeasure),a.updatedDisplay&&E(b,a.barMeasure),a.selectionChanged&&Ma(b),b.state.focused&&a.updateInput&&b.display.input.reset(a.typing),!a.focus||a.focus!=Se()||document.hasFocus&&!document.hasFocus()||Y(a.cm)}function Cb(a){var b=a.cm,c=b.display,d=b.doc;if(a.updatedDisplay&&C(b,a.update),null==c.wheelStartX||null==a.scrollTop&&null==a.scrollLeft&&!a.scrollToPos||(c.wheelStartX=c.wheelStartY=null),null==a.scrollTop||c.scroller.scrollTop==a.scrollTop&&!a.forceScroll||(d.scrollTop=Math.max(0,Math.min(c.scroller.scrollHeight-c.scroller.clientHeight,a.scrollTop)),c.scrollbars.setScrollTop(d.scrollTop),c.scroller.scrollTop=d.scrollTop),null==a.scrollLeft||c.scroller.scrollLeft==a.scrollLeft&&!a.forceScroll||(d.scrollLeft=Math.max(0,Math.min(c.scroller.scrollWidth-c.scroller.clientWidth,a.scrollLeft)),c.scrollbars.setScrollLeft(d.scrollLeft),c.scroller.scrollLeft=d.scrollLeft,v(b)),a.scrollToPos){var e=Hc(b,pa(d,a.scrollToPos.from),pa(d,a.scrollToPos.to),a.scrollToPos.margin);a.scrollToPos.isCursor&&b.state.focused&&Gc(b,e)}var f=a.maybeHiddenMarkers,g=a.maybeUnhiddenMarkers;if(f)for(var h=0;h<f.length;++h)f[h].lines.length||Fg(f[h],"hide");if(g)for(var h=0;h<g.length;++h)g[h].lines.length&&Fg(g[h],"unhide");c.wrapper.offsetHeight&&(d.scrollTop=b.display.scroller.scrollTop),a.changeObjs&&Fg(b,"changes",b,a.changeObjs),a.update&&a.update.finish()}function Db(a,b){if(a.curOp)return b();ub(a);try{return b()}finally{wb(a)}}function Eb(a,b){return function(){if(a.curOp)return b.apply(a,arguments);ub(a);try{return b.apply(a,arguments)}finally{wb(a)}}}function Fb(a){return function(){if(this.curOp)return a.apply(this,arguments);ub(this);try{return a.apply(this,arguments)}finally{wb(this)}}}function Gb(a){return function(){var b=this.cm;if(!b||b.curOp)return a.apply(this,arguments);ub(b);try{return a.apply(this,arguments)}finally{wb(b)}}}function Hb(a,b,c){this.line=b,this.rest=sd(b),this.size=this.rest?ae(Fe(this.rest))-c+1:1,this.node=this.text=null,this.hidden=vd(a,b)}function Ib(a,b,c){for(var d,e=[],f=b;f<c;f=d){var g=new Hb(a.doc,Yd(a.doc,f),f);d=f+g.size,e.push(g)}return e}function Jb(a,b,c,d){null==b&&(b=a.doc.first),null==c&&(c=a.doc.first+a.doc.size),d||(d=0);var e=a.display;if(d&&c<e.viewTo&&(null==e.updateLineNumbers||e.updateLineNumbers>b)&&(e.updateLineNumbers=b),a.curOp.viewChanged=!0,b>=e.viewTo)Jf&&td(a.doc,b)<e.viewTo&&Lb(a);else if(c<=e.viewFrom)Jf&&ud(a.doc,c+d)>e.viewFrom?Lb(a):(e.viewFrom+=d,e.viewTo+=d);else if(b<=e.viewFrom&&c>=e.viewTo)Lb(a);else if(b<=e.viewFrom){var f=Nb(a,c,c+d,1);f?(e.view=e.view.slice(f.index),e.viewFrom=f.lineN,e.viewTo+=d):Lb(a)}else if(c>=e.viewTo){var f=Nb(a,b,b,-1);f?(e.view=e.view.slice(0,f.index),e.viewTo=f.lineN):Lb(a)}else{var g=Nb(a,b,b,-1),h=Nb(a,c,c+d,1);g&&h?(e.view=e.view.slice(0,g.index).concat(Ib(a,g.lineN,h.lineN)).concat(e.view.slice(h.index)),e.viewTo+=d):Lb(a)}var i=e.externalMeasured;i&&(c<i.lineN?i.lineN+=d:b<i.lineN+i.size&&(e.externalMeasured=null))}function Kb(a,b,c){a.curOp.viewChanged=!0;var d=a.display,e=a.display.externalMeasured;if(e&&b>=e.lineN&&b<e.lineN+e.size&&(d.externalMeasured=null),!(b<d.viewFrom||b>=d.viewTo)){var f=d.view[Mb(a,b)];if(null!=f.node){var g=f.changes||(f.changes=[]);Ge(g,c)==-1&&g.push(c)}}}function Lb(a){a.display.viewFrom=a.display.viewTo=a.doc.first,a.display.view=[],a.display.viewOffset=0}function Mb(a,b){if(b>=a.display.viewTo)return null;if((b-=a.display.viewFrom)<0)return null;for(var c=a.display.view,d=0;d<c.length;d++)if((b-=c[d].size)<0)return d}function Nb(a,b,c,d){var e,f=Mb(a,b),g=a.display.view;if(!Jf||c==a.doc.first+a.doc.size)return{index:f,lineN:c};for(var h=0,i=a.display.viewFrom;h<f;h++)i+=g[h].size;if(i!=b){if(d>0){if(f==g.length-1)return null;e=i+g[f].size-b,f++}else e=i-b;b+=e,c+=e}for(;td(a.doc,c)!=c;){if(f==(d<0?0:g.length-1))return null;c+=d*g[f-(d<0?1:0)].size,f+=d}return{index:f,lineN:c}}function Ob(a,b,c){var d=a.display;0==d.view.length||b>=d.viewTo||c<=d.viewFrom?(d.view=Ib(a,b,c),d.viewFrom=b):(d.viewFrom>b?d.view=Ib(a,b,d.viewFrom).concat(d.view):d.viewFrom<b&&(d.view=d.view.slice(Mb(a,b))),d.viewFrom=b,d.viewTo<c?d.view=d.view.concat(Ib(a,d.viewTo,c)):d.viewTo>c&&(d.view=d.view.slice(0,Mb(a,c)))),d.viewTo=c}function Pb(a){for(var b=a.display.view,c=0,d=0;d<b.length;d++){var e=b[d];e.hidden||e.node&&!e.changes||++c}return c}function Qb(a){function b(){e.activeTouch&&(f=setTimeout(function(){e.activeTouch=null},1e3),g=e.activeTouch,g.end=+new Date)}function c(a){if(1!=a.touches.length)return!1;var b=a.touches[0];return b.radiusX<=1&&b.radiusY<=1}function d(a,b){if(null==b.left)return!0;var c=b.left-a.left,d=b.top-a.top;return c*c+d*d>400}var e=a.display;Cg(e.scroller,"mousedown",Eb(a,Vb)),sf&&tf<11?Cg(e.scroller,"dblclick",Eb(a,function(b){if(!ze(a,b)){var c=Ub(a,b);if(c&&!$b(a,b)&&!Tb(a.display,b)){zg(b);var d=a.findWordAt(c);ua(a.doc,d.anchor,d.head)}}})):Cg(e.scroller,"dblclick",function(b){ze(a,b)||zg(b)}),Hf||Cg(e.scroller,"contextmenu",function(b){sc(a,b)});var f,g={end:0};Cg(e.scroller,"touchstart",function(b){if(!ze(a,b)&&!c(b)){clearTimeout(f);var d=+new Date;e.activeTouch={start:d,moved:!1,prev:d-g.end<=300?g:null},1==b.touches.length&&(e.activeTouch.left=b.touches[0].pageX,e.activeTouch.top=b.touches[0].pageY)}}),Cg(e.scroller,"touchmove",function(){e.activeTouch&&(e.activeTouch.moved=!0)}),Cg(e.scroller,"touchend",function(c){var f=e.activeTouch;if(f&&!Tb(e,c)&&null!=f.left&&!f.moved&&new Date-f.start<300){var g,h=a.coordsChar(e.activeTouch,"page");g=!f.prev||d(f,f.prev)?new la(h,h):!f.prev.prev||d(f,f.prev.prev)?a.findWordAt(h):new la(Kf(h.line,0),pa(a.doc,Kf(h.line+1,0))),a.setSelection(g.anchor,g.head),a.focus(),zg(c)}b()}),Cg(e.scroller,"touchcancel",b),Cg(e.scroller,"scroll",function(){e.scroller.clientHeight&&(dc(a,e.scroller.scrollTop),ec(a,e.scroller.scrollLeft,!0),Fg(a,"scroll",a))}),Cg(e.scroller,"mousewheel",function(b){fc(a,b)}),Cg(e.scroller,"DOMMouseScroll",function(b){fc(a,b)}),Cg(e.wrapper,"scroll",function(){e.wrapper.scrollTop=e.wrapper.scrollLeft=0}),e.dragFunctions={enter:function(b){ze(a,b)||Bg(b)},over:function(b){ze(a,b)||(bc(a,b),Bg(b))},start:function(b){ac(a,b)},drop:Eb(a,_b),leave:function(b){ze(a,b)||cc(a)}};var h=e.input.getField();Cg(h,"keyup",function(b){nc.call(a,b)}),Cg(h,"keydown",Eb(a,lc)),Cg(h,"keypress",Eb(a,oc)),Cg(h,"focus",Le(qc,a)),Cg(h,"blur",Le(rc,a))}function Rb(b,c,d){if(!c!=!(d&&d!=a.Init)){var e=b.display.dragFunctions,f=c?Cg:Eg;f(b.display.scroller,"dragstart",e.start),f(b.display.scroller,"dragenter",e.enter),f(b.display.scroller,"dragover",e.over),f(b.display.scroller,"dragleave",e.leave),f(b.display.scroller,"drop",e.drop)}}function Sb(a){var b=a.display;b.lastWrapHeight==b.wrapper.clientHeight&&b.lastWrapWidth==b.wrapper.clientWidth||(b.cachedCharWidth=b.cachedTextHeight=b.cachedPaddingH=null,b.scrollbarsClipped=!1,a.setSize())}function Tb(a,b){for(var c=ue(b);c!=a.wrapper;c=c.parentNode)if(!c||1==c.nodeType&&"true"==c.getAttribute("cm-ignore-events")||c.parentNode==a.sizer&&c!=a.mover)return!0}function Ub(a,b,c,d){var e=a.display;if(!c&&"true"==ue(b).getAttribute("cm-not-content"))return null;var f,g,h=e.lineSpace.getBoundingClientRect();try{f=b.clientX-h.left,g=b.clientY-h.top}catch(b){return null}var i,j=qb(a,f,g);if(d&&1==j.xRel&&(i=Yd(a.doc,j.line).text).length==j.ch){var k=Mg(i,i.length,a.options.tabSize)-i.length;j=Kf(j.line,Math.max(0,Math.round((f-Ta(a.display).left)/tb(a.display))-k))}return j}function Vb(a){var b=this,c=b.display;if(!(ze(b,a)||c.activeTouch&&c.input.supportsTouch())){if(c.shift=a.shiftKey,Tb(c,a))return void(uf||(c.scroller.draggable=!1,setTimeout(function(){c.scroller.draggable=!0},100)));if(!$b(b,a)){var d=Ub(b,a);switch(window.focus(),ve(a)){case 1:b.state.selectingText?b.state.selectingText(a):d?Wb(b,a,d):ue(a)==c.scroller&&zg(a);break;case 2:uf&&(b.state.lastMiddleDown=+new Date),d&&ua(b.doc,d),setTimeout(function(){c.input.focus()},20),zg(a);break;case 3:Hf?sc(b,a):pc(b)}}}}function Wb(a,b,c){sf?setTimeout(Le(Y,a),0):a.curOp.focus=Se();var d,e=+new Date;Pf&&Pf.time>e-400&&0==Lf(Pf.pos,c)?d="triple":Of&&Of.time>e-400&&0==Lf(Of.pos,c)?(d="double",Pf={time:e,pos:c}):(d="single",Of={time:e,pos:c});var f,g=a.doc.sel,h=Df?b.metaKey:b.ctrlKey;a.options.dragDrop&&$g&&!a.isReadOnly()&&"single"==d&&(f=g.contains(c))>-1&&(Lf((f=g.ranges[f]).from(),c)<0||c.xRel>0)&&(Lf(f.to(),c)>0||c.xRel<0)?Xb(a,b,c,h):Yb(a,b,c,d,h)}function Xb(a,b,c,d){var e=a.display,f=+new Date,g=Eb(a,function(h){uf&&(e.scroller.draggable=!1),a.state.draggingText=!1,Eg(document,"mouseup",g),Eg(e.scroller,"drop",g),Math.abs(b.clientX-h.clientX)+Math.abs(b.clientY-h.clientY)<10&&(zg(h),!d&&+new Date-200<f&&ua(a.doc,c),uf||sf&&9==tf?setTimeout(function(){document.body.focus(),e.input.focus()},20):e.input.focus())});uf&&(e.scroller.draggable=!0),a.state.draggingText=g,e.scroller.dragDrop&&e.scroller.dragDrop(),Cg(document,"mouseup",g),Cg(e.scroller,"drop",g)}function Yb(a,b,c,d,e){function f(b){if(0!=Lf(q,b))if(q=b,"rect"==d){for(var e=[],f=a.options.tabSize,g=Mg(Yd(j,c.line).text,c.ch,f),h=Mg(Yd(j,b.line).text,b.ch,f),i=Math.min(g,h),n=Math.max(g,h),o=Math.min(c.line,b.line),p=Math.min(a.lastLine(),Math.max(c.line,b.line));o<=p;o++){var r=Yd(j,o).text,s=Ng(r,i,f);i==n?e.push(new la(Kf(o,s),Kf(o,s))):r.length>s&&e.push(new la(Kf(o,s),Kf(o,Ng(r,n,f))))}e.length||e.push(new la(c,c)),Aa(j,ma(m.ranges.slice(0,l).concat(e),l),{origin:"*mouse",scroll:!1}),a.scrollIntoView(b)}else{var t=k,u=t.anchor,v=b;if("single"!=d){if("double"==d)var w=a.findWordAt(b);else var w=new la(Kf(b.line,0),pa(j,Kf(b.line+1,0)));Lf(w.anchor,u)>0?(v=w.head,u=X(t.from(),w.anchor)):(v=w.anchor,u=W(t.to(),w.head))}var e=m.ranges.slice(0);e[l]=new la(pa(j,u),v),Aa(j,ma(e,l),Kg)}}function g(b){var c=++s,e=Ub(a,b,!0,"rect"==d);if(e)if(0!=Lf(e,q)){a.curOp.focus=Se(),f(e);var h=u(i,j);(e.line>=h.to||e.line<h.from)&&setTimeout(Eb(a,function(){s==c&&g(b)}),150)}else{var k=b.clientY<r.top?-20:b.clientY>r.bottom?20:0;k&&setTimeout(Eb(a,function(){s==c&&(i.scroller.scrollTop+=k,g(b))}),50)}}function h(b){a.state.selectingText=!1,s=1/0,zg(b),i.input.focus(),Eg(document,"mousemove",t),Eg(document,"mouseup",v),j.history.lastSelOrigin=null}var i=a.display,j=a.doc;zg(b);var k,l,m=j.sel,n=m.ranges;if(e&&!b.shiftKey?(l=j.sel.contains(c),k=l>-1?n[l]:new la(c,c)):(k=j.sel.primary(),l=j.sel.primIndex),b.altKey)d="rect",e||(k=new la(c,c)),c=Ub(a,b,!0,!0),l=-1;else if("double"==d){var o=a.findWordAt(c);k=a.display.shift||j.extend?ta(j,k,o.anchor,o.head):o}else if("triple"==d){var p=new la(Kf(c.line,0),pa(j,Kf(c.line+1,0)));k=a.display.shift||j.extend?ta(j,k,p.anchor,p.head):p}else k=ta(j,k,c);e?l==-1?(l=n.length,Aa(j,ma(n.concat([k]),l),{scroll:!1,origin:"*mouse"})):n.length>1&&n[l].empty()&&"single"==d&&!b.shiftKey?(Aa(j,ma(n.slice(0,l).concat(n.slice(l+1)),0),{scroll:!1,origin:"*mouse"}),m=j.sel):wa(j,l,k,Kg):(l=0,Aa(j,new ka([k],0),Kg),m=j.sel);var q=c,r=i.wrapper.getBoundingClientRect(),s=0,t=Eb(a,function(a){ve(a)?g(a):h(a)}),v=Eb(a,h);a.state.selectingText=v,Cg(document,"mousemove",t),Cg(document,"mouseup",v)}function Zb(a,b,c,d){try{var e=b.clientX,f=b.clientY}catch(b){return!1}if(e>=Math.floor(a.display.gutters.getBoundingClientRect().right))return!1;d&&zg(b);var g=a.display,h=g.lineDiv.getBoundingClientRect();if(f>h.bottom||!Be(a,c))return te(b);f-=h.top-g.viewOffset;for(var i=0;i<a.options.gutters.length;++i){var j=g.gutters.childNodes[i];if(j&&j.getBoundingClientRect().right>=e){var k=be(a.doc,f),l=a.options.gutters[i];return Fg(a,c,a,k,l,b),te(b)}}}function $b(a,b){return Zb(a,b,"gutterClick",!0)}function _b(a){var b=this;if(cc(b),!ze(b,a)&&!Tb(b.display,a)){zg(a),sf&&(Tf=+new Date);var c=Ub(b,a,!0),d=a.dataTransfer.files;if(c&&!b.isReadOnly())if(d&&d.length&&window.FileReader&&window.File)for(var e=d.length,f=Array(e),g=0,h=0;h<e;++h)!function(a,d){if(!b.options.allowDropFileTypes||Ge(b.options.allowDropFileTypes,a.type)!=-1){var h=new FileReader;h.onload=Eb(b,function(){var a=h.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(a)&&(a=""),f[d]=a,++g==e){c=pa(b.doc,c);var i={from:c,to:c,text:b.doc.splitLines(f.join(b.doc.lineSeparator())),origin:"paste"};zc(b.doc,i),za(b.doc,na(c,Zf(i)))}}),h.readAsText(a)}}(d[h],h);else{if(b.state.draggingText&&b.doc.sel.contains(c)>-1)return b.state.draggingText(a),void setTimeout(function(){b.display.input.focus()},20);try{var f=a.dataTransfer.getData("Text");if(f){if(b.state.draggingText&&!(Df?a.altKey:a.ctrlKey))var i=b.listSelections();if(Ba(b.doc,na(c,c)),i)for(var h=0;h<i.length;++h)Fc(b.doc,"",i[h].anchor,i[h].head,"drag");b.replaceSelection(f,"around","paste"),b.display.input.focus()}}catch(a){}}}}function ac(a,b){if(sf&&(!a.state.draggingText||+new Date-Tf<100))return void Bg(b);if(!ze(a,b)&&!Tb(a.display,b)&&(b.dataTransfer.setData("Text",a.getSelection()),b.dataTransfer.setDragImage&&!yf)){var c=Pe("img",null,null,"position: fixed; left: 0; top: 0;");c.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",xf&&(c.width=c.height=1,a.display.wrapper.appendChild(c),c._top=c.offsetTop),b.dataTransfer.setDragImage(c,0,0),xf&&c.parentNode.removeChild(c)}}function bc(a,b){var c=Ub(a,b);if(c){var d=document.createDocumentFragment();Ka(a,c,d),a.display.dragCursor||(a.display.dragCursor=Pe("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),a.display.lineSpace.insertBefore(a.display.dragCursor,a.display.cursorDiv)),Re(a.display.dragCursor,d)}}function cc(a){a.display.dragCursor&&(a.display.lineSpace.removeChild(a.display.dragCursor),a.display.dragCursor=null)}function dc(a,b){Math.abs(a.doc.scrollTop-b)<2||(a.doc.scrollTop=b,pf||D(a,{top:b}),a.display.scroller.scrollTop!=b&&(a.display.scroller.scrollTop=b),a.display.scrollbars.setScrollTop(b),pf&&D(a),Na(a,100))}function ec(a,b,c){(c?b==a.doc.scrollLeft:Math.abs(a.doc.scrollLeft-b)<2)||(b=Math.min(b,a.display.scroller.scrollWidth-a.display.scroller.clientWidth),a.doc.scrollLeft=b,v(a),a.display.scroller.scrollLeft!=b&&(a.display.scroller.scrollLeft=b),a.display.scrollbars.setScrollLeft(b))}function fc(a,b){var c=Wf(b),d=c.x,e=c.y,f=a.display,g=f.scroller,h=g.scrollWidth>g.clientWidth,i=g.scrollHeight>g.clientHeight;if(d&&h||e&&i){if(e&&Df&&uf)a:for(var j=b.target,k=f.view;j!=g;j=j.parentNode)for(var l=0;l<k.length;l++)if(k[l].node==j){a.display.currentWheelTarget=j;break a}if(d&&!pf&&!xf&&null!=Vf)return e&&i&&dc(a,Math.max(0,Math.min(g.scrollTop+e*Vf,g.scrollHeight-g.clientHeight))),ec(a,Math.max(0,Math.min(g.scrollLeft+d*Vf,g.scrollWidth-g.clientWidth))),(!e||e&&i)&&zg(b),void(f.wheelStartX=null);if(e&&null!=Vf){var m=e*Vf,n=a.doc.scrollTop,o=n+f.wrapper.clientHeight;m<0?n=Math.max(0,n+m-50):o=Math.min(a.doc.height,o+m+50),D(a,{top:n,bottom:o})}Uf<20&&(null==f.wheelStartX?(f.wheelStartX=g.scrollLeft,f.wheelStartY=g.scrollTop,f.wheelDX=d,f.wheelDY=e,setTimeout(function(){if(null!=f.wheelStartX){var a=g.scrollLeft-f.wheelStartX,b=g.scrollTop-f.wheelStartY,c=b&&f.wheelDY&&b/f.wheelDY||a&&f.wheelDX&&a/f.wheelDX;f.wheelStartX=f.wheelStartY=null,c&&(Vf=(Vf*Uf+c)/(Uf+1),++Uf)}},200)):(f.wheelDX+=d,f.wheelDY+=e))}}function gc(a,b,c){if("string"==typeof b&&!(b=ig[b]))return!1;a.display.input.ensurePolled();var d=a.display.shift,e=!1;try{a.isReadOnly()&&(a.state.suppressEdits=!0),c&&(a.display.shift=!1),e=b(a)!=Ig}finally{a.display.shift=d,a.state.suppressEdits=!1}return e}function hc(a,b,c){for(var d=0;d<a.state.keyMaps.length;d++){var e=kg(b,a.state.keyMaps[d],c,a);if(e)return e}return a.options.extraKeys&&kg(b,a.options.extraKeys,c,a)||kg(b,a.options.keyMap,c,a)}function ic(a,b,c,d){var e=a.state.keySeq;if(e){if(lg(b))return"handled";Xf.set(50,function(){a.state.keySeq==e&&(a.state.keySeq=null,a.display.input.reset())}),b=e+" "+b}var f=hc(a,b,d);return"multi"==f&&(a.state.keySeq=b),"handled"==f&&xe(a,"keyHandled",a,b,c),"handled"!=f&&"multi"!=f||(zg(c),Ma(a)),e&&!f&&/\'$/.test(b)?(zg(c),!0):!!f}function jc(a,b){var c=mg(b,!0);return!!c&&(b.shiftKey&&!a.state.keySeq?ic(a,"Shift-"+c,b,function(b){return gc(a,b,!0)})||ic(a,c,b,function(b){if("string"==typeof b?/^go[A-Z]/.test(b):b.motion)return gc(a,b)}):ic(a,c,b,function(b){return gc(a,b)}))}function kc(a,b,c){return ic(a,"'"+c+"'",b,function(b){return gc(a,b,!0)})}function lc(a){var b=this;if(b.curOp.focus=Se(),!ze(b,a)){sf&&tf<11&&27==a.keyCode&&(a.returnValue=!1);var c=a.keyCode;b.display.shift=16==c||a.shiftKey;var d=jc(b,a);xf&&(Yf=d?c:null,!d&&88==c&&!bh&&(Df?a.metaKey:a.ctrlKey)&&b.replaceSelection("",null,"cut")),18!=c||/\bCodeMirror-crosshair\b/.test(b.display.lineDiv.className)||mc(b)}}function mc(a){function b(a){18!=a.keyCode&&a.altKey||(Xg(c,"CodeMirror-crosshair"),Eg(document,"keyup",b),Eg(document,"mouseover",b))}var c=a.display.lineDiv;Yg(c,"CodeMirror-crosshair"),Cg(document,"keyup",b),Cg(document,"mouseover",b)}function nc(a){16==a.keyCode&&(this.doc.sel.shift=!1),ze(this,a)}function oc(a){var b=this;if(!(Tb(b.display,a)||ze(b,a)||a.ctrlKey&&!a.altKey||Df&&a.metaKey)){var c=a.keyCode,d=a.charCode;if(xf&&c==Yf)return Yf=null,void zg(a);if(!xf||a.which&&!(a.which<10)||!jc(b,a)){kc(b,a,String.fromCharCode(null==d?c:d))||b.display.input.onKeyPress(a)}}}function pc(a){a.state.delayingBlurEvent=!0,setTimeout(function(){a.state.delayingBlurEvent&&(a.state.delayingBlurEvent=!1,rc(a))},100)}function qc(a){a.state.delayingBlurEvent&&(a.state.delayingBlurEvent=!1),"nocursor"!=a.options.readOnly&&(a.state.focused||(Fg(a,"focus",a),a.state.focused=!0,Yg(a.display.wrapper,"CodeMirror-focused"),a.curOp||a.display.selForContextMenu==a.doc.sel||(a.display.input.reset(),uf&&setTimeout(function(){a.display.input.reset(!0)},20)),a.display.input.receivedFocus()),Ma(a))}function rc(a){a.state.delayingBlurEvent||(a.state.focused&&(Fg(a,"blur",a),a.state.focused=!1,Xg(a.display.wrapper,"CodeMirror-focused")),clearInterval(a.display.blinker),setTimeout(function(){a.state.focused||(a.display.shift=!1)},150))}function sc(a,b){Tb(a.display,b)||tc(a,b)||ze(a,b,"contextmenu")||a.display.input.onContextMenu(b)}function tc(a,b){return!!Be(a,"gutterContextMenu")&&Zb(a,b,"gutterContextMenu",!1)}function uc(a,b){if(Lf(a,b.from)<0)return a;if(Lf(a,b.to)<=0)return Zf(b);var c=a.line+b.text.length-(b.to.line-b.from.line)-1,d=a.ch;return a.line==b.to.line&&(d+=Zf(b).ch-b.to.ch),Kf(c,d)}function vc(a,b){for(var c=[],d=0;d<a.sel.ranges.length;d++){var e=a.sel.ranges[d];c.push(new la(uc(e.anchor,b),uc(e.head,b)))}return ma(c,a.sel.primIndex)}function wc(a,b,c){return a.line==b.line?Kf(c.line,a.ch-b.ch+c.ch):Kf(c.line+(a.line-b.line),a.ch)}function xc(a,b,c){for(var d=[],e=Kf(a.first,0),f=e,g=0;g<b.length;g++){var h=b[g],i=wc(h.from,e,f),j=wc(Zf(h),e,f);if(e=h.to,f=j,"around"==c){var k=a.sel.ranges[g],l=Lf(k.head,k.anchor)<0;d[g]=new la(l?j:i,l?i:j)}else d[g]=new la(i,i)}return new ka(d,a.sel.primIndex)}function yc(a,b,c){var d={canceled:!1,from:b.from,to:b.to,text:b.text,origin:b.origin,cancel:function(){this.canceled=!0}};return c&&(d.update=function(b,c,d,e){b&&(this.from=pa(a,b)),c&&(this.to=pa(a,c)),d&&(this.text=d),void 0!==e&&(this.origin=e)}),Fg(a,"beforeChange",a,d),a.cm&&Fg(a.cm,"beforeChange",a.cm,d),d.canceled?null:{from:d.from,to:d.to,text:d.text,origin:d.origin}}function zc(a,b,c){if(a.cm){if(!a.cm.curOp)return Eb(a.cm,zc)(a,b,c);if(a.cm.state.suppressEdits)return}if(!(Be(a,"beforeChange")||a.cm&&Be(a.cm,"beforeChange"))||(b=yc(a,b,!0))){var d=If&&!c&&hd(a,b.from,b.to);if(d)for(var e=d.length-1;e>=0;--e)Ac(a,{from:d[e].from,to:d[e].to,text:e?[""]:b.text});else Ac(a,b)}}function Ac(a,b){if(1!=b.text.length||""!=b.text[0]||0!=Lf(b.from,b.to)){var c=vc(a,b);ie(a,b,c,a.cm?a.cm.curOp.id:NaN),Dc(a,b,c,ed(a,b));var d=[];Wd(a,function(a,c){c||Ge(d,a.history)!=-1||(se(a.history,b),d.push(a.history)),Dc(a,b,null,ed(a,b))})}}function Bc(a,b,c){if(!a.cm||!a.cm.state.suppressEdits){for(var d,e=a.history,f=a.sel,g="undo"==b?e.done:e.undone,h="undo"==b?e.undone:e.done,i=0;i<g.length&&(d=g[i],c?!d.ranges||d.equals(a.sel):d.ranges);i++);if(i!=g.length){for(e.lastOrigin=e.lastSelOrigin=null;d=g.pop(),d.ranges;){if(le(d,h),c&&!d.equals(a.sel))return void Aa(a,d,{clearRedo:!1});f=d}var j=[];le(f,h),h.push({changes:j,generation:e.generation}),e.generation=d.generation||++e.maxGeneration;for(var k=Be(a,"beforeChange")||a.cm&&Be(a.cm,"beforeChange"),i=d.changes.length-1;i>=0;--i){var l=d.changes[i];if(l.origin=b,k&&!yc(a,l,!1))return void(g.length=0);j.push(fe(a,l));var m=i?vc(a,l):Fe(g);Dc(a,l,m,gd(a,l)),!i&&a.cm&&a.cm.scrollIntoView({from:l.from,to:Zf(l)});var n=[];Wd(a,function(a,b){b||Ge(n,a.history)!=-1||(se(a.history,l),n.push(a.history)),Dc(a,l,null,gd(a,l))})}}}}function Cc(a,b){if(0!=b&&(a.first+=b,a.sel=new ka(He(a.sel.ranges,function(a){return new la(Kf(a.anchor.line+b,a.anchor.ch),Kf(a.head.line+b,a.head.ch))}),a.sel.primIndex),a.cm)){Jb(a.cm,a.first,a.first-b,b);for(var c=a.cm.display,d=c.viewFrom;d<c.viewTo;d++)Kb(a.cm,d,"gutter")}}function Dc(a,b,c,d){if(a.cm&&!a.cm.curOp)return Eb(a.cm,Dc)(a,b,c,d);if(b.to.line<a.first)return void Cc(a,b.text.length-1-(b.to.line-b.from.line));if(!(b.from.line>a.lastLine())){if(b.from.line<a.first){var e=b.text.length-1-(a.first-b.from.line);Cc(a,e),b={from:Kf(a.first,0),to:Kf(b.to.line+e,b.to.ch),text:[Fe(b.text)],origin:b.origin}}var f=a.lastLine();b.to.line>f&&(b={from:b.from,to:Kf(f,Yd(a,f).text.length),text:[b.text[0]],origin:b.origin}),b.removed=Zd(a,b.from,b.to),c||(c=vc(a,b)),a.cm?Ec(a.cm,b,d):Td(a,b,d),Ba(a,c,Jg)}}function Ec(a,b,c){var d=a.doc,e=a.display,g=b.from,h=b.to,i=!1,j=g.line;a.options.lineWrapping||(j=ae(rd(Yd(d,g.line))),d.iter(j,h.line+1,function(a){if(a==e.maxLine)return i=!0,!0})),d.sel.contains(b.from,b.to)>-1&&Ae(a),Td(d,b,c,f(a)),a.options.lineWrapping||(d.iter(j,g.line+b.text.length,function(a){var b=l(a);b>e.maxLineLength&&(e.maxLine=a,e.maxLineLength=b,e.maxLineChanged=!0,i=!1)}),i&&(a.curOp.updateMaxLine=!0)),d.frontier=Math.min(d.frontier,g.line),Na(a,400);var k=b.text.length-(h.line-g.line)-1;b.full?Jb(a):g.line!=h.line||1!=b.text.length||Sd(a.doc,b)?Jb(a,g.line,h.line+1,k):Kb(a,g.line,"text");var m=Be(a,"changes"),n=Be(a,"change");if(n||m){var o={from:g,to:h,text:b.text,removed:b.removed,origin:b.origin};n&&xe(a,"change",a,o),m&&(a.curOp.changeObjs||(a.curOp.changeObjs=[])).push(o)}a.display.selForContextMenu=null}function Fc(a,b,c,d,e){if(d||(d=c),Lf(d,c)<0){var f=d;d=c,c=f}"string"==typeof b&&(b=a.splitLines(b)),zc(a,{from:c,to:d,text:b,origin:e})}function Gc(a,b){if(!ze(a,"scrollCursorIntoView")){var c=a.display,d=c.sizer.getBoundingClientRect(),e=null;if(b.top+d.top<0?e=!0:b.bottom+d.top>(window.innerHeight||document.documentElement.clientHeight)&&(e=!1),null!=e&&!Af){var f=Pe("div","​",null,"position: absolute; top: "+(b.top-c.viewOffset-Ra(a.display))+"px; height: "+(b.bottom-b.top+Ua(a)+c.barHeight)+"px; left: "+b.left+"px; width: 2px;");a.display.lineSpace.appendChild(f),f.scrollIntoView(e),a.display.lineSpace.removeChild(f)}}}function Hc(a,b,c,d){null==d&&(d=0);for(var e=0;e<5;e++){var f=!1,g=nb(a,b),h=c&&c!=b?nb(a,c):g,i=Jc(a,Math.min(g.left,h.left),Math.min(g.top,h.top)-d,Math.max(g.left,h.left),Math.max(g.bottom,h.bottom)+d),j=a.doc.scrollTop,k=a.doc.scrollLeft;if(null!=i.scrollTop&&(dc(a,i.scrollTop),Math.abs(a.doc.scrollTop-j)>1&&(f=!0)),null!=i.scrollLeft&&(ec(a,i.scrollLeft),Math.abs(a.doc.scrollLeft-k)>1&&(f=!0)),!f)break}return g}function Ic(a,b,c,d,e){var f=Jc(a,b,c,d,e);null!=f.scrollTop&&dc(a,f.scrollTop),null!=f.scrollLeft&&ec(a,f.scrollLeft)}function Jc(a,b,c,d,e){var f=a.display,g=sb(a.display);c<0&&(c=0);var h=a.curOp&&null!=a.curOp.scrollTop?a.curOp.scrollTop:f.scroller.scrollTop,i=Wa(a),j={};e-c>i&&(e=c+i);var k=a.doc.height+Sa(f),l=c<g,m=e>k-g;if(c<h)j.scrollTop=l?0:c;else if(e>h+i){var n=Math.min(c,(m?k:e)-i);n!=h&&(j.scrollTop=n)}var o=a.curOp&&null!=a.curOp.scrollLeft?a.curOp.scrollLeft:f.scroller.scrollLeft,p=Va(a)-(a.options.fixedGutter?f.gutters.offsetWidth:0),q=d-b>p;return q&&(d=b+p),b<10?j.scrollLeft=0:b<o?j.scrollLeft=Math.max(0,b-(q?0:10)):d>p+o-3&&(j.scrollLeft=d+(q?0:10)-p),j}function Kc(a,b,c){null==b&&null==c||Mc(a),null!=b&&(a.curOp.scrollLeft=(null==a.curOp.scrollLeft?a.doc.scrollLeft:a.curOp.scrollLeft)+b),null!=c&&(a.curOp.scrollTop=(null==a.curOp.scrollTop?a.doc.scrollTop:a.curOp.scrollTop)+c)}function Lc(a){Mc(a);var b=a.getCursor(),c=b,d=b;a.options.lineWrapping||(c=b.ch?Kf(b.line,b.ch-1):b,d=Kf(b.line,b.ch+1)),a.curOp.scrollToPos={from:c,to:d,margin:a.options.cursorScrollMargin,isCursor:!0}}function Mc(a){var b=a.curOp.scrollToPos;if(b){a.curOp.scrollToPos=null;var c=ob(a,b.from),d=ob(a,b.to),e=Jc(a,Math.min(c.left,d.left),Math.min(c.top,d.top)-b.margin,Math.max(c.right,d.right),Math.max(c.bottom,d.bottom)+b.margin);a.scrollTo(e.scrollLeft,e.scrollTop)}}function Nc(a,b,c,d){var e,f=a.doc;null==c&&(c="add"),"smart"==c&&(f.mode.indent?e=Qa(a,b):c="prev");var g=a.options.tabSize,h=Yd(f,b),i=Mg(h.text,null,g);h.stateAfter&&(h.stateAfter=null);var j,k=h.text.match(/^\s*/)[0];if(d||/\S/.test(h.text)){
if("smart"==c&&((j=f.mode.indent(e,h.text.slice(k.length),h.text))==Ig||j>150)){if(!d)return;c="prev"}}else j=0,c="not";"prev"==c?j=b>f.first?Mg(Yd(f,b-1).text,null,g):0:"add"==c?j=i+a.options.indentUnit:"subtract"==c?j=i-a.options.indentUnit:"number"==typeof c&&(j=i+c),j=Math.max(0,j);var l="",m=0;if(a.options.indentWithTabs)for(var n=Math.floor(j/g);n;--n)m+=g,l+="\t";if(m<j&&(l+=Ee(j-m)),l!=k)return Fc(f,l,Kf(b,0),Kf(b,k.length),"+input"),h.stateAfter=null,!0;for(var n=0;n<f.sel.ranges.length;n++){var o=f.sel.ranges[n];if(o.head.line==b&&o.head.ch<k.length){var m=Kf(b,k.length);wa(f,n,new la(m,m));break}}}function Oc(a,b,c,d){var e=b,f=b;return"number"==typeof b?f=Yd(a,oa(a,b)):e=ae(b),null==e?null:(d(f,e)&&a.cm&&Kb(a.cm,e,c),f)}function Pc(a,b){for(var c=a.doc.sel.ranges,d=[],e=0;e<c.length;e++){for(var f=b(c[e]);d.length&&Lf(f.from,Fe(d).to)<=0;){var g=d.pop();if(Lf(g.from,f.from)<0){f.from=g.from;break}}d.push(f)}Db(a,function(){for(var b=d.length-1;b>=0;b--)Fc(a.doc,"",d[b].from,d[b].to,"+delete");Lc(a)})}function Qc(a,b,c,d,e){function f(){var b=h+c;return!(b<a.first||b>=a.first+a.size)&&(h=b,k=Yd(a,b))}function g(a){var b=(e?lf:mf)(k,i,c,!0);if(null==b){if(a||!f())return!1;i=e?(c<0?df:cf)(k):c<0?k.text.length:0}else i=b;return!0}var h=b.line,i=b.ch,j=c,k=Yd(a,h);if("char"==d)g();else if("column"==d)g(!0);else if("word"==d||"group"==d)for(var l=null,m="group"==d,n=a.cm&&a.cm.getHelper(b,"wordChars"),o=!0;!(c<0)||g(!o);o=!1){var p=k.text.charAt(i)||"\n",q=Me(p,n)?"w":m&&"\n"==p?"n":!m||/\s/.test(p)?null:"p";if(!m||o||q||(q="s"),l&&l!=q){c<0&&(c=1,g());break}if(q&&(l=q),c>0&&!g(!o))break}var r=Ga(a,Kf(h,i),b,j,!0);return Lf(b,r)||(r.hitSide=!0),r}function Rc(a,b,c,d){var e,f=a.doc,g=b.left;if("page"==d){var h=Math.min(a.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);e=b.top+c*(h-(c<0?1.5:.5)*sb(a.display))}else"line"==d&&(e=c>0?b.bottom+3:b.top-3);for(;;){var i=qb(a,g,e);if(!i.outside)break;if(c<0?e<=0:e>=f.height){i.hitSide=!0;break}e+=5*c}return i}function Sc(b,c,d,e){a.defaults[b]=c,d&&(_f[b]=e?function(a,b,c){c!=ag&&d(a,b,c)}:d)}function Tc(a){for(var b,c,d,e,f=a.split(/-(?!$)/),a=f[f.length-1],g=0;g<f.length-1;g++){var h=f[g];if(/^(cmd|meta|m)$/i.test(h))e=!0;else if(/^a(lt)?$/i.test(h))b=!0;else if(/^(c|ctrl|control)$/i.test(h))c=!0;else{if(!/^s(hift)$/i.test(h))throw new Error("Unrecognized modifier name: "+h);d=!0}}return b&&(a="Alt-"+a),c&&(a="Ctrl-"+a),e&&(a="Cmd-"+a),d&&(a="Shift-"+a),a}function Uc(a){return"string"==typeof a?jg[a]:a}function Vc(a,b,c,d,e){if(d&&d.shared)return Wc(a,b,c,d,e);if(a.cm&&!a.cm.curOp)return Eb(a.cm,Vc)(a,b,c,d,e);var f=new pg(a,e),g=Lf(b,c);if(d&&Ke(d,f,!1),g>0||0==g&&f.clearWhenEmpty!==!1)return f;if(f.replacedWith&&(f.collapsed=!0,f.widgetNode=Pe("span",[f.replacedWith],"CodeMirror-widget"),d.handleMouseEvents||f.widgetNode.setAttribute("cm-ignore-events","true"),d.insertLeft&&(f.widgetNode.insertLeft=!0)),f.collapsed){if(qd(a,b.line,b,c,f)||b.line!=c.line&&qd(a,c.line,b,c,f))throw new Error("Inserting collapsed marker partially overlapping an existing one");Jf=!0}f.addToHistory&&ie(a,{from:b,to:c,origin:"markText"},a.sel,NaN);var h,i=b.line,j=a.cm;if(a.iter(i,c.line+1,function(a){j&&f.collapsed&&!j.options.lineWrapping&&rd(a)==j.display.maxLine&&(h=!0),f.collapsed&&i!=b.line&&_d(a,0),bd(a,new $c(f,i==b.line?b.ch:null,i==c.line?c.ch:null)),++i}),f.collapsed&&a.iter(b.line,c.line+1,function(b){vd(a,b)&&_d(b,0)}),f.clearOnEnter&&Cg(f,"beforeCursorEnter",function(){f.clear()}),f.readOnly&&(If=!0,(a.history.done.length||a.history.undone.length)&&a.clearHistory()),f.collapsed&&(f.id=++og,f.atomic=!0),j){if(h&&(j.curOp.updateMaxLine=!0),f.collapsed)Jb(j,b.line,c.line+1);else if(f.className||f.title||f.startStyle||f.endStyle||f.css)for(var k=b.line;k<=c.line;k++)Kb(j,k,"text");f.atomic&&Da(j.doc),xe(j,"markerAdded",j,f)}return f}function Wc(a,b,c,d,e){d=Ke(d),d.shared=!1;var f=[Vc(a,b,c,d,e)],g=f[0],h=d.widgetNode;return Wd(a,function(a){h&&(d.widgetNode=h.cloneNode(!0)),f.push(Vc(a,pa(a,b),pa(a,c),d,e));for(var i=0;i<a.linked.length;++i)if(a.linked[i].isParent)return;g=Fe(f)}),new qg(f,g)}function Xc(a){return a.findMarks(Kf(a.first,0),a.clipPos(Kf(a.lastLine())),function(a){return a.parent})}function Yc(a,b){for(var c=0;c<b.length;c++){var d=b[c],e=d.find(),f=a.clipPos(e.from),g=a.clipPos(e.to);if(Lf(f,g)){var h=Vc(a,f,g,d.primary,d.primary.type);d.markers.push(h),h.parent=d}}}function Zc(a){for(var b=0;b<a.length;b++){var c=a[b],d=[c.primary.doc];Wd(c.primary.doc,function(a){d.push(a)});for(var e=0;e<c.markers.length;e++){var f=c.markers[e];Ge(d,f.doc)==-1&&(f.parent=null,c.markers.splice(e--,1))}}}function $c(a,b,c){this.marker=a,this.from=b,this.to=c}function _c(a,b){if(a)for(var c=0;c<a.length;++c){var d=a[c];if(d.marker==b)return d}}function ad(a,b){for(var c,d=0;d<a.length;++d)a[d]!=b&&(c||(c=[])).push(a[d]);return c}function bd(a,b){a.markedSpans=a.markedSpans?a.markedSpans.concat([b]):[b],b.marker.attachLine(a)}function cd(a,b,c){if(a)for(var d,e=0;e<a.length;++e){var f=a[e],g=f.marker,h=null==f.from||(g.inclusiveLeft?f.from<=b:f.from<b);if(h||f.from==b&&"bookmark"==g.type&&(!c||!f.marker.insertLeft)){var i=null==f.to||(g.inclusiveRight?f.to>=b:f.to>b);(d||(d=[])).push(new $c(g,f.from,i?null:f.to))}}return d}function dd(a,b,c){if(a)for(var d,e=0;e<a.length;++e){var f=a[e],g=f.marker,h=null==f.to||(g.inclusiveRight?f.to>=b:f.to>b);if(h||f.from==b&&"bookmark"==g.type&&(!c||f.marker.insertLeft)){var i=null==f.from||(g.inclusiveLeft?f.from<=b:f.from<b);(d||(d=[])).push(new $c(g,i?null:f.from-b,null==f.to?null:f.to-b))}}return d}function ed(a,b){if(b.full)return null;var c=ra(a,b.from.line)&&Yd(a,b.from.line).markedSpans,d=ra(a,b.to.line)&&Yd(a,b.to.line).markedSpans;if(!c&&!d)return null;var e=b.from.ch,f=b.to.ch,g=0==Lf(b.from,b.to),h=cd(c,e,g),i=dd(d,f,g),j=1==b.text.length,k=Fe(b.text).length+(j?e:0);if(h)for(var l=0;l<h.length;++l){var m=h[l];if(null==m.to){var n=_c(i,m.marker);n?j&&(m.to=null==n.to?null:n.to+k):m.to=e}}if(i)for(var l=0;l<i.length;++l){var m=i[l];if(null!=m.to&&(m.to+=k),null==m.from){var n=_c(h,m.marker);n||(m.from=k,j&&(h||(h=[])).push(m))}else m.from+=k,j&&(h||(h=[])).push(m)}h&&(h=fd(h)),i&&i!=h&&(i=fd(i));var o=[h];if(!j){var p,q=b.text.length-2;if(q>0&&h)for(var l=0;l<h.length;++l)null==h[l].to&&(p||(p=[])).push(new $c(h[l].marker,null,null));for(var l=0;l<q;++l)o.push(p);o.push(i)}return o}function fd(a){for(var b=0;b<a.length;++b){var c=a[b];null!=c.from&&c.from==c.to&&c.marker.clearWhenEmpty!==!1&&a.splice(b--,1)}return a.length?a:null}function gd(a,b){var c=oe(a,b),d=ed(a,b);if(!c)return d;if(!d)return c;for(var e=0;e<c.length;++e){var f=c[e],g=d[e];if(f&&g)a:for(var h=0;h<g.length;++h){for(var i=g[h],j=0;j<f.length;++j)if(f[j].marker==i.marker)continue a;f.push(i)}else g&&(c[e]=g)}return c}function hd(a,b,c){var d=null;if(a.iter(b.line,c.line+1,function(a){if(a.markedSpans)for(var b=0;b<a.markedSpans.length;++b){var c=a.markedSpans[b].marker;!c.readOnly||d&&Ge(d,c)!=-1||(d||(d=[])).push(c)}}),!d)return null;for(var e=[{from:b,to:c}],f=0;f<d.length;++f)for(var g=d[f],h=g.find(0),i=0;i<e.length;++i){var j=e[i];if(!(Lf(j.to,h.from)<0||Lf(j.from,h.to)>0)){var k=[i,1],l=Lf(j.from,h.from),m=Lf(j.to,h.to);(l<0||!g.inclusiveLeft&&!l)&&k.push({from:j.from,to:h.from}),(m>0||!g.inclusiveRight&&!m)&&k.push({from:h.to,to:j.to}),e.splice.apply(e,k),i+=k.length-1}}return e}function id(a){var b=a.markedSpans;if(b){for(var c=0;c<b.length;++c)b[c].marker.detachLine(a);a.markedSpans=null}}function jd(a,b){if(b){for(var c=0;c<b.length;++c)b[c].marker.attachLine(a);a.markedSpans=b}}function kd(a){return a.inclusiveLeft?-1:0}function ld(a){return a.inclusiveRight?1:0}function md(a,b){var c=a.lines.length-b.lines.length;if(0!=c)return c;var d=a.find(),e=b.find(),f=Lf(d.from,e.from)||kd(a)-kd(b);if(f)return-f;var g=Lf(d.to,e.to)||ld(a)-ld(b);return g||b.id-a.id}function nd(a,b){var c,d=Jf&&a.markedSpans;if(d)for(var e,f=0;f<d.length;++f)e=d[f],e.marker.collapsed&&null==(b?e.from:e.to)&&(!c||md(c,e.marker)<0)&&(c=e.marker);return c}function od(a){return nd(a,!0)}function pd(a){return nd(a,!1)}function qd(a,b,c,d,e){var f=Yd(a,b),g=Jf&&f.markedSpans;if(g)for(var h=0;h<g.length;++h){var i=g[h];if(i.marker.collapsed){var j=i.marker.find(0),k=Lf(j.from,c)||kd(i.marker)-kd(e),l=Lf(j.to,d)||ld(i.marker)-ld(e);if(!(k>=0&&l<=0||k<=0&&l>=0)&&(k<=0&&(Lf(j.to,c)>0||i.marker.inclusiveRight&&e.inclusiveLeft)||k>=0&&(Lf(j.from,d)<0||i.marker.inclusiveLeft&&e.inclusiveRight)))return!0}}}function rd(a){for(var b;b=od(a);)a=b.find(-1,!0).line;return a}function sd(a){for(var b,c;b=pd(a);)a=b.find(1,!0).line,(c||(c=[])).push(a);return c}function td(a,b){var c=Yd(a,b),d=rd(c);return c==d?b:ae(d)}function ud(a,b){if(b>a.lastLine())return b;var c,d=Yd(a,b);if(!vd(a,d))return b;for(;c=pd(d);)d=c.find(1,!0).line;return ae(d)+1}function vd(a,b){var c=Jf&&b.markedSpans;if(c)for(var d,e=0;e<c.length;++e)if(d=c[e],d.marker.collapsed){if(null==d.from)return!0;if(!d.marker.widgetNode&&0==d.from&&d.marker.inclusiveLeft&&wd(a,b,d))return!0}}function wd(a,b,c){if(null==c.to){var d=c.marker.find(1,!0);return wd(a,d.line,_c(d.line.markedSpans,c.marker))}if(c.marker.inclusiveRight&&c.to==b.text.length)return!0;for(var e,f=0;f<b.markedSpans.length;++f)if(e=b.markedSpans[f],e.marker.collapsed&&!e.marker.widgetNode&&e.from==c.to&&(null==e.to||e.to!=c.from)&&(e.marker.inclusiveLeft||c.marker.inclusiveRight)&&wd(a,b,e))return!0}function xd(a,b,c){ce(b)<(a.curOp&&a.curOp.scrollTop||a.doc.scrollTop)&&Kc(a,null,c)}function yd(a){if(null!=a.height)return a.height;var b=a.doc.cm;if(!b)return 0;if(!Ug(document.body,a.node)){var c="position: relative;";a.coverGutter&&(c+="margin-left: -"+b.display.gutters.offsetWidth+"px;"),a.noHScroll&&(c+="width: "+b.display.wrapper.clientWidth+"px;"),Re(b.display.measure,Pe("div",[a.node],null,c))}return a.height=a.node.parentNode.offsetHeight}function zd(a,b,c,d){var e=new rg(a,c,d),f=a.cm;return f&&e.noHScroll&&(f.display.alignWidgets=!0),Oc(a,b,"widget",function(b){var c=b.widgets||(b.widgets=[]);if(null==e.insertAt?c.push(e):c.splice(Math.min(c.length-1,Math.max(0,e.insertAt)),0,e),e.line=b,f&&!vd(a,b)){var d=ce(b)<a.scrollTop;_d(b,b.height+yd(e)),d&&Kc(f,null,e.height),f.curOp.forceUpdate=!0}return!0}),e}function Ad(a,b,c,d){a.text=b,a.stateAfter&&(a.stateAfter=null),a.styles&&(a.styles=null),null!=a.order&&(a.order=null),id(a),jd(a,c);var e=d?d(a):1;e!=a.height&&_d(a,e)}function Bd(a){a.parent=null,id(a)}function Cd(a,b){if(a)for(;;){var c=a.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!c)break;a=a.slice(0,c.index)+a.slice(c.index+c[0].length);var d=c[1]?"bgClass":"textClass";null==b[d]?b[d]=c[2]:new RegExp("(?:^|s)"+c[2]+"(?:$|s)").test(b[d])||(b[d]+=" "+c[2])}return a}function Dd(b,c){if(b.blankLine)return b.blankLine(c);if(b.innerMode){var d=a.innerMode(b,c);return d.mode.blankLine?d.mode.blankLine(d.state):void 0}}function Ed(b,c,d,e){for(var f=0;f<10;f++){e&&(e[0]=a.innerMode(b,d).mode);var g=b.token(c,d);if(c.pos>c.start)return g}throw new Error("Mode "+b.name+" failed to advance stream.")}function Fd(a,b,c,d){function e(a){return{start:l.start,end:l.pos,string:l.current(),type:f||null,state:a?gg(g.mode,k):k}}var f,g=a.doc,h=g.mode;b=pa(g,b);var i,j=Yd(g,b.line),k=Qa(a,b.line,c),l=new ng(j.text,a.options.tabSize);for(d&&(i=[]);(d||l.pos<b.ch)&&!l.eol();)l.start=l.pos,f=Ed(h,l,k),d&&i.push(e(!0));return d?i:e()}function Gd(a,b,c,d,e,f,g){var h=c.flattenSpans;null==h&&(h=a.options.flattenSpans);var i,j=0,k=null,l=new ng(b,a.options.tabSize),m=a.options.addModeClass&&[null];for(""==b&&Cd(Dd(c,d),f);!l.eol();){if(l.pos>a.options.maxHighlightLength?(h=!1,g&&Jd(a,b,d,l.pos),l.pos=b.length,i=null):i=Cd(Ed(c,l,d,m),f),m){var n=m[0].name;n&&(i="m-"+(i?n+" "+i:n))}if(!h||k!=i){for(;j<l.start;)j=Math.min(l.start,j+5e4),e(j,k);k=i}l.start=l.pos}for(;j<l.pos;){var o=Math.min(l.pos,j+5e4);e(o,k),j=o}}function Hd(a,b,c,d){var e=[a.state.modeGen],f={};Gd(a,b.text,a.doc.mode,c,function(a,b){e.push(a,b)},f,d);for(var g=0;g<a.state.overlays.length;++g){var h=a.state.overlays[g],i=1,j=0;Gd(a,b.text,h.mode,!0,function(a,b){for(var c=i;j<a;){var d=e[i];d>a&&e.splice(i,1,a,e[i+1],d),i+=2,j=Math.min(a,d)}if(b)if(h.opaque)e.splice(c,i-c,a,"cm-overlay "+b),i=c+2;else for(;c<i;c+=2){var f=e[c+1];e[c+1]=(f?f+" ":"")+"cm-overlay "+b}},f)}return{styles:e,classes:f.bgClass||f.textClass?f:null}}function Id(a,b,c){if(!b.styles||b.styles[0]!=a.state.modeGen){var d=Qa(a,ae(b)),e=Hd(a,b,b.text.length>a.options.maxHighlightLength?gg(a.doc.mode,d):d);b.stateAfter=d,b.styles=e.styles,e.classes?b.styleClasses=e.classes:b.styleClasses&&(b.styleClasses=null),c===a.doc.frontier&&a.doc.frontier++}return b.styles}function Jd(a,b,c,d){var e=a.doc.mode,f=new ng(b,a.options.tabSize);for(f.start=f.pos=d||0,""==b&&Dd(e,c);!f.eol();)Ed(e,f,c),f.start=f.pos}function Kd(a,b){if(!a||/^\s*$/.test(a))return null;var c=b.addModeClass?ug:tg;return c[a]||(c[a]=a.replace(/\S+/g,"cm-$&"))}function Ld(a,b){var c=Pe("span",null,null,uf?"padding-right: .1px":null),d={pre:Pe("pre",[c],"CodeMirror-line"),content:c,col:0,pos:0,cm:a,splitSpaces:(sf||uf)&&a.getOption("lineWrapping")};b.measure={};for(var e=0;e<=(b.rest?b.rest.length:0);e++){var f,g=e?b.rest[e-1]:b.line;d.pos=0,d.addToken=Nd,Ze(a.display.measure)&&(f=de(g))&&(d.addToken=Pd(d.addToken,f)),d.map=[];Rd(g,d,Id(a,g,b!=a.display.externalMeasured&&ae(g))),g.styleClasses&&(g.styleClasses.bgClass&&(d.bgClass=Ue(g.styleClasses.bgClass,d.bgClass||"")),g.styleClasses.textClass&&(d.textClass=Ue(g.styleClasses.textClass,d.textClass||""))),0==d.map.length&&d.map.push(0,0,d.content.appendChild(Ye(a.display.measure))),0==e?(b.measure.map=d.map,b.measure.cache={}):((b.measure.maps||(b.measure.maps=[])).push(d.map),(b.measure.caches||(b.measure.caches=[])).push({}))}return uf&&/\bcm-tab\b/.test(d.content.lastChild.className)&&(d.content.className="cm-tab-wrap-hack"),Fg(a,"renderLine",a,b.line,d.pre),d.pre.className&&(d.textClass=Ue(d.pre.className,d.textClass||"")),d}function Md(a){var b=Pe("span","•","cm-invalidchar");return b.title="\\u"+a.charCodeAt(0).toString(16),b.setAttribute("aria-label",b.title),b}function Nd(a,b,c,d,e,f,g){if(b){var h=a.splitSpaces?b.replace(/ {3,}/g,Od):b,i=a.cm.state.specialChars,j=!1;if(i.test(b))for(var k=document.createDocumentFragment(),l=0;;){i.lastIndex=l;var m=i.exec(b),n=m?m.index-l:b.length-l;if(n){var o=document.createTextNode(h.slice(l,l+n));sf&&tf<9?k.appendChild(Pe("span",[o])):k.appendChild(o),a.map.push(a.pos,a.pos+n,o),a.col+=n,a.pos+=n}if(!m)break;if(l+=n+1,"\t"==m[0]){var p=a.cm.options.tabSize,q=p-a.col%p,o=k.appendChild(Pe("span",Ee(q),"cm-tab"));o.setAttribute("role","presentation"),o.setAttribute("cm-text","\t"),a.col+=q}else if("\r"==m[0]||"\n"==m[0]){var o=k.appendChild(Pe("span","\r"==m[0]?"␍":"␤","cm-invalidchar"));o.setAttribute("cm-text",m[0]),a.col+=1}else{var o=a.cm.options.specialCharPlaceholder(m[0]);o.setAttribute("cm-text",m[0]),sf&&tf<9?k.appendChild(Pe("span",[o])):k.appendChild(o),a.col+=1}a.map.push(a.pos,a.pos+1,o),a.pos++}else{a.col+=b.length;var k=document.createTextNode(h);a.map.push(a.pos,a.pos+b.length,k),sf&&tf<9&&(j=!0),a.pos+=b.length}if(c||d||e||j||g){var r=c||"";d&&(r+=d),e&&(r+=e);var s=Pe("span",[k],r,g);return f&&(s.title=f),a.content.appendChild(s)}a.content.appendChild(k)}}function Od(a){for(var b=" ",c=0;c<a.length-2;++c)b+=c%2?" ":" ";return b+=" "}function Pd(a,b){return function(c,d,e,f,g,h,i){e=e?e+" cm-force-border":"cm-force-border";for(var j=c.pos,k=j+d.length;;){for(var l=0;l<b.length;l++){var m=b[l];if(m.to>j&&m.from<=j)break}if(m.to>=k)return a(c,d,e,f,g,h,i);a(c,d.slice(0,m.to-j),e,f,null,h,i),f=null,d=d.slice(m.to-j),j=m.to}}}function Qd(a,b,c,d){var e=!d&&c.widgetNode;e&&a.map.push(a.pos,a.pos+b,e),!d&&a.cm.display.input.needsContentAttribute&&(e||(e=a.content.appendChild(document.createElement("span"))),e.setAttribute("cm-marker",c.id)),e&&(a.cm.display.input.setUneditable(e),a.content.appendChild(e)),a.pos+=b}function Rd(a,b,c){var d=a.markedSpans,e=a.text,f=0;if(d)for(var g,h,i,j,k,l,m,n=e.length,o=0,p=1,q="",r=0;;){if(r==o){i=j=k=l=h="",m=null,r=1/0;for(var s,t=[],u=0;u<d.length;++u){var v=d[u],w=v.marker;"bookmark"==w.type&&v.from==o&&w.widgetNode?t.push(w):v.from<=o&&(null==v.to||v.to>o||w.collapsed&&v.to==o&&v.from==o)?(null!=v.to&&v.to!=o&&r>v.to&&(r=v.to,j=""),w.className&&(i+=" "+w.className),w.css&&(h=(h?h+";":"")+w.css),w.startStyle&&v.from==o&&(k+=" "+w.startStyle),w.endStyle&&v.to==r&&(s||(s=[])).push(w.endStyle,v.to),w.title&&!l&&(l=w.title),w.collapsed&&(!m||md(m.marker,w)<0)&&(m=v)):v.from>o&&r>v.from&&(r=v.from)}if(s)for(var u=0;u<s.length;u+=2)s[u+1]==r&&(j+=" "+s[u]);if(!m||m.from==o)for(var u=0;u<t.length;++u)Qd(b,0,t[u]);if(m&&(m.from||0)==o){if(Qd(b,(null==m.to?n+1:m.to)-o,m.marker,null==m.from),null==m.to)return;m.to==o&&(m=!1)}}if(o>=n)break;for(var x=Math.min(n,r);;){if(q){var y=o+q.length;if(!m){var z=y>x?q.slice(0,x-o):q;b.addToken(b,z,g?g+i:i,k,o+z.length==r?j:"",l,h)}if(y>=x){q=q.slice(x-o),o=x;break}o=y,k=""}q=e.slice(f,f=c[p++]),g=Kd(c[p++],b.cm.options)}}else for(var p=1;p<c.length;p+=2)b.addToken(b,e.slice(f,f=c[p]),Kd(c[p+1],b.cm.options))}function Sd(a,b){return 0==b.from.ch&&0==b.to.ch&&""==Fe(b.text)&&(!a.cm||a.cm.options.wholeLineUpdateBefore)}function Td(a,b,c,d){function e(a){return c?c[a]:null}function f(a,c,e){Ad(a,c,e,d),xe(a,"change",a,b)}function g(a,b){for(var c=a,f=[];c<b;++c)f.push(new sg(j[c],e(c),d));return f}var h=b.from,i=b.to,j=b.text,k=Yd(a,h.line),l=Yd(a,i.line),m=Fe(j),n=e(j.length-1),o=i.line-h.line;if(b.full)a.insert(0,g(0,j.length)),a.remove(j.length,a.size-j.length);else if(Sd(a,b)){var p=g(0,j.length-1);f(l,l.text,n),o&&a.remove(h.line,o),p.length&&a.insert(h.line,p)}else if(k==l)if(1==j.length)f(k,k.text.slice(0,h.ch)+m+k.text.slice(i.ch),n);else{var p=g(1,j.length-1);p.push(new sg(m+k.text.slice(i.ch),n,d)),f(k,k.text.slice(0,h.ch)+j[0],e(0)),a.insert(h.line+1,p)}else if(1==j.length)f(k,k.text.slice(0,h.ch)+j[0]+l.text.slice(i.ch),e(0)),a.remove(h.line+1,o);else{f(k,k.text.slice(0,h.ch)+j[0],e(0)),f(l,m+l.text.slice(i.ch),n);var p=g(1,j.length-1);o>1&&a.remove(h.line+1,o-1),a.insert(h.line+1,p)}xe(a,"change",a,b)}function Ud(a){this.lines=a,this.parent=null;for(var b=0,c=0;b<a.length;++b)a[b].parent=this,c+=a[b].height;this.height=c}function Vd(a){this.children=a;for(var b=0,c=0,d=0;d<a.length;++d){var e=a[d];b+=e.chunkSize(),c+=e.height,e.parent=this}this.size=b,this.height=c,this.parent=null}function Wd(a,b,c){function d(a,e,f){if(a.linked)for(var g=0;g<a.linked.length;++g){var h=a.linked[g];if(h.doc!=e){var i=f&&h.sharedHist;c&&!i||(b(h.doc,i),d(h.doc,a,i))}}}d(a,null,!0)}function Xd(a,b){if(b.cm)throw new Error("This document is already in use.");a.doc=b,b.cm=a,g(a),c(a),a.options.lineWrapping||m(a),a.options.mode=b.modeOption,Jb(a)}function Yd(a,b){if((b-=a.first)<0||b>=a.size)throw new Error("There is no line "+(b+a.first)+" in the document.");for(var c=a;!c.lines;)for(var d=0;;++d){var e=c.children[d],f=e.chunkSize();if(b<f){c=e;break}b-=f}return c.lines[b]}function Zd(a,b,c){var d=[],e=b.line;return a.iter(b.line,c.line+1,function(a){var f=a.text;e==c.line&&(f=f.slice(0,c.ch)),e==b.line&&(f=f.slice(b.ch)),d.push(f),++e}),d}function $d(a,b,c){var d=[];return a.iter(b,c,function(a){d.push(a.text)}),d}function _d(a,b){var c=b-a.height;if(c)for(var d=a;d;d=d.parent)d.height+=c}function ae(a){if(null==a.parent)return null;for(var b=a.parent,c=Ge(b.lines,a),d=b.parent;d;b=d,d=d.parent)for(var e=0;d.children[e]!=b;++e)c+=d.children[e].chunkSize();return c+b.first}function be(a,b){var c=a.first;a:do{for(var d=0;d<a.children.length;++d){var e=a.children[d],f=e.height;if(b<f){a=e;continue a}b-=f,c+=e.chunkSize()}return c}while(!a.lines);for(var d=0;d<a.lines.length;++d){var g=a.lines[d],h=g.height;if(b<h)break;b-=h}return c+d}function ce(a){a=rd(a);for(var b=0,c=a.parent,d=0;d<c.lines.length;++d){var e=c.lines[d];if(e==a)break;b+=e.height}for(var f=c.parent;f;c=f,f=c.parent)for(var d=0;d<f.children.length;++d){var g=f.children[d];if(g==c)break;b+=g.height}return b}function de(a){var b=a.order;return null==b&&(b=a.order=fh(a.text)),b}function ee(a){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=a||1}function fe(a,b){var c={from:V(b.from),to:Zf(b),text:Zd(a,b.from,b.to)};return me(a,c,b.from.line,b.to.line+1),Wd(a,function(a){me(a,c,b.from.line,b.to.line+1)},!0),c}function ge(a){for(;a.length;){if(!Fe(a).ranges)break;a.pop()}}function he(a,b){return b?(ge(a.done),Fe(a.done)):a.done.length&&!Fe(a.done).ranges?Fe(a.done):a.done.length>1&&!a.done[a.done.length-2].ranges?(a.done.pop(),Fe(a.done)):void 0}function ie(a,b,c,d){var e=a.history;e.undone.length=0;var f,g=+new Date;if((e.lastOp==d||e.lastOrigin==b.origin&&b.origin&&("+"==b.origin.charAt(0)&&a.cm&&e.lastModTime>g-a.cm.options.historyEventDelay||"*"==b.origin.charAt(0)))&&(f=he(e,e.lastOp==d))){var h=Fe(f.changes);0==Lf(b.from,b.to)&&0==Lf(b.from,h.to)?h.to=Zf(b):f.changes.push(fe(a,b))}else{var i=Fe(e.done);for(i&&i.ranges||le(a.sel,e.done),f={changes:[fe(a,b)],generation:e.generation},e.done.push(f);e.done.length>e.undoDepth;)e.done.shift(),e.done[0].ranges||e.done.shift()}e.done.push(c),e.generation=++e.maxGeneration,e.lastModTime=e.lastSelTime=g,e.lastOp=e.lastSelOp=d,e.lastOrigin=e.lastSelOrigin=b.origin,h||Fg(a,"historyAdded")}function je(a,b,c,d){var e=b.charAt(0);return"*"==e||"+"==e&&c.ranges.length==d.ranges.length&&c.somethingSelected()==d.somethingSelected()&&new Date-a.history.lastSelTime<=(a.cm?a.cm.options.historyEventDelay:500)}function ke(a,b,c,d){var e=a.history,f=d&&d.origin;c==e.lastSelOp||f&&e.lastSelOrigin==f&&(e.lastModTime==e.lastSelTime&&e.lastOrigin==f||je(a,f,Fe(e.done),b))?e.done[e.done.length-1]=b:le(b,e.done),e.lastSelTime=+new Date,e.lastSelOrigin=f,e.lastSelOp=c,d&&d.clearRedo!==!1&&ge(e.undone)}function le(a,b){var c=Fe(b);c&&c.ranges&&c.equals(a)||b.push(a)}function me(a,b,c,d){var e=b["spans_"+a.id],f=0;a.iter(Math.max(a.first,c),Math.min(a.first+a.size,d),function(c){c.markedSpans&&((e||(e=b["spans_"+a.id]={}))[f]=c.markedSpans),++f})}function ne(a){if(!a)return null;for(var b,c=0;c<a.length;++c)a[c].marker.explicitlyCleared?b||(b=a.slice(0,c)):b&&b.push(a[c]);return b?b.length?b:null:a}function oe(a,b){var c=b["spans_"+a.id];if(!c)return null;for(var d=0,e=[];d<b.text.length;++d)e.push(ne(c[d]));return e}function pe(a,b,c){for(var d=0,e=[];d<a.length;++d){var f=a[d];if(f.ranges)e.push(c?ka.prototype.deepCopy.call(f):f);else{var g=f.changes,h=[];e.push({changes:h});for(var i=0;i<g.length;++i){var j,k=g[i];if(h.push({from:k.from,to:k.to,text:k.text}),b)for(var l in k)(j=l.match(/^spans_(\d+)$/))&&Ge(b,Number(j[1]))>-1&&(Fe(h)[l]=k[l],delete k[l])}}}return e}function qe(a,b,c,d){c<a.line?a.line+=d:b<a.line&&(a.line=b,a.ch=0)}function re(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e],g=!0;if(f.ranges){f.copied||(f=a[e]=f.deepCopy(),f.copied=!0);for(var h=0;h<f.ranges.length;h++)qe(f.ranges[h].anchor,b,c,d),qe(f.ranges[h].head,b,c,d)}else{for(var h=0;h<f.changes.length;++h){var i=f.changes[h];if(c<i.from.line)i.from=Kf(i.from.line+d,i.from.ch),i.to=Kf(i.to.line+d,i.to.ch);else if(b<=i.to.line){g=!1;break}}g||(a.splice(0,e+1),e=0)}}}function se(a,b){var c=b.from.line,d=b.to.line,e=b.text.length-(d-c)-1;re(a.done,c,d,e),re(a.undone,c,d,e)}function te(a){return null!=a.defaultPrevented?a.defaultPrevented:0==a.returnValue}function ue(a){return a.target||a.srcElement}function ve(a){var b=a.which;return null==b&&(1&a.button?b=1:2&a.button?b=3:4&a.button&&(b=2)),Df&&a.ctrlKey&&1==b&&(b=3),b}function we(a,b,c){var d=a._handlers&&a._handlers[b];return c?d&&d.length>0?d.slice():Dg:d||Dg}function xe(a,b){var c=we(a,b,!1);if(c.length){var d,e=Array.prototype.slice.call(arguments,2);Rf?d=Rf.delayedCallbacks:Gg?d=Gg:(d=Gg=[],setTimeout(ye,0));for(var f=0;f<c.length;++f)d.push(function(a){return function(){a.apply(null,e)}}(c[f]))}}function ye(){var a=Gg;Gg=null;for(var b=0;b<a.length;++b)a[b]()}function ze(a,b,c){return"string"==typeof b&&(b={type:b,preventDefault:function(){this.defaultPrevented=!0}}),Fg(a,c||b.type,a,b),te(b)||b.codemirrorIgnore}function Ae(a){var b=a._handlers&&a._handlers.cursorActivity;if(b)for(var c=a.curOp.cursorActivityHandlers||(a.curOp.cursorActivityHandlers=[]),d=0;d<b.length;++d)Ge(c,b[d])==-1&&c.push(b[d])}function Be(a,b){return we(a,b).length>0}function Ce(a){a.prototype.on=function(a,b){Cg(this,a,b)},a.prototype.off=function(a,b){Eg(this,a,b)}}function De(){this.id=null}function Ee(a){for(;Og.length<=a;)Og.push(Fe(Og)+" ");return Og[a]}function Fe(a){return a[a.length-1]}function Ge(a,b){for(var c=0;c<a.length;++c)if(a[c]==b)return c;return-1}function He(a,b){for(var c=[],d=0;d<a.length;d++)c[d]=b(a[d],d);return c}function Ie(){}function Je(a,b){var c;return Object.create?c=Object.create(a):(Ie.prototype=a,c=new Ie),b&&Ke(b,c),c}function Ke(a,b,c){b||(b={});for(var d in a)!a.hasOwnProperty(d)||c===!1&&b.hasOwnProperty(d)||(b[d]=a[d]);return b}function Le(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,b)}}function Me(a,b){return b?!!(b.source.indexOf("\\w")>-1&&Sg(a))||b.test(a):Sg(a)}function Ne(a){for(var b in a)if(a.hasOwnProperty(b)&&a[b])return!1;return!0}function Oe(a){return a.charCodeAt(0)>=768&&Tg.test(a)}function Pe(a,b,c,d){var e=document.createElement(a);if(c&&(e.className=c),d&&(e.style.cssText=d),"string"==typeof b)e.appendChild(document.createTextNode(b));else if(b)for(var f=0;f<b.length;++f)e.appendChild(b[f]);return e}function Qe(a){for(var b=a.childNodes.length;b>0;--b)a.removeChild(a.firstChild);return a}function Re(a,b){return Qe(a).appendChild(b)}function Se(){for(var a=document.activeElement;a&&a.root&&a.root.activeElement;)a=a.root.activeElement;return a}function Te(a){return new RegExp("(^|\\s)"+a+"(?:$|\\s)\\s*")}function Ue(a,b){for(var c=a.split(" "),d=0;d<c.length;d++)c[d]&&!Te(c[d]).test(b)&&(b+=" "+c[d]);return b}function Ve(a){if(document.body.getElementsByClassName)for(var b=document.body.getElementsByClassName("CodeMirror"),c=0;c<b.length;c++){var d=b[c].CodeMirror;d&&a(d)}}function We(){Zg||(Xe(),Zg=!0)}function Xe(){var a;Cg(window,"resize",function(){null==a&&(a=setTimeout(function(){a=null,Ve(Sb)},100))}),Cg(window,"blur",function(){Ve(rc)})}function Ye(a){if(null==Vg){var b=Pe("span","​");Re(a,Pe("span",[b,document.createTextNode("x")])),0!=a.firstChild.offsetHeight&&(Vg=b.offsetWidth<=1&&b.offsetHeight>2&&!(sf&&tf<8))}var c=Vg?Pe("span","​"):Pe("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return c.setAttribute("cm-text",""),c}function Ze(a){if(null!=Wg)return Wg;var b=Re(a,document.createTextNode("AخA")),c=Qg(b,0,1).getBoundingClientRect();if(!c||c.left==c.right)return!1;var d=Qg(b,1,2).getBoundingClientRect();return Wg=d.right-c.right<3}function $e(a){if(null!=ch)return ch;var b=Re(a,Pe("span","x")),c=b.getBoundingClientRect(),d=Qg(b,0,1).getBoundingClientRect();return ch=Math.abs(c.left-d.left)>1}function _e(a,b,c,d){if(!a)return d(b,c,"ltr");for(var e=!1,f=0;f<a.length;++f){var g=a[f];(g.from<c&&g.to>b||b==c&&g.to==b)&&(d(Math.max(g.from,b),Math.min(g.to,c),1==g.level?"rtl":"ltr"),e=!0)}e||d(b,c,"ltr")}function af(a){return a.level%2?a.to:a.from}function bf(a){return a.level%2?a.from:a.to}function cf(a){var b=de(a);return b?af(b[0]):0}function df(a){var b=de(a);return b?bf(Fe(b)):a.text.length}function ef(a,b){var c=Yd(a.doc,b),d=rd(c);d!=c&&(b=ae(d));var e=de(d),f=e?e[0].level%2?df(d):cf(d):0;return Kf(b,f)}function ff(a,b){for(var c,d=Yd(a.doc,b);c=pd(d);)d=c.find(1,!0).line,b=null;var e=de(d),f=e?e[0].level%2?cf(d):df(d):d.text.length;return Kf(null==b?ae(d):b,f)}function gf(a,b){var c=ef(a,b.line),d=Yd(a.doc,c.line),e=de(d);if(!e||0==e[0].level){var f=Math.max(0,d.text.search(/\S/)),g=b.line==c.line&&b.ch<=f&&b.ch;return Kf(c.line,g?0:f)}return c}function hf(a,b,c){var d=a[0].level;return b==d||c!=d&&b<c}function jf(a,b){eh=null;for(var c,d=0;d<a.length;++d){var e=a[d];if(e.from<b&&e.to>b)return d;if(e.from==b||e.to==b){if(null!=c)return hf(a,e.level,a[c].level)?(e.from!=e.to&&(eh=c),d):(e.from!=e.to&&(eh=d),c);c=d}}return c}function kf(a,b,c,d){if(!d)return b+c;do{b+=c}while(b>0&&Oe(a.text.charAt(b)));return b}function lf(a,b,c,d){var e=de(a);if(!e)return mf(a,b,c,d);for(var f=jf(e,b),g=e[f],h=kf(a,b,g.level%2?-c:c,d);;){if(h>g.from&&h<g.to)return h;if(h==g.from||h==g.to)return jf(e,h)==f?h:(g=e[f+=c],c>0==g.level%2?g.to:g.from);if(!(g=e[f+=c]))return null;h=c>0==g.level%2?kf(a,g.to,-1,d):kf(a,g.from,1,d)}}function mf(a,b,c,d){var e=b+c;if(d)for(;e>0&&Oe(a.text.charAt(e));)e+=c;return e<0||e>a.text.length?null:e}var nf=navigator.userAgent,of=navigator.platform,pf=/gecko\/\d/i.test(nf),qf=/MSIE \d/.test(nf),rf=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(nf),sf=qf||rf,tf=sf&&(qf?document.documentMode||6:rf[1]),uf=/WebKit\//.test(nf),vf=uf&&/Qt\/\d+\.\d+/.test(nf),wf=/Chrome\//.test(nf),xf=/Opera\//.test(nf),yf=/Apple Computer/.test(navigator.vendor),zf=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(nf),Af=/PhantomJS/.test(nf),Bf=/AppleWebKit/.test(nf)&&/Mobile\/\w+/.test(nf),Cf=Bf||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(nf),Df=Bf||/Mac/.test(of),Ef=/win/i.test(of),Ff=xf&&nf.match(/Version\/(\d*\.\d*)/);Ff&&(Ff=Number(Ff[1])),Ff&&Ff>=15&&(xf=!1,uf=!0);var Gf=Df&&(vf||xf&&(null==Ff||Ff<12.11)),Hf=pf||sf&&tf>=9,If=!1,Jf=!1;p.prototype=Ke({update:function(a){var b=a.scrollWidth>a.clientWidth+1,c=a.scrollHeight>a.clientHeight+1,d=a.nativeBarWidth;if(c){this.vert.style.display="block",this.vert.style.bottom=b?d+"px":"0";var e=a.viewHeight-(b?d:0);this.vert.firstChild.style.height=Math.max(0,a.scrollHeight-a.clientHeight+e)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(b){this.horiz.style.display="block",this.horiz.style.right=c?d+"px":"0",this.horiz.style.left=a.barLeft+"px";var f=a.viewWidth-a.barLeft-(c?d:0);this.horiz.firstChild.style.width=a.scrollWidth-a.clientWidth+f+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&a.clientHeight>0&&(0==d&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:c?d:0,bottom:b?d:0}},setScrollLeft:function(a){this.horiz.scrollLeft!=a&&(this.horiz.scrollLeft=a),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz)},setScrollTop:function(a){this.vert.scrollTop!=a&&(this.vert.scrollTop=a),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert)},zeroWidthHack:function(){var a=Df&&!zf?"12px":"18px";this.horiz.style.height=this.vert.style.width=a,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new De,this.disableVert=new De},enableZeroWidthBar:function(a,b){function c(){var d=a.getBoundingClientRect();document.elementFromPoint(d.left+1,d.bottom-1)!=a?a.style.pointerEvents="none":b.set(1e3,c)}a.style.pointerEvents="auto",b.set(1e3,c)},clear:function(){var a=this.horiz.parentNode;a.removeChild(this.horiz),a.removeChild(this.vert)}},p.prototype),q.prototype=Ke({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},q.prototype),a.scrollbarModel={native:p,null:q},z.prototype.signal=function(a,b){Be(a,b)&&this.events.push(arguments)},z.prototype.finish=function(){for(var a=0;a<this.events.length;a++)Fg.apply(null,this.events[a])};var Kf=a.Pos=function(a,b){if(!(this instanceof Kf))return new Kf(a,b);this.line=a,this.ch=b},Lf=a.cmpPos=function(a,b){return a.line-b.line||a.ch-b.ch},Mf=null;ca.prototype=Ke({init:function(a){function b(a){if(!ze(d,a)){if(d.somethingSelected())Mf=d.getSelections(),c.inaccurateSelection&&(c.prevInput="",c.inaccurateSelection=!1,f.value=Mf.join("\n"),Pg(f));else{if(!d.options.lineWiseCopyCut)return;var b=aa(d);Mf=b.text,"cut"==a.type?d.setSelections(b.ranges,null,Jg):(c.prevInput="",f.value=b.text.join("\n"),Pg(f))}
"cut"==a.type&&(d.state.cutIncoming=!0)}}var c=this,d=this.cm,e=this.wrapper=da(),f=this.textarea=e.firstChild;a.wrapper.insertBefore(e,a.wrapper.firstChild),Bf&&(f.style.width="0px"),Cg(f,"input",function(){sf&&tf>=9&&c.hasSelection&&(c.hasSelection=null),c.poll()}),Cg(f,"paste",function(a){ze(d,a)||$(a,d)||(d.state.pasteIncoming=!0,c.fastPoll())}),Cg(f,"cut",b),Cg(f,"copy",b),Cg(a.scroller,"paste",function(b){Tb(a,b)||ze(d,b)||(d.state.pasteIncoming=!0,c.focus())}),Cg(a.lineSpace,"selectstart",function(b){Tb(a,b)||zg(b)}),Cg(f,"compositionstart",function(){var a=d.getCursor("from");c.composing&&c.composing.range.clear(),c.composing={start:a,range:d.markText(a,d.getCursor("to"),{className:"CodeMirror-composing"})}}),Cg(f,"compositionend",function(){c.composing&&(c.poll(),c.composing.range.clear(),c.composing=null)})},prepareSelection:function(){var a=this.cm,b=a.display,c=a.doc,d=Ja(a);if(a.options.moveInputWithCursor){var e=nb(a,c.sel.primary().head,"div"),f=b.wrapper.getBoundingClientRect(),g=b.lineDiv.getBoundingClientRect();d.teTop=Math.max(0,Math.min(b.wrapper.clientHeight-10,e.top+g.top-f.top)),d.teLeft=Math.max(0,Math.min(b.wrapper.clientWidth-10,e.left+g.left-f.left))}return d},showSelection:function(a){var b=this.cm,c=b.display;Re(c.cursorDiv,a.cursors),Re(c.selectionDiv,a.selection),null!=a.teTop&&(this.wrapper.style.top=a.teTop+"px",this.wrapper.style.left=a.teLeft+"px")},reset:function(a){if(!this.contextMenuPending){var b,c,d=this.cm,e=d.doc;if(d.somethingSelected()){this.prevInput="";var f=e.sel.primary();b=bh&&(f.to().line-f.from().line>100||(c=d.getSelection()).length>1e3);var g=b?"-":c||d.getSelection();this.textarea.value=g,d.state.focused&&Pg(this.textarea),sf&&tf>=9&&(this.hasSelection=g)}else a||(this.prevInput=this.textarea.value="",sf&&tf>=9&&(this.hasSelection=null));this.inaccurateSelection=b}},getField:function(){return this.textarea},supportsTouch:function(){return!1},focus:function(){if("nocursor"!=this.cm.options.readOnly&&(!Cf||Se()!=this.textarea))try{this.textarea.focus()}catch(a){}},blur:function(){this.textarea.blur()},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var a=this;a.pollingFast||a.polling.set(this.cm.options.pollInterval,function(){a.poll(),a.cm.state.focused&&a.slowPoll()})},fastPoll:function(){function a(){c.poll()||b?(c.pollingFast=!1,c.slowPoll()):(b=!0,c.polling.set(60,a))}var b=!1,c=this;c.pollingFast=!0,c.polling.set(20,a)},poll:function(){var a=this.cm,b=this.textarea,c=this.prevInput;if(this.contextMenuPending||!a.state.focused||ah(b)&&!c&&!this.composing||a.isReadOnly()||a.options.disableInput||a.state.keySeq)return!1;var d=b.value;if(d==c&&!a.somethingSelected())return!1;if(sf&&tf>=9&&this.hasSelection===d||Df&&/[\uf700-\uf7ff]/.test(d))return a.display.input.reset(),!1;if(a.doc.sel==a.display.selForContextMenu){var e=d.charCodeAt(0);if(8203!=e||c||(c="​"),8666==e)return this.reset(),this.cm.execCommand("undo")}for(var f=0,g=Math.min(c.length,d.length);f<g&&c.charCodeAt(f)==d.charCodeAt(f);)++f;var h=this;return Db(a,function(){Z(a,d.slice(f),c.length-f,null,h.composing?"*compose":null),d.length>1e3||d.indexOf("\n")>-1?b.value=h.prevInput="":h.prevInput=d,h.composing&&(h.composing.range.clear(),h.composing.range=a.markText(h.composing.start,a.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},ensurePolled:function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},onKeyPress:function(){sf&&tf>=9&&(this.hasSelection=null),this.fastPoll()},onContextMenu:function(a){function b(){if(null!=g.selectionStart){var a=e.somethingSelected(),b="​"+(a?g.value:"");g.value="⇚",g.value=b,d.prevInput=a?"":"​",g.selectionStart=1,g.selectionEnd=b.length,f.selForContextMenu=e.doc.sel}}function c(){if(d.contextMenuPending=!1,d.wrapper.style.cssText=k,g.style.cssText=j,sf&&tf<9&&f.scrollbars.setScrollTop(f.scroller.scrollTop=i),null!=g.selectionStart){(!sf||sf&&tf<9)&&b();var a=0,c=function(){f.selForContextMenu==e.doc.sel&&0==g.selectionStart&&g.selectionEnd>0&&"​"==d.prevInput?Eb(e,ig.selectAll)(e):a++<10?f.detectingSelectAll=setTimeout(c,500):f.input.reset()};f.detectingSelectAll=setTimeout(c,200)}}var d=this,e=d.cm,f=e.display,g=d.textarea,h=Ub(e,a),i=f.scroller.scrollTop;if(h&&!xf){e.options.resetSelectionOnContextMenu&&e.doc.sel.contains(h)==-1&&Eb(e,Aa)(e.doc,na(h),Jg);var j=g.style.cssText,k=d.wrapper.style.cssText;d.wrapper.style.cssText="position: absolute";var l=d.wrapper.getBoundingClientRect();if(g.style.cssText="position: absolute; width: 30px; height: 30px; top: "+(a.clientY-l.top-5)+"px; left: "+(a.clientX-l.left-5)+"px; z-index: 1000; background: "+(sf?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",uf)var m=window.scrollY;if(f.input.focus(),uf&&window.scrollTo(null,m),f.input.reset(),e.somethingSelected()||(g.value=d.prevInput=" "),d.contextMenuPending=!0,f.selForContextMenu=e.doc.sel,clearTimeout(f.detectingSelectAll),sf&&tf>=9&&b(),Hf){Bg(a);var n=function(){Eg(window,"mouseup",n),setTimeout(c,20)};Cg(window,"mouseup",n)}else setTimeout(c,50)}},readOnlyChanged:function(a){a||this.reset()},setUneditable:Ie,needsContentAttribute:!1},ca.prototype),ea.prototype=Ke({init:function(a){function b(a){if(!ze(d,a)){if(d.somethingSelected())Mf=d.getSelections(),"cut"==a.type&&d.replaceSelection("",null,"cut");else{if(!d.options.lineWiseCopyCut)return;var b=aa(d);Mf=b.text,"cut"==a.type&&d.operation(function(){d.setSelections(b.ranges,0,Jg),d.replaceSelection("",null,"cut")})}if(a.clipboardData&&!Bf)a.preventDefault(),a.clipboardData.clearData(),a.clipboardData.setData("text/plain",Mf.join("\n"));else{var c=da(),e=c.firstChild;d.display.lineSpace.insertBefore(c,d.display.lineSpace.firstChild),e.value=Mf.join("\n");var f=document.activeElement;Pg(e),setTimeout(function(){d.display.lineSpace.removeChild(c),f.focus()},50)}}}var c=this,d=c.cm,e=c.div=a.lineDiv;ba(e),Cg(e,"paste",function(a){ze(d,a)||$(a,d)}),Cg(e,"compositionstart",function(a){var b=a.data;if(c.composing={sel:d.doc.sel,data:b,startData:b},b){var e=d.doc.sel.primary(),f=d.getLine(e.head.line),g=f.indexOf(b,Math.max(0,e.head.ch-b.length));g>-1&&g<=e.head.ch&&(c.composing.sel=na(Kf(e.head.line,g),Kf(e.head.line,g+b.length)))}}),Cg(e,"compositionupdate",function(a){c.composing.data=a.data}),Cg(e,"compositionend",function(a){var b=c.composing;b&&(a.data==b.startData||/\u200b/.test(a.data)||(b.data=a.data),setTimeout(function(){b.handled||c.applyComposition(b),c.composing==b&&(c.composing=null)},50))}),Cg(e,"touchstart",function(){c.forceCompositionEnd()}),Cg(e,"input",function(){c.composing||!d.isReadOnly()&&c.pollContent()||Db(c.cm,function(){Jb(d)})}),Cg(e,"copy",b),Cg(e,"cut",b)},prepareSelection:function(){var a=Ja(this.cm,!1);return a.focus=this.cm.state.focused,a},showSelection:function(a){a&&this.cm.display.view.length&&(a.focus&&this.showPrimarySelection(),this.showMultipleSelections(a))},showPrimarySelection:function(){var a=window.getSelection(),b=this.cm.doc.sel.primary(),c=ha(this.cm,a.anchorNode,a.anchorOffset),d=ha(this.cm,a.focusNode,a.focusOffset);if(!c||c.bad||!d||d.bad||0!=Lf(X(c,d),b.from())||0!=Lf(W(c,d),b.to())){var e=fa(this.cm,b.from()),f=fa(this.cm,b.to());if(e||f){var g=this.cm.display.view,h=a.rangeCount&&a.getRangeAt(0);if(e){if(!f){var i=g[g.length-1].measure,j=i.maps?i.maps[i.maps.length-1]:i.map;f={node:j[j.length-1],offset:j[j.length-2]-j[j.length-3]}}}else e={node:g[0].measure.map[2],offset:0};try{var k=Qg(e.node,e.offset,f.offset,f.node)}catch(a){}k&&(!pf&&this.cm.state.focused?(a.collapse(e.node,e.offset),k.collapsed||a.addRange(k)):(a.removeAllRanges(),a.addRange(k)),h&&null==a.anchorNode?a.addRange(h):pf&&this.startGracePeriod()),this.rememberSelection()}}},startGracePeriod:function(){var a=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){a.gracePeriod=!1,a.selectionChanged()&&a.cm.operation(function(){a.cm.curOp.selectionChanged=!0})},20)},showMultipleSelections:function(a){Re(this.cm.display.cursorDiv,a.cursors),Re(this.cm.display.selectionDiv,a.selection)},rememberSelection:function(){var a=window.getSelection();this.lastAnchorNode=a.anchorNode,this.lastAnchorOffset=a.anchorOffset,this.lastFocusNode=a.focusNode,this.lastFocusOffset=a.focusOffset},selectionInEditor:function(){var a=window.getSelection();if(!a.rangeCount)return!1;var b=a.getRangeAt(0).commonAncestorContainer;return Ug(this.div,b)},focus:function(){"nocursor"!=this.cm.options.readOnly&&this.div.focus()},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return!0},receivedFocus:function(){function a(){b.cm.state.focused&&(b.pollSelection(),b.polling.set(b.cm.options.pollInterval,a))}var b=this;this.selectionInEditor()?this.pollSelection():Db(this.cm,function(){b.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,a)},selectionChanged:function(){var a=window.getSelection();return a.anchorNode!=this.lastAnchorNode||a.anchorOffset!=this.lastAnchorOffset||a.focusNode!=this.lastFocusNode||a.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var a=window.getSelection(),b=this.cm;this.rememberSelection();var c=ha(b,a.anchorNode,a.anchorOffset),d=ha(b,a.focusNode,a.focusOffset);c&&d&&Db(b,function(){Aa(b.doc,na(c,d),Jg),(c.bad||d.bad)&&(b.curOp.selectionChanged=!0)})}},pollContent:function(){var a=this.cm,b=a.display,c=a.doc.sel.primary(),d=c.from(),e=c.to();if(d.line<b.viewFrom||e.line>b.viewTo-1)return!1;var f;if(d.line==b.viewFrom||0==(f=Mb(a,d.line)))var g=ae(b.view[0].line),h=b.view[0].node;else var g=ae(b.view[f].line),h=b.view[f-1].node.nextSibling;var i=Mb(a,e.line);if(i==b.view.length-1)var j=b.viewTo-1,k=b.lineDiv.lastChild;else var j=ae(b.view[i+1].line)-1,k=b.view[i+1].node.previousSibling;for(var l=a.doc.splitLines(ja(a,h,k,g,j)),m=Zd(a.doc,Kf(g,0),Kf(j,Yd(a.doc,j).text.length));l.length>1&&m.length>1;)if(Fe(l)==Fe(m))l.pop(),m.pop(),j--;else{if(l[0]!=m[0])break;l.shift(),m.shift(),g++}for(var n=0,o=0,p=l[0],q=m[0],r=Math.min(p.length,q.length);n<r&&p.charCodeAt(n)==q.charCodeAt(n);)++n;for(var s=Fe(l),t=Fe(m),u=Math.min(s.length-(1==l.length?n:0),t.length-(1==m.length?n:0));o<u&&s.charCodeAt(s.length-o-1)==t.charCodeAt(t.length-o-1);)++o;l[l.length-1]=s.slice(0,s.length-o),l[0]=l[0].slice(n);var v=Kf(g,n),w=Kf(j,m.length?Fe(m).length-o:0);return l.length>1||l[0]||Lf(v,w)?(Fc(a.doc,l,v,w,"+input"),!0):void 0},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){this.composing&&!this.composing.handled&&(this.applyComposition(this.composing),this.composing.handled=!0,this.div.blur(),this.div.focus())},applyComposition:function(a){this.cm.isReadOnly()?Eb(this.cm,Jb)(this.cm):a.data&&a.data!=a.startData&&Eb(this.cm,Z)(this.cm,a.data,0,a.sel)},setUneditable:function(a){a.contentEditable="false"},onKeyPress:function(a){a.preventDefault(),this.cm.isReadOnly()||Eb(this.cm,Z)(this.cm,String.fromCharCode(null==a.charCode?a.keyCode:a.charCode),0)},readOnlyChanged:function(a){this.div.contentEditable=String("nocursor"!=a)},onContextMenu:Ie,resetPosition:Ie,needsContentAttribute:!0},ea.prototype),a.inputStyles={textarea:ca,contenteditable:ea},ka.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(a){if(a==this)return!0;if(a.primIndex!=this.primIndex||a.ranges.length!=this.ranges.length)return!1;for(var b=0;b<this.ranges.length;b++){var c=this.ranges[b],d=a.ranges[b];if(0!=Lf(c.anchor,d.anchor)||0!=Lf(c.head,d.head))return!1}return!0},deepCopy:function(){for(var a=[],b=0;b<this.ranges.length;b++)a[b]=new la(V(this.ranges[b].anchor),V(this.ranges[b].head));return new ka(a,this.primIndex)},somethingSelected:function(){for(var a=0;a<this.ranges.length;a++)if(!this.ranges[a].empty())return!0;return!1},contains:function(a,b){b||(b=a);for(var c=0;c<this.ranges.length;c++){var d=this.ranges[c];if(Lf(b,d.from())>=0&&Lf(a,d.to())<=0)return c}return-1}},la.prototype={from:function(){return X(this.anchor,this.head)},to:function(){return W(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var Nf,Of,Pf,Qf={left:0,right:0,top:0,bottom:0},Rf=null,Sf=0,Tf=0,Uf=0,Vf=null;sf?Vf=-.53:pf?Vf=15:wf?Vf=-.7:yf&&(Vf=-1/3);var Wf=function(a){var b=a.wheelDeltaX,c=a.wheelDeltaY;return null==b&&a.detail&&a.axis==a.HORIZONTAL_AXIS&&(b=a.detail),null==c&&a.detail&&a.axis==a.VERTICAL_AXIS?c=a.detail:null==c&&(c=a.wheelDelta),{x:b,y:c}};a.wheelEventPixels=function(a){var b=Wf(a);return b.x*=Vf,b.y*=Vf,b};var Xf=new De,Yf=null,Zf=a.changeEnd=function(a){return a.text?Kf(a.from.line+a.text.length-1,Fe(a.text).length+(1==a.text.length?a.from.ch:0)):a.to};a.prototype={constructor:a,focus:function(){window.focus(),this.display.input.focus()},setOption:function(a,b){var c=this.options,d=c[a];c[a]==b&&"mode"!=a||(c[a]=b,_f.hasOwnProperty(a)&&Eb(this,_f[a])(this,b,d))},getOption:function(a){return this.options[a]},getDoc:function(){return this.doc},addKeyMap:function(a,b){this.state.keyMaps[b?"push":"unshift"](Uc(a))},removeKeyMap:function(a){for(var b=this.state.keyMaps,c=0;c<b.length;++c)if(b[c]==a||b[c].name==a)return b.splice(c,1),!0},addOverlay:Fb(function(b,c){var d=b.token?b:a.getMode(this.options,b);if(d.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:d,modeSpec:b,opaque:c&&c.opaque}),this.state.modeGen++,Jb(this)}),removeOverlay:Fb(function(a){for(var b=this.state.overlays,c=0;c<b.length;++c){var d=b[c].modeSpec;if(d==a||"string"==typeof a&&d.name==a)return b.splice(c,1),this.state.modeGen++,void Jb(this)}}),indentLine:Fb(function(a,b,c){"string"!=typeof b&&"number"!=typeof b&&(b=null==b?this.options.smartIndent?"smart":"prev":b?"add":"subtract"),ra(this.doc,a)&&Nc(this,a,b,c)}),indentSelection:Fb(function(a){for(var b=this.doc.sel.ranges,c=-1,d=0;d<b.length;d++){var e=b[d];if(e.empty())e.head.line>c&&(Nc(this,e.head.line,a,!0),c=e.head.line,d==this.doc.sel.primIndex&&Lc(this));else{var f=e.from(),g=e.to(),h=Math.max(c,f.line);c=Math.min(this.lastLine(),g.line-(g.ch?0:1))+1;for(var i=h;i<c;++i)Nc(this,i,a);var j=this.doc.sel.ranges;0==f.ch&&b.length==j.length&&j[d].from().ch>0&&wa(this.doc,d,new la(f,j[d].to()),Jg)}}}),getTokenAt:function(a,b){return Fd(this,a,b)},getLineTokens:function(a,b){return Fd(this,Kf(a),b,!0)},getTokenTypeAt:function(a){a=pa(this.doc,a);var b,c=Id(this,Yd(this.doc,a.line)),d=0,e=(c.length-1)/2,f=a.ch;if(0==f)b=c[2];else for(;;){var g=d+e>>1;if((g?c[2*g-1]:0)>=f)e=g;else{if(!(c[2*g+1]<f)){b=c[2*g+2];break}d=g+1}}var h=b?b.indexOf("cm-overlay "):-1;return h<0?b:0==h?null:b.slice(0,h-1)},getModeAt:function(b){var c=this.doc.mode;return c.innerMode?a.innerMode(c,this.getTokenAt(b).state).mode:c},getHelper:function(a,b){return this.getHelpers(a,b)[0]},getHelpers:function(a,b){var c=[];if(!fg.hasOwnProperty(b))return c;var d=fg[b],e=this.getModeAt(a);if("string"==typeof e[b])d[e[b]]&&c.push(d[e[b]]);else if(e[b])for(var f=0;f<e[b].length;f++){var g=d[e[b][f]];g&&c.push(g)}else e.helperType&&d[e.helperType]?c.push(d[e.helperType]):d[e.name]&&c.push(d[e.name]);for(var f=0;f<d._global.length;f++){var h=d._global[f];h.pred(e,this)&&Ge(c,h.val)==-1&&c.push(h.val)}return c},getStateAfter:function(a,b){var c=this.doc;return a=oa(c,null==a?c.first+c.size-1:a),Qa(this,a+1,b)},cursorCoords:function(a,b){var c,d=this.doc.sel.primary();return c=null==a?d.head:"object"==typeof a?pa(this.doc,a):a?d.from():d.to(),nb(this,c,b||"page")},charCoords:function(a,b){return mb(this,pa(this.doc,a),b||"page")},coordsChar:function(a,b){return a=lb(this,a,b||"page"),qb(this,a.left,a.top)},lineAtHeight:function(a,b){return a=lb(this,{top:a,left:0},b||"page").top,be(this.doc,a+this.display.viewOffset)},heightAtLine:function(a,b){var c,d=!1;if("number"==typeof a){var e=this.doc.first+this.doc.size-1;a<this.doc.first?a=this.doc.first:a>e&&(a=e,d=!0),c=Yd(this.doc,a)}else c=a;return kb(this,c,{top:0,left:0},b||"page").top+(d?this.doc.height-ce(c):0)},defaultTextHeight:function(){return sb(this.display)},defaultCharWidth:function(){return tb(this.display)},setGutterMarker:Fb(function(a,b,c){return Oc(this.doc,a,"gutter",function(a){var d=a.gutterMarkers||(a.gutterMarkers={});return d[b]=c,!c&&Ne(d)&&(a.gutterMarkers=null),!0})}),clearGutter:Fb(function(a){var b=this,c=b.doc,d=c.first;c.iter(function(c){c.gutterMarkers&&c.gutterMarkers[a]&&(c.gutterMarkers[a]=null,Kb(b,d,"gutter"),Ne(c.gutterMarkers)&&(c.gutterMarkers=null)),++d})}),lineInfo:function(a){if("number"==typeof a){if(!ra(this.doc,a))return null;var b=a;if(!(a=Yd(this.doc,a)))return null}else{var b=ae(a);if(null==b)return null}return{line:b,handle:a,text:a.text,gutterMarkers:a.gutterMarkers,textClass:a.textClass,bgClass:a.bgClass,wrapClass:a.wrapClass,widgets:a.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(a,b,c,d,e){var f=this.display;a=nb(this,pa(this.doc,a));var g=a.bottom,h=a.left;if(b.style.position="absolute",b.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(b),f.sizer.appendChild(b),"over"==d)g=a.top;else if("above"==d||"near"==d){var i=Math.max(f.wrapper.clientHeight,this.doc.height),j=Math.max(f.sizer.clientWidth,f.lineSpace.clientWidth);("above"==d||a.bottom+b.offsetHeight>i)&&a.top>b.offsetHeight?g=a.top-b.offsetHeight:a.bottom+b.offsetHeight<=i&&(g=a.bottom),h+b.offsetWidth>j&&(h=j-b.offsetWidth)}b.style.top=g+"px",b.style.left=b.style.right="","right"==e?(h=f.sizer.clientWidth-b.offsetWidth,b.style.right="0px"):("left"==e?h=0:"middle"==e&&(h=(f.sizer.clientWidth-b.offsetWidth)/2),b.style.left=h+"px"),c&&Ic(this,h,g,h+b.offsetWidth,g+b.offsetHeight)},triggerOnKeyDown:Fb(lc),triggerOnKeyPress:Fb(oc),triggerOnKeyUp:nc,execCommand:function(a){if(ig.hasOwnProperty(a))return ig[a].call(null,this)},triggerElectric:Fb(function(a){_(this,a)}),findPosH:function(a,b,c,d){var e=1;b<0&&(e=-1,b=-b);for(var f=0,g=pa(this.doc,a);f<b&&(g=Qc(this.doc,g,e,c,d),!g.hitSide);++f);return g},moveH:Fb(function(a,b){var c=this;c.extendSelectionsBy(function(d){return c.display.shift||c.doc.extend||d.empty()?Qc(c.doc,d.head,a,b,c.options.rtlMoveVisually):a<0?d.from():d.to()},Lg)}),deleteH:Fb(function(a,b){var c=this.doc.sel,d=this.doc;c.somethingSelected()?d.replaceSelection("",null,"+delete"):Pc(this,function(c){var e=Qc(d,c.head,a,b,!1);return a<0?{from:e,to:c.head}:{from:c.head,to:e}})}),findPosV:function(a,b,c,d){var e=1,f=d;b<0&&(e=-1,b=-b);for(var g=0,h=pa(this.doc,a);g<b;++g){var i=nb(this,h,"div");if(null==f?f=i.left:i.left=f,h=Rc(this,i,e,c),h.hitSide)break}return h},moveV:Fb(function(a,b){var c=this,d=this.doc,e=[],f=!c.display.shift&&!d.extend&&d.sel.somethingSelected();if(d.extendSelectionsBy(function(g){if(f)return a<0?g.from():g.to();var h=nb(c,g.head,"div");null!=g.goalColumn&&(h.left=g.goalColumn),e.push(h.left);var i=Rc(c,h,a,b);return"page"==b&&g==d.sel.primary()&&Kc(c,null,mb(c,i,"div").top-h.top),i},Lg),e.length)for(var g=0;g<d.sel.ranges.length;g++)d.sel.ranges[g].goalColumn=e[g]}),findWordAt:function(a){var b=this.doc,c=Yd(b,a.line).text,d=a.ch,e=a.ch;if(c){var f=this.getHelper(a,"wordChars");(a.xRel<0||e==c.length)&&d?--d:++e;for(var g=c.charAt(d),h=Me(g,f)?function(a){return Me(a,f)}:/\s/.test(g)?function(a){return/\s/.test(a)}:function(a){return!/\s/.test(a)&&!Me(a)};d>0&&h(c.charAt(d-1));)--d;for(;e<c.length&&h(c.charAt(e));)++e}return new la(Kf(a.line,d),Kf(a.line,e))},toggleOverwrite:function(a){null!=a&&a==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?Yg(this.display.cursorDiv,"CodeMirror-overwrite"):Xg(this.display.cursorDiv,"CodeMirror-overwrite"),Fg(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==Se()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:Fb(function(a,b){null==a&&null==b||Mc(this),null!=a&&(this.curOp.scrollLeft=a),null!=b&&(this.curOp.scrollTop=b)}),getScrollInfo:function(){var a=this.display.scroller;return{left:a.scrollLeft,top:a.scrollTop,height:a.scrollHeight-Ua(this)-this.display.barHeight,width:a.scrollWidth-Ua(this)-this.display.barWidth,clientHeight:Wa(this),clientWidth:Va(this)}},scrollIntoView:Fb(function(a,b){if(null==a?(a={from:this.doc.sel.primary().head,to:null},null==b&&(b=this.options.cursorScrollMargin)):"number"==typeof a?a={from:Kf(a,0),to:null}:null==a.from&&(a={from:a,to:null}),a.to||(a.to=a.from),a.margin=b||0,null!=a.from.line)Mc(this),this.curOp.scrollToPos=a;else{var c=Jc(this,Math.min(a.from.left,a.to.left),Math.min(a.from.top,a.to.top)-a.margin,Math.max(a.from.right,a.to.right),Math.max(a.from.bottom,a.to.bottom)+a.margin);this.scrollTo(c.scrollLeft,c.scrollTop)}}),setSize:Fb(function(a,b){function c(a){return"number"==typeof a||/^\d+$/.test(String(a))?a+"px":a}var d=this;null!=a&&(d.display.wrapper.style.width=c(a)),null!=b&&(d.display.wrapper.style.height=c(b)),d.options.lineWrapping&&gb(this);var e=d.display.viewFrom;d.doc.iter(e,d.display.viewTo,function(a){if(a.widgets)for(var b=0;b<a.widgets.length;b++)if(a.widgets[b].noHScroll){Kb(d,e,"widget");break}++e}),d.curOp.forceUpdate=!0,Fg(d,"refresh",this)}),operation:function(a){return Db(this,a)},refresh:Fb(function(){var a=this.display.cachedTextHeight;Jb(this),this.curOp.forceUpdate=!0,hb(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),k(this),(null==a||Math.abs(a-sb(this.display))>.5)&&g(this),Fg(this,"refresh",this)}),swapDoc:Fb(function(a){var b=this.doc;return b.cm=null,Xd(this,a),hb(this),this.display.input.reset(),this.scrollTo(a.scrollLeft,a.scrollTop),this.curOp.forceScroll=!0,xe(this,"swapDoc",this,b),b}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Ce(a);var $f=a.defaults={},_f=a.optionHandlers={},ag=a.Init={toString:function(){return"CodeMirror.Init"}};Sc("value","",function(a,b){a.setValue(b)},!0),Sc("mode",null,function(a,b){a.doc.modeOption=b,c(a)},!0),Sc("indentUnit",2,c,!0),Sc("indentWithTabs",!1),Sc("smartIndent",!0),Sc("tabSize",4,function(a){d(a),hb(a),Jb(a)},!0),Sc("lineSeparator",null,function(a,b){if(a.doc.lineSep=b,b){var c=[],d=a.doc.first;a.doc.iter(function(a){for(var e=0;;){var f=a.text.indexOf(b,e);if(f==-1)break;e=f+b.length,c.push(Kf(d,f))}d++});for(var e=c.length-1;e>=0;e--)Fc(a.doc,b,c[e],Kf(c[e].line,c[e].ch+b.length))}}),Sc("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(b,c,d){b.state.specialChars=new RegExp(c.source+(c.test("\t")?"":"|\t"),"g"),d!=a.Init&&b.refresh()}),Sc("specialCharPlaceholder",Md,function(a){a.refresh()},!0),Sc("electricChars",!0),Sc("inputStyle",Cf?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),Sc("rtlMoveVisually",!Ef),Sc("wholeLineUpdateBefore",!0),Sc("theme","default",function(a){h(a),i(a)},!0),Sc("keyMap","default",function(b,c,d){var e=Uc(c),f=d!=a.Init&&Uc(d);f&&f.detach&&f.detach(b,e),e.attach&&e.attach(b,f||null)}),Sc("extraKeys",null),Sc("lineWrapping",!1,e,!0),Sc("gutters",[],function(a){n(a.options),i(a)},!0),Sc("fixedGutter",!0,function(a,b){a.display.gutters.style.left=b?y(a.display)+"px":"0",a.refresh()},!0),Sc("coverGutterNextToScrollbar",!1,function(a){s(a)},!0),Sc("scrollbarStyle","native",function(a){r(a),s(a),a.display.scrollbars.setScrollTop(a.doc.scrollTop),a.display.scrollbars.setScrollLeft(a.doc.scrollLeft)},!0),Sc("lineNumbers",!1,function(a){n(a.options),i(a)},!0),Sc("firstLineNumber",1,i,!0),Sc("lineNumberFormatter",function(a){return a},i,!0),Sc("showCursorWhenSelecting",!1,Ia,!0),Sc("resetSelectionOnContextMenu",!0),Sc("lineWiseCopyCut",!0),Sc("readOnly",!1,function(a,b){"nocursor"==b?(rc(a),a.display.input.blur(),a.display.disabled=!0):a.display.disabled=!1,a.display.input.readOnlyChanged(b)}),Sc("disableInput",!1,function(a,b){b||a.display.input.reset()},!0),Sc("dragDrop",!0,Rb),Sc("allowDropFileTypes",null),Sc("cursorBlinkRate",530),Sc("cursorScrollMargin",0),Sc("cursorHeight",1,Ia,!0),Sc("singleCursorHeightPerLine",!0,Ia,!0),Sc("workTime",100),Sc("workDelay",100),Sc("flattenSpans",!0,d,!0),Sc("addModeClass",!1,d,!0),Sc("pollInterval",100),Sc("undoDepth",200,function(a,b){a.doc.history.undoDepth=b}),Sc("historyEventDelay",1250),Sc("viewportMargin",10,function(a){a.refresh()},!0),Sc("maxHighlightLength",1e4,d,!0),Sc("moveInputWithCursor",!0,function(a,b){b||a.display.input.resetPosition()}),Sc("tabindex",null,function(a,b){a.display.input.getField().tabIndex=b||""}),Sc("autofocus",null);var bg=a.modes={},cg=a.mimeModes={};a.defineMode=function(b,c){a.defaults.mode||"null"==b||(a.defaults.mode=b),arguments.length>2&&(c.dependencies=Array.prototype.slice.call(arguments,2)),bg[b]=c},a.defineMIME=function(a,b){cg[a]=b},a.resolveMode=function(b){if("string"==typeof b&&cg.hasOwnProperty(b))b=cg[b];else if(b&&"string"==typeof b.name&&cg.hasOwnProperty(b.name)){var c=cg[b.name];"string"==typeof c&&(c={name:c}),b=Je(c,b),b.name=c.name}else if("string"==typeof b&&/^[\w\-]+\/[\w\-]+\+xml$/.test(b))return a.resolveMode("application/xml");return"string"==typeof b?{name:b}:b||{name:"null"}},a.getMode=function(b,c){var c=a.resolveMode(c),d=bg[c.name];if(!d)return a.getMode(b,"text/plain");var e=d(b,c);if(dg.hasOwnProperty(c.name)){var f=dg[c.name];for(var g in f)f.hasOwnProperty(g)&&(e.hasOwnProperty(g)&&(e["_"+g]=e[g]),e[g]=f[g])}if(e.name=c.name,c.helperType&&(e.helperType=c.helperType),c.modeProps)for(var g in c.modeProps)e[g]=c.modeProps[g];return e},a.defineMode("null",function(){return{token:function(a){a.skipToEnd()}}}),a.defineMIME("text/plain","null");var dg=a.modeExtensions={};a.extendMode=function(a,b){Ke(b,dg.hasOwnProperty(a)?dg[a]:dg[a]={})},a.defineExtension=function(b,c){a.prototype[b]=c},a.defineDocExtension=function(a,b){wg.prototype[a]=b},a.defineOption=Sc;var eg=[];a.defineInitHook=function(a){eg.push(a)};var fg=a.helpers={};a.registerHelper=function(b,c,d){fg.hasOwnProperty(b)||(fg[b]=a[b]={_global:[]}),fg[b][c]=d},a.registerGlobalHelper=function(b,c,d,e){a.registerHelper(b,c,e),fg[b]._global.push({pred:d,val:e})};var gg=a.copyState=function(a,b){if(b===!0)return b;if(a.copyState)return a.copyState(b);var c={};for(var d in b){var e=b[d];e instanceof Array&&(e=e.concat([])),c[d]=e}return c},hg=a.startState=function(a,b,c){return!a.startState||a.startState(b,c)};a.innerMode=function(a,b){for(;a.innerMode;){var c=a.innerMode(b);if(!c||c.mode==a)break;b=c.state,a=c.mode}return c||{mode:a,state:b}};var ig=a.commands={selectAll:function(a){a.setSelection(Kf(a.firstLine(),0),Kf(a.lastLine()),Jg)},singleSelection:function(a){a.setSelection(a.getCursor("anchor"),a.getCursor("head"),Jg)},killLine:function(a){Pc(a,function(b){if(b.empty()){var c=Yd(a.doc,b.head.line).text.length;return b.head.ch==c&&b.head.line<a.lastLine()?{from:b.head,to:Kf(b.head.line+1,0)}:{from:b.head,to:Kf(b.head.line,c)}}return{from:b.from(),to:b.to()}})},deleteLine:function(a){Pc(a,function(b){return{from:Kf(b.from().line,0),to:pa(a.doc,Kf(b.to().line+1,0))}})},delLineLeft:function(a){Pc(a,function(a){return{from:Kf(a.from().line,0),to:a.from()}})},delWrappedLineLeft:function(a){Pc(a,function(b){var c=a.charCoords(b.head,"div").top+5;return{from:a.coordsChar({left:0,top:c},"div"),to:b.from()}})},delWrappedLineRight:function(a){Pc(a,function(b){var c=a.charCoords(b.head,"div").top+5,d=a.coordsChar({left:a.display.lineDiv.offsetWidth+100,top:c},"div");return{from:b.from(),to:d}})},undo:function(a){a.undo()},redo:function(a){a.redo()},undoSelection:function(a){a.undoSelection()},redoSelection:function(a){a.redoSelection()},goDocStart:function(a){a.extendSelection(Kf(a.firstLine(),0))},goDocEnd:function(a){a.extendSelection(Kf(a.lastLine()))},goLineStart:function(a){a.extendSelectionsBy(function(b){return ef(a,b.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(a){a.extendSelectionsBy(function(b){return gf(a,b.head)},{origin:"+move",bias:1})},goLineEnd:function(a){a.extendSelectionsBy(function(b){return ff(a,b.head.line)},{origin:"+move",bias:-1})},goLineRight:function(a){a.extendSelectionsBy(function(b){var c=a.charCoords(b.head,"div").top+5;return a.coordsChar({left:a.display.lineDiv.offsetWidth+100,top:c},"div")},Lg)},goLineLeft:function(a){a.extendSelectionsBy(function(b){var c=a.charCoords(b.head,"div").top+5;return a.coordsChar({left:0,top:c},"div")},Lg)},goLineLeftSmart:function(a){a.extendSelectionsBy(function(b){var c=a.charCoords(b.head,"div").top+5,d=a.coordsChar({left:0,top:c},"div");return d.ch<a.getLine(d.line).search(/\S/)?gf(a,b.head):d},Lg)},goLineUp:function(a){a.moveV(-1,"line")},goLineDown:function(a){a.moveV(1,"line")},goPageUp:function(a){a.moveV(-1,"page")},goPageDown:function(a){a.moveV(1,"page")},goCharLeft:function(a){a.moveH(-1,"char")},goCharRight:function(a){a.moveH(1,"char")},goColumnLeft:function(a){a.moveH(-1,"column")},goColumnRight:function(a){a.moveH(1,"column")},goWordLeft:function(a){a.moveH(-1,"word")},goGroupRight:function(a){a.moveH(1,"group")},goGroupLeft:function(a){a.moveH(-1,"group")},goWordRight:function(a){a.moveH(1,"word")},delCharBefore:function(a){a.deleteH(-1,"char")},delCharAfter:function(a){a.deleteH(1,"char")},delWordBefore:function(a){a.deleteH(-1,"word")},delWordAfter:function(a){a.deleteH(1,"word")},delGroupBefore:function(a){a.deleteH(-1,"group")},delGroupAfter:function(a){a.deleteH(1,"group")},indentAuto:function(a){a.indentSelection("smart")},indentMore:function(a){a.indentSelection("add")},indentLess:function(a){a.indentSelection("subtract")},insertTab:function(a){a.replaceSelection("\t")},insertSoftTab:function(a){for(var b=[],c=a.listSelections(),d=a.options.tabSize,e=0;e<c.length;e++){var f=c[e].from(),g=Mg(a.getLine(f.line),f.ch,d);b.push(new Array(d-g%d+1).join(" "))}a.replaceSelections(b)},defaultTab:function(a){a.somethingSelected()?a.indentSelection("add"):a.execCommand("insertTab")},transposeChars:function(a){Db(a,function(){for(var b=a.listSelections(),c=[],d=0;d<b.length;d++){var e=b[d].head,f=Yd(a.doc,e.line).text;if(f)if(e.ch==f.length&&(e=new Kf(e.line,e.ch-1)),e.ch>0)e=new Kf(e.line,e.ch+1),a.replaceRange(f.charAt(e.ch-1)+f.charAt(e.ch-2),Kf(e.line,e.ch-2),e,"+transpose");else if(e.line>a.doc.first){var g=Yd(a.doc,e.line-1).text;g&&a.replaceRange(f.charAt(0)+a.doc.lineSeparator()+g.charAt(g.length-1),Kf(e.line-1,g.length-1),Kf(e.line,1),"+transpose")}c.push(new la(e,e))}a.setSelections(c)})},newlineAndIndent:function(a){Db(a,function(){for(var b=a.listSelections().length,c=0;c<b;c++){var d=a.listSelections()[c];a.replaceRange(a.doc.lineSeparator(),d.anchor,d.head,"+input"),a.indentLine(d.from().line+1,null,!0)}Lc(a)})},toggleOverwrite:function(a){a.toggleOverwrite()}},jg=a.keyMap={};jg.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},jg.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection",
"Alt-U":"redoSelection",fallthrough:"basic"},jg.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},jg.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},jg.default=Df?jg.macDefault:jg.pcDefault,a.normalizeKeyMap=function(a){var b={};for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];if(/^(name|fallthrough|(de|at)tach)$/.test(c))continue;if("..."==d){delete a[c];continue}for(var e=He(c.split(" "),Tc),f=0;f<e.length;f++){var g,h;f==e.length-1?(h=e.join(" "),g=d):(h=e.slice(0,f+1).join(" "),g="...");var i=b[h];if(i){if(i!=g)throw new Error("Inconsistent bindings for "+h)}else b[h]=g}delete a[c]}for(var j in b)a[j]=b[j];return a};var kg=a.lookupKey=function(a,b,c,d){b=Uc(b);var e=b.call?b.call(a,d):b[a];if(e===!1)return"nothing";if("..."===e)return"multi";if(null!=e&&c(e))return"handled";if(b.fallthrough){if("[object Array]"!=Object.prototype.toString.call(b.fallthrough))return kg(a,b.fallthrough,c,d);for(var f=0;f<b.fallthrough.length;f++){var g=kg(a,b.fallthrough[f],c,d);if(g)return g}}},lg=a.isModifierKey=function(a){var b="string"==typeof a?a:dh[a.keyCode];return"Ctrl"==b||"Alt"==b||"Shift"==b||"Mod"==b},mg=a.keyName=function(a,b){if(xf&&34==a.keyCode&&a.char)return!1;var c=dh[a.keyCode],d=c;return null!=d&&!a.altGraphKey&&(a.altKey&&"Alt"!=c&&(d="Alt-"+d),(Gf?a.metaKey:a.ctrlKey)&&"Ctrl"!=c&&(d="Ctrl-"+d),(Gf?a.ctrlKey:a.metaKey)&&"Cmd"!=c&&(d="Cmd-"+d),!b&&a.shiftKey&&"Shift"!=c&&(d="Shift-"+d),d)};a.fromTextArea=function(b,c){function d(){b.value=i.getValue()}if(c=c?Ke(c):{},c.value=b.value,!c.tabindex&&b.tabIndex&&(c.tabindex=b.tabIndex),!c.placeholder&&b.placeholder&&(c.placeholder=b.placeholder),null==c.autofocus){var e=Se();c.autofocus=e==b||null!=b.getAttribute("autofocus")&&e==document.body}if(b.form&&(Cg(b.form,"submit",d),!c.leaveSubmitMethodAlone)){var f=b.form,g=f.submit;try{var h=f.submit=function(){d(),f.submit=g,f.submit(),f.submit=h}}catch(a){}}c.finishInit=function(a){a.save=d,a.getTextArea=function(){return b},a.toTextArea=function(){a.toTextArea=isNaN,d(),b.parentNode.removeChild(a.getWrapperElement()),b.style.display="",b.form&&(Eg(b.form,"submit",d),"function"==typeof b.form.submit&&(b.form.submit=g))}},b.style.display="none";var i=a(function(a){b.parentNode.insertBefore(a,b.nextSibling)},c);return i};var ng=a.StringStream=function(a,b){this.pos=this.start=0,this.string=a,this.tabSize=b||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};ng.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(a){var b=this.string.charAt(this.pos);if("string"==typeof a)var c=b==a;else var c=b&&(a.test?a.test(b):a(b));if(c)return++this.pos,b},eatWhile:function(a){for(var b=this.pos;this.eat(a););return this.pos>b},eatSpace:function(){for(var a=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>a},skipToEnd:function(){this.pos=this.string.length},skipTo:function(a){var b=this.string.indexOf(a,this.pos);if(b>-1)return this.pos=b,!0},backUp:function(a){this.pos-=a},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Mg(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?Mg(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return Mg(this.string,null,this.tabSize)-(this.lineStart?Mg(this.string,this.lineStart,this.tabSize):0)},match:function(a,b,c){if("string"!=typeof a){var d=this.string.slice(this.pos).match(a);return d&&d.index>0?null:(d&&b!==!1&&(this.pos+=d[0].length),d)}var e=function(a){return c?a.toLowerCase():a};if(e(this.string.substr(this.pos,a.length))==e(a))return b!==!1&&(this.pos+=a.length),!0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(a,b){this.lineStart+=a;try{return b()}finally{this.lineStart-=a}}};var og=0,pg=a.TextMarker=function(a,b){this.lines=[],this.type=b,this.doc=a,this.id=++og};Ce(pg),pg.prototype.clear=function(){if(!this.explicitlyCleared){var a=this.doc.cm,b=a&&!a.curOp;if(b&&ub(a),Be(this,"clear")){var c=this.find();c&&xe(this,"clear",c.from,c.to)}for(var d=null,e=null,f=0;f<this.lines.length;++f){var g=this.lines[f],h=_c(g.markedSpans,this);a&&!this.collapsed?Kb(a,ae(g),"text"):a&&(null!=h.to&&(e=ae(g)),null!=h.from&&(d=ae(g))),g.markedSpans=ad(g.markedSpans,h),null==h.from&&this.collapsed&&!vd(this.doc,g)&&a&&_d(g,sb(a.display))}if(a&&this.collapsed&&!a.options.lineWrapping)for(var f=0;f<this.lines.length;++f){var i=rd(this.lines[f]),j=l(i);j>a.display.maxLineLength&&(a.display.maxLine=i,a.display.maxLineLength=j,a.display.maxLineChanged=!0)}null!=d&&a&&this.collapsed&&Jb(a,d,e+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,a&&Da(a.doc)),a&&xe(a,"markerCleared",a,this),b&&wb(a),this.parent&&this.parent.clear()}},pg.prototype.find=function(a,b){null==a&&"bookmark"==this.type&&(a=1);for(var c,d,e=0;e<this.lines.length;++e){var f=this.lines[e],g=_c(f.markedSpans,this);if(null!=g.from&&(c=Kf(b?f:ae(f),g.from),a==-1))return c;if(null!=g.to&&(d=Kf(b?f:ae(f),g.to),1==a))return d}return c&&{from:c,to:d}},pg.prototype.changed=function(){var a=this.find(-1,!0),b=this,c=this.doc.cm;a&&c&&Db(c,function(){var d=a.line,e=ae(a.line),f=_a(c,e);if(f&&(fb(f),c.curOp.selectionChanged=c.curOp.forceUpdate=!0),c.curOp.updateMaxLine=!0,!vd(b.doc,d)&&null!=b.height){var g=b.height;b.height=null;var h=yd(b)-g;h&&_d(d,d.height+h)}})},pg.prototype.attachLine=function(a){if(!this.lines.length&&this.doc.cm){var b=this.doc.cm.curOp;b.maybeHiddenMarkers&&Ge(b.maybeHiddenMarkers,this)!=-1||(b.maybeUnhiddenMarkers||(b.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(a)},pg.prototype.detachLine=function(a){if(this.lines.splice(Ge(this.lines,a),1),!this.lines.length&&this.doc.cm){var b=this.doc.cm.curOp;(b.maybeHiddenMarkers||(b.maybeHiddenMarkers=[])).push(this)}};var og=0,qg=a.SharedTextMarker=function(a,b){this.markers=a,this.primary=b;for(var c=0;c<a.length;++c)a[c].parent=this};Ce(qg),qg.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var a=0;a<this.markers.length;++a)this.markers[a].clear();xe(this,"clear")}},qg.prototype.find=function(a,b){return this.primary.find(a,b)};var rg=a.LineWidget=function(a,b,c){if(c)for(var d in c)c.hasOwnProperty(d)&&(this[d]=c[d]);this.doc=a,this.node=b};Ce(rg),rg.prototype.clear=function(){var a=this.doc.cm,b=this.line.widgets,c=this.line,d=ae(c);if(null!=d&&b){for(var e=0;e<b.length;++e)b[e]==this&&b.splice(e--,1);b.length||(c.widgets=null);var f=yd(this);_d(c,Math.max(0,c.height-f)),a&&Db(a,function(){xd(a,c,-f),Kb(a,d,"widget")})}},rg.prototype.changed=function(){var a=this.height,b=this.doc.cm,c=this.line;this.height=null;var d=yd(this)-a;d&&(_d(c,c.height+d),b&&Db(b,function(){b.curOp.forceUpdate=!0,xd(b,c,d)}))};var sg=a.Line=function(a,b,c){this.text=a,jd(this,b),this.height=c?c(this):1};Ce(sg),sg.prototype.lineNo=function(){return ae(this)};var tg={},ug={};Ud.prototype={chunkSize:function(){return this.lines.length},removeInner:function(a,b){for(var c=a,d=a+b;c<d;++c){var e=this.lines[c];this.height-=e.height,Bd(e),xe(e,"delete")}this.lines.splice(a,b)},collapse:function(a){a.push.apply(a,this.lines)},insertInner:function(a,b,c){this.height+=c,this.lines=this.lines.slice(0,a).concat(b).concat(this.lines.slice(a));for(var d=0;d<b.length;++d)b[d].parent=this},iterN:function(a,b,c){for(var d=a+b;a<d;++a)if(c(this.lines[a]))return!0}},Vd.prototype={chunkSize:function(){return this.size},removeInner:function(a,b){this.size-=b;for(var c=0;c<this.children.length;++c){var d=this.children[c],e=d.chunkSize();if(a<e){var f=Math.min(b,e-a),g=d.height;if(d.removeInner(a,f),this.height-=g-d.height,e==f&&(this.children.splice(c--,1),d.parent=null),0==(b-=f))break;a=0}else a-=e}if(this.size-b<25&&(this.children.length>1||!(this.children[0]instanceof Ud))){var h=[];this.collapse(h),this.children=[new Ud(h)],this.children[0].parent=this}},collapse:function(a){for(var b=0;b<this.children.length;++b)this.children[b].collapse(a)},insertInner:function(a,b,c){this.size+=b.length,this.height+=c;for(var d=0;d<this.children.length;++d){var e=this.children[d],f=e.chunkSize();if(a<=f){if(e.insertInner(a,b,c),e.lines&&e.lines.length>50){for(;e.lines.length>50;){var g=e.lines.splice(e.lines.length-25,25),h=new Ud(g);e.height-=h.height,this.children.splice(d+1,0,h),h.parent=this}this.maybeSpill()}break}a-=f}},maybeSpill:function(){if(!(this.children.length<=10)){var a=this;do{var b=a.children.splice(a.children.length-5,5),c=new Vd(b);if(a.parent){a.size-=c.size,a.height-=c.height;var d=Ge(a.parent.children,a);a.parent.children.splice(d+1,0,c)}else{var e=new Vd(a.children);e.parent=a,a.children=[e,c],a=e}c.parent=a.parent}while(a.children.length>10);a.parent.maybeSpill()}},iterN:function(a,b,c){for(var d=0;d<this.children.length;++d){var e=this.children[d],f=e.chunkSize();if(a<f){var g=Math.min(b,f-a);if(e.iterN(a,g,c))return!0;if(0==(b-=g))break;a=0}else a-=f}}};var vg=0,wg=a.Doc=function(a,b,c,d){if(!(this instanceof wg))return new wg(a,b,c,d);null==c&&(c=0),Vd.call(this,[new Ud([new sg("",null)])]),this.first=c,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=c;var e=Kf(c,0);this.sel=na(e),this.history=new ee(null),this.id=++vg,this.modeOption=b,this.lineSep=d,this.extend=!1,"string"==typeof a&&(a=this.splitLines(a)),Td(this,{from:e,to:e,text:a}),Aa(this,na(e),Jg)};wg.prototype=Je(Vd.prototype,{constructor:wg,iter:function(a,b,c){c?this.iterN(a-this.first,b-a,c):this.iterN(this.first,this.first+this.size,a)},insert:function(a,b){for(var c=0,d=0;d<b.length;++d)c+=b[d].height;this.insertInner(a-this.first,b,c)},remove:function(a,b){this.removeInner(a-this.first,b)},getValue:function(a){var b=$d(this,this.first,this.first+this.size);return a===!1?b:b.join(a||this.lineSeparator())},setValue:Gb(function(a){var b=Kf(this.first,0),c=this.first+this.size-1;zc(this,{from:b,to:Kf(c,Yd(this,c).text.length),text:this.splitLines(a),origin:"setValue",full:!0},!0),Aa(this,na(b))}),replaceRange:function(a,b,c,d){b=pa(this,b),c=c?pa(this,c):b,Fc(this,a,b,c,d)},getRange:function(a,b,c){var d=Zd(this,pa(this,a),pa(this,b));return c===!1?d:d.join(c||this.lineSeparator())},getLine:function(a){var b=this.getLineHandle(a);return b&&b.text},getLineHandle:function(a){if(ra(this,a))return Yd(this,a)},getLineNumber:function(a){return ae(a)},getLineHandleVisualStart:function(a){return"number"==typeof a&&(a=Yd(this,a)),rd(a)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(a){return pa(this,a)},getCursor:function(a){var b=this.sel.primary();return null==a||"head"==a?b.head:"anchor"==a?b.anchor:"end"==a||"to"==a||a===!1?b.to():b.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Gb(function(a,b,c){xa(this,pa(this,"number"==typeof a?Kf(a,b||0):a),null,c)}),setSelection:Gb(function(a,b,c){xa(this,pa(this,a),pa(this,b||a),c)}),extendSelection:Gb(function(a,b,c){ua(this,pa(this,a),b&&pa(this,b),c)}),extendSelections:Gb(function(a,b){va(this,sa(this,a),b)}),extendSelectionsBy:Gb(function(a,b){va(this,sa(this,He(this.sel.ranges,a)),b)}),setSelections:Gb(function(a,b,c){if(a.length){for(var d=0,e=[];d<a.length;d++)e[d]=new la(pa(this,a[d].anchor),pa(this,a[d].head));null==b&&(b=Math.min(a.length-1,this.sel.primIndex)),Aa(this,ma(e,b),c)}}),addSelection:Gb(function(a,b,c){var d=this.sel.ranges.slice(0);d.push(new la(pa(this,a),pa(this,b||a))),Aa(this,ma(d,d.length-1),c)}),getSelection:function(a){for(var b,c=this.sel.ranges,d=0;d<c.length;d++){var e=Zd(this,c[d].from(),c[d].to());b=b?b.concat(e):e}return a===!1?b:b.join(a||this.lineSeparator())},getSelections:function(a){for(var b=[],c=this.sel.ranges,d=0;d<c.length;d++){var e=Zd(this,c[d].from(),c[d].to());a!==!1&&(e=e.join(a||this.lineSeparator())),b[d]=e}return b},replaceSelection:function(a,b,c){for(var d=[],e=0;e<this.sel.ranges.length;e++)d[e]=a;this.replaceSelections(d,b,c||"+input")},replaceSelections:Gb(function(a,b,c){for(var d=[],e=this.sel,f=0;f<e.ranges.length;f++){var g=e.ranges[f];d[f]={from:g.from(),to:g.to(),text:this.splitLines(a[f]),origin:c}}for(var h=b&&"end"!=b&&xc(this,d,b),f=d.length-1;f>=0;f--)zc(this,d[f]);h?za(this,h):this.cm&&Lc(this.cm)}),undo:Gb(function(){Bc(this,"undo")}),redo:Gb(function(){Bc(this,"redo")}),undoSelection:Gb(function(){Bc(this,"undo",!0)}),redoSelection:Gb(function(){Bc(this,"redo",!0)}),setExtending:function(a){this.extend=a},getExtending:function(){return this.extend},historySize:function(){for(var a=this.history,b=0,c=0,d=0;d<a.done.length;d++)a.done[d].ranges||++b;for(var d=0;d<a.undone.length;d++)a.undone[d].ranges||++c;return{undo:b,redo:c}},clearHistory:function(){this.history=new ee(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(a){return a&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(a){return this.history.generation==(a||this.cleanGeneration)},getHistory:function(){return{done:pe(this.history.done),undone:pe(this.history.undone)}},setHistory:function(a){var b=this.history=new ee(this.history.maxGeneration);b.done=pe(a.done.slice(0),null,!0),b.undone=pe(a.undone.slice(0),null,!0)},addLineClass:Gb(function(a,b,c){return Oc(this,a,"gutter"==b?"gutter":"class",function(a){var d="text"==b?"textClass":"background"==b?"bgClass":"gutter"==b?"gutterClass":"wrapClass";if(a[d]){if(Te(c).test(a[d]))return!1;a[d]+=" "+c}else a[d]=c;return!0})}),removeLineClass:Gb(function(a,b,c){return Oc(this,a,"gutter"==b?"gutter":"class",function(a){var d="text"==b?"textClass":"background"==b?"bgClass":"gutter"==b?"gutterClass":"wrapClass",e=a[d];if(!e)return!1;if(null==c)a[d]=null;else{var f=e.match(Te(c));if(!f)return!1;var g=f.index+f[0].length;a[d]=e.slice(0,f.index)+(f.index&&g!=e.length?" ":"")+e.slice(g)||null}return!0})}),addLineWidget:Gb(function(a,b,c){return zd(this,a,b,c)}),removeLineWidget:function(a){a.clear()},markText:function(a,b,c){return Vc(this,pa(this,a),pa(this,b),c,c&&c.type||"range")},setBookmark:function(a,b){var c={replacedWith:b&&(null==b.nodeType?b.widget:b),insertLeft:b&&b.insertLeft,clearWhenEmpty:!1,shared:b&&b.shared,handleMouseEvents:b&&b.handleMouseEvents};return a=pa(this,a),Vc(this,a,a,c,"bookmark")},findMarksAt:function(a){a=pa(this,a);var b=[],c=Yd(this,a.line).markedSpans;if(c)for(var d=0;d<c.length;++d){var e=c[d];(null==e.from||e.from<=a.ch)&&(null==e.to||e.to>=a.ch)&&b.push(e.marker.parent||e.marker)}return b},findMarks:function(a,b,c){a=pa(this,a),b=pa(this,b);var d=[],e=a.line;return this.iter(a.line,b.line+1,function(f){var g=f.markedSpans;if(g)for(var h=0;h<g.length;h++){var i=g[h];null!=i.to&&e==a.line&&a.ch>i.to||null==i.from&&e!=a.line||null!=i.from&&e==b.line&&i.from>b.ch||c&&!c(i.marker)||d.push(i.marker.parent||i.marker)}++e}),d},getAllMarks:function(){var a=[];return this.iter(function(b){var c=b.markedSpans;if(c)for(var d=0;d<c.length;++d)null!=c[d].from&&a.push(c[d].marker)}),a},posFromIndex:function(a){var b,c=this.first;return this.iter(function(d){var e=d.text.length+1;if(e>a)return b=a,!0;a-=e,++c}),pa(this,Kf(c,b))},indexFromPos:function(a){a=pa(this,a);var b=a.ch;return a.line<this.first||a.ch<0?0:(this.iter(this.first,a.line,function(a){b+=a.text.length+1}),b)},copy:function(a){var b=new wg($d(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);return b.scrollTop=this.scrollTop,b.scrollLeft=this.scrollLeft,b.sel=this.sel,b.extend=!1,a&&(b.history.undoDepth=this.history.undoDepth,b.setHistory(this.getHistory())),b},linkedDoc:function(a){a||(a={});var b=this.first,c=this.first+this.size;null!=a.from&&a.from>b&&(b=a.from),null!=a.to&&a.to<c&&(c=a.to);var d=new wg($d(this,b,c),a.mode||this.modeOption,b,this.lineSep);return a.sharedHist&&(d.history=this.history),(this.linked||(this.linked=[])).push({doc:d,sharedHist:a.sharedHist}),d.linked=[{doc:this,isParent:!0,sharedHist:a.sharedHist}],Yc(d,Xc(this)),d},unlinkDoc:function(b){if(b instanceof a&&(b=b.doc),this.linked)for(var c=0;c<this.linked.length;++c){var d=this.linked[c];if(d.doc==b){this.linked.splice(c,1),b.unlinkDoc(this),Zc(Xc(this));break}}if(b.history==this.history){var e=[b.id];Wd(b,function(a){e.push(a.id)},!0),b.history=new ee(null),b.history.done=pe(this.history.done,e),b.history.undone=pe(this.history.undone,e)}},iterLinkedDocs:function(a){Wd(this,a)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(a){return this.lineSep?a.split(this.lineSep):_g(a)},lineSeparator:function(){return this.lineSep||"\n"}}),wg.prototype.eachLine=wg.prototype.iter;var xg="iter insert remove copy getEditor constructor".split(" ");for(var yg in wg.prototype)wg.prototype.hasOwnProperty(yg)&&Ge(xg,yg)<0&&(a.prototype[yg]=function(a){return function(){return a.apply(this.doc,arguments)}}(wg.prototype[yg]));Ce(wg);var zg=a.e_preventDefault=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1},Ag=a.e_stopPropagation=function(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},Bg=a.e_stop=function(a){zg(a),Ag(a)},Cg=a.on=function(a,b,c){if(a.addEventListener)a.addEventListener(b,c,!1);else if(a.attachEvent)a.attachEvent("on"+b,c);else{var d=a._handlers||(a._handlers={}),e=d[b]||(d[b]=[]);e.push(c)}},Dg=[],Eg=a.off=function(a,b,c){if(a.removeEventListener)a.removeEventListener(b,c,!1);else if(a.detachEvent)a.detachEvent("on"+b,c);else for(var d=we(a,b,!1),e=0;e<d.length;++e)if(d[e]==c){d.splice(e,1);break}},Fg=a.signal=function(a,b){var c=we(a,b,!0);if(c.length)for(var d=Array.prototype.slice.call(arguments,2),e=0;e<c.length;++e)c[e].apply(null,d)},Gg=null,Hg=30,Ig=a.Pass={toString:function(){return"CodeMirror.Pass"}},Jg={scroll:!1},Kg={origin:"*mouse"},Lg={origin:"+move"};De.prototype.set=function(a,b){clearTimeout(this.id),this.id=setTimeout(b,a)};var Mg=a.countColumn=function(a,b,c,d,e){null==b&&(b=a.search(/[^\s\u00a0]/))==-1&&(b=a.length);for(var f=d||0,g=e||0;;){var h=a.indexOf("\t",f);if(h<0||h>=b)return g+(b-f);g+=h-f,g+=c-g%c,f=h+1}},Ng=a.findColumn=function(a,b,c){for(var d=0,e=0;;){var f=a.indexOf("\t",d);f==-1&&(f=a.length);var g=f-d;if(f==a.length||e+g>=b)return d+Math.min(g,b-e);if(e+=f-d,e+=c-e%c,d=f+1,e>=b)return d}},Og=[""],Pg=function(a){a.select()};Bf?Pg=function(a){a.selectionStart=0,a.selectionEnd=a.value.length}:sf&&(Pg=function(a){try{a.select()}catch(a){}});var Qg,Rg=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,Sg=a.isWordChar=function(a){return/\w/.test(a)||a>""&&(a.toUpperCase()!=a.toLowerCase()||Rg.test(a))},Tg=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;Qg=document.createRange?function(a,b,c,d){var e=document.createRange();return e.setEnd(d||a,c),e.setStart(a,b),e}:function(a,b,c){var d=document.body.createTextRange();try{d.moveToElementText(a.parentNode)}catch(a){return d}return d.collapse(!0),d.moveEnd("character",c),d.moveStart("character",b),d};var Ug=a.contains=function(a,b){if(3==b.nodeType&&(b=b.parentNode),a.contains)return a.contains(b);do{if(11==b.nodeType&&(b=b.host),b==a)return!0}while(b=b.parentNode)};sf&&tf<11&&(Se=function(){try{return document.activeElement}catch(a){return document.body}});var Vg,Wg,Xg=a.rmClass=function(a,b){var c=a.className,d=Te(b).exec(c);if(d){var e=c.slice(d.index+d[0].length);a.className=c.slice(0,d.index)+(e?d[1]+e:"")}},Yg=a.addClass=function(a,b){var c=a.className;Te(b).test(c)||(a.className+=(c?" ":"")+b)},Zg=!1,$g=function(){if(sf&&tf<9)return!1;var a=Pe("div");return"draggable"in a||"dragDrop"in a}(),_g=a.splitLines=3!="\n\nb".split(/\n/).length?function(a){for(var b=0,c=[],d=a.length;b<=d;){var e=a.indexOf("\n",b);e==-1&&(e=a.length);var f=a.slice(b,"\r"==a.charAt(e-1)?e-1:e),g=f.indexOf("\r");g!=-1?(c.push(f.slice(0,g)),b+=g+1):(c.push(f),b=e+1)}return c}:function(a){return a.split(/\r\n?|\n/)},ah=window.getSelection?function(a){try{return a.selectionStart!=a.selectionEnd}catch(a){return!1}}:function(a){try{var b=a.ownerDocument.selection.createRange()}catch(a){}return!(!b||b.parentElement()!=a)&&0!=b.compareEndPoints("StartToEnd",b)},bh=function(){var a=Pe("div");return"oncopy"in a||(a.setAttribute("oncopy","return;"),"function"==typeof a.oncopy)}(),ch=null,dh=a.keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};!function(){for(var a=0;a<10;a++)dh[a+48]=dh[a+96]=String(a);for(var a=65;a<=90;a++)dh[a]=String.fromCharCode(a);for(var a=1;a<=12;a++)dh[a+111]=dh[a+63235]="F"+a}();var eh,fh=function(){function a(a){return a<=247?c.charAt(a):1424<=a&&a<=1524?"R":1536<=a&&a<=1773?d.charAt(a-1536):1774<=a&&a<=2220?"r":8192<=a&&a<=8203?"w":8204==a?"b":"L"}function b(a,b,c){this.level=a,this.from=b,this.to=c}var c="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",d="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm",e=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,f=/[stwN]/,g=/[LRr]/,h=/[Lb1n]/,i=/[1n]/;return function(c){if(!e.test(c))return!1;for(var d,j=c.length,k=[],l=0;l<j;++l)k.push(d=a(c.charCodeAt(l)));for(var l=0,m="L";l<j;++l){var d=k[l];"m"==d?k[l]=m:m=d}for(var l=0,n="L";l<j;++l){var d=k[l];"1"==d&&"r"==n?k[l]="n":g.test(d)&&(n=d,"r"==d&&(k[l]="R"))}for(var l=1,m=k[0];l<j-1;++l){var d=k[l];"+"==d&&"1"==m&&"1"==k[l+1]?k[l]="1":","!=d||m!=k[l+1]||"1"!=m&&"n"!=m||(k[l]=m),m=d}for(var l=0;l<j;++l){var d=k[l];if(","==d)k[l]="N";else if("%"==d){for(var o=l+1;o<j&&"%"==k[o];++o);for(var p=l&&"!"==k[l-1]||o<j&&"1"==k[o]?"1":"N",q=l;q<o;++q)k[q]=p;l=o-1}}for(var l=0,n="L";l<j;++l){var d=k[l];"L"==n&&"1"==d?k[l]="L":g.test(d)&&(n=d)}for(var l=0;l<j;++l)if(f.test(k[l])){for(var o=l+1;o<j&&f.test(k[o]);++o);for(var r="L"==(l?k[l-1]:"L"),s="L"==(o<j?k[o]:"L"),p=r||s?"L":"R",q=l;q<o;++q)k[q]=p;l=o-1}for(var t,u=[],l=0;l<j;)if(h.test(k[l])){var v=l;for(++l;l<j&&h.test(k[l]);++l);u.push(new b(0,v,l))}else{var w=l,x=u.length;for(++l;l<j&&"L"!=k[l];++l);for(var q=w;q<l;)if(i.test(k[q])){w<q&&u.splice(x,0,new b(1,w,q));var y=q;for(++q;q<l&&i.test(k[q]);++q);u.splice(x,0,new b(2,y,q)),w=q}else++q;w<l&&u.splice(x,0,new b(1,w,l))}return 1==u[0].level&&(t=c.match(/^\s+/))&&(u[0].from=t[0].length,u.unshift(new b(0,0,t[0].length))),1==Fe(u).level&&(t=c.match(/\s+$/))&&(Fe(u).to-=t[0].length,u.push(new b(0,j-t[0].length,j))),2==u[0].level&&u.unshift(new b(1,u[0].to,u[0].to)),u[0].level!=Fe(u).level&&u.push(new b(u[0].level,j,j)),u}}();return a.version="5.13.2",a}),function(a){"object"==typeof exports&&"object"==typeof module?a(require("cm")):"function"==typeof define&&define.amd?define("cm.matchbrackets",["cm"],a):a(CodeMirror)}(function(a){function b(a,b,d,e){var f=a.getLineHandle(b.line),i=b.ch-1,j=i>=0&&h[f.text.charAt(i)]||h[f.text.charAt(++i)];if(!j)return null;var k=">"==j.charAt(1)?1:-1;if(d&&k>0!=(i==b.ch))return null;var l=a.getTokenTypeAt(g(b.line,i+1)),m=c(a,g(b.line,i+(k>0?1:0)),k,l||null,e);return null==m?null:{from:g(b.line,i),to:m&&m.pos,match:m&&m.ch==j.charAt(0),forward:k>0}}function c(a,b,c,d,e){for(var f=e&&e.maxScanLineLength||1e4,i=e&&e.maxScanLines||1e3,j=[],k=e&&e.bracketRegex?e.bracketRegex:/[(){}[\]]/,l=c>0?Math.min(b.line+i,a.lastLine()+1):Math.max(a.firstLine()-1,b.line-i),m=b.line;m!=l;m+=c){var n=a.getLine(m);if(n){var o=c>0?0:n.length-1,p=c>0?n.length:-1;if(!(n.length>f))for(m==b.line&&(o=b.ch-(c<0?1:0));o!=p;o+=c){var q=n.charAt(o);if(k.test(q)&&(void 0===d||a.getTokenTypeAt(g(m,o+1))==d)){var r=h[q];if(">"==r.charAt(1)==c>0)j.push(q);else{if(!j.length)return{pos:g(m,o),ch:q};j.pop()}}}}}return m-c!=(c>0?a.lastLine():a.firstLine())&&null}function d(a,c,d){for(var e=a.state.matchBrackets.maxHighlightLineLength||1e3,h=[],i=a.listSelections(),j=0;j<i.length;j++){var k=i[j].empty()&&b(a,i[j].head,!1,d);if(k&&a.getLine(k.from.line).length<=e){var l=k.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";h.push(a.markText(k.from,g(k.from.line,k.from.ch+1),{className:l})),k.to&&a.getLine(k.to.line).length<=e&&h.push(a.markText(k.to,g(k.to.line,k.to.ch+1),{className:l}))}}if(h.length){f&&a.state.focused&&a.focus();var m=function(){a.operation(function(){for(var a=0;a<h.length;a++)h[a].clear()})};if(!c)return m;setTimeout(m,800)}}function e(a){a.operation(function(){i&&(i(),i=null),i=d(a,!1,a.state.matchBrackets)})}var f=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),g=a.Pos,h={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},i=null;a.defineOption("matchBrackets",!1,function(b,c,d){d&&d!=a.Init&&b.off("cursorActivity",e),c&&(b.state.matchBrackets="object"==typeof c?c:{},b.on("cursorActivity",e))}),a.defineExtension("matchBrackets",function(){d(this,!0)}),a.defineExtension("findMatchingBracket",function(a,c,d){return b(this,a,c,d)}),a.defineExtension("scanForBracket",function(a,b,d,e){return c(this,a,b,d,e)})}),define("general.components/codearea/qlikview-script-mode-constants",[],function(){return{REGEXP_WORD:/[^\s\(\)\"\'\,\+\$\*\-\<\>\=\&\/\!\{\}\;\.\:\@\`\´\[\]]/,REGEXP_WORD_SEPARATOR:/[\s\(\)\"\'\,\+\$\*\-\<\>\=\&\/\!\{\}\;\.\:\@\`\´\[\]]/}}),define("general.components/codearea/qlikview-script-mode",["./qlikview-script-mode-constants","cm"],function(a,b){var c=a.REGEXP_WORD;return b.defineMode("qlikviewscript",function(a,b){function d(a,b,c){return b.tokenize=c,c(a,b)}function e(a,b){for(var c;null!=(c=a.next());)if(c==b)return!1;return!1}function f(a,b,c){return v=a,w=c,b}function g(a,e){if(a.eatSpace())return v="whitespace",null;v="any";var g=a.next();if(y.test(g))return"["===g?d(a,e,i("]")):d(a,e,i(g));if(/[\[\]{}\(\),;\:]/.test(g))return f(g);if("0"==g&&a.eat(/x/i))return a.eatWhile(/[\da-f]/i),f("number","number");if(/[\.\d]/.test(g))return a.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),!a.eol()&&(g=a.peek(),/[A-z]/.test(g))?"normaltext":"number";if("/"===g)return a.eat("*")?d(a,e,j):a.eat("/")?(a.skipToEnd(),"comment"):(a.eatWhile(x),"operator");if(x.test(g))return a.eatWhile(x),f(g,"operator");if("$"===g&&a.match(/^\(=/,!1,!0))return f("$");if("$"===g&&a.match(/^\((MUST_INCLUDE|INCLUDE)=/i,!1,!0))return f("$");if("$"===g&&a.match(/^\(/,!1,!0))return e.tokenize=l,f("$(");a.eatWhile(c);var h=a.current(),m=h.toLowerCase();return"rem"===m?d(a,e,k):b.service.isFunction(m)&&a.match(/(^\s*\()/,!1,!0)?f("function","keyword",m):b.service.isField(h)?f("field","field"):b.service.isVariable(h)?f("variable","variable"):b.service.isKeyword(m)?f("keyword","keyword"):"normaltext"}function h(a){return a.substr(1,a.length-2)}function i(a){return function(c,d){if(!e(c,a)&&(d.tokenize=g,"'"!==a)){var i=h(c.current(),a);if(b.service.isField(i))return f("field","field");if(b.service.isVariable(i))return f("variable","variable")}return f("string","string")}}function j(a,b){for(var c,d=!1;c=a.next();){if("/"==c&&d){b.tokenize=g;break}d="*"==c}return f("comment","comment")}function k(a,b){for(var c;c=a.next();)if(";"==c){b.tokenize=g;break}return f("comment","comment")}function l(a,c){v="any";var d=a.next();if(")"==d&&(c.tokenize=g),/[\(\),]/.test(d))return f(d);a.eatWhile(/[^(),]/);var e=a.current();return!/^\d/.test(e)&&b.service.isVariable(e)?f("variable","variable"):"normaltext"}function m(a,b,c,d){this.type=a,this.prev=b,this.info=c,this.pos=d}function n(a,b,c,d,e){var f=a.cc;for(z.state=a,z.stream=e,z.marked=null,z.cc=f;;){if((f.length?f.pop():u)(c,d)){for(;f.length&&f[f.length-1].lex;)f.pop()();return z.marked?z.marked:b}}}function o(){for(var a=arguments.length-1;a>=0;a--)z.cc.push(arguments[a])}function p(){return o.apply(null,arguments),!0}function q(a,b){var c=function(){var c=z.state;c.lexical=new m(a,c.lexical,b,z.stream.pos)};return c.lex=!0,c}function r(){var a=z.state;a.lexical.prev&&(a.lexical=a.lexical.prev)}function s(a){return function(b){return b==a?p():";"==a?o():p(arguments.callee)}}function t(a,b){return function c(d){return d==b?p():o(a,c)}}function u(a){
return"function"==a?p(q("qvfunction",w),s("("),t(u,")"),r):"("===a?p(t(u,")")):"$("===a?p(s("("),t(u,")")):p()}var v,w,x=/[+\-*&=<>]/,y=/[\u0022\u0027\u0060\u00b4[]/,z={state:null,column:null,marked:null,cc:null};return r.lex=!0,{startState:function(){return{tokenize:g,lastType:null,cc:[],lexical:new m("block")}},token:function(a,b){var c=b.tokenize(a,b);return"comment"==v?c:(b.lastType=v,n(b,c,v,w,a))},lineComment:"//"}}),{REGEXP_WORD:c}}),define("general.components/codearea/codearea-function-tip",["qvangular","general.services/show-service/show-service"],function(a,b){"use strict";a.directive("qvCodeareaFunctionTip",function(){return{restrict:"A",require:"qvCodearea",link:function(c,d,e,f){var g,h,i=22,j=c.$watch(e.qvCodeareaFunctionTip,function(d){function e(){var a=f.codemirror.getCursor(),b=f.codemirror.getTokenAt(a,!0);if("comment"!==b.type){for(var c=0,d=b.state.lexical;d&&"qvfunction"!==d.type||0===c&&d.info&&b.string.toLowerCase()===d.info.toLowerCase();)d=d.prev,c++;return d}}function k(a,b){for(var c,d=f.codemirror.getCursor(),e={line:d.line,ch:d.ch};e.line>=0;){if(c=f.codemirror.getLine(e.line).toLowerCase(),c.substring(a.pos-b.length,a.pos)===b){e.ch=a.pos-b.length;break}e.line-=1}var g=f.codemirror.charCoords(e);return g.top-=f.codemirror.defaultTextHeight()+i,g}function l(){var c=e(),f=c?c.info:void 0,h=f?d.service.getFunctionTip(f):void 0;a.$apply(function(){if(m(),h){var a=k(c,f);p(),g=b.show(d.view,{content:h,offset:a})}})}function m(){q(),g&&(g.destroy(),g=void 0)}function n(){clearTimeout(h),h=setTimeout(l,250)}function o(){m()}function p(){f.codemirror.addKeyMap(r)}function q(){f.codemirror.removeKeyMap(r)}var r={Esc:function(){c.$apply(function(){m()})}};d&&(f.codemirror.on("blur",o),f.codemirror.on("cursorActivity",n),c.$on("$destroy",function(){f.codemirror.off("blur",o),f.codemirror.off("cursorActivity",n),m()}),j())},!0)}}})}),define("text!general.components/autocomplete-view/autocomplete-view.ng.html",[],function(){return'<div class="qv-autocomplete-container">\n\t<ul class="codearea-autocomplete-hints">\n\t\t<li ng-repeat="item in state.hints track by item.text"\n\t\t\tqva-scroll-into-view="{ scroll: state.selectedHint == $index, scrollSelector: \'.codearea-autocomplete-hints\' }"\n\t\t\tclass="codearea-autocomplete-hint"\n\t\t\tng-class="{ \'codearea-autocomplete-hint-active\': state.selectedHint == $index }"\n\t\t\tng-mouseover="state.selectedHint = $index;"\n\t\t\tqva-activate="state.choose( $index )">\n\n\t\t\t<div class="codearea-autocomplete-hint-text">{{item.text}}</div>\n\t\t\t<div ng-repeat="type in item.types track by $index"\n\t\t\t\t class="codearea-autocomplete-hint-type {{type.id}}"\n\t\t\t\t q-translation="{{type.key}}"></div>\n\t\t</li>\n\t</ul>\n</div>\n'}),define("general.components/autocomplete-view/autocomplete-view",["text!./autocomplete-view.ng.html","jquery"],function(a,b){"use strict";function c(a,b,c){var d=c.bottom+a.height<=b.height,e=d?c.bottom:c.top-a.height,f=Math.max(0,c.left+a.width-b.width);return{top:e,left:c.left-f}}function d(a,b){a.$$postDigest(function(){a.$$postDigest(b)})}return{scope:{state:"="},template:a,controller:["$scope","$element",function(a,e){function f(){var b={width:h.width(),height:h.height()},d=g[0].getBoundingClientRect(),e=a.state.cursorPos,f=c(d,b,e);g.css({left:f.left,top:f.top})}var g=e.find(".qv-autocomplete-container"),h=b(window);a.$watch("state.hints.length",function(){d(a,f)})}]}}),define("general.components/codearea/codearea-autocomplete",["jquery","qvangular","general.services/show-service/show-service","general.components/autocomplete-view/autocomplete-view","core.utils/resize","general.components/codearea/qlikview-script-mode-constants"],function(a,b,c,d,e,f){"use strict";function g(a){var b=a.getTokenAt(a.getCursor()).type;return"keyword"===b||"field"===b||"variable"===b}function h(a,b,c){if(a.somethingSelected()||g(a)&&!c||b.disabled)return null;var d=b.getHints(a),e=d.list;if(0===e.length)return null;e.length>n&&(e=e.slice(0,n));var f=a.cursorCoords(b.alignWithWord!==!1?d.from:null);return{from:d.from,to:d.to,hints:e,selectedHint:c?c.selectedHint:0,cursorPos:f}}function i(a,c){this.dialogHandle=null,this.dialogOptions={},this.state=null,this.options=c,this.cm=a,this.currentOptions=null,this.once=null,this.closingOnBlur=null,this.bound={cursorActivity:this.cursorActivity.bind(this),pick:this.pick.bind(this),close:this.close.bind(this),onBlur:this.onBlur.bind(this),onFocus:this.onFocus.bind(this),choose:this.choose.bind(this),showHint:this.showHint.bind(this)};var d=this;this.ourMap={Up:function(){d.changeActive(d.state.selectedHint-1),b.$rootScope.$apply()},Down:function(){d.changeActive(d.state.selectedHint+1),b.$rootScope.$apply()},PageUp:function(){d.changeActive(d.state.selectedHint-8),b.$rootScope.$apply()},PageDown:function(){d.changeActive(d.state.selectedHint+8),b.$rootScope.$apply()},Home:function(){d.changeActive(0),b.$rootScope.$apply()},End:function(){d.changeActive(d.state.hints.length-1),b.$rootScope.$apply()},Enter:this.bound.pick,Tab:this.bound.pick,Esc:this.bound.close}}function j(a){return"["+a.replace(/\]/g,"]]")+"]"}function k(a,b){function c(a){"string"==typeof a&&(a={text:a});var b=a.text;if(h){if(!p[a.type]||!p[a.type].allowQuote)return;b=j(b)}b&&0===b.toLowerCase().indexOf(g)&&(e[b]||(e[b]={text:a.text,types:[],value:a.value||b},f.push(e[b])),p[a.type]&&e[b].types.push({id:a.type,key:p[a.type].translation}))}function d(a,b){var c=a.text.toLowerCase(),d=b.text.toLowerCase();return c===d?0:c>d?1:-1}var e={},f=[],g=a.toLowerCase(),h="["===a[0];return!h&&o.test(a)||/^\d+$/.test(a)?[]:(""!==a&&(b.forEach(c),f.sort(d)),1===f.length&&a===f[0].value&&(f=[]),f)}function l(a,b){var c=a.getCursor(),d=a.getTokenAt(c);return{list:k(d.string,b),from:{line:c.line,ch:d.start},to:{line:c.line,ch:d.end}}}var m=b.getService("$timeout"),n=100,o=f.REGEXP_WORD_SEPARATOR;i.prototype.cursorActivity=function(){m.cancel(this.once),this.once=null,this.cm.getCursor().line!==this.startLine||this.cm.somethingSelected()?this.close():this.once=m(this.bound.showHint,70)},i.prototype.choose=function(a){this.changeActive(a),this.pick()},i.prototype.pick=function(){this.cm.replaceRange(this.state.hints[this.state.selectedHint].value,this.state.from,this.state.to),this.close(),b.$apply(b.$rootScope)},i.prototype.onBlur=function(){this.closingOnBlur=m(this.bound.close,300)},i.prototype.onFocus=function(){m.cancel(this.closingOnBlur),this.closingOnBlur=null},i.prototype.changeActive=function(a){this.state&&(a=Math.max(0,Math.min(a,this.state.hints.length-1)),this.state.selectedHint!==a&&(this.state.selectedHint=a))},i.prototype.close=function(){m.cancel(this.once),m.cancel(this.startTimeout),this.dialogHandle&&(this.dialogHandle.destroy(),this.dialogHandle=null,this.cm.removeKeyMap(this.ourMap),this.cm.off("cursorActivity",this.bound.cursorActivity),this.cm.off("blur",this.bound.onBlur),this.cm.off("focus",this.bound.onFocus),this.cm.off("scroll",this.bound.close),this.state=null,b.$apply(b.$rootScope))},i.prototype.open=function(){this.dialogHandle=c.show(this.options.view,this.dialogOptions),this.startLine=this.cm.getCursor().line,this.cm.addKeyMap(this.ourMap),this.cm.on("cursorActivity",this.bound.cursorActivity),this.cm.on("blur",this.bound.onBlur),this.cm.on("focus",this.bound.onFocus),this.cm.on("scroll",this.bound.close)},i.prototype.showHint=function(){var a=this.state;if(this.state=h(this.cm,this.options,a),!this.state)return void(a&&this.close());this.state.choose=this.bound.choose,this.dialogOptions.state=this.state,a||this.open()},i.prototype.start=function(){this.state||(this.startTimeout&&m.cancel(this.startTimeout),this.startTimeout=m(this.bound.showHint,500))};var p={keyword:{translation:"Common.Keyword",allowQuote:!1},variable:{translation:"Common.Variable",allowQuote:!0},field:{translation:"Common.Field",allowQuote:!0},function:{translation:"Common.Function",allowQuote:!1}};return b.directive("qvCodeareaAutocomplete",function(){return{restrict:"A",require:"qvCodearea",link:function(b,c,f,g){var h=[37,38,39,40,33,34,27],j=b.$watch(f.qvCodeareaAutocomplete,function(c){function f(a){return l(a,c.service.getAutocompleteList())}function k(){n.start()}function m(b,c){a.inArray(c.which,h)===-1&&k()}if(c){c.view||(c.view=d),c.getHints||(c.getHints=f);var n=new i(g.codemirror,c),o=n.close.bind(n);g.codemirror.on("focus",k),g.codemirror.on("keyup",m),e.off("end",o),b.$on("$destroy",function(){g.codemirror.off("focus",k),g.codemirror.off("keyup",m),e.on("end",o),n.close()}),j()}},!0)}}}),{getCompletions:k}}),define("general.components/codearea/search-cursor",["cm"],function(a){function b(a,b,c,e){if(this.atOccurrence=!1,this.cm=a,e||"string"!=typeof b||(e=!1),c=c?a.clipPos(c):d(0,0),this.pos={from:c,to:c},b||(b=""),"string"!=typeof b)b.global||(b=new RegExp(b.source,b.ignoreCase?"ig":"g")),this.matches=function(c,e){var f,g,h;if(c){for(b.lastIndex=0,f=a.getLine(e.line).slice(0,e.ch),g=b.exec(f),h=0;g;){h+=g.index+1,f=f.slice(h),b.lastIndex=0;var i=b.exec(f);if(!i)break;g=i}h--}else b.lastIndex=e.ch,f=a.getLine(e.line),g=b.exec(f),h=g&&g.index;if(g&&g[0])return{from:d(e.line,h),to:d(e.line,h+g[0].length),match:g}};else{e||(b=b.toLowerCase());var f=e?function(a){return a}:function(a){return a.toLowerCase()},g=b.split("\n");1==g.length?b.length?this.matches=function(c,e){var g,h=f(a.getLine(e.line)),i=b.length;if(c?e.ch>=i&&(g=h.lastIndexOf(b,e.ch-i))!=-1:(g=h.indexOf(b,e.ch))!=-1)return{from:d(e.line,g),to:d(e.line,g+i)}}:this.matches=function(){}:this.matches=function(b,c){var e=c.line,h=b?g.length-1:0,i=g[h],j=f(a.getLine(e)),k=b?j.indexOf(i)+i.length:j.lastIndexOf(i);if(!(b?k>=c.ch||k!=i.length:k<=c.ch||k!=j.length-i.length))for(;;){if(b?!e:e==a.lineCount()-1)return;if(j=f(a.getLine(e+=b?-1:1)),i=g[b?--h:++h],!(h>0&&h<g.length-1)){var l=b?j.lastIndexOf(i):j.indexOf(i)+i.length;if(b?l!=j.length-i.length:l!=i.length)return;var m=d(c.line,k),n=d(e,l);return{from:b?n:m,to:b?m:n}}if(j!=i)return}}}}function c(a,c,d,e){return new b(a,c,d,e)}var d=a.Pos;return b.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(a){function b(a){var b=d(a,0);return c.pos={from:b,to:b},c.atOccurrence=!1,!1}for(var c=this,e=this.cm.clipPos(a?this.pos.from:this.pos.to);;){if(this.pos=this.matches(a,e))return this.pos.from&&this.pos.to||window.console.log(this.matches,this.pos),this.atOccurrence=!0,this.pos.match||!0;if(a){if(!e.line)return b(0);e=d(e.line-1,this.cm.getLine(e.line-1).length)}else{var f=this.cm.lineCount();if(e.line==f-1)return b(f);e=d(e.line+1,0)}}},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(b){if(this.atOccurrence){var c=a.splitLines(b);this.cm.replaceRange(c,this.pos.from,this.pos.to),this.pos.to=d(this.pos.from.line+c.length-1,c[c.length-1].length+(1==c.length?this.pos.from.ch:0))}}},{getSearchCursor:c}}),define("general.utils/string-util",["jquery"],function(){"use strict";function a(a){var b=/^[^\\/:*?\"<>|\x00-\x1f]+$/;return void 0!==a&&!e(a,"_")&&!e(a,"$$")&&b.test(a)&&a.length>=x&&a.length<=y}function b(a){return!/[\\\*\?"\(\)<>\|' &\$£¤\^\/+\-]+/.test(a)}function c(a){return/^(ftp|http|https):\/\/[^ "]+$/.test(a.toLowerCase())}function d(a){return/^.*:\/\//.test(a)?a:"http://"+a}function e(a,b){return 0===a.indexOf(b)}function f(a,b){return a.indexOf(b,a.length-b.length)!==-1}function g(a,b){return b||(b=""),a.length>0?a.reduce(function(a,c){return a+b+c}):""}function h(a){return a.replace(/.*\[|\]/gi,"").match(/"[^=]*"|[^;]+/g)}function i(a,b){var c,d=h(a);if(d)for(c=0;c<d.length;c++)if(d[c].toLowerCase().indexOf(b.toLowerCase())!==-1)return d[c].split("=")[1];return""}function j(a,b){function c(){return(a+"\\"+b).replace("\\\\","\\")}return function(){if("\\\\"===a.substring(0,2))return"\\"+c()}()||c()}function k(a){var b,c=h(a),d=[];return c&&c.forEach(function(a){(b=a.split("="))&&d.push({key:b[0],value:b.length>1?b[1]:""})}),d}function l(a){return"\\"===a.charAt(0)&&(a=a.substring(1)),"\\"===a.charAt(a.length-1)&&(a=a.slice(0,-1)),a}function m(a){return"\\"!==a.charAt(a.length-1)&&(a+="\\"),a}function n(a){var b;return"\\\\"===a.substring(0,2)?(b=l(a.substring(2)).split("\\"),b.pop(),"\\\\"+g(b,"\\")):(b=l(a).split("\\"),b.pop(),1===b.length?b[0]+"\\":g(b,"\\"))}function o(a){return a.replace(/[0-9]+/g,function(a){var b=a.length,c=""+b,d="000";return d.substring(0,d.length-c.length)+c+""+a})}function p(a,b){a.sort(function(a,c){return q(a[b],c[b])})}function q(a,b){var c=o(a).toLowerCase(),d=o(b).toLowerCase();return c.localeCompare(d)}function r(a,b){if(!a)throw new Error("Haystack is undefined.");if(!b)throw new Error("Needle is undefined.");return a.indexOf(b)!==-1}function s(a,b){if(a+="",!(b+=""))return 0;var c=b.match(/^\/(.*)\/([a-z]*)$/);if(!c){a=a.toLowerCase(),b=b.toLowerCase();for(var d=0,e=0,f=b.length,g=!1;!g;)e=a.indexOf(b,e),e>=0?(d++,e+=f):g=!0;return d}try{var h=new RegExp(c[1],c[2].indexOf("i")===-1?"":"i");return a.split(h).length-1}catch(a){return 0}}function t(a){return a.substring(a.lastIndexOf("\\")+1,a.length)}function u(a){return a.substring(0,a.lastIndexOf("\\")+1)}function v(a){var b=a.match(/.*\\(.*)\\.*$/);return b||(b=a.match(/^(.*)\\.*$/)),b?b[1]:null}function w(a){return!(!a||"false"===a)}var x=1,y=256;return{MIN_CONNECTION_NAME_LENGTH:x,MAX_CONNECTION_NAME_LENGTH:y,isValidConnectionName:a,isValidFieldName:b,isValidUrl:c,prefixHttpToUrl:d,endsWith:f,startsWith:e,goUpOneFolderLevel:n,removeSurroundingSlashes:l,arrayToString:g,formatDirectoryPathForEngine:m,sortSlightlyMoreNaturallyArray:p,sortSlightlyMoreNaturallySingle:q,_expandNumbersForNaturalSorting:o,getValueFromConnectionString:i,tokenizeConnectionString:k,contains:r,occurrencesRE:s,combinePath:j,fileNameFromPath:t,fileDirectoryFromPath:u,lastFolderFromPath:v,bool:w}}),define("general.components/codearea/search-util",["general.utils/string-util"],function(a){"use strict";function b(b,d){var e=a.occurrencesRE(b,d);return e>=c?c:e}var c=2e3;return{MAX_NBR_OF_HITS:c,getMaxNumberOfHits:b}}),define("general.components/codearea/searcher",["./search-cursor","./search-util"],function(a,b){"use strict";function c(){this.posFrom=this.posTo=this.query=null,this.marked=[]}function d(d){function e(b,c,e){return a.getSearchCursor(d,b,c,e)}function f(a){s.validQuery=!0;var b=!1;try{return b?new RegExp(b[1],b[2].indexOf("i")===-1?"":"i"):a}catch(b){return s.validQuery=!1,a}}function g(){d.operation(function(){var a;if(r.query){for(r.query=null,a=0;a<r.marked.length;++a)r.marked[a].clear();r.marked.length=0}}),i()}function h(a,c,h,i){var j=0;return g(),a?(d.operation(function(){r.query=f(a);var g={line:0,ch:0};if(!c&&p&&p.from()&&(g=p.from()),p=e(r.query,{line:0,ch:0},i),j=b.getMaxNumberOfHits(d.getValue(),a),d.lineCount()<2e3)for(;p.findNext();)r.marked.push(d.markText(p.from(),p.to(),{className:"cm-searching"}));r.posFrom=r.posTo=d.getCursor(),p=e(r.query,g,i)}),h&&k(),s.hits=j,j):(s.hits=0,0)}function i(){q&&q.clear()}function j(){i(),q=d.markText(p.from(),p.to(),{className:"cm-current"}),d.setCursor(p.to()),r.posFrom=p.from(),r.posTo=p.to()}function k(a,b){var c=p.find(a);return c?(j(),d.scrollIntoView(p.from(),d.getScrollInfo().clientHeight/2)):b&&b(),c}function l(a){return p=e(r.query,{line:0,ch:0},a),k(!1)}function m(a){var b=d.lastLine(),c=d.getLine(b).length;return p=e(r.query,{line:b,ch:c},a),k(!0)}function n(a,b,c,d){var e="string"==typeof r.query?b:p.pos.match[0].replace(r.query,b);p.atOccurrence||l(c),p.replace(e),s.hits--,p.find(a)?j():d&&d()}function o(a,b,c){if(a){var g=0;return a=f(a),d.operation(function(){for(p=e(a,void 0,c);p.findNext();){g++;var d="string"==typeof r.query?b:p.pos.match[0].replace(r.query,b);p.replace(d)}}),s.hits=0,g}}var p,q,r=new c,s={doSearch:h,clearMarkedSearch:g,doFindNext:k,doFindFirst:l,doFindLast:m,doReplaceAll:o,doReplace:n,hits:0,validQuery:!0};return s}return{createSingleCodeareaSearcher:d}}),function(a){"object"==typeof exports&&"object"==typeof module?a(require("cm")):"function"==typeof define&&define.amd?define("cm.comment",["cm"],a):a(CodeMirror)}(function(a){"use strict";function b(a){var b=a.search(d);return b==-1?0:b}var c={},d=/[^\s\u00a0]/,e=a.Pos;a.commands.toggleComment=function(a){a.toggleComment()},a.defineExtension("toggleComment",function(a){a||(a=c);for(var b=this,d=1/0,f=this.listSelections(),g=null,h=f.length-1;h>=0;h--){var i=f[h].from(),j=f[h].to();i.line>=d||(j.line>=d&&(j=e(d,0)),d=i.line,null==g?b.uncomment(i,j,a)?g="un":(b.lineComment(i,j,a),g="line"):"un"==g?b.uncomment(i,j,a):b.lineComment(i,j,a))}}),a.defineExtension("lineComment",function(a,f,g){g||(g=c);var h=this,i=h.getModeAt(a),j=g.lineComment||i.lineComment;if(!j)return void((g.blockCommentStart||i.blockCommentStart)&&(g.fullLines=!0,h.blockComment(a,f,g)));if(null!=h.getLine(a.line)){var k=Math.min(0!=f.ch||f.line==a.line?f.line+1:f.line,h.lastLine()+1),l=null==g.padding?" ":g.padding,m=g.commentBlankLines||a.line==f.line;h.operation(function(){if(g.indent){for(var c=null,f=a.line;f<k;++f){var i=h.getLine(f),n=i.slice(0,b(i));(null==c||c.length>n.length)&&(c=n)}for(var f=a.line;f<k;++f){var i=h.getLine(f),o=c.length;(m||d.test(i))&&(i.slice(0,o)!=c&&(o=b(i)),h.replaceRange(c+j+l,e(f,0),e(f,o)))}}else for(var f=a.line;f<k;++f)(m||d.test(h.getLine(f)))&&h.replaceRange(j+l,e(f,0))})}}),a.defineExtension("blockComment",function(a,b,f){f||(f=c);var g=this,h=g.getModeAt(a),i=f.blockCommentStart||h.blockCommentStart,j=f.blockCommentEnd||h.blockCommentEnd;if(!i||!j)return void((f.lineComment||h.lineComment)&&0!=f.fullLines&&g.lineComment(a,b,f));var k=Math.min(b.line,g.lastLine());k!=a.line&&0==b.ch&&d.test(g.getLine(k))&&--k;var l=null==f.padding?" ":f.padding;a.line>k||g.operation(function(){if(0!=f.fullLines){var c=d.test(g.getLine(k));g.replaceRange(l+j,e(k)),g.replaceRange(i+l,e(a.line,0));var m=f.blockCommentLead||h.blockCommentLead;if(null!=m)for(var n=a.line+1;n<=k;++n)(n!=k||c)&&g.replaceRange(m+l,e(n,0))}else g.replaceRange(j,b),g.replaceRange(i,a)})}),a.defineExtension("uncomment",function(a,b,f){f||(f=c);var g,h=this,i=h.getModeAt(a),j=Math.min(0!=b.ch||b.line==a.line?b.line:b.line-1,h.lastLine()),k=Math.min(a.line,j),l=f.lineComment||i.lineComment,m=[],n=null==f.padding?" ":f.padding;a:if(l){for(var o=k;o<=j;++o){var p=h.getLine(o),q=p.indexOf(l);if(q>-1&&!/comment/.test(h.getTokenTypeAt(e(o,q+1)))&&(q=-1),q==-1&&(o!=j||o==k)&&d.test(p))break a;if(q>-1&&d.test(p.slice(0,q)))break a;m.push(p)}if(h.operation(function(){for(var a=k;a<=j;++a){var b=m[a-k],c=b.indexOf(l),d=c+l.length;c<0||(b.slice(d,d+n.length)==n&&(d+=n.length),g=!0,h.replaceRange("",e(a,c),e(a,d)))}}),g)return!0}var r=f.blockCommentStart||i.blockCommentStart,s=f.blockCommentEnd||i.blockCommentEnd;if(!r||!s)return!1;var t=f.blockCommentLead||i.blockCommentLead,u=h.getLine(k),v=j==k?u:h.getLine(j),w=u.indexOf(r),x=v.lastIndexOf(s);if(x==-1&&k!=j&&(v=h.getLine(--j),x=v.lastIndexOf(s)),w==-1||x==-1||!/comment/.test(h.getTokenTypeAt(e(k,w+1)))||!/comment/.test(h.getTokenTypeAt(e(j,x+1))))return!1;var y=u.lastIndexOf(r,a.ch),z=y==-1?-1:u.slice(0,a.ch).indexOf(s,y+r.length);if(y!=-1&&z!=-1&&z+s.length!=a.ch)return!1;z=v.indexOf(s,b.ch);var A=v.slice(b.ch).lastIndexOf(r,z-b.ch);return y=z==-1||A==-1?-1:b.ch+A,(z==-1||y==-1||y==b.ch)&&(h.operation(function(){h.replaceRange("",e(j,x-(n&&v.slice(x-n.length,x)==n?n.length:0)),e(j,x+s.length));var a=w+r.length;if(n&&u.slice(a,a+n.length)==n&&(a+=n.length),h.replaceRange("",e(k,w),e(k,a)),t)for(var b=k+1;b<=j;++b){var c=h.getLine(b),f=c.indexOf(t);if(f!=-1&&!d.test(c.slice(0,f))){var g=f+t.length;n&&c.slice(g,g+n.length)==n&&(g+=n.length),h.replaceRange("",e(b,f),e(b,g))}}}),!0)})}),define("general.components/codearea/codearea-exposed-context-api",["qvangular","cm","cm.comment"],function(a,b){var c="\r\n";a.directive("qvCodeareaExposedContextApi",["$parse","$timeout",function(a,d){return{require:["qvCodearea","qvCodeareaExposedContextApi"],link:function(b,c,d,e){var f=e[0],g=e[1];g._connectCodeArea(f);var h=a(d.qvCodeareaExposedContextApi);h.assign(b,g),b.$on("$destroy",function(){h.assign(b,void 0),g._connectCodeArea(void 0)})},controller:function(){function a(a){q=a}function e(){for(var a=q.codemirror.getTokenAt(q.codemirror.getCursor()),b=0,c=a.state.lexical;c&&"qvfunction"!==c.type||0===b&&c.info&&a.string.toLowerCase()===c.info.toLowerCase();)c=c.prev,b++;return!!c&&c.info}function f(){q.focus()}function g(){q.codemirror.undo()}function h(){q.codemirror.redo()}function i(){b.commands.toggleComment(q.codemirror),f()}function j(){q.codemirror.indentSelection("add"),f()}function k(){q.codemirror.indentSelection("subtract"),f()}function l(){return q.codemirror.options.readOnly}function m(a){var b=q.codemirror.getDoc().getSelection(),c=a(b);q.codemirror.replaceSelection(c)}function n(a){q.codemirror.setCursor(q.codemirror.getCursor("end"));var b=q.codemirror.getCursor().line,d=q.codemirror.getCursor().ch,e=q.codemirror.getLine(b).length;e>0&&(d===e?(q.codemirror.setCursor(b,e),q.codemirror.replaceSelection(c)):(q.codemirror.setCursor(q.codemirror.lineCount(),0),a=c+c+a)),q.codemirror.setCursor(q.codemirror.getCursor("end")),q.codemirror.replaceSelection(a),q.focus()}function o(a){q.codemirror.replaceSelection(a,"end"),q.focus()}function p(a){d(function(){var b=q.codemirror.lineCount();a<b?q.codemirror.setCursor(a-1,0):q.codemirror.setCursor(b-2,0),q.focus()})}var q,r={applyToSelection:m,focus:f,undo:g,redo:h,comment:i,indent:j,outdent:k,insertCode:n,replaceSelection:o,getFunctionNameUnderCursor:e,gotoLine:p,isReadOnly:l,_connectCodeArea:a,codemirror:void 0};return Object.defineProperty(r,"canUndo",{get:function(){return q&&q.codemirror&&q.codemirror.historySize().undo>0},enumerable:!0}),Object.defineProperty(r,"canRedo",{get:function(){return q&&q.codemirror&&q.codemirror.historySize().redo>0},enumerable:!0}),r}}}])}),define("general.components/codearea/codearea-exposed-touch-api",["jquery","qvangular"],function(a,b){function c(a,b){var c,d=a.length,e=b.length,f=Math.min(a.length,b.length);for(c=0;c<f&&a.charAt(c)===b.charAt(c);c++);if(c!==a.length||c!==b.length){var g,h,i=c;for(c=0;c<f&&(g=d-c-1,h=e-c-1,!(g<i||h<i))&&a.charAt(d-c-1)===b.charAt(e-c-1);c++);return{start:i,targetRange:{from:i,to:d-c-1+1},sourceRange:{from:i,to:e-c-1+1}}}}return b.directive("qvCodeareaExposedTouchApi",["$parse","$timeout",function(b,d){return{require:["qvCodearea","qvCodeareaExposedTouchApi"],link:function(a,c,e,f){var g=f[0],h=f[1];h._connectCodeArea(g);var i=b(e.qvCodeareaExposedTouchApi);i.assign(a,h),a.$on("$destroy",function(){i.assign(a,void 0),d(function(){h._connectCodeArea(void 0)})})},controller:["$scope",function(b){function e(a){o=a}function f(a,b){o.codemirror.scrollTo(b,a)}function g(a){o.setCustomFocusFn(a)}function h(c){function d(){var b=a(o.codemirror.getScrollerElement());c(b.scrollTop(),b.scrollLeft())}o.codemirror.on("scroll",d),b.$on("$destroy",function(){o.codemirror.off("scroll",d),c=void 0})}function i(a){function c(){var b={anchor:o.codemirror.indexFromPos(o.codemirror.getCursor("anchor")),head:o.codemirror.indexFromPos(o.codemirror.getCursor("head"))};a(o.codemirror.getValue(),b)}function d(){p||c()}c(),o.codemirror.on("change",d),b.$on("$destroy",function(){o.codemirror.off("change",d),a=void 0})}function j(c){b.$watch(function(){return String(o.codemirror.lineCount()).length},function(){d(function(){var b=a(o.codemirror.getGutterElement()).outerWidth();c({top:0,left:b,bottom:0,right:0})})}),b.$on("$destroy",function(){c=void 0})}function k(a,b,c){o&&o.codemirror.setSelection(a,b,c)}function l(a,b){var d=o.codemirror.getValue("\n"),e=c(d,b);if(e){var f=b.substring(e.sourceRange.from,e.sourceRange.to),g=o.codemirror.posFromIndex(e.targetRange.from),h=o.codemirror.posFromIndex(e.targetRange.to);p=!0,o.codemirror.replaceRange(f,g,h),p=!1}}function m(){o.cssClasses["qv-codearea-disable-selection"]=!0}function n(){o.cssClasses["qv-codearea-disable-selection"]=!1}var o,p;return{_connectCodeArea:e,scrollTo:f,onScroll:h,setOverlayFocuser:g,replicateSelection:k,replicateContent:l,onNewContent:i,onResize:j,disableSelections:m,restoreSelections:n}}]}}]),{diff:c}}),define("general.components/codearea/codearea-exposed-search-api",["qvangular","general.components/codearea/searcher"],function(a,b){a.directive("qvCodeareaExposedSearchApi",["$parse",function(a){return{require:"qvCodearea",link:function(c,d,e,f){var g=a(e.qvCodeareaExposedSearchApi);g.assign(c,b.createSingleCodeareaSearcher(f.codemirror)),c.$on("$destroy",function(){g.assign(c,void 0)})},controller:function(){}}}])}),define("general.components/codearea/codearea-accelerators",["qvangular"],function(a){a.directive("qvCodeareaAccelerators",function(){return{require:["qvCodearea","qvCodeareaExposedContextApi"],link:function(b,c,d,e){function f(a,b){return a.keyCode===b.keyCode&&a.ctrlKey===(b.ctrlKey||!1)&&a.shiftKey===(b.shiftKey||!1)}function g(c,e){var g=b.$eval(d.qvCodeareaAccelerators);for(var h in g){var k=g[h];if(f(e,k)&&(!k.previous||f(j,k.previous)))return a.$apply(function(){k.fn(i)}),j={keyCode:void 0,ctrlKey:void 0,shiftKey:void 0},void e.preventDefault()}j={keyCode:e.keyCode,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey}}var h=e[0],i=e[1],j={keyCode:void 0,ctrlKey:void 0,shiftKey:void 0};h.codemirror.on("keydown",g),b.$on("$destroy",function(){h.codemirror.off("keydown",g)})}}})}),define("general.components/codearea/codearea-breakpoints",["jquery","qvangular"],function(a,b){function c(b){var c=a("<div class='qv-codearea-breakpoint-marker' data-icon='debugger-breakpoint'></div>");return c.data("breakpoint",b),c[0]}function d(b,c){c.enabled?(a(b).addClass("qv-codearea-breakpoint-marker-enabled"),a(b).removeClass("qv-codearea-breakpoint-marker-disabled")):(a(b).addClass("qv-codearea-breakpoint-marker-disabled"),a(b).removeClass("qv-codearea-breakpoint-marker-enabled"))}b.directive("qvCodeareaBreakpoints",function(){return{require:"qvCodearea",link:function(e,f,g,h){function i(a){if(a){n=a;for(var b=h.codemirror.getDoc().lineCount(),e=0;e<b;e++){var f=e+1,g=a[f],i=h.codemirror.lineInfo(e).gutterMarkers,j=i&&i["qv-codearea-breakpoint"];g?(j||(j=c(g),h.codemirror.setGutterMarker(e,"qv-codearea-breakpoint",j)),d(j,g)):j&&h.codemirror.setGutterMarker(e,"qv-codearea-breakpoint",null)}}}function j(a){for(var b=h.codemirror.getDoc().lineCount(),c=a.from.line;c<b;c++){var d=h.codemirror.lineInfo(c).gutterMarkers;if(d&&d["qv-codearea-breakpoint"])return!0}return!1}function k(a){return a.text.length!==a.removed.length}function l(c,d){!h.supressChangeEvent&&k(d)&&j(d)&&b.$apply(function(){var b=n;for(var c in b)b.hasOwnProperty(c)&&delete b[c];for(var d=h.codemirror.getDoc().lineCount(),e=0;e<d;e++){var f=e+1,g=h.codemirror.lineInfo(e).gutterMarkers,i=g&&g["qv-codearea-breakpoint"];if(i){var j=a(i),k=j.data("breakpoint");k.lineNbr=f,b[f]=k}}})}function m(a,b){h.disabled||e.$apply(function(){var a=b+1;n[a]?delete n[a]:n[a]={enabled:!0,lineNbr:a}})}var n;e.$watch(g.qvCodeareaBreakpoints,i),e.$watch(g.qvCodeareaBreakpoints,i,!0),h.codemirror.on("change",l),h.codemirror.on("gutterClick",m);var o={F9:function(){m(h.codemirror,h.codemirror.getCursor().line)}};h.codemirror.addKeyMap(o),e.$on("$destroy",function(){h.codemirror.off("change",l),h.codemirror.off("gutterClick",m),h.codemirror.removeKeyMap(o)})}}})}),define("general.components/codearea/codearea-debug-location",["qvangular"],function(a){a.directive("qvCodeareaDebugLocation",function(){return{require:"qvCodearea",link:function(a,b,c,d){var e;a.$watch(c.qvCodeareaDebugLocation,function(a){if(a){var b=d.codemirror.lastLine()+1,c=a.lineNbr;c>b&&(c=b),e&&(d.codemirror.removeLineClass(e,"background","qv-codearea-current-debug-line"),d.codemirror.removeLineClass(e,"background","qv-codearea-current-debug-line-error")),c>0&&c<=b&&(d.codemirror.addLineClass(c-1,"background","qv-codearea-current-debug-line"),a.errorMessage&&d.codemirror.addLineClass(c-1,"background","qv-codearea-current-debug-line-error"),d.codemirror.scrollIntoView({line:c-1,ch:0},200),e=d.codemirror.getLineHandle(c-1))}},!0)}}})}),define("general.components/codearea/codearea-errors",["qvangular"],function(a){a.directive("qvCodeareaErrors",function(){return{require:"qvCodearea",link:function(a,b,c,d){var e=[];a.$watch(c.qvCodeareaErrors+".content",function(a){if(a){var b;for(b=0;b<e.length;b++)e[b].clear();for(b=0;b<a.length;b++){var c=a[b],f={line:c.qLineInTab,ch:c.qColInLine},g={line:c.qLineInTab,ch:c.qColInLine+c.qErrLen},h=d.codemirror.markText(f,g,{className:"cm-servererror"});e.push(h)}}},!0),a.$on("$destroy",function(){e=[]})}}})}),define("general.components/codearea/codemirror-change-limiter",[],function(){function a(a,b,c){var d=b.text.join("\n"),e=a.getRange(b.from,b.to).length,f=d.length,g=f-e,h=a.getValue().length;h>=c&&0===e?b.cancel():h+g>c&&(f=Math.max(0,c-h+e),d=d.substr(0,f),b.update(null,null,d.split("\n")))}return a}),define("general.components/codearea/codearea-limit",["qvangular","general.components/codearea/codemirror-change-limiter"],function(a,b){a.directive("qvCodeareaLimit",function(){return{require:"qvCodearea",link:function(a,c,d,e){function f(c,e){var f=a.$eval(d.qvCodeareaLimit);f&&f>0&&b(c,e,f)}e.codemirror.on("beforeChange",f),a.$on("$destroy",function(){e.codemirror.off("beforeChange",f)})}}})}),define("general.components/codearea/codearea-help-mode",["qvangular","jquery","core.utils/help-url","underscore"],function(a,b,c,d){function e(a,b){var c,d,e,f=[];for(d=0;d<a.length;d++)for(c=a[d].split(" "),e=0;e<c.length;e++)c[e].toLowerCase()===b.toLowerCase()&&(k||(k=c.length>1,l=e>0),f.push(a[d]));return f}function f(a,b,c){if(" "===c.string){var d=a.getTokenAt({ch:c.end+1,line:b.line});if(d.string.length>1)return d}return c}function g(a,b,c,d){var e=d?b.end-(b.string.length+1):b.end+2;return a.getTokenAt({ch:e,line:c.line})}function h(a,b,c,d){var e={left:b.pageX,top:b.pageY},f=a.coordsChar(e,"window");return j(a,a.getTokenAt(f),c,d)}function i(a,b,c,d){return j(a,a.getTokenAt(a.getCursor()),c,d)}function j(a,b,h,i){k=!1,l=!1,h=h||"scriptsyntax";var j,n,o,p=c.path+h+".",q=[];return("keyword"===b.type||"function"===b.type)&&(b=f(a,a.getCursor(),b),q=e(d.pluck(i.getAutocompleteList(),"text"),b.string),k?(n=g(a,b,a.getCursor(),l),o=e(q,n.string),j=o.length>0&&n.string!==b.string?l?n.string+"_"+b.string:b.string+"_"+n.string:b.string):j=b.string,p+=j,/firefox/.test(window.navigator.userAgent.toLocaleLowerCase())&&m&&m.close(),m=window.open(p,"__qlikviewhelp"),!0)}var k,l,m;a.directive("qvCodeareaHelpMode",["$parse",function(a){return{require:"qvCodearea",link:function(c,d,e,f){var g,j=c.$watch(e.qvCodeareaHelpModeOptions,function(k){function l(b){if(g){b.preventDefault();h(f.codemirror,b,k.syntax,k.service)&&c.$apply(function(){a(e.qvCodeareaHelpMode).assign(c,!1)})}}function m(a,b){72!==b.keyCode&&104!==b.keyCode||!b.ctrlKey||(b.preventDefault(),i(f.codemirror,b,k.syntax,k.service))}j(),c.$watch(e.qvCodeareaHelpMode,function(a){g=a,f.cssClasses["qv-codearea-help-mode"]=a}),b(d).on("click",l),f.codemirror.on("keydown",m),c.$on("$destroy",function(){b(d).off("click",l),f.codemirror.off("keydown",m)})})}}}])}),define("general.components/codearea/codearea-touch-overlay",["qvangular"],function(a){a.directive("qvCodeareaTouchOverlay",function(){return{restrict:"E",replace:!0,scope:{codeareaTouchApi:"=",enabled:"=",helpMode:"="},template:'<div class="qv-codearea-touch-overlay-container" ng-style="containerStyle"><textarea class="qv-codearea-touch-overlay" autocorrect="off" autocapitalize="off" autocomplete="off" spellcheck="false" wrap="off"></textarea></div>',link:function(a,b){function c(b){function c(a,b){var c=a.substring(0,b).split("\n");return{line:c.length-1,ch:c[c.length-1].length}}function f(){var a=d.val(),e=d[0].selectionStart,f=d[0].selectionEnd,g=c(a,e),h=c(a,f);b.replicateSelection(g,h,{scroll:!1})}function g(){e||(d[0].selectionStart===h&&d[0].selectionEnd===i||(h=d[0].selectionStart,i=d[0].selectionEnd,f()),setTimeout(g,200))}
/iPad|iPhone|iPod/.test(navigator.userAgent)&&d.css("padding-left","1px"),b.disableSelections(),a.$on("$destroy",function(){b.restoreSelections()}),b.onNewContent(function(a,b){d.val(a),d[0]===document.activeElement&&(d[0].selectionStart===b.anchor&&d[0].selectionEnd===b.head||(d[0].selectionStart=b.anchor,d[0].selectionEnd=b.head))}),b.setOverlayFocuser(function(){}),b.onResize(function(b){a.containerStyle.left=b.left}),b.onScroll(function(a,b){d.scrollTop(a),d.scrollLeft(b),document.activeElement===d[0]&&(""===d[0].style.textShadow?d[0].style.textShadow="rgba(0,0,0,0) 0 0 0":d[0].style.textShadow="")}),d.on("scroll",function(){b.scrollTo(d.scrollTop(),d.scrollLeft())}),d.on("input",function(a){var c=d.val();b.replicateContent(a,c)});var h,i;setTimeout(g,200)}var d=b.find("textarea"),e=!1;a.containerStyle={},a.$watch("helpMode",function(a){a?b.hide():b.show()});var f=a.$watch("codeareaTouchApi",function(a){a&&(c(a),f())});a.$on("$destroy",function(){e=!0,d=void 0})}}})}),define("general.components/codearea/codearea-block-large-pastes",["qvangular"],function(a){"use strict";a.directive("qvCodeareaBlockLargePastes",function(){var a=function(a){return""===a||isNaN(a)?1e6:a},b=function(a){return a.originalEvent.clipboardData?a.originalEvent.clipboardData.getData("text/plain").length:window.clipboardData.getData("Text").length};return{restrict:"A",controller:["$scope","$element","$attrs",function(c,d,e){d.find("textarea").on("paste",function(c){b(c)>a(e.qvCodeareaBlockLargePastes)&&c.preventDefault()}),c.$on("$destroy",function(){d.find("textarea").off("paste")})}]}})}),define("general.components/codearea/codearea-exposed-gutter-width",["jquery","qvangular"],function(a,b){b.directive("qvCodeareaExposedGutterWidth",["$parse","$timeout",function(b,c){return{require:"qvCodearea",link:function(d,e,f,g){var h=b(f.qvCodeareaExposedGutterWidth);d.$watch(function(){return String(g.codemirror.lineCount()).length},function(){var b=a(g.codemirror.getGutterElement()).outerWidth();h.assign(d,b),c(function(){var b=a(g.codemirror.getGutterElement()).outerWidth();h.assign(d,b)})}),d.$on("$destroy",function(){h.assign(d,void 0)})},controller:function(){}}}])}),define("general.components/codearea/codearea-composition-event",["qvangular","jquery","cm"],function(a,b,c){"use strict";function d(a){var b,c,d,e;for(c=a.getAllMarks(),d=0,e=c.length;d<e;d++)null!=(b=c[d])&&b.className===q&&b.clear();return!0}function e(a,e){function q(){return window.navigator.userAgent.indexOf("MSIE ")>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)}var s=e;a.options.enableCompositionMod=!0,j=function(){k&&k(),a.display.input.blur(),a.display.input.focus()},i=function(b){if(l=b.char,k&&k(),a.display.inCompositionMode){var c=a.getCursor(),d=a.display.compositionHead,e=a.charCoords(c).left-a.charCoords(d).left;e+=void 0!==l?30:1,a.display.input.style.width=e+"px"}},f=function(){a.options.enableCompositionMod&&(p.disabled=!0,a.display.inCompositionMode=!0,n=s.offset(),a.display.inputDiv.classList.add("CodeMirror-input-wrapper"),a.display.inputDiv.classList.add("in-composition"),a.setOption("readOnly",!0),a.somethingSelected()&&a.replaceSelection(""),a.display.compositionHead=a.getCursor(),void 0===l?a.display.input.value="":" "===l&&g({data:" "}))},g=function(b){var c,d;if(a.options.enableCompositionMod&&a.display.inCompositionMode){var e=a.display.compositionHead;a.display.textMarkerInComposition?(c=a.display.textMarkerInComposition.find())&&(a.replaceRange(b.data,e,c.to),a.display.textMarkerInComposition.clear(),a.display.textMarkerInComposition=void 0):a.replaceRange(b.data,e,e);var f=a.getCursor();d=a.charCoords(f).left-a.charCoords(e).left,void 0===l&&(d+=1),a.display.input.style.width=d+"px",a.display.textMarkerInComposition=a.markText(e,f,r),m()}},h=function(b){var e;a.options.enableCompositionMod&&a.display.inCompositionMode&&(q()?"\b"===l&&g(b):g(b),a.display.inCompositionMode=!1,a.display.compositionHead=void 0,null!=(e=a.display.textMarkerInComposition)&&e.clear(),a.display.textMarkerInComposition=void 0,a.setOption("readOnly",!1),a.display.inputDiv.classList.remove("in-composition"),a.display.inputDiv.classList.remove("CodeMirror-input-wrapper"),d(a),k=function(){p.disabled=!1,c.off(a.display.input,"input",k),a.display.inCompositionMode||(a.display.input.value="",a.display.input.style.width="0px",k=void 0)},c.on(a.display.input,"input",k))},m=function(){if(a.display.inCompositionMode){var b=a.charCoords(a.display.compositionHead).top-n.top;void 0!==l&&(b-=1),a.display.inputDiv.style.top=b+"px";var c=a.charCoords(a.display.compositionHead).left-n.left;a.display.inputDiv.style.left=c+"px"}},o=function(c){var d=b(a.display.scroller);d.scrollTop(d.scrollTop()-c.wheelDelta)}}var f,g,h,i,j,k,l,m,n,o,p,q="CodeMirror-text-in-composition",r={inclusiveLeft:!0,inclusiveRight:!0,className:q};a.directive("qvCodeareaCompositionEvent",function(){return{restrict:"A",require:"qvCodearea",link:function(a,d,l,n){e(n.codemirror,d);var q=n.codemirror.display.input,r=a.$watch(l.qvCodeareaAutocomplete,function(a){p=a,r()});r=a.$watch("codeareaTouchApi",function(a){a&&(a.onResize(function(){m()}),a.onScroll(function(){m()}),r())}),b(window).on("resize",m),c.on(n.codemirror,"mousedown",j),c.on(q,"keydown",i),c.on(q,"compositionstart",f),c.on(q,"compositionupdate",g),c.on(q,"compositionend",h),c.on(q,"mousedown",j),c.on(q,"mousewheel",o),a.$on("$destroy",function(){b(window).off("resize",m),c.off(n.codemirror,"mousedown",j),c.off(q,"compositionstart",f),c.off(q,"keydown",i),c.off(q,"compositionupdate",g),c.off(q,"compositionend",h),c.off(q,"input",k),c.off(q,"mousedown",j),c.off(q,"mousewheel",o)})}}})}),define("general.components/codearea/codearea",["jquery","qvangular","cm","cm.matchbrackets","general.components/codearea/qlikview-script-mode","general.components/codearea/codearea-function-tip","general.components/codearea/codearea-autocomplete","general.components/codearea/searcher","general.components/codearea/codearea-exposed-context-api","general.components/codearea/codearea-exposed-touch-api","general.components/codearea/codearea-exposed-search-api","general.components/codearea/codearea-accelerators","general.components/codearea/codearea-breakpoints","general.components/codearea/codearea-debug-location","general.components/codearea/codearea-errors","general.components/codearea/codearea-limit","general.components/codearea/codearea-help-mode","general.components/codearea/codearea-touch-overlay","general.components/codearea/codearea-block-large-pastes","general.components/codearea/codearea-exposed-gutter-width","general.components/codearea/codearea-composition-event"],function(){}),define("assets/client/dialogs/expression-dialog/expression-dialog",["jquery","core.models/app","core.utils/deferred","client.assets/tab-contents/fields/assets-field-list-model","general.utils/expression-validator","general.components/info-popover/info-popover","general.services/show-service/show-service","text!assets/client/dialogs/expression-dialog/expression-dialog.ng.html","client.utils/state","assets/client/dialogs/expression-dialog/expression-dialog-controller","assets/client/dialogs/expression-dialog/expression-validation-info","general.utils/string-limits","client.services/validation","translator","general.components/function-tip-view/function-tip-view","touche","assets/client/dialogs/expression-dialog/expression-bnf","general.components/extract","general.components/codearea/codearea"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){function r(a,b){b.preventDefault();var c=a.controller.previewText();a.codearea.contextApi.replaceSelection(c)}function s(a,b){a.functionTipOptions={service:b,view:o}}function t(b,c,d,e){function g(){h(),c.codearea.contextApi.focus()}function h(){a(document).off("keydown",g),i.remove()}if(d){var i=a("<div />").appendTo(document.body);d=d.replace(/\n/g," "),/^(input|textarea)$/i.test(document.activeElement.tagName)&&a.support.touch&&document.activeElement.blur(),i.showComponent(f,{alignTo:e.target,text:d,onClose:h,position:"top"}),a(document).one("keydown",{self:this},g)}}function u(a,b){var c={expression:a,validity:b.validity};return m.validateExpr(c,l)}function v(a){var e=a.app||b.current;return c.all({bnf:q.get(e),fields:e.enigmaModel.getFieldList()}).then(function(b){if(w)return c.reject();var e=b.bnf,f=d.expand(b.fields),h=String(a.expr||""),i={title:a.title,allowEmpty:a.allowEmpty,labels:a.labels,expr:h,mode:a.mode,controller:j.create({fields:f,translator:n}),expressionBnfModel:e};return w=!0,g.show(x,i).resultPromise})}var w=!1,x={template:h,controller:["$scope","$element",function(a,b){function c(b){a.info.setExpr(b),a.validity.expression||u(b,a)}a.stringLimits=l,a.controller=a.input.controller,a.codearea={content:a.input.expr};var d=new e.ExpressionValidator(null,a.input.mode);a.validity={expression:!0},a.enableTouchOverlay=p.utils.touch,a.insertTextHandler=r.bind(null,a),a.$watch("controller.selectedTable",function(b){a.controller.setTableFilter(b)}),a.info=k.create({validator:d,labels:a.input.labels}),a.info.setExpr(a.input.expr),a.showErrorMessage=t.bind(null,b,a),a.qlikviewReloadScriptMode={name:"qlikviewscript",service:a.input.expressionBnfModel},a.helpModeOptions={syntax:"chartsyntax",service:a.input.expressionBnfModel},a.autocompleteOptions={completeSingle:!1,service:a.input.expressionBnfModel},s(a,a.input.expressionBnfModel),a.cancel=function(){a.destroyComponent(),a.deferredResult.reject()},a.confirm=function(){var b=a.codearea.content;(u(b,a)||a.input.allowEmpty&&""===b)&&(a.destroyComponent(),a.deferredResult.resolve(b))},i.StateChanged.bind(a.cancel),a.$watch("codearea.content",c),a.$on("$destroy",function(){w=!1,i.StateChanged.unbind(a.cancel)})}]};return{_insertTextHandler:r,show:v}}),define("client.property-panel/property-panel-directives",["jquery","angular","qvangular","core.utils/resize","client.property-panel/component-utils","general.utils/expression-validator","assets/client/dialogs/expression-dialog/expression-dialog","util","general.utils/dom-util","general.utils/support","jqueryui"],function(a,b,c,d,e,f,g,h,i,j){function k(a){return"ValueExpr"===a||"ValueExpression"===a?f.Modes.NumberOrExpression:f.Modes.Expression}function l(a){return"="===a[0]?a:"="+a}return c.directive("ppSortable",[function(){return{scope:"=",link:function(b,c,d){b.$watch(d.ppSortable,function(d){if(d){var e;d=h.extend({},{handle:"[pp-sortable-handle]",start:function(a,b){b.item.data("startPos",b.item.index())},scrollSpeed:j.treatAsDesktop()?25:60,distance:j.treatAsDesktop()?10:0,items:"> :not(.locked)",cancel:".locked",update:function(a,c){var e=c.item.index(),f=c.item.data("startPos");b.$apply(function(){d.onMove(f,e)})},stop:function(){j.treatAsDesktop()||c.sortable("option","disabled",!0)}},d),e=c.closest(".pp-section"),e.length&&(d.containment=e),c.sortable(d),j.treatAsDesktop()||c.sortable("option","disabled",!0),b.enableTouchDrag=function(){var b;c.sortable("option","disabled",!1),b=a.Event(window.event,{type:"mousedown"}),b.which=1,b.pageX=window.event.pageX,b.pageY=window.event.pageY,b.target=window.event.target,a.ui.mouse.prototype._touchStart.call(c.data("ui-sortable"),b)}}})}}}]),c.directive("ppSlider",[function(){return{require:"?ngModel",link:function(a,d,e,f){a.$watch(e.ppSlider,function(e){e&&(e.range?(e=h.extend({},{min:0,max:10,step:1,values:f.$modelValue,stop:function(b,d){c.$apply(a,function(){f.$setViewValue(d.values)})}},e),a.$watchCollection(function(){return f.$modelValue},function(a,c){b.equals(a,c)||d.slider("values",a)})):(e=h.extend({},{min:0,max:10,step:1,value:f.$modelValue,stop:function(b,d){c.$apply(a,function(){f.$setViewValue(d.value)})}},e),a.$watch(function(){return f.$modelValue},function(a,b){a!==b&&d.slider("value",a)})),d.slider(e))})}}}]),c.directive("ppModelOnkeyup",function(){return{require:"ngModel",link:function(a,b,c,d){b.bind("keyup",function(c){27===c.which?(c.stopPropagation(),d.$rollbackViewValue(),b.trigger("blur")):13===c.which&&b.trigger("blur"),"function"==typeof a.onkeyup&&a.onkeyup(b)})}}}),c.directive("ppPlaceholder",function(){return{link:function(a,b,c){function d(){var d=a.$eval(c.ppPlaceholder);a.$eval(c.ppPlaceholderSuppressEqual)&&"="===d[0]&&(d=d.substr(1)),b.attr("placeholder",d)}b.on("focus",function(){b.attr("placeholder","")}),b.on("blur",function(){d()}),a.$watch(c.ppPlaceholder,function(){d()})}}}),c.directive("ppAccordion",function(){return{template:"<div ng-transclude></div>",transclude:!0,scope:{ppAccordion:"=",definition:"=",args:"="},controller:["$scope","$element","$timeout",function(b,c,e){function f(){i=e(function(){c.accordion("refresh"),i=null})}function g(a){var c=-1;return a=a.split(".")[0],Object.keys(b.definition.items||{}).filter(function(a){return b.definition.items[a].show!==!1}).forEach(function(b,d){if(b===a)return c=d,!1}),c}var h=b.args.cache,i=null;this.loadit=function(e){var i=h.get("accordion_path"),k=-1;i&&(k=g(i)),e===b.ppAccordion.length-1&&(c.accordion({header:".pp-section-header",active:k,heightStyle:"fill",animate:!!j.treatAsDesktop()&&"swing",activate:function(b,c){var d=a(c.newPanel).attr("x-path");h.put("accordion_path",d)}}),d.on("end",f))},b.$on("pp-open-path",function(a,b){var d=g(b);d>=0&&c.accordion("option","active",d)}),b.$on("$destroy",function(){i&&(e.cancel(i),i=null),d.off("end",f)})}]}}),c.directive("ppAccordionItem",function(){return{require:"^ppAccordion",link:function(a,b,c,d){d.loadit(a.$index)}}}),c.directive("ppInputValidator",["$parse",function(a){return{require:"ngModel",link:function(b,c,d,g){function i(a,b){if(void 0===a)return!1;switch(b){case"StringExpression":return 0===a.indexOf("=");case"ValueExpression":return"string"==typeof a&&0===a.indexOf("=");case"StringExpr":return 0===a.indexOf("=");case"ValueExpr":case"dimension":case"measure":return!0;default:return!1}}function j(c){d.ppValidationOnResult?a(d.ppValidationOnResult)(b,{isValid:c}):b.invalid=!c}function l(a){j(a.valid)}function m(a){"measure"===q?""===a?j(!0):o.validate(a):"dimension"===q?""===a?j(!1):(a&&"="!==a[0]&&(a="="+h.escapeField(a)),o.validate(a)):o.validate(a)}function n(a){i(a,q)?m(a):j(e.validateType(a,p,b.data,b.args))}var o=null,p=b.definition,q=d.expressionType;q&&(o=new f.ExpressionValidator(null,k(q)),o.Update.bind(l)),b.$on("datachanged",function(){n(g.$modelValue)}),b.$on("pp-revalidate",function(){n(g.$modelValue)}),b.$watch(function(){return g.$modelValue},function(a){n(a)}),b.$on("$destroy",function(){o&&o.Update.unbind(l)})}}}]),c.directive("ppExpressionEditor",["$parse","$timeout",function(c,d){return{link:function(e,f,j){function m(a,b){if(void 0===a)return!1;switch(b){case"StringExpression":case"ValueExpression":return"object"==typeof a;case"StringExpr":return"object"==typeof a&&0===a.qv.indexOf("=");case"ValueExpr":return"object"==typeof a;case"dimension":case"measure":return!0;default:return!1}}function n(a){return"'"!==a[0]&&"'"!==a[a.length-1]&&a.indexOf("(")===-1&&a.indexOf(")")===-1&&!h.isNumeric(a)}function o(){var a=c(j.ppExpressionEditor)(e),d=j.expressionType,f=k(d),i=a,o=m(a,d);"object"==typeof a&&("StringExpression"===d?a=l(a.qStringExpression.qExpr):"ValueExpression"===d?a=l(a.qValueExpression.qExpr):"StringExpr"===d?a=a.qv:"ValueExpr"===d&&(a=a.qv)),"dimension"===d&&a.length?"="!==a[0]&&(a="="+h.escapeField(a)):o||"StringExpr"!==d&&"StringExpression"!==d||("StringExpr"===d&&a.qv&&(a=a.qv),a&&n(a)&&(a="='"+a.replace(/'/g,"''")+"'")),g.show({expr:a,title:a?"Dimension.Expression.Dialog.Edit.Title":"Dimension.Expression.Dialog.Add.Title",allowEmpty:!0,mode:f}).then(function(a){"ValueExpression"===d&&a.length?a={qValueExpression:{qExpr:a}}:"StringExpression"===d&&a.length?a={qStringExpression:{qExpr:a}}:"ValueExpr"===d?a={qv:a}:"StringExpr"===d?("="!==a[0]&&(a="="+a),a={qv:a}):"dimension"===d&&a.length&&"="!==a[0]&&(a="="+a),j.ppExpressionEditorOnApply?c(j.ppExpressionEditorOnApply)(e,{value:a}):b.equals(i,a)||(e.value=a,e.change())},function(){})}f.on("keypress.pp-expression",function(b){13!==b.which&&32!==b.which||a(b.target).trigger("qv-activate")}),f.on("qv-activate.pp-expression",function(){var b;j.editorDisabled&&c(j.editorDisabled)(e)||(i.isInput(document.activeElement)?(b=a(document.activeElement),b.on("blur.pp-expression",function(){d(function(){o()}),b.off("blur.pp-expression")}),b.blur()):o())}),e.$on("$destroy",function(){f.off(".pp-expression")})}}}]),c.componentDirective("includePpComponent",{definition:"=",data:"=",args:"="}),{}}),define("objects.views/charts/components/data-title/dropdown-data-title/dropdown-data-title",["qvangular","util","text!./dropdown-data-title.ng.html","text!./dropdown-data-title-popover.ng.html","client.soft-property-panel/default-explore-properties","assets/client/soft-property-panel/soft-property-handler","client.soft-property-panel/components/hypercube-data/hypercube-data-handler","client.utils/property-resolver","core.utils/deferred","core.models/generic-object","core.utils/resize","client.property-panel/property-panel-directives"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function l(a){return{left:"right",right:"left",top:"bottom",bottom:"top"}[a]}var m,n;m={template:d,controller:["$scope",function(a){a.position||(a.position="right");var b=new g(a.args.effectiveProperties,a.args.model.app),c=new f(a.args.model);a.alternativeItemClicked=function(d,e,f){d.stopPropagation(),b.updateAlternativeItem(e,f,a.definition.items[f.ref].ref,a.definition.items[f.ref].alternativeRef,[{path:"qDef",property:"series"}]),c.saveSoftProperties(a.args.prevEffectiveProperties,a.args.effectiveProperties),a.closePopover()}}],scope:{alignTo:"=",position:"=",args:"=",definition:"=",item:"=",type:"=",closePopover:"=",qvaOutsideIgnoreFor:"=",options:"="}},a.directive("qvaDropdownDataTitle",[function(){return{replace:!0,template:c,restrict:"E",scope:{model:"=",type:"=",data:"=",disabled:"=",dock:"=",options:"="},link:function(c,d){var f=a.getService("$cacheFactory"),o=f.get("em-object"),p={},q=c.model,r=new g(null,q.app);c.closePopover=function(){c.isMenuOpen&&(c.isMenuOpen=!1,n&&(n.close(),n=null))},c.openAlternativePopover=function(){var b=l(c.dock);if(!c.disabled){if(c.isMenuOpen)return void c.closePopover();c.isMenuOpen=!0,n=a.getService("luiPopover").show({template:m.template,controller:m.controller,input:c.popoverSettings,alignTo:d[0],dock:b,variant:"inverse",closeOnOutside:!0,closeOnEscape:!0,outsideIgnore:"dataTitle-"+c.$id}),n.closed.then(function(){c.isMenuOpen=!1})}},c.refreshItems=function(){i.all({effectiveProperties:q.getEffectiveProperties(),properties:q.getProperties().then(function(a){return a.qExtendsId?j.get(a.qExtendsId).then(function(a){return a.getProperties()}):a}),layout:q.getLayout()}).then(function(a){c.destroyed||(p.args={layout:a.layout,model:q,properties:a.properties,effectiveProperties:b.extend(!0,{},a.effectiveProperties),prevEffectiveProperties:b.extend(!0,{},a.effectiveProperties),cache:o},p.data=a.effectiveProperties,p.definition=e.data,p.item=c.getAlternativeItem(p),c.popoverSettings={args:p.args,item:p.item,type:p.type,definition:p.definition,closePopover:c.closePopover,qvaOutsideIgnoreFor:"dataTitle-"+c.$id,options:c.options},c.isMenuOpen&&c.closePopover())})},c.refreshItems(),c.$on("datachanged",function(){c.refreshItems()}),c.getAlternativeItem=function(a){var b,d,e,f,g,i=c.data.index;if("dimension"===c.type?(g=a.data.qHyperCubeDef.qDimensions[i],f=r.getDimensionOptions,e="dimensions"):(g=a.data.qHyperCubeDef.qMeasures[i],f=r.getMeasureOptions,e="measures"),g)return b=h.getValue(a.data,a.definition.items[e].alternativeRef,[]),d=h.getValue(a.data,a.definition.items[e].ref,[]),b=f.call(r,d,b,g,a.args.layout,!0),{alternatives:b,index:isNaN(c.data.index)?0:c.data.index,data:g}},k.on("end",c.closePopover),c.$on("$destroy",function(){k.off("end",c.closePopover),c.destroyed=!0,c.closePopover()})}}}])}),define("text!objects.views/charts/components/data-title/breadcrumb-bar/breadcrumb-bar.ng.html",[],function(){return'<div class="qv-breadcrumb">\n\t<div class="qv-breadcrumb-container">\n\t\t<span class="icon-dimension-drilldown" title="{{drillDownTooltip}}"></span>\n\t\t\t<span class="crumb-item" ng-repeat="label in data.labels track by $index">\n\n\t\t\t\t<div ng-style="getCrumbStyle(hoverIndex === $index, $last, disabled)"\n\t\t\t\t\t ng-mouseover="hoverIndex = $index"\n\t\t\t\t\t ng-mouseout="hoverIndex = -1"\n\t\t\t\t\t ng-class="{\'crumb-button\' : !$last, \'disabled\' : disabled}"\n\t\t\t\t\t qva-activate="onClick($event, $index, $last)">\n\n\t\t\t\t\t<div ng-if="!$last" class="chart-data-title" >\n\t\t\t\t\t\t<span qva-direction x-dir-text="{{label}}" class="chart-data-title-label" title="{{label}}">{{label}}</span>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<qva-default-data-title ng-if="$last" data="data" model="model" disabled="disabled" type="type" direction="direction" dock="dock" options="options"></qva-default-data-title>\n\n\t\t\t\t\t<span class="lui-icon lui-icon--triangle-left" ng-if="!$last"></span>\n\t\t\t\t\t<span class="lui-icon lui-icon--triangle-right" ng-if="!$last"></span>\n\t\t\t\t</div>\n\t\t\t</span>\n\t</div>\n</div>'}),define("objects.views/charts/components/data-title/breadcrumb-bar/breadcrumb-bar",["qvangular","general.utils/color","text!./breadcrumb-bar.ng.html","objects.views/charts/chart-style-service","core.utils/feature-flags","client.utils/theme/theme-module","translator","touche"],function(a,b,c,d,e,f,g){function h(a){var c,d,f;if(e.THEMING){var g=i.initializeService("object."+(a.options.parentType||""));c=g.getStyle("","backgroundColor");var h=g.getStyle("axis.title","color"),l=g.getStyle("axis.title.disabled","color");k.crumbColor={color:h},k.crumbButtonColor={color:l},k.crumbButtonHoverColor={color:h},k.crumbButtonLockedColor={color:h},k.crumbButtonDisabledColor={color:l}}else c=j.getValue("",null,"backgroundColor","#ffffff"),k.crumbColor={color:j.getValue("","axis.title","color")},k.crumbButtonColor={color:j.getValue("","axis.title","color","inactive")},k.crumbButtonHoverColor={color:j.getValue("","axis.title","color","active")},k.crumbButtonLockedColor={color:j.getValue("","axis.title","color","locked")},k.crumbButtonDisabledColor={color:j.getValue("","axis.title","color","disabled")};d=b.toRGBA(c,0),f=b.toRGBA(c,1),a.faderStyle={background:"linear-gradient(to right, "+f+", "+d+")"}}var i=f.get(),j=d.getInstance(),k={};a.directive("qvaBreadcrumbBar",function(){return{template:c,restrict:"E",replace:!0,scope:{data:"=",type:"=?",model:"=?",disabled:"=?",dock:"=?",columnIndex:"=",options:"="},link:function(a,b){a.hoverIndex=-1,a.height=b.width(),a.singleLabelMode=!0,a.onClick=function(b,c,d){a.disabled||d||(a.$emit("drill-up",a.columnIndex,c),b.stopImmediatePropagation())},a.drillDownTooltip=g.get("Tooltip.dimensions.drilldown"),a.getCrumbStyle=function(a,b,c){return c?k.crumbButtonDisabledColor:b?{}:a?k.crumbButtonHoverColor:k.crumbButtonColor},h(a)}}})}),define("objects.views/charts/components/data-title/data-title",["qvangular","translator","objects.views/charts/components/chart-component-angular","objects.views/charts/utils/canvas-renderer","objects.views/charts/components/data-title/data-title-handler","text!./data-title.ng.html","text!./default-data-title.ng.html","text!./simple-data-title.ng.html","objects.views/charts/chart-style-service","core.utils/feature-flags","client.utils/theme/theme-module","objects.views/charts/components/data-title/dropdown-data-title/dropdown-data-title","objects.views/charts/components/data-title/breadcrumb-bar/breadcrumb-bar"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function l(a){this.relevantSize=this._titleFontHeight+o+(a?this._extraSizeWhenAlternatives:0)}function m(a,b){return"normal "+parseInt(a)*b+"px 'QlikView Sans'"}function n(){var a=q.layoutMap[this._layoutMode]||"medium";if(j.THEMING){this._innerScope.options.parentType=this.options.parentType;var b=p.initializeService("object."+this.options.parentType);this._innerScope.fontStyle.font=m(b.scaleFontSize(b.getStyle("axis.title","fontSize"),this._layoutMode),this._innerScope.fontScale),this._innerScope.fontStyle.color=b.getStyle("axis.title","color"),this._titleFontHeight=d.getFontHeight("normal "+b.scaleFontSize(b.getStyle("axis.title","fontSize"),this._layoutMode)+" 'QlikView Sans'")}else this._innerScope.fontStyle.font=q.getFont("","axis.title",a,null,null,this._innerScope.fontScale),this._titleFontHeight=d.getFontHeight(q.getFont("","axis.title",a,null,null))}var o=3,p=k.get(),q=i.getInstance();return a.directive("qvaSimpleDataTitle",[function(){return{replace:!0,template:h,restrict:"E",scope:{label:"=",locked:"=?",options:"="},link:function(a){a.lockedTooltip=b.get("Tooltip.selections.locked")}}}]),a.directive("qvaDefaultDataTitle",[function(){return{replace:!0,template:g,restrict:"E",scope:{data:"=",type:"=?",model:"=?",disabled:"=?",dock:"=?",options:"="}}}]),c.extend("DataTitle",{init:function(){var a=Array.prototype.slice.call(arguments),b=this;a.push(f),this._super.apply(this,a),this._showTitle=!0,this._innerScope.fontScale=1,this._currentDrillDownLevels=[],this._innerScope.disabled=!0,this._selectionsEnabled=!0,this._innerScope.fontStyle={font:"12px 'QlikView Sans'"},n.call(this),this._extraSizeWhenAlternatives=10,this.drillUpRef=this._innerScope.$on("drill-up",function(a,c,d){b._currentDrillDownLevels[c]-d>0&&b.fire("drill-up",[a,c,b._currentDrillDownLevels[c]-d])})},calculateRelevantSize:function(){this._super(),n.call(this),l.call(this,this._hasAlternatives)},setShowStrategy:function(a){this._showTitle=["all","title"].contains(a)},setDock:function(a){this._super(a),this._innerScope.direction="right"===a?"top-to-bottom":"left"===a?"bottom-to-top":"",this._innerScope.dock=a},setType:function(a){this._innerScope.type=a},setModel:function(a){this._innerScope.model=a},setSelectionsEnabled:function(a){this._selectionsEnabled=a,this._changed=!0,this.invalidateProperties("dataTitle.setSelectionsEnabled")},setData:function(a){if(this._super(a),a){var b=this;return e.modelHasAlternatives(this._innerScope.model,this._innerScope.type).then(function(a){return b._hasAlternatives=a,b._changed=!0,b.invalidateProperties("dataTitle.setData")})}},_updateProperties:function(){if(this._super(),this._changed&&this._data){var a=this._data;if(a.qHyperCube&&this._innerScope.type&&(a=e.getTitleDataFromHyperCube(a.qHyperCube,this._innerScope.type,this._selectionsEnabled),this._currentDrillDownLevels=a.map(function(a){return a.currentDrillDownLevels})),!this._innerScope)return;a.forEach(function(a){a.hasAlternatives=this._hasAlternatives},this),this._innerScope.titles=a,this._innerScope.$broadcast("datachanged"),e.setWrapperStyle(this._innerScope.fontStyle,this._innerContainer,this._innerScope.direction,this._innerScope.titles)}this._changed=!1},isVisible:function(){return this._super.apply(this,arguments)&&this._showTitle},on:function(){this._innerScope.disabled=!1},off:function(){this._innerScope.disabled=!0},paint:function(){this._innerScope.visible=!0,this._innerScope.fontScale=this.chartScale,n.call(this),this._innerScope.$digest(),e.setWrapperStyle(this._innerScope.fontStyle,this._innerContainer,this._innerScope.direction,this._innerScope.titles)},release:function(){this._super(),this.drillUpRef()},clear:function(){this._super(),this._innerScope.visible=!1}})}),define("objects.views/charts/components/grid",["./chart-component","objects.views/charts/utils/canvas-renderer","objects.views/charts/chart-style-service","client.utils/theme/modern/theme","core.utils/feature-flags"],function(a,b,c,d,e){function f(a,b,c,d,e,f,g){var h,i,j,k;return g?(h=0,i=d,j=a,k=a):(h=a,i=a,j=0,k=e),{type:"line",opacity:c,strokeWidth:f,shape:{x1:h,x2:i,y1:j,y2:k},stroke:b}}function g(a,b){var c,d,e,g,h=a.ticks,i=a.minorTicks,k=h?h.length:0,l=i?i.length:0,m=a.getSpacingMode()===j.DENSE||a.isDimension,n=a.getSpacingMode()===j.SPARSE?2:1,o=b.rect.height,p=b.rect.width,q=b.style,r=[];if(a.getSpacingMode()===j.NONE||!h)return[];for(g=0;g<k;g+=1)d=h[g].position,c=h[g].value,e=h[g].opacity,g%n!=0&&0!==c||(0===c?r.push(f(d,q.zero.color,e,p,o,q.zero.width,a.isVertical())):r.push(f(d,q.major.color,e,p,o,q.major.width,a.isVertical())));if(m&&i)for(g=0;g<l;g+=1)d=i[g].position,r.push(f(d,q.minor.color,1,p,o,q.minor.width,a.isVertical()));return r}function h(a,b){var c,d;return e.THEMING?d={ticks:{major:{color:a.getStyle("line.major","color")},minor:{color:a.getStyle("line.minor","color")},zero:{color:a.getStyle("line.highContrast","color")}}}:(c=a.layoutMap[b]||"medium",d={ticks:{major:{color:a.getValue("","axis.grid.major","color",c),width:a.getValue("","axis.grid.major","width",c)},minor:{color:a.getValue("","axis.grid.minor","color",c),width:a.getValue("","axis.grid.major","width",c)},zero:{color:a.getValue("","axis.grid.zero","color",c),width:a.getValue("","axis.grid.major","width",c)}}}),d}function i(){this.invalidateDisplay("Grid.setAxes")}var j={NONE:0,SPARSE:1,NORMAL:1,DENSE:3};return a.extend("Grid",{init:function(){this._super.apply(this,Array.prototype.slice.call(arguments)),this._styleService=e.THEMING?d.initializeService("object.grid"):c.getInstance(),this._renderer=new b(this.container),this._renderer.edgeBleed={top:1,left:1,bottom:0,right:0},this._$renderAreaWrap.addClass("qv-chart-component-grid"),this.renderers={gridlines:this._renderer}},afterRenderLines:function(){},setAxes:function(a,b){this._primaryHorizontalAxis!==a&&(this._primaryHorizontalAxis&&this._primaryHorizontalAxis.stopListen("changed",i,this),this._primaryHorizontalAxis=a,this._primaryHorizontalAxis&&this._primaryHorizontalAxis.listen("changed",i,this)),this._primaryVerticalAxis!==b&&(this._primaryVerticalAxis&&this._primaryVerticalAxis.stopListen("changed",i,this),this._primaryVerticalAxis=b,this._primaryVerticalAxis&&this._primaryVerticalAxis.listen("changed",i,this))},hasValidData:function(){return this._super()&&(this._primaryVerticalAxis||this._primaryHorizontalAxis)},paint:function(a,b){this._super(a,b);var c=[];return this._style=h(this._styleService,this._layoutMode),this._primaryVerticalAxis&&(this._primaryVerticalAxis.updateNow(),c=g(this._primaryVerticalAxis,{rect:this.rect,style:this._style.ticks})),this._primaryHorizontalAxis&&(this._primaryHorizontalAxis.updateNow(),c=c.concat(g(this._primaryHorizontalAxis,{rect:this.rect,style:this._style.ticks}))),this.afterRenderLines(c),this._renderer.shapes=c,this._renderer.render(),this},release:function(){this._super(),this._styleService=null,this._primaryHorizontalAxis&&this._primaryHorizontalAxis.stopListen("changed",null,this),this._primaryVerticalAxis&&this._primaryVerticalAxis.stopListen("changed",null,this)}})}),define("objects.views/charts/axis-chart",["jquery","objects.views/charts/chart","objects.views/charts/components/chart-component","objects.views/charts/components/ref-lines","objects.views/charts/components/axis/continuous-axis","objects.views/charts/components/data-title/data-title","objects.views/charts/components/grid"],function(a,b,c,d,e,f,g){"use strict";return b.extend({init:function(b,h,i,j,k){var l=a.extend(!0,{components:{grid:{show:!0,dock:"center",showFlag:c.prototype.ShowFlags.XSMALL,clazz:g},refLines:{clazz:d},colorLegend:{show:!0,order:4,reductionOrder:1,dock:"right",relevantSize:126,showFlag:c.prototype.ShowFlags.MEDIUM},xAxis:{show:!0,order:1,dock:"bottom",relevantSize:120,showFlag:c.prototype.ShowFlags.XSMALL,clazz:e},yAxis:{show:!0,order:1,dock:"left",relevantSize:90,reductionOrder:2,showFlag:c.prototype.ShowFlags.XSMALL,clazz:e},yAxisTitle:{show:!0,order:1.1,dock:"left",relevantSize:30,reductionOrder:1,showFlag:c.prototype.ShowFlags.SMALL,clazz:f},xAxisTitle:{show:!0,order:1.1,dock:"bottom",relevantSize:30,reductionOrder:1,showFlag:c.prototype.ShowFlags.SMALL,clazz:f}}},i||{});this._super(b,h,l,j,k)},getVerticalComponents:function(){var a=this._super();return this._data&&this.components&&(this.components.xAxis&&this.components.xAxis.isVertical()&&this._data.xAxis&&(a.push({comp:this.components.xAxis,dock:this._data.xAxis.dock}),this.components.xAxisTitle&&a.push({comp:this.components.xAxisTitle,
dock:this._data.xAxis.dock})),this.components.yAxis&&this.components.yAxis.isVertical()&&this._data.yAxis&&(a.push({comp:this.components.yAxis,dock:this._data.yAxis.dock}),this.components.yAxisTitle&&a.push({comp:this.components.yAxisTitle,dock:this._data.yAxis.dock}))),a},_updateData:function(a,b){this._super.apply(this,[].slice.call(arguments)),this.updateDataArea(a,b),this.updateAxis(a,b),this.updateGrid(a,b),this.updateRefLines(a,b),this.updateVerticalComponentsDock()},updateDataArea:function(a,b){var c,d;for(c in b.axes)d=b.axes[c],d.component.setDataIndices(d.dataIndices||[d.dataIndex||0]),d.component.setCurrentDataIndices(d.currentDataIndices||d.dataIndices||[d.dataIndex||0])},setAxisDataRange:function(a,b,c,d,e,f){var g,h;null!==d&&null!==e||null===d&&null===e?(g=c,h=b):null!==d&&d<=c?(g=d-f,h=b):null!==e&&e>=b?(g=c,h=e+f):(g=c,h=b),a.setDataRange(g,h),this.components.miniChart&&this.components.miniChart.components.measureAxis.setDataRange(g,h)},updateAxis:function(a,b){var c,d,e,f=b.axes,g=this.components.miniChart;for(c in b.axes)d=f[c],d.component.setTitle(d.title),d.component.setShowStrategy(d.data.show),d.component.setLabelMode(d.data.label),d.component.setLockedInfo&&d.component.setLockedInfo(a.qHyperCube.qDimensionInfo.map(function(a){return a.qLocked===!0})),d.component.setPlotMin&&!d.component.isDimension&&(e=this.getAxisOptions(d),d.component.setPlotMin(e.min),d.component.setPlotMax(e.max),d.component.setTickMultiplier(d.data.spacing),d.component.setLogScale(d.data.logarithmic),g&&(e=this.getAxisOptions(d),g.components.measureAxis.setPlotMin(e.min),g.components.measureAxis.setPlotMax(e.max))),d.component.isVertical()?d.component.setDock("far"===d.data.dock?"right":"left"):d.component.setDock("far"===d.data.dock?"top":"bottom");for(c in b.axisTitles)d=b.axisTitles[c],d.component.setShowStrategy(d.data.show),d.component.isVertical()?d.component.setDock("far"===d.data.dock?"right":"left"):d.component.setDock("far"===d.data.dock?"top":"bottom")},getAxisOptions:function(a){if(a&&a.data)return a.data.autoMinMax?{min:null,max:null}:{min:["min","minMax"].contains(a.data.minMax)?Number(a.data.min):null,max:["max","minMax"].contains(a.data.minMax)?Number(a.data.max):null}},updateGrid:function(a,b){if(this.components.grid){var c,d;if(a.gridLine&&"number"==typeof a.gridLine.spacing){d=a.gridLine.auto?2:a.gridLine.spacing;for(c in b.axes)b.axes[c].component.setSpacingMode&&b.axes[c].component.setSpacingMode(d)}}},updateRefLines:function(a,b){var c,d=b.refLineLabels,e=[],f=[];for(c in d)d[c].component&&(d[c].component.setData(d[c].data),d[c].component.setAxis(d[c].axis),d[c].component.setDock(d[c].axis.getOppositeDock()),f.push(d[c].axis),e.push(d[c].data));b.refLines&&b.refLines.component&&(b.refLines.component.setAxes(f),b.refLines.component.setData(e))}})}),define("objects.views/charts/utils/time-scale-utils",[],function(){return{dateToQlikTimestamp:function(a){return a.getTime()/1e3/86400-a.getTimezoneOffset()/60/24+25569},getUnixDate:function(a){return new Date(1899,11,30+a)},calculateTicks:function(a,b,c,d,e,f){var g,h,i=this.getUnixDate(b),j=i.getFullYear(),k=i.getMonth(),l=i.getDate(),m=c-b,n=d-c,o=a/n,p=o/1440,q=o/86400,r=366*o,s=3*o*30,t=e.second/q,u=e.minute/p,v=e.date/s,w=e.year/r,x=0,y=0,z=null,A=null,B=null,C=null,D=null,E=null,F={plotMin:c,plotMax:d,tickMin:0,tickMax:0,mainTickValues:[],mainDates:[],secondaryTickValues:[],secondaryDates:[]};for(t<1?(z=1,y=1/86400):t<2?(z=2,y=1/86400*2):t<5?(z=5,y=1/86400*5):t<10?(z=10,y=1/86400*10):t<30?(z=30,y=1/86400*30):u<1?(A=1,y=1/1440):u<2?(A=2,y=1/1440*2):u<5?(A=5,y=1/1440*5):u<10?(A=10,y=1/1440*10):u<30?(A=30,y=1/1440*30):u<60?(B=1,y=1/24):u<120?(B=2,y=2/24):u<360?(B=6,y=.25):u<720?(B=12,y=.5):v<1/90?y=C=1:v<2/90?y=C=2:v<7/90?y=C=7:v<31/90?(D=1,y=31):v<1?(D=3,y=90):w<1?(E=1,y=366):w<2?(E=2,y=732):w<5?(E=5,y=1826.25):(E=10,y=3652.5),h=Math.floor((m+b%1)/y);x<d;){g=E?new Date(j+h*E,0,1):D?new Date(j,k+h*D,1):C?new Date(j,k,l+h*C):B?new Date(j,k,l,0+h*B):A?new Date(j,k,l,0,0+h*A):new Date(j,k,l,0,0,0+h*z),x=this.dateToQlikTimestamp(g),F.secondaryDates.push(g),F.secondaryTickValues.push(x);var G=Math.floor(x);f||E||D||C||F.mainTickValues[F.mainTickValues.length-1]===G||(F.mainDates.push(this.getUnixDate(G)),F.mainTickValues.push(G)),h++}return F.tickSpacing=y,F.tickMinValue=F.secondaryTickValues[0],F.tickMaxValue=F.secondaryTickValues[F.secondaryTickValues.length-1],F}}}),define("objects.views/charts/components/axis/time-scale",["./linear-scale","../../utils/time-scale-utils"],function(a,b){"use strict";return a.extend("TimeScale",{init:function(){this._super.apply(this,arguments),this.mainDates=[],this.secondaryDates=[]},calculateTicks:function(a,c){var d,e,f,g,h;e=isNaN(this._realDataMin)?this._dataMin:this._realDataMin,d=b.calculateTicks(this._calculationSize,e,this._explicitPlotMin,this._explicitPlotMax,a,c),this._mergeResult(d),0!==this.secondaryValues.length||isNaN(this.plotMin)||(this.secondaryValues=[this.plotMin],this.secondaryDates=[b.getUnixDate(this.plotMin)]),0===this._tickSpacing&&(this._tickSpacing=1),this._showExplicitMinMax&&(g=this.secondaryValues[0],h=this.secondaryDates[0],this.secondaryValues[0]=d.plotMin,this.secondaryDates[0]=b.getUnixDate(d.plotMin),g-d.plotMin>=d.tickSpacing/2&&(this.secondaryValues.splice(1,0,g),this.secondaryDates.splice(1,0,h)),f=d.mainTickValues[d.mainTickValues.length-1],d.plotMax-f<=d.tickSpacing/2?(this.secondaryValues[d.mainTickValues.length-1]=d.plotMax,this.secondaryDates[d.secondaryDates.length-1]=b.getUnixDate(d.plotMax)):(this.secondaryValues.push(d.plotMax),this.secondaryDates.push(b.getUnixDate(d.plotMax))))},_mergeResult:function(a){this._tickSpacing=a.tickSpacing,this.plotMin=a.plotMin,this.plotMax=a.plotMax,this.plotRange=this.plotMax-this.plotMin,this.tickMin=a.tickMinValue,this.tickMax=a.tickMaxValue,this.mainValues=a.mainTickValues,this.mainDates=a.mainDates,this.secondaryValues=a.secondaryTickValues,this.secondaryDates=a.secondaryDates},getValues:function(){return{mainValues:this.mainValues,mainDates:this.mainDates,secondaryValues:this.secondaryValues,secondaryDates:this.secondaryDates}}})}),define("objects.views/charts/components/axis/time-axis",["./continuous-axis","./time-scale","util","./axis-utils"],function(a,b,c,d){"use strict";function e(){var a,b=this._scale.getValues(),c=b.secondaryValues,d=b.secondaryDates,e=[];for(a=0;a<c.length;a++)e.push({position:0,value:c[a],opacity:1,label:c[a]});var f=this._getLabels(e,!0);f.labelsBetweenTicks=!0,f.align=this.yMirrorMode?"right":"left",f.dates=d,this._levels.splice(1),this._levels.unshift(f)}function f(a,b,c,d){for(var e=c.length*d,f=0,g=a._formatter,h=a._renderer,i=a._style.label.font,j=0;j<c.length;j++)if(b[j]<n?f++:b[j]<o&&g&&h.getTextWidth(g.formatValue(c[j]),i)>b[j]-2*a._labelPadding&&f++,f>e)return!1;return!0}function g(a,b){var c;for(c=0;c<a.length;++c){var e=a[c];if(f(b,e.widths,e.labels,.1))break;if(f(b,e.widths.map(function(a){return 1.1*a}),e.labels,.1)){++c;break}}if(b.indicators=c>0&&c<a.length?a[c-1]:null,b.indicators){var g=d.getAvgTickWidth(b.indicators.positions)||b._plotSize,h=d.getAvgTickWidth(a[c].positions)||b._plotSize;g<p||h<q?b.indicators=null:b._snapTicksAvgWidth=g}return a.slice(c,c+2)}function h(a,b){var c=a.map(function(a){var c,e,f=a.qTicks,g=[],h=[],i=[],j=[],k=[],l=[],n=!0;return f.forEach(function(a){c=a.qStart,g.push(c),j.push(b.isLabelSelected(a.qStart,a.qEnd)?1:b._globalAlpha),k.push(a.qText),l.push(a.qualifiedText),e=b.getPositionOfValue(c),h.push(Math.abs(e-b.getPositionOfValue(a.qEnd))),e=d.roundToHalf(e),i.push(e),a.qStart!==a.qEnd-1&&(n=!1)}),f.length>0&&(c=f[f.length-1].qEnd,g.push(c),e=b.getPositionOfValue(c),e=d.roundToHalf(e),i.push(e)),{align:b.yMirrorMode?"right":"left",labelsBetweenTicks:!0,values:g,widths:h,positions:i,opacities:j,labels:k,qualifiedLabels:l[0]?l:null,labelMode:m,labelSpace:b._wantedLabelSpacePerLevel,dayLevel:n,rangeLabels:!0,explicitLabels:!0}});return c=g(c,b)}function i(a){var b,c,d,e,f=[];for(b=0;b<a.length;b++)for(d=a[b].qTicks,c=0;c<a.length;c++)e=a[c].qTicks,b!==c&&d[0]&&e[0]&&"string"!=typeof d[0].qualifiedText&&"string"!=typeof e[0].qualifiedText&&d.length===e.length&&d.every(function(a,b){return a.qStart===e[b].qStart&&a.qEnd===e[b].qEnd})&&(a[b].qTags.contains("$qualified")?(e.forEach(function(a,b){a.qualifiedText=d[b].qText}),f.push(b)):(d.forEach(function(a,b){a.qualifiedText=e[b].qText}),f.push(c)));f.sort(function(a,b){return b-a}),f.forEach(function(b){a.splice(b,1)})}function j(){for(var a=0;a<this._levels.length;++a)for(var b=this._levels[a],c=0;c<b.values.length;++c){var e=b.values[c],f=this.getPositionOfValue(e);if(b.positions[c]=d.roundToHalf(f),c<b.values.length-1){var g=this.isLabelSelected(e,b.values[c+1]);b.opacities[c]=g?1:this._globalAlpha}}}function k(){this._formatter.localeInfo&&(this._levelFormattingPatterns=[],this._labelGranularity===r.YEAR?this._levelFormattingPatterns.push("YYYY"):this._labelGranularity===r.DATE?this._levelFormattingPatterns.push(this._formatter.localeInfo.qDateFmt):this._labelGranularity===r.MINUTE?this._levelFormattingPatterns.push(this._timeformatPatterns.minuteLevel):this._labelGranularity===r.SECOND&&this._levelFormattingPatterns.push(this._timeformatPatterns.secondLevel),this._levelFormattingPatterns.push(this._formatter.localeInfo.qDateFmt))}function l(a,b){var c=b/a,d=3*c*30,e=c/2;c/24/60/2>this._approxLabelWidths.second?this._labelGranularity=r.SECOND:e>this._approxLabelWidths.minute?this._labelGranularity=r.MINUTE:d>this._approxLabelWidths.date?this._labelGranularity=r.DATE:this._labelGranularity=r.YEAR}var m=1,n=30,o=150,p=5,q=80,r={YEAR:1,DATE:2,MINUTE:3,SECOND:4};return a.extend("TimeAxis",{init:function(){this._super.apply(this,[].slice.call(arguments)),this._approxLabelWidths={year:60,date:60,minute:60,second:60},this._levelFormattingPatterns=["YYYY","YYYY-mm-yy"],this._labelGranularity=r.YEAR,this._timeformatPatterns={minuteLevel:"hh:mm",secondLevel:"hh:mm:ss"}},_initScales:function(){this._scale=new b},_generateExplicitLabels:function(){var a=!1;return this._explicitLabels.length&&(this._levels=h(this._explicitLabels,this),this._levels.length&&(this._calculationSize/(this._scaleDetails.explicitPlotMax-this._scaleDetails.explicitPlotMin)/2>this._approxLabelWidths.minute&&e.call(this),a=!0,this._levels.length>1&&(this._levels[1].qualifiedLabels&&(this._levels[1].labels=this._levels[1].qualifiedLabels),this._levels[1].outOfSyncWithLevelBelow=!this._levels[1].dayLevel&&!this._levels[1].values.every(function(a){return a<this._scale._dataMin||a>this._scale._dataMax||this._levels[0].values.indexOf(a)>-1}.bind(this))),this.ticks=d.getTicks(this._levels[0].values,this._padding,this._plotSize),this.minorTicks=[],this._levels.length>1&&(this.minorTicks=this.ticks.filter(function(a){return this._levels[1].values.indexOf(a.value)===-1},this),this.ticks=this.ticks.filter(function(a){return this._levels[1].values.indexOf(a.value)!==-1},this)))),a},calculatePreliminaryLabelSpace:function(){var a=this._super.apply(this,arguments);return a.relevantLabelSize*=2,a},calculateLabelSpace:function(){var a=this._super.apply(this,arguments);return a.relevantLabelSize*=2,a},_initLevels:function(){this.useExplicitLabels?(j.call(this),this._levels[0].formatPattern=this._levelFormattingPatterns[0]):(this._levels=[this._getLabels(this.minorTicks,!0)],this._levels[0].labelsBetweenTicks=!0,this._levels[0].align=this.yMirrorMode?"right":"left",this._levels[0].dates=this._minorTickDates,this._levels[0].formatPattern=this._levelFormattingPatterns[0],this.ticks.length&&(this._levels.push(this._getLabels(this.ticks,!0)),this._levels[1].labelsBetweenTicks=!0,this._levels[1].align=this.yMirrorMode?"right":"left",this._levels[1].dates=this._tickDates,this._levels[1].formatPattern=this._levelFormattingPatterns[1]))},_calculateScale:function(a){if(0!==a){var b,c=this._scaleDetails,d=isNaN(c.realDataMin)?c.dataMin:c.realDataMin,e=isNaN(c.realDataMax)?c.dataMax:c.realDataMax,f=isNaN(c.explicitPlotMin)||null===c.explicitPlotMin?d:c.explicitPlotMin,g=isNaN(c.explicitPlotMax)||null===c.explicitPlotMax?e:c.explicitPlotMax;b=this.isRadial()?96:Math.max(60,this._getApproximateLabelWidth(f,g,this._levelFormattingPatterns[0])+this._labelPadding);var h=this.isVertical()?4*this._fontHeight:b;h=a/(Math.max(2,a/h/c.tickMultiplier+1)-1),c.usedDataMin=d,c.usedDataMax=e,c.minTickSpacingInPixel=h,c.plotSize=this._plotSize,c.calculationSize=void 0!==a?a:this._calculationSize,c.fontHeight=this._fontHeight,c.showExplicitMinMax=!1,Object.keys(c).forEach(function(a){this._scale["_"+a]=c[a]},this),this._scale.calculateTicks(this._approxLabelWidths,"T"===this._formatter.type)}},_generateTickObjects:function(a,b){if(this.useExplicitLabels=this._generateExplicitLabels(),!this.useExplicitLabels){var c=a.getValues();this.ticks=d.getTicks(c.mainValues,this._padding,b),this.minorTicks=d.getTicks(c.secondaryValues,this._padding,b),this._tickDates=c.mainDates,this._minorTickDates=c.secondaryDates}},_updateTickFormatting:function(a,b){var c,d,e,f;for(c=0;c<a.length;c++)if(!a[c].explicitLabels)for(e=a[c].dates&&a[c].values.length!==a[c].dates.length,f=b._dateFormatter&&a[c].dates&&a[c].dates.length&&!e,d=0;d<a[c].values.length;d++)a[c].labels[d]=f?b._dateFormatter.format(a[c].dates[d],a[c].formatPattern):b.formatValue(a[c].values[d])},formatValue:function(a){if(this._discrete||!this._formatter)return a+"";var b="YYYY"===this._levels[0].formatPattern?void 0:this._levels[0].formatPattern;return this._formatter.formatValue(a,b)},setLabels:function(a){this._explicitLabels=c.extend(!0,[],a).reverse(),i(this._explicitLabels)},updateFormatter:function(){if(this._super(),this._formatter.localeInfo){var a=/t+/gi.test(this._formatter.localeInfo.qTimestampFmt);this._timeformatPatterns.minuteLevel=a?"h:mm tt":"hh:mm",this._timeformatPatterns.secondLevel=a?"h:mm:ss tt":"hh:mm:ss";this._approxLabelWidths={year:Math.max(60,this._renderer.getTextWidth(this._formatter.formatValue(41000.2343433,"YYYY"),this._style.label.font)+this._labelPadding+20),date:Math.max(60,this._renderer.getTextWidth(this._formatter.formatValue(41000.2343433,this._formatter.localeInfo.qDateFmt),this._style.label.font)+this._labelPadding+20),minute:Math.max(60,this._renderer.getTextWidth(this._formatter.formatValue(41000.2343433,this._timeformatPatterns.minuteLevel),this._style.label.font)+this._labelPadding+20),second:Math.max(60,this._renderer.getTextWidth(this._formatter.formatValue(41000.2343433,this._timeformatPatterns.secondLevel),this._style.label.font)+this._labelPadding+20)}}},_updateScaleAndTicks:function(){this._scaleDetails.calculationSize&&(l.call(this,this._scaleDetails.explicitPlotMax-this._scaleDetails.explicitPlotMin,this._scaleDetails.calculationSize),k.call(this)),this._super()}})}),define("objects.views/charts/components/scroll-area",["./chart-component","general.utils/shapes/rect","jquery","touche","general.utils/color","core.utils/feature-flags","client.utils/theme/theme-module"],function(a,b,c,d,e,f,g){function h(a){var c,d,e,f=this,g=this.isVertical(),h={size:g?"height":"width",pos:g?"y":"x",coord:g?"pageY":"pageX"},i=new b(0,0,0,0),j=f._$renderAreaWrap.offset();i.x=j.left,i.y=j.top,i.width=f._$renderAreaWrap.width(),i.height=f._$renderAreaWrap.height(),this.fire("scrollStart"),e=f.scrollRect[h.size]*i[h.size],d=a.points[0][h.pos]-i[h.pos],this.yMirrorMode&&!g&&(d=i.width-d),c=d-e/2,f.scrollRect[h.pos]=Math.max(0,Math.min(i[h.size]*(1-f.scrollRect[h.size]),c))/i[h.size],f.setOffset(f.scrollRect[h.pos]*f.fullState.max)}function i(a){var c=this,d=this.isVertical(),e={size:d?"height":"width",pos:d?"y":"x",coord:d?"pageY":"pageX"},f=this.yMirrorMode&&!d,g=c._$renderAreaWrap.offset();this._containerRect=new b(0,0,0,0),this._containerRect.x=g.left,this._containerRect.y=g.top,this._containerRect.width=c._$renderAreaWrap.width(),this._containerRect.height=c._$renderAreaWrap.height(),c.scrollRect[e.size]=c.viewState.range/c.fullState.max,this._rp=a.points[0][e.pos]-this._containerRect[e.pos]-c.scrollRect[e.pos]*this._containerRect[e.size],f&&(this._rp=c.scrollRect[e.size]*this._containerRect[e.size]-this._rp),c.startScrollPos=c.scrollRect[e.pos],c.startScrollSize=c.scrollRect[e.size],this._rp<0?(c.scrollRect[e.pos]=Math.max(0,c.scrollRect[e.pos]-this._rp/this._containerRect[e.size]),this._rp=0):this._rp/this._containerRect[e.size]>c.scrollRect[e.size]&&(c.scrollRect[e.pos]=Math.min(1,this._rp/this._containerRect[e.size])-c.scrollRect[e.size],this._rp=c.scrollRect[e.size]*this._containerRect[e.size]),this.fire("scrollStart")}function j(a){var b=this,c=this.options,d=this.isVertical(),e="function"==typeof c.onScroll?c.onScroll:function(){},f={size:d?"height":"width",pos:d?"y":"x",coord:d?"pageY":"pageX"},g=a.points[0][f.pos]-this._containerRect[f.pos],h=this.yMirrorMode&&!d;if(this.allowResize){var i=(g-this._rp)/this._containerRect[f.size]-b.startScrollPos,j=b.startScrollPos,k=j+b.startScrollSize;/start/.test(a.relatedTarget.className)?(a.relatedTarget.classList.add("active"),j=Math.max(0,Math.min(k-1e-5,j+i))):/end/.test(a.relatedTarget.className)?(a.relatedTarget.classList.add("active"),k=Math.min(1,Math.max(j+1e-5,k+i))):(j=Math.min(1-b.startScrollSize,Math.max(0,j+i)),k=Math.min(1,Math.max(0+b.startScrollSize,k+i))),b.setViewRange((k-j)*b.fullState.max),h?b.setOffset((1-k)*b.fullState.max):b.setOffset(j*b.fullState.max),b.fire("offsetChanged")}else h&&(g=this.rect.width-g),b.scrollRect[f.pos]=Math.max(0,Math.min(this._containerRect[f.size]*(1-b.scrollRect[f.size]),g-this._rp))/this._containerRect[f.size],b.setOffset(b.scrollRect[f.pos]*b.fullState.max);e()}function k(){if(this.miniChart){var a=this;d(this.miniChart.container).tap({id:q,end:function(b,c){h.call(a,c)}}),d(this.miniChart.container).swipe({id:q,options:{radiusThreshold:1},start:function(b,c){i.call(a,c)},update:function(b,c){j.call(a,c)},end:function(a,b){b.relatedTarget.classList.remove("active")}})}}function l(){this.miniChart&&(c(this.miniChart.container).off(q),d(this.miniChart.container).off("*",q))}function m(){this.miniChart&&(this._internalUseMiniChart?this.miniChart.showComponent():this.miniChart.hideComponent())}function n(a,b){var c=this.viewState.min,d=this._relativeOffset?this._explicitOffset*(this.fullState.max-this.viewState.range):this._explicitOffset||0;this.viewState.min=Math.max(0,Math.min(d||0,(this.fullState.max||0)-(this.viewState.range||0))),this.viewState.min!==c&&(this.invalidateDisplay(a),b&&this.fire("offsetChanged"))}function o(a,b,c){(Array.isArray(a)?a:[a]).forEach(function(a){c.forEach(function(b){a.style[b]=""}),a.className=b})}var p,q=".scrollarea",r=g.get();return p=a.extend("ScrollArea",{init:function(){this._super.apply(this,Array.prototype.slice.call(arguments)),this._useMiniChart=!0,this._internalUseMiniChart=!0,this._miniChartThreshold=.5,this._miniChartMinimunNumberOfBars=3,this.scrollRect=new b(0,0,0,0),this.fullState={min:0,max:20},this.viewState={min:0,range:10},this.allowResize=!1,this._$renderAreaWrap.addClass("qv-chart-component-scroll-area"),this.before=document.createElement("div"),this.bar=document.createElement("div"),this.after=document.createElement("div"),this.before.style.position="absolute",this.bar.style.position="absolute",this.after.style.position="absolute",this.before.style.backgroundColor=this.after.style.backgroundColor="rgba(0,0,0,0.1)",this.bar.style.marginTop="-1px",c(this.before).attr("tid","component.scrollArea.before"),c(this.bar).attr("tid","component.scrollArea.bar"),c(this.after).attr("tid","component.scrollArea.after"),c(this.bar).append('<div class="q-resize-handle q-resize-handle-start">'),c(this.bar).append('<div class="q-resize-handle q-resize-handle-end">'),this.container.appendChild(this.before),this.container.appendChild(this.after),this.container.appendChild(this.bar),f.THEMING&&(this._styleService=r.initializeService("object."+this.options.parentType),this.before.style.backgroundColor=this.after.style.backgroundColor=this._styleService.getStyle("","color"),this.before.style.opacity=this.after.style.opacity=.1)},on:function(){var a=this;this._super(),d(this.container).tap({id:q,end:function(b,c){h.call(a,c)}}),d(this.container).swipe({id:q,options:{radiusThreshold:1},start:function(b,c){i.call(a,c)},update:function(b,c){j.call(a,c)},end:function(a,b){b.relatedTarget.classList.remove("active")}}),k.call(this),this._on&&this.allowResize&&this.container.classList.add("q-allow-resize")},off:function(){this._super(),c(this.container).off(q),d(this.container).off("*",q),l.call(this),this.container.classList.remove("q-allow-resize")},setAllowResize:function(a){this.allowResize=a,this.container.classList[a&&this._on?"add":"remove"]("q-allow-resize")},calculateRelevantSize:function(){var a,b=d.utils.touch?32:16;this.miniChart&&this._useMiniChart&&(this.miniChart.calculateRelevantSize(),a=this.miniChart.relevantSize,this._internalUseMiniChart=!0,m.apply(this)),this.relevantSize=this._internalUseMiniChart?a||16:b},insertAdjacentTo:function(){this._super.apply(this,[].slice.apply(arguments)),this.miniChart&&this.miniChart.setRect(this.rect.x,this.rect.y,this.rect.width,this.rect.height)},setRect:function(){this._super.apply(this,[].slice.apply(arguments)),this.miniChart&&this.miniChart.setRect(this.rect.x,this.rect.y,this.rect.width,this.rect.height)},setDock:function(a){this._super(a),this.miniChart&&this.miniChart.setDock(a)},getOffset:function(){return this.viewState.min},setRelativeOffset:function(a){this._explicitOffset=a,this._relativeOffset=!0,n.call(this,"ScrollArea.setOffset",!0)},setOffset:function(a){this._explicitOffset=a,this._relativeOffset=!1,n.call(this,"ScrollArea.setOffset")},setMiniChart:function(a){this.miniChart&&l.call(this),this.miniChart=a,this.miniChart.setDock(this.options.dock),m.apply(this),this._on&&k.call(this),this.invalidateDisplay("ScrollArea.setMiniChart")},setUseMiniChart:function(a){this._useMiniChart=a,this._internalUseMiniChart=a,m.apply(this),this.invalidateDisplay("ScrollArea.setUseMiniChart")},getUseMiniChart:function(){return this._useMiniChart},setViewRange:function(a){this.viewState.range=a,n.call(this,"ScrollArea.setViewRange",!0),this.invalidateDisplay("ScrollArea.setViewRange")},getViewRange:function(){return this.viewState.range},setSpaces:function(a){this._spaces=a},setDataRange:function(a){this.dataRange=a,this.invalidateDisplay("ScrollArea.setDataRange")},getDataRange:function(){return this.dataRange},setFullRange:function(a){this.fullState.max=a,n.apply(this,["ScrollArea.setFullRange",!0]),this.invalidateDisplay("ScrollArea.setFullRange")},getFullRange:function(){return this.fullState.max},isVisible:function(a){return this._super(a)&&(this.viewState.range<this.fullState.max||this.allowResize)},setOuterRect:function(a,b,c,d){this._super(a,b,c,d),this.miniChart&&this.miniChart.setOuterRect(a,b,c,d)},setLayoutToContainerRatios:function(a,b){this._super(a,b),this.miniChart&&this.miniChart.setLayoutToContainerRatios(a,b)},setContainerRect:function(a,b,c,d){this._super(a,b,c,d),this.miniChart&&this.miniChart.setContainerRect(a,b,c,d)},updateSize:function(){this._super();var a="#000000";f.THEMING&&(a=this._styleService.getStyle("","color")),this.miniChart&&this._internalUseMiniChart&&this.miniChart.isVisible()?(this.before.style.display="block",this.bar.style.border="1px solid "+e.toRGBA(a,.4),this.bar.style.backgroundColor="transparent",this.after.style.display="block",this.isVertical()?o.apply(this,[[this.before,this.bar,this.after],"qv-chart-scrollable-mini-chart-vertical",["width","left"]]):(o.apply(this,[[this.before,this.after],"qv-chart-scrollable-mini-chart-horizontal",["height","top"]]),o.apply(this,[this.bar,"qv-chart-scrollable-mini-chart-bar-horizontal",["height","top"]]))):(this.before.style.display="none",this.bar.style.backgroundColor=e.toRGBA(a,.2),this.bar.style.boxShadow="none",this.bar.style.border="none",this.after.style.display="none",this.isVertical()?o.apply(this,[this.bar,"qv-chart-scrollable-vertical",["width","left"]]):o.apply(this,[this.bar,"qv-chart-scrollable-horizontal",["height","top"]]))},paint:function(a,b){var d;f.THEMING&&(this.before.style.backgroundColor=this.after.style.backgroundColor=this._styleService.getStyle("","color"),this.before.style.opacity=this.after.style.opacity=.1),this.container.style.display="block",this._super(a,b),this.scrollRect[this.isVertical()?"height":"width"]=this.viewState.range/this.fullState.max,this.scrollRect[this.isVertical()?"y":"x"]=this.viewState.min/this.fullState.max,this.yMirrorMode&&!this.isVertical()&&(this.scrollRect.x=1-this.scrollRect.width-this.scrollRect.x),d=this.scrollRect[this.isVertical()?"height":"width"]*this.rect[this.isVertical()?"height":"width"],d=d<1?1:d,d=100*d/this.rect[this.isVertical()?"height":"width"],this.isVertical()?(c(this.before).css({height:100*this.scrollRect.y+"%",top:"0%"}),c(this.bar).css({top:100*this.scrollRect.y+"%",height:d+"%"}),c(this.after).css({top:100*this.scrollRect.y+d+"%",height:100-(100*this.scrollRect.y+d)+"%"})):(c(this.before).css({width:100*this.scrollRect.x+"%",left:"0%"}),c(this.bar).css({left:100*this.scrollRect.x+"%",width:d+"%"}),c(this.after).css({left:100*this.scrollRect.x+d+"%",width:100-(100*this.scrollRect.x+d)+"%"}))},clear:function(){this.container.style.display="none"}}),Object.defineProperty(p.prototype,"className",{value:"ScrollArea"}),p}),define("objects.views/charts/utils/label-positioner",[],function(){"use strict";return{positionRectanglesAlongAxis:function(a,b,c,d,e){function f(){var d,e,f,g,h;for(e=a[0].position,f=a[0].size,e=Math.max(c,e-f/2)+f/2,a[0].newPosition=e,d=1;d<p;d++)g=a[d-1].newPosition,h=a[d-1].size,e=a[d].position,f=a[d].size,e=Math.max(g+h/2+b,e-f/2)+f/2,a[d].newPosition=e}function g(){var e,f,g,h,i;if(f=a[p-1].newPosition,g=a[p-1].size,f+g/2>d)for(a[p-1].newPosition=d-g/2-c,e=p-2;e>=0;e--)h=a[e+1].newPosition,i=a[e+1].size,f=a[e].newPosition,g=a[e].size,f=Math.min(h-i/2-b,f+g/2)-g/2,a[e].newPosition=f}function h(){var d,e,f,g=a[0].newPosition,h=a[0].size;if(g-h/2<c)return!0;if(g-h/2>c)return!1;for(d=1;d<p;d++)if(e=a[d-1].newPosition,f=a[d-1].size,g=a[d].newPosition,h=a[d].size,e+f/2+b<g-h/2)return!1;return!0}function i(){var b,c,d,e,f,g,h,i,j,k,l,m;for(t&&t.length===r||(t=new Array(r)),b=0;b<r;b+=1)c=q[b],d=c[0],e=c[c.length-1],f=a[d],g=a[e],j=f.position,h=f.size,l=f.newPosition-h/2,k=g.position,i=g.size,m=g.newPosition+i/2,t[b]={firstPosition:j,lastPosition:k,minPosition:l,maxPosition:m}}function j(){k(0,c);for(var a=1;a<r;a++)k(a,t[a-1].maxPosition+b)}function k(a,b){q[a].length%2==0?l(a,b):m(a,b)}function l(b,c){var d,e,f,g,h,i,j,k,l,m,o,p,r;d=q[b],e=d[0],f=d[d.length/2-1],g=d[d.length/2],h=a[e],i=a[f],j=a[g],l=h.newPosition,k=h.size,o=(i.position+j.position)/2,p=(i.newPosition+j.newPosition)/2,r=p-o,m=l-r,n(b,l,m,k,c)}function m(b,c){var d,e,f,g,h,i,j,k,l,m,o;d=q[b],e=d[0],f=d[(d.length-1)/2],g=a[e],h=a[f],i=g.newPosition,j=g.size,k=h.position,l=h.newPosition,m=l-k,o=i-m,n(b,i,o,j,c)}function n(a,b,c,d,e){if(!(c>=b)){c=Math.max(e+d/2,c);var f=b-c;t[a].minPosition-=f,t[a].maxPosition-=f,o(a,f)}}function o(b,c){var d,e,f,g=q[b],h=g?g.length:0;for(d=0;d<h;d++)e=g[d],f=a[e],f.newPosition-=c}var p,q,r,s,t;p=a?a.length:0,e!==!0&&a.sort(function(a,b){return a.position>b.position?1:-1}),function(){if(0===p)return q=[],void(r=0);var c,d,e,f,g;for(q=[[0]],c=1;c<p;c++)d=a[c].position,e=a[c].size,f=a[c-1].position,g=a[c-1].size,f+g/2+b>d-e/2?q[q.length-1].push(c):q.push([c]);r=q?q.length:0}(),function(){0!==p&&(f(),g(),i(),(s=h())||j())}()}}}),define("objects.views/charts/components/ref-line-label-tooltip",["jquery","qvangular","core.utils/class","general.utils/support","general.utils/shapes/point"],function(a,b,c,d,e){"use strict";function f(a,b,c){var d=a.offset();return new e(b-d.left,c-d.top)}function g(a,b,c){var d=a.offset();return new e(d.left+b,d.top+c)}function h(a,b){return a.shapeWrapper.getBoundingRect().pointInside(b.x,b.y)}function i(a,b){return a.filter(function(a){return h(a,b)})[0]}function j(a,b){return{positions:[g(b,a.x+a.width/2,a.y),g(b,a.x+a.width,a.y+a.height/2),g(b,a.x,a.y+a.height/2),g(b,a.x+a.width/2,a.y+a.height)],directions:["top","right","left","bottom"]}}function k(){l&&(l=null)}var l,m=a(document);return c.extend("RefLineLabelTooltip",{init:function(b){this.$container=a(b)},setLabelObjects:function(a){this._labelObjects=a},on:function(){var a=this;this._onMouseMove=function(c){if(a._labelObjects){var d=f(a.$container,c.pageX,c.pageY),e=i(a._labelObjects,d);if(e&&l!==e){l=e;var g=j(e.shapeWrapper.getLocalBoundingRect(),a.$container);b.getService("qvChartTooltipService").open({content:[{rows:e.tooltipRows}],position:g.positions,direction:g.directions,hideCallback:k},7e3,500)}else e||(l=null,b.getService("qvChartTooltipService").close())}},this._onMouseLeave=function(){l=null,b.getService("qvChartTooltipService").close()},d.treatAsDesktop()&&(this.$container.on("mousemove",this._onMouseMove),this.$container.on("mouseleave",this._onMouseLeave),m.on("mouseleave.refLineLabels",this._onMouseLeave))},off:function(){this.$container.off("mousemove",this._onMouseMove),this.$container.off("mouseleave",this._onMouseLeave),m.off("mouseleave.refLineLabels",this._onMouseLeave)},release:function(){this.$container=null}})}),define("objects.views/charts/components/ref-line-labels",["./chart-component","client.utils/theme/theme-module","objects.views/charts/renderers/canvas-renderer","objects.views/charts/utils/label-positioner","objects.views/charts/chart-style-service","./ref-line-label-tooltip","objects.views/charts/shapes/text","objects.views/charts/shapes/circle","objects.views/charts/shapes/polygon","util","client.utils/rtl/rtl-util","core.utils/feature-flags"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";function m(a){a.forEach(function(a){a.size=a.shapeWrapper.measure().height})}function n(a){return Q.resolveColor(a)}function o(a,b,c,d,e,f){void 0===e&&(e=Number.MAX_VALUE),void 0===f&&(f=1);var h=new g;return h.setText(a),h.font=b,h.x=c,h.y=d,h.maxWidth=e,h.maxNumLines=f,h.align=O,h.baseline=P,h}function p(a){return void 0===a||""===a?0:(J.setText(a),J.measure().width)}function q(a){return void 0===a||""===a?0:(L.setText(a),L.measure())}function r(a){return void 0===a||""===a?0:(K.setText(a),K.measure().width)}function s(a,b){return void 0===a||""===a?{numLines:0,width:0,height:0,lines:[]}:(K.setText(a),K.maxWidth=b,K.measure())}function t(a,b){if(void 0===a||""===a)return{index:-1,width1:0,width2:0,width:0};void 0===b&&(b=p(a));for(var c,d,e,f,g=Number.MAX_VALUE,h=a.length,i=Math.floor(h/2),j=a.substring(0,i),k=0,l=!0,m=j.lastIndexOf(" ");m>-1&&l;)j=a.substring(0,m),c=p(j),d=b-c-M,e=Math.max(c,d),g<e?l=!1:(g=e,k++,f={index:m,width1:c,width2:d,width:g},m=j.lastIndexOf(" "));if(k>1)return f;for(m=a.indexOf(" ",i),k=0;m>-1;){if(j=a.substring(m+1),d=p(j),c=b-d-M,e=Math.max(c,d),g<e)return f;g=e,k++,f={index:m,width1:c,width2:d,width:g},m=a.indexOf(" ",m+1)}return void 0===f&&(f={index:-1,width1:0,width2:b,width:b}),f}function u(a,b){if(void 0===a||""===a)return{index1:-1,index2:-1,width1:0,width2:0,width3:0,width:0};void 0===b&&(b=p(a));for(var c,d,e,f,g,h,i,j=Number.MAX_VALUE,k=a.length,l=Math.floor(k/3),m=a.substring(0,l),n=0,o=!0,q=m.lastIndexOf(" ");q>-1&&o;)m=a.substring(0,q),c=a.substring(q+1),e=p(c),d=b-e-M,h=t(c,e),g=h.width,f=Math.max(d,g),j<f?o=!1:(j=f,n++,i={index1:q,index2:h.index,width1:d,width2:h.width1,width3:h.width2,width:j},q=m.lastIndexOf(" "));if(n>1)return i;for(q=a.indexOf(" ",l),n=0;q>-1;){if(c=a.substring(q+1),e=p(c),d=b-e-M,h=t(c,e),g=h.width,f=Math.max(d,g),j<f)return i;j=f,n++,i={index1:q,index2:h.index,width1:d,width2:h.width1,width3:h.width2,width:j},q=a.indexOf(" ",q+1)}return void 0===i&&(i={index1:-1,index2:-1,width1:0,width2:0,width3:b,width:b}),i}function v(a,b,c){var d;if(b<=c)return{minTextWidth:b,level:1};if(b<=2*c){if(d=t(a,b),d.width<=c)return{minTextWidth:d.width,level:0===d.width1?3:2};if(0===d.width1)return{minTextWidth:Math.ceil(d.width/2)+N,level:3}}return b<3*c?(d=u(a,b),
0===d.width1&&0===d.width2?{minTextWidth:Math.min(Math.ceil(d.width/3)+Math.ceil(3*N/2),c),level:3}:{minTextWidth:Math.min(d.width,c),level:3}):{minTextWidth:c,level:3}}function w(a,b,c,d,e){a.size=b,a.size2=c,a.numLines=d,a.level=e}function x(a,b,c){if(!(a.size/2<=b||3===a.numLines||3===a.level)){var d,e;if(2===a.numLines)return d=u(a.text,a.singleLineTextWidth),e=s(a.text,d.width),void w(a,d.width,e.height,e.numLines,3);if(d=t(a.text,a.singleLineTextWidth),0!==d.width1){if(d.width/2<=b||c===!0)return e=s(a.text,d.width),void w(a,d.width,e.height,e.numLines,2);d=u(a.text,a.singleLineTextWidth),e=s(a.text,d.width),w(a,d.width,e.height,e.numLines,3)}}}function y(a,b,c){var d,e;a.position+a.size/2+c>b.position-b.size/2&&(a.size>b.size?(d=a,e=b.position-b.size/2-c-a.position):(d=b,e=b.position-(a.position+a.size/2+c)),x(d,e,!0))}function z(a,b,c,d,e,f){a.singleLineTextWidth=b,a.size=c,a.size2=d,a.numLines=e,a.level=f}function A(a){return String(void 0!==a.label?a.label:a)}function B(a,b){var c=a,d=j.escapeRegExp("+-"+(this.chartFormatter.getLocaleInfo().qDecimalSep||"")+(this.chartFormatter.getLocaleInfo().qThousandSep||"")),e=c.replace(new RegExp("[0-9e"+d+"]","g"),"");return e=e.length?c:this._axis.format(b)}function C(a){if(this._axis&&this._data){this._axis.updateFormatter();var b,c,d,e,f,g,h,i=this._data?this._data.length:0,j=[],l=this._axis.getPlotMin(),m=this._axis.getPlotMax(),n=[],o=[],p=-Number.MAX_VALUE,q=Number.MAX_VALUE,r=0,s=0;for(this._plotMinValueForRelevantSize=l,this._plotMaxValueForRelevantSize=m,this._maxLowerLabelIndex=void 0,this._minUpperLabelIndex=void 0,b=0;b<i;b+=1)this._data[b]&&this._data[b].show&&void 0!==this._data[b].refLineExpr&&(c=A(this._data[b].refLineExpr),null===(d=a?this._currentProperties["value"+b]:this._data[b].refLineExpr.value)||isNaN(d)||(e=this._data[b].label,f=B.apply(this,[c,d]),g=" "+k.lrm+"("+f+")"+k.lrm,d<l?(r++,o.push({label:e,value:f}),p<d&&(this._maxLowerLabelIndex=b)):d>m?(s++,n.push({label:e,value:f}),q>d&&(this._minUpperLabelIndex=b)):(h=e+g,j.push({index:b,text:h,value:d,text1:e,text2:g,tooltipRows:[{label:e,value:f}]}))));s>0&&j.push({index:-1,text:s<10?s.toString():"9+",value:"max",type:1,tooltipRows:n}),r>0&&j.push({index:-2,text:r<10?r.toString():"9+",value:"min",type:-1,tooltipRows:o}),this._labelObjects=j,this._numLabelObjects=this._labelObjects?this._labelObjects.length:0,this._labelsMaxWidthNeedToUpdate=!0,this._labelsMaxHeightNeedToUpdate=!0,this._labelObjectsNeedToUpdate=!1,this._numLowerLabels=r,this._numUpperLabels=s}}function D(){if(this._labelsMaxWidthNeedToUpdate){this._labelsMaxWidthNeedToUpdate=!1;var a,b,c,d=0;for(K.maxWidth=this._labelMaxWidthForYAxis,a=0;a<this._numLabelObjects;a++)if(void 0!==this._labelObjects[a].type?(b=q(this._labelObjects[a].text),c=G(b),d=Math.max(d,c+4)):d=Math.max(d,r(this._labelObjects[a].text)+4),d>=this._labelMaxWidthForYAxis)return void(this._labelsMaxWidth=this._labelMaxWidthForYAxis);this._labelsMaxWidth=d}}function E(a){return"max"===a?Math.floor(this._axis.getPositionOfValue(this._axis.getPlotMax()))-.5+(this.isVertical()?-.1:.1):"min"===a?Math.floor(this._axis.getPositionOfValue(this._axis.getPlotMin()))-.5+(this.isVertical()?.1:-.1):Math.floor(this._axis.getPositionOfValue(a))-.5}function F(){var a,b,c;for(a=0;a<this._numLabelObjects;a+=1)b=this._labelObjects[a],c=E.call(this,b.value),b.position=c}function G(a){return Math.sqrt(a.width*a.width+a.height*a.height)}function H(){if(this._labelsMaxHeightNeedToUpdate){this._labelsMaxHeightNeedToUpdate=!1,F.call(this);var a,b,c,e=0;for(this.calculateLabelWidths(this._labelObjects,this._componentWidth,this._horizontalLabelGap,this._boundaryGap,this._labelMaxWidthForXAxis),d.positionRectanglesAlongAxis(this._labelObjects,this._horizontalLabelGap,this._boundaryGap,this._componentWidth,!0),a=0;a<this._numLabelObjects;a+=1)void 0!==this._labelObjects[a].type?(b=q(this._labelObjects[a].text),c=G(b),e=Math.max(e,c)):e=Math.max(e,this._labelObjects[a].size2);this._labelsMaxHeight=e}}function I(a,b){var c,d=a.layoutMap[b]||"medium";return c=l.THEMING?{label:{color:a.getStyle("label.name","color"),font:"normal "+a.scaleFontSize(a.getStyle("label.name","fontSize"),b,null)+" 'QlikView Sans'"},outOfBounds:{color:a.getStyle("outOfBounds","color"),backgroundColor:a.getStyle("outOfBounds","backgroundColor"),font:"normal "+a.scaleFontSize(a.getStyle("outOfBounds","fontSize"),b,null)+" 'QlikView Sans'"}}:{label:{color:a.getValue("","referenceLine.label","color"),font:a.getFont("","referenceLine.label",d)},outOfBounds:{color:a.getValue("","referenceLine.outOfBounds","color"),backgroundColor:a.getValue("","referenceLine.outOfBounds","backgroundColor"),font:a.getFont("","referenceLine.outOfBounds",d)}},J=o("",c.label.font,0,0,Number.MAX_VALUE,1),K=o("",c.label.font,0,0,Number.MAX_VALUE,3),L=o("",c.outOfBounds.font,0,0,Number.MAX_VALUE,1),M=p("m m")-p("mm"),N=p("m"),c}var J,K,L,M,N,O="center",P="bottom",Q=b.get();return a.extend("RefLineLabels",{init:function(){this._super.apply(this,arguments),this.renderer=new c(this.container),this._tooltips=new f(this.container),this._currentProperties={},this._transitionProperties={},this.renderers={labels:this.renderer},this._$renderAreaWrap.addClass("qv-chart-component-reflinelabels"),this._hasVisibleRefLines=!1,this._styleService=l.THEMING?Q.initializeService("object.referenceLine"):e.getInstance(),this._style=I(this._styleService),this._labelMargin=4,this._labelMaxWidthForYAxis=70,this._labelMaxWidthForXAxis=100,this._labelMaxHeightForXAxis=50,this._verticaLabelGap=4,this._horizontalLabelGap=6,this._boundaryGap=4},calculateRelevantSize:function(){if(this._super(),C.call(this),this.isVertical())D.call(this),this.relevantSize=this._labelsMaxWidth+this._labelMargin;else{var a=this.rect.width?this.rect.width:this._axis._plotSize;this._componentWidth!==a&&(this._componentWidth=a,this._labelsMaxHeightNeedToUpdate=!0),H.call(this),this.relevantSize=this._labelsMaxHeight+this._labelMargin}},calculatePreliminaryRelevantSize:function(){this.relevantSize=this.isVertical()?this._labelMaxWidthForYAxis:this._labelMaxHeightForXAxis},setData:function(){this._super.apply(this,arguments),this._hasVisibleRefLines=this.checkIfHavingVisibleRefLines(),this.updateLocalPlotMaxMinValues(),this._labelObjectsNeedToUpdate=!0},setAxis:function(a){var b=this;this._axis=a,this._axis.listen("changed",function(){this.invalidateDisplay()},b),this._labelObjectsNeedToUpdate=!0},isVisible:function(){return!!this._super.apply(this,arguments)&&(this._axis&&(this._plotMinValue===this._axis.getPlotMin()&&this._plotMaxValue===this._axis.getPlotMax()||(this._hasVisibleRefLines=this.checkIfHavingVisibleRefLines(),this.updateLocalPlotMaxMinValues())),this._hasVisibleRefLines)},calculateLabelWidths:function(a,b,c,d,e){var f,g,h,i,j,k,l,m=a?a.length:0;if(0!==m){for(f=0;f<m;f++)h=a[f],i=h.text,void 0===i||""===i?z(h,0,0,0,0,0):(j=p(i),k=v(i,j,e),l=s(i,k.minTextWidth),z(h,j,k.minTextWidth,l.height,l.numLines,k.level));for(a.sort(function(a,b){return a.position>b.position?1:-1}),h=a[m-1],void 0!==h.text&&""!==h.text&&x(h,b-h.position-d),h=a[0],void 0!==h.text&&""!==h.text&&x(h,h.position-d),f=0;f<m-1;f++)if(void 0!==a[f].text&&""!==a[f].text&&void 0!==a[f+1].text&&""!==a[f+1].text)for(g=0;g<4;g++)y(a[f],a[f+1],c)}},checkIfHavingVisibleRefLines:function(){if(!this._data||0===this._data.length||!this._axis)return!1;var a;for(a=0;a<this._data.length;a+=1)if(this._data[a]&&this._data[a].show&&void 0!==this._data[a].refLineExpr){if("value"in this._data[a].refLineExpr&&(null===this._data[a].refLineExpr.value||isNaN(this._data[a].refLineExpr.value)))continue;return!0}return!1},updateLocalPlotMaxMinValues:function(){this._axis&&(this._plotMinValue=this._axis.getPlotMin(),this._plotMaxValue=this._axis.getPlotMax())},setLabelMargin:function(a){this._labelMargin=void 0===a?4:a},hasValidData:function(){return this._super()&&this._data&&this._axis},paint:function(){if(this._super.apply(this,arguments),this._plotMinValue===this._axis.getPlotMin()&&this._plotMaxValue===this._axis.getPlotMax()||(this._hasVisibleRefLines=this.checkIfHavingVisibleRefLines(),this.updateLocalPlotMaxMinValues()),!this._hasVisibleRefLines)return void this._clearLabels();C.call(this,!0);var a,b,c,e,f,j,k,l,o,p,q,r,s,t,u,v,w,x,y,z=this.isVertical()?"middle":"top"===this.dock?"bottom":"top",A=this.rect.width,B=this.rect.height,D="top"===this.dock?B-this._labelMargin:this._labelMargin,F=new Array(this._numLabelObjects),H=this._labelMaxWidthForYAxis,I=this._style.label.font,J="top"===this.dock?(B-this._labelMargin)/2:(B+this._labelMargin)/2;for(this.yMirrorMode?(l=.7,o=.3,p=A/2-(this._labelMargin/2+1)):(l=.3,o=.7,p=A/2+this._labelMargin/2+1),y=p,a=0;a<this._numLabelObjects;a+=1)w=this._labelObjects[a],b=w.index,c=E.call(this,w.value),this.isVertical()?(e=p,f=c):(e=c,f=void 0!==w.type?J:D),q=b>-1&&void 0!==this._data[b].color?n(this._data[b].color):this._style.label.color,void 0!==w.type?(I=this._style.outOfBounds.font,x="middle",q="white"):(I=this._style.label.font,x=z),r=new g,r.fill=q,r.x=e,r.y=f,r.align=O,r.baseline=x,r.font=I,r.maxWidth=H,r.maxHeight=92,r.maxNumLines=3,r.ellipsis="… "+w.text2,r.setText(w.text),F[a]=r,w.position=c,w.shapeWrapper=r;if(0===this._numLabelObjects)return void this._clearLabels();if(this.isVertical()){for(m(this._labelObjects),this._numUpperLabels>0&&(c=Math.floor(this._axis.getPositionOfValue(this._axis.getPlotMax()))-.7,this._labelObjects.push({position:c,size:2})),this._numLowerLabels>0&&(c=Math.floor(this._axis.getPositionOfValue(this._axis.getPlotMin()))-.3,this._labelObjects.push({position:c,size:2})),d.positionRectanglesAlongAxis(this._labelObjects,this._verticaLabelGap,this._boundaryGap,this.rect.height,!1),a=this._labelObjects.length-1;a>-1;a--)void 0===this._labelObjects[a].shapeWrapper&&this._labelObjects.splice(a,1);for(a=0;a<this._numLabelObjects;a+=1)w=this._labelObjects[a],s=w.shapeWrapper,s.y=w.newPosition,1===w.type&&(t=w.shapeWrapper.measure(),u={cx:s.x,cy:s.y,r:G(t)/2}),w.type===-1&&(t=w.shapeWrapper.measure(),v={cx:s.x,cy:s.y,r:G(t)/2})}else{for(this.calculateLabelWidths(this._labelObjects,this.rect.width,this._horizontalLabelGap,this._boundaryGap,this._labelMaxWidthForXAxis),this._numUpperLabels>0&&(c=Math.floor(this._axis.getPositionOfValue(this._axis.getPlotMax()))-l,this._labelObjects.push({position:c,size:2})),this._numLowerLabels>0&&(c=Math.floor(this._axis.getPositionOfValue(this._axis.getPlotMin()))-o,this._labelObjects.push({position:c,size:2})),d.positionRectanglesAlongAxis(this._labelObjects,this._horizontalLabelGap,this._boundaryGap,this.rect.width,!1),a=this._labelObjects.length-1;a>-1;a--)void 0===this._labelObjects[a].shapeWrapper&&this._labelObjects.splice(a,1);for(a=0;a<this._numLabelObjects;a+=1)w=this._labelObjects[a],s=w.shapeWrapper,s.x=w.newPosition,s.maxWidth=w.size,1===w.type&&(t=w.shapeWrapper.measure(),u={cx:s.x,cy:J,r:G(t)/2}),w.type===-1&&(t=w.shapeWrapper.measure(),v={cx:s.x,cy:J,r:G(t)/2})}this._numLowerLabels>0&&(this.isVertical()?r=new i([{x:y-3,y:B-5.2},{x:y,y:B},{x:y+3,y:B-5.2}]):(j=this.yMirrorMode?A-5.2:5.2,k=this.yMirrorMode?A:0,r=new i([{x:j,y:J-3},{x:k,y:J},{x:j,y:J+3}])),r.fill=this._style.label.color,F.push(r),r=new h(v.cx,v.cy,v.r),r.fill=this._style.outOfBounds.backgroundColor,F.splice(0,0,r)),this._numUpperLabels>0&&(this.isVertical()?r=new i([{x:y-3,y:5.2},{x:y,y:0},{x:y+3,y:5.2}]):(j=this.yMirrorMode?5.2:A-5.2,k=this.yMirrorMode?0:A,r=new i([{x:j,y:J-3},{x:k,y:J},{x:j,y:J+3}])),r.fill=this._style.label.color,F.push(r),r=new h(u.cx,u.cy,u.r),r.fill=this._style.outOfBounds.backgroundColor,F.splice(0,0,r)),this.renderer.stage.removeChildren(),this.renderer.stage.addChildren(F),this.renderer.render(),this._tooltips.setLabelObjects(this._labelObjects)},release:function(){this._super(),this._axis&&this._axis.stopListen("changed",null,this),this._tooltips.release(),this._tooltips=null},on:function(){this._super(),this._tooltips.on()},off:function(){this._super(),this._tooltips.off()},_updateProperties:function(){if(this._data){var a,b,c=this._data,d=c.length;for(b=0;b<d;b++)a="value"+b,this._transitionProperties[a]=c[b].refLineExpr.value;this.calculateRelevantSize(),this._super()}},_clearLabels:function(){this.renderer.stage.removeChildren(),this.renderer.clear()}})}),define("objects.views/charts/utils/continuous-chart-util",["util"],function(a){return{getFocusRange:function(a,b,c,d){var e,f={},g=b<1?0:b-1,h=a.length-c-1;if(d<2)f[a[0][1].qElemNumber]={lower:null,upper:null};else for(var i=0;i<a.length;i++)f[a[i][1]]||(f[a[i][1].qElemNumber]={lower:null,upper:null});for(i=b-1;i>=0;i--)(e=f[a[i][1].qElemNumber])&&!e.lower&&(e.lower=i);for(i=a.length-c;i<a.length;i++)(e=f[a[i][1].qElemNumber])&&!e.upper&&(e.upper=i);return Object.keys(f).forEach(function(a){f[a].lower<g&&(g=f[a].lower),f[a].upper>h&&(h=f[a].upper)}),{lower:g,upper:h}},getFullContinuousRange:function(a){var b=a.qHyperCube.qDimensionInfo[0].qMin,c=a.qHyperCube.qDimensionInfo[0].qMax;return c<b||"NaN"===c?b=c="NaN":b===c&&(b-=.5,c+=.5),{min:b,max:c}},addContinuousDataToLayout:function(b,c){return b=a.extend({},b),b.qHyperCube=a.extend({},b.qHyperCube,{qMode:"S"}),b.qHyperCube.qDataPages=c.qDataPages,b.qHyperCube.qAxisData=c.qAxisData,b}}}),define("objects.backend-api/stacked-cube-slicer",["core.utils/class","general.utils/shapes/rect"],function(a,b){"use strict";var c=new b(0,0,0,0),d=new b(0,0,0,0);return a.extend("StackedCubeSlicer",{init:function(){this.pages=[]},get:function(a){return a.map(function(a){return this.getPage(a)}.bind(this))},getPage:function(a){var e,f,g,h=[];for(f=0;f<this.pages.length;f++)if(e=this.pages[f].qArea,c.set(a.qLeft,a.qTop,a.qWidth,a.qHeight),d.set(e.qLeft,e.qTop,e.qWidth,e.qHeight),g=d.intersection(c,!0),h.push({coverage:g?g.clone():new b(0,0,0,0),idx:f}),e.qLeft<=a.qLeft&&e.qLeft+e.qWidth>=a.qLeft+a.qWidth&&e.qTop<=a.qTop&&e.qTop+e.qHeight>=a.qTop+a.qHeight)return this._extract(a,this.pages[f]);return h.sort(function(a,b){return b.coverage.width*b.coverage.height-a.coverage.width*a.coverage.height}),h[0].coverage.height>0&&h[0].coverage.width>0?this._extract(a,this.pages[h[0].idx]):{qArea:{qTop:a.qTop,qLeft:a.qLeft,qWidth:0,qHeight:0},qData:[]}},destroy:function(){this.clear()},isEmpty:function(){return!(this.pages&&this.pages[0]&&this.pages[0].qArea.qHeight&&this.pages[0].qArea.qWidth)},clear:function(){this.pages=[]},store:function(a){this.pages=a},containsArea:function(a){for(var b,c=0;c<this.pages.length;c++)if(b=this.pages[c].qArea,b.qLeft<=a.qLeft&&b.qLeft+b.qWidth>=a.qLeft+a.qWidth&&b.qTop<=a.qTop&&b.qTop+b.qHeight>=a.qTop+a.qHeight)return!0;return!1},contains:function(a){return!(!this.pages||!this.pages.length)&&0===a.filter(function(a){return!this.containsArea(a)}.bind(this)).length},_extract:function(a,b){c.set(a.qLeft,a.qTop,a.qWidth,a.qHeight),d.set(b.qArea.qLeft,b.qArea.qTop,b.qArea.qWidth,b.qArea.qHeight);var e,f,g=c.intersection(d,!0);if(!g)return{qArea:{qTop:a.qTop,qLeft:a.qLeft,qWidth:0,qHeight:0},qData:[]};f=Math.max(0,a.qTop-b.qArea.qTop);var h=b.qData[0],i=h.qSubNodes;e={};for(var j in h)h.hasOwnProperty(j)&&(e[j]="qSubNodes"===j?i.slice(f,f+g.height):h[j]);return e.qUp+=f,e.qDown+=b.qArea.qHeight-g.height-f,{qArea:{qTop:g.y,qLeft:g.x,qWidth:g.width,qHeight:g.height},qData:[e]}}})}),define("objects.views/selections/interaction-handler",["jquery","core.utils/class","core.utils/notification","objects.utils/event-utils"],function(a,b,c){function d(a){return s+"."+a}function e(a,b){return a.priority-b.priority}function f(a,b){return a.filter(function(a){return a.target===b.target&&a.container===b.container}).length?null:(b.priority=isNaN(b.priority)?0:b.priority,a.push(b),a.sort(e),b)}function g(a,b){var c=a.indexOf(b);c!==-1&&a.splice(c,1)}function h(a,b,c){return a.filter(function(a){return a[c]===b})}function i(a,b,c){for(var d,e=a.gesture,f=a.action,g=a.item.targets,h=0;h<g.length&&(d=g[h].target,!d.active()||(d[e][f]&&d[e][f].apply(this,[b,c,g[h].data]),!d.exclusive()));h++);}function j(a,b,c){for(var d,e=a.gesture,f=a.item.targets,g=0;g<f.length&&(d=f[g].target,!(d.active()&&(d[e].apply(this,[b,c,f[g].data]),d.exclusive&&d.exclusive())));g++);}function k(a,b){a.handlers.start=function(c,d){i.apply(this,[{gesture:b,action:"start",item:a},c,d])},a.handlers.end=function(c,d){i.apply(this,[{gesture:b,action:"end",item:a},c,d])},["swipe","swipetwo","wheelswipe","rotate"].contains(b)&&(a.handlers.update=function(c,d){i.apply(this,[{gesture:b,action:"update",item:a},c,d])},a.handlers.cancel=function(c,d){i.apply(this,[{gesture:b,action:"cancel",item:a},c,d])})}function l(a,b,c){var e={id:d(b),options:{preventDefault:c}};switch(Object.keys(a.handlers).forEach(function(b){e[b]=a.handlers[b]}),b){case"swipe":e.options.useMomentum=!0,e.options.inertia=.5;case"tap":e.options.touches=1;break;case"swipetwo":e.options.useMomentum=!0,e.options.inertia=.5;case"taptwo":e.options.touches=2;break;case"tapthree":e.options.touches=3}return e}function m(a){switch(a){case"taptwo":case"tapthree":return"tap";case"swipetwo":return"swipe";case"tap":case"swipe":case"wheelswipe":case"rotate":default:return a}}function n(a,b,c){var d=t[c].containers.filter(function(b){return b.container===a.container})[0];return d||(d={container:a.container,targets:[],handlers:{}},k(d,c),d.unbind=Touche(a.container)[m(c)](l(d,c,b)),t[c].containers.push(d)),f(d.targets,a),d}function o(b,c){var d=u[c].containers.filter(function(a){return a.container===b.container})[0];return d||(d={container:b.container,targets:[],handler:null},d.handler=function(a){j.apply(this,[{gesture:c,item:d},a])},a(b.container).on(c+"."+s+("mousewheel"===c?" DOMMouseScroll."+s:""),d.handler)),f(d.targets,b),d}function p(a){switch(a){case"tap":case"swipe":case"taptwo":case"swipetwo":case"wheelswipe":case"tapthree":case"rotate":return"touche";case"mousemove":case"mouseleave":case"mousewheel":case"mouseup":return"jquery"}}var q=a(document),r=[],s="chart-interaction",t={tap:{containers:[]},taptwo:{containers:[]},tapthree:{containers:[]},swipe:{containers:[]},swipetwo:{containers:[]},wheelswipe:{containers:[]},rotate:{containers:[]}},u={mousemove:{containers:[]},mouseleave:{containers:[]},mousewheel:{containers:[]},mouseup:{containers:[]}},v=b.extend({init:function(){c.mixin(this),this.notification("ShiftToggle"),this.notification("CtrlToggle"),this.notification("KeyPressed"),this.notification("MouseUp"),this.notification("MouseLeave"),q.on("keydown."+s,function(a){16!==a.which||this.shiftPressed?17!==a.which||this.ctrlPressed||(this.ctrlPressed=!0,this.CtrlToggle.emit(this.ctrlPressed)):(this.shiftPressed=!0,this.ShiftToggle.emit(this.shiftPressed))}.bind(this)),q.on("keyup."+s,function(a){16===a.which&&this.shiftPressed?(this.shiftPressed=!1,this.ShiftToggle.emit(this.shiftPressed)):17===a.which&&this.ctrlPressed&&(this.ctrlPressed=!1,this.CtrlToggle.emit(this.ctrlPressed)),this.KeyPressed.emit(a.which)}.bind(this)),q.on("mouseup."+s,function(a){this.MouseUp.emit(a)}.bind(this)),q.on("mouseleave."+s,function(a){this.MouseLeave.emit(a)}.bind(this)),this.shiftPressed=!1,this.ctrlPressed=!1},addInteraction:function(a,b,c,d,e,g){var h=f(r,{target:a,container:b,priority:c,types:{},data:g});if(!h)throw new Error("Duplicate add of interaction, potential leak detected.");d.forEach(function(b){if(!a[b])throw new Error("Interaction reciver does not implement the specified interaction type: "+b);switch(b){case"tap":case"taptwo":case"swipe":case"swipetwo":case"wheelswipe":case"tapthree":case"rotate":h.types[b]=n(h,e,b);break;case"mousemove":case"mouseleave":case"mousewheel":case"mouseup":h.types[b]=o(h,b);break;default:throw"The specified interaction type does not exist: "+b}})},removeInteraction:function(b,c){var e=h(r,b,"target");c&&(e=h(e,c,"container")),e&&e.length&&e.forEach(function(b){Object.keys(b.types).forEach(function(c){var e=b.types[c];g(e.targets,b),e.targets.length||("touche"===p(c)?(Touche(e.container).off("*",d(c)),g(t[c].containers,e)):a(e.container).off(c+"."+s))}),g(r,b)})},removeAllInteraction:function(){Object.keys(t).forEach(function(a){t[a].containers.forEach(function(b){Touche(b.container).off("*",d(a))}),t[a].containers=[]}),r=[]}}),w=new v;return{ShiftToggle:w.ShiftToggle,CtrlToggle:w.CtrlToggle,KeyPressed:w.KeyPressed,MouseUp:w.MouseUp,MouseLeave:w.MouseLeave,addInteraction:w.addInteraction,removeInteraction:w.removeInteraction,removeAllInteraction:w.removeAllInteraction,preventGestures:function(a){if(!a.gestureHandler)throw"Interaction.js, preventGestures: Called with invalid binder";Touche.preventGestures(a.gestureHandler)},_unitTestExposure:{toucheHandlers:t}}}),define("objects.views/selections/interaction-type",["core.utils/class"],function(a){var b=a.extend({init:function(){},tap:{},taptwo:{},tapthree:{},swipe:{},swipetwo:{},rotate:{},mousemove:{},mouseleave:{},mousewheel:{},wheelswipe:{},exclusive:function(){return!1},active:function(){return!0}});return{extend:function(){return 2===arguments.length?b.extend.call(a,arguments[0],arguments[1]):new(b.extend(arguments[0]))}}}),define("objects.views/charts/utils/pan-scroll-controller",["core.utils/notification","objects.utils/event-utils","general.utils/shapes/point","objects.views/selections/interaction-handler","objects.views/selections/interaction-type"],function(a,b,c,d,e){"use strict";var f=3;return e.extend("PanScrollController",{init:function(d,e){function g(a,b){l._panning=!0,l._panX=b.points[0].x,l._panY=b.points[0].y,l.PanStart.emit()}function h(a){l._panning=!0,l._panX=a.pageX,l._panY=a.pageY,l.PanStart.emit()}function i(a,b){l._panning||(l._panning=!0,l._panX=b.points[0].x,l._panY=b.points[0].y);var d=b.swipe&&b.swipe.currentPoint?b.swipe.currentPoint:new c(a.pageX,a.pageY),e=new c(d.x-l._panX,d.y-l._panY);l._panX=d.x,l._panY=d.y,l.PanUpdate.emit(e)}function j(){l._panning=!1,l.PanEnd.emit()}function k(a){var c=b.getMouseWheelData(a.originalEvent);if(c.delta){var d=c.delta>0?f:-f;l.PanWheel.emit(d)}}a.mixin(this),this.notification("PanStart"),this.notification("PanUpdate"),this.notification("PanWheel"),this.notification("PanEnd"),this._$dataAreaContainer=d,this._$fullContainer=e;var l=this;this._eventHandlers={swipe:{start:g,update:i,end:j},swipetwo:{start:g,update:i,end:j},mousewheel:b.throttle(k,20),wheelswipe:{start:h,update:i,end:j},exclusive:function(){return!1},active:function(){return!0}}},on:function(){this._isOn||(d.addInteraction(this._eventHandlers,this._$dataAreaContainer,2,["swipe","swipetwo"],!0),d.addInteraction(this._eventHandlers,this._$fullContainer,2,["mousewheel","wheelswipe"],!0),this._isOn=!0)},off:function(){this._isOn&&(d.removeInteraction(this._eventHandlers),this._isOn=!1)}})}),define("objects.views/charts/utils/unit-projection",["core.utils/class"],function(a){return a.extend("UnitProjection",{init:function(){},getProjectionType:function(){return"Unit"},project:function(a){return a},invProject:function(a){return a}})}),define("objects.views/charts/utils/viewport-projection",["objects.views/charts/events/event-launcher","general.utils/shapes/point","general.utils/shapes/rect","objects.views/charts/utils/unit-projection","objects.views/charts/utils/matrix"],function(a,b,c,d,e){function f(a){return this._originalProjectedDataCenterIsZeroPoint?a:new b(a.x-this._originalProjectedDataCenter.x,a.y-this._originalProjectedDataCenter.y)}function g(a){return this._originalProjectedDataCenterIsZeroPoint?a:new b(a.x+this._originalProjectedDataCenter.x,a.y+this._originalProjectedDataCenter.y)}function h(a,c){var d=Math.pow(2,c+8)/this._projectedDataSize;return new b(a.x*d,a.y*d)}function i(a,c){var d=Math.pow(2,c+8)/this._projectedDataSize;return new b(a.x/d,a.y/d)}function j(){if(this._projection&&this._projectedDataBoundingBox){var a,b,c,d,e;(!this._currentProjectedDataDataCenter||this._projectionChanged||this._currentDataCenterChanged)&&(this._currentProjectedDataDataCenter=void 0===this._currentDataCenter?this._originalProjectedDataCenter:this._projection.project(this._currentDataCenter)),this._transformMatrixForZoomLevel.identity(),this._transformMatrixForZoomLevel.translate(this._viewportSize.x/2,this._viewportSize.y/2),this._mirrorYAxis&&this._transformMatrixForZoomLevel.scale(1,-1),a=Math.pow(2,this._zoomLevel+8)/this._projectedDataSize,this._transformMatrixForZoomLevel.scale(a,a),this._transformMatrixForZoomLevel.translate(-this._originalProjectedDataCenter.x,-this._originalProjectedDataCenter.y),b=this._transformMatrixForZoomLevel.transformPoint(this._originalProjectedDataCenter),c=this._transformMatrixForZoomLevel.transformPoint(this._currentProjectedDataDataCenter),d=b.x-c.x,e=b.y-c.y,this._transformMatrix.identity(),this._transformMatrix.translate(d,e),this._transformMatrix.multiply(this._transformMatrixForZoomLevel.elements),this._invTransformMatrix=this._transformMatrix.clone(),this._invTransformMatrix.invert(),this._projectionChanged=!1,this._currentDataCenterChanged=!1,this.enabledChangeEvent&&this.fire("changed")}}function k(){var a,b,d,e,f,g;a={x:this._boundingBox.x,y:this._boundingBox.y},b={x:this._boundingBox.x+this._boundingBox.width,y:this._boundingBox.y+this._boundingBox.height},d=this._projection.project(a),e=this._projection.project(b),f=Math.min(d.x,e.x),g=Math.min(d.y,e.y),this._projectedDataBoundingBox=new c(f,g,Math.abs(e.x-d.x),Math.abs(e.y-d.y)),this._projectedDataSize=Math.max(this._projectedDataBoundingBox.width,this._projectedDataBoundingBox.height),this._originalProjectedDataCenter=this._projectedDataBoundingBox.getCenterPoint(),this._originalProjectedDataCenterIsZeroPoint=0===this._originalProjectedDataCenter.x&&0===this._originalProjectedDataCenter.y}var l=0,m=new b(0,0),n=Math.log(2);return a.extend("ViewportProjection",{init:function(){this._super(),l++,this._fractionalZoomMode=!0,this._viewportSize=new b(256,256),this._zoomLevel=0,this._maxZoomLevel=22,this._minZoomLevel=0,this._translation=new b(0,0),this._unitProjection=new d,this._projection=this._unitProjection,this._originalProjectedDataCenter=new b(0,0),this._boundingBox=new c(0,0,256,256),k.call(this),this._originalProjectedDataCenterIsZeroPoint=!0,this._transformMatrixForZoomLevel=new e,this._transformMatrix=new e,this._invTransformMatrix=new e,this.enabledChangeEvent=!0,this._mirrorYAxis=!1,this.helpFunctions={translateProjectedDataCenterToZeroPoint:f,invTranslateProjectedDataCenterToZeroPoint:g,scaleProjectedDataToZoomLevel:h,invScaleProjectedDataToZoomLevel:i,updateProjectedDataBoundingBox:k}},setProjection:function(a){return(!this._projection||!a||this._projection.getProjectionType()!==a.getProjectionType())&&(this._projection=a,this._projection||(this._projection=this._unitProjection),k.call(this),this._projectionChanged=!0,j.call(this),!0)},getProjection:function(){return this._projection},getUnitProjection:function(){return this._unitProjection},setBoundingBox:function(a){this._boundingBox&&this._boundingBox.equal&&this._boundingBox.equal(a)||(this._boundingBox=new c(a.x,a.y,a.width,a.height),k.call(this),j.call(this))},getBoundingBox:function(){return this._boundingBox},setSize:function(a){return!(this._viewportSize&&this._viewportSize.equal&&this._viewportSize.equal(a))&&(this._viewportSize=new b(a.x,a.y),j.call(this),!0)},getSize:function(){return this._viewportSize},setZoomLevel:function(a){return!isNaN(a)&&(this._fractionalZoomMode||(a=Math.round(a)),a=Math.max(Math.min(a,this._maxZoomLevel),this._minZoomLevel),Math.abs(a-this._minZoomLevel)<.001?a=this._minZoomLevel:Math.abs(a-this._maxZoomLevel)<.001&&(a=this._maxZoomLevel),!(Math.abs(this._zoomLevel-a)<.001)&&(this._zoomLevel=a,j.call(this),!0))},getZoomLevel:function(){return this._zoomLevel},setDataCenter:function(a){return!!a&&(!(this._currentDataCenter&&this._currentDataCenter.closeTo&&this._currentDataCenter.closeTo(a,1e-9))&&(this._currentDataCenterChanged=!0,this._currentDataCenter=new b(a.x,a.y),j.call(this),!0))},getDataCenter:function(){return this._currentDataCenter},setFractionalZoomMode:function(a){this._fractionalZoomMode=a},getFractionalZoomMode:function(){return this._fractionalZoomMode},project:function(a){var b;return b=this._projection.project(a),this.transform(b)},fromDataRectToViewportRect:function(a){var d,e;return d=this.project(new b(a.x,a.y)),e=this.project(new b(a.x+a.width,a.y+a.height)),new c(d.x,d.y,e.x-d.x,e.y-d.y)},invProject:function(a){var b;return b=this.invTransform(a),this._projection.invProject(b)},fromViewportRectToDataRect:function(a){var d,e;return d=this.invProject(new b(a.x,a.y)),e=this.invProject(new b(a.x+a.width,a.y+a.height)),new c(d.x,d.y,e.x-d.x,e.y-d.y)},getDataRectOfViewport:function(){var a,b;return a=this.invProject(m),b=this.invProject(this._viewportSize),new c(a.x,a.y,b.x-a.x,b.y-a.y)},getDataRectOfViewportIfZoomOnADataRect:function(a){var b=this.enabledChangeEvent;this.enabledChangeEvent=!1;var c=this.getZoomLevel(),d=this.getDataCenter();this.zoomOnDataRectangle(a);var e=this.getDataRectOfViewport();return this.setZoomLevel(c),this.setDataCenter(d),this.enabledChangeEvent=b,e},transform:function(a){var c=this._transformMatrix.transformPoint(a);return new b(c.x,c.y)},invTransform:function(a){var c=this._invTransformMatrix.transformPoint(a);return new b(c.x,c.y)},fromDataPointToPixel:function(a,c){var d,e,g,i=Math.pow(2,c+7);return d=this._projection.project(a),e=f.call(this,d),g=h.apply(this,[e,c]),new b(g.x+i,i-g.y)},fromPixelToDataPoint:function(a,c){var d,e,f,h=Math.pow(2,c+7);return f=new b(a.x-h,h-a.y),e=i.apply(this,[f,c]),d=g.call(this,e),this._projection.invProject(d)},calculateZoomLevelForDataRectangle:function(a){if(a){var c,d,e,f,g,h,i,j,k;return c=new b(a.x,a.y),(d=new b(a.x+a.width,a.y+a.height),e=this.fromDataPointToPixel(c,0),f=this.fromDataPointToPixel(d,0),g=Math.abs(e.x-f.x),h=Math.abs(e.y-f.y),i=0===g?Number.MAX_VALUE:this._viewportSize.x/g,j=0===h?Number.MAX_VALUE:this._viewportSize.y/h,(k=Math.min(i,j))===Number.MAX_VALUE)?20:Math.log(k)/Math.LN2}},calculateCenterPointForDataRectangle:function(a){if(a){var c,d,e,f,g;return c=new b(a.x,a.y),d=new b(a.x+a.width,a.y+a.height),e=this.fromDataPointToPixel(c,0),f=this.fromDataPointToPixel(d,0),g=new b((e.x+f.x)/2,(e.y+f.y)/2),this.fromPixelToDataPoint(g,0)}},moveViewport:function(a,c){this.setDataCenter(this.invProject(new b(this._viewportSize.x/2-a,this._viewportSize.y/2-c)))},zoom:function(a){a>0&&this.setZoomLevel(this.getZoomLevel()+Math.log(a)/Math.LN2)},zoomOnPixel:function(a,b){if(b>0){var c,d,e;c=this.invTransform(a),e=Math.log(b)/Math.LN2,this.setZoomLevel(this.getZoomLevel()+e),d=this.transform(c),this.moveViewport(a.x-d.x,a.y-d.y)}},zoomOnDataRectangle:function(a,b){if(a){var c,d;c=this.calculateZoomLevelForDataRectangle(a),this._fractionalZoomMode||(c=b?Math.round(c):Math.floor(c)),this.setZoomLevel(c),d=this.calculateCenterPointForDataRectangle(a),this.setDataCenter(d)}},setMaxZoomLevel:function(a){this._maxZoomLevel=a},setMinZoomLevel:function(a){this._minZoomLevel=a},getTransformMatrix:function(){return this._transformMatrix},setTransformMatrix:function(a){var c,d,e;this._invTransformMatrix=a.clone().invert(),c=Math.abs(a.elements[0][0]),d=Math.log(c*this._projectedDataSize)/n-8,e=this.invProject(new b(this._viewportSize.x/2,this._viewportSize.y/2)),this.setZoomLevel(d),this.setDataCenter(e)},getInvTransformMatrix:function(){return this._invTransformMatrix}})}),define("objects.views/charts/utils/pan-zoom-controller",["core.utils/class","objects.utils/event-utils","general.utils/shapes/point","general.utils/shapes/rect","objects.views/charts/utils/matrix","objects.views/charts/utils/viewport-projection","objects.views/selections/interaction-type","objects.views/selections/interaction-handler","touche"],function(a,b,c,d,e,f,g,h){"use strict";function i(a){a=Math.min(Math.max(a,this._minZoomLevel),this._maxZoomLevel),this._viewportProjection.setZoomLevel(a)}function j(a,b,c,d){var f,g,h,i,j,k=new e,m=c/d;h=b.x-a.x,i=b.y-a.y,f=this._localMatrix.clone().invert().transformPoint(a),k.translate(f.x,f.y),k.scale(m,m),k.translate(-f.x,-f.y),this._localMatrix=this._localMatrix.multiply(k),
j=this._localMatrix.elements,this._localMatrix.translate(h/j[0][0],i/j[1][1]),l.call(this),k.identity(),g=this._globalMatrix.clone().invert().transformPoint(a),k.translate(g.x,g.y),k.scale(m,m),k.translate(-g.x,-g.y),this._globalMatrix=this._globalMatrix.multiply(k),j=this._globalMatrix.elements,this._globalMatrix.translate(h/j[0][0],i/j[1][1])}function k(a){if(!this._setTransformOrigin){var b="top left";a.style["-webkit-transform-origin"]=b,a.style["-moz-transform-origin"]=b,a.style["-o-transform-origin"]=b,a.style["-ms-transform-origin"]=b,a.style["transform-origin"]=b,this._setTransformOrigin=!0}}function l(){var a=this._localMatrix.elements,b="matrix("+a[0][0]+",0,0,"+a[1][1]+","+a[0][2]+","+a[1][2]+")";this.helpFunctions.setTransform(this._$element[0],b)}function m(a,b){this.helpFunctions.onInteractionStart(),n.call(this,a,b)}function n(a,b){if(!this._disableZoomOnMouseWheel){this._disableZoomOnMouseWheel=!0;var c,d=this,f=new e;if(setTimeout(function(){d._disableZoomOnMouseWheel=!1},d._mouseWheelTimeoutPeriod),this._zoomPanByWebkitTransform){var g;this._zooming=!0,g=this._localMatrix.clone().invert().transformPoint(a),f.translate(g.x,g.y),f.scale(b,b),f.translate(-g.x,-g.y),this._localMatrix=this._localMatrix.multiply(f),l.call(this)}else t.call(this,a,b);this._zoomCancelled||(f.identity(),c=this._globalMatrix.clone().invert().transformPoint(a),f.translate(c.x,c.y),f.scale(b,b),f.translate(-c.x,-c.y),this._globalMatrix=this._globalMatrix.multiply(f),this._updateCallback()),this._zoomCancelled=!1}}function o(){this._zooming=!1,this.helpFunctions.onInteractionEnd()}function p(a,b){this.helpFunctions.onInteractionStart(),q.call(this,a,b)}function q(a,b){var c;this._zoomPanByWebkitTransform?(this._panning=!0,c=this._localMatrix.elements,this._localMatrix.translate(a/c[0][0],b/c[1][1]),l.call(this)):s.call(this,a,b),c=this._globalMatrix.elements,this._globalMatrix.translate(a/c[0][0],b/c[1][1]),this._updateCallback()}function r(){this._panning=!1,this.helpFunctions.onInteractionEnd()}function s(a,b){this._viewportProjection.enabledChangeEvent=!1,this.moveViewport(a,b),this._viewportProjection.enabledChangeEvent=!0}function t(a,b){this._viewportProjection.enabledChangeEvent=!1,this.zoomOnPixel(a,b),this._viewportProjection.enabledChangeEvent=!0}var u=a.extend("PanZoomController",{init:function(a,b,c,g){var h=this;this._minZoomLevel=-3,this._maxZoomLevel=22,this._interactionStarted=!1,this._zoomPanByWebkitTransform=!1,this._fractionalZoomMode=!0,this._defaultScale=Math.pow(2,.5),this._invDefaultScale=1/this._defaultScale,this._mouseWheelTimeoutPeriod=50,this._viewportProjection=g||new f,this._viewportProjection.setMinZoomLevel(this._minZoomLevel),this._viewportProjection.setMaxZoomLevel(this._maxZoomLevel),this._localMatrix=new e,this._$element=a,this._offset=a.offset(),this._startCallback=function(){b.start&&b.start(this._viewportProjection._transformMatrix)},this._updateCallback=function(){b.update&&b.update(this._viewportProjection._transformMatrix)},this._endCallback=function(){b.end&&b.end(this._viewportProjection._transformMatrix)},this._resetCallback=function(){b.reset&&b.reset(this._viewportProjection._transformMatrix)},this._enabled=!0,this._defaultBounds=this._viewportProjection.getBoundingBox(),this._dataBounds=c?new d(c.x,c.y,c.width,c.height):this._defaultBounds,this.helpFunctions={setTransform:function(a,b){a.style["-webkit-transform"]=b,a.style["-moz-transform"]=b,a.style["-o-transform"]=b,a.style["-ms-transform"]=b,a.style.transform=b},onInteractionStart:function(){h._interactionStarted||(h._startCallback(),h.reset(),h._interactionStarted=!0)},onInteractionEnd:function(){h._zooming||h._panning||h._pinching||!h._interactionStarted||(h.helpFunctions.setTransform(h._$element[0],"matrix(1,0,0,1,0,0)"),h._viewportProjection.enabledChangeEvent=!1,h._viewportProjection.setTransformMatrix(h._globalMatrix),h._endCallback(),h._viewportProjection.enabledChangeEvent=!0,h._interactionStarted=!1)}}},reset:function(){this._localMatrix.identity(),this._globalMatrix=this._viewportProjection.getTransformMatrix().clone(),this._zoomPanByWebkitTransform&&this.helpFunctions.setTransform(this._$element[0],"matrix(1,0,0,1,0,0)")},setOffset:function(a){this._offset=a},navigate:function(a,b){var c,d=this;switch(a){case"resetZoom":d.zoomOnDataBounds();break;case"zoomIn":if(void 0===(c=d.getZoomLevel())||null===c||c===d._maxZoomLevel)return;m.call(d,{x:this._$element.width()/2,y:this._$element.height()/2},d._defaultScale),o.call(d);break;case"zoomOut":if(void 0===(c=d.getZoomLevel())||null===c||c===d._minZoomLevel)return;m.call(d,{x:this._$element.width()/2,y:this._$element.height()/2},d._invDefaultScale),o.call(d);break;case"navUp":p.call(d,0,200),r.call(d);break;case"navDown":p.call(d,0,-200),r.call(d);break;case"navLeft":p.call(d,200,0),r.call(d);break;case"navRight":p.call(d,-200,0),r.call(d);break;case"jumpTo":p.call(d,b.x,b.y),r.call(d);break;case"startAt":p.call(d,b.x,b.y);break;case"moveTo":q.call(d,b.x,b.y);break;case"endAt":r.call(d)}},onPan:function(a,b,c){var d=this;switch(a){case"start":p.call(d,c.swipe.deltaX,c.swipe.deltaY);break;case"update":q.call(d,c.swipe.curDeltaX,c.swipe.curDeltaY);break;case"end":r.call(d)}},on:function(a,d){var e,f,i,l,s=this,t=!1,u=d||this._$element[0],v=!1;this.container=u,this.namespace=a,k.call(this,this._$element[0]);var w=function(a){var d,e,f,g,h=b.getMouseWheelData(a.originalEvent);d=h.x-s._offset.left,e=h.y-s._offset.top,f=new c(d,e),g=h.delta>0?s._defaultScale:s._invDefaultScale,v?n.call(s,f,g):m.call(s,f,g),v=!0,null!==l&&clearTimeout(l),l=setTimeout(function(){l=null,o.call(s),v=!1},250)},x=function(a,b){2===b.pagePoints.length?(this.pinch={start:{},current:{}},this.pinch.start.point1=b.pagePoints[0],this.pinch.start.point2=b.pagePoints[1],b.centerPoint=new c((this.pinch.start.point1.x+this.pinch.start.point2.x)/2,(this.pinch.start.point1.y+this.pinch.start.point2.y)/2),b.scale=1,f={},f.x=(this.pinch.start.point1.x+this.pinch.start.point2.x)/2-s._offset.left,f.y=(this.pinch.start.point1.y+this.pinch.start.point2.y)/2-s._offset.top,i={x:b.centerPoint.x-s._offset.left,y:b.centerPoint.y-s._offset.top},s.helpFunctions.onInteractionStart(),e=b.scale,f=i):s.onPan("start",a,b),Touche.preventGestures(this.gestureHandler)},y=function(a,b){2===b.pagePoints.length?this.pinch.start.point2?(b.centerPoint||(b.centerPoint=new c((this.pinch.start.point1.x+this.pinch.start.point2.x)/2,(this.pinch.start.point1.y+this.pinch.start.point2.y)/2)),this.pinch.current.point1=b.pagePoints[0],this.pinch.current.point2=b.pagePoints[1],this.startDistance=this.pinch.start.point2.distanceTo(this.pinch.start.point1),this.lastDistance=this.currentDistance,this.currentDistance=this.pinch.current.point2.distanceTo(this.pinch.current.point1),this.pinchLength=Math.abs(this.startDistance-this.currentDistance),this.scale=this.currentDistance/this.startDistance,b.scale=this.scale,b.delta=this.currentDistance-this.lastDistance,b.centerPoint.x=(this.pinch.current.point1.x+this.pinch.current.point2.x)/2,b.centerPoint.y=(this.pinch.current.point1.y+this.pinch.current.point2.y)/2,i={x:b.centerPoint.x-s._offset.left,y:b.centerPoint.y-s._offset.top},s._pinching=!0,s._zoomPanByWebkitTransform?(j.call(s,f,i,b.scale,e),e=b.scale):(Math.abs(b.scale-e)>.1&&(n.call(s,i,b.scale-e+1),e=b.scale),q.call(s,i.x-f.x,i.y-f.y)),f=i):this.pinch.start.point2=b.pagePoints[1]:s.onPan("update",a,b),Touche.preventGestures(this.gestureHandler)},z=function(a,b){s._pinching=!1,this._zoomPanByWebkitTransform||(this._zooming=!1),s.onPan("end",a,b)},A=b.throttle(function(a){w(a)},20);this._eventHandlers=g.extend({mousewheel:function(a){A(a),a.preventDefault()},swipe:{start:function(a,b){x.call(this,a,b)},update:function(a,b){y.call(this,a,b)},end:function(a,b){z.call(this,a,b)}},swipetwo:{start:function(a,b){x.call(this,a,b)},update:function(a,b){y.call(this,a,b)},end:function(a,b){z.call(this,a,b)}},tapthree:{end:function(){s.zoomOnDataBounds(),h.preventGestures(this)}},wheelswipe:{start:function(a){s._panX=a.pageX,s._panY=a.pageY,t=!1},update:function(a){var b,c,d,e,f;b=a.pageX,c=a.pageY,d=b-s._panX,e=c-s._panY,f=t,!t&&(Math.abs(d)>3||Math.abs(e)>3)&&(t=!0),t&&(s._panX=b,s._panY=c,f?q.call(s,d,e):p.call(s,d,e))},end:function(){t?r.call(s):s.zoomOnDataBounds(),t=!1}},active:function(){return s._enabled}}),h.addInteraction(this._eventHandlers,u,2,["tapthree","swipe","swipetwo","wheelswipe","mousewheel"],!1)},off:function(){h.removeInteraction(this._eventHandlers)},setMaxZoomLevel:function(a){this._maxZoomLevel=a,this._viewportProjection&&this._viewportProjection.setMaxZoomLevel(a)},setMinZoomLevel:function(a){this._minZoomLevel=a,this._viewportProjection&&this._viewportProjection.setMinZoomLevel(a)},setCenter:function(a){this._viewportProjection&&this._viewportProjection.setDataCenter(a)},getCenter:function(){return this._viewportProjection?this._viewportProjection.getDataCenter():null},setZoomLevel:function(a){!isNaN(a)&&isFinite(a)&&(Math.abs(a-Math.round(a))<1e-6&&(a=Math.round(a)),i.call(this,a))},getZoomLevel:function(){return this._viewportProjection?this._viewportProjection.getZoomLevel():0},moveViewport:function(a,b){var d=this._viewportProjection.getSize();this.setCenter(this._viewportProjection.invProject(new c(d.x/2-a,d.y/2-b)))},zoom:function(a){if(a>0){var b=Math.log(a)/Math.LN2;Math.abs(b-Math.round(b))<1e-6&&(b=Math.round(b)),this.setZoomLevel(this.getZoomLevel()+b)}},zoomOnPixel:function(a,b){var c,d,e=this.getZoomLevel();if(e<=this._minZoomLevel&&b<=1||e>=this._maxZoomLevel&&b>=1)return void(this._zoomCancelled=!0);c=Math.pow(2,this._minZoomLevel-e),d=Math.pow(2,this._maxZoomLevel-e),b=Math.min(Math.max(b,c),d),this._viewportProjection.zoomOnPixel(a,b)},zoomOnDataRectangle:function(a,b){this._viewportProjection.zoomOnDataRectangle(a,b)},zoomOnViewportRectangle:function(a,b){var c=this._viewportProjection.fromViewportRectToDataRect(a);this.zoomOnDataRectangle(c,b)},setBounds:function(a,b,c,e){isNaN(a)||isNaN(b)||isNaN(c)||isNaN(e)||(this._dataBounds=new d(a,b,c,e))},setBoundsRect:function(a){!a||this._dataBounds&&this._dataBounds.equal(a)||(this._dataBounds=a.clone())},zoomOnDataBounds:function(){var a=this._dataBounds&&!this._dataBounds.hasNaN()?this._dataBounds:this._defaultBounds;if(a)return this.zoomOnDataRectangle(a,!1),this._resetCallback(),this._viewportProjection.fire("resetZoomFinished"),!0},setFractionalZoomMode:function(a){this._fractionalZoomMode=a,this._defaultScale=this._fractionalZoomMode?Math.pow(2,.5):2,this._invDefaultScale=1/this._defaultScale,this._mouseWheelTimeoutPeriod=this._fractionalZoomMode?50:100,this._viewportProjection&&this._viewportProjection.setFractionalZoomMode(a)},getFractionalZoomMode:function(){return this._fractionalZoomMode},setZoomPanByWebkitTransform:function(a){this._zoomPanByWebkitTransform=a},getZoomPanByWebkitTransform:function(){return this._zoomPanByWebkitTransform},release:function(){this._viewportProjection=null,this._$element=null}});return Object.defineProperties(u.prototype,{enabled:{set:function(a){this._enabled=a},get:function(){return this._enabled}}}),u}),define("objects.views/charts/scrollable-chart",["jquery","util","./axis-chart","objects.views/charts/components/axis/discrete-axis","objects.views/charts/components/axis/continuous-axis","objects.views/charts/components/axis/time-axis","objects.views/charts/components/chart-component","objects.views/charts/components/scroll-area","objects.views/charts/components/mini-chart","objects.views/charts/components/ref-line-labels","objects.views/charts/representation/combo-color-map","objects.views/charts/utils/binding","objects.views/charts/utils/continuous-chart-util","objects.views/charts/utils/time-utils","general.utils/shapes/rect","objects.utils/event-utils","objects.utils/num-date-time-formatter","core.utils/deferred","objects.backend-api/stacked-cube-slicer","objects.views/charts/utils/pan-scroll-controller","objects.views/charts/utils/pan-zoom-controller"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){function v(a){var b=this.components.scrollArea.getOffset()-a/(this.components.dimensionAxis._discreteSpacing||28);b=b<0?0:b,this.components.scrollArea.setOffset(b)}function w(){if(!this._disableZoom){var a=this._panZoomController._viewportProjection,b=this._activeDimAxis.getDataMin(),c=this._activeDimAxis.getDataMax(),d=c-b,e=this._activeDimAxis.getPlotSize();a.setSize({x:e,y:1}),a.setBoundingBox(new o(b,0,c-b,1)),this._panZoomController.setOffset(this._panZoomController._$element.offset());var f=this.components.scrollArea.getOffset(),g=this.components.scrollArea.getViewRange();this.yMirrorMode&&(f=d-g-f);var h=a.getTransformMatrix();h.identity(),h.scale(e/g,1),h.translate(-f,0),a.setTransformMatrix(h),A(this.selections)}}function x(a,b){var c=this.components.scrollArea.getOffset(),d=this.components.scrollArea.getViewRange();(Math.abs(a-c)>K||Math.abs(b-d)>K)&&(this.components.scrollArea.setViewRange(b),this.components.scrollArea.setOffset(a),this.components.scrollArea.fire("offsetChanged"))}function y(){if(!this._disableZoom){var a=this._panZoomController._viewportProjection,b=this._activeDimAxis.getPlotSize(),c=this._activeDimAxis.getDataMin(),d=this._activeDimAxis.getDataMax(),e=d-c,f=a.invTransform({x:0,y:0}).x,g=a.invTransform({x:b,y:0}).x,h=Math.min(g-f,e),i=Math.min(Math.max(f,0),e-h);this.yMirrorMode&&(i=e-h-i),x.call(this,i,h)}}function z(){var a=this._activeDimAxis.getDataMin(),b=this._activeDimAxis.getDataMax();x.call(this,0,b-a)}function A(a,b){var c=a&&a.getActiveType();c&&"range.discrete"===c.getActiveMode()&&c.cancel(!0),b&&b.clearSelection()}function B(a,b,c,f){var g,h,i=[],j=[];Object.keys(this.components).forEach(function(a){this.components[a]instanceof d||this.components[a].isDimension?i.push(this.components[a]):this.components[a]instanceof e&&!this.components[a].isStacked&&j.push(this.components[a])}.bind(this)),g=["top","bottom"].contains(this._activeDimAxis.dock)?"x":"y",h="x"===g?"y":"x",this.selections.types.range.setComponent(g,i),this.tooltips.setComponent(g,i),this.selections.types.range.setComponent(h,j),c&&(a>1||b>1)?(this.selections.types.range.setComponent(h,[]),"byMeasure"===f?this.selections.types.colorLegend.removeComponent("colorLegend",this.components.colorLegend):this.selections.types.colorLegend.setComponent("colorLegend",this.components.colorLegend)):this.selections.types.colorLegend.setComponent("colorLegend",this.components.colorLegend)}function C(){this._isPagingTransitionEnabled&&(this.components.measureAxis.setDataRangeTransition(!1),this.components.measureAxis.stopListen("endTransition",D,this),this.components.measureAxis.stopListen("startTransition",E,this),clearTimeout(this._pagingTransitionTimer),delete this.components.measureAxis.setDataRange,this._isPagingTransitionEnabled=!1)}function D(){this.components.refLineLabels&&this.layout();for(var a in this.components)this.components[a].invalidateDisplay("ScrollableChart.onAxisTransitionEnded")}function E(){this._visibleRefLines=this.components.refLineLabels.isVisible()}function F(){if(!this._isPagingTransitionEnabled&&!this.isDimensionContinuous){this._isPagingTransitionEnabled=!0;var a=this,b=this.components.measureAxis,c=b.setDataRange;b.listen("endTransition",D,this),b.listen("startTransition",E,this),this._pagingTransitionTimer=null,this.components.measureAxis.setDataRange=function(d,e){clearTimeout(a._pagingTransitionTimer),a._pagingTransitionTimer=setTimeout(function(){var f;b.setDataRangeTransition(!0),c.apply(b,[d,e]),a.layout();for(f in a.components)a.components[f].invalidateDisplay()},500)}}}function G(){var a,b,c,d,e,f=this.components.scrollArea,g=this.yMirrorMode,h=this._scrollableHint,i=[];this._scrollAffordance||(this._scrollAffordance={canIncrease:!1,canDecrease:!1,yMirrorMode:g}),c=f.getOffset(),e=f.getViewRange(),d=f.fullState.max,b=c>K,a=c+e<d-K,b===this._scrollAffordance.canDecrease&&a===this._scrollAffordance.canIncrease&&g===this._scrollAffordance.yMirrorMode||(this._scrollAffordance.canIncrease=a,this._scrollAffordance.canDecrease=b,this._scrollAffordance.yMirrorMode=g,b&&i.push(f.isVertical()?"up":this.yMirrorMode?"right":"left"),a&&i.push(f.isVertical()?"down":this.yMirrorMode?"left":"right"),this.yMirrorMode&&i.reverse(),h.attr("class",function(a,b){return b.replace(/\bqv-chart-scrollable-\S+/g,"")}),h.addClass("qv-chart-scrollable-"+i.join("-")))}function H(){var a=this;this._debounceUpdateHandle={},this._debouncedUpdate=p.debounce(function(){var b=this._activeDimAxis.getPlotMin(),c=this._activeDimAxis.getPlotMax();a.updateFocusedContinuousData(b,c).then(function(){a.partialUpdate(a._data)})},400,this._debounceUpdateHandle),this._changeWatchers.push(l.bindSetter(function(){if(a.isDimensionContinuous){var b=a._activeDimAxis.getDataMin()+a.components.scrollArea.getOffset(),c=b+a.components.scrollArea.getViewRange();a._activeDimAxis.setPlotMin(b),a._activeDimAxis.setPlotMax(c),a._activeDimAxis.invalidateDisplay(),a.components.dataArea.invalidateDisplay(),a.components.grid.invalidateDisplay(),a._debouncedUpdate()}},this.components.scrollArea,"offset"))}function I(a,b,c,d){for(var e,f,g=0;g<c.length;g++)for(var h=0;h<d.length;h++)if(c[g].qName===d[h].qName){e=d[h].qTicks.filter(function(b){return b.qEnd+1<a}),f=d[h].qTicks.filter(function(a){return a.qStart+1>b}),c[g].qTicks=e.concat(c[g].qTicks,f);break}}var J={NONE:0,ONE_DIM:1,TWO_DIM:2},K=1e-6;return c.extend("ScrollableChart",{init:function(b,c,m,n,p){var q=this,r=a.extend(!0,{providers:{colorMap:{clazz:k,multiDimScheme:"last"}},components:{refLines:{sortKey:5,show:!0,dock:"center",showFlag:g.prototype.ShowFlags.SPARK},dataArea:{sortKey:10,show:!0,dock:"center",showFlag:g.prototype.ShowFlags.SPARK},miniChart:{show:!0,clazz:i,components:{dimensionAxis:{show:!1,clazz:d},measureAxis:{show:!1},dataArea:{isMini:!0,show:!0},continuousAxis:{show:!1,clazz:e,dock:"bottom"}}},xAxis:{clazz:d,reductionOrder:10,shrinkToFitThreshold:.85,showFlag:{whenVertical:{vertical:g.prototype.ShowFlags.XSMALL,horizontal:g.prototype.ShowFlags.SMALL},whenHorizontal:{vertical:g.prototype.ShowFlags.SMALL,horizontal:g.prototype.ShowFlags.XSMALL}},titleShowFlag:{whenVertical:{vertical:g.prototype.ShowFlags.XSMALL,horizontal:g.prototype.ShowFlags.MEDIUM},whenHorizontal:{vertical:g.prototype.ShowFlags.MEDIUM,horizontal:g.prototype.ShowFlags.XSMALL}}},xAxisTitle:{showFlag:{whenVertical:{vertical:g.prototype.ShowFlags.XSMALL,horizontal:g.prototype.ShowFlags.MEDIUM},whenHorizontal:{vertical:g.prototype.ShowFlags.MEDIUM,horizontal:g.prototype.ShowFlags.XSMALL}},reductionOrder:1},timeAxis:{show:!0,isDimension:!0,order:1,dock:"bottom",relevantSize:90,reductionOrder:2,clazz:f,showFlag:{whenHorizontal:{vertical:g.prototype.ShowFlags.SMALL,horizontal:g.prototype.ShowFlags.XSMALL},whenVertical:{vertical:g.prototype.ShowFlags.XSMALL,horizontal:g.prototype.ShowFlags.SMALL}}},continuousAxis:{show:!0,isDimension:!0,order:1,dock:"bottom",relevantSize:90,reductionOrder:2,clazz:e,showFlag:{whenHorizontal:{vertical:g.prototype.ShowFlags.SMALL,horizontal:g.prototype.ShowFlags.XSMALL},whenVertical:{vertical:g.prototype.ShowFlags.XSMALL,horizontal:g.prototype.ShowFlags.SMALL}}},scrollArea:{sortKey:2,show:!0,dock:"bottom",order:2,relevantSize:20,reductionOrder:10.1,showFlag:g.prototype.ShowFlags.XSMALL,clazz:h},refLineLabels:{show:!0,dock:"right",order:3,reductionOrder:3,showFlag:{whenVertical:{vertical:g.prototype.ShowFlags.XSMALL,horizontal:g.prototype.ShowFlags.SMALL},whenHorizontal:{vertical:g.prototype.ShowFlags.MEDIUM,horizontal:g.prototype.ShowFlags.XSMALL}},clazz:j}}},m||{});this._super(b,c,r,n,p),this._scrollableHint=a("<div class='qv-chart-scrollable'>").appendTo(this.components.dataArea.container),this._changeWatchers=this._changeWatchers||[],this._pagingInfo=new o(0,0,0,0),this.components.measureAxis=this.components.yAxis,this.components.dimensionAxis=this.components.xAxis,this.components.dimensionAxisTitle=this.components.xAxisTitle,this.components.measureAxisTitle=this.components.yAxisTitle,delete this.components.xAxisTitle,delete this.components.yAxisTitle,delete this.components.xAxis,delete this.components.yAxis,this.components.dimensionAxisTitle.setType("dimension"),this.components.dimensionAxisTitle.listen("drill-up",function(a,b,c){q.backendApi.drillUp(b,c)}),this.components.dimensionAxisTitle.setModel(b.ext.model),this.components.measureAxisTitle.setType("measure"),this.components.measureAxisTitle.setModel(b.ext.model),this.components.scrollArea.listen("scrollStart",function(){A(this.selections,this.tooltips)}.bind(this)),this._showLegend=!1,this.scrollMultiplicator=1,this.components.dataArea.setMinorAxis(this.components.measureAxis),this.components.dataArea.setMajorAxis(this.components.dimensionAxis),this.components.dataArea.setTimeAxis(this.components.timeAxis),this.components.dataArea.setContinuousAxis(this.components.continuousAxis),this._setActiveDimensionAxis(b.layout),this.components.grid.setAxes(this.components.dimensionAxis,this.components.measureAxis),this.components.dimensionAxis.setMinDiscreteUnitSize(28),this._changeWatchers.push(l.bindProperty(this.components.dataArea,"dimensionTree",this._chartContext,"dimensionTree")),this._changeWatchers.push(l.bindProperty(this.providers.colorMap,"dimensionTree",this._chartContext,"dimensionTree")),this._changeWatchers.push(l.bindSetter(function(){q.isDimensionContinuous||q.components.dimensionAxis.setOffset(q.components.scrollArea.getOffset())},this.components.scrollArea,"offset")),this._changeWatchers.push(l.bindSetter(function(a){q.isDimensionContinuous||null===a||q.components.scrollArea.setFullRange(a)},this.components.dimensionAxis,"numDiscreteUnits")),this._changeWatchers.push(l.bindSetter(function(a){q.isDimensionContinuous||q.components.scrollArea.setViewRange(q._pagingMode===J.TWO_DIM?a/2:a)},this.components.dimensionAxis,"numDiscreteUnitsInView")),[this.components.timeAxis,this.components.continuousAxis].forEach(function(a){a&&a.listen("rendered",function(){var a=q.selections&&q.selections.getActiveType&&q.selections.getActiveType();a&&"range.dimension"===a.getActiveMode()&&(a.refreshContainer(),a.updateRangeProjection(),a.updateRangeDisplay())})}),(this.components.timeAxis||this.components.continuousAxis)&&H.call(this,this.components.continuousAxis),this._changeWatchers.push(l.bindSetter(function(){q._checkPage!==!1&&q.checkPage(),G.call(q)},this.components.dimensionAxis,"offset")),this._scrollController=new t(this.components.dataArea.container,this.container,this.components.scrollArea),this._scrollController.PanStart.bind(function(){A(q.selections)}),this._scrollController.PanUpdate.bind(function(a){var b=q.components.scrollArea.isHorizontal()?"x":"y";q.yMirrorMode&&(a.x=-a.x),v.call(q,a[b])}),this._scrollController.PanWheel.bind(function(a){A(q.selections),v.call(q,a*q.components.dimensionAxis._discreteSpacing)}),this._panZoomController=new u(a(this.components.dataArea.container),{start:function(){w.call(q)},update:function(){y.call(q)},end:function(){y.call(q)},reset:function(){z.call(q)}}),this._panZoomController.setZoomPanByWebkitTransform(!1),this.isDimensionContinuous&&this._panZoomController.setMaxZoomLevel(27)},setYMirrorMode:function(a){this._super(a),this.updateVerticalComponentsDock()},getVerticalComponents:function(){var a,b=this._super();return this._data&&this.components&&(this.components.dimensionAxis&&this.components.dimensionAxis.isVertical()&&this._data.dimensionAxis&&(b.push({comp:this.components.dimensionAxis,dock:this._data.dimensionAxis.dock}),this.components.dimensionAxisTitle&&b.push({comp:this.components.dimensionAxisTitle,dock:this._data.dimensionAxis.dock})),this.components.measureAxis&&this.components.measureAxis.isVertical()&&this._data.measureAxis&&(a=this._data.measureAxes&&this._data.measureAxes[0]?this._data.measureAxes[0].dock:this._data.measureAxis.dock,b.push({comp:this.components.measureAxis,dock:a}),this.components.measureAxisTitle&&b.push({comp:this.components.measureAxisTitle,dock:a})),this.components.refLineLabels&&this.components.refLineLabels.isVertical()&&this._data.measureAxis&&b.push({comp:this.components.refLineLabels,dock:"far"===this._data.measureAxis.dock?"near":"far"}),this.components.scrollArea&&this.components.scrollArea.isVertical()&&b.push({comp:this.components.scrollArea,dock:"far"})),b},initSelections:function(){this.selections._disableSelections=this.options._disableSelections,this.selections.types.dataArea.setComponent("dataArea",this.components.dataArea),this.selections.types.colorLegend.setComponent("colorLegend",this.components.colorLegend),this.options._disableSelections||(this.selections.types.range.setComponent("dataArea",this.components.dataArea),this.selections.Activated.bind(this.onSelection.Activated.bind(this)),this.selections.Lasso.bind(this.onToggleLasso.bind(this)),this.selections.Deactivated.bind(this.onSelection.Deactivated.bind(this)),this.selections.SelectRange.bind(this.onSelection.SelectRange.bind(this)),this.selections.SelectAttributeDim.bind(this.onSelection.SelectAttributeDim.bind(this)),this.selections.ToggleShape.bind(this.onSelection.ToggleShape.bind(this)),this.selections.Confirm.bind(this.onSelection.Confirm.bind(this)),this.selections.Cancel.bind(this.onSelection.Cancel.bind(this)),this.selections.Clear.bind(this.onSelection.Clear.bind(this)),this.selections.SelectWhileLocked.bind(this.selectWhileLocked.bind(this)))},initTooltips:function(){this.tooltips.setComponent("dataArea",this.components.dataArea)},getSnapshotSize:function(){var a=0,b=0;return this.rect&&(a=this.rect.width,b=this.rect.height),!this.getSnapshotChartData().hasMiniChart&&this.components.scrollArea.isVisible()&&(this.components.scrollArea.isVertical()?a-=this.components.scrollArea.rect.width:b-=this.components.scrollArea.rect.height),{w:a,h:b}},getSnapshotChartData:function(b){var c=a.extend(!0,this._super()||{},{scrollOffset:b&&b.ignoreReducedData?0:this.components.scrollArea.getOffset(),discreteSpacing:this.components.dimensionAxis.getDiscreteSpacing(),axisInnerOffset:b&&b.ignoreReducedData?0:this.components.dimensionAxis.getInnerOffset(),hasMiniChart:this.components.miniChart&&!!this.components.miniChart.isVisible(),viewRange:this.components.scrollArea.getViewRange()});return b&&b.ignoreReducedData&&this.components.measureAxis.isStacked&&(c.dataRanges=[{min:this.components.measureAxis.getPlotMin(),max:this.components.measureAxis.getPlotMax()}]),c},setSnapshotData:function(b,c){function d(){var a=this.components.scrollArea,c=a.getOffset()/this.scrollMultiplicator,d=Math.round(c),e=this.components.dimensionAxis._discreteSpacing,f=a.getViewRange()/this.scrollMultiplicator,g=Math.round(f-(d-c)),h=Math.min(8,e/2),i=this._pagingInfo.y;if(isNaN(g)&&(g=10),this._data.barGrouping&&"grouped"===this._data.barGrouping.grouping&&this._data.qHyperCube.qMeasureInfo.length>1){d=Math.floor(c),g=Math.ceil(f-(d-c)),b.snapshotData.content.chartData.scrollOffset=a.getOffset()%this.scrollMultiplicator;d=(Math.ceil(c)-c)*e*this.scrollMultiplicator-e/2<h?Math.ceil(c):Math.floor(c),g=Math.round(c+f);var j=c+f;j=(j-Math.floor(j))*e*this.scrollMultiplicator-e/2<h?Math.floor(j):Math.ceil(j),g=j-d}else if(this._data.barGrouping&&"grouped"===this._data.barGrouping.grouping&&this._data.qHyperCube.qDimensionInfo.length>1){var k=this.components.dataArea._tree;if(d=Math.max(Math.round(c-.5),i),g=Math.round(this.components.dimensionAxis.getNumDiscreteUnitsInView()-(d-(c-.5))),k){var l,m=0,n=0,o=0,p=i;if(i!==d){for(m=0;m<k.children.length&&p<d;m++,p++)for(l=k.children[m],n=0;n<l.children.length&&p<d;n++,++p)o++;d=i+o,m=Math.max(0,m-1),n=Math.max(0,n-1)}for(o=0,p=0;m<k.children.length&&p<g;m++,p++){for(l=k.children[m],n;n<l.children.length&&p<g;n++,++p)o++;n=0}g=o}else g*=2}return{qTop:d,qLeft:0,qWidth:this._data.qHyperCube.qSize.qcx,qHeight:g||0}}this._super(b,c);var e,f=r();if(!c||!c.ignoreReducedData)return this.isDimensionContinuous&&(b.qHyperCube.qDataPages=this._data.qHyperCube.qDataPages,b.qHyperCube.qAxisData=this._data.qHyperCube.qAxisData),this.components.miniChart.isVisible()||delete b.reducedHyperCube,f.resolve(b),f.promise;if(delete b.reducedHyperCube,this.isDimensionContinuous)return e=b.qHyperCube,e.qDataPages=[a.extend(!0,{},this._data.qHyperCube.qDataPages[0])],this._upperFocusIndex?e.qDataPages[0].qMatrix=e.qDataPages[0].qMatrix.slice(this._lowerFocusIndex,this._upperFocusIndex+1):e.qDataPages[0].qMatrix=e.qDataPages[0].qMatrix,e.qAxisData=this._cachedFocusAxisData,e.qDimensionInfo[0].qMin=this._activeDimAxis.getPlotMin(),e.qDimensionInfo[0].qMax=this._activeDimAxis.getPlotMax(),f.resolve(b),f.promise;if(e=b.qHyperCube,this.providers.colorMap&&this.providers.colorMap.getColorDataInfo()&&(b.color.persistent=!!this.providers.colorMap.getColorDataInfo().persistentColors),"K"===e.qMode){var g=new s;g.store(e.qStackedDataPages);var h=g.get([d.call(this)]);e.qSize.qcy=h[0].qArea.qHeight,h[0]&&h[0].qData[0]&&(h[0].qData[0].qDown=0,h[0].qData[0].qUp=0),e.qStackedDataPages=h,f.resolve(b)}else this.backendApi.getData([d.call(this)]).then(function(a){"S"===e.qMode?e.qDataPages=a:e.qStackedDataPages=a,e.qSize.qcy=a[0].qArea.qHeight,e.qDimensionInfo[0].qStateCounts&&(e.qDimensionInfo[0].qStateCounts.qOption=e.qSize.qcy,e.qDimensionInfo[0].qStateCounts.qSelected=0),f.resolve(b)});return f.promise},getViewState:function(){return this.isDimensionContinuous?null:{scrollOffset:this.components.scrollArea.getOffset(),axisInnerOffset:this.components.dimensionAxis.getInnerOffset()}},checkPage:function(a){if(!this.isValid(this._data)||!this._pagingMode)return!1;var b=this.components.scrollArea,c=Math.floor(b.getOffset()/this.scrollMultiplicator),d=this._pagingInfo.y,e=this._pagingInfo.height,f=this._pagingMode===J.TWO_DIM?0:20,g=Math.ceil(b.getViewRange()/this.scrollMultiplicator);return isNaN(g)&&(g=500),this._pagingMode===J.TWO_DIM&&(g*=2),c+g>d+e||Math.max(0,c)<d?this.pageData(Math.floor(Math.max(0,c-f)),g+2*f,a):void 0},pageData:function(a,b,c){if("function"!=typeof this.backendApi.getReducedData)return!1;var d=r();if(this._data.qHyperCube){var e,f=this;e="K"===this._data.qHyperCube.qMode?this._data.qHyperCube.qStackedDataPages[0]&&this._data.qHyperCube.qStackedDataPages[0].qData&&this._data.qHyperCube.qStackedDataPages[0].qData.length>0:this._data.qHyperCube.qDataPages[0]&&this._data.qHyperCube.qDataPages[0].qMatrix.length>0,b<=0?("S"===f._data.qHyperCube.qMode?f._data.qHyperCube.qDataPages=[]:f._data.qHyperCube.qStackedDataPages=[],f._pagingInfo.set(a,0,this._data.qHyperCube.qSize.qcx,b)):this.backendApi.getData([{qTop:a,qLeft:0,qWidth:this._data.qHyperCube.qSize.qcx,qHeight:b}]).then(function(g){if("S"===f._data.qHyperCube.qMode){f._data.qHyperCube.qDataPages=g;var h=g[0].qArea;f._pagingInfo.set(h.qLeft,h.qTop,h.qWidth,h.qHeight)}else f._data.qHyperCube.qStackedDataPages=g,f._pagingInfo.set(0,a,f._data.qHyperCube.qSize.qcx,b);c||!e?(f._chartContext.refresh(f._data),f.paint(f._data).then(function(){d.resolve()})):f.partialUpdate(f._data).then(function(){d.resolve()})})}else d.resolve();return d.promise},partialUpdate:function(a){var b,c,d,e,f=[];F.call(this),this._chartContext.refresh(a),this.providers.colorMap.setData(a),c=a.qHyperCube.qStackedDataPages.length>0?this._pagingInfo.y:a.qHyperCube.qDataPages[0].qArea.qTop,this.components.dimensionAxis.setInnerOffset(c*this.scrollMultiplicator);for(b in this.components)"miniChart"!==b&&b.indexOf("AxisTitle")<0&&this.components[b].invalidateProperties("ScrollableChart.partialUpdate");return this.components.dataArea.updateNow(["properties"]),d=this.components.dataArea.getMajorAxisData(),e=this.components.dataArea.getMinorAxisData(),!e||this._readStoredData&&this.getSnapshotStoredChartData().dataRanges||this.components.measureAxis.setDataRange(e.min,e.max),this.components.dimensionAxis.setDataRange(d.data,d.info),this.components.colorLegend.updateNow(["properties"]),this.components.dimensionAxis.updateLevels(),f.push(this.components.dataArea.invalidateDisplay("ScrollableChart.partialUpdate")),
f.push(this.components.colorLegend.invalidateDisplay("ScrollableChart.partialUpdate")),this.isDimensionContinuous?(f.push(this.components.timeAxis.invalidateDisplay("ScrollableChart.partialUpdate")),f.push(this.components.continuousAxis.invalidateDisplay("ScrollableChart.partialUpdate")),f.push(this.components.measureAxis.invalidateDisplay("ScrollableChart.partialUpdate")),this.layout()):f.push(this.components.dimensionAxis.invalidateDisplay("ScrollableChart.partialUpdate")),r.all(f)},getApproriateNrOfBins:function(a){var b=a.qHyperCube.qMeasureInfo.length||1,c=4+2*(b-1);return a.qHyperCube.qDimensionInfo.length>1&&(b=Math.max(1,Math.min(n.maxNumberOfLines,a.qHyperCube.qDimensionInfo[1].qStateCounts.qLocked+a.qHyperCube.qDimensionInfo[1].qStateCounts.qOption+a.qHyperCube.qDimensionInfo[1].qStateCounts.qSelected)),c=4),Math.ceil(2e3/(b*c))},getHyperCubeContinousData:function(a){if(a.qStart>a.qEnd||isNaN(a.qStart)||isNaN(a.qEnd))return r.resolve({qAxisData:{qAxis:[]},qDataPages:[{qMatrix:[],qTails:!1,qArea:{qLeft:0,qTop:0,qRight:0,qBottom:0}}]});var b=this;return this.backendApi.getHyperCubeContinousData(a,!1).then(function(a){return b.cancelPromises?r.reject():a})},getFullContinousData:function(a,c,d){return this.getHyperCubeContinousData({qStart:c,qEnd:d,qNbrPoints:this.getApproriateNrOfBins(a),qMaxNbrTicks:300,qMaxNumberLines:n.maxNumberOfLines}).then(function(c){return this._cachedContinousMatrix=c.qDataPages[0].qMatrix,a.qHyperCube.qDimensionInfo[0].qIsCyclic||(this._cachedContinousAxisData=c.qAxisData),this._cachedFocusAxisData=b.extend(!0,{},c.qAxisData),this._lowerFocusIndex=null,this._upperFocusIndex=null,c}.bind(this))},getFocusedContinousData:function(a,c,d){return this.getHyperCubeContinousData({qStart:a,qEnd:c,qNbrPoints:this.getApproriateNrOfBins(d),qMaxNbrTicks:300,qMaxNumberLines:n.maxNumberOfLines}).then(function(d){if(this._cachedContinousMatrix&&!this._readStoredData){d.qDataPages[0]&&d.qDataPages[0].qMatrix.length&&(a=Math.min(a,d.qDataPages[0].qMatrix[0][0].qNum),c=Math.max(c,d.qDataPages[0].qMatrix[d.qDataPages[0].qMatrix.length-1][0].qNum));var e=this._cachedContinousMatrix.filter(function(b){return b[0].qNum<a}),f=this._cachedContinousMatrix.filter(function(a){return a[0].qNum>c});d.qDataPages[0].qMatrix=e.concat(d.qDataPages[0].qMatrix,f);var g=m.getFocusRange(d.qDataPages[0].qMatrix,e.length,f.length,this._data.qHyperCube.qDimensionInfo.length);this._lowerFocusIndex=g.lower,this._upperFocusIndex=g.upper}return this._cachedContinousAxisData&&!this._readStoredData&&(this._cachedFocusAxisData=b.extend(!0,{},d.qAxisData),I(a,c,d.qAxisData.qAxis,this._cachedContinousAxisData.qAxis)),d}.bind(this))},updateFocusedContinuousData:function(a,b){var c=this,d=this._data;return this.getFocusedContinousData(a,b,d).then(function(a){d.qHyperCube.qDataPages=a.qDataPages,d.qHyperCube.qAxisData=a.qAxisData;var b=0===d.qHyperCube.qDataPages[0].qMatrix.length;c._activeDimAxis.setLabels(b?[]:d.qHyperCube.qAxisData.qAxis);var e=c._activeDimAxis.getUseTransition();c._activeDimAxis.setUseTransition(!1),c._activeDimAxis.updateSize(),c._activeDimAxis.setUseTransition(e)})},updateFullContinuousData:function(b){var c=m.getFullContinuousRange(b),d=c.min,e=c.max,f=this;return this.getFullContinousData(b,d,e).then(function(c){if(!f.isDimensionContinuous)return b;b=m.addContinuousDataToLayout(b,c);var g=a.extend(!0,{},b);return f.components.miniChart.setData(g,!0),f._activeDimAxis.setDataRange(d,e),f.components.scrollArea.setFullRange(e-d),f.components.scrollArea.setViewRange(e-d),f._activeDimAxis.setPlotMin(d),f._activeDimAxis.setPlotMax(e),p.cancelDebounce(f._debounceUpdateHandle),b})},_updateData:function(a){if(this._super.apply(this,[].slice.call(arguments)),this._pagingInfo.set(0,0,0,0),this.isValid(a)){var b,c=a.qHyperCube.qStackedDataPages[a.qHyperCube.qStackedDataPages.length-1];b=c&&c.qData?c.qData.length?{qLeft:0,qTop:0,qWidth:a.qHyperCube.qSize.qcx,qHeight:c.qData[0].qSubNodes.length}:c.qArea:a.qHyperCube.qDataPages[0].qArea,this._pagingInfo.set(b.qLeft,b.qTop,b.qWidth,b.qHeight),this.components.dimensionAxis.setInnerOffset(b.qTop*this.scrollMultiplicator)}},updateGrid:function(a,b){this._super(a,b),this.components.grid.setAxes(this._activeDimAxis,this.components.measureAxis)},_setActiveDimensionAxis:function(a){var b,c=this.isDimensionContinuous,d=n.isTimeDimension(c,a.qHyperCube.qDimensionInfo[0]);d?(this._activeDimAxis=this.components.timeAxis,b="continuousAxis"):c?(this._activeDimAxis=this.components.continuousAxis,b="continuousAxis"):(this._activeDimAxis=this.components.dimensionAxis,b="dimensionAxis"),this.components.miniChart&&this.components.miniChart.setActiveDimensionAxis(b),this.components.dataArea&&this.components.dataArea.setActiveDimensionAxis(this._activeDimAxis)},updateAxis:function(a){if(this._super.apply(this,[].slice.call(arguments)),this._readStoredData&&this.options.hideChartScrollWithoutMiniChart&&!this.components.scrollArea.getUseMiniChart()?this.components.scrollArea.hideComponent():this.components.scrollArea.showComponent(),this.selections){var b="S"!==a.qHyperCube.qMode||this.isDimensionContinuous&&a.qHyperCube.qDimensionInfo.length>1;B.apply(this,[a.qHyperCube.qDimensionInfo.length,a.qHyperCube.qMeasureInfo.length,b,a.color?a.color.mode:null])}this.tooltips&&this.tooltips.setComponent(["top","bottom"].contains(this.components.dimensionAxis.dock)?"y":"x",this.components.dimensionAxis),this._updateMinDiscreteUnitSize(this.components.dimensionAxis)},updateTimeAxis:function(){if(this.isDimensionContinuous){var a=this._data.qHyperCube.qDimensionInfo[0].qStateCounts,b=a.qLocked+a.qOption+a.qSelected>1;this._disableZoom=!b,n.isTimeDimension(!0,this._data.qHyperCube.qDimensionInfo[0])?(this.components.timeAxis.showComponent(),this.components.continuousAxis.hideComponent(),this.components.timeAxis.setLabels(this._data.qHyperCube.qAxisData?this._data.qHyperCube.qAxisData.qAxis:null)):(this.components.continuousAxis.showComponent(),this.components.timeAxis.hideComponent()),n.hasTimeTag(this._data.qHyperCube.qDimensionInfo[0])?this._activeDimAxis.dimensionFormatter=new q(this.backendApi.localeInfo,this.backendApi.localeInfo.qDateFmt,null,null,"TS"):this._activeDimAxis.dimensionFormatter=this.chartFormatter.getFormattersForMeasures(this._data.qHyperCube.qDimensionInfo,[0])[0],b?this.components.scrollArea.showComponent():this.components.scrollArea.hideComponent(),this.components.dimensionAxis.hideComponent()}else this.components.dimensionAxis.showComponent(),this.components.dimensionAxis.setOffset(this.components.scrollArea.getOffset()),this.components.timeAxis.hideComponent(),this.components.continuousAxis.hideComponent()},_disablePagingTransitions:function(){C.call(this)},_enablePagingTransitions:function(){F.call(this)},_postResize:function(){this._super(),this.components.dimensionAxis&&this._updateMinDiscreteUnitSize(this.components.dimensionAxis)},_updateMinDiscreteUnitSize:function(a){var b=this._data.qHyperCube.qSize.qcy,c=this._data.qHyperCube,d="S"===c.qMode?"qDataPages":"qStackedDataPages";if((c[d]&&c[d][0]?c[d][0].qArea.qHeight:0)>=b&&this.options.components.scrollArea.show===!1)return void a.setMinDiscreteUnitSize(null);!a.isVisible(this._layoutMode)||"title"===this._data.dimensionAxis.show||"all"===this._data.dimensionAxis.show&&"none"===this._data.dimensionAxis.label?this._layoutMode===g.prototype.ShowFlags.SPARK?a.setMinDiscreteUnitSize(7):a.setMinDiscreteUnitSize(20):a.setMinDiscreteUnitSize(28)},layout:function(){var a;if(this.options.components.scrollArea.show===!1){var b=this.components.dimensionAxis;b._hideMyLabels=!1,a=function(){if(b._discreteSpacing*(b._groupSize||1)<20)return b._hideMyLabels=!0,!0}}this._super(this.components.dimensionAxis.isVertical()?"vertical":"horizontal",a),G.call(this)},setIsDimensionContinuous:function(a){this.isDimensionContinuous!==a&&(this.isDimensionContinuous=a,this.components.scrollArea.setAllowResize(a),this._on&&this._navigation&&(this.isDimensionContinuous?(this._scrollController.off(),this._panZoomController.on(this.namespace)):(this._panZoomController.off(),this._scrollController.on())))},on:function(){this._on||(this._super(),this._navigation&&(this.isDimensionContinuous?this._panZoomController.on(this.namespace):this._scrollController.on()))},off:function(){this._on&&(this._navigation&&(this._scrollController.off(),this._panZoomController.off()),this._super())},destroy:function(){this._super(),this.cancelPromises=!0,this._disablePagingTransitions(),this.components.scrollArea.stopListen("scrollStart"),this.components.dimensionAxisTitle.stopListen("drill-up"),this._panZoomController.release(),this.components.timeAxis&&this.components.timeAxis.stopListen("rendered"),this.components.continuousAxis&&this.components.continuousAxis.stopListen("rendered")}})}),define("objects.backend-api/engine-throttle",["core.utils/deferred","core.utils/class","core.utils/notification","util"],function(a,b,c,d){function e(a,b){var c=this;this.queuedRequests.push(a),clearTimeout(this._debounceTimer),b>=10?this._debounceTimer=setTimeout(function(){f.call(c)},b):f.call(c)}function f(){if(this.ongoingRequests.length)return void(this.waitingForResponse=!0);var a=this.queuedRequests.pop();for(a&&g.call(this,a);this.queuedRequests.length;)a=this.queuedRequests.shift(),a.dfd.reject()}function g(a){this.waitingForResponse=!1,this.ongoingRequests.push(a);var b=this,c=a.wrapper;a.sentAt=Date.now(),c.promise.then(function(){b.ongoingRequests.splice(b.ongoingRequests.indexOf(a),1),a.respondedAt=Date.now(),b.resolvedRequests.push({sentAt:a.sentAt,respondedAt:a.respondedAt,requestedAt:a.requestedAt}),b.resolvedRequests.length>10&&(b.resolvedRequests=b.resolvedRequests.slice(-10)),a.requestedAt>b._latestResolvedRequestedAt?a.dfd.resolve.apply(a.dfd,[].slice.call(arguments)):a.dfd.reject(),b._latestResolvedRequestedAt=a.requestedAt},function(){b.ongoingRequests.splice(b.ongoingRequests.indexOf(a),1),a.respondedAt=Date.now(),a.dfd.reject.apply(a.dfd,[].slice.call(arguments))}).finally(function(){b.waitingForResponse&&f.call(b)}),this.Send.emit(a.data,c)}var h={enabled:!0,delay:50};return b.extend("Throttle",{init:function(){this.options={},this.ongoingRequests=[],this.queuedRequests=[],this.recentRequests=[],this.resolvedRequests=[],this._debounceTimer=null,this._latestResolvedRequestedAt=-1,c.mixin(this),this.notification("Send"),this.notification("Cancel"),this.setOptions({})},destroy:function(){this.clear(),this.recentRequests=[],this.resolvedRequests=[],c.release(this)},setOptions:function(a){this.options=d.extend(!0,{},h,this.options,a),this.enabled=this.options.enabled||!1,this.delay=this.options.delay||-1},clear:function(){clearTimeout(this._debounceTimer);for(var a;this.queuedRequests.length;)a=this.queuedRequests.pop(),a.dfd.reject();for(;this.ongoingRequests.length;)a=this.ongoingRequests.pop(),a.dfd.reject()},queue:function(b){var c=this.enabled?this.delay:-1,d={data:b,dfd:a(),wrapper:a(),requestedAt:Date.now()},f=Math.max(this._getAvgResolutionTime(),c);return c<1||this.recentRequests.length<1||Date.now()-this.recentRequests.slice(-1)[0].requestedAt>f?e.apply(this,[d,0]):e.apply(this,[d,Math.min(c,1e3)]),this.recentRequests.push(d),this.recentRequests.length>10&&(this.recentRequests=this.recentRequests.slice(-10)),d.dfd.promise},updateResolutionTime:function(){this._latestResolvedRequestedAt=Date.now()},_getAvgResolutionTime:function(){var a;return this.resolvedRequests.length&&(a=0,this.resolvedRequests.forEach(function(b){a+=b.respondedAt-b.sentAt}),a/=this.resolvedRequests.length),a}})}),define("objects.backend-api/cube-slicer",["core.utils/class","general.utils/shapes/rect"],function(a,b){"use strict";var c=new b(0,0,0,0),d=new b(0,0,0,0);return a.extend("CubeSlicer",{init:function(){this.pages=[]},get:function(a){return a.map(function(a){return this.getPage(a)}.bind(this))},getPage:function(a){var e,f,g,h=[];for(f=0;f<this.pages.length;f++)if(e=this.pages[f].qArea,c.set(a.qLeft,a.qTop,a.qWidth,a.qHeight),d.set(e.qLeft,e.qTop,e.qWidth,e.qHeight),g=d.intersection(c,!0),h.push({coverage:g?g.clone():new b(0,0,0,0),idx:f}),e.qLeft<=a.qLeft&&e.qLeft+e.qWidth>=a.qLeft+a.qWidth&&e.qTop<=a.qTop&&e.qTop+e.qHeight>=a.qTop+a.qHeight)return this._extract(a,this.pages[f]);return h.sort(function(a,b){return b.coverage.width*b.coverage.height-a.coverage.width*a.coverage.height}),h[0].coverage.height>0&&h[0].coverage.width>0?this._extract(a,this.pages[h[0].idx]):{qArea:{qTop:a.qTop,qLeft:a.qLeft,qWidth:0,qHeight:0},qMatrix:[]}},destroy:function(){this.clear()},isEmpty:function(){return!(this.pages&&this.pages[0]&&this.pages[0].qArea.qHeight&&this.pages[0].qArea.qWidth)},clear:function(){this.pages=[]},store:function(a){this.pages=a},containsArea:function(a){for(var b,c=0;c<this.pages.length;c++)if(b=this.pages[c].qArea,b.qLeft<=a.qLeft&&b.qLeft+b.qWidth>=a.qLeft+a.qWidth&&b.qTop<=a.qTop&&b.qTop+b.qHeight>=a.qTop+a.qHeight)return!0;return!1},contains:function(a){return!(!this.pages||!this.pages.length)&&0===a.filter(function(a){return!this.containsArea(a)}.bind(this)).length},_extract:function(a,b){c.set(a.qLeft,a.qTop,a.qWidth,a.qHeight),d.set(b.qArea.qLeft,b.qArea.qTop,b.qArea.qWidth,b.qArea.qHeight);var e,f,g,h=c.intersection(d,!0);return h?(g=Math.max(0,a.qTop-b.qArea.qTop),f=Math.max(0,a.qLeft-b.qArea.qLeft),e=b.qMatrix.slice(g,g+h.height).map(function(a){return a.slice(f,f+h.width)}),{qArea:{qTop:h.y,qLeft:h.x,qWidth:h.width,qHeight:h.height},qMatrix:e}):{qArea:{qTop:a.qTop,qLeft:a.qLeft,qWidth:0,qHeight:0},qMatrix:[]}}})}),define("objects.backend-api/pivot-cube-slicer",["./cube-slicer","general.utils/shapes/rect"],function(a,b){"use strict";function c(a,b){var c,d={};for(c in a)"qSubNodes"!==c&&a.hasOwnProperty(c)&&(d[c]=a[c]);return b.push(d),d}function d(a,b,e){var g,h,i,j=[],k=[],l=0,m=0;for(e.length&&(l=e[0].qUp||0,m=e[e.length-1].qDown||0),g=0;g<e.length;++g)if(h=e[g],h.qSubNodes.length>0&&(k=d(a,b,h.qSubNodes)),i=null,(0===h.qSubNodes.length&&f>=a&&f<=a+b||k.length>0)&&(i=c(h,j),void 0!==i.qUp&&1===j.length&&(i.qUp=l+g),i.qSubNodes=k),0===h.qSubNodes.length&&f++,f===a+b){i&&void 0!==i.qDown&&(i.qDown=m+(e.length-1-g));break}return j}function e(a,b,c){return f=0,d(a,b,c)}var f,g=new b(0,0,0,0),h=new b(0,0,0,0);return a.extend("PivotCubeSlicer",{init:function(){this._super(),this.requestedAreas=[]},getPage:function(a){var c,d,e,f=[];for(d=0;d<this.pages.length;d++)if(c=this.pages[d].qArea,g.set(a.qLeft,a.qTop,a.qWidth,a.qHeight),h.set(c.qLeft,c.qTop,c.qWidth,c.qHeight),e=h.intersection(g,!0),f.push({coverage:e?e.clone():new b(0,0,0,0),idx:d}),c.qLeft<=a.qLeft&&c.qLeft+c.qWidth>=a.qLeft+a.qWidth&&c.qTop<=a.qTop&&c.qTop+c.qHeight>=a.qTop+a.qHeight)return this._extract(a,this.pages[d]);return f.sort(function(a,b){return b.coverage.width*b.coverage.height-a.coverage.width*a.coverage.height}),f[0].coverage.height>0&&f[0].coverage.width>0?this._extract(a,this.pages[f[0].idx]):{qLeft:[],qTop:[],qData:[],qArea:{qTop:a.qTop,qLeft:a.qLeft,qWidth:0,qHeight:0}}},_extract:function(a,b){var c,d;g.set(a.qLeft,a.qTop,a.qWidth,a.qHeight),h.set(b.qArea.qLeft,b.qArea.qTop,b.qArea.qWidth,b.qArea.qHeight);var f,i,j,k=g.intersection(h,!0);return k?(j=Math.max(0,a.qTop-b.qArea.qTop),i=Math.max(0,a.qLeft-b.qArea.qLeft),f=b.qData.slice(j,j+k.height).map(function(a){return a.slice(i,i+k.width)}),c=e(j,k.height,b.qLeft),d=e(i,k.width,b.qTop),{qLeft:c,qTop:d,qData:f,qArea:{qTop:k.y,qLeft:k.x,qWidth:k.width,qHeight:k.height}}):{qLeft:[],qTop:[],qData:[],qArea:{qTop:a.qTop,qLeft:a.qLeft,qWidth:0,qHeight:0}}}})}),define("objects.backend-api/cache-cube",["core.utils/class","util","core.utils/deferred","objects.backend-api/engine-throttle","objects.backend-api/cube-slicer","objects.backend-api/pivot-cube-slicer"],function(a,b,c,d,e,f){var g={mode:"S",enabled:!0,debouncing:{enabled:!0,delay:50},height:250,width:250,maxTotalArea:1e4};return a.extend("CacheCube",{init:function(a,b,c,g){this.model=a,this.responseProperty=b,this.options={},this.cubeHeight=0,this.cubeWidth=0,this.setOptions(g||{}),this.setPath(c),"P"===this.options.mode?this.cube=new f:this.cube=new e,this.throttle=new d;var h=this;this.throttle.Send.bind(function(a,b){var c=h._getDirections(h.throttle.recentRequests.map(function(a){return{top:a.data[0].qTop,left:a.data[0].qLeft}})),d=h._getAreasToCache(a,c.vertical,c.horizontal);h.cacheData(d,a).then(function(a){h.cube?b.resolve(a):b.reject()},function(){b.reject()})}),this._modelBinding=function(){h.clear()},this.model.Invalidated.bind(this._modelBinding)},destroy:function(){this.cube.destroy(),this.throttle.destroy(),this.model&&this.model.Invalidated&&this.model.Invalidated.unbind(this._modelBinding),this._modelBinding=null,delete this.model,delete this.throttle,delete this.cube},setMethodName:function(a){this.method=a},setPath:function(a){this.path=a},setCubeSize:function(a){this.cubeHeight=a.qcy,this.cubeWidth=a.qcx},setOptions:function(a){a&&(this.options=b.extend(!0,{},g,this.options,a),this.cacheHeight=this.options.height,this.cacheWidth=this.options.width,this.enabled=this.options.enabled||!1,this.debouncing={enabled:this.options.debouncing.enabled||!1,delay:this.options.debouncing.delay||-1})},clear:function(){this.cube.clear(),this.throttle.clear()},set:function(a){this.clear(),a&&a.length&&this.cube.store(a)},cacheData:function(a,b){return this.model[this.method](this.path,a).then(function(a){return this.cube?(this.cube.store(a),this.cube.get(b)):a}.bind(this))},getData:function(a){if(!this.model)return c.reject();if(!this.enabled||!this.cubeHeight||!this.cubeWidth)return this.model[this.method](this.path,a);var b,d,e=[];for(b=0;b<a.length;++b)d=a[b],e.push({qTop:Math.max(Math.floor(d.qTop),0),qLeft:Math.max(d.qLeft,0),qHeight:Math.min(d.qHeight,this.cubeHeight-Math.floor(d.qTop)),qWidth:Math.min(d.qWidth,this.cubeWidth-d.qLeft)});return this.cube.contains(e)?(this.throttle.updateResolutionTime(),c.resolve(this.cube.get(e))):0===e[0].qTop&&this.cube.isEmpty()?(this.throttle.updateResolutionTime(),this.cacheData(e,e)):this.throttle.queue(e)},_getDirections:function(a){if(!a||a.length<2)return{vertical:0,horizontal:0};var b=a.slice(-2),c=b[1].top-b[0].top,d=b[1].left-b[0].left;return{vertical:c<0?-1:c>0?1:0,horizontal:d<0?-1:d>0?1:0}},_getAreasToCache:function(a,b,c){var d,e,f,g,h,i,j,k,l,m=[],n=this.cacheHeight;for(void 0===b&&(b=0),void 0===c&&(c=0),this.cacheHeight*this.cacheWidth*a.length>this.options.maxTotalArea&&(n=Math.floor(this.options.maxTotalArea/(a.length*this.cacheWidth))),d=0;d<a.length;++d)e=0!==b?Math.floor(.5*Math.max(0,n-a[d].qHeight)):0,f=0!==c?Math.floor(.5*Math.max(0,this.cacheWidth-a[d].qWidth)):0,g=e*b-e,h=f*c-f,i=0!==b?Math.max(0,Math.min(Math.max(a[d].qHeight,n),this.cubeHeight)):a[d].qHeight,j=0!==c?Math.max(0,Math.min(Math.max(a[d].qWidth,this.cacheWidth),this.cubeWidth)):a[d].qWidth,k=Math.max(0,Math.min(a[d].qTop+g,this.cubeHeight-i)),l=Math.max(0,Math.min(a[d].qLeft+h,this.cubeWidth-j)),m.push({qTop:k,qHeight:i,qLeft:l,qWidth:j});return m}})}),define("objects.backend-api/backend-throttle",["core.utils/class","util","objects.backend-api/engine-throttle"],function(a,b,c){var d={enabled:!0,debouncing:{enabled:!0,delay:50}};return a.extend({init:function(a,b,d){this.model=a,this.responseProperty=b,this.options={},this.setOptions({}),this.setPath(d),this.throttle=new c,this.throttle.Send.bind(function(a,b){e.model[e.method](e.path,a).then(function(a){b.resolve(a)},function(){b.reject()})});var e=this;this._modelBinding=function(){e.clear()},this.model.Invalidated.bind(this._modelBinding)},setMethodName:function(a){this.method=a},setPath:function(a){this.path=a},setOptions:function(a){this.options=b.extend(!0,{},d,this.options,a),this.enabled=this.options.enabled||!1,this.debouncing={enabled:this.options.debouncing.enabled||!1,delay:this.options.debouncing.delay||-1}},clear:function(){this.throttle.clear()},destroy:function(){this.throttle.destroy(),this.model&&this.model.Invalidated&&this.model.Invalidated.unbind(this._modelBinding),this._modelBinding=null,delete this.model,delete this.throttle},set:function(){this.clear()},getData:function(a){return this.enabled?this.throttle.queue(a):this.model[this.method](this.path,a)}})}),define("objects.backend-api/backend-api",["jquery","core.utils/class","core.utils/deferred","./cache-cube","./backend-throttle"],function(a,b,c,d,e){"use strict";return b.extend("BackendApi",{init:function(a,b,c){this.model=a,this.localeInfo=a.session.currentApp?a.session.currentApp.layout.qLocaleInfo:{},this.path=b,b&&(this.dataPath=b.slice(1,-3)),this.cacheCube=new d(a,"qDataPages",this.path,c),this.backendStackThrottle=new e(a,"qDataPages",this.path)},setPath:function(a){this.path=a,a&&(this.dataPath=a.slice(1,-3)),this.cacheCube.setPath(a),this.backendStackThrottle.setPath(a)},setCacheOptions:function(a){this.cacheCube.setOptions(a)},updateCache:function(){},applyPatches:function(a,b){return this.model.applyPatches(a,b)},clearSoftProperties:function(){var a=this;return this.model.getLayout().then(function(b){return b.qHasSoftPatches?a.model.clearSoftPatches():c.resolve()})},beginSelections:function(){return this.model.app.switchModalSelection(this.model,this.path)},endSelections:function(a){return this.model.app.switchModalSelection(null,null,a)},clearSelections:function(a){return a=a||0,this.model.clearSelections(this.path,[a])},getDimensionInfos:function(){return this.model.layout[this.dataPath].qDimensionInfo?Array.isArray(this.model.layout[this.dataPath].qDimensionInfo)?this.model.layout[this.dataPath].qDimensionInfo:[this.model.layout[this.dataPath].qDimensionInfo]:[]},getMeasureInfos:function(){return this.model.layout[this.dataPath].qMeasureInfo},getRowCount:function(){return this.model.layout[this.dataPath].qSize.qcy},eachDataRow:function(b){var c=this.model.layout[this.dataPath],d=!0;c&&a.each(c.qDataPages,function(c,e){return a.each(e.qMatrix,function(a,c){return d=b(e.qArea.qTop+a,c)}),d})},drillUp:function(a,b){return this.model.drillUp(this.path,a,b)},hasSelections:function(){for(var a=this.getDimensionInfos(),b=0;b<a.length;++b)if(a[b].qStateCounts.qSelected>0)return!0;return!1},inSelections:function(){return this.model.layout.qSelectionInfo&&this.model.layout.qSelectionInfo.qInSelections},destroy:function(){this.cacheCube.destroy(),this.backendStackThrottle.destroy()},getSize:function(){return this.model.layout[this.dataPath].qSize}})}),define("objects.backend-api/hypercube-api",["./backend-api"],function(a){"use strict";return a.extend("HyperCube",{init:function(a){this._super(a,"/qHyperCubeDef"),this.cacheCube.setMethodName("getHyperCubeData")},updateCache:function(a){a&&a.qHyperCube?(this.cacheCube.set(a.qHyperCube.qDataPages),this.cacheCube.setCubeSize(a.qHyperCube.qSize)):this.cacheCube.clear()},getData:function(a,b){return b?this.model.getHyperCubeData(b,a):this.cacheCube.getData(a)},getHyperCubeBinnedData:function(a,b,c,d){return this.model.getHyperCubeBinnedData(this.path,a,{width:0,height:0},b,c,d,0)},getHyperCubeContinousData:function(a,b){return this.model.getHyperCubeContinuousData(this.path,a,b)},getReducedData:function(a,b,c){return c=void 0!==c?c:"D1",this.model.getHyperCubeReducedData(this.path,a,b,c)},selectDimensionRange:function(a){var b=a.map(function(a){return{qDimIx:a.idx,qRange:{qMin:a.range.min,qMax:a.range.max,qMinInclEq:!0,qMaxInclEq:a.range.maxIncluded}}});return this.model.selectHyperCubeContinuousRange(this.path,b)},selectRange:function(a,b,c){var d;return b=!!b,c=c||[],d=a.map(function(a){return{qMeasureIx:a.idx,qRange:{qMin:a.range.min,qMax:a.range.max,qMinInclEq:a.range.minInclEq!==!1,qMaxInclEq:a.range.maxInclEq!==!1}}}),this.model.rangeSelectHyperCubeValues(this.path,d,c,b)},selectRects:function(a,b){var c;return b=b||[],c=a.map(function(a){var c=a[0],d=a[1];return{qRanges:[{qMeasureIx:c.idx,qRange:{qMin:c.range.min,qMax:c.range.max,qMinInclEq:c.range.minInclEq!==!1,qMaxInclEq:c.range.maxInclEq!==!1}},{qMeasureIx:d.idx,qRange:{qMin:d.range.min,qMax:d.range.max,qMinInclEq:d.range.minInclEq!==!1,qMaxInclEq:d.range.maxInclEq!==!1}}],qColumnToSelect:b}}),this.model.multiRangeSelectHyperCubeValues(this.path,c,!1)},select:function(a,b){return this.model.selectHyperCubeCells(this.path,a,b)},selectValues:function(a,b,c,d){return this.model.selectHyperCubeValues(d||this.path,a,b,c)},getProperties:function(){return this.model.getProperties()},getDimensionInfos:function(){return this.model.layout.qHyperCube.qDimensionInfo},getMeasureInfos:function(){return this.model.layout.qHyperCube.qMeasureInfo},clearSelections:function(){return this.model.resetMadeSelections()},hasSelections:function(){return this.model.layout.qSelectionInfo.qMadeSelections}})}),define("objects.backend-api/stacked-api",["./hypercube-api"],function(a){"use strict";function b(a,b,c){var d,e,f,g=[];for(e=0;e<b.length;e++)for(d=0;d<a.length;d++)f={qType:c,qCol:b[e],qRow:a[d]},g.push(f);return g}return a.extend("StackedApi",{init:function(){this._super.apply(this,arguments),this.backendStackThrottle.setMethodName("getHyperCubeStackData")},updateCache:function(a){a&&a.qHyperCube&&"S"===a.qHyperCube.qMode?(this.cacheCube.set(a.qHyperCube.qDataPages),this.cacheCube.setCubeSize(a.qHyperCube.qSize)):this.cacheCube.clear(),this.backendStackThrottle.clear()},getData:function(a,b,c){switch((c||this.model.layout.qHyperCube).qMode){case"P":return this.model.getHyperCubePivotData(this.path,a);case"S":return this._super(a,b);case"K":return b?this._super(a,b):this.backendStackThrottle.getData(a);default:return this._super(a,b)}},getReducedData:function(a,b,c){return c=void 0!==c?c:"D1",this.model.getHyperCubeReducedData(this.path,a,b,c)},select:function(a,c,d){switch(this.model.layout.qHyperCube.qMode){case"P":case"K":return this.model.selectPivotCells(this.path,b(a,c,d));default:return this.model.selectHyperCubeCells(this.path,a,c)}}})}),define("objects.views/charts/disclaimers/chart-utils",["util"],function(a){function b(a,b){var c,d,e,f,g,h=b.length;for(a&&(d=!(a.autoMinMax||"min"!==a.minMax&&"minMax"!==a.minMax||null===a.min||isNaN(a.min)),e=!(a.autoMinMax||"max"!==a.minMax&&"minMax"!==a.minMax||null===a.max||isNaN(a.max))),f=Number.MAX_VALUE,g=-Number.MAX_VALUE,c=0;c<h;c++)if(f=Math.min(f,b[c].qMin),g=Math.max(g,b[c].qMax),f<=0&&g>=0)return!0;return f=d?a.min:f,g=e?a.max:g,f<=0&&g>=0}return{applyDisclaimerAttributes:function(c,d,e,f,g){d||(d={});var h=a.extend({limitedData:!1,hasNegativeOrZeroData:!1,onlyNegativeOrZero:!1,onlyNanData:!1,onlyNullColor:!1,hasDataRangeIncludingZero:!1},d);return a.extend(d,h),d.noDataExist=g.qHyperCube.qSize.qcy*g.qHyperCube.qSize.qcx==0,d.noDataExist?(e.toggleClass("qv-viz-with-disclaimer",!1),d):(c=c||{},c.overlay=c.overlay||!1,c.supportNegative=void 0===c.supportNegative||c.supportNegative,c.supportRangeOverZero=void 0===c.supportRangeOverZero||c.supportRangeOverZero,g.qHyperCube.qDataPages[0]&&c.explicitLimitedData!==!0?d.limitedData=!c.paging&&g.qHyperCube.qSize.qcy>g.qHyperCube.qDataPages[0].qMatrix.length:d.limitedData=c.explicitLimitedData===!0,d.hasNegativeOrZeroData=!c.supportNegative&&g.qHyperCube.qMeasureInfo.some(function(a){return a.qMin<=0}),d.onlyNegativeOrZero=!c.supportNegative&&g.qHyperCube.qMeasureInfo.every(function(a){return a.qMax<=0&&a.qMax>=a.qMin})||0===g.qHyperCube.qSize.qcy,d.onlyNanData=g.qHyperCube.qMeasureInfo.every(function(a){return a.qMax<a.qMin||"NaN"===a.qMax}),d.hasDataRangeIncludingZero=!c.supportRangeOverZero&&b(g.measureAxis,g.qHyperCube.qMeasureInfo,g.lineType),d.onlyNegativeOrZero&&c.overlay||!(d.limitedData||d.hasNegativeOrZeroData&&!c.supportNegative||d.hasDataRangeIncludingZero||d.onlyNullColor)?(e.toggleClass("qv-viz-with-disclaimer",!1),f.options.showDisclaimerStar=!1):(e.toggleClass("qv-viz-with-disclaimer",c.bottom),f.options.showDisclaimerStar=!0),d)}}}),define("text!extensions.qliktech/barchart/barchart.ng.html",[],function(){return'<div class="qv-viz"></div>\n<span class="qv-viz-center-disclaimer" ng-if="dataAttributes.noDataExist  && dataAttributes.layoutMode > 2" q-translation="Object.Disclaimer.NoDataExist" q-title-translation="Object.Disclaimer.NoDataExist" dir="ltr"></span>\n<div qva-chart-disclaimer attributes="dataAttributes" visible="!dataAttributes.noDataExist" direction="options.direction"></div>'}),define("objects.extension/export-format",[],function(){"use strict";function a(a){a=void 0!==a?a:1,this.data=[];for(var b=0;b<a;++b)this.data.push({dimensions:[],measures:[],excludedDimensions:[],excludedMeasures:[],interColumnSortOrder:[]});this.properties={}}return a}),define("client.property-panel/default-sorting-properties",["client.utils/property-resolver"],function(a){var b=[{value:"ascending",translation:"properties.sorting.ascending"},{value:"descending",translation:"properties.sorting.descending"}];return{type:"array",component:"sorting",translation:"properties.sorting",sortIndexRef:"qHyperCubeDef.qInterColumnSortOrder",allowMove:!0,schemaIgnore:!0,items:{dimensions:{type:"items",component:"expandable-items",ref:"qHyperCubeDef.qDimensions",items:{autoSort:{ref:"qDef.autoSort",type:"boolean",translation:"properties.sorting",component:"switch",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}],change:function(a,b){if(a.qDef.autoSort)return b.autoSortDimension(a).then(function(){})}},dimension:{component:"sorting-dimension",type:"items",ref:"",items:{dimensionDefinition:{type:"items",grouped:!0,items:{expression:{type:"items",items:{expressionToggled:{type:"boolean",ref:"qSortByExpression",translation:"properties.sorting.sortByExpression",resolveFunctions:"booleanToSortInteger"},expression:{type:"number",component:"expression",expressionType:"ValueExpr",ref:"qExpression",translation:"Common.Expression",defaultValue:"",show:function(b){return 0!==a.getValue(b,"qSortByExpression",0)}},expressionOrder:{type:"string",component:"dropdown",ref:"qSortByExpression",options:b,resolveFunctions:"enumToSortInteger",show:function(b){return 0!==a.getValue(b,"qSortByExpression",0)}}}},frequency:{type:"items",show:!1,items:{frequencyToggled:{type:"boolean",ref:"qSortByFrequency",translation:"properties.sorting.sortByFrequency",resolveFunctions:"booleanToSortInteger"},frequencyOrder:{type:"string",component:"dropdown",ref:"qSortByFrequency",options:b,resolveFunctions:"invertedEnumToSortInteger",show:function(b){return 0!==a.getValue(b,"qSortByFrequency",0)}}}},numeric:{type:"items",items:{numericToggled:{type:"boolean",ref:"qSortByNumeric",translation:"properties.sorting.sortByNumeric",defaultSort:-1,resolveFunctions:"booleanToSortInteger"},numericOrder:{type:"string",component:"dropdown",ref:"qSortByNumeric",options:b,resolveFunctions:"enumToSortInteger",show:function(b){return 0!==a.getValue(b,"qSortByNumeric",0)}}}},ascii:{type:"items",items:{asciiToggled:{type:"boolean",ref:"qSortByAscii",translation:"properties.sorting.sortByAlphabetic",resolveFunctions:"booleanToSortInteger"},asciiOrder:{type:"string",component:"dropdown",ref:"qSortByAscii",options:b,resolveFunctions:"enumToSortInteger",show:function(b){return 0!==a.getValue(b,"qSortByAscii",0)}}}},defaultSortMessage:{component:"text",translation:"properties.sorting.defaultSortingMessage",show:function(a){return!(a.qSortByAscii||a.qSortByNumeric||a.qSortByExpression||a.qSortByFrequency)}}}}}}}},measures:{type:"items",component:"expandable-items",grouped:!0,ref:"qHyperCubeDef.qMeasures",items:{autoSort:{ref:"qDef.autoSort",type:"boolean",translation:"properties.sorting",component:"switch",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}],change:function(a,b){if(a.qDef.autoSort)return b.autoSortMeasure(a).then(function(){})}},numeric:{type:"items",show:function(a){return!a.qDef.autoSort},items:{numericToggled:{type:"boolean",ref:"qSortBy.qSortByNumeric",translation:"properties.sorting.sortByNumeric",defaultSort:-1,resolveFunctions:"booleanToSortInteger"},numericOrder:{type:"string",component:"dropdown",ref:"qSortBy.qSortByNumeric",options:b,
resolveFunctions:"enumToSortInteger",show:function(b){return 0!==a.getValue(b,"qSortBy.qSortByNumeric",0)}}}},ascii:{type:"items",show:function(a){return!a.qDef.autoSort},items:{asciiToggled:{type:"boolean",ref:"qSortBy.qSortByAscii",translation:"properties.sorting.sortByAlphabetic",resolveFunctions:"booleanToSortInteger"},asciiOrder:{type:"string",component:"dropdown",ref:"qSortBy.qSortByAscii",options:b,resolveFunctions:"enumToSortInteger",show:function(b){return 0!==a.getValue(b,"qSortBy.qSortByAscii",0)}}}},defaultSortMessage:{component:"text",translation:"properties.sorting.defaultSortingMessage",show:function(b){var c;return!b.qDef.autoSort&&(c=a.getValue(b,"qSortBy",{}),!(c.qSortByAscii||c.qSortByNumeric||c.qSortByFrequency))}}}}}}}),define("client.property-panel/default-axis-properties-logic",["translator","objects.utils/continuous-utils"],function(a,b){function c(a){return!(a&&a.orientation&&!b.isContinuousChart(a))||"vertical"===a.orientation}function d(a,b){return b?b.getDimensionLayouts():a&&a.qHyperCubeDef?a.qHyperCubeDef.qDimensions.map(function(a){return a.qDef}):[]}function e(a,b){return b?b.getMeasureLayouts():a.qHyperCubeDef.qMeasures.map(function(a){return a.qDef})}function f(b,e){var f="y",g=d(b,e).map(function(a){return a&&a.qFallbackTitle?a.qFallbackTitle:""}).join(", ");return c(e&&e.layout)&&(f="x"),g?a.get("properties."+f+"AxisWithInfo",[g]):a.get("properties."+f+"Axis")}function g(a,b){return{ref:a+".dock",translation:"Common.Position",type:"string",component:"dropdown",defaultValue:"near",options:function(a,d,e){var f,g,i;if(b&&b.direction)i=b.direction;else{var j=c(e.layout);i=j&&b&&!b.major||!j&&b&&b.major?"y":"x"}return"x"===i?(f=h.bottom,g=h.top):(f=e.yMirrorMode?h.right:h.left,g=e.yMirrorMode?h.left:h.right),[{value:"near",translation:f},{value:"far",translation:g}]},show:function(b){return b[a]&&"none"!==b[a].show}}}var h={left:"properties.dock.left",right:"properties.dock.right",bottom:"Common.Bottom",top:"Common.Top"};return{isVertical:c,getDimensions:d,getMeasures:e,dimensionAxisLabelFn:f,getAxisDockProperties:g,dockStringMap:h}}),define("client.property-panel/default-axis-properties",["translator","objects.utils/continuous-utils","client.property-panel/default-axis-properties-logic"],function(a,b,c){var d={type:"items",items:{autoMinMax:{ref:"measureAxis.autoMinMax",type:"boolean",translation:"properties.axis.range",component:"switch",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}]},minMax:{type:"string",component:"dropdown",ref:"measureAxis.minMax",options:[{translation:"properties.axis.min",value:"min"},{translation:"Common.Max",value:"max"},{translation:"properties.axis.minMax",value:"minMax"}],defaultValue:"min",show:function(a){return a.measureAxis&&!a.measureAxis.autoMinMax}},min:{ref:"measureAxis.min",translation:"properties.axis.min",expression:"optional",type:"number",show:function(a){return a.measureAxis&&["min","minMax"].contains(a.measureAxis.minMax)&&!a.measureAxis.autoMinMax},invalid:function(a){return!(!a.measureAxis||"minMax"!==a.measureAxis.minMax)&&a.measureAxis.min>=a.measureAxis.max}},max:{ref:"measureAxis.max",translation:"Common.Max",expression:"optional",type:"number",defaultValue:10,show:function(a){return a.measureAxis&&["max","minMax"].contains(a.measureAxis.minMax)&&!a.measureAxis.autoMinMax},invalid:function(a){return!(!a.measureAxis||"minMax"!==a.measureAxis.minMax)&&a.measureAxis.min>=a.measureAxis.max}}}};return{measureAxis:{type:"items",label:a.get("properties.yAxis"),grouped:!0,items:{axis:{type:"items",items:{show:{type:"string",component:"dropdown",ref:"measureAxis.show",translation:"properties.axis.labelsAndTitle",options:[{value:"all",translation:"properties.axis.show.all"},{value:"labels",translation:"properties.axis.show.labels"},{value:"title",translation:"properties.axis.show.title"},{value:"none",translation:"Common.None"}],defaultValue:"all"},dock:c.getAxisDockProperties("measureAxis"),spacing:{ref:"measureAxis.spacing",translation:"properties.axis.scale",type:"number",component:"dropdown",defaultValue:1,options:[{value:2,translation:"properties.gridLine.wide"},{value:1,translation:"properties.gridLine.medium"},{value:.5,translation:"properties.gridLine.narrow"}],show:function(a){return a.measureAxis&&"none"!==a.measureAxis.show}}}},minMax:d}},flippableMeasureAxis:{uses:"axis.measureAxis",label:function(b,d){var e="x",f=c.getMeasures(b,d).map(function(a){return a.qFallbackTitle}).join(", ");return c.isVertical(d.layout)&&(e="y"),f?a.get("properties."+e+"AxisWithInfo",[f]):a.get("properties."+e+"Axis")},items:{axis:{type:"items",items:{show:{snapshot:{title:function(b){return a.get("properties."+this.getXYAxis(b)+"Axis")},getXYAxis:function(a){return c.isVertical(a)?"y":"x"},group:!1,tid:function(a){return"property-"+this.getXYAxis(a)+"Axis"}}},dock:{options:function(a,b,d){var e,f;return c.isVertical(b.layout)?(e=d.yMirrorMode?"properties.dock.right":"properties.dock.left",f=d.yMirrorMode?"properties.dock.left":"properties.dock.right"):(e="Common.Bottom",f="Common.Top"),[{value:"near",translation:e},{value:"far",translation:f}]}}}}}},dimensionAxis:{type:"items",label:c.dimensionAxisLabelFn,grouped:!0,items:{continuousGroup:{type:"items",items:{auto:{ref:"dimensionAxis.continuousAuto",translation:"properties.axis.continuous",type:"boolean",component:"switch",defaultValue:!0,undefinedValue:!1,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}]},preferContinuous:{type:"boolean",ref:"preferContinuousAxis",translation:"properties.axis.preferContinuous",defaultValue:!0,undefinedValue:!1,show:function(a){return!a.dimensionAxis.continuousAuto},readOnly:function(a,c,d){return!b.canBeContinuousChart(d.layout)}}}},othersGroup:{type:"items",items:{show:{type:"string",component:"dropdown",ref:"dimensionAxis.show",translation:"properties.axis.labelsAndTitle",options:[{value:"all",translation:"properties.axis.show.all"},{value:"labels",translation:"properties.axis.show.labels"},{value:"title",translation:"properties.axis.show.title"},{value:"none",translation:"Common.None"}],defaultValue:"all",snapshot:{title:function(b){return a.get("properties."+this.getXYAxis(b)+"Axis")},getXYAxis:function(a){return c.isVertical(a)?"x":"y"},group:!1,tid:function(a){return"property-"+this.getXYAxis(a)+"Axis"}}},label:{type:"string",component:"dropdown",ref:"dimensionAxis.label",translation:"properties.axis.labelOrientation",options:[{value:"auto",translation:"Common.Auto"},{value:"horizontal",translation:"Common.Horizontal"},{value:"tilted",translation:"properties.labels.tilted"}],defaultValue:"auto",show:function(a,d,e){return c.isVertical(e.layout)&&a.dimensionAxis&&["all","labels"].contains(a.dimensionAxis.show)&&!b.isContinuousChart(e.layout)}},dock:c.getAxisDockProperties("dimensionAxis",{major:!0})}}}},picasso:{dimensionAxis:{type:"items",label:function(){return a.get("properties.yAxis")},items:{dock:c.getAxisDockProperties("dimensionAxis",{direction:"y"})}},measureAxis:{type:"items",label:function(){return a.get("properties.xAxis")},items:{dock:c.getAxisDockProperties("measureAxis",{direction:"x"}),minMax:d,showBounds:{ref:"measureAxis.showBounds",type:"boolean",translation:"properties.axis.showMinMax",defaultValue:!1,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Off"}],show:function(a){return!a.measureAxis.autoMinMax}}}}}}}),define("general.utils/number-formatting",["util"],function(a){function b(a,b,c,d,e){void 0===c&&(c=e.qDecimalSep),void 0===d&&(d=e.qThousandSep);var f,g,h,i,j="";if("F"===a)if(0===b)j="#"+d+"##0";else for(j="#"+d+"##0"+c,h=0;h<b;++h)j+="0";else{for(h=0;h<b;++h)j+="#";b>3&&(i=j.length,f=j.substring(0,i-3),g=j.substr(i-3),j=f+d+g)}return j}return{setNumFmtPattern:function(a,b,c){var d,e={type:b.qType||"U",nDec:"qType"===a?(b.qType,2):"R"===b.qType?b.qnDec||10:"number"==typeof b.qnDec?Math.max(0,b.qnDec):2,thousandSep:b.qThou,decimalSep:b.qDec};d=this._getSeparators(a,"M"===b.qType,e.decimalSep,e.thousandSep,c),void 0!==d.decimal&&(e.decimalSep=d.decimal),void 0!==d.thousand&&(e.thousandSep=d.thousand),b.qType=e.type,b.qnDec=e.nDec,b.qDec=e.decimalSep,b.qThou=e.thousandSep,b.qFmt=this._getPattern(e.type,e.nDec,e.decimalSep,e.thousandSep,c),["D","T","TS","IV"].indexOf(e.type)>=0&&(b.qDec="",b.qThou="")},_getSeparators:function(a,b,c,d,e){var f=c,g=d,h="q"+(b?"Money":"");return"qType"===a?(g=e[h+"ThousandSep"]||"",f=e[h+"DecimalSep"]||"."):"qThou"===a&&void 0===d?(g=e[h+"ThousandSep"]||"",f=c||"."):"qDec"!==a||void 0!==c&&""!==c||(f=e[h+"DecimalSep"]||".",g=d||""),{decimal:f||".",thousand:g||""}},_getPattern:function(b,c,d,e,f){var g;switch(b){case"U":return"";case"I":return"#"+e+"##0";case"R":case"F":return this.getNDecPattern("F",c,d,e,f);case"M":return g=f.qMoneyFmt,f.qMoneyDecimalSep&&(g=g.replace(new RegExp(a.escapeRegExp(f.qMoneyDecimalSep),"g"),d)),f.qMoneyThousandSep&&(g=g.replace(new RegExp(a.escapeRegExp(f.qMoneyThousandSep),"g"),e)),g;case"D":return f.qDateFmt;case"T":return f.qTimeFmt;case"TS":return f.qTimestampFmt;case"IV":return"h:mm:ss";default:return""}},getDefaultNumericFormat:function(a,c){return b("F",2,a.qDec,a.qThou||"",c)},getNDecPattern:b,getNormalizedFormat:function(a,b){var c=a.qDec+a.qThou;return/\u00a0/.test(c)&&!/\u0020/.test(c)?b.replace(/\u0020/g," "):b}}}),define("client.property-panel/default-properties",["client.utils/property-resolver","client.property-panel/default-sorting-properties","client.property-panel/default-axis-properties","general.utils/number-formatting","translator","client.utils/theme/theme-module","general.utils/string-limits","util","client.utils/default-property-logic","core.utils/feature-flags"],function(a,b,c,d,e,f,g,h,i,j){function k(b,c){return a.getValue(b,"qDef.qNumFormat.qFmt")===d.getDefaultNumericFormat(b.qDef.qNumFormat,c?c.localeInfo:"")}function l(b){var c=a.getValue(b,"qDef.qNumFormat.qType");return["R","M","IV"].contains(c)||"U"!==c&&a.getValue(b,"qDef.numFormatFromTemplate",!0)===!1}var m={sorting:b,"dimensions-sorting":b.items.dimensions,"dimension-sorting-items":b.items.dimensions.items.dimension.items.dimensionDefinition.items,"measures-sorting":b.items.measures,axis:c},n=f.get(),o=i.getLogicFor("hard","default");m.general={type:"items",translation:"properties.general",grouped:!0,items:{showTitles:{translation:"properties.showTitles",type:"boolean",ref:"showTitles",component:"switch",defaultValue:!0,options:[{value:!0,translation:"properties.on"},{value:!1,translation:"properties.off"}],snapshot:{tid:"property-showTitles"}},titles:{type:"items",show:function(a){return a.showTitles!==!1},items:{title:{translation:"Common.Title",type:"string",expression:"optional",ref:"title",defaultValue:""},subtitle:{translation:"properties.subtitle",type:"string",expression:"optional",ref:"subtitle",defaultValue:""},footnote:{translation:"properties.footnote",type:"string",expression:"optional",ref:"footnote",defaultValue:""}}},details:{type:"items",show:!0,items:{showDetails:{translation:"properties.showDetails",type:"boolean",ref:"showDetails",component:"switch",defaultValue:!1,options:[{value:!0,translation:"Common.Show"},{value:!1,translation:"properties.hide"}]},allowShowDetailsMessage:{component:"text",translation:"properties.allowShowDetails",style:"hint"}}}}},m.metadata={type:"items",translation:"properties.metadata",schemaIgnore:!0,show:function(a){return"masterobject"===a.qInfo.qType},grouped:!0,items:{name:{translation:"Common.Name",type:"string",ref:"qMetaDef.title",minlength:1,rollbackInvalid:!0,show:function(a){return a.qMetaDef}},description:{translation:"Common.Description",type:"string",component:"textarea",ref:"qMetaDef.description",maxlength:g.description,show:function(a){return a.qMetaDef}},tags:{translation:"Common.Tags",component:"tags",type:"array",ref:"qMetaDef.tags",show:function(a){return a.qMetaDef}}}},m.settings={type:"items",component:"expandable-items",translation:"Common.Appearance",items:{metadata:m.metadata,general:m.general}},m.addons={type:"items",component:"expandable-items",translation:"properties.addons",items:{}},m.dimensions={type:"array",component:"dimensions",translation:"Common.Dimensions",ref:"qHyperCubeDef.qDimensions",disabledRef:"qHyperCubeDef.qLayoutExclude.qHyperCubeDef.qDimensions",min:1,allowAdd:!0,allowRemove:!0,allowMove:!0,addTranslation:"properties.dimensions.add",grouped:!0,items:{libraryId:{type:"string",component:"library-item",libraryItemType:"dimension",ref:"qLibraryId",translation:"Common.Dimension",show:function(a){return a.qLibraryId}},inlineDimension:{component:"inline-dimension",show:function(a){return!a.qLibraryId}},autoSort:{ref:"qDef.autoSort",type:"boolean",defaultValue:!0,show:!1},cId:{ref:"qDef.cId",type:"string",show:!1},nullSuppression:{type:"boolean",ref:"qNullSuppression",defaultValue:!1,translation:"properties.dimensions.showNull",inverted:!0},dimensionLimits:{type:"items",items:{otherMode:{type:"string",component:"dropdown",ref:"qOtherTotalSpec.qOtherMode",translation:"properties.dimensionLimits.limitation",options:[{value:"OTHER_OFF",translation:"properties.dimensionLimits.none"},{value:"OTHER_COUNTED",translation:"properties.dimensionLimits.fixedNumber"},{value:"OTHER_ABS_LIMITED",translation:"properties.dimensionLimits.exactValue"},{value:"OTHER_REL_LIMITED",translation:"properties.dimensionLimits.relativeValue"}],defaultValue:"OTHER_OFF",readOnly:function(a,b){return 0===b.getMeasures().length},change:function(b){var c,d=a.getValue(b,"qOtherTotalSpec.qOtherMode");"OTHER_REL_LIMITED"===d?(c=a.getValue(b,"qOtherTotalSpec.qOtherLimit.qv","0"),c.length&&"%"!==c[c.length-1]&&h.isNumeric(c)&&(b.qOtherTotalSpec.qOtherLimit||a.setValue(b,"qOtherTotalSpec.qOtherLimit",{qv:"0"}),b.qOtherTotalSpec.qOtherLimit.qv=c+"%")):"OTHER_ABS_LIMITED"===d&&(c=a.getValue(b,"qOtherTotalSpec.qOtherLimit.qv","0"),c.length&&"%"===c[c.length-1]&&(b.qOtherTotalSpec.qOtherLimit||a.setValue(b,"qOtherTotalSpec.qOtherLimit",{qv:"0"}),b.qOtherTotalSpec.qOtherLimit.qv=c.substr(0,c.length-1)))}},otherSortMode:{type:"string",component:"buttongroup",ref:"qOtherTotalSpec.qOtherSortMode",options:[{value:"OTHER_SORT_DESCENDING",translation:"Common.Top"},{value:"OTHER_SORT_ASCENDING",translation:"Common.Bottom"}],defaultValue:"OTHER_SORT_DESCENDING",show:function(b,c){return"OTHER_COUNTED"===a.getValue(b,"qOtherTotalSpec.qOtherMode")&&c.getMeasures().length>0}},otherCounted:{component:"expression",expressionType:"ValueExpr",ref:"qOtherTotalSpec.qOtherCounted",defaultValue:{qv:"10"},show:function(b,c){return"OTHER_COUNTED"===a.getValue(b,"qOtherTotalSpec.qOtherMode")&&c.getMeasures().length>0}},otherLimitMode:{type:"string",component:"buttongroup",ref:"qOtherTotalSpec.qOtherLimitMode",options:[{value:"OTHER_GE_LIMIT",label:">=",tooltipTranslation:"properties.greaterOrEqualTo"},{value:"OTHER_GT_LIMIT",label:">",tooltipTranslation:"properties.greaterThan"},{value:"OTHER_LT_LIMIT",label:"<",tooltipTranslation:"properties.lessThan"},{value:"OTHER_LE_LIMIT",label:"<=",tooltipTranslation:"properties.lessOrEqualTo"}],defaultValue:"OTHER_GE_LIMIT",icon:!0,smallIconFont:!0,show:function(b,c){var d=a.getValue(b,"qOtherTotalSpec.qOtherMode");return("OTHER_ABS_LIMITED"===d||"OTHER_REL_LIMITED"===d)&&c.getMeasures().length>0}},otherLimit:{component:"expression",expressionType:"ValueExpr",ref:"qOtherTotalSpec.qOtherLimit",defaultValue:{qv:"0"},show:function(b,c){var d=a.getValue(b,"qOtherTotalSpec.qOtherMode");return("OTHER_ABS_LIMITED"===d||"OTHER_REL_LIMITED"===d)&&c.getMeasures().length>0}},calculatedAgainstMessage:{component:"text",label:function(a,b){var c=b.getMeasureLayouts()[0];return c?e.get("Properties.DimensionLimits.CalculatedAgainst",c.qFallbackTitle):e.get("Properties.DimensionLimits.NoMeasure")},show:function(b){return"OTHER_OFF"!==a.getValue(b,"qOtherTotalSpec.qOtherMode")}}}},others:{type:"items",items:{suppressOther:{type:"boolean",ref:"qOtherTotalSpec.qSuppressOther",translation:"properties.dimensionLimits.showOthers",inverted:!0,defaultValue:!1,show:function(b,c){return"OTHER_OFF"!==a.getValue(b,"qOtherTotalSpec.qOtherMode")&&c.getMeasures().length>0}},othersLabel:{type:"string",expression:"optional",ref:"qDef.othersLabel",translation:"properties.dimensionLimits.othersLabel",defaultValue:function(){return e.get("properties.dimensionLimits.others")},change:function(a){if(a.qDef){var b=a.qDef.othersLabel||"";"object"==typeof b?(b=b.qStringExpression&&b.qStringExpression.qExpr||"",a.qOtherLabel={qv:0===b.indexOf("=")?b:"="+b}):a.qOtherLabel={qv:b}}},show:function(b,c){return!a.getValue(b,"qOtherTotalSpec.qSuppressOther")&&"OTHER_OFF"!==a.getValue(b,"qOtherTotalSpec.qOtherMode")&&c.getMeasures().length>0}},othersLabel2:{type:"string",component:"expression",expressionType:"StringExpr",ref:"qOtherLabel",translation:"properties.dimensionLimits.othersLabel",defaultValue:function(){return e.get("properties.dimensionLimits.others")},show:!1}}}}},m.measures={type:"array",component:"measures",translation:"Common.Measures",ref:"qHyperCubeDef.qMeasures",disabledRef:"qHyperCubeDef.qLayoutExclude.qHyperCubeDef.qMeasures",min:1,allowAdd:!0,allowRemove:!0,allowMove:!0,addTranslation:"properties.measures.add",grouped:!0,items:{libraryId:{type:"string",component:"library-item",libraryItemType:"measure",ref:"qLibraryId",translation:"Common.Measure",show:function(a){return a.qLibraryId}},inlineMeasure:{component:"inline-measure",show:function(a){return!a.qLibraryId}},autoSort:{ref:"qDef.autoSort",type:"boolean",defaultValue:!0,show:!1},cId:{ref:"qDef.cId",type:"string",show:!1},numberFormatting:{type:"items",items:{numberFormattingType:{type:"string",component:"dropdown",ref:"qDef.qNumFormat.qType",translation:"properties.numberFormatting",defaultValue:"U",schemaIgnore:!0,options:[{value:"U",translation:"Common.Auto"},{value:"F",translation:"properties.numberFormatting.types.number"},{value:"M",translation:"properties.numberFormatting.types.money"},{value:"D",translation:"properties.numberFormatting.types.date"},{value:"IV",translation:"properties.numberFormatting.types.duration"},{value:"R",translation:"Common.Custom"}],change:function(a,b,c,e){d.setNumFmtPattern("qType",a.qDef.qNumFormat,e.localeInfo)}},numberFormattingMode:{type:"boolean",component:"switch",ref:"qDef.numFormatFromTemplate",translation:"properties.numberFormatting.formatting",defaultValue:!0,options:[{value:!0,translation:"properties.numberFormatting.simple"},{value:!1,translation:"Common.Custom"}],show:function(b){return["F","D","TS","T"].contains(a.getValue(b,"qDef.qNumFormat.qType"))}},numberFormattingTemplates:{type:"string",component:"number-formatter-dropdown",ref:"qDef.qNumFormat.qFmt",defaultValue:"#,##0",schemaIgnore:!0,show:function(b){var c=a.getValue(b,"qDef.qNumFormat.qType");return["F","D","TS","T"].contains(c)&&a.getValue(b,"qDef.numFormatFromTemplate",!0)===!0}},numDecimals:{type:"integer",ref:"qDef.qNumFormat.qnDec",translation:"properties.numberFormatting.nDec",defaultValue:2,schemaIgnore:!0,min:0,max:14,show:!1},numPrecisionDigits:{type:"integer",ref:"qDef.qNumFormat.qnDec",translation:"properties.numberFormatting.significantFigures",defaultValue:10,schemaIgnore:!0,min:1,max:14,show:!1},decimalSep:{type:"string",ref:"qDef.qNumFormat.qDec",translation:"properties.numberFormatting.dec",defaultValue:".",schemaIgnore:!0,show:function(b){return"R"===a.getValue(b,"qDef.qNumFormat.qType")},change:function(a,b,c,e){d.setNumFmtPattern("qDec",a.qDef.qNumFormat,e.localeInfo)},invalid:function(b){return a.getValue(b,"qDef.qNumFormat.qDec")===a.getValue(b,"qDef.qNumFormat.qThou")},readOnly:function(a,b,c,d){return!k(a,d)}},thousandSep:{type:"string",ref:"qDef.qNumFormat.qThou",translation:"properties.numberFormatting.thousandSeparator",defaultValue:"",schemaIgnore:!0,show:function(b){return"R"===a.getValue(b,"qDef.qNumFormat.qType")},change:function(a,b,c,e){d.setNumFmtPattern("qThou",a.qDef.qNumFormat,e.localeInfo)},invalid:function(b){return"I"!==a.getValue(b,"qDef.qNumFormat.qType")&&a.getValue(b,"qDef.qNumFormat.qDec")===a.getValue(b,"qDef.qNumFormat.qThou")},readOnly:function(a,b,c,d){return!k(a,d)}},format:{type:"string",component:"number-formatter",ref:"qDef.qNumFormat.qFmt",resetTranslation:"properties.numberFormatting.resetPattern",translation:"properties.numberFormatting.formatPattern",defaultValue:"",schemaIgnore:!0,show:function(a){return l(a)},change:function(a){a.qDef.qNumFormat.qFmt=d.getNormalizedFormat(a.qDef.qNumFormat,a.qDef.qNumFormat.qFmt)},invalid:function(a,b,c){if(["D","T","TS","IV"].contains(a.qDef.qNumFormat.qType))return!1;var d="R"===a.qDef.qNumFormat.qType?a.qDef.qNumFormat.qDec:c.localeInfo["q"+("M"===a.qDef.qNumFormat.qType?"Money":"")+"DecimalSep"],e=new RegExp("(0|#)"+h.escapeRegExp(d)+"0*#*"),f=(a.qDef.qNumFormat.qFmt||"").split(";"),g=f[0].match(e),i=g&&g[0]?g[0].length-2:0,j=f[1]?f[1].match(e):null,k=j&&j[0]?j[0].length-2:0;return i>15||k>15}}}}}},m.reflines={type:"array",ref:"refLine.refLines",translation:"properties.referenceLines",itemTitleRef:"label",allowAdd:!0,allowRemove:!0,allowMove:!0,addTranslation:"properties.referenceLines.add",items:{show:{ref:"show",translation:"Common.Show",type:"boolean",defaultValue:!0},label:{ref:"label",translation:"Common.Label",type:"string"},color:{ref:"color",translation:"properties.color",type:"integer",component:"color-picker",defaultValue:2},expressionValue:{ref:"refLineExpr.value",translation:"properties.referenceLines.expression",type:"number",expression:"optional",expressionType:"ValueExpression",defaultValue:0,change:function(a){var b=a.refLineExpr;"object"==typeof b.value?b.label={qStringExpression:{qExpr:b.value.qValueExpression.qExpr}}:b.label=""+b.value}},expressionLabel:{ref:"refLineExpr.label",translation:"properties.referenceLines.expression",type:"string",expression:"optional",expressionType:"StringExpression",defaultValue:"0",show:!1}}},m.dataHandling={type:"items",translation:"properties.dataHandling",grouped:!0,items:{suppressZero:{ref:"qHyperCubeDef.qSuppressZero",defaultValue:!1,translation:"properties.hyperCube.showZero",type:"boolean",inverted:!0},calcCond:{type:"items",items:{expr:{ref:"qHyperCubeDef.qCalcCond",type:"string",component:"expression",expressionType:"ValueExpr",translation:"properties.hyperCube.calcCond"},customErrorMessage:{ref:"qHyperCubeDef.customErrorMessage.calcCond",component:"textarea",defaultValue:"",type:"string",placeholderTranslation:"Object.ErrorMessage.CalculationCondition",translation:"properties.hyperCube.calcCondMessage",show:function(b){var c=a.getValue(b,"qHyperCubeDef.qCalcCond");return c.qv&&""!==c.qv}}}}}};var p;return p=j.DIM_COLOR?{ref:"color.useBaseColors",type:"string",translation:"properties.useLibraryColors",component:"dropdown",show:o.color.baseColor.show,globalChange:function(b){"byMultiple"===a.getValue(b,"color.mode","")&&"dimension"===a.getValue(b,"color.useBaseColors","")&&a.setValue(b,"color.useBaseColors","measure")},defaultValue:"off",options:function(a,b){var c=[{value:"off",translation:"Common.None"}];return o.color.baseColor.hasMeasureColor(b)&&o.color.baseColor.isSupported(a.visualization)&&c.push({value:"measure",translation:"Common.Measure"}),o.color.baseColor.hasDimensionColor(b)&&"byMultiple"!==a.color.mode&&c.push({value:"dimension",translation:"Common.Dimension"}),c}}:{ref:"color.useBaseColors",type:"string",translation:"properties.useLibraryMeasureColors",component:"switch",show:o.color.baseColor.show,defaultValue:"off",options:[{value:"off",translation:"properties.off"},{value:"measure",translation:"properties.on"}]},m.colorsAndLegend={type:"items",translation:"properties.colorsAndLegend",grouped:!0,items:{colors:{type:"items",items:{autoColor:{ref:"color.auto",type:"boolean",translation:"properties.colors",component:"switch",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}]},colorMode:{ref:"color.mode",type:"string",component:"dropdown",options:o.color.colorMode.options,defaultValue:"primary",show:o.color.colorMode.show,globalChange:function(a,b){o.color.colorBy.globalChange(a,b,"qHyperCubeDef.")}},colorByDimension:{ref:"color.byDimDef",schemaIgnore:!0,translation:"properties.colorBy.selectDimension",type:"object",defaultValue:{},component:"color-by-dropdown",libraryItemType:"dimension",show:o.color.colorBy.dimension.show,change:function(b){b.color.altLabel=a.getValue(b,"color.byDimDef.label","")}},colorByMeasure:{ref:"color.byMeasureDef",schemaIgnore:!0,translation:"properties.colorBy.selectMeasure",type:"object",defaultValue:{},component:"color-by-dropdown",libraryItemType:"measure",show:o.color.colorBy.measure.show,change:function(b){b.color.altLabel=a.getValue(b,"color.byMeasureDef.label","")}},colorByLabel:{type:"string",ref:"color.altLabel",schemaIgnore:!0,translation:"Common.Label",show:o.color.colorBy.label.show,change:function(b){o.color.colorBy.measure&&o.color.colorBy.measure.show(b)?b.color.byMeasureDef.label=a.getValue(b,"color.altLabel",""):o.color.colorBy.dimension&&o.color.colorBy.dimension.show(b)&&(b.color.byDimDef.label=a.getValue(b,"color.altLabel",""))}},baseColors:{type:"items",items:{useBaseColor:p,measureColor:{translation:"properties.libraryColors",component:"measure-color",show:o.color.baseColor.showColors}}},singleColor:{ref:"color.singleColor",translation:"properties.color",type:"integer",component:"color-picker",defaultValue:3,show:o.color.singleColor.show},paletteColor:{ref:"color.paletteColor",translation:"properties.color",type:"object",component:"color-picker",readOnly:o.color.paletteColor.readOnly,dualOutput:!0,show:o.color.paletteColor.show,change:o.color.paletteColor.change,defaultValue:o.color.paletteColor.defaultValue},persistentColors:{ref:"color.persistent",translation:"properties.colorPersistence",type:"boolean",defaultValue:!1,show:o.color.persistentColors.show,readOnly:o.color.persistentColors.readOnly},attributeExpression:{type:"string",component:"expression",expressionType:"measure",schemaIgnore:!0,ref:"qHyperCubeDef.qMeasures.0.qAttributeExpressions.0.qExpression",change:o.color.attributeExpression.change,globalChange:o.color.attributeExpression.globalChange,translation:"Common.Expression",show:o.color.attributeExpression.show},expressionIsColor:{ref:"color.expressionIsColor",translation:"properties.expressionIsColor",type:"boolean",defaultValue:!0,show:o.color.expressionIsColor.show},expressionLabel:{type:"string",ref:"color.expressionLabel",translation:"Common.Label",change:o.color.expressionLabel.change,show:o.color.expressionLabel.show},colorSchemeMeasure:{ref:"color.measureScheme",type:"string",translation:"properties.colorScheme",component:"item-selection-list",defaultValue:a.getValue(n,"scales.0.propertyValue","sg"),items:o.helpers.getMeasureSchemeOptions,show:o.color.colorSchemeMeasure.show},reverseScheme:{ref:"color.reverseScheme",translation:"properties.reverseColorScheme",type:"boolean",defaultValue:!1,show:o.color.reverseScheme.show},colorSchemeDimension:{ref:"color.dimensionScheme",type:"string",translation:"properties.colorScheme",component:"item-selection-list",defaultValue:a.getValue(n,"dataPalettes.0.propertyValue","12"),items:o.helpers.getDimensionSchemeOptions,show:o.color.colorSchemeDimension.show},customRange:{type:"items",items:{autoMinMax:{ref:"color.autoMinMax",type:"boolean",translation:"properties.axis.range",component:"switch",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}],show:o.color.customRange.autoMinMax.show},min:{ref:"color.measureMin",translation:"properties.axis.min",expression:"optional",type:"number",show:o.color.customRange.min.show,invalid:o.color.customRange.min.invalid},max:{ref:"color.measureMax",translation:"Common.Max",expression:"optional",type:"number",defaultValue:10,show:o.color.customRange.max.show,invalid:o.color.customRange.max.invalid}},show:o.color.customRange.show}}},legend:{type:"items",items:{show:{ref:"legend.show",type:"boolean",translation:"properties.legend.show",component:"switch",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],show:o.legend.show},dock:{type:"string",component:"dropdown",ref:"legend.dock",translation:"properties.legend.position",options:[{value:"auto",translation:"Common.Auto"},{value:"right",translation:"properties.dock.right"},{value:"bottom",translation:"Common.Bottom"},{value:"left",translation:"properties.dock.left"},{value:"top",translation:"Common.Top"}],defaultValue:"auto",show:o.legend.dock.show},showTitle:{ref:"legend.showTitle",translation:"properties.legend.showTitle",type:"boolean",defaultValue:!0,show:o.legend.showTitle.show}}}}},m.data={type:"items",component:"hypercube-data",translation:"Common.Data",addTranslation:"Properties.AddData",allowAdd:!0,items:{dimensions:m.dimensions,measures:m.measures}},m}),define("client.utils/property-mapper",["client.property-panel/default-properties","client.utils/property-resolver","util"],function(a,b,c){function d(a,c,e){var f,g,h,i=null;if(a.ref===c)return a;if(b.isHierarchical(a))for(f=Object.keys(a.items),h=0;h<f.length;++h){if(g=a.items[f[h]],g.ref===c){i=g;break}if(e&&null!==(i=d(g,c,e)))break}return i}function e(d,f,g){var h,i,l;if(g=g||a,d||(d=j),f&&k[f])return k[f];for(var m;d.uses;){if(!(l=b.getValue(g,d.uses)))throw"No defaults found for: "+d.uses;if(m=l.uses,d=c.extend(!0,{},l,d),!m){delete d.uses;break}d.uses=m}return b.isHierarchical(d)||"array"===d.type&&d.items?(i={},Object.keys(d.items).forEach(function(a){d.items[a]&&(i[a]=e(d.items[a],null,g))}),h=c.extend({},d,{items:i})):h=c.extend({},d),f&&!k[f]&&(k[f]=h),h}function f(a,d,f){var g=e(a,f);return d?c.extend(!0,b.getDefaults(g),d):b.getDefaults(g)}function g(a){function c(a){function d(a){return a.search(/\.\d/g)!==-1}function e(a){var c={type:a.type,defaultValue:b.getDefaultValue(a.type,a)};return a.maxlength&&(c.maxlength=a.maxlength),a.min&&(c.min=a.min),a.max&&(c.max=a.max),a.expression&&(c.expression=a.expression),a.options&&"boolean"!==a.type&&(c.enum=a.options.map(function(a){return a.value})),c}function f(a){var h,i,j,k,l,m;if(b.isHierarchical(a))for(h=Object.keys(a.items),l=0;l<h.length;l++)i=h[l],j=a.items[i],f(j);else a.ref&&"array"===a.type&&a.items?(k=c({type:"items",items:a.items}),m={type:"array",items:k},d(a.ref)||b.setValue(g,a.ref,m)):a.ref&&(m=e(a),d(a.ref)||b.setValue(g,a.ref,m))}var g={};return f(a),g}return c(a)}function h(a){function c(a){var e,f,g;if(b.isHierarchical(a))for(e=Object.keys(a.items),g=0;g<e.length;++g)f=a.items[e[g]],f.snapshot&&d.push(f),c(f)}var d=[];return c(a),d}function i(a,b){function c(a){a.globalChange&&d.push(a.globalChange),"items"!==a.type&&"array"!==a.type||!a.items||Object.keys(a.items).forEach(function(b){a.items[b]&&c(a.items[b])})}if(b&&l[b])return l[b];var d=[];return c(a),b&&!l[b]&&(l[b]=d),d}var j,k={},l={};return j={type:"items",component:"accordion",items:{settings:{uses:"settings"}}},{findDefinition:d,findSnapshotProperties:h,findGlobalListeners:i,mapDefinition:e,mapProperties:f,getPropertyHierarchy:g}}),define("objects.utils/data-properties/data-property-handler",["core.utils/class","util"],function(a,b){"use strict";var c;return c="Not supported in this object, need to implement in subclass.",a.extend({init:function(a){a=a||{},this.dimensionDefinition=a.dimensionDefinition||{max:0},this.measureDefinition=a.measureDefinition||{max:0},a.dimensionDefinition&&(this.dimensionProperties=a.dimensionProperties||{}),a.measureDefinition&&(this.measureProperties=a.measureProperties||{}),a.globalChangeListeners&&(this.globalChangeListeners=a.globalChangeListeners),this.app=a.app},setProperties:function(a){this.properties=a},setGlobalChangeListeners:function(a){this.globalChangeListeners=a},setLayout:function(a){this.layout=a},type:function(){throw"Must override this method"},getDimensions:function(){return[]},getDimension:function(a){var b=this.getDimensions(),c=0;for(c;c<b.length;++c)if(b[c].qDef.cId===a)return b[c];return null},
minDimensions:function(){return"function"==typeof this.dimensionDefinition.min?this.dimensionDefinition.min.call(null,this.properties,this):this.dimensionDefinition.min||0},maxDimensions:function(){return"function"==typeof this.dimensionDefinition.max?this.dimensionDefinition.max.call(null,this.getMeasures().length):isNaN(this.dimensionDefinition.max)?1e4:this.dimensionDefinition.max},canAddDimension:function(){return this.getDimensions().length<this.maxDimensions()},minMeasures:function(){return"function"==typeof this.measureDefinition.min?this.measureDefinition.min.call(null,this.properties,this):this.measureDefinition.min||0},maxMeasures:function(){return"function"==typeof this.measureDefinition.max?this.measureDefinition.max.call(null,this.getDimensions().length):isNaN(this.measureDefinition.max)?1e4:this.measureDefinition.max},canAddMeasure:function(){return this.getMeasures().length<this.maxMeasures()},getMeasures:function(){return[]},getMeasure:function(a){var b=this.getMeasures(),c=0;for(c;c<b.length;++c)if(b[c].qDef.cId===a)return b[c];return null},addDimension:function(){throw c},getSorting:function(){throw c},addFieldDimension:function(a,b,c){var d=this.createFieldDimension(a,b,c);return this.addDimension(d)},addLibraryDimension:function(a,b){var c=this.createLibraryDimension(a,b);return this.addDimension(c)},addMeasure:function(){throw c},addExpressionMeasure:function(a,b,c){var d=this.createExpressionMeasure(a,b,c);return this.addMeasure(d)},addLibraryMeasure:function(a,b){var c=this.createLibraryMeasure(a,b);return this.addMeasure(c)},addAlternativeFieldDimension:function(a,b,c){var d=this.createFieldDimension(a,b,c);return this.addDimension(d,!0)},addAlternativeLibraryDimension:function(a,b){var c=this.createLibraryDimension(a,b);return this.addDimension(c,!0)},addAlternativeExpressionMeasure:function(a,b,c){var d=this.createExpressionMeasure(a,b,c);return this.addMeasure(d,!0)},addAlternativeLibraryMeasure:function(a,b){var c=this.createLibraryMeasure(a,b);return this.addMeasure(c,!0)},replaceDimension:function(){throw c},replaceMeasure:function(){throw c},autoSortDimension:function(){throw c},autoSortMeasure:function(){throw c},createFieldDimension:function(a,c,d){var e=b.extend(!0,{},this.dimensionProperties||{},d||{});return e.qDef||(e.qDef={}),e.qOtherTotalSpec||(e.qOtherTotalSpec={}),a?(e.qDef.qFieldDefs=[a],e.qDef.qFieldLabels=c?[c]:[""],e.qDef.qSortCriterias=[{qSortByLoadOrder:1}]):(e.qDef.qFieldDefs=[],e.qDef.qFieldLabels=[],e.qDef.qSortCriterias=[]),e.qDef.autoSort=!0,e},createLibraryDimension:function(a,c){var d=b.extend(!0,{},this.dimensionProperties||{},c||{});return d.qDef||(d.qDef={}),d.qOtherTotalSpec||(d.qOtherTotalSpec={}),d.qLibraryId=a,d.qDef.qSortCriterias=[{qSortByLoadOrder:1}],d.qDef.autoSort=!0,delete d.qDef.qFieldDefs,delete d.qDef.qFieldLabels,d},createExpressionMeasure:function(a,c,d){var e=b.extend(!0,{},this.measureProperties||{},d||{});return e.qDef||(e.qDef={}),e.qDef.qNumFormat||(e.qDef.qNumFormat={}),e.qDef.qDef=a,e.qDef.qLabel=c,e.qDef.autoSort=!0,e},createLibraryMeasure:function(a,c){var d=b.extend(!0,{},this.measureProperties||{},c||{});return d.qDef||(d.qDef={}),d.qDef.qNumFormat||(d.qDef.qNumFormat={}),d.qLibraryId=a,d.qDef.autoSort=!0,delete d.qDef.qDef,delete d.qDef.qLabel,d},updateGlobalChangeListeners:function(){this.globalChangeListeners&&(this.globalChangeListeners||[]).forEach(function(a){a&&"function"==typeof a&&a(this.properties,this)}.bind(this))},removeDimension:function(){throw c},removeMeasure:function(){throw c},moveDimension:function(){throw c},moveMeasure:function(){throw c},changeSorting:function(){throw c},setColorByDef:function(a,b){function c(a){return a.split(" ").length>1?"["+a+"]":a}switch(b?"expression":a.type){case"field":this.properties.color.mode="byDimension",this.properties.color.byDimDef={label:c(a.name),key:c(a.name),type:"expression"};break;case"expression":this.properties.color.mode="byMeasure",this.properties.color.byMeasureDef={label:b||a.label||a.name,key:b||a.name,type:"expression"};break;case"dimension":this.properties.color.mode="byDimension",this.properties.color.byDimDef={label:a.name,key:a.id,type:"libraryItem"};break;case"measure":this.properties.color.mode="byMeasure",this.properties.color.byMeasureDef={label:a.name,key:a.id,type:"libraryItem"}}this.properties.color.auto=!1,this.properties.color.altLabel=a.label||a.name}})}),define("objects.utils/data-properties/hypercube-handler",["./data-property-handler","core.utils/deferred","objects.utils/data-properties/library-utils","general.utils/array-util","util","general.utils/attribute-expression-util","client.utils/property-resolver","client.utils/default-property-logic"],function(a,b,c,d,e,f,g,h){"use strict";function i(a){return n.test(a)}function j(a,b){return a?b&&a[b]?a[b].qHyperCube:a.qHyperCube:[]}function k(a,b,c){if(a[c]){var d=f.getIndexById(a[c],b);d>=0&&a[c].splice(d,1)}else a[c]=[]}var l,m=["$numeric","$year","$quarter","$yearquarter","$month","$yearmonth","$weeknumber","$date","$timestamp"],n=new RegExp(m.join("|").replace(/\$/g,"\\$"));return l=a.extend({init:function(a){this._super(a),this.path=a.path},setProperties:function(a){a&&(this._super(a),this.hcProperties=this.path?e.getValue(a,(this.path?this.path+".":"")+"qHyperCubeDef"):a.qHyperCubeDef,this.hcProperties&&(this.hcProperties.qDimensions||(this.hcProperties.qDimensions=[]),this.hcProperties.qMeasures||(this.hcProperties.qMeasures=[]),this.hcProperties.qInterColumnSortOrder||(this.hcProperties.qInterColumnSortOrder=[]),this.hcProperties.qLayoutExclude||(this.hcProperties.qLayoutExclude={}),this.hcProperties.qLayoutExclude.qHyperCubeDef||(this.hcProperties.qLayoutExclude.qHyperCubeDef={}),this.hcProperties.qLayoutExclude.qHyperCubeDef.qDimensions||(this.hcProperties.qLayoutExclude.qHyperCubeDef.qDimensions=[]),this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures||(this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures=[]),this.hcProperties.qDimensions.forEach(function(a){void 0!==a.autoSort&&(a.qDef.autoSort=a.autoSort,delete a.autoSort)}),this.hcProperties.qMeasures.forEach(function(a){void 0!==a.autoSort&&(a.qDef.autoSort=a.autoSort,delete a.autoSort)})))},canColorBy:function(a){var b=a||{qHyperCubeDef:this.hcProperties||this.properties.qHyperCubeDef},c=this.layout?this.layout.visualization:null,d=b.qHyperCubeDef.qDimensions.length>=this.minDimensions()&&b.qHyperCubeDef.qMeasures.length>=this.minMeasures();return"gauge"!==c&&"kpi"!==c&&(d&&this.layout&&this.layout.color?l.canColorBy(b,c):{})},getDimensions:function(){return this.hcProperties?this.hcProperties.qDimensions:[]},getMeasures:function(){return this.hcProperties?this.hcProperties.qMeasures:[]},getSorting:function(){return this.hcProperties.qInterColumnSortOrder},addDimension:function(a,c,f){var g=this.getDimensions(),h=this;return a.qDef.cId||(a.qDef.cId=e.generateId()),c?(f=void 0!==f?f:this.hcProperties.qLayoutExclude.qHyperCubeDef.qDimensions.length,this.hcProperties.qLayoutExclude.qHyperCubeDef.qDimensions.splice(f,0,a),b.resolve(a)):g.length<this.maxDimensions()?(f=void 0!==f?f:g.length,g.splice(f,0,a),this.autoSortDimension(a).then(function(){return d.indexAdded(h.hcProperties.qInterColumnSortOrder,void 0!==f?f:g.length-1),"function"==typeof h.dimensionDefinition.add?b.when(h.dimensionDefinition.add.call(h,a,h.properties,h)).then(function(){return a}):a})):g.length<1e3?(f=this.hcProperties.qLayoutExclude.qHyperCubeDef.qDimensions.length,this.hcProperties.qLayoutExclude.qHyperCubeDef.qDimensions.splice(f,0,a),b.resolve(a)):void 0},reinsertDimension:function(a,c,f){var g=this.getDimensions(),h=this;if(a.qDef.cId||(a.qDef.cId=e.generateId()),c){if(f=void 0!==f?f:this.hcProperties.qLayoutExclude.qHyperCubeDef.qDimensions.length,this.hcProperties.qLayoutExclude.qHyperCubeDef.qDimensions.splice(f,0,a),"function"==typeof h.dimensionDefinition.move)return b.when(h.dimensionDefinition.move.call(h,a,h.properties,h)).then(function(){return a})}else if(g.length<this.maxDimensions()){if(f=void 0!==f?f:g.length,g.splice(f,0,a),d.indexAdded(h.hcProperties.qInterColumnSortOrder,void 0!==f?f:g.length-1),"function"==typeof h.dimensionDefinition.move)return b.when(h.dimensionDefinition.move.call(h,a,h.properties,h)).then(function(){return a})}else g.length<1e3&&(f=this.hcProperties.qLayoutExclude.qHyperCubeDef.qDimensions.length,this.hcProperties.qLayoutExclude.qHyperCubeDef.qDimensions.splice(f,0,a));return b.resolve(a)},addMeasure:function(a,c,f){var g=this.getMeasures(),h=this;return a.qDef.cId||(a.qDef.cId=e.generateId()),c?(f=void 0!==f?f:this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures.length,this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures.splice(f,0,a),b.resolve(a)):(f=void 0!==f?f:g.length,g.length<this.maxMeasures()?(g.splice(f,0,a),this.autoSortMeasure(a).then(function(){return d.indexAdded(h.hcProperties.qInterColumnSortOrder,h.getDimensions().length+g.length-1),"function"==typeof h.measureDefinition.add?b.when(h.measureDefinition.add.call(null,a,h.properties,h)).then(function(){return a}):a})):g.length<1e3?(f=this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures.length,this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures.splice(f,0,a),b.resolve(a)):void 0)},getDimensionLayouts:function(){var a=j(this.layout,this.path);return a?a.qDimensionInfo:[]},getDimensionLayout:function(a){return this.getDimensionLayouts().filter(function(b){return a===b.cId})[0]},getMeasureLayouts:function(){var a=j(this.layout,this.path);return a?a.qMeasureInfo:[]},getMeasureLayout:function(a){return this.getMeasureLayouts().filter(function(b){return a===b.cId})[0]},reinsertMeasure:function(a,c,f){var g=this.getMeasures(),h=this;if(a.qDef.cId||(a.qDef.cId=e.generateId()),c)f=void 0!==f?f:this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures.length,this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures.splice(f,0,a);else if(f=void 0!==f?f:g.length,g.length<this.maxMeasures()){if(g.splice(f,0,a),d.indexAdded(h.hcProperties.qInterColumnSortOrder,h.getDimensions().length+g.length-1),"function"==typeof h.measureDefinition.move)return b.when(h.measureDefinition.move.call(null,a,h.properties,h,!0)).then(function(){return a})}else g.length<1e3&&(f=this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures.length,this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures.splice(f,0,a));return b.resolve(a)},replaceDimension:function(a,b){var c=this.getDimensions(),d=c[a],f=this;return this.autoSortDimension(b).then(function(){return b.qDef.cId=e.generateId(),c[a]=b,"function"==typeof f.dimensionDefinition.replace&&f.dimensionDefinition.replace.call(null,b,d,a,f.properties,f),b})},replaceMeasure:function(a,b){var c=this.getMeasures(),d=c[a],f=this;return this.autoSortMeasure(b).then(function(){return b.qDef.cId=e.generateId(),c[a]=b,"function"==typeof f.measureDefinition.replace&&f.measureDefinition.replace.call(null,b,d,a,f.properties,f),b})},autoSortDimension:function(a){function b(b){b.forEach(function(b,c){var e=b.qTags,f={qSortByLoadOrder:1};"function"==typeof d.dimensionDefinition.autoSort?d.dimensionDefinition.autoSort(a,d.properties,e,f,d):e&&(i(e)?f.qSortByNumeric=1:(e.contains("$text")||e.contains("$ascii"))&&(f.qSortByAscii=1)),a.qDef.qSortCriterias[c]=f})}var d=this;return a.qLibraryId?this.app.getDimensionList().then(function(d){var e=c.findLibraryDimension(a.qLibraryId,d);return e&&b(e.qData.info),a}):this.app.getFieldList().then(function(d){var e=c.findField(a.qDef.qFieldDefs[0],d);return e&&b([e]),a})},autoSortMeasure:function(a){return a.qSortBy={qSortByLoadOrder:1,qSortByNumeric:-1},b.resolve(a)},removeDimension:function(a,c){var e;if(c){if(e=this.hcProperties.qLayoutExclude.qHyperCubeDef.qDimensions.splice(a,1),"function"==typeof this.dimensionDefinition.remove)return b.when(this.dimensionDefinition.remove.call(null,e,this.properties,this,a))}else if(e=this.hcProperties.qDimensions.splice(a,1)[0],d.indexRemoved(this.hcProperties.qInterColumnSortOrder,a),"function"==typeof this.dimensionDefinition.remove)return b.when(this.dimensionDefinition.remove.call(null,e,this.properties,this,a));return b.resolve(e)},removeMeasure:function(a,c){var e;if(c)e=this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures.splice(a,1)[0];else if(e=this.hcProperties.qMeasures.splice(a,1)[0],d.indexRemoved(this.hcProperties.qInterColumnSortOrder,this.getDimensions().length+a),"function"==typeof this.measureDefinition.remove)return b.when(this.measureDefinition.remove.call(null,e,this.properties,this,a));return b.resolve(e)},moveDimension:function(a,c){var e,f,g,h=this.getDimensions(),i=this.hcProperties.qLayoutExclude.qHyperCubeDef.qDimensions;return a<h.length&&c<h.length?d.move(h,a,c):a<h.length&&c>=h.length?(f=c-h.length,g=i.splice(0,1)[0],h.push(g),g=h.splice(a,1)[0],i.splice(f,0,g)):a>=h.length&&c<h.length?(e=a-h.length,g=h.splice(h.length-1,1)[0],i.splice(0,0,g),g=i.splice(e+1,1)[0],h.splice(c,0,g)):(e=a-h.length,f=c-h.length,d.move(i,e,f)),b.resolve(g)},moveMeasure:function(a,c){var e,f,g,h=this.getMeasures(),i=this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures;return a<h.length&&c<h.length?d.move(h,a,c):a<h.length&&c>=h.length?(f=c-h.length,g=i.splice(0,1)[0],h.push(g),g=h.splice(a,1)[0],i.splice(f,0,g)):a>=h.length&&c<h.length?(e=a-h.length,g=h.splice(h.length-1,1)[0],i.splice(0,0,g),g=i.splice(e+1,1)[0],h.splice(c,0,g)):(e=a-h.length,f=c-h.length,d.move(i,e,f)),b.resolve(g)},changeSorting:function(a,b){d.move(this.hcProperties.qInterColumnSortOrder,a,b)},setSorting:function(a){a&&a.length===this.hcProperties.qInterColumnSortOrder.length&&(this.hcProperties.qInterColumnSortOrder=a)},setColorByItem:function(a,c,d,e,f){return l.setColorByItem(a,c,d,e,this.properties,f),b.resolve()},clearColorByItem:function(a,b){l.clearColorByItem(a,b)}}),l.setColorByItem=function(a,b,c,d,e,h){l.clearColorByItem(b,c);var i=b[b.length-1];if(i){var j=a?g.getValue(e,"color.byDimDef"):g.getValue(e,"color.byMeasureDef");if(j){var k={id:f.IDMAP.COLOR_BY_ALTERNATIVE};switch(j.type){case"expression":k.label=d||j.label,a?k.qDef=j.key:k.qExpression=j.key;break;case"libraryItem":if(!a){var m=-1;h.forEach(function(a,b){j.key===a.qLibraryId&&(m=b)}),k.matchMeasure=m}k.qLibraryId=j.key}a?(k.qSortBy={qSortByAscii:1},i.qAttributeDimensions.push(k)):i.qAttributeExpressions.push(k)}}},l.canColorBy=function(a,b){var c={primary:!0};if(a){var d=h.getLogicFor("hard",b).helpers.colorModeOptions;c.byDimension=d.dimension(a),c.byMeasure=d.measure(a),c.byMultiple=d.multiColor(a),c.byExpression=d.expression(a)}return c},l.clearColorByItem=function(a,b){a.forEach(function(a){k(a,f.IDMAP.COLOR_BY_ALTERNATIVE,"qAttributeDimensions"),k(a,f.IDMAP.COLOR_BY_ALTERNATIVE,"qAttributeExpressions")}),b.forEach(function(a){k(a,f.IDMAP.COLOR_BY_ALTERNATIVE,"qAttributeDimensions"),k(a,f.IDMAP.COLOR_BY_ALTERNATIVE,"qAttributeExpressions")})},l}),define("objects.extension/object-conversion",["util","objects.extension/export-format","general.utils/array-util","client.utils/property-resolver","client.utils/property-mapper","translator","objects.utils/data-properties/hypercube-handler","general.utils/attribute-expression-util"],function(a,b,c,d,e,f,g,h){function i(a,b,c){b.hasOwnProperty(a)&&(c[a]=b[a])}function j(a,b,c,d){b.hasOwnProperty(a)?c[a]=b[a]:c[a]=d}function k(b){var c=a.extend(!0,{},b);return d.getValue(c,"qOtherTotalSpec.qOtherCounted")||d.setValue(c,"qOtherTotalSpec.qOtherCounted",{qv:"10"}),d.getValue(c,"qOtherTotalSpec.qOtherLimit")||d.setValue(c,"qOtherTotalSpec.qOtherLimit",{qv:"0"}),c.hasOwnProperty("othersLabel")||(c.othersLabel=f.get("properties.dimensionLimits.others")),c}function l(a,b,c){"masterobject"===b.properties.qInfo.qType?a.qInfo.qType="masterobject":a.qInfo.qType=c.qInfo.qType,a.visualization=c.visualization}function m(a,b,c){var e=c.qProperty,f=c.qProperty.qLayoutExclude;if(!/boolean|number|string/.test(typeof b))return void d.setValue(e,a,b);f&&(f.changed||(f.changed={}),f.changed[a]={from:d.getValue(e,a),to:b}),d.setValue(e,a,b)}function n(a){for(var b in a.qLayoutExclude.changed)a.qLayoutExclude.changed[b].to===d.getValue(a,b)&&d.setValue(a,b,a.qLayoutExclude.changed[b].from)}function o(a,b,c){var e,f,g=b.properties,h=b.properties.qLayoutExclude,i=d.getValue(g,a);if(!/boolean|number|string/.test(typeof i))try{if(e=JSON.stringify(i),f=e.match(/:\{/g),(f=f?f.length:0)>2)return;i=JSON.parse(e)}catch(a){return}h||(b.properties.qLayoutExclude={quarantine:{}},h=b.properties.qLayoutExclude),h.quarantine||(h.quarantine={}),h.quarantine[c]||(h.quarantine[c]={}),h.quarantine[c][a]=i}function p(a,b){var c,e=a.qLayoutExclude?a.qLayoutExclude.quarantine:{};if(!e[b])return!1;e=e[b];for(c in e)d.setValue(a,c,e[c]);return delete a.qLayoutExclude.quarantine[b],!0}var q,r,s,t,u,v,w=Math.pow(2,53)-1;return q={exportProperties:function(d,e){var f,g,h,i=new b,j=d.qProperty,k=e?j[e].qHyperCubeDef:j.qHyperCubeDef,l=i.data[0];for(f=0;f<k.qDimensions.length;++f)l.dimensions.push(k.qDimensions[f]);if(k.qLayoutExclude&&k.qLayoutExclude.qHyperCubeDef&&k.qLayoutExclude.qHyperCubeDef.qDimensions)for(f=0;f<k.qLayoutExclude.qHyperCubeDef.qDimensions.length;++f)l.excludedDimensions.push(k.qLayoutExclude.qHyperCubeDef.qDimensions[f]);for(f=0;f<k.qMeasures.length;++f)l.measures.push(k.qMeasures[f]);if(k.qLayoutExclude&&k.qLayoutExclude.qHyperCubeDef&&k.qLayoutExclude.qHyperCubeDef.qMeasures)for(f=0;f<k.qLayoutExclude.qHyperCubeDef.qMeasures.length;++f)l.excludedMeasures.push(k.qLayoutExclude.qHyperCubeDef.qMeasures[f]);if(l.interColumnSortOrder=k.qInterColumnSortOrder.concat(),k.qLayoutExclude&&k.qLayoutExclude.qHyperCubeDef&&k.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder){var m=k.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder.concat();c.isOrderedSubset(m,l.interColumnSortOrder)&&(l.interColumnSortOrder=m)}delete k.qLayoutExclude;for(g in j)i.properties[g]=j[g];if(e&&(i.properties.qHyperCubeDef=j[e].qHyperCubeDef,delete j[e].qHyperCubeDef),j.qLayoutExclude||(j.qLayoutExclude={}),j.qLayoutExclude.disabled){for(g in j.qLayoutExclude.disabled)h=g,i.properties.hasOwnProperty(h)||(i.properties[h]=j.qLayoutExclude.disabled[g]);delete j.qLayoutExclude.disabled}return j.qLayoutExclude.changed&&(n(j),delete j.qLayoutExclude.changed),j.qLayoutExclude.quarantine&&!a.isEmpty(j.qLayoutExclude.quarantine)||delete j.qLayoutExclude,i},importProperties:function(b,d,f,g){var h,m,n,o,p={qChildren:[]},q={},r=b.data[0],s=f.data&&f.data.measures;s||(s=f.definition&&f.definition.items&&f.definition.items.measures||{max:0});var t="function"==typeof s.max?s.max(r.dimensions.length):isNaN(s.max)?w:s.max,u="function"==typeof s.min?s.min(r.dimensions.length):isNaN(s.min)?0:s.min,v=f.data&&f.data.dimensions;v||(v=f.definition&&f.definition.items&&f.definition.items.dimensions||{max:0});var x="function"==typeof v.max?v.max(t):isNaN(v.max)?w:v.max,y="function"==typeof v.min?v.min(u):isNaN(v.min)?0:v.min;q.qLayoutExclude||(q.qLayoutExclude={}),q.qLayoutExclude.disabled={},q.qLayoutExclude.quarantine={};for(m in b.properties)"qLayoutExclude"===m?b.properties[m].quarantine&&(q.qLayoutExclude.quarantine=a.extend(!0,{},b.properties[m].quarantine)):d.hasOwnProperty(m)||"qMetaDef"===m?q[m]=b.properties[m]:q.qLayoutExclude.disabled[m]=b.properties[m];q=a.extend(!0,{},d,q);var z=g?d[g].qHyperCubeDef:d.qHyperCubeDef,A=g?q[g].qHyperCubeDef:q.qHyperCubeDef;if(A.qDimensions.length=0,A.qMeasures.length=0,(r.dimensions.length>x&&x>0||r.measures.length>t&&t>0||r.excludedDimensions.length&&r.dimensions.length+r.excludedDimensions.length>y||r.excludedMeasures.length&&r.measures.length+r.excludedMeasures.length>u||!t&&r.measures.length||!x&&r.dimensions.length)&&(A.qLayoutExclude||(A.qLayoutExclude={}),A.qLayoutExclude.qHyperCubeDef||(A.qLayoutExclude.qHyperCubeDef={}),(r.dimensions.length>x&&x>0||r.excludedDimensions&&r.excludedDimensions.length&&r.dimensions.length+r.excludedDimensions.length>y)&&(A.qLayoutExclude.qHyperCubeDef.qDimensions||(A.qLayoutExclude.qHyperCubeDef.qDimensions=[])),(r.measures.length>t&&t>0||r.excludedMeasures&&r.excludedMeasures.length&&r.measures.length+r.excludedMeasures.length>u)&&(A.qLayoutExclude.qHyperCubeDef.qMeasures||(A.qLayoutExclude.qHyperCubeDef.qMeasures=[])),!t&&r.measures.length&&(A.qLayoutExclude.qHyperCubeDef.qMeasures||(A.qLayoutExclude.qHyperCubeDef.qMeasures=[])),!x&&r.dimensions.length&&(A.qLayoutExclude.qHyperCubeDef.qDimensions||(A.qLayoutExclude.qHyperCubeDef.qDimensions=[]))),x>0)for(n=0;n<r.dimensions.length;++n)A.qDimensions.length<x?A.qDimensions.push(k(r.dimensions[n])):A.qLayoutExclude.qHyperCubeDef.qDimensions.push(k(r.dimensions[n]));else if(r.dimensions.length)for(n=0;n<r.dimensions.length;++n)A.qLayoutExclude.qHyperCubeDef.qDimensions.push(k(r.dimensions[n]));if(r.excludedDimensions.length)for(n=0;n<r.excludedDimensions.length;++n)A.qDimensions.length<y?A.qDimensions.push(k(r.excludedDimensions[n])):A.qLayoutExclude.qHyperCubeDef.qDimensions.push(k(r.excludedDimensions[n]));if(t>0)for(n=0;n<r.measures.length;++n)A.qMeasures.length<t?A.qMeasures.push(r.measures[n]):A.qLayoutExclude.qHyperCubeDef.qMeasures.push(r.measures[n]);else if(r.measures.length)for(n=0;n<r.measures.length;++n)A.qLayoutExclude.qHyperCubeDef.qMeasures.push(r.measures[n]);if(r.excludedMeasures.length)for(n=0;n<r.excludedMeasures.length;++n)A.qMeasures.length<u?A.qMeasures.push(r.excludedMeasures[n]):A.qLayoutExclude.qHyperCubeDef.qMeasures.push(r.excludedMeasures[n]);if(o=A.qDimensions.length+A.qMeasures.length,A.qInterColumnSortOrder=r.interColumnSortOrder.concat(),(n=A.qInterColumnSortOrder.length)!==o)for(A.qLayoutExclude&&(A.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder=r.interColumnSortOrder.concat());n!==o;)n<o?(c.indexAdded(A.qInterColumnSortOrder,n),++n):(--n,c.indexRemoved(A.qInterColumnSortOrder,n));return h=e.mapProperties(e.mapDefinition(f.definition,f.type),{},f.type),["qAlwaysFullyExpanded","qSuppressMissing","qSuppressZero"].filter(function(a){return h&&h.qHyperCubeDef&&void 0===h.qHyperCubeDef[a]}).forEach(function(a){i(a,z,A)}),i("qMaxStackedCells",z,A),i("qNoOfLeftDims",z,A),j("qInitialDataFetch",z,A,[{qTop:0,qLeft:0,qWidth:0,qHeight:0}]),j("qMode",z,A,"S"),j("qReductionMode",z,A,"N"),j("qSortbyYValue",z,A),j("qIndentMode",z,A),j("qShowTotalsAbove",z,A),l(q,b,d),p.qProperty=q,p}},r={exportProperties:function(a){var c,d,e,f=new b,g=a.qProperty,h=g.qListObjectDef,i=f.data[0];if((h.qLibraryId||h.qDef&&h.qDef.qFieldDefs[0])&&i.dimensions.push({qLibraryId:h.qLibraryId,qDef:h.qDef,title:h.title,qOtherTotalSpec:{}}),h.qLayoutExclude&&h.qLayoutExclude.qHyperCubeDef&&h.qLayoutExclude.qHyperCubeDef.qDimensions)for(c=0;c<h.qLayoutExclude.qHyperCubeDef.qDimensions.length;++c)i.excludedDimensions.push(h.qLayoutExclude.qHyperCubeDef.qDimensions[c]);if(h.qLayoutExclude&&h.qLayoutExclude.qHyperCubeDef&&h.qLayoutExclude.qHyperCubeDef.qMeasures)for(c=0;c<h.qLayoutExclude.qHyperCubeDef.qMeasures.length;++c)i.excludedMeasures.push(h.qLayoutExclude.qHyperCubeDef.qMeasures[c]);if(h.qLayoutExclude&&h.qLayoutExclude.qHyperCubeDef&&h.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder)for(c=0;c<h.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder.length;++c)i.interColumnSortOrder.push(h.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder[c]);delete h.qLayoutExclude;for(d in g)f.properties[d]=g[d];if(g.qLayoutExclude&&g.qLayoutExclude._disabled){for(d in g.qLayoutExclude._disabled)e="_"===d.substr(0,1)?d.substring(1):d,f.properties.hasOwnProperty(e)||(f.properties[e]=g.qLayoutExclude.disabled[d]);delete g.qLayoutExclude.disabled}if(i.dimensions.length>0)for(c=0;c<i.dimensions[0].qDef.qSortCriterias.length;++c)i.dimensions[0].qDef.qSortCriterias[c].qSortByFrequency=0;return f},importProperties:function(b,c){var d,e,f={qChildren:[]},g={},h=b.data[0];g.qLayoutExclude||(g.qLayoutExclude={}),g.qLayoutExclude.disabled={};for(d in b.properties)"qLayoutExclude"===d?b.properties[d].quarantine&&(g.qLayoutExclude.quarantine=a.extend(!0,{},b.properties[d].quarantine)):c.hasOwnProperty(d)||"qMetaDef"===d?g[d]=b.properties[d]:g.qLayoutExclude.disabled[d]=b.properties[d];for(g=a.extend(!0,{},c,g),g.qListObjectDef.qLayoutExclude||(g.qListObjectDef.qLayoutExclude={}),g.qListObjectDef.qLayoutExclude.qHyperCubeDef||(g.qListObjectDef.qLayoutExclude.qHyperCubeDef={}),g.qListObjectDef.qLayoutExclude.qHyperCubeDef.qDimensions||(g.qListObjectDef.qLayoutExclude.qHyperCubeDef.qDimensions=[]),g.qListObjectDef.qLayoutExclude.qHyperCubeDef.qMeasures||(g.qListObjectDef.qLayoutExclude.qHyperCubeDef.qMeasures=[]),g.qListObjectDef.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder||(g.qListObjectDef.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder=[]),e=0;e<h.dimensions.length;++e)e<1?(g.qListObjectDef.qDef=h.dimensions[e].qDef,g.qListObjectDef.qLibraryId=h.dimensions[e].qLibraryId):g.qListObjectDef.qLayoutExclude.qHyperCubeDef.qDimensions.push(h.dimensions[e]);for(e=0;e<h.excludedDimensions.length;++e)g.qHyperCubeDef.qLayoutExclude.qHyperCubeDef.qDimensions.push(k(h.excludedDimensions[e]));for(e=0;e<h.measures.length;++e)g.qListObjectDef.qLayoutExclude.qHyperCubeDef.qMeasures.push(h.measures[e]);for(e=0;e<h.excludedMeasures.length;++e)g.qHyperCubeDef.qLayoutExclude.qHyperCubeDef.qMeasures.push(h.excludedMeasures[e]);for(e=0;e<h.interColumnSortOrder.length;++e)g.qListObjectDef.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder.push(h.interColumnSortOrder[e]);return g.qListObjectDef.qInitialDataFetch=c.qListObjectDef.qInitialDataFetch,l(g,b,c),f.qProperty=g,f}},s={importProperties:function(a,b,c){var e=this.hypercube.importProperties(a,b,c),f=d.getValue(e,"qProperty.visualization"),h=d.getValue(e,"qProperty.qHyperCubeDef.qDimensions",[]),i=d.getValue(e,"qProperty.qHyperCubeDef.qLayoutExclude.qHyperCubeDef.qDimensions",[]),j=d.getValue(e,"qProperty.qHyperCubeDef.qMeasures",[]),k=d.getValue(e,"qProperty.qHyperCubeDef.qMeasures.0.qAttributeExpressions",[]),l=d.getValue(e,"qProperty.color.colorExpression",""),n=d.getValue(e,"qProperty.color.mode",""),o=d.getValue(e,"qProperty.color.persistent",!1);if(g.canColorBy(e.qProperty,f)[n])if("byDimension"!==n&&"byMeasure"!==n||!h.length)"byExpression"===n&&j.length&&(k.splice(0,0,{qExpression:l,id:"colorByExpression"}),d.setValue(e,"qProperty.qHyperCubeDef.qMeasures.0.qAttributeExpressions",k));else{var p=d.getValue(e,"qProperty.color.altLabel");g.setColorByItem("byDimension"===n,h,i,p,e.qProperty,j)}else d.setValue(e,"qProperty.color.mode","primary"),d.setValue(e,"qProperty.color.auto",!0);return h.length>1&&!o&&m("color.persistent",!0,e),h.forEach(function(a){"qTotalMode"in a.qOtherTotalSpec&&delete a.qOtherTotalSpec.qTotalMode,"qGlobalOtherGrouping"in a.qOtherTotalSpec&&delete a.qOtherTotalSpec.qGlobalOtherGrouping}),e},exportProperties:function(a){var b=this.hypercube.exportProperties(a),c=b.data[0];return h.moveByIdFromGroup(c.dimensions.concat(c.excludedDimensions),[],"qAttributeDimensions",h.IDMAP.COLOR_BY_ALTERNATIVE),h.moveByIdFromGroup(c.dimensions.concat(c.excludedDimensions),[],"qAttributeExpressions",h.IDMAP.COLOR_BY_ALTERNATIVE),h.moveByIdFromGroup(c.measures.concat(c.excludedMeasures),[],"qAttributeExpressions",h.IDMAP.COLOR_BY_EXPRESSION),b}},t={importProperties:function(b,c,d){var e,f,g=this.colorChart.importProperties.apply(this,[b,c,d]),h=g.qProperty;if(c.measureAxis&&void 0===c.measureAxis.autoMinMax?p(h,"unsupportedAutoMinMax")||a.extend(h.measureAxis,c.measureAxis):p(h,"supportedAutoMinMax")||a.extend(h.measureAxis,c.measureAxis),b.properties.measureAxes&&!c.measureAxes&&c.measureAxis&&void 0!==c.measureAxis.autoMinMax){var i=[];if(h.qHyperCubeDef.qMeasures.length>0&&h.qHyperCubeDef.qMeasures.forEach(function(a){a.qDef.series&&(i[a.qDef.series.axis]||(i[a.qDef.series.axis]={axis:a.qDef.series.axis,type:{line:0,marker:0,bar:0,total:0}}),["bar","marker","line"].contains(a.qDef.series.type)&&i[a.qDef.series.axis].type[a.qDef.series.type]++,i[a.qDef.series.axis].type.total++)}),i.length){var j="barchart"===c.visualization?"bar":"linechart"===c.visualization?"line":"";j&&(e=i.filter(function(a){return a.type[j]>0}).sort(function(a,b){return b.type[j]-a.type[j]})),e&&e.length||(e=i.sort(function(a,b){return b.type.total-a.type.total})),e&&e[0]&&a.extend(h.measureAxis,b.properties.measureAxes[e[0].axis])}else a.extend(h.measureAxis,b.properties.measureAxes[0])}return h.qHyperCubeDef.qDimensions.length>1&&0!==(f=h.qHyperCubeDef.qInterColumnSortOrder.indexOf(0))&&(e=h.qHyperCubeDef.qInterColumnSortOrder[0],h.qHyperCubeDef.qInterColumnSortOrder[0]=0,h.qHyperCubeDef.qInterColumnSortOrder[f]=e),g},exportProperties:function(a){var b=this.colorChart.exportProperties.apply(this,[a]);return"gauge"===b.properties.visualization?(o("measureAxis.min",b,"unsupportedAutoMinMax"),o("measureAxis.max",b,"unsupportedAutoMinMax")):(o("measureAxis.min",b,"supportedAutoMinMax"),o("measureAxis.max",b,"supportedAutoMinMax")),b}},u={importProperties:function(a,b,c){var e,f,g=this.hypercube.importProperties(a,b,c),h=d.getValue(g,"qProperty.qHyperCubeDef.qDimensions",[]),i=h.length,j=d.getValue(g,"qProperty.qHyperCubeDef.qMeasures",[]).length,k=d.getValue(g,"qProperty.qHyperCubeDef.qInterColumnSortOrder",[]),l=!0;i+j===k.length&&d.setValue(g,"qProperty.qLayoutExclude.quarantine.interColSortOrder",k.concat());var m=d.getValue(g,"qProperty.qLayoutExclude.quarantine.pivotInterColSortOrder");m?(k=m,f=m.slice(),d.setValue(g,"qProperty.qHyperCubeDef.qInterColumnSortOrder",k),delete g.qProperty.qLayoutExclude.quarantine.pivotInterColSortOrder):k.length=0;var n=k.indexOf(-1)>-1,o=i+n;if(o>k.length)for(e=k.length;e<o;e++)k.indexOf(e)<0&&k.push(e-n);for(e=k.length-1;e>=0;e--)k[e]>=i&&k.splice(e,1);if(j>1&&k.indexOf(-1)<0?k.push(-1):j<2&&k.indexOf(-1)>-1&&k.splice(k.indexOf(-1),1),i>0&&d.getValue(g,"qProperty.qHyperCubeDef.qNoOfLeftDims",-1)===-1&&d.setValue(g,"qProperty.qHyperCubeDef.qNoOfLeftDims",i),f&&k&&f.length===k.length){for(e=0;e<f.length;e++)if(f[e]!==k[e]){l=!1;break}l&&p(g.qProperty,"noOfLeftDims")}return h.forEach(function(a){"qTotalMode"in a.qOtherTotalSpec||(a.qOtherTotalSpec.qTotalMode="TOTAL_EXPR")}),g},exportProperties:function(a){var b=d.getValue(a,"qProperty.qHyperCubeDef.qInterColumnSortOrder",[]),c=b.slice(0),e=b.indexOf(-1);e>-1&&b.splice(e,1);var f=this.hypercube.exportProperties(a),g=f.properties.qHyperCubeDef,h=g.qDimensions.length,i=g.qMeasures.length,j=g.qInterColumnSortOrder;d.setValue(f,"properties.qLayoutExclude.quarantine.pivotInterColSortOrder",c),o("qHyperCubeDef.qNoOfLeftDims",f,"noOfLeftDims"),delete f.properties.qHyperCubeDef.qNoOfLeftDims;var k=d.getValue(f,"properties.qLayoutExclude.quarantine.interColSortOrder");k&&(j=k,d.setValue(f,"properties.qHyperCubeDef.qInterColumnSortOrder",j),d.setValue(f,"data.0.interColumnSortOrder",j),delete f.properties.qLayoutExclude.quarantine.interColSortOrder);for(var l=j.length;l<h+i;l++)j.length<=l&&j.push(l);return f}},v={importProperties:function(b,c){var d,e={qChildren:[]},f={};f.qLayoutExclude||(f.qLayoutExclude={}),f.qLayoutExclude.disabled={};for(d in b.properties)"qLayoutExclude"!==d&&(c.hasOwnProperty(d)||"qMetaDef"===d?f[d]=b.properties[d]:f.qLayoutExclude.disabled[d]=b.properties[d]);return f=a.extend(!0,{},c,f),l(f,b,c),e.qProperty=f,e},exportProperties:function(a){var c,d,e=new b,f=a.qProperty;for(c in f)e.properties[c]=f[c];if(f.qLayoutExclude||(f.qLayoutExclude={}),f.qLayoutExclude.disabled)for(c in f.qLayoutExclude.disabled)d=c,e.properties.hasOwnProperty(d)||(e.properties[d]=f.qLayoutExclude.disabled[c]);return delete f.qLayoutExclude,e}},{importCommonProperties:l,hypercube:q,listbox:r,axisChart:t,colorChart:s,pivotChart:u,other:v,changeProperty:m}}),
define("extensions.qliktech/barchart/barchart",["jquery","util","core.utils/deferred","extensions.qliktech/barchart/bararea","extensions.qliktech/barchart/barchart-properties","extensions.qliktech/barchart/barchart-data","extensions.qliktech/barchart/barchart-explore-properties","objects.views/charts/scrollable-chart","objects.backend-api/stacked-api","objects.views/charts/disclaimers/chart-utils","objects.views/charts/utils/time-utils","objects.views/charts/components/axis/axis-utils","text!./barchart.ng.html","objects.extension/object-conversion","objects.utils/continuous-utils"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){"use strict";function p(a,b,c,d,e,f,g){var h,i=["bottom","top"],j=["left","right"];"horizontal"===g?(h=i,i=j,j=h,e.setDock("right")):e.setDock("bottom"),a.setDock("far"===f.dimensionAxis.dock?i[1]:i[0]),b.setDock("far"===f.dimensionAxis.dock?i[1]:i[0]),d.setDock("far"===f.measureAxis.dock?j[1]:j[0]),c.setDock("far"===f.measureAxis.dock?j[1]:j[0])}var q,r={NONE:0,ONE_DIM:1,TWO_DIM:2};return q=h.extend("BarChart",{namespace:".barchart",init:function(b,c,e,f,g){var h,i=a.extend(!0,{},e);this.$scope=b,e=a.extend(!0,e||{},{components:{dataArea:{clazz:d},miniChart:{components:{dataArea:{clazz:d}}}}},i),this._super(b,c,e,f,g),this._data={},this._tree=null,this.components.dimensionAxis.setMaxDiscreteUnitSize(64),h=this.components.miniChart,this.components.miniChart&&(this.components.miniChart.setBackendApi(this.backendApi),this.components.scrollArea.setUseMiniChart(!0),this.components.scrollArea.setMiniChart(this.components.miniChart),h.components.measureAxis.setDock("left"),h.components.dimensionAxis.setDock("bottom"),h.components.dataArea.setMinorAxis(h.components.measureAxis),h.components.dataArea.setMajorAxis(h.components.dimensionAxis),h.components.dataArea.setShowDataPoints(!1),h.setColorMap(this.providers.colorMap)),this._orientation="vertical"},initSelections:function(){if(!this.options._disableSelections){this.selections.Select.bind(function(a,b){var c=this.selections.getActiveType().activeComponent.getSelectionIndices()||[];this.onSelection.Select.apply(this,[a,b,c,"L"])}.bind(this));var a=function(a){this.onSelection.scheduleInvalidation.call(this),this.components.timeAxis.setSelectedRanges(a),this.components.dataArea.updateRangeSelection(a),this.components.miniChart.components.dataArea.updateRangeSelection(a)};this.selections.UpdateRanges.bind(a.bind(this)),this.selections.Clear.bind(a.bind(this,[])),this.selections.Deactivated.bind(a.bind(this,[]))}this._super()},isValid:function(a){return this._super(a)&&!this.supressChartRendering},_paint:function(){if(!this.isValid(this._data))return this.clear();this._super();var a,b=this._data,d=this.isDimensionContinuous||"vertical"===b.orientation,e=this.components.scrollArea,f=this.getSnapshotStoredChartData(),g=d?this.rect.height:this.rect.width,h=0,i=[];this._cutMode?((this._cutMode.positive||this._cutMode.negative)&&(h=this._layoutMode>=15?32:this._layoutMode>=7?16:8),d?this.components.measureAxis.setPadding(this._cutMode.positive?h:0,0,this._cutMode.negative?h:0,0):this.components.measureAxis.setPadding(0,this._cutMode.positive?h:0,0,this._cutMode.negative?h:0)):this.components.measureAxis.setPadding(0,0,0,0),this.components.dimensionAxis.setMaxDiscreteUnitSize(Math.max(1,Math.ceil(g/4)));var j=this.components.dataArea.getMajorAxisData().info.map(function(a){return a.show});if(this.components.colorLegend.updateNow(["properties"]),b.qHyperCube.qDimensionInfo.length>1&&"grouped"===b.barGrouping.grouping&&this.components.colorLegend.isVisible(this._layoutMode)&&this.providers.colorMap){var k=this.providers.colorMap.getColorDataInfo();k&&"dimension"===k.legendMode.colorMode&&(j[this.providers.colorMap.getDimensionIndex()]=!1)}this.components.dimensionAxis.setLabelLevelVisibility(j),this.layout(),!this.isDimensionContinuous&&this._dataForMiniChartChanged&&this.components.scrollArea.isVisible()&&this.components.scrollArea.getUseMiniChart()&&this.components.miniChart&&(i.push(this.components.miniChart.setData(b)),this._dataForMiniChartChanged=!1),this._readStoredData?(this.components.dimensionAxis.setInnerOffset(f.axisInnerOffset),this.components.scrollArea.setOffset(f.scrollOffset),this.components.scrollArea.setViewRange(f.viewRange)):this.options.viewState&&(this.components.dimensionAxis.setInnerOffset(this.options.viewState.axisInnerOffset),this.components.scrollArea.setOffset(this.options.viewState.scrollOffset));var l=this.checkPage();if(l)i.push(l);else{for(a in this.components)i.push(this.components[a].invalidateDisplay("BarChart.paint"));e.viewState.min+e.viewState.range>e.fullState.max&&e.setOffset(e.fullState.max-e.viewState.range)}return c.all(i)},prePaint:function(a){this._super(a);var b=!1;if(o.isContinuousChart(a)&&2===a.qHyperCube.qDimensionInfo.length){var c=a.qHyperCube.qDimensionInfo[1];b=c.qStateCounts.qLocked+c.qStateCounts.qOption+c.qStateCounts.qSelected>k.maxNumberOfLines}j.applyDisclaimerAttributes({paging:!0,bottom:!0,explicitLimitedData:b},this.$scope.dataAttributes,this.$element,this.$scope,a),this.supressChartRendering=this.$scope.dataAttributes.noDataExist},updateData:function(a){if(this.setIsDimensionContinuous(o.isContinuousChart(a)),this._setActiveDimensionAxis(a),this.isDimensionContinuous){var b=this,c=this._super;return this.updateFullContinuousData(a).then(function(a){return c.call(b,a)})}return this._super(a)},_updateData:function(a){var b=[];this._checkPage=!1,this._disablePagingTransitions.call(this),this._data=a,this.isDimensionContinuous||(this._dataForMiniChartChanged=!0),this.isStacked=("stacked"===a.barGrouping.grouping||this.isDimensionContinuous)&&(a.qHyperCube.qDimensionInfo.length>1||a.qHyperCube.qMeasureInfo.length>1),this.components.measureAxis.isStacked=this.isStacked,this.components.scrollArea.setUseMiniChart(!0),b.push(this.components.dataArea.setData(a)),b.push(this.providers.colorMap.setData(a)),b.push(this.components.colorLegend.setData(a)),b.push(this.components.dimensionAxisTitle.setData(a)),b.push(this.components.measureAxisTitle.setData(a));var d=this.isDimensionContinuous?"vertical":a.orientation;d&&this.components.miniChart?(this._orientation!==d&&(this.components.miniChart.clear(),this._orientation=d),this.components.miniChart.setOrientation(d)):this._orientation=d;var e={axes:{measureAxis:{component:this.components.measureAxis},dimensionAxis:{component:this.components.dimensionAxis},timeAxis:{component:this.components.timeAxis,data:a.dimensionAxis},continuousAxis:{component:this.components.continuousAxis,data:a.dimensionAxis}},axisTitles:{dimensionAxisTitle:{component:this.components.dimensionAxisTitle},measureAxisTitle:{component:this.components.measureAxisTitle}},refLineLabels:{labels:{data:a.refLine.refLines,component:this.components.refLineLabels}},refLines:{component:this.components.refLines}},f=null,g=this.getSnapshotStoredChartData();return this.components.dataArea.setIsDimensionContinuous(this.isDimensionContinuous),this.scrollMultiplicator=a.qHyperCube.qDimensionInfo.length<2&&"grouped"===a.barGrouping.grouping&&a.qHyperCube.qMeasureInfo.length>1?a.qHyperCube.qMeasureInfo.length+1:1,this._pagingMode=r.NONE,this.components.dataArea._allowInnerSelection=!1,a.qHyperCube.qDimensionInfo.length<2&&a.qHyperCube.qSize.qcy>500?(f=a.qHyperCube.qSize.qcy,"grouped"===a.barGrouping.grouping&&a.qHyperCube.qMeasureInfo.length>1&&(this.scrollMultiplicator=a.qHyperCube.qMeasureInfo.length+1,f*=this.scrollMultiplicator),this._pagingMode=r.ONE_DIM):a.qHyperCube.qDimensionInfo.length>1&&"grouped"===a.barGrouping.grouping?(a.qHyperCube.qSize.qcy>500&&(this._pagingMode=r.TWO_DIM,f=a.qHyperCube.qSize.qcy),this.components.dataArea._allowInnerSelection=a.qHyperCube.qDimensionInfo[0].qStateCounts.qOption+a.qHyperCube.qDimensionInfo[0].qStateCounts.qSelected<=1):a.qHyperCube.qDimensionInfo.length>1&&(this.components.dataArea._allowInnerSelection=a.qHyperCube.qDimensionInfo[0].qStateCounts.qOption+a.qHyperCube.qDimensionInfo[0].qStateCounts.qSelected<=1,f=this.isStacked?a.qHyperCube.qStackedDataPages&&a.qHyperCube.qStackedDataPages.length&&a.qHyperCube.qStackedDataPages[0].qData&&a.qHyperCube.qStackedDataPages[0].qData.length?a.qHyperCube.qStackedDataPages[0].qData[0].qSubNodes.length+a.qHyperCube.qStackedDataPages[0].qData[0].qDown:a.qHyperCube.qDimensionInfo[0].qStateCounts.qOption+a.qHyperCube.qDimensionInfo[0].qStateCounts.qSelected:a.qHyperCube.qDataPages[0].qMatrix.length+a.qHyperCube.qDimensionInfo[0].qStateCounts.qOption+a.qHyperCube.qDimensionInfo[0].qStateCounts.qSelected,this._pagingMode=r.ONE_DIM),this.components.dimensionAxis.isDiscrete()&&!this.isDimensionContinuous||(this._pagingMode=r.NONE),this.components.dimensionAxis.setNumDiscreteUnits(f),this._super(a,e),this._readStoredData?(this.components.dimensionAxis.setInnerOffset(g.axisInnerOffset),this.components.scrollArea.setOffset(g.scrollOffset),this.components.scrollArea.setViewRange(g.viewRange)):this.options.viewState?(this.components.dimensionAxis.setInnerOffset(this.options.viewState.axisInnerOffset),this.components.scrollArea.setOffset(this.options.viewState.scrollOffset)):isNaN(a.scrollStartPos)?this.isDimensionContinuous||(this.components.dimensionAxis.setInnerOffset(0),this.components.scrollArea.setOffset(0)):this.components.scrollArea.setRelativeOffset(a.scrollStartPos),this.isDimensionContinuous||(this._checkPage=!0),c.all(b)},updateDataArea:function(a){this.components.dataArea.setShowDataPoints(a.dataPoint.showLabels);var b=this.isDimensionContinuous?"stacked":a.barGrouping.grouping;this.components.dataArea.setGroupingMode(b),this.components.miniChart&&this.components.miniChart.components.dataArea.setGroupingMode(b),this.components.dataArea.updateNow(["properties"])},updateAxis:function(c,d){var e,f,g,h,i,j,k,m,n,o,q,r,s=this.getSnapshotStoredChartData();this.components.timeAxis.setData(c);var t=c.qHyperCube.qMeasureInfo.filter(function(a){return!isNaN(a.qMin)}).map(function(a){return{min:a.qMin,max:a.qMax,index:c.qHyperCube.qMeasureInfo.indexOf(a)}});m=t.reduce(function(a,b){return a.min<b.min?a:b},t[0]),n=t.reduce(function(a,b){return a.max>b.max?a:b},t[0]),o=m?m.min:void 0,q=n?n.max:void 0,b.isNumeric(o)||(o=0),b.isNumeric(q)||(q=1),e=this.components.measureAxis,f=this.components.dimensionAxis,g=this.components.dimensionAxisTitle,h=this.components.measureAxisTitle;var u=this.components.dataArea.getMajorAxisData(),v=this.components.dataArea.getMinorAxisData();f.setDataRange(u.data,u.info),g.setSelectionsEnabled(!!this.selections),h.setSelectionsEnabled(!!this.selections),a.extend(d.axes.measureAxis,{data:a.extend(!0,{},c.measureAxis,{logarithmic:!1}),dataIndices:c.qHyperCube.qMeasureInfo.map(function(a,b){return b})}),a.extend(d.axes.dimensionAxis,{data:c.dimensionAxis,dataIndices:c.qHyperCube.qDimensionInfo.map(function(a,b){return b}),currentDataIndices:[0]}),a.extend(d.axisTitles.dimensionAxisTitle,{data:c.dimensionAxis}),a.extend(d.axisTitles.measureAxisTitle,{data:c.measureAxis}),k=d.axes.measureAxis,r=this.getAxisOptions(k),d.refLineLabels.labels.axis=e,p.apply(this,[f,g,e,h,this.components.scrollArea,c,this._orientation]),this._super(c,d);for(j in d.axes)i=d.axes[j],i.component.setDataIndices(i.dataIndices||[i.dataIndex||0]),i.component.setCurrentDataIndices(i.currentDataIndices||i.dataIndices||[i.dataIndex||0]);q<o?(q=10,o=-10):o===q&&0===q&&(q=10,o=-10),q=Math.max(0,q),o=Math.min(0,o),m&&n?(this._cutMode=this.getSpikeSettings(c,m,n,o,q,r),q=this._cutMode.max,o=this._cutMode.min):this._cutMode={positive:!1,negative:!1},this._readStoredData&&s.dataRanges&&s.dataRanges[0]?this.setAxisDataRange(e,s.dataRanges[0].max,s.dataRanges[0].min,r.max,r.min,1):v?this.setAxisDataRange(e,v.max,v.min,r.max,r.min,1):this.setAxisDataRange(e,q,o,r.max,r.min,1),"none"===c.measureAxis.show?f.setUnitAlignment("center"):this.components.dimensionAxis.setUnitAlignment(l.getAxisUnitAlignment(c.measureAxis.dock,f.isHorizontal())),this.updateTimeAxis()},getSpikeSettings:function(a,b,c,d,e,f){for(var g,h,i=0,j=0,k=0,l=0,m=!1,n=!1,o=c.index+a.qHyperCube.qDimensionInfo.length,p=b.index+a.qHyperCube.qDimensionInfo.length,q=a.qHyperCube.qDataPages[0]?a.qHyperCube.qDataPages[0].qMatrix:[],r=0;r<q.length;r++)g=q[r],h=g[o].qNum,h>0&&!isNaN(h)&&(g[0].qIsOtherCell||g[1].qIsOtherCell?k=Math.max(h,k):i=Math.max(h,i)),(h=g[p].qNum)<0&&!isNaN(h)&&(g[0].qIsOtherCell||g[1].qIsOtherCell?l=Math.min(h,l):j=Math.min(h,j));return this.isStacked&&a.qHyperCube.qMeasureInfo.length+a.qHyperCube.qDimensionInfo.length>2||(null!==f.max&&f.max<e?m=f.max>0:i>0&&k/i>5&&(e=i,m=e>=0),null!==f.min&&f.min>d?n=f.min<0:j<0&&l/j>5&&(d=j,n=d<0)),{max:e,min:d,positive:m,negative:n}},getPreferredSize:function(){return this._super()},setOrientation:function(a){this._orientation=a||"horizontal"},getOrientation:function(){return this._orientation}}),{type:"barchart",BackendApi:i,template:m,View:q,definition:e,softDefinition:g,initialProperties:{qHyperCubeDef:{qDimensions:[],qMeasures:[],qMode:"S",qAlwaysFullyExpanded:!0,qInitialDataFetch:[{qTop:0,qHeight:500,qLeft:0,qWidth:17}],qSuppressZero:!1,qSuppressMissing:!0}},support:{cssScaling:!1,snapshot:!0,export:!0,exportData:!0,sharing:!0},options:{selections:{dataArea:{},range:{},colorLegend:{}},tooltips:{}},data:f,importProperties:function(a,b,c){var d=n.axisChart.importProperties.apply(n,[a,b,c]),e=d.qProperty;return e.qHyperCubeDef.qDimensions.length>1&&"stacked"===e.barGrouping.grouping&&(e.qHyperCubeDef.qMode="K"),d},exportProperties:n.axisChart.exportProperties.bind(n)}}),define("extensions.qliktech/piechart/piechart-label-modes",[],function(){"use strict";return{NONE:0,SHARE:1,VALUE:2}}),define("extensions.qliktech/piechart/piearea-helper",["objects.views/charts/renderers/canvas-renderer","objects.views/charts/components/axis/radial-axis-helper","general.utils/color","extensions.qliktech/piechart/piechart-label-modes"],function(a,b,c,d){function e(a,b){return Math.round(100*a*Math.pow(10,b))/Math.pow(10,b)}function f(a){return a/360*Math.PI*2%(2*Math.PI)}function g(b,c,d,e,f,g,j,k){if(k)return h(b,c,d,f,g);var l,m,n,o,p,q=d.end-d.start,r=d.radius,s=(d.arcCenter+e)%(2*Math.PI),t=(s+Math.PI)%(2*Math.PI);return p=b.font===f&&b.text===c?b.pieLabelMeasures:a.measureText(c,f),q<0&&(q+=2*Math.PI),l=i(q>.4&&p.width<q*r,t),m="center"===l,n=r*Math.cos(s)+(m?Math.cos(s)*p.width/2:0)+(m?-p.width/2:"right"===l?-p.width:0),o=r*Math.sin(s)+(m?Math.sin(s)*p.height/2:0),b.baseline="middle",b.align="left",b.fill=g,b.font=f,b.text=c,b.textAlign=l,b.x=n,b.y=o,b.width=p.width,b.laHeight=p.height,b.arcCenter=t,b.arcLength=q,b.pieLabelMeasures=p,b}function h(b,c,d,e,f){var g=d.radius,h=e.split("px"),i=h[1],j=a.measureText(c,e),k=Math.min(2*g/j.width,8),l=Math.min(100,Math.max(g/10*k*.3,11)),m=l+"px"+i;return b.fill=f,b.text=c,b.font=m,b.align="center",b.baseline="bottom",b.x=0,b.y=0,b.maxWidth=1.3*g,b.visible=!0,b}function i(a,b){return a?"center":b<Math.PI/2||b>1.5*Math.PI?"right":"left"}function j(b,c,d,e,f,g,h,i,j,l){if(j)return k(b,c,e,l,d);var m,n,o,p,q,r,s=(e.arcCenter+f)%(2*Math.PI),t=(s+Math.PI)%(2*Math.PI),u=i||a.measureText(c,h);return q=g?e.innerRadius:e.radius,m=t<Math.PI/2||t>1.5*Math.PI,n=t>Math.PI,r=.07*(m?1:-1)*(n?1:-1)*Math.abs(Math.sin(t)),o=.95*q*Math.cos(s)+e.cx-(m?-1:1)*(Math.abs(Math.cos(t))*u.width/2),p=.95*q*Math.sin(s+r)+e.cy-(n?1:-1)*(Math.abs(Math.sin(t))*u.height/2),b.fill=d,b.x=o,b.y=p,b.text=c,b.font=h,b.align="center",b.baseline="middle",b.maxWidth=1.4*u.width,b}function k(b,c,d,e,f){if(!e)return b;var g,h=d.radius,i=e.split("px"),j=i[0],k=i[1],l=.8*j,m=l+"px"+k,n=a.measureText(c,m);return n.width>1.2*h&&(g=1.2*h/n.width,l=Math.max(l*g,10),m=l+"px"+k),b.fill=f,b.text=c,b.font=m,b.align="center",b.baseline="top",b.maxWidth=1.3*h,b.x=d.cx,b.y=d.cy,b}function l(a,b,d,e,f){return d||c.useDarkLabel(e,f)?b:a}function m(a,b,c){if(a.length<2)return[];var d,e,f,g,h=Math.min(c.width,c.height),i=[],j=[],k=[],l=[],m=[],o=[];for(f=0;f<a.length;f++)o.push({label:a[f],line:b[f]});for(o.sort(function(a,b){return a.label.arcCenter>b.label.arcCenter?1:-1}),f=0;f<a.length;f++)switch(e=o[f],d=e.label,g=d.arcCenter,d.quartile=t(g),d.quartile){case 1:i.push(e);break;case 2:j.push(e);break;case 3:k.push(e);break;case 4:l.push(e)}return m=i.concat(j.reverse()).concat(k).concat(l.reverse()),m=n(m,h,c)}function n(a,c,d){var e,f,g,h,i,j,k,l,m,n,t,u,v,w,x=20;for(m=0;m<a.length;m++){e=a[m].label,j=e.x,k=e.y,g=b.getPolPos({x:j,y:k}),h=e.arcCenter<Math.PI/2||e.arcCenter>3*Math.PI/2,x=Math.max(Math.min(x,g.r/15),5),i=b.getCartPos({r:g.r+x,a:g.a}),j=i.x,k=i.y,0!==m&&(f=a[m-1].label,l=f.y),f&&r(e.quartile,f.quartile)?(u=q(k,l,e.quartile,f.quartile,h,e.laHeight),v=Math.abs(u),l=k+u+2*(u>0?1:-1)):(t=e.arcLength*c/3,v=e.laHeight-t,l=k+(v>0?v*(1===e.quartile||2===e.quartile?1:-1):0)),v>10?(w={x:e.x,y:e.y},o(a[m],w,{x:j,y:l})):a[m].line.strokeWidth=0,e.x=j,e.y=l,e=p(e,d),e.maxWidth=e.width,e.width=null,"center"===a[m].label.textAlign&&v>10&&(a[m].line.x1+=Math.cos(a[m].label.arcLength)*(h?1:-1)*a[m].label.maxWidth/2,a[m].line.x2+=(h?1:-1)*a[m].label.maxWidth/4,a[m].line.y1+=Math.sin(a[m].label.arcLength)*(h?1:-1)*e.laHeight/2,a[m].line.y2+=(h?1:-1)*e.laHeight/2,a[m].line.strokeWidth=1),n=e.y+d.height/2+e.laHeight*(s(e.quartile)?.5:-.5);var y=-n>0||n-d.height>0;a[m].label.visible=!y,a[m].line.visible=!y}return a}function o(a,b,c){var d,e,f,g,h={r:Math.sqrt(b.x*b.x+b.y*b.y),a:Math.atan2(b.y,b.x)},i={r:Math.sqrt(c.x*c.x+c.y*c.y),a:Math.atan2(c.y,c.x)},j=a.label.textAlign;return d=(h.r+2)*Math.cos(h.a),e=(h.r+2)*Math.sin(h.a),f=(i.r-3)*Math.cos(i.a),g=(i.r-3)*Math.sin(i.a),a.line.x1=d+("right"===j?a.label.width:0),a.line.y1=e,a.line.x2=f+("right"===j?a.label.width:0),a.line.y2=g,a}function p(a,b){var c={x:b.width/2,y:b.height/2};switch(a.textAlign){case"left":a.x+a.width>b.width-c.x&&(a.width-=a.x+a.width-(b.width-c.x));break;case"right":a.x<-c.x&&(a.width+=a.x+c.x,a.x=-c.x);break;case"center":a.x<-c.x?(a.width+=a.x+c.x,a.x=-c.x):a.x+a.width>b.width-c.x&&(a.width-=a.x+a.width-(b.width-c.x))}return a}function q(a,b,c,d,e,f){return(a-b)*(1===d||2===c?1:-1)<f?b-a+f*(e&&3===c||!e&&4===c?-1:1):0}function r(a,b){return a===b||3===a&&2===b}function s(a){return 1===a||2===a}function t(a){var b=1;return a>=1.5*Math.PI?b=2:a<=Math.PI/2?b=3:a>Math.PI/2&&a<Math.PI&&(b=4),b}function u(a,d,e,f,g){var h,i;return h=b.getCartPos({r:g.radius-1,a:g.start+g.radianOffset},{x:g.cx,y:g.cy}),i=b.getCartPos({r:g.innerRadius+1,a:g.start+g.radianOffset},{x:g.cx,y:g.cy}),a.x1=h.x,a.y1=h.y,a.x2=i.x,a.y2=i.y,a.strokeWidth=1,e&&c.getContrast(d,e)>1.2?a.stroke=d.toHex():a.stroke=d.isDark()?"#ccc":"#333",a}function v(a,b,c,e){return b&&e||c===d.VALUE?a.pieData.label:a.pieData.formattedShare.toString()+" %"}return{getFormattedPercentageValue:e,getRadianOffset:f,updateNameLabel:g,updateValueLabel:j,getLabelColor:l,improveNameLabelPositions:m,updateLabel:o,checkQuartile:t,isBottomQuartile:s,checkRelevantQuartile:r,checkInterference:q,checkEllipsis:p,updateDivider:u,getValueText:v}}),define("extensions.qliktech/piechart/piearea",["objects.views/charts/components/chart-component","objects.views/charts/shapes/arc","objects.views/charts/shapes/circle","objects.views/charts/shapes/line","objects.views/charts/shapes/text","objects.views/charts/shapes/container","objects.views/charts/utils/tree-iterator","objects.views/charts/renderers/canvas-renderer","objects.views/charts/chart-style-service","client.utils/theme/modern/theme","extensions.qliktech/piechart/piearea-helper","translator","general.utils/color","extensions.qliktech/piechart/piechart-label-modes","core.utils/deferred","core.utils/feature-flags"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){"use strict";function q(a,b){var c={backgroundColor:p.THEMING?a.getStyle("","backgroundColor"):a.getValue(v,null,"backgroundColor"),dataPoint:{},dataValue:{},shape:{},line:{}};return p.THEMING?(c.dataPoint.label={font:"normal "+a.scaleFontSize(a.getStyle("label.name","fontSize"),b)+" 'QlikView Sans'",color:{dark:a.getStyle("label.name","color"),light:a.getStyle("label.name","color")}},c.dataValue.label={font:"normal "+a.scaleFontSize(a.getStyle("label.value","fontSize"),b)+" 'QlikView Sans'",color:{dark:"#333333",light:"#E6E6E6"}},c.shape={border:{width:1},selected:{border:{width:2,color:"#333333"}}},c.line={color:a.getStyle("label.name","color"),width:1}):(c.dataPoint.label={font:a.getFont(v,"item.name",b),color:{dark:a.getValue(v,"item.name","color","dark"),light:a.getValue(v,"item.name","color","light")}},c.dataValue.label={font:a.getFont(v,"item.value",b),color:{dark:a.getValue(v,"item.value","color","dark"),light:a.getValue(v,"item.value","color","light")}},c.shape={border:{width:a.getValue(v,"item.shape.border","width")},selected:{border:{width:a.getValue(v,"item.shape.border","width","selected"),color:a.getValue(v,"item.shape.border","color","selected")}}},c.line={color:a.getValue(v,"item.line","color"),width:a.getValue(v,"item.line","width")}),c}function r(a,b,c,d,e,f){a?(c.strokeWidth=b.shape.selected.border.width,c.stroke=b.shape.selected.border.color,c.opacity=w,c.zIndex=1,d.opacity=1,f.opacity=1,e.opacity=1):(c.opacity=void 0,c.strokeWidth=void 0,c.stroke=void 0,c.zIndex=void 0,d.opacity=void 0,f.opacity=void 0,e.opacity=void 0)}function s(a){this._fontSize=a>300?"large":a>200?"medium":a>100?"small":"tiny"}function t(a,b,c){return c<1e-6&&(c=0),a.set(0,0,this._showAsDonut?this._innerRadius:0,this._radius,b,b+c,this._radianOffset),a}function u(){if(!this._data||!this._tree)return o.resolve();var a,b,c,d,e,f,g,i,j,l,p,q,r,s,u,v,w,x,y,z,A,B,C=this._tree,D=this._itemData.length,E=C.children.length,F=0,G=0,H=[],I=[],J=this._styles,K=this,L=new m(J.backgroundColor).isDark();this.beforeRenderPie(this._tree,n),this._radianOffset=k.getRadianOffset(this._currentProperties.rotation+90);var M=(this._radianOffset<0?this._radianOffset+2*Math.PI:this._radianOffset)%(2*Math.PI);if(y={nameLabel:{font:J.dataPoint.label.font,color:"#f00"},dataLabel:{font:J.dataValue.label.font,color:"#f00"}},E){for(u=1===this._numSlices,b=0;b<D;b++){if(c=this._itemData[b],!c.pieData||c.pieData.value<=0)return o.resolve();G=Math.min(2*Math.PI*c.pieData.share,2*Math.PI),f=K._arcs[c.pieData.shpIndex],g=c.parent.cacheItem.selected,t.apply(K,[f,F-Math.PI,G]),x={border:{color:"white",width:0}},u&&!K._showAsDonut?(p=K._singleItemCircle,p.set(0,0,f.radius)):p=f,r=K._dividers[c.pieData.shpIndex],r.visible=!1,g||u||(r=K._dividers[c.pieData.shpIndex],r.visible=!0,k.updateDivider.call(this,r,c.pieData.color,e,x.border,p),K.dividerAddedToRender(r)),K.pieAddedToRender(c,p),K._showDimensionValues&&(d=u?k.getLabelColor(J.dataPoint.label.color.light,J.dataPoint.label.color.dark,K._showAsDonut,c.pieData.color,L):L?J.dataPoint.label.color.light:J.dataPoint.label.color.dark,i=k.updateNameLabel(K._nameLabels[c.pieData.shpIndex],c.pieData.title,f,M,y.nameLabel.font,d,K.rect,u),H.push(i),q=K._lines[c.pieData.shpIndex],q.stroke=J.line.color,q.strokeWidth=J.line.width,q.x1=0,q.y1=0,q.x2=0,q.y2=0,I.push(q)),F+=G,e=c.pieData.color}if(this._valueLabelContainer.removeChildren(),!this._data.dataPoint.auto||this._layoutMode>3)for(a=0;a<this._sortedIndices.length;a++){if(s=this._itemData[this._sortedIndices[a].idx],!s.pieData||s.pieData.value<=0)return o.resolve();f=K._arcs[s.pieData.shpIndex],v=f.start,w=f.end,w+=v*w<0?2*Math.PI:0,l=k.getValueText(s,this._data.dataPoint.auto,this._dataPointsLabelMode,u),j=K._valueLabels[s.pieData.shpIndex],j.text!==l||y.dataLabel.font!==j.font?(j.text=l,z=h.measureText(l,y.dataLabel.font)):z=j.pieLabelMeasures,j.pieLabelMeasures=z,B=(f.arcCenter+f.radianOffset)%(2*Math.PI),A=(B+Math.PI)%(2*Math.PI);var N=w===v?2*Math.PI:w>=v?w-v:v-w,O=Math.abs(Math.cos(A))*z.height*2+Math.abs(Math.sin(A))*z.width*2;if(!(this._dataPointsLabelMode!==n.NONE&&f.radius*N>O))break;d=k.getLabelColor(J.dataValue.label.color.light,J.dataValue.label.color.dark,this._showAsDonut,s.pieData.color,L),j=k.updateValueLabel(j,l,d,f,M,this._showAsDonut,y.dataLabel.font,z,u,i?i.font:null),j.maxWidth<(this._showAsDonut?f.innerRadius:f.radius)*(u?2:1)&&this._valueLabelContainer.addChild(j)}}k.improveNameLabelPositions(H.concat(),I,K.rect),this._nameLabelContainer.removeChildren(),this._lineContainer.removeChildren();var P=[],Q=[];for(a=0;a<H.length;a++)H[a].visible!==!1&&P.push(H[a]),I[a].visible!==!1&&Q.push(I[a]);return this._nameLabelContainer.addChildren(P),this._lineContainer.addChildren(Q),this._prevRect&&this._prevRect.w===this.rect.width&&this._prevRect.h===this.rect.height||(this._prevRect={w:this.rect.width,h:this.rect.height},this._renderRoot.clearTransform(),this._renderRoot.translate(this.rect.width/2,this.rect.height/2)),this.renderers.pie.render(!0)}var v="pieChart",w=1;return a.extend({init:function(){this._super.apply(this,arguments),this._data=null,this._arcs=[],this._nameLabels=[],this._valueLabels=[],this._lines=[],this._dividers=[],this._itemData=[],this._labelRects=[],this._cacheItems=[],this.renderers={pie:new h(this.container,{name:"pie"})},this.renderers.pie.setCompositingEnabled(!1),this._renderRoot=new f,this._rotationContainer=new f,this._arcContainer=new f,this._dividerContainer=new f,this._nameLabelContainer=new f,this._valueLabelContainer=new f,this._lineContainer=new f,this._rowToShapeMapping={},this._dividerContainer.strokeWidth=1,this._arcContainer.lineJoin="round",this._rotationContainer.addChildren([this._arcContainer,this._dividerContainer]),this._renderRoot.addChildren([this._rotationContainer,this._nameLabelContainer,this._valueLabelContainer,this._lineContainer]),this.renderers.pie.stage.addChild(this._renderRoot),this._singleItemCircle=new c(0,0,0),this._singleItemCircle.type="circle",this._fontSize="large",this._styles={},p.THEMING?this._styleService=j.initializeService("object.pieChart"):this._styleService=i.getInstance(),this._transitionHelper.setTransitionCurve("easeout"),this._maxSizeRatio=.8,this._showValueTextInsideSlice=!1,this._showDimensionValues=!0,this._showAsDonut=!1,this._showLabels=!0,this._recalculcating=!1,this._currentProperties.rotation=0,this._transitionProperties.rotation=0,this._hasNegativeValues=!1,this._innerRadiusRatio=.7},beforeRenderPie:function(){},pieAddedToRender:function(){},dividerAddedToRender:function(){},afterPaint:function(){return o.resolve()},setShowDimensionValues:function(a){this._showDimensionValues=a,this.invalidateDisplay("setShowDimensionValues")},getShowDimensionValues:function(){return this._showDimensionValues},setRotation:function(a){this._transitionProperties.rotation=a,this._transition()},getRotation:function(){return this._transitionProperties.rotation},setScaleRatio:function(a){this._maxSizeRatio=a,this.invalidateDisplay("setScaleRatio")},getScaleRatio:function(){return this._maxSizeRatio},setShowAsDonut:function(a){this._showAsDonut=a,this.invalidateDisplay("setShowAsDonut")},getShowAsDonut:function(){return this._showAsDonut},setColorMap:function(a){this._colorMap=a},getColorMap:function(){return this._colorMap},setDataPointsLabelMode:function(a){switch(a){case"value":this._dataPointsLabelMode=n.VALUE;break;case"share":this._dataPointsLabelMode=n.SHARE;break;default:this._dataPointsLabelMode=n.NONE}this.invalidateDisplay("setDataPointsLabelMode")},getDataPointsLabelMode:function(){return this._dataPointsLabelMode},setDimensionTree:function(a){this._tree=a,this.invalidateProperties(),this.invalidateDisplay("setDimensionTree")},updateSize:function(){this._super()},_updateProperties:function(){if(this._data&&this._tree){this._itemData=[];var a,c,f,h,i,j,m=[],n=this._data.qHyperCube.qDimensionInfo.length,o=this._tree,p=n+1,q=0,s=this._arcs.length,t=o.children.length,u=this.measureFormatters[0],v=this,w=this.selectionIdentifier?this.selectionIdentifier:"dataArea";this._numSlices=0,this._arcContainer.removeChildren(),this._dividerContainer.removeChildren(),this._rowToShapeMapping={};var x,y,z,A,B,C=this._arcContainer,D=this._dividerContainer;t&&(g.each.call(o,function(k,l){if(c=g.getLevel.call(k),k.idx=l,c===p){if(f=k.data.qNum,isNaN(f)||f<=0)return void((n<=1||l<=0)&&(a=k.parent.cacheItem,m.push(a)));v._numSlices++,i=k.parent.data.qText,j="U"!==u.type?k.children[0].data.qText:u.formatValue(k.data.qNum),k.pieData={value:f,title:i,color:null,label:j},k.pieData.shpIndex=q++,h=null!=v._colorMap?v._colorMap.getColor(k.parent.data.qElemNo,f,0,k.parent.idx):null,k.pieData.color=h,s<q?(x=new b(0,0,0,0,0,0,0),B=new d(0,0,0,0),y=new e,z=new e,A=new d(0,0,0,0),v._arcs.push(x),v._nameLabels.push(y),v._valueLabels.push(z),v._lines.push(A),v._dividers.push(B)):(x=v._arcs[k.pieData.shpIndex],y=v._nameLabels[k.pieData.shpIndex],z=v._valueLabels[k.pieData.shpIndex],A=v._lines[k.pieData.shpIndex],B=v._dividers[k.pieData.shpIndex]),v._rowToShapeMapping[k.data.rowIndex]=k.pieData.shpIndex,r(!1,v._styles,x,y,z,A),x.fill=h.toRGBA(),C.addChild(x),D.addChild(B),a=k.parent.cacheItem,a.addShape(w,x),a.addShape(w,y),m.push(a),v._itemData.push(k)}}),this._singleItemCircle.opacity=void 0,this._singleItemCircle.strokeWidth=0,this._singleItemCircle.stroke="white",1!==v._itemData.length||v._showAsDonut||(this._singleItemCircle.fill=v._itemData[0].pieData.color.toRGBA(),C.removeChildren(),C.addChild(this._singleItemCircle),D.removeChildren(),a=m[v._itemData[0].parent.idx],y=a.getShapes()[1],a.clearShapes(w),a.addShape(w,this._singleItemCircle),y&&a.addShape(w,y))),this.setSelectableShapes(m),this._sortedIndices=this._itemData.map(function(a,b){return{value:a.pieData.value,idx:b}}),this._sortedIndices.sort(function(a,b){return a.value<b.value?1:-1});var E,F,G=0;this._numNonZero=0,this._itemData.forEach(function(a){G+=a.pieData.value,v._numNonZero+=a.pieData.value>0?1:0}),this._itemData.forEach(function(a){E=a.pieData.value/G,a.pieData.share=E,F=k.getFormattedPercentageValue(E,v._data.dataPoint.sharePrecision?v._data.dataPoint.sharePrecision:1),a.pieData.formattedShare=F,a.parent.cacheItem.addMeasure(l.get("properties.dataPoints.labelmode.share"),F+" %",F+" %")}),this._super()}},hasValidData:function(){return this._super()&&this._data&&this._tree},_onAnimatitonEnd:function(){this._super(),this.getRotation()%360==0&&(this._currentProperties.rotation=this._transitionProperties.rotation=0)},paint:function(){return this._super(this._layoutMode,this._data),this._radius=this._maxSizeRatio*Math.min(this.rect.width,this.rect.height)/2,this.renderers.pie.stage.opacity=this._globalAlpha||1,this._dividerContainer.opacity=.4*this._globalAlpha,s.apply(this,[this._radius]),this._styles=q(this._styleService,this._fontSize),this._innerRadius=this._innerRadiusRatio*this._radius,u.call(this).then(function(){return this.afterPaint()}.bind(this))},toggleCacheItem:function(a){var b=!0,c=this._styles;this.renderers.pie.stage.opacity!==this._globalAlpha&&(b=!1,this.renderers.pie.stage.opacity=this._globalAlpha);var d=this._rowToShapeMapping[a.row],e=this._arcs[d],f=this._nameLabels[d],g=this._valueLabels[d],h=this._lines[d];e&&(r(a.selected,c,e,f,g,h),b&&(e.invalidate(),f.invalidate(),h.invalidate(),g.invalidate())),1===this._itemData.length&&(a.selected?(this._singleItemCircle.opacity=w,this._singleItemCircle.strokeWidth=c.shape.selected.border.width,this._singleItemCircle.stroke=c.shape.selected.border.color):(this._singleItemCircle.opacity=void 0,this._singleItemCircle.strokeWidth=0,this._singleItemCircle.stroke="white"),b&&this._singleItemCircle.invalidate()),b||this.renderers.pie.render(!0)}})}),define("extensions.qliktech/piechart/piechart-properties",["client.utils/property-resolver","client.utils/default-property-logic"],function(a,b){var c,d,e=b.getLogicFor("hard","piechart");c={uses:"settings",items:{presentation:{type:"items",translation:"properties.presentation",grouped:!0,items:{showAsDonut:{ref:"donut.showAsDonut",type:"boolean",component:"item-selection-list",defaultValue:!1,horizontal:!0,items:[{icon:"∏",component:"icon-item",labelPlacement:"bottom",translation:"properties.pie",value:!1},{icon:"π",component:"icon-item",labelPlacement:"bottom",translation:"properties.donut",value:!0}]},labels:{type:"items",snapshot:{tid:"property-labels"},items:{
dimensionTitle:{ref:"dimensionTitle",type:"boolean",component:"switch",translation:"properties.dataPoints.dimensionlabels",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}]},valuesAuto:{ref:"dataPoint.auto",type:"boolean",translation:"properties.dataPoints.labelmode",component:"switch",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}]},labelMode:{ref:"dataPoint.labelMode",type:"string",component:"dropdown",options:[{value:"none",translation:"Common.None"},{value:"share",translation:"properties.dataPoints.labelmode.share"},{value:"value",translation:"properties.dataPoints.labelmode.value"}],defaultValue:"share",show:function(b){return!a.getValue(b,"dataPoint.auto")}}}}}},colorsAndLegend:{uses:"colorsAndLegend",items:{legend:{items:{show:{defaultValue:!1,show:e.legend.show,snapshot:{tid:"property-legend"}},showTitle:{show:e.legend.showTitle.show},dock:{show:e.legend.dock.show}}}}}}};var f={uses:"data",items:{dimensions:{uses:"dimensions"},measures:{uses:"measures",items:{numberFormatting:{items:{percentOfPieMessage:{component:"text",translation:"properties.numberFormatting.pieMessage",show:function(b,c){return c&&(a.getValue(c,"properties.dataPoint.auto")||"share"===a.getValue(c,"properties.dataPoint.labelMode"))}}}}}}}};return d={uses:"sorting"},{type:"items",component:"accordion",items:{data:f,sorting:d,addons:{type:"items",component:"expandable-items",translation:"properties.addons",items:{dataHandling:{uses:"dataHandling",items:{suppressZero:null}}}},settings:c}}}),define("extensions.qliktech/piechart/piechart-data",["client.utils/property-resolver"],function(a){function b(a){1===a.getDimensions().length&&1===a.getMeasures().length&&(a.getMeasures()[0].qSortBy.qSortByNumeric=-1,1!==a.getSorting()[0]&&a.changeSorting(1,0))}function c(b,c){var d=c.getMeasures();"byExpression"===a.getValue(b,"color.mode")&&0===d.length&&a.setValue(b,"color.mode","primary")}function d(a,c){a.qOtherTotalSpec.qOtherMode="OTHER_COUNTED",a.qOtherTotalSpec.qOtherCounted={qv:"10"},b(c)}return{dimensions:{add:function(a,b,c){d(a,c)},move:function(a,b,c){d(a,c)},replace:function(a,b,c,e,f){d(a,f)},min:1,max:1},measures:{min:1,max:1,add:function(a,c,d){b(d)},remove:function(a,b,d){c(b,d)}}}}),define("extensions.qliktech/piechart/piechart-explore-properties",[],function(){return{type:"items",component:"accordion",items:{data:{uses:"data"},sort:{uses:"sort"},presentation:{uses:"presentation",items:{showAsDonut:{ref:"donut.showAsDonut",type:"boolean",component:"item-selection-list",horizontal:!0,items:[{icon:"∏",component:"icon-item",labelPlacement:"bottom",translation:"properties.pie",value:!1},{icon:"π",component:"icon-item",labelPlacement:"bottom",translation:"properties.donut",value:!0}]},labelMode:{type:"items",items:{labelMode:{type:"string",component:"radio-list",translation:"properties.dataPoints.labelmode",diffs:["dataPoint.auto:false","dataPoint.labelMode"],options:function(){return[{value:"none",translation:"Common.None"},{value:"share",translation:"properties.dataPoints.labelmode.share"},{value:"value",translation:"properties.dataPoints.labelmode.value"}]},setPropertyValue:function(a,b){a.dataPoint.auto=!1,a.dataPoint.labelMode=b},getValue:function(a){return a.dataPoint.auto?"":a.dataPoint.labelMode}}}}}},color:{uses:"color"}}}}),define("text!extensions.qliktech/piechart/piechart.ng.html",[],function(){return'<div class="qv-viz"></div>\n<span class="qv-viz-center-disclaimer" ng-if="dataAttributes.onlyNegativeOrZero" q-translation="Object.Disclaimer.OnlyNegativeOrZeroValues" q-title-translation="Object.Disclaimer.OnlyNegativeOrZeroValues" dir="ltr"></span>\n<span class="qv-viz-center-disclaimer" ng-if="dataAttributes.noDataExist" q-translation="Object.Disclaimer.NoDataExist" q-title-translation="Object.Disclaimer.NoDataExist" dir="ltr"></span>\n<span class="qv-viz-center-disclaimer" ng-if="dataAttributes.onlyNanData" q-translation="Object.Disclaimer.OnlyNanData" q-title-translation="Object.Disclaimer.OnlyNanData" dir="ltr"></span>\n<div qva-chart-disclaimer attributes="dataAttributes" visible="!dataAttributes.onlyNegativeOrZero" direction="options.direction"></div>'}),define("extensions.qliktech/piechart/piechart",["jquery","core.utils/deferred","objects.views/charts/chart","objects.views/charts/components/chart-component","objects.views/charts/components/data-title/data-title","./piearea","objects.views/charts/representation/combo-color-map","objects.backend-api/hypercube-api","extensions.qliktech/piechart/piechart-properties","extensions.qliktech/piechart/piechart-data","extensions.qliktech/piechart/piechart-explore-properties","text!./piechart.ng.html","objects.utils/event-utils","objects.views/charts/disclaimers/chart-utils","objects.extension/object-conversion","objects.views/selections/interaction-handler","objects.views/selections/interaction-type"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){"use strict";function r(a){var b=a.getRotation(),c=b%360,d=c>180?b+360-c:b-c;a.setRotation(d)}function s(a){void 0!==a&&this.components.dataArea.setRotation(a)}function t(a){return a&&!(a.qHyperCube.qMeasureInfo.every(function(a){return a.qMax<=0&&a.qMax>=a.qMin})||0===a.qHyperCube.qSize.qcy)}var u;return u=c.extend("PieChart",{init:function(b,c,h,i,j){var k=this,l=a.extend(!0,{},h);h=a.extend(!0,h||{},{debug:!0,providers:{colorMap:{clazz:g,colorBy:"dimension"}},components:{xAxisTitle:{show:!0,order:1,dock:"top",relevantSize:30,showFlag:d.prototype.ShowFlags.SMALL,clazz:e},dataArea:{sortKey:1e3,show:!0,dock:"center",clazz:f,showFlag:d.prototype.ShowFlags.SPARK},colorLegend:{show:!0,dock:"right",relevantSize:126,label:"colorLegend",showFlag:d.prototype.ShowFlags.MEDIUM}}},l),this._super(b,c,h,i,j),this.components.dimensionAxisTitle=this.components.xAxisTitle,this.components.dimensionAxisTitle.listen("drill-up",function(a,b,c){k.backendApi.drillUp(b,c)}),this.components.dimensionAxisTitle.setModel(this.$scope.ext.model),this.components.dimensionAxisTitle.setDock(this.components.xAxisTitle.dock),delete this.components.xAxisTitle,this._lastRotation=0},initSelections:function(){this.selections._disableSelections=this.options._disableSelections,this.selections.types.dataArea.setComponent("dataArea",this.components.dataArea),this.selections.types.colorLegend.setComponent("colorLegend",this.components.colorLegend),this.options._disableSelections||(this.selections.Activated.bind(this.onSelection.Activated.bind(this)),this.selections.Deactivated.bind(this.onSelection.Deactivated.bind(this)),this.selections.Lasso.bind(this.onToggleLasso.bind(this)),this.selections.Select.bind(this.onSelection.Select.bind(this)),this.selections.SelectRange.bind(this.onSelection.SelectRange.bind(this)),this.selections.SelectAttributeDim.bind(this.onSelection.SelectAttributeDim.bind(this)),this.selections.ToggleShape.bind(this.onSelection.ToggleShape.bind(this)),this.selections.Confirm.bind(this.onSelection.Confirm.bind(this)),this.selections.Cancel.bind(this.onSelection.Cancel.bind(this)),this.selections.SelectWhileLocked.bind(this.selectWhileLocked.bind(this)))},initTooltips:function(){this.tooltips&&this.tooltips.setComponent("dataArea",this.components.dataArea)},on:function(){if(this._super(),this._navigation){var a=this;this._eventHandlers=q.extend({mousewheel:function(b){var c=m.getMouseWheelData(b.originalEvent);s.apply(a,[a.components.dataArea.getRotation()+5*c.delta]),b.preventDefault()},rotate:{start:function(){a._lastRotation=0,a.components.dataArea.setUseTransition(!1),p.preventGestures(this)},update:function(b,c){s.apply(a,[a.components.dataArea.getRotation()+c.rotation-a._lastRotation]),a._lastRotation=c.rotation,p.preventGestures(this)},end:function(){a.components.dataArea.setUseTransition(!0),p.preventGestures(this)}},tapthree:{end:function(){r(a.components.dataArea),p.preventGestures(this)}},mouseup:function(b){2===b.which&&(b.preventDefault(),r(a.components.dataArea))},exclusive:function(){return!1},active:function(){return!0}}),p.addInteraction(this._eventHandlers,this.components.dataArea.container,2,["mousewheel","tapthree","rotate","mouseup"])}this._on=!0},off:function(){this._navigation&&p.removeInteraction(this._eventHandlers),this._super()},getSnapshotChartData:function(){return a.extend(!0,this._super()||{},{rotation:this.components.dataArea._currentProperties.rotation})},getViewState:function(){return{rotation:this.components.dataArea._currentProperties.rotation}},_paint:function(){var a,c=[];if(!this.isValid(this._data))return this.clear();this._super(),this.layout(),this.components.dataArea.setShowDimensionValues(this._layoutMode>d.prototype.ShowFlags.SPARK);for(a in this.components)c.push(this.components[a].invalidateDisplay("PieChart._paint"));return b.all(c)},isValid:function(a){return this._super(a)&&!this.supressChartRendering},prePaint:function(a){this._super(a),n.applyDisclaimerAttributes({title:!0,bottom:!0,overlay:!0,supportNegative:!1},this.$scope.dataAttributes,this.$element,this.$scope,a),this.supressChartRendering=this.$scope.dataAttributes.onlyNanData||this.$scope.dataAttributes.noDataExist||this.$scope.dataAttributes.onlyNegativeOrZero},_updateData:function(a){this._data=a;var c=this.getSnapshotStoredChartData();this._super(a),this.isDataSelectable(a)&&(this.selections&&this.selections.on(),!this._on&&this.inAnalysisState()&&this.on());var d=[];return d.push(this.providers.colorMap.setData(a)),d.push(this.components.dataArea.setData(a)),d.push(this.components.colorLegend.setData(a)),this.components.dimensionAxisTitle.setType("dimension"),d.push(this.components.dimensionAxisTitle.setData(a)),this.providers.colorMap.setDimensionTree(this._chartContext.getDimensionTree()),this.components.dataArea.setDimensionTree(this._chartContext.getDimensionTree()),a.dataPoint&&this.components.dataArea.setDataPointsLabelMode(a.dataPoint.auto?"share":a.dataPoint.labelMode),a.donut&&this.components.dataArea.setShowAsDonut(a.donut.showAsDonut),a.scale&&this.components.dataArea.setScaleRatio(a.scale),this._readStoredData&&c?this.components.dataArea.setRotation(c.rotation):this.options.viewState?this.components.dataArea.setRotation(this.options.viewState.rotation):a.rotation?this.components.dataArea.setRotation(a.rotation):r(this.components.dataArea),a.dimensionTitle!==!1?this.components.dimensionAxisTitle.showComponent():this.components.dimensionAxisTitle.hideComponent(),b.all(d)},toggleCacheItem:function(a){this.components.dataArea.toggleCacheItem(a),this.components.colorLegend.invalidateDisplay("PieChart#toggleCacheItem")},getPreferredSize:function(){return this._super()},destroy:function(){this._super(),this.components.dimensionAxisTitle&&this.components.dimensionAxisTitle.stopListen("drill-up")}}),{type:"piechart",BackendApi:h,template:l,View:u,definition:i,softDefinition:k,initialProperties:{qHyperCubeDef:{qDimensions:[],qMeasures:[],qInitialDataFetch:[{qWidth:10,qHeight:500}],qSuppressZero:!1,qSuppressMissing:!0}},data:j,support:{cssScaling:!1,snapshot:t,export:t,exportData:!0,sharing:t},options:{selections:{dataArea:{},colorLegend:{}},tooltips:{}},importProperties:o.colorChart.importProperties.bind(o),exportProperties:o.colorChart.exportProperties.bind(o)}}),define("extensions.qliktech/scatterplot/scatter-helper",["general.utils/shapes/circle","general.utils/shapes/rect","general.utils/shapes/polygon"],function(a,b,c){function d(d,e){var f;switch(d){case"circle":f=new a(e[0],e[1],e[2],e[3]);break;case"rect":f=new b(e[0],e[1],e[2],e[3]);break;case"polygon":f=new c}return f}function e(a,b){return a?[]:b}function f(a){return!(!a.dotData||"NaN"===a.dotData.xValue||"NaN"===a.dotData.yValue)}function g(a){return!!(a&&a.cacheItem&&a.cacheItem.selected)}function h(a,b){return!b||!!a.selected||!!a.highlighted}function i(a,b,c,d){return(b?j(a,c.sizeDataMin,c.sizeDataMax,c._minDotSize,c._maxDotSize):c._minDotSize)*d}function j(a,b,c,d,e){var f;return isNaN(a)||null===a?NaN:b===c?(d+e)/2:a<=b?d:a>=c?e:(f=(a-b)/(c-b),d+(e-d)*Math.sqrt(f))}function k(a,b,c,d,e){var f=isNaN(c)||void 0===c,g=f?0:c;return a<-g||a>d+g||b<-g||b>e+g}function l(a,b,c){return a<0?-10+c:a>b?b-c+10:a}function m(a,b,c){var d;for(d=0;d<c.length;d++)if(a[c[d]]!==b[c[d]])return!1;return!0}function n(a,b,c,d,e){return 13!==a.length?null:(a[0].x=b-d+e/2,a[0].y=c-d-e/2,a[1].x=b-d-e/2,a[1].y=c-d+e/2,a[2].x=b-e,a[2].y=c,a[3].x=b-d-e/2,a[3].y=c+d-e/2,a[4].x=b-d+e/2,a[4].y=c+d+e/2,a[5].x=b,a[5].y=c+e,a[6].x=b+d-e/2,a[6].y=c+d+e/2,a[7].x=b+d+e/2,a[7].y=c+d-e/2,a[8].x=b+e,a[8].y=c,a[9].x=b+d+e/2,a[9].y=c-d+e/2,a[10].x=b+d-e/2,a[10].y=c-d-e/2,a[11].x=b,a[11].y=c-e,a[12].x=b-d+e/2,a[12].y=c-d-e/2,a)}function o(a,b){var c,d,e=!1;for(d=0;d<a.length;d++)if(c=a[d],"circle"===c.type){if(m(c,b,["cx","cy","r"])){e=!0;break}}else if(m(c,b,["cx","cy"])){e=!0;break}return e}function p(a,b){var c,d;return c=a.cacheItem.getShapes("dataArea")[0],d=b.cacheItem.getShapes("dataArea")[0],c.cy-c.r>d.cy-d.r?1:c.cy-c.r<d.cy-d.r?-1:c.cx-c.r>d.cx-d.r?1:c.cx-c.r<d.cx-d.r?-1:c.r>d.r?-1:c.r<d.r?1:a.cacheItem.id<b.cacheItem.id?-1:1}function q(a,b){return 0===b?a[1]?a[1]:null:a[b-1]}function r(a,b,c,d){var e,f={x:!1,y:!1};return isNaN(d.cx)||isNaN(d.cy)?(f.y=!0,f):(e=-(b.y-a.y))<0?f:(e<2*a.height+d.r+c.r&&(f.y=!0,Math.abs(b.x-a.x)<a.width/2+b.width/2&&(f.x=!0)),f)}function s(a,b){var c=a.x-a.width/2;return a.maxWidth=a.width,c<0&&(a.maxWidth+=2*c,a.x=a.maxWidth/2),c=a.x+a.width/2-b,c>0&&(a.maxWidth-=2*c),a.maxWidth=Math.max(a.maxWidth,0),a}function t(a,b){return a.x=b.x-b.width/2,a.y=b.y-b.height,a.width=b.maxWidth,a.height=b.height,a}return{createShape:d,checkClearNodes:e,checkNodeValid:f,checkSelected:g,checkShouldRender:h,getRadius:i,getDotRadius:j,outOfBounds:k,outOfBoundsPosition:l,isSame:m,updateCross:n,checkOverlapping:o,sortObjectsForLabels:p,getComparableObject:q,checkLabelInterference:r,checkEllipsis:s,centerLabel:t}}),define("extensions.qliktech/scatterplot/scatter-circle",["objects.views/charts/renderers/canvas-renderer","objects.views/charts/renderers/canvas/circle","objects.views/charts/renderers/canvas/polygon","objects.views/charts/shapes/circle"],function(a,b,c,d){function e(a,d,e){"saltire"===this.type?c.render.apply(this,[a,d,e]):b.render.apply(this,[a,d,e])}function f(a){var b,c=[];for(b=0;b<a;b++)c.push(g());return c}function g(){return{x:0,y:0}}function h(a,b,c,d,e){return 13!==a.length?null:(a[0].x=b-d+e/2,a[0].y=c-d-e/2,a[1].x=b-d-e/2,a[1].y=c-d+e/2,a[2].x=b-e,a[2].y=c,a[3].x=b-d-e/2,a[3].y=c+d-e/2,a[4].x=b-d+e/2,a[4].y=c+d+e/2,a[5].x=b,a[5].y=c+e,a[6].x=b+d-e/2,a[6].y=c+d+e/2,a[7].x=b+d+e/2,a[7].y=c+d-e/2,a[8].x=b+e,a[8].y=c,a[9].x=b+d+e/2,a[9].y=c-d+e/2,a[10].x=b+d-e/2,a[10].y=c-d-e/2,a[11].x=b,a[11].y=c-e,a[12].x=b-d+e/2,a[12].y=c-d-e/2,a)}var i=d.extend("ScatterCircle",{init:function(a,b,c,d,e){this._super(a,b,c),this.type="circle",this.saltireSize=d,this.saltireWidth=e},set:function(a,b,c,d,e){this.saltireSize=this.saltireSize||d,this.saltireWidth=this.saltireWidth||e,this._saltire=h(this._saltire||f(13),a,b,this.saltireSize,this.saltireWidth),this._polygons=[{points:this._saltire}],this._super(a,b,c)}});return a._registerRenderFn(e,i),i}),define("extensions.qliktech/scatterplot/heat-map-light",["core.utils/class","objects.views/charts/shapes/rect","objects.views/charts/shapes/text","general.utils/color","objects.utils/number-formatter","objects.views/charts/renderers/canvas-renderer","objects.views/selections/cache-item-combo","translator"],function(a,b,c,d,e,f,g,h){function i(a){var b=new c;return b.text=this._numberFormatter.format(a.qNum,this._defaultPattern),b.align="center",b.font="11px 'QlikView Sans'",b}function j(a,b,c){a.x=b.x+b.width/2,a.y=b.y+b.height/2+4,a.fill=c?"#fff":"#444"}function k(a,b){var c,d,e,f,g,h=this._binGapCompensation,i=this._rtlBinGapCompensation;c=b.qText,d=this._xAxis.getPositionOfValue(c[0]),f=this._yAxis.getPositionOfValue(c[1]),e=this._xAxis.getPositionOfValue(c[2]),g=this._yAxis.getPositionOfValue(c[3]),a.set(d-h,f-h,e-d+i,g-f+h)}function l(a,b,c){k.call(this,a,b),a.fill=c.toRGBA()}function m(a){var c,e,f=this._data[a],g=new d(this._colorMap.getColor(null,f.qNum/this._maxNrInBin));this._rectShapes[a]||(this._rectShapes[a]=new b(0,0,0,0),this._heatContainer.addChild(this._rectShapes[a]),this._labelShapes[a]=i.call(this,f),this._heatContainer.addChild(this._labelShapes[a])),c=this._rectShapes[a],l.call(this,c,f,g),e=this._labelShapes[a],j.call(this,e,c,g.isDark()),e.visible=c.width>40&&c.height>15}function n(){var a,b=this._binShapes.length;for(a=0;a<b;a++)k.call(this,this._binShapes[a],this._data[a])}function o(){for(var a=0;a<this._numBins;a++)m.call(this,a)}return a.extend("HeatMapLight",{init:function(a,b,c){this._renderer=a,this._heatContainer=b,this._selectedRenderer=c,this._numberFormatter=new e,this._defaultPattern="#.#A",this._binGapCompensation=.5,this._rtlBinGapCompensation=this._binGapCompensation,this._binShapes=[]},setYMirrorMode:function(a){this.yMirrorMode=a,this._rtlBinGapCompensation=this.yMirrorMode?-this._binGapCompensation:this._binGapCompensation},setData:function(a){this._data=a[0].concat(),this._metaData=this._data.splice(0,1)[0],this._maxNrInBin=this._metaData.qNum,this._numBins=this._data?this._data.length:0,this._rectShapes=[],this._labelShapes=[],this._selectedShapes={},this._needToClearShapes=!0},getData:function(){return this._data},setColorMap:function(a){this._colorMap=a},getColorMap:function(){return this._colorMap},hasValidData:function(){return this._data&&this._metaData},setXAxis:function(a){this._xAxis=a},setYAxis:function(a){this._yAxis=a},setCacheItems:function(a){this._cacheItems=a},createCacheItems:function(a){var c,d,e,f,i=[];for(c=0;c<this._numBins;c++)d=this._data[c],this._binShapes.length>c?e=this._binShapes[c]:(e=new b(0,0,0,0),this._binShapes[c]=e),f=new g([0],[],[],[],c,0,d.qElemNumber),f._dimensions[0]=h.get("properties.compression.density")+": "+d.qNum,f.addShape(a,e,!0),i[i.length]=f;return this._binShapes.length>this._numBins&&(this._binShapes=this._binShapes.slice(0,this._numBins)),this._cacheItems=i,i},toggleCacheItem:function(a){var c=a.row;if(a.selected){var e,f,g=this._data[c],h=new d(this._colorMap.getColor(null,g.qNum/this._maxNrInBin));e=new b(0,0,0,0),l.call(this,e,g,h),e.stroke="#333",e.strokeWidth=2,this._selectedRenderer.stage.addChild(e),this._selectedShapes[c]={rect:e},e.invalidate(),e.width>40&&e.height>15&&(f=i.call(this,g),j.call(this,f,e,h.isDark()),this._selectedRenderer.stage.addChild(f),this._selectedShapes[c].label=f,f.invalidate())}else this._selectedShapes[c].rect&&(this._selectedShapes[c].rect.invalidate(),this._selectedRenderer.stage.removeChild(this._selectedShapes[c].rect)),this._selectedShapes[c].label&&(this._selectedShapes[c].label.invalidate(),this._selectedRenderer.stage.removeChild(this._selectedShapes[c].label)),this._selectedShapes[c]=void 0},draw:function(){if(this._data&&this._data.length&&!(this._data.length<1))return this._pixelRatio=f.getDevicePixelToBackingStoreRatio(),this._needToClearShapes&&(this._heatContainer.removeChildren(),this._needToClearShapes=!1),n.call(this),o.call(this),this._renderer.render()},copyHeatMap:function(){return this._renderer._canvas.width&&this._renderer._canvas.height&&(this._imageData=this._renderer._canvas.getContext("2d").getImageData(0,0,this._renderer._canvas.width,this._renderer._canvas.height),this._selectedRenderer&&this._selectedRenderer._updateSize()),this._imageData},getHeatMapCanvas:function(){return this._renderer._canvas},clipSelected:function(a){this._renderer._canvas.width&&this._renderer._canvas.height&&(this._selectedRenderer.clear(),this._selectedRenderer._canvas.getContext("2d").putImageData(this._imageData,0,0,a.x*this._pixelRatio,a.y*this._pixelRatio,a.width*this._pixelRatio,a.height*this._pixelRatio))},clearSelection:function(){this._selectedRenderer.stage.removeChildren(),this._selectedRenderer.clear()},release:function(){this._renderer=null,this._heatContainer=null,this._selectedRenderer=null}})}),define("extensions.qliktech/scatterplot/scatterarea",["objects.views/charts/components/chart-component","extensions.qliktech/scatterplot/scatter-helper","objects.views/charts/renderers/canvas-renderer","./scatter-circle","objects.views/charts/shapes/text","objects.views/charts/shapes/rect","objects.views/charts/shapes/line","objects.views/charts/utils/tree-iterator","objects.views/charts/chart-style-service","general.utils/color","core.utils/deferred","extensions.qliktech/scatterplot/heat-map-light","objects.views/charts/shapes/container","client.utils/theme/modern/theme","core.utils/feature-flags"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){"use strict";function p(a,b,c,d){return a.set(b,c,d),a}function q(a){var b,c=a.length;for(b=0;b<c;b++)a[b].renderer.setAttribute("style",{opacity:a[b].visible?1:0});setTimeout(function(){for(b=0;b<c;b++)a[b].renderer.setAttribute("style",{visibility:a[b].visible?"":"hidden"})},500)}function r(a){var b="scatterPlot";return o.THEMING?{backgroundColor:a.getStyle("","backgroundColor"),dataPoint:{label:{color:a.getStyle("label.value","color"),font:"normal "+a.getStyle("label.value","fontSize")+" 'QlikView Sans'",background:a.getStyle("","backgroundColor")}},line:{color:a.getStyle("label.value","color"),width:1},shape:{border:{width:1},selected:{border:{color:"rgba(0,0,0,0.7)",width:2}},outOfBounds:{opacity:.3}}}:{backgroundColor:a.getValue(b,null,"backgroundColor"),dataPoint:{label:{color:a.getValue(b,"value","color"),font:a.getFont(b,"value"),background:a.getValue(b,"value","background")}},shape:{border:{width:a.getValue(b,"shape.border","width")},selected:{border:{color:a.getValue(b,"shape.border","color"),width:a.getValue(b,"shape.border","width","selected")}},outOfBounds:{opacity:a.getValue(b,"shape.outOfBounds","opacity")}},line:{color:a.getValue(b,"line","color"),width:a.getValue(b,"line","width")}}}function s(a){var c,e,f,g,h,i,j,l,m,n,o,r,s,t=this._tree,u=this._tree.children.length,v=b.createShape("circle",[0,0,0,0]),w=this.rect.width,x=this.rect.height,y=this._dots,z=this,A=[],B=[],C=3,D=this._canvasShapes,E=this._data.qHyperCube.qMeasureInfo.length>2&&!this._data.qHyperCube.qIsReduced,F=Math.min(this.rect.height,this.rect.width)/300,G=this.selectionIdentifier?this.selectionIdentifier:"dataArea",H=this._styles;if(!u)return void this.clear();if(this._renderedNodes=b.checkClearNodes(!a,this._renderedNodes),t.children.forEach(function(k){if(b.checkNodeValid(k)&&(i=!1,g=b.checkSelected(k),k.selected=g,k.highlighted=k.cacheItem.highlighted,m=g?H.shape.selected.border.width:H.shape.border.width,n=g?.9:void 0,"dimension"===k.data.type)){if(!b.checkShouldRender(k,a)||!z._currentProperties.values)return;if(!(o=z._currentProperties.values[k.data.qElemNo]))return;if(c=z._xAxis.getPositionOfValue(o.xValue),e=z._yAxis.getPositionOfValue(o.yValue),f=b.getRadius(o.rValue,E,z._currentProperties,F),isNaN(c)||isNaN(e))return;f=f<.5?.5:f,C=f<C?f:C,j=isNaN(f)||void 0===f,k.dotData.outOfBounds=i=b.outOfBounds(c,e,f,w,x),i&&(f=C,c=b.outOfBoundsPosition(c,w,f),e=b.outOfBoundsPosition(e,x,f)),l=j&&!i,v=p(y[k.dotData.dotIndex],c,e,l?6:f),h=k.cacheItem,h.clearShapes(G),h.addShape(G,v,!0),k.dotData.color=z._colorMap.getColor(k.data.qElemNo,k._children[0].data.qNum,0,k.data.rowIndex),s=!1,k.selected||(s=b.checkOverlapping(i?B:A,v,c,e,1)),s||(r=D[k.idx],r?r.fill=k.dotData.color.toRGBA():(r=new d(0,0,0,3,1),r.fill=k.dotData.color.toRGBA(),r.strokeWidth=m,r.opacity=n,r.stroke=g?H.shape.selected.border.color:z._sheetBackgroundColor.toRGBA(),r.data.label=k.data.qText?k.data.qText.substr(0,128):"",D[k.idx]=r),i?z._isBigData||(r.set(v.cx,v.cy,v.r),r.type="circle",B.push(r)):(r.set(v.cx,v.cy,v.r),r.type=j?"saltire":"circle",a||(A.push(r),z._renderedNodes.push(k))))}}),!a){var I=[];return this.renderers.dots.stage.removeChildren(),this.renderers.dots.stage.addChildren(A),I.push(this.renderers.dots.render()),this._isBigData?q.call(this,[{renderer:this.renderers.oob,visible:!1}]):(q.call(this,[{renderer:this.renderers.oob,visible:!0}]),this.renderers.oob.stage.removeChildren(),this.renderers.oob.stage.addChildren(B),I.push(this.renderers.oob.render())),k.all(I)}}function t(){var a,c,d,h,i,j,k,l,m,n,o,p,q,r=this._renderedNodes.length,s=this,t=[],v=this._labelShapes,w=this.renderers.labels,x=this._styles,y=this.selectionIdentifier?this.selectionIdentifier:"dataArea";return r&&(j=this._renderedNodes.sort(b.sortObjectsForLabels),j.forEach(function(r,w){if(v[r.data.rowIndex]&&(v[r.data.rowIndex].visible=!1),h=r.cacheItem,c=r.dotData.label,a=h.getShapes(y)[0],i=h.toggleShapes[0],n=w-1,k=b.getComparableObject(j,w),c.x=a.cx,c.y=a.cy-a.r-5,!c||r.dotData.outOfBounds)return void i.set(0,0,0,0);if(s._labelMode===u.AUTO&&k){if(l=k.cacheItem.getShapes(y)[0],d=k.dotData.label,m=b.checkLabelInterference(c,d,a,l),m.x&&m.y)return void(i.width=0);for(;m.y&&n>0;)if(n--,k=0!==w?j[n]:null,l=k.cacheItem.getShapes(y)[0],d=k.dotData.label,m=b.checkLabelInterference(c,d,a,l),m.x&&m.y)return void(i.width=0)}if(c.y-c.height<0||c.y>s.rect.height)return void i.set(0,0,0,0);c=b.checkEllipsis(c,s.rect.width),i=b.centerLabel(i,c),i.width&&(v[r.data.rowIndex]?(p=v[r.data.rowIndex].rect,o=v[r.data.rowIndex].text,q=v[r.data.rowIndex].line,v[r.data.rowIndex].visible=!0):(p=new f,o=new e,q=new g,v[r.data.rowIndex]={visible:!0,rect:p,text:o,line:q},p.fill=x.dataPoint.label.background,o.fill=x.dataPoint.label.color,o.align="center",o.font=x.dataPoint.label.font,o.baseline="bottom",q.stroke=x.line.color),o.setText(c.text),o.x=c.x,o.y=c.y,o.maxWidth=c.maxWidth,p.x=o.x-o.maxWidth/2-2,p.y=i.y,p.width=i.width+4,p.height=i.height,q.set(c.x,c.y-2,c.x,c.y+3),t.push(p),t.push(o),t.push(q))})),w.stage.removeChildren(),w.stage.addChildren(t),w.render()}var u;return u={NONE:0,AUTO:1,ALL:2},a.extend({init:function(){this._super.apply(this,arguments),this._data=null,this._layoutMode=null,this._selectableShapes=[],this._dots=[],this._binShapes=[],this._labelRects=[],this._cacheItems=[],this._renderedNodes=[],this._showDataPoints=!0,this._colorMap=null,this._navigationVisible=!1,this._globalAlpha=1,this._canvasShapes={},this._labelMode=u.AUTO,this._transitionProperties._minDotSize=2,this._transitionProperties._maxDotSize=10,this._style={dataPoints:{color:"#666",font:"12px 'QlikView Sans'"}},this._styles={},this._styleService=o.THEMING?n.initializeService("object.scatterPlot"):i.getInstance(),this._styles=r(this._styleService),this._sheetBackgroundColor=new j(this._styles.backgroundColor),this._sheetBackgroundColor.setAlpha(.3),this.renderers={heat:new c(this.container,{name:"heat"}),selectedHeat:new c(this.container,{name:"selectedHeat"}),dots:new c(this.container,{name:"dots"}),labels:new c(this.container,{name:"labels"}),oob:new c(this.container,{name:"oob"})},this._heatContainer=new m,this.renderers.heat.stage.addChild(this._heatContainer),this._heatMap=new l(this.renderers.heat,this._heatContainer,this.renderers.selectedHeat);this.renderers.heat.setAttribute("style",{webkitTransition:"opacity 0.5s linear",mozTransition:"opacity 0.5s linear",transition:"opacity 0.5s linear"}),this.renderers.dots.setAttribute("style",{webkitTransition:"opacity 0.5s linear",mozTransition:"opacity 0.5s linear",transition:"opacity 0.5s linear"}),this.renderers.labels.setAttribute("style",{webkitTransition:"opacity 0.5s linear",mozTransition:"opacity 0.5s linear",transition:"opacity 0.5s linear"}),this.perpendicularlyRelevantSpacing={top:10,left:10,right:10,bottom:10},this._transitionHelper.setTransitionTime(500,0)},setYMirrorMode:function(a){this.yMirrorMode=a,this._heatMap&&this._heatMap.setYMirrorMode(a)},setIsBigData:function(a){this._isBigData=a},getIsBigData:function(){return this._isBigData},setIsReduced:function(a){a!==this._isReduced&&(this._reducedModeChanged=!0,this._isReduced=a)},getIsReduced:function(){return this._isReduced},setHeatMapData:function(a){this._heatMap.setData(a)},getHeatMapData:function(){return this._heatMap.getData()},setColorMap:function(a){this._colorMap=a},getColorMap:function(){return this._colorMap},setHeatColorMap:function(a){this._heatColorMap=a,this._heatMap.setColorMap(this._heatColorMap)},getHeatColorMap:function(){return this._heatColorMap},setXAxis:function(a){this._xAxis=a,this._heatMap.setXAxis(a),this._xAxis.listen("changed",function(){this.invalidateDisplay()},this)},setYAxis:function(a){this._yAxis=a,this._heatMap.setYAxis(a),this._yAxis.listen("changed",function(){this.invalidateDisplay()},this)},setDimensionTree:function(a){this._tree=a,this.invalidateProperties(),this.invalidateDisplay()},setMinDotSize:function(a){this._transitionProperties._minDotSize=a,this.invalidateDisplay()},setMaxDotSize:function(a){this._transitionProperties._maxDotSize=a,this.invalidateDisplay()},setLabelMode:function(a){this._labelMode=a,this.invalidateDisplay()},setNavigation:function(a){this._navigationVisible=a,this.invalidateDisplay()},preRelevantSizeCalculation:function(){this.perpendicularlyRelevantSpacing={top:10,left:10,right:10,bottom:10}},_updateSize:function(){this.invalidateDisplay()},setData:function(a){this._super(a)},_updateProperties:function(){if(this._data&&(this._isReduced||this._tree)){this._canvasShapes={},this._labelShapes={};var a,c,d,e,f,g,i,j,k=[],l=this._data.qHyperCube.qDimensionInfo.length,m=this._data.qHyperCube.qMeasureInfo.length,n=this._tree,o=this,p=this._dots,q=this._labelRects,r=0,s=this._dots.length,t=l+1,v=this.renderers.dots,w=this._style.dataPoints,x=this.selectionIdentifier?this.selectionIdentifier:"dataArea";return this._onlySelected=!1,o._transitionProperties.values={},o._transitionProperties.nodes={},m>2&&(o._transitionProperties.sizeDataMin=this._data.qHyperCube.qMeasureInfo[2].qMin,o._transitionProperties.sizeDataMax=this._data.qHyperCube.qMeasureInfo[2].qMax),!this._isReduced&&this._tree?(e=n.children.length,e&&h.each.call(n,function(e,m){if(j=h.getLevel.call(e),e.idx=m,j===t-1){if(l>1&&m>0)return;f=e.children[0].data.qNum,g=e.children[1].data.qNum,i=e.children.length>2?e.children[2].data.qNum:.5,e.dotData={color:null,label:null},l<=1&&(e.dotData.dotIndex=r++,s<r?(a=b.createShape("circle",[0,0,0,0]),c=b.createShape("rect",[0,0,0,0]),p.push(a),q.push(c)):(a=o._dots[e.dotData.dotIndex],a.cx=NaN,a.cy=NaN,c=o._labelRects[e.dotData.dotIndex]),o._labelMode===u.NONE&&(c.width=NaN,c.height=NaN),d=e.cacheItem,d.addShape(x,a,!0),d.toggleShapes=[c],k.push(d),o._transitionProperties.values[e.data.qElemNo]={xValue:f,yValue:g,rValue:i}),e.dotData.label={x:0,y:0,width:0,height:0,text:e.data.qText},e.dotData.label.width=v.getTextWidth(e.dotData.label.text,w.font),e.dotData.label.height=v.getFontHeight(w.font)}}),this._dots.length>r&&(this._dots=this._dots.slice(0,r),this._labelRects=this._labelRects.slice(0,r)),this._heatMap.setCacheItems()):k=this._heatMap.createCacheItems(x),this._cacheItems=k,this.setSelectableShapes(k),this._super()}},hasValidData:function(){return this._super()&&this._data&&(this._tree||this._isReduced&&this._heatMap.hasValidData())&&this._xAxis&&this._yAxis},paint:function(){var a=this;if(this._super(this._layoutMode,this._data),this._xAxis&&this._yAxis&&this._data&&this.renderers){if(this._xAxis.updateNow(),this._yAxis.updateNow(),this.renderers.oob.edgeBleed={left:10,right:10,bottom:10,top:10},this._styles=r(this._styleService),!this._renderData)return this.clear();if(this.renderers.dots.stage.opacity=this._globalAlpha||1,this.renderers.labels.stage.opacity=this._globalAlpha||1,this.renderers.heat.setAttribute("style",{opacity:this._globalAlpha||1}),this._isReduced)return this._reducedModeChanged?(this._reducedModeChanged=!1,q.call(this,[{renderer:this.renderers.heat,visible:!0},{renderer:this.renderers.selectedHeat,visible:!0},{renderer:this.renderers.dots,visible:!1},{renderer:this.renderers.labels,visible:!1},{renderer:this.renderers.oob,visible:!1}]),this._heatMap.draw()):(this.renderers.labels.stage.removeChildren(),this.renderers.labels.clear(),this.renderers.dots.stage.removeChildren(),this.renderers.dots.clear(),this.renderers.oob.stage.removeChildren(),
this.renderers.oob.clear(),this._heatMap.draw());if(this._tree.children.length>0){var b=function(){var b,c,d=[];return b=s.apply(a,[a._onlySelected]),b&&d.push(b),a._onlySelected=!1,a._labelMode>u.NONE&&a._layoutMode>a.ShowFlags.XSMALL?(c=t.apply(a,[]))&&d.push(c):(a.renderers.labels.stage.removeChildren(),d.push(a.renderers.labels.clear())),k.all(d)};return this._reducedModeChanged?(this._reducedModeChanged=!1,q.call(this,[{renderer:this.renderers.heat,visible:!1},{renderer:this.renderers.selectedHeat,visible:!1},{renderer:this.renderers.dots,visible:!0},{renderer:this.renderers.labels,visible:!0}]),b()):(this.renderers.selectedHeat.clear(),this.renderers.selectedHeat.stage.removeChildren(),b())}}},clear:function(){return this._transitionHelper.clear(),this._super()},toggleCacheItem:function(a){if(this._isReduced)this._heatMap.toggleCacheItem(a);else{var b=!0,c=this._styles,d=this;this.renderers.dots.stage.opacity!==this._globalAlpha&&(b=!1,this.renderers.dots.stage.opacity=this._globalAlpha,this.renderers.labels.stage.opacity=this._globalAlpha);var e=this._canvasShapes[a.row],f=this._labelShapes[a.row];e&&(a.selected?(e.strokeWidth=2,e.stroke=c.shape.selected.border.color,e.opacity=.9,e.zIndex=1,f&&f.visible&&(f.text.opacity=1,f.line.opacity=1,f.zIndex=1)):(e.opacity=void 0,e.stroke=d._sheetBackgroundColor.toRGBA(),e.strokeWidth=1,e.zIndex=void 0,f&&f.visible&&(f.text.opacity=void 0,f.line.opacity=void 0,f.zIndex=void 0)),b&&(e.invalidate(),f&&f.visible&&f.text.invalidate())),b||(this.renderers.dots.render(),this.renderers.labels.render(),this.renderers.oob.render())}},updateRangeSelection:function(a){this._heatMap.copyHeatMap(a),this._heatMap.clipSelected(a)},startRangeSelection:function(a){this._heatMap.copyHeatMap(a)},copyHeatMap:function(){return this._heatMap.copyHeatMap()},getHeatMapCanvas:function(){return this._heatMap.getHeatMapCanvas()},clearSelection:function(){this._heatMap.clearSelection()},setRenderData:function(a){this._renderData=a},release:function(){this._super(),this._styleService=null,this._styles=null,this._sheetBackgroundColor=null,this._heatMap.release(),this._heatContainer.removeChildren(),this.renderers=null,this._heatContainer=null,this._heatMap=null}})}),define("objects.views/charts/representation/basic-color-map",["core.utils/class","general.utils/color-cache","objects.views/charts/representation/color-scale","client.utils/theme/theme-module"],function(a,b,c,d){function e(a,b){return a&&a.length>1&&b&&b.length&&(a.length===b.length+1||a.length/2===b.length+1)}function f(a,c,d){return a.gradient?[b.retriveBlend(c,d,.5),d]:[d,d]}function g(a,c){var d=c.map(function(a){return b.retriveColor(a)});if(void 0!==a[0].value){var e=[];a[0].gradient?Array.prototype.push.apply(e,[d[0],b.retriveBlend(d[0],d[1],.5)]):Array.prototype.push.apply(e,[d[0],d[0]]);for(var g=1;g<d.length;g++)Array.prototype.push.apply(e,f(a[g-1],d[g-1],d[g]));return{colors:e,limits:a.map(function(a){return a.value})}}return{colors:d,limits:a}}var h=d.get();return a.extend("BasicColorMap",{init:function(a){if(this._valid=e(a.colors,a.limits),this._max=isNaN(a.max)?1:a.max,this._min=a.min||0,this._valid){var b=g(a.limits.reverse(),a.colors.reverse());this._colorScale=new c,this._colorScale.setMaxMinValues(this._max,this._min),this._colorScale.setLimits(b.limits);for(var d=0;d<b.colors.length;d+=2)this._colorScale.addColorPart(b.colors[d],b.colors[d+1])}},setMaxMin:function(a,b){this._max=a,this._min=b},getColor:function(a,c){return this._valid?this._colorScale.getColor(c):b.retriveColor(h.dataColors.nullColor)},getColorMapping:function(){var a,b,c=this._colorScale.getLegendParts(),d=this._max-this._min,e=c.length,f=d/e,g=this._max,h=[];for(b=0;b<e-1;b++)a=c[b],a.isMax=0===b,a.max=g,a.min=g-f,a.id=[g,g-f],a.type="range",g-=f,h.push(a);return a=c[b],a.max=g,a.min=this._min,a.id=[g,this._min],a.type="range",h.push(a),h},getSelectionIndices:function(){return[0]},getValueFormatter:function(){return null},getColorDataInfo:function(){return{legendMode:{discrete:!1,boxType:null,colorMode:"expression",selectionEnabled:!1,altMode:!1}}},getColorFromPreScaledValue:function(a){return this._colorScale.getColor(a)},getLegendDataProvider:function(){return null},setLegendTitle:function(a){this._legendTitle=a},getLegendTitle:function(){return this._legendTitle},getLegendMode:function(){return["scale",null,"expression",!0]}})}),define("extensions.qliktech/scatterplot/scatterplot-properties",["translator","client.utils/default-property-logic","core.utils/feature-flags"],function(a,b,c){var d,e,f,g=b.getLogicFor("hard","scatterplot");f={component:"text",translation:"properties.compression.willNotAffect",show:function(a,b){return g.helpers.showCompressionResolution(b.layout)}},d={uses:"settings",items:{presentation:{type:"items",translation:"properties.presentation",grouped:!0,items:{showNavigation:{ref:"navigation",type:"boolean",translation:"Common.Navigation",component:"switch",defaultValue:!1,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}]},bubbleSizeItems:{type:"items",items:{bubbleSizes:{type:"integer",component:"slider",ref:"dataPoint.bubbleSizes",translation:"properties.dataPoints.bubbleSizes",min:1,max:20,step:1,defaultValue:5,show:function(a){return a.qHyperCubeDef.qMeasures.length<3}},rangeBubbleSizes:{type:"array",component:"slider",ref:"dataPoint.rangeBubbleSizes",translation:"properties.dataPoints.bubbleSizes",min:1,max:20,step:1,defaultValue:[2,8],show:function(a){return a.qHyperCubeDef.qMeasures.length>=3}},rangeBubbleCompressionNote:f}},label:{type:"items",items:{labelMode:{ref:"labels.mode",translation:"properties.labels",type:"string",component:"dropdown",defaultValue:1,options:[{value:1,translation:"Common.Auto"},{value:2,translation:"Common.All"},{value:0,translation:"Common.None"}],snapshot:{tid:"property-labels"}},labelModeCompressionNote:f}},queryLevel:{type:"integer",component:"slider",ref:"compressionResolution",translation:"properties.compression.resolution",min:4,max:8,step:1,defaultValue:5,show:function(a,b){return g.helpers.showCompressionResolution(b.layout)}},gridLines:{type:"items",snapshot:{tid:"property-gridLines"},items:{showGridLines:{ref:"gridLine.auto",type:"boolean",translation:"properties.gridLine.spacing",component:"switch",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}]},gridSpacing:{ref:"gridLine.spacing",type:"number",component:"dropdown",defaultValue:2,options:[{value:0,translation:"properties.gridLine.noLines"},{value:1,translation:"properties.gridLine.wide"},{value:2,translation:"properties.gridLine.medium"},{value:3,translation:"properties.gridLine.narrow"}],show:function(a){return!a.gridLine.auto}}}}}},colorsAndLegend:{uses:"colorsAndLegend",items:{colors:{items:{autoColor:{},colorsAnLegendCompressionNote:f,colorMode:{defaultValue:"primary",options:g.color.colorMode.options},persistentColors:{show:g.color.persistentColors.show}}},legend:{items:{show:{show:g.legend.show,snapshot:{tid:"property-legend"}},showTitle:{show:g.legend.showTitle.show},dock:{show:g.legend.dock.show}}}}},xAxis:{type:"items",uses:"axis.measureAxis",label:function(b,c){var d=c.getMeasureLayouts()[0];return d&&!d.qError?a.get("properties.xAxisWithInfo",[d.qFallbackTitle]):a.get("properties.xAxis")},items:{axis:{items:{show:{ref:"xAxis.show",snapshot:{title:"properties.xAxis",tid:"property-xAxis"}},dock:{ref:"xAxis.dock",show:function(a){return"none"!==a.xAxis.show},options:[{value:"near",translation:"Common.Bottom"},{value:"far",translation:"Common.Top"}]},spacing:{ref:"xAxis.spacing",show:function(a){return"none"!==a.xAxis.show}}}},minMax:{type:"items",items:{autoMinMax:{ref:"xAxis.autoMinMax"},minMax:{ref:"xAxis.minMax",show:function(a){return!a.xAxis.autoMinMax}},min:{ref:"xAxis.min",show:function(a){return["min","minMax"].contains(a.xAxis.minMax)&&!a.xAxis.autoMinMax},invalid:function(a){return"minMax"===a.xAxis.minMax&&a.xAxis.min>=a.xAxis.max}},max:{ref:"xAxis.max",show:function(a){return["max","minMax"].contains(a.xAxis.minMax)&&!a.xAxis.autoMinMax},invalid:function(a){return"minMax"===a.xAxis.minMax&&a.xAxis.min>=a.xAxis.max}}}}}},yAxis:{type:"items",uses:"axis.measureAxis",label:function(b,c){var d=c.getMeasureLayouts()[1];return d&&!d.qError?a.get("properties.yAxisWithInfo",[d.qFallbackTitle]):a.get("properties.yAxis")},items:{axis:{items:{show:{ref:"yAxis.show",snapshot:{title:"properties.yAxis",tid:"property-yAxis"}},dock:{ref:"yAxis.dock",show:function(a){return"none"!==a.yAxis.show},options:[{value:"near",translation:"properties.dock.left"},{value:"far",translation:"properties.dock.right"}]},spacing:{ref:"yAxis.spacing",show:function(a){return"none"!==a.yAxis.show}}}},minMax:{type:"items",items:{autoMinMax:{ref:"yAxis.autoMinMax"},minMax:{ref:"yAxis.minMax",show:function(a){return!a.yAxis.autoMinMax}},min:{ref:"yAxis.min",show:function(a){return["min","minMax"].contains(a.yAxis.minMax)&&!a.yAxis.autoMinMax},invalid:function(a){return"minMax"===a.yAxis.minMax&&a.yAxis.min>=a.yAxis.max}},max:{ref:"yAxis.max",show:function(a){return["max","minMax"].contains(a.yAxis.minMax)&&!a.yAxis.autoMinMax},invalid:function(a){return"minMax"===a.yAxis.minMax&&a.yAxis.min>=a.yAxis.max}}}}}}}};var h={uses:"data"};return e={type:"items",component:"expandable-items",translation:"properties.addons",items:{refLinesX:{uses:"reflines",ref:"refLine.refLinesX",translation:"properties.referenceLinesX"},refLinesY:{uses:"reflines",ref:"refLine.refLinesY",translation:"properties.referenceLinesY"},dataHandling:{uses:"dataHandling"}}},c.DIM_COLOR||(d.items.colorsAndLegend.items.colors.items.baseColors={type:"items",show:!1,items:{useBaseColor:{ref:"color.useBaseColors",show:!1,defaultValue:"off"}}}),{type:"items",component:"accordion",items:{data:h,addons:e,settings:d}}}),define("extensions.qliktech/scatterplot/scatterplot-explore-properties",["client.utils/default-property-logic","client.utils/property-hypercube-helper"],function(a,b){var c=a.getLogicFor("explore","scatterplot");return{type:"items",component:"accordion",items:{data:{uses:"data"},presentation:{uses:"presentation",items:{showNavigation:{type:"boolean",translation:"Common.Navigation",component:"switch",ref:"navigation",options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}]},showLabels:{component:"radio-list",translation:"properties.labels",type:"number",ref:"labels.mode",options:function(){return[{value:1,translation:"Common.Auto"},{value:2,translation:"Common.All"},{value:0,translation:"Common.None"}]}},bubbleSizes:{type:"integer",component:"slider",ref:"dataPoint.bubbleSizes",translation:"properties.dataPoints.bubbleSizes",min:1,max:20,step:1,show:function(a){return b.getNumMeasures(a)<3}},rangeBubbleSizes:{type:"array",component:"slider",ref:"dataPoint.rangeBubbleSizes",translation:"properties.dataPoints.bubbleSizes",min:1,max:20,step:1,show:function(a){return b.getNumMeasures(a)>2}},queryLevel:{type:"integer",component:"slider",ref:"compressionResolution",translation:"properties.compression.resolution",min:4,max:8,step:1,show:function(a,b){return c.helpers.showCompressionResolution(b)}}}},color:{uses:"color",items:{mode:{options:c.color.colorMode.options},dimension:{items:{colorScheme:{show:function(a,c){var d=b.getDimensionLayouts(c)[0];return!(d&&d.qCardinal<=12)}},persistentColors:{show:!0}}}}}}}}),define("extensions.qliktech/scatterplot/scatterplot-data",["client.utils/property-resolver"],function(a){function b(a){var b=a.getMeasures();2===b.length?a.setSorting([2,1,0]):3===b.length&&a.setSorting([3,2,1,0])}function c(b,c){var d=c.getMeasures();"byExpression"===a.getValue(b,"color.mode")&&0===d.length&&a.setValue(b,"color.mode","primary")}return{dimensions:{min:1,max:1},measures:{min:2,max:3,add:function(a,c,d){b(d),a.qSortBy.qSortByNumeric=-1},remove:function(a,d,e){b(e),c(d,e)}}}}),define("text!extensions.qliktech/scatterplot/scatterplot.ng.html",[],function(){return'<div class="qv-viz" style="position: relative;"></div>\n<span class="qv-viz-disclaimer"\n\t  ng-if="dataAttributes.reduceDataDisc  && dataAttributes.layoutMode > 2"\n\t  qva-direction x-dir-setting="{{options.direction}}" x-dir-text="{{reducedDataNote}}">\n\t<span class="ltr-star">*</span>\n\t<span>{{ reducedDataNote }}</span>\n\t<span class="rtl-star">*</span>\n</span>\n<span class="qv-viz-center-disclaimer" ng-if="dataAttributes.noDataExist  && dataAttributes.layoutMode > 2" q-translation="Object.Disclaimer.NoDataExist" q-title-translation="Object.Disclaimer.NoDataExist" dir="ltr"></span>\n<span class="qv-viz-center-disclaimer" ng-if="dataAttributes.onlyNanData  && dataAttributes.layoutMode > 2" q-translation="Object.Disclaimer.OnlyNanData" q-title-translation="Object.Disclaimer.OnlyNanData" dir="ltr"></span>\n<div qva-scatter-navigation>\n\t<!--on-navigation="onNavigation"\n\tnavigation-disabled="navigationDisabled"\n\tnavigation-home-only="navigationHomeOnly"\n\tnavigation-visible="navigationVisible"\n\tnavigation-style="navigationPosition"-->\n</div>\n<div qva-scatter-mini-map ng-show="showMiniMap" ng-style="miniMapStyle" colorMap="colorMap"></div>\n'}),define("text!extensions.qliktech/scatterplot/directives/navigation/scatterplot-navigation.ng.html",[],function(){return'<div class="qv-scatter-nav" ng-style="navigationStyle">\n\t<div ng-show="navigationHomeOnly && navigationVisible" class="qv-scatter-nav-homeonly">\n\t\t<button class="qv-scatter-nav-home qui-plainbuttonicon" data-icon="ü" qva-activate="onHomePressed()" ng-disabled="navigationDefaultPosition || navigationDisabled" q-title-translation="Object.Navigation.ResetZoom" />\n\t</div>\n\t<div ng-show="!navigationHomeOnly && navigationVisible" class="qv-scatter-nav-fullnav">\n\t\t<div class="qv-scatter-nav-top">\n\t\t\t<button class="qv-scatter-nav-up qui-plainbuttonicon" data-icon="R" qva-activate="onNavigationPressed(\'navUp\')" ng-disabled="navigationDisabled" q-title-translation="Object.Navigation.PanUp" />\n\t\t</div>\n\t\t<div class="qv-scatter-nav-middle">\n\t\t\t<button class="qv-scatter-nav-left qui-plainbuttonicon" data-icon="T" qva-activate="onNavigationPressed(\'navLeft\')" ng-disabled="navigationDisabled" q-title-translation="Object.Navigation.PanLeft" />\n\t\t\t<button class="qv-scatter-nav-home qui-plainbuttonicon" data-icon="ü" qva-activate="onHomePressed()" ng-disabled="navigationDefaultPosition || navigationDisabled" q-title-translation="Object.Navigation.ResetZoom" />\n\t\t\t<button class="qv-scatter-nav-right qui-plainbuttonicon" data-icon="U" qva-activate="onNavigationPressed(\'navRight\')" ng-disabled="navigationDisabled" q-title-translation="Object.Navigation.PanRight" />\n\t\t</div>\n\t\t<div class="qv-scatter-nav-bottom">\n\t\t\t<button class="qv-scatter-nav-down qui-plainbuttonicon" data-icon="S" qva-activate="onNavigationPressed(\'navDown\')" ng-disabled="navigationDisabled" q-title-translation="Object.Navigation.PanDown" />\n\t\t\t<button class="qv-scatter-nav-in qui-plainbuttonicon" data-icon="Y" qva-activate="onNavigationPressed(\'zoomIn\')" ng-disabled="navigationDisabled" q-title-translation="Object.Navigation.ZoomIn" />\n\t\t\t<button class="qv-scatter-nav-out qui-plainbuttonicon" data-icon="Z" qva-activate="onNavigationPressed(\'zoomOut\')" ng-disabled="navigationDisabled" q-title-translation="Object.Navigation.ZoomOut" />\n\t\t</div>\n\t</div>\n</div>'}),define("extensions.qliktech/scatterplot/directives/navigation/scatterplot-navigation",["qvangular","text!./scatterplot-navigation.ng.html"],function(a,b){a.directive("qvaScatterNavigation",function(){return{template:b,replace:!0,link:function(a){a.onHomePressed=function(){a.$broadcast("navigationPressed","resetZoom")},a.onNavigationPressed=function(b){a.$broadcast("navigationPressed",b)}}}})}),define("extensions.qliktech/scatterplot/axis-light",["core.utils/class"],function(a){return a.extend("AxisLight",{init:function(a,b,c,d){this._values={min:a,max:b},this._positions={min:c,max:d}},setYMirrorMode:function(a){this.yMirrorMode=a},setValues:function(a){this._values=a},getValues:function(){return this._values},setPositions:function(a){this._positions=a},getPositions:function(){return this._positions},getPositionOfValue:function(a){var b=(a-this._values.min)/(this._values.max-this._values.min),c=this._positions.max-this._positions.min;return this.yMirrorMode?this._positions.max-c*b:this._positions.min+c*b}})}),define("text!extensions.qliktech/scatterplot/directives/mini-map/scatterplot-mini-map.ng.html",[],function(){return'<div class="qv-scatter-mini-map">\n\t<div class="scatter-mini-map"></div>\n\t<div class="scatter-mini-map-focus" ng-style="focusStyle"></div>\n</div>'}),define("extensions.qliktech/scatterplot/directives/mini-map/scatterplot-mini-map",["qvangular","objects.views/charts/renderers/canvas-renderer","extensions.qliktech/scatterplot/axis-light","extensions.qliktech/scatterplot/heat-map-light","text!./scatterplot-mini-map.ng.html","objects.views/charts/shapes/container","touche"],function(a,b,c,d,e,f){a.directive("qvaScatterMiniMap",function(){return{template:e,replace:!0,link:function(a,e){function g(b){if(m){var c=q.getPositionOfValue(m.xMin),d=r.getPositionOfValue(m.yMax),e=q.getPositionOfValue(m.xMax)-q.getPositionOfValue(m.xMin),f=r.getPositionOfValue(m.yMin)-r.getPositionOfValue(m.yMax),g=b.width-2,h=b.height-2;c<0?(e+=c,c=0):c>g&&(c=g,e=0),d<0?(f+=d,d=0):d>h&&(d=h,f=0),c+e>g&&(e=g-c),d+f>h&&(f=h-d),f=f>h?h:f,e=e>g?g:e,a.focusStyle={left:c,top:d,width:e,height:f}}}function h(b,c){n=e.offset();var d=a.focusStyle.width,f=a.focusStyle.height,g={x:c.pagePoints[0].x-n.left,y:c.pagePoints[0].y-n.top},h={x:a.focusStyle.left+d/2,y:a.focusStyle.top+f/2},i=(g.x-h.x)/(m.scale*e.width()),j=(g.y-h.y)/(m.scale*e.height());a.$broadcast("navigationPressed","jumpTo",{x:-i*l.width,y:-j*l.height})}function i(){Touche(e[0]).tap({id:p,end:function(a,b){h(a,b)}});var b;Touche(e[0]).swipe({id:p,start:function(){n=e.offset();var c=a.focusStyle.width,d=a.focusStyle.height;b={x:a.focusStyle.left+c/2,y:a.focusStyle.top+d/2},a.$broadcast("navigationPressed","startAt",{x:0,y:0})},update:function(c,d){var f={x:d.pagePoints[0].x-n.left,y:d.pagePoints[0].y-n.top},g=(f.x-b.x)/(m.scale*e.width()),h=(f.y-b.y)/(m.scale*e.height());a.$broadcast("navigationPressed","moveTo",{x:-g*l.width,y:-h*l.height}),b=f},end:function(){a.$broadcast("navigationPressed","endAt")}})}function j(){Touche(e[0]).off("*",p)}var k,l,m,n,o=e.find(".scatter-mini-map"),p=".scatterplot-mini-map",q=new c,r=new c,s=new b(o[0],{name:"overview"}),t=new f;s.stage.addChild(t),k=new d(s,t),k.setXAxis(q),k.setYAxis(r),k.setColorMap(a.colorMap);var u=[];u.push(a.$on("onUpdateMiniMapData",function(a,b){k.setData(b)})),u.push(a.$on("onYMirrorModeChange",function(a,b){k.setYMirrorMode(b),q.setYMirrorMode(b)})),u.push(a.$on("onResizeMiniMap",function(a,b,c){q.setPositions({min:0,max:b.width}),r.setPositions({min:b.height,max:0}),s.setDimensions(0,0,b.width,b.height),g({width:b.width,height:b.height}),l=c,k.draw()})),u.push(a.$on("onUpdateMiniMap",function(a,b){var c=e.width(),d=e.height();q.setValues(b.x),q.setPositions({min:0,max:c}),r.setValues(b.y),r.setPositions({min:d,max:0}),s.setDimensions(0,0,e.width(),e.height()),k.draw()})),u.push(a.$on("onUpdateMiniMapFocus",function(a,b,c,d,f){var h=q.getValues();m={xMin:b,yMin:d,xMax:c,yMax:f,scale:(c-b)/(h.max-h.min)},k.yMirrorMode&&(m.scale=-m.scale),g({width:e.width(),height:e.height()})})),u.push(a.$on("onResetMiniMapFocus",function(){a.focusStyle={left:0,top:0,width:e.width(),height:e.height()}})),a.$on("$destroy",function(){for(j();u.length;)u.pop()();t.removeChildren(),s.release(),k.release(),q=null,r=null,p=null,s=null,t=null,k=null}),a.$watch("interactive",function(a){a?i():j()})}}})}),define("extensions.qliktech/scatterplot/scatterplot",["jquery","core.utils/deferred","translator","objects.views/charts/axis-chart","objects.views/charts/components/chart-component","objects.views/charts/components/ref-line-labels","objects.views/charts/utils/binding","./scatterarea","objects.views/charts/representation/combo-color-map","objects.views/charts/representation/basic-color-map","objects.backend-api/hypercube-api","extensions.qliktech/scatterplot/scatterplot-properties","extensions.qliktech/scatterplot/scatterplot-explore-properties","extensions.qliktech/scatterplot/scatterplot-data","text!./scatterplot.ng.html","objects.utils/event-utils","objects.views/charts/disclaimers/chart-utils","objects.extension/object-conversion","objects.utils/number-formatter","objects.views/charts/utils/pan-zoom-controller","extensions.qliktech/scatterplot/directives/navigation/scatterplot-navigation","extensions.qliktech/scatterplot/directives/mini-map/scatterplot-mini-map","touche"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){"use strict";function u(){}function v(a){var b,c=[],d=a[0].qMatrix;if(c.push(d[0][0]),a[0].reformatted)for(b=1;b<d.length;b++)try{c.push(d[b][0])}catch(a){}else{for(b=1;b<d.length;b++)try{d[b][0].qText=JSON.parse(d[b][0].qText),c.push(d[b][0])}catch(a){}a[0].reformatted=!0}return[c]}function w(){var a=this.selections&&this.selections.getActiveType();a&&!/^item/.test(a.getActiveMode())&&a.clearSelection(),this.selections&&this.selections.enabled&&(this._selectionsOffDuringPanZoom=!0,this.selections.enabled=!1),this.tooltips&&(this.tooltips.clearSelection(),this.tooltips.enabled=!1)}function x(){this._selectionsOffDuringPanZoom&&(this._selectionsOffDuringPanZoom=!1,this.selections&&(this.selections.enabled=!0),this.tooltips&&(this.tooltips.enabled=!0))}function y(a,b,c){return void 0===c&&(c=0),0===a?Math.abs(b)<=c:Math.abs(b/a-1)<=c}function z(a,b,c,d,e){void 0===e&&(e=0);var f=Math.abs(b-a)*e;return Math.abs(c-a)<=f&&Math.abs(d-b)<=f}function A(a,b,c,d,e,f,g){return this._axisInfoAtHomeState&&z(this._axisInfoAtHomeState.x.min,this._axisInfoAtHomeState.x.max,a,b,g)&&z(this._axisInfoAtHomeState.y.min,this._axisInfoAtHomeState.y.max,c,d,g)&&(void 0===e||void 0===f||y(this._axisInfoAtHomeState.x.size,e,g)&&y(this._axisInfoAtHomeState.y.size,f,g))}function B(){var a=this.components.xAxis,b=this.components.yAxis;if(this._isHomeState=A.call(this,a.getPlotMin(),a.getPlotMax(),b.getPlotMin(),b.getPlotMax(),a.getPlotSize(),b.getPlotSize(),_),this.rect&&this._data){var c=this.rect.width>=400&&this.rect.height>=400,d=this._layoutMode>=3,e=this.inAnalysisState()||this.inEditState(),f=this._data.navigation?d&&!c:d,g=this._navigation&&(!this._isHomeState||e&&d&&!!this._data.navigation),h=this;this.$scope.navigationHomeOnly=f,this.$scope.navigationVisible=g,this.$scope.navigationDefaultPosition=this._isHomeState,this.yMirrorMode?this.$scope.navigationStyle={top:this.components.dataArea.rect.y+5+"px",left:this.components.dataArea.rect.x+17+"px"}:this.$scope.navigationStyle={top:this.components.dataArea.rect.y+5+"px",right:this.rect.width-this.components.dataArea.rect.x-this.components.dataArea.rect.width+5+"px"},setTimeout(function(){h.$scope.$apply()})}}function C(){var a=this.components.dataArea,b=a._xAxis,c=a._yAxis;this._axisInfo.x.min=!this._data.xAxis.autoMinMax&&["min","minMax"].contains(this._data.xAxis.minMax)?Number(this._data.xAxis.min):null,this._axisInfo.x.max=!this._data.xAxis.autoMinMax&&["max","minMax"].contains(this._data.xAxis.minMax)?Number(this._data.xAxis.max):null,this._axisInfo.y.min=!this._data.yAxis.autoMinMax&&["min","minMax"].contains(this._data.yAxis.minMax)?Number(this._data.yAxis.min):null,this._axisInfo.y.max=!this._data.yAxis.autoMinMax&&["max","minMax"].contains(this._data.yAxis.minMax)?Number(this._data.yAxis.max):null,b.setPlotMin(this._axisInfo.x.min),b.setPlotMax(this._axisInfo.x.max),c.setPlotMin(this._axisInfo.y.min),c.setPlotMax(this._axisInfo.y.max)}function D(){var a=this.components.dataArea,b=a._xAxis,c=a._yAxis;this._axisInfoAtHomeState={x:{size:b.getPlotSize(),max:b.getPlotMax(),min:b.getPlotMin()},y:{size:c.getPlotSize(),max:c.getPlotMax(),min:c.getPlotMin()}}}function E(){this.$scope.navigationDisabled=this.navigationDisabled||this._disabledPanZoom}function F(a){this._disabledPanZoom=a,this.$scope&&E.call(this)}function G(){if(!this._disabledPanZoom){var a=this.components.dataArea,b=a._xAxis,c=a._yAxis,d=this;w.call(this),b.setUseTransition(this._oldUseTransition),c.setUseTransition(this._oldUseTransition),C.call(this),this._axisInfoAtHomeStateNeedToUpdate=!0,this._isHomeState=!0,u.call(this),this._paint(),setTimeout(function(){d._debouncedUpdateLayout.call(d),d.$scope.$emit("onResetMiniMapFocus"),d.$scope.showMiniMap=!1},1e3)}}function H(){this._disabledPanZoom||(this._cancelDebounce(this),this._inPanZoom=!0,this._axisInfoAtHomeStateNeedToUpdate&&D.call(this),this._axisInfoAtHomeStateNeedToUpdate=!1,this.components.xAxis.setUseTransition(!1),this.components.yAxis.setUseTransition(!1),w.call(this))}function I(a,b){if(!this._disabledPanZoom){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=this.components.xAxis,t=this.components.yAxis;this._isHomeState&&this._needUpdateMiniMap&&R.call(this),a.identityIfClose($),this._plotMaxMinNeedToUpdate&&(this._xAxisMin=s.getPlotMin(),this._xAxisMax=s.getPlotMax(),this._yAxisMin=t.getPlotMin(),this._yAxisMax=t.getPlotMax(),this._plotMaxMinNeedToUpdate=!1),p=s.getPlotSize(),q=t.getPlotSize(),this.yMirrorMode?(d={x:p,y:q},e={x:0,y:0}):(d={x:0,y:q},e={x:p,y:0}),f=a.transformPoint(d),g=a.transformPoint(e),h=g.x-f.x,i=g.y-f.y,j=this._xAxisMax-this._xAxisMin,k=this._yAxisMax-this._yAxisMin,l=this._xAxisMin-f.x/h*j,m=this._xAxisMin+(p-f.x)/h*j,n=this._yAxisMax-(g.y-q)/i*k,o=this._yAxisMax-g.y/i*k,b&&this._axisInfoAtHomeState&&A.call(this,l,m,n,o,void 0,void 0,aa)&&(l=this._axisInfoAtHomeState.x.min,m=this._axisInfoAtHomeState.x.max,n=this._axisInfoAtHomeState.y.min,o=this._axisInfoAtHomeState.y.max),s.setPlotMin(l),s.setPlotMax(m),t.setPlotMin(n),t.setPlotMax(o),this.components.dataArea.clearSelection(),this.components.dataArea.getIsReduced()&&this.components.dataArea.renderers.heat.transformScene(a),r.$scope.$emit("onUpdateMiniMapFocus",l,m,n,o);for(c in this.components)"dataArea"===c&&this.components.dataArea.getIsReduced()||this.components[c].invalidateDisplay();B.call(this)}}function J(){this._disabledPanZoom||(this._inPanZoom=!1,this._debouncedUpdateLayout())}function K(){var a=this._panZoomController._viewportProjection.getTransformMatrix();if(!a.isIdentity()){var b=this._xAxisOldSize,c=this._yAxisOldSize;if(b&&c){var d=this.components.xAxis,e=this.components.yAxis,f=d.getPlotSize(),g=e.getPlotSize();if(b!==f||c!==g){var h,i,j,k;this.yMirrorMode?(h=this._xAxisMax,i=this._xAxisMin,j=d.getPlotMax(),k=d.getPlotMin()):(h=this._xAxisMin,i=this._xAxisMax,j=d.getPlotMin(),k=d.getPlotMax());var l=this._yAxisMin,m=this._yAxisMax,n=e.getPlotMin(),o=e.getPlotMax(),p=a.clone(),q=a.clone(),r=i-h,s=m-l,t=k-j,u=o-n;p.set([[f/r,0,-f*h/r],[0,-g/s,g*m/s],[0,0,1]]),q.set([[f/t,0,-f*j/t],[0,-g/u,g*o/u],[0,0,1]]),p.invert(),a=q.multiply(p),a.identityIfClose($),this._panZoomController._viewportProjection.setTransformMatrix(a),this._panZoomController.reset()}}}}function L(){this._plotMaxMinNeedToUpdate=!0;var a=this._panZoomController._viewportProjection;a.setTransformMatrix(a.getTransformMatrix().identity())}function M(a,d,e,f,g){if(!this._inPanZoom){if(this._dataDfd=b(),this._ready=this._dataDfd.promise,!this._data||isNaN(a)||isNaN(d)||isNaN(e)||isNaN(f))return this._fetchedData=!0,this.$scope.throbberApi.hide(),b.resolve();var h=this,i=this._data.compressionResolution?this._data.compressionResolution:Y,j=g?g-1:0,k=Math.min(i+j,Z),l=function(){return h._fetchedData=!0,h.prePaint(h._data),b.all([h._updateData(h._data)]).then(function(){h._dataDfd.resolve(),h.$scope.throbberApi.hide(),h.backendApi.isSnapshot&&(h._isBigData=h._data.dataPages&&h._data.dataPages.length>0&&h._data.dataPages[0].qMatrix.length>0,h.components.dataArea.setIsBigData(h._isBigData))})};return this.backendApi.getHyperCubeBinnedData(void 0===h._data?void 0:[{qTop:0,qLeft:0,qWidth:h._data.qHyperCube.qSize.qcx,qHeight:h._data.qHyperCube.qSize.qcy}],[{qLeft:a,qTop:d,qWidth:e,qHeight:f}],1e3,k).then(function(a){if(!h._inPanZoom){if(!h._data||!a||h._destroyed)return h._fetchedData=!0,void h.$scope.throbberApi.hide();if(L.call(h),h.components.dataArea.setIsBigData(!0),a[0].qMatrix.length>0){h._isReduced=!0,h._data.qHyperCube.isReduced=!0;var b=v([a[0]]);return h.components.dataArea.setHeatMapData(b),h._heatMapData=h.components.dataArea.getHeatMapData(),h._heatColorMap.setMaxMin(b[0][0].qNum,0),h._needUpdateMiniMap&&h.$scope.$emit("onUpdateMiniMapData",b),h.components.dataArea.setIsReduced(!0),h.$scope.reducedDataNote=c.get("properties.compression.providingOverviewOf",[h._numberFormatter.format(h._data.qHyperCube.qSize.qcy,h._defaultPattern)]),l()}return h._isReduced=!1,h._data.qHyperCube.isReduced=!1,h._data.qHyperCube.qDataPages=[a[1]],h.components.dataArea.setIsReduced(!1),l()}})}}function N(){this._layoutMode<=3?this.$scope.miniMapStyle={display:"none"}:this.$scope.miniMapStyle={display:"block",left:this.yMirrorMode?this.components.dataArea.rect.x+10:this.components.dataArea.rect.x+.85*this.components.dataArea.rect.width-10,top:this.components.dataArea.rect.y+.85*this.components.dataArea.rect.height-10,width:.15*this.components.dataArea.rect.width,height:.15*this.components.dataArea.rect.height}}function O(){this.$scope.showMiniMap=!(!this._isBigData||this._isHomeState||this.components.xAxis.getPlotMin()<=this._resettedAxisInfo.x.min&&this.components.xAxis.getPlotMax()>=this._resettedAxisInfo.x.max&&this.components.yAxis.getPlotMin()<=this._resettedAxisInfo.y.min&&this.components.yAxis.getPlotMax()>=this._resettedAxisInfo.y.max)}function P(){var a=this.components.dataArea.rect.width,b=this.components.dataArea.rect.height;N.call(this),O.call(this),this.$scope.$emit("onResizeMiniMap",this.$scope.miniMapStyle,{width:a,height:b})}function Q(){var a={colors:["rgba(111,153,197,1.0)","rgba(29,51,72,1.0)"],limits:[{value:.5,gradient:!0}],min:0,max:1};this._heatColorMap=new j(a),this._heatColorMap.setLegendTitle(c.get("properties.compression.density")),this.components.dataArea&&this.components.dataArea.setHeatColorMap(this._heatColorMap)}function R(){this._resettedAxisInfo.x.min=this.components.xAxis.getPlotMin(),this._resettedAxisInfo.x.max=this.components.xAxis.getPlotMax(),this._resettedAxisInfo.y.min=this.components.yAxis.getPlotMin(),this._resettedAxisInfo.y.max=this.components.yAxis.getPlotMax(),this.$scope.$emit("onUpdateMiniMap",this._resettedAxisInfo),this.$scope.showMiniMap=!1,this._needUpdateMiniMap=!1}function S(a,b){if(0===a.length)return[];var c,d,e,f,g,h,i,j,k=a.length,l=[],m=0;for(f="x"===b?"y":"x",g=b+"Min",h=b+"Max",i=f+"Min",j=f+"Max",a.sort(function(a,b){return a[g]>b[g]?1:a[g]!==b[g]?-1:a[g]===b[g]?a[i]-b[i]:void 0}),c=a[0],l[m]=d={xMin:c.xMin,xMax:c.xMax,yMin:c.yMin,yMax:c.yMax},e=1;e<k;e++)c=a[e],d[g]===c[g]&&d[h]===c[h]&&d[j]===c[i]?d[j]=c[j]:(m++,l[m]=d={xMin:c.xMin,xMax:c.xMax,yMin:c.yMin,yMax:c.yMax});return l}function T(a){var b,c,d,e,f,g,h,i,j,k,l,m=a?a.length:0,n=new Array(m),o=[];for(b=0;b<m;b++)c=this._heatMapData[a[b]].qText,d=Math.min(c[0],c[2]),f=Math.min(c[1],c[3]),e=Math.max(c[0],c[2]),g=Math.max(c[1],c[3]),n[b]={xMin:d,xMax:e,yMin:f,yMax:g};for(j=S(S(n,"x"),"y"),k=S(S(n,"y"),"x"),l=j.length>k.length?k:j,m=l.length,b=0;b<m;b++)c=l[b],h={idx:0,range:{max:c.xMax,min:c.xMin},type:"measure"},i={idx:1,range:{max:c.yMax,min:c.yMin},type:"measure"},o[b]=[h,i];return o}function U(){var a=this.components.dataArea._cacheItems,b=a.filter(function(a){return a.selected}).map(function(a){return a.row}),c=T.call(this,b);c&&0!==c.length?(V.call(this,c),F.call(this,!0)):(this.backendApi.clearSelections(),F.call(this,!1))}function V(a){var b=this;this.backendApi.selectRects(a,!1).then(function(a){a||(b.backendApi.clearSelections(),W.call(b,!1))})}function W(){this.components.dataArea.getIsReduced()&&this.components.dataArea.clearSelection(),F.call(this,!1)}var X,Y=6,Z=8,$=1e-9,_=1e-5,aa=1e-4;return X=d.extend("ScatterPlot",{init:function(b,c,d,j,k){var l=this;d=a.extend(!0,d||{},{providers:{
colorMap:{clazz:i,colorBy:"dimension",autoMode:"primary"}},components:{refLines:{sortKey:5,show:!0,dock:"center",showFlag:e.prototype.ShowFlags.SPARK},dataArea:{sortKey:10,show:!0,dock:"center",clazz:h,showFlag:e.prototype.ShowFlags.SPARK},grid:{showFlag:e.prototype.ShowFlags.XSMALL},refLineLabelsX:{show:!0,dock:"top",order:3,showFlag:e.prototype.ShowFlags.XSMALL,clazz:f},refLineLabelsY:{show:!0,dock:"right",order:3,showFlag:e.prototype.ShowFlags.XSMALL,clazz:f}}}),this._resettedAxisInfo={x:{min:0,max:0},y:{min:0,max:0}},this._axisInfo={x:{min:null,max:null},y:{min:null,max:null}},this._super(b,c,d,j,k),this.backendApi.setCacheOptions({enabled:!1}),this._numberFormatter=new s,this._defaultPattern="#.#A",this._oldUseTransition=this.components.xAxis.getUseTransition(),this.components.dataArea.setYAxis(this.components.yAxis),this.components.dataArea.setXAxis(this.components.xAxis),this.components.xAxisTitle.setType("measure"),this.components.yAxisTitle.setType("measure"),this.components.xAxisTitle.setModel(b.ext.model),this.components.yAxisTitle.setModel(b.ext.model),this.components.yAxis.setShowExplicitMinMax(!1),this.components.xAxis.setShowExplicitMinMax(!1),this.components.grid.setAxes(this.components.xAxis,this.components.yAxis),this.providers.colorMap.getLegendDataProvider().setLegendMarker("circle"),Q.call(this),b.colorMap=this._heatColorMap,this.components.xAxis.getTransitionHelper().setTransitionTime(700),this.components.yAxis.getTransitionHelper().setTransitionTime(700),this.components.dataArea.getTransitionHelper().setTransitionTime(700),this._changeWatchers.push(g.bindProperty(this.components.dataArea,"dimensionTree",this._chartContext,"dimensionTree")),this._changeWatchers.push(g.bindProperty(this.providers.colorMap,"dimensionTree",this._chartContext,"dimensionTree")),this._panZoomController=new t(a(this.components.dataArea.container),{start:function(){H.call(l)},update:function(a){I.call(l,a)},end:function(a){I.call(l,a,!0),J.call(l)},reset:function(){G.call(l)}}),this._panZoomController.setZoomPanByWebkitTransform(!1),this._debouncedUpdateLayout=p.debounce(function(){if(!l._inPanZoom){var a=l._data.qHyperCube.qSize.qcy>1e3&&!this.backendApi.isSnapshot,b=l.components.xAxis.getPlotMin(),c=l.components.xAxis.getPlotMax(),d=l.components.yAxis.getPlotMin(),e=l.components.yAxis.getPlotMax(),f=Math.floor(Math.sqrt((l._data.qHyperCube.qMeasureInfo[1].qMax-l._data.qHyperCube.qMeasureInfo[1].qMin)/(e-d)));a?(l._dataUpdatedOnPanOrZoom=!0,M.call(this,b,e,c-b,e-d,f).then(function(){u.call(l),l._paint().then(function(){l.components.xAxis.setUseTransition(l._oldUseTransition),l.components.yAxis.setUseTransition(l._oldUseTransition)})})):(u.call(l),l._paint().then(function(){l.components.xAxis.setUseTransition(l._oldUseTransition),l.components.yAxis.setUseTransition(l._oldUseTransition)}))}},400,this),this._cancelDebounce=p.cancelDebounce,this.onNavigationPressed=b.$on("navigationPressed",function(a,b,c){a.preventDefault(),!l._disabledPanZoom&&l._panZoomController.navigate(b,c)}),this.navigationDisabled=!0,E.call(this)},getVerticalComponents:function(){var a=this._super();return this.components&&this.components.refLineLabelsY&&this._data&&this._data.yAxis&&a.push({comp:this.components.refLineLabelsY,dock:"far"===this._data.yAxis.dock?"near":"far"}),a},setYMirrorMode:function(a){this.yMirrorMode!==a&&(this._super(a),this.$scope.$emit("onYMirrorModeChange",a),this.updateVerticalComponentsDock())},initSelections:function(){var a=this,b=this.components.dataArea;this.selections._disableSelections=this.options._disableSelections,this.selections.types.colorLegend.setComponent("colorLegend",this.components.colorLegend),this.selections.types.dataArea.setComponent("dataArea",this.components.dataArea),this.options._disableSelections||(this.selections.types.range.setComponent("dataArea",this.components.dataArea),this.selections.types.range.setComponent("x",this.components.xAxis),this.selections.types.range.setComponent("y",this.components.yAxis),this.selections.Activated.bind(function(){b.getIsReduced()&&b.copyHeatMap(),a._inSelectionMode=!0,a.onSelection.Activated.call(a)}),this.selections.Deactivated.bind(function(){a._inSelectionMode=!1,a.onSelection.Deactivated.call(a)}),this.selections.Lasso.bind(this.onToggleLasso.bind(this)),this.selections.Select.bind(this.Select.bind(this)),this.selections.SelectRange.bind(a.onSelection.SelectRange.bind(this)),this.selections.ToggleShape.bind(this.onSelection.ToggleShape.bind(this)),this.selections.Confirm.bind(this.Confirm.bind(this)),this.selections.Cancel.bind(this.onSelection.Cancel.bind(this)),this.selections.Clear.bind(this.Clear.bind(this)),this.selections.SelectAttributeDim.bind(this.onSelection.SelectAttributeDim.bind(this)),this.selections.SelectWhileLocked.bind(this.selectWhileLocked.bind(this)),this.selections.ResetSelections.bind(function(){b.getIsReduced()&&b.clearSelection()}))},initTooltips:function(){this.tooltips.setComponent("dataArea",this.components.dataArea)},Select:function(a,b){this._isReduced?U.call(this,a):this.onSelection.Select.apply(this,[a,b,0,"",this._data.qHyperCube.qSize.qcy>1e3])},Clear:function(){this.onSelection.Clear.call(this),W.call(this)},Confirm:function(){this.onSelection.Confirm.call(this),W.call(this)},_paint:function(){var c=this;return this._super().then(function(d){if(!d||!d.invalid)return c._ready.then(function(){if(c._destroyed)return b.resolve();var d,e=[];this.components.dataArea&&(this._offset=a(this.components.dataArea.container).offset());var f=this.components.xAxis,g=this.components.yAxis;this._xAxisOldSize=f?f.getPlotSize():void 0,this._yAxisOldSize=g?g.getPlotSize():void 0,this.layout(),this.components.dataArea&&this._panZoomController.setOffset(a(this.components.dataArea.container).offset());for(d in this.components)e.push(this.components[d].invalidateDisplay());return this._axisInfoAtHomeStateNeedToUpdate&&D.call(this),B.call(this),K.call(this),P.call(this),x.call(this),b.all(e)}.bind(this))}.bind(this))},on:function(){if(!this._on&&(this._super(),this._navigation)){if(B.call(this),this.supressDotRendering)return void(this.selections&&this.selections.off());this._panZoomController.on(".scatterplot"),this.$scope.interactive=!0,this.navigationDisabled=!1,E.call(this)}},off:function(){this.navigationDisabled=!0,E.call(this),this.$scope.interactive=!1,this._on&&(this._navigation&&(B.call(this),this._panZoomController.off(),Touche(this.components.dataArea.container).off("*",".scatterplot"),Touche(this.container).off("*",".scatterplot"),a(this.components.dataArea.container).off(".scatterplot"),a(this.container).off(".scatterplot")),this._super())},isValid:function(a){return this._super(a)&&a.qHyperCube.qMeasureInfo.length>=2&&!this.supressChartRendering},resize:function(){var a=new b,c=this;return this._isHomeState&&!this.backendApi.isSnapshot&&(C.call(this),this._axisInfoAtHomeStateNeedToUpdate=!0),this._super().then(function(){c.rect&&u.call(c),a.resolve()}),a.promise},prePaint:function(a){this._super(a),this.$scope.dataAttributes.limitedData=a.qHyperCube.qSize.qcy>1e3,this.$scope.dataAttributes.reduceDataDisc=this.$scope.dataAttributes.limitedData,q.applyDisclaimerAttributes({title:!1,bottom:!0,overlay:!1,explicitLimitedData:this.$scope.dataAttributes.limitedData,direction:this.$scope.options.direction},this.$scope.dataAttributes,this.$element,this.$scope,a),this.$scope.dataAttributes.noDataExist||(this.$scope.dataAttributes.onlyNanData=a.qHyperCube.qMeasureInfo.slice(0,2).some(function(a){return a.qMax<a.qMin||"NaN"===a.qMax})),this.supressChartRendering=this.$scope.dataAttributes.onlyNanData||this.$scope.dataAttributes.noDataExist,this.supressDotRendering=this.supressChartRendering},setInteractionState:function(a,b){this._super(a,b),this._oldUseTransition=this.components.xAxis.getUseTransition()},_updateHyperCube:function(a){var c,d=[];return this._dataUpdatedOnPanOrZoom||(this._isHomeState=!0),d.push(this.components.dataArea.setData(a)),d.push(this.providers.colorMap.setData(a)),d.push(this.components.colorLegend.setData(a)),d.push(this.components.xAxisTitle.setData([{label:a.qHyperCube.qMeasureInfo[0].qFallbackTitle,index:0}])),d.push(this.components.yAxisTitle.setData([{label:a.qHyperCube.qMeasureInfo[1].qFallbackTitle,index:1}])),c=this.getSnapshotStoredChartData(),this._readStoredData&&c?(this.components.xAxis.setPlotMin(c.xAxisMin),this.components.xAxis.setPlotMax(c.xAxisMax),this.components.yAxis.setPlotMin(c.yAxisMin),this.components.yAxis.setPlotMax(c.yAxisMax)):this.options.viewState&&(this.components.xAxis.setPlotMin(this.options.viewState.xAxisMin),this.components.xAxis.setPlotMax(this.options.viewState.xAxisMax),this.components.yAxis.setPlotMin(this.options.viewState.yAxisMin),this.components.yAxis.setPlotMax(this.options.viewState.yAxisMax)),a.legend&&this.components.colorLegend[(this.supressDotRendering||!a.legend.auto&&!a.legend.show?"hide":"show")+"Component"](),b.all(d)},_updateData:function(a){var c,d=this;this._data=a;var e=this.selectionsCache.getSelectedValuesInColumn(0).slice();if(this._fetchedData)return c={axes:{xAxis:{component:this.components.xAxis,data:a.xAxis,title:"",dataIndices:[0]},yAxis:{component:this.components.yAxis,data:a.yAxis,title:"",dataIndices:[1]}},refLineLabels:{x:{axis:this.components.xAxis,data:a.refLine?a.refLine.refLinesX:"",component:this.components.refLineLabelsX},y:{axis:this.components.yAxis,data:a.refLine?a.refLine.refLinesY:"",component:this.components.refLineLabelsY}},axisTitles:{xAxisTitle:{component:this.components.xAxisTitle},yAxisTitle:{component:this.components.yAxisTitle}},refLines:{component:this.components.refLines}},this._super(a,c),e&&this.selectionsCache.setValues(e),this._fetchedData=!1,this.components.colorLegend.setColorMap(this._isReduced?this._heatColorMap:this.providers.colorMap),this._updateHyperCube(a);if(this._dataUpdatedOnPanOrZoom=!1,this._axisInfoAtHomeStateNeedToUpdate=!0,this._isBigData=a.qHyperCube.qSize.qcy>1e3,this._needUpdateMiniMap=!0,this._isBigData){var f=a.xAxis.autoMinMax||"min"!==a.xAxis.minMax&&"minMax"!==a.xAxis.minMax?a.qHyperCube.qMeasureInfo[0].qMin:a.xAxis.min,g=a.xAxis.autoMinMax||"max"!==a.xAxis.minMax&&"minMax"!==a.xAxis.minMax?a.qHyperCube.qMeasureInfo[0].qMax:a.xAxis.max,h=a.yAxis.autoMinMax||"min"!==a.yAxis.minMax&&"minMax"!==a.yAxis.minMax?a.qHyperCube.qMeasureInfo[1].qMin:a.yAxis.min,i=a.yAxis.autoMinMax||"max"!==a.yAxis.minMax&&"minMax"!==a.yAxis.minMax?a.qHyperCube.qMeasureInfo[1].qMax:a.yAxis.max;this.$scope.throbberApi.show(),M.call(this,f,i,g-f,i-h)}else this._dataDfd=b(),this._ready=this._dataDfd.promise,this._isReduced=!1,a.qHyperCube.isReduced=!1,this.backendApi.getData([{qTop:0,qLeft:0,qWidth:a.qHyperCube.qSize.qcx,qHeight:1e3}]).then(function(a){if(d._destroyed)return void d._dataDfd.resolve();d._data.qHyperCube.qDataPages=a,d._fetchedData=!0,d.components.dataArea.setIsBigData(!1),d.components.dataArea.setIsReduced(!1),L.call(d),d.prePaint(d._data),b.all([d._updateData(d._data)]).then(function(){d._dataDfd.resolve()})});return this._ready},updateDataArea:function(a,b){this._super(a,b),a.qHyperCube.qMeasureInfo.length>2&&a.dataPoint.rangeBubbleSizes?a.dataPoint.rangeBubbleSizes.length>0&&(this.components.dataArea.setMinDotSize(a.dataPoint.rangeBubbleSizes[0]),a.dataPoint.rangeBubbleSizes.length>1&&this.components.dataArea.setMaxDotSize(a.dataPoint.rangeBubbleSizes[1])):a.dataPoint.bubbleSizes&&this.components.dataArea.setMinDotSize(a.dataPoint.bubbleSizes),null!==a.labels.mode&&this.components.dataArea.setLabelMode(a.labels.mode),this.components.dataArea.setRenderData(!this.supressDotRendering),this.supressDotRendering?(this.selections&&this.selections.off(),this._on&&this.off()):!this.supressDotRendering&&this.isDataSelectable(a)&&(this.selections&&this.selections.on(),this._on||this.inEditState()||this.on())},updateAxis:function(b,c){if(!this._dataUpdatedOnPanOrZoom){a.extend(c.axisTitles.xAxisTitle,{data:b.xAxis}),a.extend(c.axisTitles.yAxisTitle,{data:b.yAxis}),this._super(b,c);var d,e,f,g,h,i,j,k,l=0;for(g in c.axes)d=c.axes[g],f=d.dataIndices[0],e=d.component,h=b.qHyperCube.qMeasureInfo[f].qMin,i=b.qHyperCube.qMeasureInfo[f].qMax,j=!d.data.autoMinMax&&["min","minMax"].contains(d.data.minMax)?Number(d.data.min):null,k=!d.data.autoMinMax&&["max","minMax"].contains(d.data.minMax)?Number(d.data.max):null,i<h?(i=10,h=-10):h===i&&0===i||isNaN(h)&&isNaN(i)?(i=10,h=-10):l=Math.abs(i!==h?.02*(i-h):.1*i),this.setAxisDataRange(e,Math.max(h,i+l),h-l,k,j,l)}},updateRefLines:function(a,b){this._super(a,b);for(var c in b.refLineLabels)b.refLineLabels[c].component.setLabelMargin(10)},toggleCacheItem:function(a){this.components.dataArea.toggleCacheItem(a),this.components.colorLegend.invalidateDisplay("ScatterPlot#toggleCacheItem")},getSnapshotData:function(a,b,c,d,e,f){var g=this._data&&this._data.compressionResolution?this._data.compressionResolution:Y,h=f?f-1:0;return this.backendApi.getHyperCubeBinnedData([{qTop:0,qLeft:0,qWidth:a.qHyperCube.qSize.qcx,qHeight:a.qHyperCube.qSize.qcy}],[{qLeft:b,qTop:c,qWidth:d,qHeight:e}],1e3,Math.min(g+h,Z)).then(function(b){a.dataPages=b,a.foo="custom"})},setSnapshotData:function(a){if(this._super(a),!(this._isReduced||a.qHyperCube.qSize.qcy>1e3))return b.resolve();var c=this.components.xAxis.getPlotMin(),d=this.components.xAxis.getPlotMax(),e=this.components.yAxis.getPlotMin(),f=this.components.yAxis.getPlotMax(),g=Math.floor(Math.sqrt((this._data.qHyperCube.qMeasureInfo[1].qMax-this._data.qHyperCube.qMeasureInfo[1].qMin)/(f-e)));return this.getSnapshotData(a,c,f,d-c,f-e,g)},getSnapshotChartData:function(){return a.extend(!0,this._super()||{},{xAxisMin:this.components.xAxis.getPlotMin(),xAxisMax:this.components.xAxis.getPlotMax(),yAxisMin:this.components.yAxis.getPlotMin(),yAxisMax:this.components.yAxis.getPlotMax()})},getViewState:function(){return{xAxisMin:this.components.xAxis.getPlotMin(),xAxisMax:this.components.xAxis.getPlotMax(),yAxisMin:this.components.yAxis.getPlotMin(),yAxisMax:this.components.yAxis.getPlotMax()}},getPreferredSize:function(){return this._super()},clear:function(){return this.$scope.navigationVisible=!1,this._super()},destroy:function(){this._super(),this.onNavigationPressed(),this._panZoomController.release(),this._destroyed=!0}}),{type:"scatterplot",BackendApi:k,template:o,View:X,definition:l,softDefinition:m,initialProperties:{qHyperCubeDef:{qDimensions:[],qMeasures:[],qSuppressMissing:!0}},data:n,support:{cssScaling:!1,snapshot:!0,export:!0,exportData:!0,sharing:!0},options:{selections:{dataArea:{},range:{},colorLegend:{}},tooltips:{}},importProperties:r.colorChart.importProperties.bind(r),exportProperties:r.colorChart.exportProperties.bind(r)}}),define("extensions.qliktech/linechart/line-objects-model",["core.utils/class","util"],function(a,b){function c(a,b,c,d){return c<a||d>b}var d={LINE:"line",AREA:"area",STACKED:"stackedArea"},e={GAP:"gap",CONNECT:"connect",ZERO:"zero"};return a.extend("LineObjectsModel",{init:function(){this._lineObjectSettings=[]},update:function(a,c){this._updateLineObjectsSettings(a,b.extend({selections:this._getSelected(a,c.numDimensions)},c))},getLineObjectsSettings:function(){return this._lineObjectSettings},getPointsOutOfRange:function(){return this._outOfRange.points},_updateLineObjectsSettings:function(a,c){var d,e,f,g,h,i,j,k=a?a.length:0;for(this._outOfRange={up:{},down:{},points:[]},this._lineObjectSettings=[],d=0;d<k;d++)e=a[d],f=c.minorAxes[c.measureToAxisIndex[e.measureIdx]],g=c.axesSettings[c.measureToAxisIndex[e.measureIdx]],h=this._getColorSettings(c.colorMap,g,f),i=[],this._updateLinePoints(a[d].points,i,this._outOfRange,b.extend({majorAxis:c.majorAxis,minorAxis:f,measureIdx:e.measureIdx,axisSettings:g,isLineSelected:c.selections.lines.indexOf(d)>=0},c)),j=b.extend({info:a.info,colors:h,clippings:this._getClippings(f,c.rect),idx:a.idx,points:i},c),this._lineObjectSettings.push(j)},_updateLinePoints:function(a,b,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u=g.style.line.width%2==0?0:.5,v=a?a.length:0,w=1===v,x=g.yMirrorMode,y=g.rect.width,z=g.rect.height;for(n=0,i=0;i<v;i++)if(a[i]&&(h=a[i],j=h.idx,k={x:g.isNumeric?g.numericAxis.getPositionOfValue(h.dimValue):g.majorAxis.getPositionOfValue(j,0),y:g.minorAxis.zeroPos},l=h.cacheCircle,l&&(l.cx=k.x,l.cy=k.y),!w||!(k.x<0||k.x>y))){if(h.isNaN&&!h.hasRightNeighbour&&"number"!=typeof h.nearestRightNeighbour)break;if(h.isNaN&&g.lineType===d.STACKED&&g.nullMode===e.CONNECT&&h.isInterpolationOffset!==!0);else if(h.isNaN&&h.isInterpolationOffset!==!0){b.push(!1);continue}if(o=h.hasRightNeighbour?a[i+1].idx:h.nearestRightNeighbour,m=void 0!==o?g.isNumeric?a[o]?g.numericAxis.getPositionOfValue(a[o].dimValue):NaN:g.majorAxis.getPositionOfValue(o,0):NaN,!x&&c(0,y,m,n)||x&&c(0,y,n,m))b.push(!1);else{p=h.cacheItem&&h.cacheItem.selected;var A=!p&&g.isLineSelected&&g.selections.synqronize&&this._isSelectedIndirectly(j,g.selections.lines,g.selections.points),B=g.minorAxis.getPositionOfValue(h.aggregated.end);k.y=Math.floor(B)-u,k.y<-1e5&&(k.y=-1e5),k.y>z+1e5&&(k.y=z+1e5),l&&(l.r=Math.max(g.style.dataPoints.size.normal/2,8),l.cy=Math.max(g.axisSettings.topCutoff,Math.min(g.axisSettings.bottomCutoff,k.y))),h.isNaN||(n=k.x),q=h.cacheItem&&(h.cacheItem.parent?[h.cacheItem.parent.id,h.cacheItem.id]:h.cacheItem.id),r=g.colorMap.getColor(q,h.aggregated.end,g.measureIdx,h.rowIndex).toRGBA(),w?t=!0:(t=!h.hasLeftNeighbour&&!h.hasRightNeighbour&&g.nullMode===e.GAP)&&g.isNumeric&&(t=(0==i||a[i-1])&&(i===v-1||a[i+1])),s={size:p?g.style.dataPoints.size.selected:g.style.dataPoints.size.normal,selected:p||A,selectedIndirectly:A,text:h.cacheItem?h.cacheItem.getDimensions()[0]:"",measureIdx:h.measureIdx,label:h.label,value:h.aggregated.end,isNaN:h.isNaN,isInterpolationOffset:h.isInterpolationOffset,color:r,outOfRangeUp:B<g.axisSettings.topCutoff,outOfRangeDown:B>g.axisSettings.bottomCutoff,outOfDimensionBounds:k.x<0||k.x>y,outOfBounds:k.x<0||k.x>y||h.aggregated.end>g.axisSettings.plotMax||h.aggregated.end<g.axisSettings.plotMin,dataIndex:j,isSingle:t,hidden:h.hidePoint,x:k.x,y:k.y,y1:0===h.aggregated.start?g.axisSettings.areaStartBase:g.minorAxis.getPositionOfValue(h.aggregated.start),cacheItem:h.cacheItem,isNull:h.cacheItem&&h.cacheItem.id===-2},(s.outOfRangeUp||s.outOfRangeDown)&&(s.outOfRangeUp&&!f.up[s.x]?(f.points.push(s),f.up[s.x]=!0):s.outOfRangeDown&&!f.down[s.x]&&(f.points.push(s),f.down[s.x]=!0)),b[j]=s}}},_getSelected:function(a,b){var c,d,e,f=[],g=[],h=a.length;if(b)for(c=0;c<h;c++)for(e=a[c].points,d=0;d<e.length;d++)e[d]&&e[d].cacheItem&&e[d].cacheItem.selected&&(f.indexOf(c)===-1?(f.push(c),g[c]=[e[d].idx]):g[c].push(e[d].idx));return{lines:f,points:g,synqronize:f.length>1}},_isSelectedIndirectly:function(a,b,c){var d,e,f,g=b?b.length:0,h=!1;for(d=0;d<g;d++)for(f=c[b[d]],e=0;e<f.length;e++)if(a===f[e]){h=!0;break}return h},_getClippings:function(a,b){var c=a.getPadding(),d=c.top-1,e=a.rect.height-c.bottom;return{areaClip:{x:0,y:d,width:b.width,height:e-d},lineClip:{x:0,y:d,width:b.width,height:e-d-.5}}},_getColorSettings:function(a,b){var c=.3,d=!1;return a.mode&&(a.mode===a.EXPRESSION||a.mode===a.MEASURE&&!isNaN(b.posMin))&&(d=!0,c=.6),{isExpression:d,areaAlpha:c,varyingPointColors:d,gradient:!1}}})}),define("extensions.qliktech/linechart/layers/shapes/points",["objects.views/charts/shapes/container","objects.views/charts/shapes/circle","objects.views/charts/shapes/polygon","objects.views/charts/shapes/rect"],function(a,b,c,d){function e(a){switch(a){case"diamond":case"triangle":return new c;case"circle":return new b;case"line":default:return new d}}function f(a,b,c,d,e){var f=d;switch(e){case"circle":a.set(b,c,.5*f);break;case"diamond":a.set([{x:b,y:c-f/2},{x:b-f/2,y:c},{x:b,y:c+f/2},{x:b+f/2,y:c}]);break;case"triangle":a.set([{x:b,y:c-f/2},{x:b-f/2,y:c+f/2},{x:b+f/2,y:c+f/2}]);break;default:f=d,a.set(b-f/2,c-f/2,f,f)}}return a.extend("Points",{init:function(a){this._super(),this._symbol=a||"circle"},update:function(a){var b,c,d,g=a.points?a.points:[],h=0,i=!1,j=g?g.length:0;for(c=0;c<j;c++)!(d=g[c])||d.outOfDimensionBounds||d.isNaN||(b=this._children[h++],b||(b=e(this._symbol),this.addChild(b)),f(b,d.x,d.y,d.size,this._symbol),b.fill=d.selectedIndirectly?"white":d.color,b.stroke=d.selectedIndirectly?d.color:!!d.selected&&"white",b.opacity=d.selected||d.selectedIndirectly?1:a.globalAlpha,b.strokeWidth=1.5,b.visible=!d.outOfBounds&&!d.isNaN&&!d.hidden&&(a.showDataPoints||d.isSingle||d.keep||d.selected),b.visible&&!i&&(i=b.true),b.data.outOfBounds=d.outOfBounds,b.data.value=d.value,b.data.label=d.label,b.data.dataIndex=d.dataIndex,b.data.text=d.text);return h<this._children.length&&this.removeChildren(this._children.slice(h-this._children.length)),this.visible=i,this._selectedSize=a.style.dataPoints.size.selected,this},getFromRange:function(a,c,d){return this.children.filter(function(b){return d?b.cx>=a&&b.cx<=c&&b.visible:b.cx>=a&&b.cx<c&&b.visible}).map(function(a){var c=new b(a.cx,a.cy,.5*this._selectedSize);return c.fill=a.fill,c.stroke="white",c.opacity=1,c.strokeWidth=1.5,c},this)}})}),define("extensions.qliktech/linechart/layers/shapes/poly-line",["objects.views/charts/shapes/container","objects.views/charts/shapes/polygon","objects.views/charts/shapes/line"],function(a,b,c){"use strict";function d(a){var b,c=[];for(b=0;b<a.length;b++)c=c.concat(e(a[b]));return c}function e(a){var b,c,d,g,h,i,j,k=[],l=a._polygons[0].points;if(!l||l.length<2)return k;for(a.data.selected=l[0].selected&&l[1].selected,i=null,j=l.length-1,h=1;h<l.length;h++)if(l[h-1].selected&&l[h].selected){i=h-1;break}if(null!==i){for(h=i;h<l.length;h++)if(!l[h].selected){j=h-1;break}c=l.slice(0,i+1),d=l.slice(i,j+1),g=l.slice(j),c&&c.length>1&&(b=f(c,a),k.push(b)),d&&d.length>1&&(b=f(d,a),b.data.selected=!0,k.push(b)),g&&g.length>1&&(b=f(g,a),k=k.concat(e(b)))}else k.push(a);return k}function f(a,c){var d=new b(a);return d.opacity=c.opacity,d.close=!1,d.stroke=c.stroke,d.strokeWidth=c.strokeWidth,d.lineJoin=c.lineJoin,d.lineCap=c.lineCap,d}function g(a,c,e,f){var g,h,i,k,l,m,n=[];for(k=c?c.length:0,l=[],g=0;g<k;g++)if(!(m=c[g])||m.isNaN&&m.isInterpolationOffset!==!0)void 0===m&&a.isNumeric||e!==j.GAP||!i||!n.length||(i.set(n),l.push(i),i=null,n=[]);else{if(!i&&(i=new b,i.close=!1,i.stroke=f||m.color||"#333333",i.lineJoin="round",i.lineCap="round",i.opacity=1,n=[],m.isNull&&!f&&c[g+1]&&(i.stroke=c[g+1].color||"#333333"),m.hidden&&!f))for(h=1;h<k-g;++h)if(c[g+h]&&!c[g+h].hidden){i.stroke=c[g+h].color||"#333333";break}n.push({x:m.x,y:m.y,selected:m.selected,dataIndex:m.dataIndex,y_:m.y1})}for(i&&n.length>1&&(i.set(n),l.push(i)),l=d(l),k=l.length,g=0;g<k;g++)l[g].strokeWidth=a.style.line.width*(l[g].data.selected?2:1),l[g].opacity=l[g].data.selected?1:a.globalAlpha;return l}function h(a,b,c,d){var e,f,g,h=b?b.length:0,i=a.interpolateVaryingColors,k=[],l=null;for(e=0;e<h;e++)f=b[e],!f||f.isNaN&&f.isInterpolationOffset!==!0?void 0===f&&a.isNumeric||c!==j.GAP||(g=null):g?(l=new d(g.x,g.y,f.x,f.y),l.data.selected=g.selected&&f.selected,l.data.y1_=g.y1,l.data.y2_=f.y1,g.color!==f.color?l.stroke={gradient:{x0:g.x,y0:0,x1:f.x,y1:0,limits:i?[0,1]:[0,.5,.5,1],colors:i?[g.color||"#333333",f.color||"#333333"]:[g.color||"#333333",g.color||"#333333",f.color||"#333333",f.color||"#333333"]}}:l.stroke=f.color,l.opacity=l.data.selected?1:a.globalAlpha,l.strokeWidth=a.style.line.width*(l.data.selected?2:1),k.push(l),g=f):g=f;return k}var i,j={GAP:"gap",CONNECT:"connect",ZERO:"zero"};return i=a.extend("PolyLine",{init:function(){this._super(),this.lineJoin="round",this.lineCap="round"},update:function(a){this.clip=a.clippings.lineClip,this.removeChildren(),a.colors.varyingPointColors?this.addChildren(i.getLines(a,a.points,a.nullMode,c)):this.addChildren(g.call(this,a,a.points,a.nullMode,a.colors.gradient))},getLineInRange:function(a,b){var c=new i;return this.children.forEach(function(d){var e=d.getPartialFromRange(a,b);e&&(e.stroke=d.stroke,e.strokeWidth=3,e.close=d.close,c.addChildren([e]))}),c}}),i.getLines=h,i}),define("extensions.qliktech/linechart/layers/shapes/poly-area",["objects.views/charts/shapes/container","objects.views/charts/shapes/polygon","objects.views/charts/shapes/line"],function(a,b,c){function d(a){return{x:a.x,y:a.y_}}function e(a,e){var f,g,h,i,j,k=[],l=e?e.length:0;for(f=0;f<l;f++)e[f]instanceof b?(h=e[f]._polygons[0].points,g=new b(h.concat(h.map(d).reverse())),g.fill=a.colors.gradient||e[f].stroke,g.opacity=a.colors.areaAlpha*(e[f].data.selected?1:a.globalAlpha)):e[f]instanceof c&&(i=Math.floor(e[f].x1),j=Math.floor(e[f].x2),h=[{x:i,y:e[f].y1},{x:i,y:e[f].data.y1_},{x:j,y:e[f].data.y2_},{x:j,y:e[f].y2}],g=new b(h),e[f].stroke.gradient?g.fill={gradient:{colors:e[f].stroke.gradient.colors,limits:e[f].stroke.gradient.limits,x0:e[f].stroke.gradient.x0,x1:e[f].stroke.gradient.x1,y0:0,y1:0}}:e[f].stroke?g.fill=e[f].stroke||"#eeeeee":g.fill=a.colors.gradient||"#eeeeee",g.opacity=a.colors.areaAlpha*(e[f].data.selected?1:a.globalAlpha)),g&&k.push(g);return k}return a.extend("PolyArea",{getAreaFromSegments:function(b){var c=new a;return c.addChildren(e(this.__data,b)),c},update:function(a,b){this.__data=a,this.clip=a.clippings.areaClip,this.removeChildren(),this.addChildren(e(a,b))}})}),define("extensions.qliktech/linechart/layers/shapes/line-object",["objects.views/charts/shapes/container","./points","./poly-line","./poly-area"],function(a,b,c,d){return a.extend("LineObject",{init:function(a,e){this._super(),this.data.label=a.info.label,e.showArea&&(this._areaLayer=new d,this.addChild(this._areaLayer)),this._lineLayer=new c,this.addChild(this._lineLayer),this._pointLayer=new b("circle"),this.addChild(this._pointLayer)},update:function(a){this._pointLayer.update(a),this._lineLayer.update(a),this.visible=this._pointLayer.visible||this._lineLayer.visible,this._areaLayer&&(this._areaLayer.update(a,this._lineLayer.children),this._areaLayer.visible&&(this.visible=!0))},getLinesInRange:function(b,c,d){var e=new a,f=this._lineLayer.getLineInRange(b,c);if(this._areaLayer){var g=this._areaLayer.getAreaFromSegments(f.children);e.addChildren([g])}return e.addChildren([f]),e.addChildren(this._pointLayer.getFromRange(b,c,d)),e}})}),define("extensions.qliktech/linechart/layers/line-objects-layer",["./layer","./shapes/line-object"],function(a,b){return a.extend("LineObjectLayer",{init:function(a){this._super(a,{name:"line-objects-layer"})},updateInstances:function(a,c){var d,e=a?a.length:0,f=[];for(this.renderer.stage.removeChildren(),d=0;d<e;d++)f.push(new b(a[d],{showArea:c.showArea}));this.renderer.stage.addChildren(f),this._lineObjects=f},getLineObjects:function(){return this._lineObjects},getPolyLinesInRange:function(a,b,c){return this._lineObjects.map(function(d){return d.getLinesInRange(a,b,c)})},update:function(a){var b,c=this._lineObjects?this._lineObjects.length:0;for(b=0;b<c;b++)this._lineObjects[b].update(a[b])}})}),define("extensions.qliktech/linechart/layers/oob-layer",["./layer","objects.views/charts/shapes/polygon"],function(a,b){function c(a,b,c,d,e){var f=[];return"left"===e?(f.push({x:a,y:b+c/2}),f.push({x:a,y:b-c/2}),f.push({x:a-d,y:b})):"right"===e?(f.push({x:a,y:b+c/2}),f.push({x:a,y:b-c/2}),f.push({x:a+d,y:b})):"up"===e?(f.push({x:a-c/2,y:b}),f.push({x:a+c/2,y:b}),f.push({x:a,y:b-d})):"down"===e&&(f.push({x:a-c/2,y:b}),f.push({x:a+c/2,y:b}),f.push({x:a,y:b+d})),f}return a.extend("OutOfBoundsLayer",{init:function(a){this._super(a,{name:"out-of-bounds-layer"}),this._markerSize=8},update:function(a,d){var e,f,g,h,i,j,k=this.renderer.stage,l=k.children,m=d.markerSize||this._markerSize,n=a?a.length:0;for(j=0;j<n;j++)e=l[j],f=a[j],h=f,f.data&&(h=f.data),i=d.axesSettings[d.measureToAxisIndex[h.measureIdx]],g=c(h.x,h.outOfRangeUp?i.topCutoff+m:i.bottomCutoff-m,m,m,h.outOfRangeUp?"up":"down"),e?e.set(g):(e=new b(g),k.addChild(e)),e.fill=d.style.outOfRange.color,e.opacity=h.selected?1:d.globalAlpha;n<l.length&&k.removeChildren(l.slice(n-l.length))}})}),define("extensions.qliktech/linechart/layers/label-layer",["./layer","objects.views/charts/utils/canvas-renderer","general.utils/shapes/geometry-math"],function(a,b,c){function d(){var a,b,c,d,e,f,g,h,i,j,k={},l=this.combinedMeasuresFormatter;for(this._allDataLineObjectsLength=this._allDataLineObjects?this._allDataLineObjects.length:0,this._dataLabelsOfLines=new Array(this._allDataLineObjectsLength),this._allDataPointLabels=[],a=0;a<this._allDataLineObjectsLength;a++)for(this._dataLabelsOfLines[a]=[],c=this._allDataLineObjects[a],f=c.find("Points [visible='true']"),e=f?f.length:0,b=0;b<e;b++)g=f[b].getLocalBoundingRect(),h=g.x+g.width/2,i=g.y+g.height/2,(j=h+";"+i)in k||(k[j]=!0,d={text:this._lineType===F.STACKED&&this._allDataLineObjectsLength>1?l.formatValue(f[b].value):f[b].data.label,x0:h,y0:i,align:"center",font:this._style.dataPoints.font,maxWidth:512,maxNumLines:1,line:a},this._dataLabelsOfLines[a].push(d),this._allDataPointLabels.push(d));this._numAllDataPointLabels=this._allDataPointLabels.length}function e(){var a;for(a=0;a<this._numAllDataPointLabels;a++)this._allDataPointLabels[a].size=b.measureTextObject({type:"text",shape:this._allDataPointLabels[a]})}function f(){e.call(this);var a,b,c,d,f,g,h,i=this._discreteSpacing/2,j="leftDx",k="leftDy",l="rightDx",m="rightDy",n=1;for(this.yMirrorMode&&(j="rightDx",k="rightDy",l="leftDx",m="leftDy",n=-1),a=0;a<this._allDataLineObjectsLength;a++)if(d=this._dataLabelsOfLines[a],0!==(c=d.length))if(1!==c){for(f=d[0],f.priority=6,h=d[1],f[j]=i,f[k]=0,f[l]=(h.x0-f.x0)*n,f[m]=f.y0-h.y0,b=1;b<c-1;b++)f=d[b],g=d[b-1],h=d[b+1],f[j]=g[l],f[k]=-g[m],f[l]=(h.x0-f.x0)*n,f[m]=f.y0-h.y0,g.y0<f.y0?f.y0<h.y0?f.priority=1:f.y0===h.y0?f.priority=2:f.priority=3:g.y0===f.y0?f.y0<h.y0?f.priority=2:f.y0===h.y0?f.priority=0:f.priority=2:f.y0<h.y0?f.priority=4:f.y0===h.y0?f.priority=2:f.priority=1;f=d[c-1],g=d[c-2],f[j]=g[l],f[k]=-g[m],f[l]=i,f[m]=0,f.priority=5}else f=d[0],f[j]=i,f[k]=0,f[l]=i,f[m]=0}function g(){void 0!==this._usedDataMax&&this._usedDataMax===this._usedDataMin?this._allDataPointLabels.sort(function(a,b){return a.x0<b.x0?-1:1}):this._allDataPointLabels.sort(function(a,b){return a.priority>b.priority?-1:a.priority===b.priority?6===a.priority?a.x0===b.x0?a.y0>b.y0?1:-1:a.x0>b.x0?1:-1:5===a.priority?a.x0===b.x0?a.y0>b.y0?1:-1:a.x0>b.x0?-1:1:4===a.priority?a.y0>b.y0?1:-1:3===a.priority?a.y0>b.y0?-1:1:a.y0===b.y0?a.x0>b.x0?-1:1:a.y0<b.y0?-1:1:1})}function h(){var a,b,c,d,e,f,g,h=[];for(a=0;a<this._allDataLineObjectsLength;a++)for(c=this._allDataLineObjects[a],d=c.find("PolyLine [stroke]"),e=d?d.length:0,b=0;b<e;b++)f=d[b],g=f.getLocalPoints(),h.push(g);return h}function i(a,b){return!(a.minX2>b.maxX2||a.maxX2<b.minX2||a.minY2>b.maxY2||a.maxY2<b.minY2)}function j(a){var b=this._allDataPointLabels[a],c=this.rect.width,d=this.rect.height;return b.x0>=0&&b.x0<=c&&b.minX>=0&&b.maxX<=c&&b.minY>=0&&b.maxY<=d}function k(a){return!c.checkPolylinesIntersectingRectDefinedByMaxMin(this._polylines,this._allDataPointLabels[a])}function l(a){var b,c,d=this._allDataPointLabels[a],e=(d.minX+d.maxX)/2,f=(d.minY+d.maxY)/2,g=Math.pow(e-d.x0,2)+Math.pow(f-d.y0,2);for(c=0;c<this._numAllDataPointLabels;c++)if(b=this._allDataPointLabels[c],c!==a&&g>=Math.pow(e-b.x0,2)+Math.pow(f-b.y0,2))return!1;return!0}function m(a){var b,c=this._allDataPointLabels[a];for(b=0;b<a;b++)if(this._allDataPointLabels[b].status&&i(c,this._allDataPointLabels[b]))return!1;return!0}function n(a){return!!j.call(this,a)&&(!!l.call(this,a)&&(!!k.call(this,a)&&m.call(this,a)))}function o(a){var b,c,d,e=this._dataLabelHorizontalGap/2,f=this._dataLabelVerticalGap/2;b=a.size.width/2,c=b+e,a.minX=a.x-b,a.maxX=a.x+b,a.minX2=a.x-c,a.maxX2=a.x+c,d=a.size.height,"top"===a.baseline&&(a.minY=a.y,a.maxY=a.y+d,a.maxY2=a.maxY+f,a.minY2=a.minY-f),"bottom"===a.baseline&&(a.maxY=a.y,a.minY=a.y-d,a.maxY2=a.maxY+f,a.minY2=a.minY-f),"middle"===a.baseline&&(a.maxY=a.y+d/2,a.minY=a.y-d/2,a.maxY2=a.maxY+f,a.minY2=a.minY-f)}function p(a){6===a.priority&&a.x-a.size.width/2<0&&(a.x=a.size.width/2+1),5===a.priority&&a.x+a.size.width/2>this.rect.width&&(a.x=this.rect.width-a.size.width/2-1)}
function q(a){return a.baseline="middle",a.x=a.x0-a.size.width/2-this._dataLabelHorizontalGap,a.y=a.y0,!0}function r(a){return a.baseline="middle",a.x=a.x0+a.size.width/2+this._dataLabelHorizontalGap,a.y=a.y0,!0}function s(a){return a.baseline="bottom",a.x=a.x0,a.y=a.y0-this._dataLabelMargin,p.call(this,a),!0}function t(a){return a.baseline="top",a.x=a.x0,a.y=a.y0+this._dataLabelMargin,p.call(this,a),!0}function u(a){var b,c,d,e,f,g=a.leftDx,h=a.rightDx,i=a.leftDy,j=a.rightDy;return(i>0||j>0)&&(i=Math.max(i,1e-9),j=Math.max(j,1e-9),b=a.size.width+2*this._horizontalDistanceFromLine,(d=b/(g/i+h/j))<=this._maxDataLabelMargin)&&(a.baseline="bottom",d=Math.max(d,this._dataLabelMargin),a.y=a.y0-d,e=d*g/i,f=d*h/j,c=b/2,e<c?a.x=a.x0+(c-e):f<c&&(a.x=a.x0-(c-f)),!0)}function v(a){var b,c,d,e,f,g=a.leftDx,h=a.rightDx,i=-a.leftDy,j=-a.rightDy;return(i>0||j>0)&&(i=Math.max(i,1e-9),j=Math.max(j,1e-9),b=a.size.width+2*this._horizontalDistanceFromLine,(d=b/(g/i+h/j))<=this._maxDataLabelMargin)&&(a.baseline="top",d=Math.max(d,this._dataLabelMargin),a.y=a.y0+d,e=d*g/i,f=d*h/j,c=b/2,e<c?a.x=a.x0+(c-e):f<c&&(a.x=a.x0-(c-f)),!0)}function w(a){var b,c,d=a.leftDx,e=a.leftDy;return a.baseline="middle",b=a.size.height/2+this._horizontalDistanceFromLine,c=Math.abs(this._dataLabelHorizontalGap*e/d),a.x=a.x0-a.size.width/2-this._dataLabelHorizontalGap,a.y=a.y0+(c>=b?0:e>0?b-c:c-b),!0}function x(a){var b,c,d=a.rightDx,e=a.rightDy;return a.baseline="middle",b=a.size.height/2+this._horizontalDistanceFromLine,c=Math.abs(this._dataLabelHorizontalGap*e/d),a.x=a.x0+a.size.width/2+this._dataLabelHorizontalGap,a.y=a.y0+(c>=b?0:e>0?b-c:c-b),!0}function y(a){var b,c,d,e,f=this.rect.width;return a.priority>3?(a.baseline="middle",a.x0-0<=f-a.x0?(a.x=a.x0+9+a.size.width/2,a.y=a.y0):(a.x=a.x0-9-a.size.width/2,a.y=a.y0)):3===a.priority&&(b=a.leftDy/a.leftDx,c=a.rightDy/a.rightDx,c>=b?(d=(a.size.height/2+1)/c,d<=18?(a.baseline="middle",a.y=a.y0,a.x=a.x0+Math.max(d,9)+a.size.width/2):(e=18*c-1,a.baseline="top",a.y=a.y0-e,a.x=a.x0+18+a.size.width/2)):(d=(a.size.height/2+1)/b,d<=18?(a.baseline="middle",a.y=a.y0,a.x=a.x0-Math.max(d,9)-a.size.width/2):(e=18*b-1,a.baseline="top",a.y=a.y0-e,a.x=a.x0-18-a.size.width/2))),!0}function z(a){var b;return a.rightDy<=0?(a.baseline="bottom",a.x=a.x0+a.size.width/2,a.y=a.y0+1):a.rightDy<=a.rightDx?(a.baseline="bottom",a.x=a.x0+a.size.width/2,a.y=a.y0-a.size.width*Math.abs(a.rightDy/a.rightDx)-1):(a.baseline="top",b=Math.max(0,a.size.height+1-this.rect.height+a.y0),a.x=a.x0+a.size.width/2+b*Math.abs(a.rightDx/a.rightDy),a.y=a.y0-b+1),!0}function A(a){var b;return a.leftDy<=0?(a.baseline="bottom",a.x=a.x0-a.size.width/2,a.y=a.y0+1):a.leftDy<=a.leftDx?(a.baseline="bottom",a.x=a.x0-a.size.width/2,a.y=a.y0-a.size.width*Math.abs(a.leftDy/a.leftDx)-1):(a.baseline="top",b=Math.max(0,a.size.height+1-this.rect.height+a.y0),a.x=a.x0-a.size.width/2-b*Math.abs(a.leftDx/a.leftDy),a.y=a.y0-b+1),!0}function B(a,b){var c=this._allDataPointLabels[b];!c.status&&a.call(this,c)&&(o.call(this,c),c.status=n.call(this,b))}function C(a){var b=this._allDataPointLabels[a];this._allDataLineObjectsLength>1?(6===b.priority&&B.apply(this,[q,a]),5===b.priority&&B.apply(this,[r,a]),B.apply(this,[s,a]),B.apply(this,[t,a])):(B.apply(this,[s,a]),B.apply(this,[t,a]),6===b.priority&&B.apply(this,[q,a]),5===b.priority&&B.apply(this,[r,a])),b.status||(b.rightDy+Math.abs(b.rightDx)*b.leftDy/Math.abs(b.leftDx)>=0?(B.apply(this,[v,a]),B.apply(this,[u,a])):(B.apply(this,[u,a]),B.apply(this,[v,a]))),b.status||(b.rightDy+Math.abs(b.rightDx)*b.leftDy/Math.abs(b.leftDx)>=0?(B.apply(this,[w,a]),B.apply(this,[x,a])):(B.apply(this,[x,a]),B.apply(this,[w,a]))),B.apply(this,[y,a]),b.status||6!==b.priority||B.apply(this,[z,a]),b.status||5!==b.priority||B.apply(this,[A,a])}function D(){var a;for(a=0;a<this._numAllDataPointLabels;a++)C.call(this,a)}function E(){var a,b,c,d=[];for(a=0;a<this._numAllDataPointLabels;a++)b=this._allDataPointLabels[a],b.status&&(c={type:"text",fill:this._style.dataPoints.color,shape:b},d.push(c));this.renderer.shapes=d}var F={LINE:"line",AREA:"area",STACKED:"stackedArea"};return a.extend("LabelLayer",{init:function(a){this.wrapper=document.createElement("div"),this.wrapper.style.position="absolute",this.renderer=new b(this.wrapper),this.minorAxis=null,this.majorAxis=null,a.appendChild(this.wrapper),this._dataLabelMargin=6,this._maxDataLabelMargin=12,this._dataLabelHorizontalGap=6,this._dataLabelVerticalGap=3,this._horizontalDistanceFromLine=2},setYMirrorMode:function(a){this.yMirrorMode=a},update:function(a,b){this.combinedMeasuresFormatter=b.combinedMeasuresFormatter,this._allDataLineObjects=a,this._lineType=b.lineType,this._discreteSpacing=b.majorAxis.getDiscreteSpacing(),this._style=b.style,this.rect=b.rect,this.renderer.shapes=[],d.call(this),f.call(this),g.call(this),this._polylines=h.call(this),D.call(this),E.call(this)}})}),define("extensions.qliktech/linechart/layers/line-highlight-layer",["./layer","./shapes/line-object"],function(a){return a.extend("LineHighlightLayer",{init:function(){this._super.apply(this,arguments),this.ranges=[]},getLineObjects:function(){return this._lineObjects},setRanges:function(a){this.ranges=a},update:function(a,b){var c=[];this.ranges.forEach(function(d){var e=a.getPositionOfValue(d.min),f=a.getPositionOfValue(d.max);c=c.concat(b.getPolyLinesInRange(e,f,d.maxIncluded))},this),this.renderer.stage.removeChildren(),c.length?(this.renderer.stage.addChildren(c),this.show()):this.hide()}})}),define("extensions.qliktech/linechart/linearea",["objects.views/charts/components/chart-component","general.utils/shapes/circle","./line-objects-model","./layers/line-objects-layer","./layers/oob-layer","./layers/label-layer","./layers/line-highlight-layer","./layers/selection-highlight-layer","objects.views/charts/chart-style-service","client.utils/theme/modern/theme","core.utils/deferred","core.utils/feature-flags"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";function m(a){return!!a}function n(a,b){for(var c,d=Object.keys(a),e=d.length,f=d.map(function(b){return a[b].points}),g=Math.max.apply(null,f.map(function(a){return a.length})),h=0;h<g;++h){var i=!1,j=!1;for(c=0;c<e;++c)i=i||f[c][h],j=j||!f[c][h];if(i&&j)for(c=0;c<e;++c)f[c][h]||(f[c][h]={idx:i.idx,dimValue:i.dimValue,measureIdx:i.measureIdx,aggregated:{start:0,end:0},hasLeftNeighbour:!!f[c][h-1]&&!f[c][h-1].isNaN,hasRightNeighbour:!!f[c][h+1]&&!f[c][h+1].isNaN,isNaN:!b,value:b?0:NaN,text:b?"0":"",hidePoint:!0,color:null,label:""})}}function o(a){var b,c,d,e,f,g=a?a.length:0;for(b=0;b<g;b++)if((f=a[b])&&!f.hasRightNeighbour){for(c=b+1;c<g;c++)if(a[c]&&!a[c].isNaN){f.nearestRightNeighbour=c;break}if(!f.isNaN){if(!isNaN(f.nearestRightNeighbour))for(e=c-b,d=1;d<e;d++)a[b+d]&&(a[b+d].nearestRightNeighbour=f.nearestRightNeighbour,a[b+d].nearestLeftNeighbour=b);b=c-1}}}function p(a){var b,c,d,e,f,g,h,i,j,k=a?a.length:0,l=this.isDimensionContinuous;for(b=0;b<k;b++)if((j=a[b])&&!j.hasRightNeighbour&&!j.isNaN&&!isNaN(j.nearestRightNeighbour))for(c=j.nearestRightNeighbour,f=j.value,g=a[c].value,i=c-b,h=l?a[c].dimValue-j.dimValue:c-b,d=1;d<i;d++)e=(l?a[b+d].dimValue-j.dimValue:d)/h,a[b+d]&&(a[b+d].interpolatedValue=f*(1-e)+g*e)}function q(a,b){var c,d,e,f,g,h=[],i=a?a.length:0;for(c=0;c<i;c++)d=a[c].points,Object.keys(d).forEach(function(a){var c=!1;g=d[a].idx,h[g]||(h[g]={pos:0,neg:0,total:0}),(f=d[a])&&(e=f.isNaN?isNaN(f.interpolatedValue)?0:f.interpolatedValue:f.value,isNaN(e)||(b?(0===e?f.hasLeftNeighbour&&d[a-1]?c=d[a-1].aggregated.end<0:f.hasRightNeighbour&&d[a+1]&&(c=d[a+1].aggregated.end<0):c=e<0,c?(f.aggregated.start=h[g].neg,h[g].neg+=e,f.aggregated.end=h[g].neg):(f.aggregated.start=h[g].pos,h[g].pos+=e,f.aggregated.end=h[g].pos)):(f.aggregated.start=h[g].total,h[g].total+=e,h[g].pos=Math.max(h[g].pos,h[g].total),h[g].neg=Math.min(h[g].neg,h[g].total),f.aggregated.end=h[g].total),"number"==typeof f.interpolatedValue&&(f.interpolatedValue=f.aggregated.end,f.isInterpolationOffset=!0)))});return{pos:Math.max.apply(null,h.filter(function(a){return!!a}).map(function(a){return a.pos})),neg:Math.min.apply(null,h.filter(function(a){return!!a}).map(function(a){return a.neg}))}}function r(a,b){var c=a.layoutMap[b]||"medium";return l.THEMING?{dataPoints:{color:a.getStyle("label.value","color"),font:"normal "+a.getStyle("label.value","fontSize")+" 'QlikView Sans'",size:{normal:6,selected:10}},outOfRange:{color:a.getStyle("outOfRange","color")},line:{width:"full"===c?2:1}}:{dataPoints:{color:a.getValue(t,"item.value","color"),font:a.getFont(t,"item.value",c),size:{normal:a.getValue(t,"item.shape","size"),selected:a.getValue(t,"item.shape","size","selected")}},outOfRange:{color:a.getValue(t,"item.outOfRange","color")},line:{width:a.getValue(t,"item.line","width",c)}}}function s(){if(!this._data||!this._tree)return[];var a,b=this._data.qHyperCube.qDimensionInfo,c=b.length,d=[],e=0;return this._tree.children.forEach(function(f){f.id=b[0].cId+"_"+f.data.qElemNo,a={label:f.data.qText||"",cacheIndex:[],id:f.id},d.push(a),1===c&&(a.cacheIndex[0]=e++),c>1&&f.children.forEach(function(b){b.children[0]&&b.children[0].isBranch&&(b.data.qElemNo!==-2&&a.cacheIndex.push(e),e++)},this)},this),{data:d,info:[{qApprMaxGlyphCount:this._tree.data.qApprMaxGlyphCount}],groupSize:null}}var t="lineChart",u={LINE:"line",AREA:"area",STACKED:"stackedArea"},v={GAP:"gap",CONNECT:"connect",ZERO:"zero"};return a.extend("LineArea",{init:function(){this._super.apply(this,arguments),this._data=null,this._layoutMode=null,this._selectableShapes=[],this._shapes=[],this._generatedCacheItems=[],this._showDataPoints=!0,this._colorMap=null,this._showDataPoints=!1,this._lineType=u.LINE,this._nullMode=v.GAP,this._separateStacking=!0,this._globalAlpha=1,this._dataLabelMargin=6,this._maxDataLabelMargin=12,this._dataLabelHorizontalGap=6,this._dataLabelVerticalGap=3,this._horizontalDistanceFromLine=2,this.interpolateVaryingColors=!0,l.THEMING?this._styleService=j.initializeService("object.lineChart"):this._styleService=i.getInstance(),this._lineObjectsModel=new c,this._edgeBleed=0,this._lineLayer=new d(this.container),this.layers=[this._lineLayer],this.isMini?(this._rangeSelectionLayer=new h(this.container),this.layers.push(this._rangeSelectionLayer)):(this._oobLayer=new e(this.container),this.layers.push(this._oobLayer),this._labelLayer=new f(this.container),this.layers.push(this._labelLayer),this._rangeSelectionLayer=new g(this.container),this.layers.push(this._rangeSelectionLayer))},setYMirrorMode:function(a){this.yMirrorMode=a,this._labelLayer&&this._labelLayer.setYMirrorMode(a)},preRender:function(){},afterPaint:function(){return k.resolve()},setColorMap:function(a){this._colorMap=a},getColorMap:function(){return this._colorMap},setShowDataPoints:function(a){this._showDataPoints=a},getShowDataPoints:function(){return this._showDataPoints},setMajorAxis:function(a){this._majorAxis=a,this._majorAxis.listen("changed",function(){this.invalidateDisplay()},this)},setMinorAxis:function(a){this._minorAxis=a,this._minorAxis.listen("changed",function(){this.invalidateDisplay()},this)},setTimeAxis:function(a){this.timeAxis=a,this.timeAxis.listen("changed",function(){this.invalidateDisplay()},this)},setContinuousAxis:function(a){this.continuousAxis=a,this.continuousAxis.listen("changed",function(){this.invalidateDisplay()},this)},setActiveDimensionAxis:function(a){this._activeDimAxis=a},setSecondaryMinorAxis:function(a){this._secondaryMinorAxis=a,this._secondaryMinorAxis.listen("changed",function(){this.invalidateDisplay()},this)},setIsDimensionContinuous:function(a){this.isDimensionContinuous=a,this._edgeBleed=this.isDimensionContinuous?5:0},setDimensionTree:function(a){this._tree=a,this.invalidateProperties()},setLineType:function(a){this._lineType=a},setNullMode:function(a){this._nullMode=a},setSeparateStacking:function(a){this._separateStacking=a},setShowDataPointLabels:function(a){this._showDataPointLabels=a},getShowDataPointLabels:function(){return this._showDataPointLabels},freezeZOrdering:function(){this._zOrderFreezed=!0},unFreezeZOrdering:function(){this._zOrderFreezed=!1},setColorMappings:function(a){this._colorMappings=a},_updateSize:function(){this.invalidateDisplay()},getCacheItems:function(){return this._cacheItems},setCacheItems:function(a){this._cacheItems=a},getGeneratedCacheItems:function(){return this._generatedCacheItems||[]},setMeasureIndices:function(a){this._measureIndices=a},getMajorAxisData:function(){return this._majorAxisData},getMinorAxisData:function(){return this._minorAxisData},renderRangeSelections:function(){return this._rangeSelectionLayer.update(this._activeDimAxis,this._lineLayer),this._rangeSelectionLayer.render()},updateRangeSelection:function(a){this._rangeSelectionLayer.setRanges(a),this.renderRangeSelections()},_updateProperties:function(){if(this._data&&this._tree){this._minorAxes=[this._minorAxis],this._secondaryMinorAxis&&this._minorAxes.push(this._secondaryMinorAxis),this._majorAxisData=s.call(this),this._minorAxisData=null;var a,c,d,e,f,g,h,i=[],j=this._data.qHyperCube.qDimensionInfo,k=j.length,l=this._measureIndices?this._measureIndices.length:this._data.qHyperCube.qMeasureInfo.length,r=this._data.qHyperCube.qMeasureInfo,t=this._tree,w=this._shapes,x=t.children.length,y=0,z=this._shapes.length,A={},B=this.measureFormatters,C=this.selectionIdentifier?this.selectionIdentifier:"dataArea",D=this._minorAxes,E=[],F=[];if(this._measureIndices)F=this._measureIndices;else if(l>0&&l<20)for(;F.length<l;)F.push(F.slice(-1)[0]+1||0);if(F.forEach(function(a){E[a]=D.filter(function(b){return!b._dataIndices||b._dataIndices.indexOf(a)>=0})[0]}),this._measureToAxis=E,this._measureToAxisIndex=E.map(function(a){return D.indexOf(a)}),this._polysData=[],x&&F||F.length){t.children.forEach(function(l,m){l.id=j[0].cId+"_"+l.data.qElemNo,l.children.forEach(function(n,o){if(k>1)a=l.id+";"+j[1].cId+"_"+n.data.qElemNo,h=A[n.data.qText],h||(A[n.data.qText]={info:{label:n.data.qText},points:[],values:[],measureIdx:k>1?0:o},h=A[n.data.qText]),n=n.children[0],g=B[0];else{if(this._measureIndices&&this._measureIndices.indexOf(o)<0)return;a=l.id,h=A[o],h||(A[o]={info:{label:r[o].qFallbackTitle},measureIdx:o,points:[],values:[]},h=A[o]),g=B[o]}(d=n?n.children[0]:void 0)&&(c=void 0!==d.data.qValue?d.data.qValue:d.data.qNum,f=isNaN(c),this._nullMode===v.ZERO&&f&&(c=0,f=!1),n.chartData={value:c,isNaN:f,idx:m,measureIdx:k>1?0:o,hasLeftNeighbour:!!h.points[m-1]&&!h.points[m-1].isNaN,hasRightNeighbour:!1,color:null,text:d.data.qText,label:d.data.qText?g&&("U"===g.type||isNaN(d.data.qNum))?g.formatValue(c):d.data.qText:"",rowIndex:n.data.rowIndex,dimValue:l.data.qNum,id:a,aggregated:{}},n.chartData.isNaN||(n.chartData.aggregated.start=0,n.chartData.aggregated.end=c,h.values.push(c)),h.points[m]=n.chartData,h.points[m-1]&&(h.points[m-1].hasRightNeighbour=!n.chartData.isNaN),n.chartData.shapeIndex=y++,z<y&&w.push(new b(NaN,NaN,NaN)),n.chartData.cacheCircle=w[n.chartData.shapeIndex],e=n.parent,e.cacheItem&&(i.indexOf(e.cacheItem)<0&&i.push(e.cacheItem),n.chartData.cacheItem=e.cacheItem,e.cacheItem.addShape(C,n.chartData.cacheCircle,!0),e.cacheItem.calculateTooltipPosition=!0))},this)},this);var G=[],H=l>1||k>1,I=(this._nullMode===v.CONNECT||this.isDimensionContinuous)&&this._lineType===u.STACKED&&H,J=this._nullMode===v.ZERO&&H&&!this.isDimensionContinuous;if((I||J)&&n.call(this,A,J),Object.keys(A).forEach(function(a){(I||this._nullMode!==v.ZERO)&&o.call(this,A[a].points),I&&p.call(this,A[a].points),this.isDimensionContinuous||(A[a].points=A[a].points.filter(m)),G.push(A[a])},this),this._polysData=G,this._zOrderFreezed){var K=this._sortedOrder;this._polysData.forEach(function(a,b){a.idx=b}),this._polysData.sort(function(a,b){return K.indexOf(a.idx)-K.indexOf(b.idx)})}else this._lineType===u.AREA?(this._polysData.forEach(function(a,b){a.idx=b,a.values.sort(function(a,b){return b-a}),a.absMedian=Math.abs(a.values[Math.floor(a.values.length/2)])}),this._polysData.sort(function(a,b){return b.absMedian-a.absMedian})):this._polysData.forEach(function(a,b){a.idx=b}),this._sortedOrder=this._polysData.map(function(a){return a.idx});if(this._lineType===u.STACKED&&(l>1||k>1)){var L=q.apply(this,[G,this._separateStacking]);this._minorAxisData={min:L.neg>=0?0:L.neg,max:L.pos<0?0:L.pos}}}this._shapes.length>y&&(this._shapes=this._shapes.slice(0,y)),this.setSelectableShapes(i),this._lineLayer.updateInstances(this._polysData,{showArea:[u.AREA,u.STACKED].contains(this._lineType)})}},hasValidData:function(){return this._super()&&this._majorAxis&&this._minorAxis&&this._data&&this._tree},updateSize:function(){this._super(),this.layers.forEach(function(a){a.rect=this.rect,a.renderer.setDimensions(0,-1,this.rect.width,this.rect.height+1),a.renderer.setDimensionsToContainerRatio(this.layoutToContainerRatios.x,this.layoutToContainerRatios.y)},this),this._style=r(this._styleService,this._layoutMode)},preRelevantSizeCalculation:function(){this.perpendicularlyRelevantSpacing={left:this._edgeBleed,right:this._edgeBleed,top:1,bottom:this._edgeBleed}},release:function(){this.layers.forEach(function(a){a.release()}),this._super(),this._majorAxis&&this._majorAxis.stopListen("changed",null,this),this._minorAxis&&this._minorAxis.stopListen("changed",null,this),this._secondaryMinorAxis&&this._secondaryMinorAxis.stopListen("changed",null,this),this.timeAxis&&this.timeAxis.stopListen("changed",null,this),this.continuousAxis&&this.continuousAxis.stopListen("changed",null,this)},beforeLayerUpdates:function(){},paint:function(){this._majorAxis.updateNow(),this._minorAxis.updateNow(),this._activeDimAxis&&this._activeDimAxis.updateNow();var a={numDimensions:this._data.qHyperCube.qDimensionInfo.length,showDataPoints:this._showDataPoints&&this._layoutMode>this.ShowFlags.SPARK,nullMode:this._nullMode,globalAlpha:this._globalAlpha,majorAxis:this._majorAxis,minorAxes:this._minorAxes,numericAxis:this._activeDimAxis,isNumeric:this.isDimensionContinuous,measureToAxisIndex:this._measureToAxisIndex,axesSettings:this._minorAxes.map(this._getAxisDetails),combinedMeasuresFormatter:this.combinedMeasuresFormatter,interpolateVaryingColors:this.interpolateVaryingColors,colorMap:this._colorMap,rect:this.rect,style:this._style,markerSize:Math.min(8,this._majorAxis.getDiscreteSpacing()/2),yMirrorMode:this.yMirrorMode},b=this,c=[];return this._lineObjectsModel.update(this._polysData,a),this.beforeLayerUpdates(this._lineObjectsModel.getLineObjectsSettings()),this._lineLayer.renderer.edgeBleed={left:this._edgeBleed,right:this._edgeBleed,top:this._layoutMode===this.ShowFlags.SPARK?1:0,bottom:this._edgeBleed},this._lineLayer.update(this._lineObjectsModel.getLineObjectsSettings()),this.preRender(this._lineLayer._lineObjects),c.push(this._lineLayer.render()),this._oobLayer&&(this._oobLayer.renderer.edgeBleed={left:this._edgeBleed,right:this._edgeBleed,top:0,bottom:this._edgeBleed},this._oobLayer.update(this._lineObjectsModel.getPointsOutOfRange(),a),c.push(this._oobLayer.render())),this._labelLayer&&(this._layoutMode>this.ShowFlags.XSMALL&&this._showDataPointLabels&&this._showDataPoints?(this._labelLayer.renderer.edgeBleed={left:this._edgeBleed,right:this._edgeBleed,top:0,bottom:this._edgeBleed},this._labelLayer.update(this._lineLayer.getLineObjects(),a),this._labelLayer.show(),c.push(this._labelLayer.render())):this._labelLayer.hide()),this._rangeSelectionLayer&&c.push(this.renderRangeSelections()),k.all(c).then(function(){return b.afterPaint(a.axesSettings[0].topCutoff,a.axesSettings[0].bottomCutoff)})},clear:function(){this._super(),this.layers.forEach(function(a){a.clear()})},_getAxisDetails:function(a){var b=a.getPlotMin(),c=a.getPlotMax(),d=c-b,e=a.getPadding(),f=e.top,g=a.rect.height-e.bottom,h=0;return h=b>0?g:c<0?f:Math.ceil(a.getPositionOfValue(0)+1e-5),{plotMin:b,plotMax:c,posMin:a.getPositionOfValue(b),posMax:a.getPositionOfValue(c),plotRange:d,topCutoff:f,bottomCutoff:g,areaStartBase:h,zeroPos:Math.floor(a.getPositionOfValue(0))-.5}}})}),define("extensions.qliktech/linechart/linechart-properties",["client.utils/default-property-logic","objects.utils/continuous-utils"],function(a,b){function c(a,b){var c=b.getDimensions(),d=b.getMeasures();return"area"===a.lineType&&c.length+d.length>2}var d,e,f,g=a.getLogicFor("hard","linechart");return d={uses:"settings",items:{presentation:{type:"items",translation:"properties.presentation",grouped:!0,items:{lineType:{ref:"lineType",type:"string",component:"item-selection-list",defaultValue:"line",horizontal:!0,items:[{icon:"æ",component:"icon-item",labelPlacement:"bottom",translation:"properties.style.line",value:"line"},{icon:"ø",component:"icon-item",labelPlacement:"bottom",translation:"properties.style.area",value:"area"}]},stackedProps:{type:"items",grouped:!1,items:{stackedArea:{ref:"stackedArea",translation:"properties.style.stackedArea",type:"boolean",defaultValue:!1,show:function(a,b){return c(a,b)}},separateStacking:{ref:"separateStacking",translation:"properties.separateStacking",type:"boolean",defaultValue:!0,readOnly:function(a){return!a.stackedArea},show:function(a,b){return c(a,b)}}}},scrollStartPos:{ref:"scrollStartPos",type:"number",translation:"properties.ScrollAlignment",component:"dropdown",defaultValue:0,options:[{value:0,translation:"properties.ScrollAlignStart"},{value:1,translation:"properties.ScrollAlignEnd"}],show:function(a,c,d){return!b.isContinuousChart(d.layout)}},nullMode:{type:"string",component:"dropdown",ref:"nullMode",translation:"properties.nullMode",options:[{value:"gap",translation:"properties.nullMode.gap"},{value:"connect",translation:"properties.nullMode.connect"},{value:"zero",translation:"properties.nullMode.zero"}],defaultValue:"gap"},dataPointSettings:{type:"items",grouped:!1,snapshot:{tid:"property-dataPoint"},items:{dataPoints:{ref:"dataPoint.show",translation:"properties.dataPoints.showDataPoints",type:"boolean",defaultValue:!1},showDataPointLabels:{ref:"dataPoint.showLabels",translation:"properties.dataPoints.labelmode",type:"boolean",component:"switch",defaultValue:!1,show:function(a){return a.dataPoint&&a.dataPoint.show},options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}]}}},gridLines:{type:"items",snapshot:{tid:"property-gridLines"},items:{showGridLines:{ref:"gridLine.auto",type:"boolean",translation:"properties.gridLine.spacing",component:"switch",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}]},gridSpacing:{type:"number",component:"dropdown",ref:"gridLine.spacing",defaultValue:2,options:[{value:0,translation:"properties.gridLine.noLines"},{value:1,translation:"properties.gridLine.wide"},{value:2,translation:"properties.gridLine.medium"},{value:3,translation:"properties.gridLine.narrow"}],show:function(a){return a.gridLine&&!a.gridLine.auto}}}}}},colorsAndLegend:{uses:"colorsAndLegend",items:{colors:{items:{colorMode:{options:g.color.colorMode.options}}},legend:{items:{show:{snapshot:{tid:"property-legend"}}}}}},dimensionAxis:{uses:"axis.dimensionAxis"},measureAxis:{uses:"axis.flippableMeasureAxis",items:{scale:{type:"items",items:{logScale:{ref:"measureAxis.logarithmic",translation:"properties.axis.logarithmicScale",type:"boolean"},label:{component:"text",translation:"properties.axis.logarithmicScaleNote",show:function(a){return a.measureAxis&&a.measureAxis.logarithmic}}}}}}}},e={type:"items",translation:"properties.sorting",items:{noContinuousSortingMessage:{component:"text",translation:"properties.sorting.noContinuousSortingMessage",show:function(a,c,d){return b.isContinuousChart(d.layout)}},defaultSorting:{uses:"sorting",show:function(a,c,d){return!b.isContinuousChart(d.layout)},items:{dimensions:{locked:function(a,b,c){return 1===c.getMeasures().length&&2===c.getDimensions().length}},measures:{locked:function(a,b,c){return 1===c.getMeasures().length&&2===c.getDimensions().length}}}}}},f={type:"items",component:"expandable-items",translation:"properties.addons",items:{dataHandling:{uses:"dataHandling"},refLines:{uses:"reflines"}}},{type:"items",component:"accordion",items:{data:{uses:"data",items:{dimensions:{items:{nullSuppression:{show:function(a,c,d){return!b.isContinuousChart(d.layout)}}}}}},sorting:e,addons:f,settings:d}}}),define("extensions.qliktech/linechart/linechart-data",["client.utils/property-resolver"],function(a){function b(a){var b,c=a.getDimensions(),d=a.getMeasures();1===c.length&&1===d.length?0!==a.getSorting()[0]&&a.changeSorting(1,0):c.length>1&&1===d.length&&0!==(b=a.getSorting().indexOf(0))&&a.changeSorting(b,0)}function c(b,c){var d=c.getDimensions(),e=c.getMeasures(),f=a.getValue(b,"color.mode");d.length>1&&a.setValue(b,"color.persistent",!0),"byMeasure"===f&&d.length>1?a.setValue(b,"color.mode","byDimension"):"byDimension"===f&&d.length<=1&&e.length<=1?a.setValue(b,"color.mode","primary"):"byExpression"===f&&0===e.length&&a.setValue(b,"color.mode","primary")}function d(a){return a>=2?1:15}return{dimensions:{min:1,max:function(a){return a>=2?1:2},add:function(a,d,e){e.getDimensions().length>1&&(d.qHyperCubeDef.qMode="K",d.qHyperCubeDef.qAlwaysFullyExpanded=!0),b(e),c(d,e)},move:function(a,d,e){e.getDimensions().length>1&&(d.qHyperCubeDef.qMode="K",d.qHyperCubeDef.qAlwaysFullyExpanded=!0),b(e),c(d,e)},remove:function(a,b,d){var e=d.getDimensions();c(b,d),1===e.length&&(b.qHyperCubeDef.qMode="S")},autoSort:function(a,b,c,d){c&&(c.indexOf("$numeric")!==-1||c.indexOf("$date")!==-1||c.indexOf("$timestamp")!==-1?d.qSortByNumeric=1:c.indexOf("$text")===-1&&c.indexOf("$ascii")===-1||(d.qSortByAscii=1))}},measures:{min:1,max:d,add:function(a,d,e){b(e),c(d,e)},move:function(a,d,e){b(e),c(d,e)},remove:function(a,b,d){var e=d.getDimensions();c(b,d),e.length>1?(b.qHyperCubeDef.qMode="K",b.qHyperCubeDef.qAlwaysFullyExpanded=!0):1===e.length&&(b.qHyperCubeDef.qMode="S")}}}}),define("extensions.qliktech/linechart/linechart-explore-properties",["client.utils/default-property-logic","client.utils/property-hypercube-helper","objects.utils/continuous-utils"],function(a,b,c){var d=a.getLogicFor("explore","linechart");return{type:"items",component:"accordion",items:{data:{uses:"data"},sort:{uses:"sort",show:function(a,b){return!c.isContinuousChart(b)},items:{dimensions:{locked:function(a,c){return 1===b.getNumMeasures(c)&&2===b.getNumDimensions(c)&&0===a}}}},presentation:{uses:"presentation",items:{valueLabels:{type:"boolean",component:"switch",translation:"properties.dataPoints.labelmode",diffs:["dataPoint.show","dataPoint.showLabels"],options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],setPropertyValue:function(a,b){a.dataPoint.show=b,a.dataPoint.showLabels=b},getValue:function(a){return a.dataPoint.show&&a.dataPoint.showLabels}},lineType:{ref:"lineType",type:"string",component:"item-selection-list",horizontal:!0,items:[{icon:"æ",component:"icon-item",labelPlacement:"bottom",translation:"properties.style.line",value:"line"},{icon:"ø",component:"icon-item",labelPlacement:"bottom",translation:"properties.style.area",value:"area"}]},logarithmic:{type:"boolean",component:"switch",translation:"properties.axis.logarithmicScale",ref:"measureAxis.logarithmic",options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}]}}},color:{uses:"color",items:{mode:{options:d.color.colorMode.options}}}}}}),define("text!extensions.qliktech/linechart/linechart.ng.html",[],function(){return'<div class="qv-viz"></div>\n<span class="qv-viz-center-disclaimer" ng-if="dataAttributes.noDataExist && dataAttributes.layoutMode > 2" q-translation="Object.Disclaimer.NoDataExist" q-title-translation="Object.Disclaimer.NoDataExist" dir="ltr"></span>\r\n<span class="qv-viz-center-disclaimer" ng-if="!dataAttributes.noDataExist && dataAttributes.onlyNanDim && dataAttributes.layoutMode > 2" q-translation="Object.Disclaimer.OnlyNanData" q-title-translation="Object.Disclaimer.OnlyNanData" dir="ltr"></span>\n<div qva-chart-disclaimer attributes="dataAttributes" visible="!dataAttributes.noDataExist" direction="options.direction"></div>\n'}),define("extensions.qliktech/linechart/linechart",["jquery","util","core.utils/deferred","objects.views/charts/scrollable-chart","objects.views/charts/components/chart-component","./linearea","extensions.qliktech/linechart/linechart-properties","extensions.qliktech/linechart/linechart-data","extensions.qliktech/linechart/linechart-explore-properties","objects.backend-api/stacked-api","text!./linechart.ng.html","objects.views/charts/disclaimers/chart-utils","objects.views/charts/utils/time-utils","objects.extension/object-conversion","objects.utils/continuous-utils"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){"use strict";function p(a){var b,c,d=0,f=0;b=this.components.measureAxis,!a.dataPoint.show||this._layoutMode<=e.prototype.ShowFlags.XSMALL?(d=0,f=0):a.dataPoint.show&&(c=15,a.dataPoint.showLabels&&(d=c+7,f=0)),["near","bottom"].contains(this.components.dimensionAxis.dock)?b.setPadding(d,0,f,0):b.setPadding(f,0,d,0)}function q(a,b,c){return a===b&&(a>0&&(a+=c),b<0&&(b-=c)),b>=1?b=1:b>0?b=Math.pow(10,Math.floor(Math.log(b)/Math.log(10))):a<=-1?a=-1:a<0&&(a=-Math.pow(10,Math.floor(Math.log(-a)/Math.log(10)))),{max:a,min:b}}var r,s={NONE:0,ONE_DIM:1,TWO_DIM:2};return r=d.extend("LineChart",{namespace:".linechart",init:function(b,c,d,e,g){var h,i=a.extend(!0,{},d);d=a.extend(!0,d||{},{components:{dataArea:{clazz:f},miniChart:{components:{dataArea:{clazz:f}}}}},i),this._super(b,c,d,e,g),this.components.miniChart&&(h=this.components.miniChart,this.components.miniChart.setBackendApi(this.backendApi),this.components.scrollArea.setMiniChart(h),h.setColorMap(this.providers.colorMap),h.components.measureAxis.setDock("left"),h.components.dimensionAxis.setDock("bottom"),h.components.dataArea.setMinorAxis(h.components.measureAxis),h.components.dataArea.setMajorAxis(h.components.dimensionAxis),h.setOrientation("vertical"))},initSelections:function(){if(!this.options._disableSelections){this.selections.types.range.setComponent("x",this.components.dimensionAxis),this.selections.types.range.setComponent("y",this.components.measureAxis),this.selections.Select.bind(function(a,b){this.onSelection.Select.apply(this,[a,b,this.selections.getActiveType().activeComponent.getSelectionIndices(),"L"])}.bind(this));var a=function(a){this.onSelection.scheduleInvalidation.call(this),this._activeDimAxis.setSelectedRanges(a),this.components.dataArea.updateRangeSelection(a),this.components.miniChart.components.dataArea.updateRangeSelection(a)};this.selections.UpdateRanges.bind(a.bind(this)),this.selections.Clear.bind(a.bind(this,[])),this.selections.Deactivated.bind(a.bind(this,[]))}this._super()},_postResize:function(){this.components.measureAxis.setNiceNumberEnabled(this._layoutMode>e.prototype.ShowFlags.XSMALL),this._super()},partialUpdate:function(){return this.components.dataArea.freezeZOrdering(),this._super.apply(this,[].slice.call(arguments))},isValid:function(a){return this._super(a)&&!this.supressChartRendering},_paint:function(){if(!this.isValid(this._data))return this.clear();this._super();var a,b=this.components.scrollArea,d=[];p.call(this,this._data),this.layout(),!this.isDimensionContinuous&&this._dataForMiniChartChanged&&this.components.scrollArea.isVisible()&&this.components.scrollArea.getUseMiniChart()&&this.components.miniChart&&(d.push(this.components.miniChart.setData(this._data)),this._dataForMiniChartChanged=!1);var e=this.checkPage();if(e)d.push(e);else{for(a in this.components)d.push(this.components[a].invalidateDisplay("LineChart.paint"));b.viewState.min+b.viewState.range>b.fullState.max&&b.setOffset(b.fullState.max-b.viewState.range)}return c.all(d)},prePaint:function(a){this._super(a);var b=!1,c=o.isContinuousChart(a);if(2===a.qHyperCube.qDimensionInfo.length)if(!c&&a.qHyperCube.qStackedDataPages[0]){var d=a.qHyperCube.qStackedDataPages[0].qData[0];d&&(b=d.qSubNodes.some(function(a){return a.qDown>0}))}else{var e=a.qHyperCube.qDimensionInfo[1]
;b=e.qStateCounts.qLocked+e.qStateCounts.qOption+e.qStateCounts.qSelected>m.maxNumberOfLines}l.applyDisclaimerAttributes({title:a.qHyperCube.qDimensionInfo.length>1,bottom:!0,supportRangeOverZero:!a.measureAxis.logarithmic,paging:1===a.qHyperCube.qDimensionInfo.length,explicitLimitedData:b},this.$scope.dataAttributes,this.$element,this.$scope,a);var f=a.qHyperCube.qDimensionInfo[0];this.$scope.dataAttributes.onlyNanDim=!!c&&!!f&&(f.qMax<f.qMin||"NaN"===f.qMax),this.supressChartRendering=this.$scope.dataAttributes.noDataExist||this.$scope.dataAttributes.onlyNanDim},updateData:function(a){if(this.setIsDimensionContinuous(o.isContinuousChart(a)),this._setActiveDimensionAxis(a),this.selectionsCache.setSelectionMode(this.isDimensionContinuous?this.selectionsCache.SELECTION_MODE.VALUE:this.selectionsCache.SELECTION_MODE.VALUE|this.selectionsCache.SELECTION_MODE.ROW),this.isDimensionContinuous){var b=this,c=this._super;return this.updateFullContinuousData(a).then(function(a){return c.call(b,a)})}return this._super(a)},_updateData:function(a){var b=[];this._checkPage=!1,this._data=a,this.isDimensionContinuous||(this._dataForMiniChartChanged=!0),this._disablePagingTransitions(),this.components.dataArea.unFreezeZOrdering(),this.isStacked=("stackedArea"===a.lineType||"area"===a.lineType&&a.stackedArea)&&(a.qHyperCube.qDimensionInfo.length>1||a.qHyperCube.qMeasureInfo.length>1),this.components.measureAxis.isStacked=this.isStacked,!this.isDimensionContinuous&&a.qHyperCube.qDimensionInfo.length>1&&!this.isStacked?this.components.scrollArea.setUseMiniChart(!1):this.components.scrollArea.setUseMiniChart(!0);var d=null;if(this._pagingMode=s.NONE,this.components.dataArea.setSelectionIndices([0]),a.qHyperCube.qDimensionInfo.length>1){var e=a.qHyperCube.qDimensionInfo[1].qStateCounts.qOption+a.qHyperCube.qDimensionInfo[1].qStateCounts.qSelected;d=a.qHyperCube.qStackedDataPages&&a.qHyperCube.qStackedDataPages.length&&a.qHyperCube.qStackedDataPages[0].qData&&a.qHyperCube.qStackedDataPages[0].qData[0]?a.qHyperCube.qStackedDataPages[0].qData[0].qSubNodes.length+a.qHyperCube.qStackedDataPages[0].qData[0].qDown+a.qHyperCube.qStackedDataPages[0].qData[0].qUp:null,this.components.dimensionAxis.setSelectionIndices([0]),!a.qHyperCube.qDimensionInfo[1].qLocked&&e>1?this.components.dataArea.setSelectionIndices([1]):this.components.dataArea.setSelectionIndices([0]),this._pagingMode=s.ONE_DIM,this.isStacked=!0}else a.qHyperCube.qSize.qcy>a.qHyperCube.qDataPages[0].qArea.qHeight&&(d=a.qHyperCube.qSize.qcy,this._pagingMode=s.ONE_DIM);this.components.dataArea.setIsDimensionContinuous(this.isDimensionContinuous),this.isDimensionContinuous?this._pagingMode=s.NONE:(this.components.dimensionAxis.isDiscrete()||(this._pagingMode=s.NONE),this.components.dimensionAxis.setNumDiscreteUnits(d));var f,g={axes:{measureAxis:{component:this.components.measureAxis,data:a.measureAxis,dataIndices:a.qHyperCube.qMeasureInfo.map(function(a,b){return b})},dimensionAxis:{component:this.components.dimensionAxis,data:a.dimensionAxis,dataIndices:a.qHyperCube.qDimensionInfo.map(function(a,b){return b})},timeAxis:{component:this.components.timeAxis,data:a.dimensionAxis},continuousAxis:{component:this.components.continuousAxis,data:a.dimensionAxis}},refLineLabels:{labels:{data:a.refLine.refLines,component:this.components.refLineLabels,axis:this.components.measureAxis}},refLines:{component:this.components.refLines},axisTitles:{dimensionAxisTitle:{component:this.components.dimensionAxisTitle,data:a.dimensionAxis},measureAxisTitle:{component:this.components.measureAxisTitle,data:a.measureAxis}}},h=this.components.dimensionAxisTitle,i=this.components.measureAxisTitle;return b.push(this.components.dataArea.setData(a)),b.push(this.providers.colorMap.setData(a)),b.push(this.components.colorLegend.setData(a)),this.providers.colorMap.getLegendDataProvider().setLegendMarker(a.dataPoint.show?["line","circle"]:["line"]),b.push(h.setData(a)),b.push(i.setData(a)),this._super(a,g),f=this.getSnapshotStoredChartData(),this._readStoredData&&f?(this.components.dimensionAxis.setInnerOffset(f.axisInnerOffset),this.components.scrollArea.setOffset(f.scrollOffset),this.components.scrollArea.setViewRange(f.viewRange)):this.options.viewState?(this.components.dimensionAxis.setInnerOffset(this.options.viewState.axisInnerOffset),this.components.scrollArea.setOffset(this.options.viewState.scrollOffset)):isNaN(a.scrollStartPos)?this.isDimensionContinuous||(this.components.dimensionAxis.setInnerOffset(0),this.components.scrollArea.setOffset(0)):this.components.scrollArea.setRelativeOffset(a.scrollStartPos),this.isDimensionContinuous||(this._checkPage=!0),c.all(b)},updateDataArea:function(a){var b="stackedArea"===a.lineType||"area"===a.lineType&&a.stackedArea?"stackedArea":a.lineType;this._super.apply(this,[].slice.call(arguments)),this.components.dataArea.setLineType(b),"byExpression"===a.color.mode?this.components.dataArea.interpolateVaryingColors=!a.color.expressionIsColor&&["sg","dg"].indexOf(a.color.measureScheme)!==-1:this.components.dataArea.interpolateVaryingColors=!1,this.components.miniChart&&(this.components.miniChart.components.dataArea.setLineType(b),this.components.miniChart.components.dataArea.setNullMode(a.nullMode),this.components.miniChart.components.dataArea.setSeparateStacking(a.separateStacking),this.components.miniChart.setLogScale(a.measureAxis.logarithmic)),this.components.dataArea.setShowDataPoints(a.dataPoint.show),this.components.dataArea.setNullMode(a.nullMode),this.components.dataArea.setSeparateStacking(a.separateStacking),this.components.dataArea.setShowDataPointLabels(a.dataPoint.showLabels),this.components.dataArea.updateNow(["properties"])},updateAxis:function(a,c){this._super(a,c);var d,e,f,g,h,i,j,k=this.getSnapshotStoredChartData();this.components.dimensionAxis.setData(a),this._activeDimAxis.setData(a),f=Math.min.apply(this,a.qHyperCube.qMeasureInfo.filter(function(a){return!isNaN(a.qMin)}).map(function(a){return a.qMin})),g=Math.max.apply(this,a.qHyperCube.qMeasureInfo.filter(function(a){return!isNaN(a.qMax)}).map(function(a){return a.qMax})),b.isNumeric(f)||(f=-1),b.isNumeric(g)||(g=1),h=c.axes.measureAxis,i=!h.data.autoMinMax&&["min","minMax"].contains(h.data.minMax)?Number(h.data.min):null,j=!h.data.autoMinMax&&["max","minMax"].contains(h.data.minMax)?Number(h.data.max):null,d=this.components.measureAxis,d.setWhiteSpaceOptimizingEnabled(!0),d.setRealDataRange(void 0,void 0);var l=this.components.dataArea.getMajorAxisData(),m=this.components.dataArea.getMinorAxisData();if(this.components.dimensionAxis.setDataRange(l.data,l.info),e=0,g<f?(g=10,f=-10):g===f&&(g?e=Math.abs(g?.2*g:0):(g=10,f=-10)),this._readStoredData&&k&&k.dataRanges)this.setAxisDataRange(d,k.dataRanges[0].max,k.dataRanges[0].min,j,i,e);else if(m&&("stackedArea"===a.lineType||"area"===a.lineType&&a.stackedArea)&&(a.qHyperCube.qMeasureInfo.length>1||a.qHyperCube.qDimensionInfo.length>1))this.setAxisDataRange(d,m.max,m.min,j,i,e);else if("line"!==a.lineType)if(this._data.measureAxis.logarithmic){var n=q(g,f,e);this.setAxisDataRange(d,n.max,n.min,j,i,e)}else this.setAxisDataRange(d,g>0?g+e:0,f<0?f-e:0,j,i,e);else this.setAxisDataRange(d,g>0?g+e:Math.min(0,g+e),f<0?f-e:Math.max(0,f-e),j,i,e);this.updateTimeAxis(),p.call(this,a),this.components.dimensionAxisTitle.setSelectionsEnabled(!!this.selections),this.components.measureAxisTitle.setSelectionsEnabled(!!this.selections)},getPreferredSize:function(){return this._super()},destroy:function(){return this._super()}}),{type:"linechart",BackendApi:j,template:k,View:r,definition:g,softDefinition:i,initialProperties:{qHyperCubeDef:{qDimensions:[],qMeasures:[],qMode:"S",qAlwaysFullyExpanded:!0,qInitialDataFetch:[{qTop:0,qHeight:500,qLeft:0,qWidth:17}],qSuppressZero:!1,qSuppressMissing:!0}},data:h,support:{cssScaling:!1,snapshot:!0,export:!0,exportData:!0,sharing:!0},options:{selections:{dataArea:{},range:{},colorLegend:{}},tooltips:{}},importProperties:function(a,b,c){var d=n.axisChart.importProperties.apply(n,[a,b,c]),e=d.qProperty;return e.qHyperCubeDef.qDimensions.length>1&&(e.qHyperCubeDef.qMode="K"),e.color&&"byDimension"===e.color.mode&&e.qHyperCubeDef.qDimensions.length<=1&&e.qHyperCubeDef.qMeasures.length<=1&&n.changeProperty("color.mode","primary",d),d},exportProperties:n.axisChart.exportProperties.bind(n)}}),define("extensions.qliktech/treemap/treemap-node",["objects.views/charts/shapes/container","objects.views/charts/shapes/display-object","objects.views/charts/renderers/canvas-renderer","objects.views/charts/renderers/canvas/rect","objects.views/charts/shapes/rect","general.utils/shapes/rect"],function(a,b,c,d,e,f){var g=a.extend("TreemapNode",{init:function(a,b,c){this._super(),this.x=0,this.y=0,this.width=0,this.height=0,this.data.area=0,this.data.value=b||0,this.data.label=a||"",this.data.valueLabel=c||"",f.apply(this,[0,0,0,0])},pointInside:b.prototype.pointInside,containsPoint:e.prototype.containsPoint,intersectsLocalLine:e.prototype.intersectsLocalLine,getLocalPoints:e.prototype.getLocalPoints,getLocalBoundingRect:e.prototype.getLocalBoundingRect,_calculateBounds:b.prototype._calculateBounds});return Object.keys(e.prototype).forEach(function(a){!g.prototype.hasOwnProperty(a)&&["pointInside","intersectsLine","getBoundingRect","getPoints"].indexOf(a)<0&&(g.prototype[a]=e.prototype[a])}),c._registerRenderFn(d.render,g),g}),define("extensions.qliktech/treemap/treemap-layout",["core.utils/class","extensions.qliktech/treemap/treemap-node","translator"],function(a,b,c){function d(a,b){var c,e;for(c=0;c<a.length;c++)e=a[c],e.x=b-e.x-e.width,e._children&&e._children.length&&d(e._children,b)}function e(a,b){var c,d;for(c=0;c<a.length;c++)d=a[c],d.y=b-d.y-d.height,d._children&&d._children.length&&e(d._children,b)}var f,g={NONE:0,NONE_COLLAPSED:.1,LEAF:1,HEADER:2,OVERLAY:3};return f=a.extend("TreemapLayout",{init:function(){this.cellPadding=2,this.collapseHeadersOnSmallBranches=!0,this.labeling={},this.othersLabel=c.get("properties.dimensionLimits.others")},sort:function(){return this},weigh:function(a,c,d){if(!a||!a.length)return this;d=d||0;for(var e,f,g=a.length,h=0,i=0,j=a[0].parent.data.value;g;)h+=a[--g].data.value;for(g=a.length,e=Math.max(h,j);g;)a[--g].data.weight=e?a[g].data.value/e:0,i+=a[g].data.weight,a[g].isBranch&&this.weigh(a[g].children,c,d+1);return 1-i>1e-5&&(f=new b,f.data.label="",f.data.weight=1-i,f.x=0,f.y=0,f.width=0,f.height=0,f.data.qElemNo=-3,f.data.qType="O",f.data.isFakeOthers=!0,f.data.value=j-h,f.data.depth=(a[0].parent.data.depth||0)+1,a[0].parent.addChild(f),a[0].parent.children!==a&&a.push(f)),this},layout:function(){return this},arrange:function(a,b,c,f,h,i,j,k){if(!a||!a.length)return this;this.layout(a,b,c,f,h);var l,m,n,o=this.cellPadding;for(n=0;n<a.length;n++)l=a[n],l.visible=l.width>0&&l.height>0,l.isBranch?(l.width=Math.max(0,l.width-o),l.height=Math.max(0,l.height-o),l.x+=.5*o,l.y+=.5*o,l.visible=l.width>0&&l.height>0,l.data.labelType=this._getLabelType(i,!0,l.data.area),m=l.data.labelType!==g.HEADER?0:24,l.data.labelType===g.NONE_COLLAPSED&&(m=4,l.data.labelType=g.NONE),this.arrange(l.children,l.width,l.height-m,l.x,l.y+m,i+1)):l.data.labelType=this._getLabelType(i,!1,l.data.area);return 0===i&&(1===j&&d(a,b),1===k&&e(a,c)),this},_getLabelType:function(a,b,c){return b?a>this.labeling.headers.numLevels?g.NONE:a===this.labeling.headers.numLevels?this.labeling.overlay.show&&c>=4e3?g.OVERLAY:g.NONE:this.collapseHeadersOnSmallBranches&&c<8e3?g.NONE_COLLAPSED:c<4e3?g.NONE:g.HEADER:c<4e3||"none"===this.labeling.leaves.type?g.NONE:g.LEAF}}),f.LABEL=g,f}),define("extensions.qliktech/treemap/treemap-squarified-layout",["extensions.qliktech/treemap/treemap-layout"],function(a){"use strict";function b(a,b,c){var e,f,g,h=c.x,i=c.y,j=c.shortSide,k=a.length,l=0;if(c.direction===d){for(;l<k;l++)g=a[l],g.data.area<=0?(f=0,e=j):(f=j*g.data.area/b,e=g.data.area/f),g.x=Number(h.toFixed(5)),g.y=Number(i.toFixed(5)),g.width=Number(e.toFixed(5)),g.height=Number(f.toFixed(5)),i+=f;c.x+=e,c.width-=e}else{for(;l<k;l++)g=a[l],g.data.area<=0?(e=0,f=j):(e=j*g.data.area/b,f=g.data.area/e),g.x=Number(h.toFixed(5)),g.y=Number(i.toFixed(5)),g.width=Number(e.toFixed(5)),g.height=Number(f.toFixed(5)),h+=e;c.y+=f,c.height-=f}}function c(a,b,c,d){for(var e,f=Number.MAX_VALUE,g=0,h=b*b,i=c*c,j=a.length;j;)a[--j].data.area<f&&(f=a[j].data.area),a[j].data.area>g&&(g=a[j].data.area);return e=Math.max(h*g/i,i/(h*f)),d.data.area<f&&(f=d.data.area),d.data.area>g&&(g=d.data.area),i=(c+d.data.area)*(c+d.data.area),Math.max(h*g/i,i/(h*f))<=e}var d=0;return a.extend({init:function(){this._super()},sort:function(a){var b,c;if(!a||!a.length)return this;for(a.sort(function(a,b){return"O"===b.data.qType?-1:"O"===a.data.qType?1:b.data.weight-a.data.weight}),c=a.length,b=0;b<c;b++)a[b].isBranch&&this.sort(a[b].children);return this},layout:function(a,e,f,g,h){if(!a||!a.length)return this;var i,j,k,l,m={x:g,y:h,width:e,height:f,direction:f<=e?d:1,shortSide:Math.min(f,e)},n=0,o=[],p=e*f;for(j=a.length;j;)a[--j].data.area=p*a[j].data.weight;for(j=0;j<a.length;)i=a[j],m.direction===d?(l=m.height*i.data.area/(n+i.data.area),k=i.data.area/l):(k=m.width*i.data.area/(n+i.data.area),l=i.data.area/k),!o.length||c(o,m.shortSide,n,i)?(n+=i.data.area,o.push(i),j++):(b(o,n,m),n=0,o=[],m.shortSide=Math.min(m.width,m.height),m.direction=m.height<=m.width?d:1);return o.length&&b(o,n,m),this}})}),define("extensions.qliktech/treemap/treemap-hierarchy",["core.utils/class","extensions.qliktech/treemap/treemap-node"],function(a,b){"use strict";function c(a,d,f,g,h,i,j){var k,l,m,n,o,p=d?d.length:0;for(g=g||0,j=j||0,o=0;o<p;o++)k=null,m=d[o],l=m.children,m.data.qType===e.PSEUDO&&(j=o),m.data.qType!==e.TOTAL&&(l.length||"N"===m.data.qType?1===l.length&&l[0].data.qType===e._MEASURE?(n=l[0].children,(n=n?n[0]:null)&&!isNaN(n.data.qValue)&&n.data.qValue>0&&(k=new b(m.data.qText,n.data.qValue,i?i.formatValue(n.data.qValue):n.data.qText),k.data.row=m.data.rowIndex,k.data.qType=m.data.qType,k.data.qElemNo=m.data.qElemNo,m.cacheItem&&m.cacheItem.addShape("dataArea",k),k.data.cacheItem=m.cacheItem)):1===l.length&&l[0].data.qType===e.VALUE?!isNaN(l[0].data.qValue)&&l[0].data.qValue>0&&(k=new b(m.data.qText,l[0].data.qValue,i?i.formatValue(l[0].data.qValue):l[0].data.qText),k.data.row=m.data.rowIndex,k.data.qType=m.data.qType,k.data.qElemNo=m.data.qElemNo,m.cacheItem&&m.cacheItem.addShape("dataArea",k),k.data.cacheItem=m.cacheItem):m.data.qMaxPos>0&&(k=new b(m.data.qText,m.data.qMaxPos),k.data.qElemNo=m.data.qElemNo,k.data.row=m.data.rowIndex,k.data.qType=m.data.qType,k.data.cacheItem=m.cacheItem,k.data.addMeasures=!0,m.cacheItem&&m.cacheItem.addShape("dataArea",k),l.length&&c(k,l,f,g+1,h,i,j)):!isNaN(m.data.qValue)&&m.data.qValue>0&&(k=new b(m.data.qText,m.data.qValue,m.data.qText),k.data.qType=m.data.qType,k.data.qElemNo=m.data.qElemNo,k.data.row=m.data.rowIndex,k.data.isMeasure=g===f,m.cacheItem&&m.cacheItem.addShape("dataArea",k),k.data.cacheItem=m.cacheItem),k&&(k.data.depth=g,isNaN(j)||(k.data.measureIndex=j),a.addChild(k)))}function d(a){var b=[];return a.forEach(function(a){b=b.concat(a.children)}),b}var e={PSEUDO:"P",TOTAL:"T",VALUE:"V",NORMAL:"N",OTHERS:"O",ROOT:"R",_MEASURE:"_M"};return a.extend("TreemapHierarchy",{init:function(a){this.root=a||new b,this._pseudoDimPos=0,this.labeling={values:{show:!1}}},setData:function(a,b){this._pseudoDimPos=a.pseudoDimPos||0,this._numMeasures=a.qHyperCube.qMeasureInfo.length,this._numDimensions=a.qHyperCube.qDimensionInfo.length,this._dimensionLocks=a.qHyperCube.qDimensionInfo.map(function(a){return a.qLocked}),this._selectionStates=a.qHyperCube.qDimensionInfo.map(function(a){return a.qStateCounts});var d=this.labeling.values.show&&this.measureFormatters&&this.measureFormatters[0]&&"U"===this.measureFormatters[0].type?this.measureFormatters[0]:null,f=a.qHyperCube.qStackedDataPages[0].qData,g=a.qHyperCube.qMeasureInfo.map(function(a){return a.qFallbackTitle}),h=a.qHyperCube.qMeasureInfo.length>1?this._pseudoDimPos:-1;this.root.removeChildren(),f&&f.length&&(this.root.data.value=f[0].qMaxPos,this.root.data.qType=e.ROOT,c(this.root,b.children,h,0,g,d))},getDimensionIndexFromNode:function(a){var b,c,d=0;if(!a)return-2;if(a.data.qType===e.PSEUDO)return-1;for(b=a,c=b.parent;b&&c&&c!==this.root;)b=c,c=b.parent,b.data.qType!==e.PSEUDO&&d++;return d},getSelectableCacheItems:function(a){if(!a||!a.length)return[];var b,c=a[0],f=c.children,g=this.getDimensionIndexFromNode(c);return c.data.qType===e.PSEUDO?f.length?this.getSelectableCacheItems(d(a)):[]:this._dimensionLocks[g]?f.length?this.getSelectableCacheItems(d(a)):[]:(b=this.getCacheItemsFromNodes(a),b.length<=1&&this._selectionStates[g].qSelected&&!this._selectionStates[g].qOption&&f.length?this.getSelectableCacheItems(d(a)):b)},getCacheItemsFromNodes:function(a){var b,c=a?a.length:0,d=[];for(b=0;b<c;b++)a[b].data.cacheItem&&d.indexOf(a[b].data.cacheItem)<0&&d.push(a[b].data.cacheItem);return d}})}),define("extensions.qliktech/treemap/treemap-area",["general.utils/color","./treemap-squarified-layout","./treemap-hierarchy","client.utils/property-resolver","objects.views/charts/renderers/canvas-renderer","objects.views/charts/shapes/rect","objects.views/charts/shapes/container","objects.views/charts/shapes/text","objects.views/charts/components/chart-component","objects.views/charts/chart-style-service","core.utils/deferred","client.utils/theme/modern/theme","core.utils/feature-flags"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";function n(b,c){return x.width=8,x.height=8,y.save(),y.fillStyle=a.toRGBA(b),y.strokeStyle=a.toRGBA(b,c),y.lineWidth=2,y.scale(1,1),y.beginPath(),y.moveTo(5,-1),y.lineTo(-1,5),y.moveTo(9,3),y.lineTo(3,9),y.stroke(),y.restore(),y.createPattern(x,"repeat")}function o(b,c){var d,e,f,g,i,j,k,l=b?b.length:0,n="leaf",p=new a(this._style.overlay.label.color.light),q=new a(this._style.overlay.label.color.dark),r=function(a,b){return b.data.isColorDark?a+b.data.value:a};for(d=0;d<l;d++)if(e=b[d],n=e.data.labelType,e.isBranch?(o.apply(this,[b[d].children,c+1]),j=this._branchLabelContainer):j=this._leafLabelContainer,e.data.labelType){switch(g=e.data.label,g&&g.length>512&&(g=g.substr(0,256)),this.labeling.values.show&&1===n&&e.data.valueLabel&&(g=[g,e.data.valueLabel]),e.data.labelShape?e.data.labelShape.parent||j.addChild(e.data.labelShape):(e.data.labelShape=new h,e.data.labelShape.setText(g),j.addChild(e.data.labelShape)),i={x:e.x,y:e.y,width:e.width,height:e.height,maxHeight:e.height-4,maxWidth:e.width-8,align:this.yMirrorMode?"right":"left",baseline:"top"},n){case 3:e.data.labelFill||(k=e.descendants,e.data.labelFill=k.reduce(r,0)>e.data.value/2?p:q,e.data.labelStroke=e.data.labelFill===p?"rgba(33, 33, 33, 0.4)":"rgba(230, 230, 230, 0.4)",e.data.labelFill=e.data.labelFill.toRGBA(),e.data.labelShape.strokeFirst=!0),i.fill=e.data.labelFill,i.stroke=e.data.labelStroke,i.maxNumLines=/\s+/.test(e.data.label)?2:1,f=Math.round(.1*Math.sqrt(2*e.data.area)),m.THEMING?i.font="bold "+f+"px 'QlikView Sans'":i.font=this._styleService.getFont(s,"overlay.label",null,null,f),i.strokeWidth=f>64?2:1,i.align="center",i.baseline="middle";break;case 2:i.fill=this._style.branch.label.color,i.stroke=void 0,i.x+=4,i.width-=8,i.font=this._style.branch.label.font,i.baseline="middle",i.maxNumLines=1,i.height=t;break;default:i.fill=e.data.isColorDark?this._style.leaf.label.color.light:this._style.leaf.label.color.dark,i.x+=4,i.y+=4,i.width-=8,i.height-=8,i.font=this.labeling.leaves.type===u.DYNAMIC?this._styleService.getFont(s,"leaf.label",null,null,Math.round(.1*Math.sqrt(2*e.area))):this._style.leaf.label.font,i.baseline="top",i.maxNumLines=this.labeling.values.show?[-1,1]:[-1]}e.data.labelShape.attrs(i)}else e.data.labelShape&&e.data.labelShape.detach()}function p(b){var c,d,e,f=b?b.length:0,g=this._colorMap;for(c=0;c<f;c++)b[c].isBranch?(b[c].fill=this._style.branch.fill,b[c].stroke=null,p.call(this,b[c].children)):b[c].data.isInitiated||(e=[],"P"!==b[c].data.qType&&void 0!==b[c].data.qElemNo&&e.push(b[c].data.qElemNo),b[c].ancestors.forEach(function(a){["A","N"].contains(a.data.qType)&&e.push(a.data.qElemNo)}),e.reverse(),b[c].data.isInitiated=!0,b[c].data.color=g.getColor(e,b[c].data.value,b[c].data.measureIndex||0,b[c].data.row),d=b[c].data.isFakeOthers?this._branchColorAtDepth[b[c].data.depth]:b[c].data.color,b[c].data.isColorDark=a.getBestContrast(d,v,w)===v,b[c].fill=b[c].data.isFakeOthers?this._fakeOthersPatternAtDepth[b[c].data.depth]:b[c].data.color.toRGBA(),b[c].stroke=this._sheetBackgroundStroke,b[c].strokeWidth=1)}function q(a){return m.THEMING?{backgroundColor:a.getStyle("","backgroundColor"),branch:{fill:a.getStyle("branch","backgroundColor"),label:{color:a.getStyle("branch.label","color"),font:"normal "+a.getStyle("branch.label","fontSize")+" 'QlikView Sans'"}},leaf:{border:{width:{selected:2},color:{selected:"#000000"}},label:{font:"normal "+a.getStyle("leaf.label","fontSize")+" 'QlikView Sans'",color:{light:"#E6E6E6",dark:"#595959"}}},overlay:{label:{color:{light:"rgba(222,222,222,0.4)",dark:"rgba(33,33,33,0.4)"}}}}:{backgroundColor:a.getValue(s,null,"backgroundColor"),branch:{fill:a.getValue(s,"branch","fill"),label:{color:a.getValue(s,"branch.label","color"),font:a.getFont(s,"branch.label")}},leaf:{border:{width:{selected:a.getValue(s,"leaf.border","width","selected")},color:{selected:a.getValue(s,"leaf.border","color","selected")}},label:{font:a.getFont(s,"leaf.label"),color:{light:a.getValue(s,"leaf.label","color","light"),dark:a.getValue(s,"leaf.label","color","dark")}}},overlay:{label:{color:{light:a.getValue(s,"overlay.label","color","light"),dark:a.getValue(s,"overlay.label","color","dark")}}}}}function r(b,c){var d=b._a+c._a*(1-b._a),e=(b._r*b._a+c._r*c._a*(1-b._a))/d,f=(b._g*b._a+c._g*c._a*(1-b._a))/d,g=(b._b*b._a+c._b*c._a*(1-b._a))/d;return 0===d&&(e=f=g=0),new a(e,f,g,1)}var s="treemap",t=24,u={NONE:"none",STATIC:"static",DYNAMIC:"dynamic"},v=new a("#eee"),w=new a("#666"),x=document.createElement("canvas"),y=x.getContext("2d");return i.extend("TreeMapArea",{init:function(){this._super.apply(this,arguments),this.renderers={cells:new e(this.container,{name:"cell-layer"}),labels:new e(this.container,{name:"label-layer"}),selections:new e(this.container,{name:"selection-layer"})},this._layout=new b,this._hierarchy=new c(this.renderers.cells.stage),this._pseudoDimPos=0,this._labelSettings={values:{show:!1},headers:{show:!0,numLevels:1},overlay:{show:!0},leaves:{show:!0,type:"static"}},this._styleService=m.THEMING?l.initializeService("object.treemap"):j.getInstance(),this._style=q(this._styleService),this._sheetBackgroundColor=new a(this._style.backgroundColor),this._sheetBackgroundStroke=a.toRGBA(this._sheetBackgroundColor,.5),this.labeling=this._labelSettings},cellPadding:2,setYMirrorMode:function(a){this.yMirrorMode!==a&&(this.yMirrorMode=a,this._yMirrorModeChanged=!0)},setColorMap:function(a){this._colorMap=a},getColorMap:function(){return this._colorMap},setPseudoDimPos:function(a){this._pseudoDimPos=a},setGlobalOpacity:function(a,b){a<1?(this._globalAlpha=a,this.toggleCacheItem()):this._super(a,b)},setDimensionTree:function(a){this._tree=a,this.invalidateProperties(),this.invalidateDisplay()},_updateSize:function(){this.invalidateDisplay()},_updateProperties:function(){if(this._data){this._style=q(this._styleService),this._sheetBackgroundColor=new a(this._style.backgroundColor),this._sheetBackgroundStroke=a.toRGBA(this._sheetBackgroundColor,.5),d.getValue(this._data,"labels.auto")?(this.labeling.overlay.show=!0,this.labeling.headers.numLevels=0,this.labeling.leaves.type=u.STATIC):(this.labeling.overlay.show=d.getValue(this._data,"labels.overlay",!0),this.labeling.headers.numLevels=d.getValue(this._data,"labels.headers")&&this._layoutMode>3?1:0,this.labeling.leaves.type=d.getValue(this._data,"labels.leaves")?u.STATIC:u.NONE),this.labeling.values.show=d.getValue(this._data,"labels.values",!1),this._layout.labeling=this.labeling,this._hierarchy.measureFormatters=this.measureFormatters;var b=this._hierarchy.root.children;this._hierarchy.labeling=this.labeling,this._hierarchy.setData(this._data,this._tree),this._dimension=0;var c=this.renderers.labels.stage;c.removeChildren();var e=new g;c.addChild(e);var f=new g;c.addChild(f);var h=this._data.qHyperCube.qDimensionInfo.map(function(a){return a.supressOthers});this._layout.othersLabelByDimension=this._data.qHyperCube.qDimensionInfo.map(function(a){return a.othersLabel}),this._layout.weigh(b,h).sort(b),this._leafLabelContainer=e,this._branchLabelContainer=f;var i=this._hierarchy.getSelectableCacheItems(b),j=this.selectionIdentifier?this.selectionIdentifier:"dataArea",k=0,l=0,m=i[0]?i[0].getShapes(j)[0]:null;m&&m.ancestors.forEach(function(a){a.parent&&("N"===a.data.qType&&k++,l++)}),this.setSelectionIndices([k]),this._dimension=l,this.setSelectableShapes(i);var o=new a(this._style.branch.fill),s=this._data.qHyperCube.qDimensionInfo.length+1;this._branchColorAtDepth=[r(o,this._sheetBackgroundColor)],this._fakeOthersPatternAtDepth=[];for(var t=1;t<s;t++)this._branchColorAtDepth.push(r(o,this._branchColorAtDepth[t-1]));for(t=0;t<s;t++)this._fakeOthersPatternAtDepth.push(n(this._colorMap.getColor([-3]),.1));this._dataChanged=!0,p.call(this,b),this.renderers.selections.stage.doInvalidate=!1,this.renderers.selections.stage.removeChildren()}},hasValidData:function(){return this._super()&&this._data},paint:function(){this._super(this._layoutMode,this._data);var a=this._hierarchy.root.children;return this.renderers.cells.stage.opacity=this._globalAlpha||1,this.renderers.labels.stage.opacity=this._globalAlpha||1,this.renderers.selections.stage.opacity=1,this._layout.cellPadding=this.cellPadding*Math.sqrt(this.rect.width*this.rect.height)/500,this.labeling.headers.numLevels=(d.getValue(this._data,"labels.auto",!0)||d.getValue(this._data,"labels.headers"))&&this._layoutMode>3?1:0,a.length&&(this._dataChanged||this._yMirrorModeChanged||this._oldW!==this.rect.width||this._oldH!==this.rect.height)&&(this._layout.arrange(a,this.rect.width-4,this.rect.height-4,this.yMirrorMode?-2:2,2,0,this.yMirrorMode?1:0),o.apply(this,[a,0])),this._dataChanged=!1,this._yMirrorModeChanged=!1,this._oldW=this.rect.width,this._oldH=this.rect.height,k.all([this.renderers.cells.render(!0),this.renderers.labels.render(!0),this.renderers.selections.render(!0)])},release:function(){for(var a in this.renderers)this.renderers[a].release();this._selectableShapes=[],this.renderers={},this._hierarchy=null,this._layout=null,this._super()},toggleCacheItem:function(a){var b=!0;this.renderers.cells.stage.opacity!==this._globalAlpha?(b=!1,this.renderers.cells.stage.opacity=this._globalAlpha,this.renderers.labels.stage.opacity=this._globalAlpha,this.renderers.selections.stage.doInvalidate=!1):this.renderers.selections.stage.doInvalidate=!0,a&&a.getShapes(this.selectionIdentifier?this.selectionIdentifier:"dataArea").forEach(function(c){a.selected?(c.data.borderShape||(c.data.borderShape=new f(c.x,c.y,c.width,c.height),c.data.borderShape.strokeWidth=this._style.leaf.border.width.selected,c.data.borderShape.stroke=this._style.leaf.border.color.selected,this.renderers.selections.stage.addChild(c.data.borderShape)),c.opacity=1,c.find("[data.labelShape]").forEach(function(a){a.data.labelShape.opacity=1,b&&a.data.labelShape.invalidate()}),c.data.labelShape&&(c.data.labelShape.opacity=1,b&&c.data.labelShape.invalidate())):(c.data.borderShape&&(c.data.borderShape.detach(),c.data.borderShape=null),c.opacity=void 0,c.data.labelShape&&(c.data.labelShape.opacity=void 0,b&&c.data.labelShape.invalidate()),c.find("[data.labelShape]").forEach(function(a){a.data.labelShape.opacity=void 0,b&&a.data.labelShape.invalidate()})),b&&c.invalidate()},this),b||(this.renderers.cells.render(),this.renderers.labels.render(),this.renderers.selections.render())}})}),define("text!extensions.qliktech/treemap/treemap.ng.html",[],function(){return'<div class="qv-viz"></div>\n<span class="qv-viz-center-disclaimer" ng-if="dataAttributes.onlyNegativeOrZero && dataAttributes.layoutMode > 2" q-translation="Object.Disclaimer.OnlyNegativeOrZeroValues" q-title-translation="Object.Disclaimer.OnlyNegativeOrZeroValues" dir="ltr"></span>\n<span class="qv-viz-center-disclaimer" ng-if="dataAttributes.noDataExist && dataAttributes.layoutMode > 2" q-translation="Object.Disclaimer.NoDataExist" q-title-translation="Object.Disclaimer.NoDataExist" dir="ltr"></span>\n<span class="qv-viz-center-disclaimer" ng-if="dataAttributes.onlyNanData && dataAttributes.layoutMode > 2" q-translation="Object.Disclaimer.OnlyNanData" q-title-translation="Object.Disclaimer.OnlyNanData" dir="ltr"></span>\n<div qva-chart-disclaimer attributes="dataAttributes" visible="!dataAttributes.onlyNegativeOrZero" direction="options.direction"></div>'}),define("extensions.qliktech/treemap/treemap-properties",["client.utils/property-resolver"],function(a){function b(a,b){var c=b.getDimensions();return b.getMeasures().length+c.length>2}var c;return c={uses:"settings",items:{presentation:{type:"items",translation:"properties.presentation",grouped:!1,items:{labels:{type:"items",items:{auto:{ref:"labels.auto",type:"boolean",translation:"properties.dataPoints.headersAndLabels",component:"switch",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}],snapshot:{tid:"property-dataPoints"}},headers:{ref:"labels.headers",translation:"properties.dataPoints.headers",type:"boolean",component:"switch",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],show:function(c,d){return!a.getValue(c,"labels.auto")&&b(c,d)}},overlay:{ref:"labels.overlay",type:"boolean",component:"switch",translation:"properties.dataPoints.overlayLabels",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],show:function(b,c){return!a.getValue(b,"labels.auto")&&c.getDimensions().length-(a.getValue(b,"labels.headers")?1:0)>1}},leaves:{ref:"labels.leaves",type:"string",translation:"properties.dataPoints.leafLabels",component:"switch",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],show:function(b){return!a.getValue(b,"labels.auto")},snapshot:{tid:"property-leafLabels"}},values:{ref:"labels.values",type:"boolean",component:"switch",translation:"properties.dataPoints.labelmode",defaultValue:!1,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],show:function(b){return a.getValue(b,"labels.auto")||a.getValue(b,"labels.leaves")}}}}}},colorsAndLegend:{uses:"colorsAndLegend",items:{legend:{items:{show:{defaultValue:!1}}}}}}},{type:"items",component:"accordion",items:{data:{uses:"data",items:{dimensions:{},measures:{}}},addons:{type:"items",component:"expandable-items",translation:"properties.addons",items:{dataHandling:{uses:"dataHandling",items:{suppressZero:null}}}},settings:c}}}),define("extensions.qliktech/treemap/treemap-explore-properties",["client.utils/property-resolver"],function(a){return{type:"items",component:"accordion",items:{data:{uses:"data"},presentation:{uses:"presentation",type:"items",translation:"properties.presentation",grouped:!1,items:{labels:{type:"items",items:{auto:{ref:"labels.auto",type:"boolean",translation:"properties.dataPoints.headersAndLabels",component:"switch",options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}]},headers:{ref:"labels.headers",translation:"properties.dataPoints.headers",type:"boolean",component:"switch",options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],show:function(b,c){return!a.getValue(b,"labels.auto")&&c.qHyperCube.qMeasureInfo.length+c.qHyperCube.qDimensionInfo.length>2}},overlay:{ref:"labels.overlay",type:"boolean",component:"switch",translation:"properties.dataPoints.overlayLabels",options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],show:function(b,c){
return!a.getValue(b,"labels.auto")&&c.qHyperCube.qDimensionInfo.length-(a.getValue(b,"labels.headers")?1:0)>1}},leaves:{ref:"labels.leaves",type:"string",translation:"properties.dataPoints.leafLabels",component:"switch",options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],show:function(b){return!a.getValue(b,"labels.auto")}},values:{ref:"labels.values",type:"boolean",component:"switch",translation:"properties.dataPoints.labelmode",options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}],show:function(b){return a.getValue(b,"labels.auto")||a.getValue(b,"labels.leaves")}}}}}}}}}),define("extensions.qliktech/treemap/treemap-data",["client.utils/property-resolver"],function(a){function b(b,c){var d=c.getDimensions(),e=c.getMeasures(),f=a.getValue(b,"color.mode");d.length>1&&b.color?b.color.persistent=!0:"byExpression"===f&&0===e.length&&a.setValue(b,"color.mode","primary")}function c(a){var b;a.getDimensions().length>1&&0!==(b=a.getSorting().indexOf(0))&&a.changeSorting(b,0)}function d(b,c){a.setValue(c,"color.dimensionId",void 0)}return{dimensions:{min:1,max:15,add:function(a,c,d){b(c,d)},move:function(a,d,e){c(e),b(d,e)},remove:function(a,c,e){d(a,c),b(c,e)},replace:function(b,c,d,e){a.getValue(e,"color.dimensionId")===c.qDef.cId&&a.setValue(e,"color.dimensionId",b.qDef.cId)}},measures:{min:1,max:1,add:function(a,c,d){b(c,d)},move:function(a,c,d){b(c,d)},remove:function(a,c,d){b(c,d)}}}}),define("extensions.qliktech/treemap/treemap",["jquery","./treemap-area","text!./treemap.ng.html","objects.views/charts/chart","objects.backend-api/stacked-api","objects.views/charts/disclaimers/chart-utils","extensions.qliktech/treemap/treemap-properties","extensions.qliktech/treemap/treemap-explore-properties","extensions.qliktech/treemap/treemap-data","objects.views/charts/components/chart-component","objects.views/charts/representation/combo-color-map","core.utils/deferred","objects.extension/object-conversion","objects.views/charts/utils/tree-node","touche"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){"use strict";function o(a){return a&&!(a.qHyperCube.qMeasureInfo.every(function(a){return a.qMax<=0&&a.qMax>=a.qMin})||0===a.qHyperCube.qSize.qcy)}function p(a){if(a&&a.length)for(var b=0;b<=a.length;)a[b]&&0===a[b].data.qMaxPos&&0===a[b].data.qMinNeg&&"N"===a[b].data.qType?(a.splice(b,1),b--):b++;if(1===a.length){if("undefined"===a||!a.length||"undefined"===a[0]._children||"_M"===a[0].data.qType)return}else if("undefined"===a||!a.length||"undefined"===a[0]||"undefined"===a[0]._children||0===a[0]._children.length||"undefined"===a[0]._children[0]||"undefined"===a[0].data||"undefined"===a[0]._children[0].data||"_M"===a[0].data.qType)return;for(var c=0;c<a.length;c++)p(1===a.length?a[0]._children:a[c]._children)}var q;return q=d.extend("Treemap",{init:function(c,d,e,f,g){this._data={},e=a.extend(!0,e||{},{debug:!0,providers:{colorMap:{clazz:k,multiDimScheme:"first"}},components:{dataArea:{clazz:b,show:!0,dock:"center",showFlag:j.prototype.ShowFlags.SPARK},colorLegend:{show:!0,dock:"right",relevantSize:126,label:"colorLegend",showFlag:j.prototype.ShowFlags.MEDIUM}}}),this._super(c,d,e,f,g)},off:function(){Touche(this.container).off("*",".treemap"),this._super()},initSelections:function(){this.selections._disableSelections=this.options._disableSelections,this.selections.types.dataArea.setComponent("dataArea",this.components.dataArea),this.selections.types.colorLegend.setComponent("colorLegend",this.components.colorLegend),this.options._disableSelections||(this.selections.Activated.bind(this.onSelection.Activated.bind(this)),this.selections.Deactivated.bind(this.onSelection.Deactivated.bind(this)),this.selections.Lasso.bind(this.onToggleLasso.bind(this)),this.selections.Select.bind(function(a){var b=this.components.dataArea.getSelectionIndices();this.selections.getActiveType().components.colorLegend&&(b=b.concat(this.components.colorLegend.getSelectionIndices())),this.selectionsCache.hasSelections()?this.onSelection.Select.apply(this,[a,!0,b,"L"]):a.length&&a.every(function(a){return!a.selected})&&this.selectionsApi.clear()}.bind(this)),this.selections.SelectRange.bind(this.onSelection.SelectRange.bind(this)),this.selections.SelectAttributeDim.bind(this.onSelection.SelectAttributeDim.bind(this)),this.selections.ToggleShape.bind(this.onSelection.ToggleShape.bind(this)),this.selections.Confirm.bind(this.onSelection.Confirm.bind(this)),this.selections.Cancel.bind(this.onSelection.Cancel.bind(this)),this.selections.SelectWhileLocked.bind(this.selectWhileLocked.bind(this)))},initTooltips:function(){this.tooltips.setComponent("dataArea",this.components.dataArea)},_updateSelectionCache:function(a){this._super(a),a=a||this.components.dataArea.getSelectableShapes();var b=[],c=this.providers.colorMap.getDimensionIndex()[0],d=this.providers.colorMap.getColorDataInfo().attrIndex>=0;if(c>0&&d)for(;c>0;){for(var e=0;e<a.length;e++)b=b.concat(a[e].children);a=b,c--}this.components.colorLegend.setSelectableShapes(a)},_paint:function(){var a=this;return this._super().then(function(b){if(!b||!b.invalid){a.layout();var c,d=[];for(c in a.components)d.push(a.components[c].invalidateDisplay("Treemap.paint"));return l.all(d)}})},isValid:function(a){return this._super(a)&&!this.supressChartRendering},prePaint:function(a){this._super(a),f.applyDisclaimerAttributes({title:!0,bottom:!0,overlay:!0,supportNegative:!1},this.$scope.dataAttributes,this.$element,this.$scope,a),this.supressChartRendering=this.$scope.dataAttributes.onlyNanData||this.$scope.dataAttributes.noDataExist||this.$scope.dataAttributes.onlyNegativeOrZero},_updateData:function(b){this._data=b,this._super(b),this.providers.colorMap.setData(b),this.components.dataArea.setData(b),this.components.colorLegend.setData(b),b.color&&"byMeasure"!==b.color.mode?this.selections&&this.selections.types.colorLegend.setComponent("colorLegend",this.components.colorLegend):this.selections&&this.selections.types.colorLegend.removeComponent("colorLegend",this.components.colorLegend);for(var c=a.extend(!0,{},this._chartContext.getDimensionTree()),d=new n;c._children&&c._children.length;)d._children.push(c._children.shift());p(d._children),this.providers.colorMap.setDimensionTree(d),this.components.dataArea.setDimensionTree(d),this.components.dataArea.cellPadding=2,this.components.dataArea.setPseudoDimPos(0)},toggleCacheItem:function(a){for(var b in this.components)this.components[b].toggleCacheItem?this.components[b].toggleCacheItem(a):this.components[b].invalidateDisplay("Treemap#toggleCacheItem")},getPreferredSize:function(){return this._super()}}),{type:"treemap",BackendApi:e,template:c,View:q,definition:g,softDefinition:h,initialProperties:{qHyperCubeDef:{qDimensions:[],qMeasures:[],qMode:"K",qNoOfLeftDims:-1,qSortbyYValue:-1,qIndentMode:!0,qShowTotalsAbove:!0,qMaxStackedCells:3e3,qAlwaysFullyExpanded:!0,qInitialDataFetch:[{qTop:0,qHeight:3e3,qLeft:0,qWidth:30}],qSuppressZero:!1,qSuppressMissing:!0}},data:i,support:{cssScaling:!1,snapshot:o,export:o,exportData:!0,sharing:o},options:{selections:{dataArea:{},colorLegend:{}},tooltips:{}},importProperties:m.colorChart.importProperties.bind(m),exportProperties:m.colorChart.exportProperties.bind(m)}}),define("objects.utils/font-manager",["core.utils/class"],function(a){function b(a,b,c){return a<b?0:a>c?1:(a-b)/(c-b)}return a.extend("FontManager",{init:function(){this._minFontSize=10,this._maxFontSize=20,this._minRectSize=100,this._maxRectSize=900,this._fontWeight="normal",this._fontFamily="QlikView Sans",this._fontSize=10},setFontWeight:function(a){this._fontWeight=a},setFontFamily:function(a){this._fontFamily=a},setRectLimits:function(a,b){this._minRectSize=a,this._maxRectSize=b},getFont:function(a,c){var d=Math.min(a.height,a.width),e=c&&c.minFontSize?c.minFontSize:this._minFontSize,f=c&&c.maxFontSize?c.maxFontSize:this._maxFontSize,g=b(d,this._minRectSize,this._maxRectSize);return this._fontSize=e+Math.round(g*(f-e)),this._fontWeight+" "+this._fontSize+"px "+this._fontFamily},getFontSize:function(a,c){var d=Math.min(a.height,a.width),e=c&&c.minFontSize?c.minFontSize:this._minFontSize,f=c&&c.maxFontSize?c.maxFontSize:this._maxFontSize,g=b(d,this._minRectSize,this._maxRectSize);return e+Math.round(g*(f-e))}})}),define("extensions.qliktech/gauge/gauge-helper",["core.utils/class","objects.views/charts/shapes/rect","objects.views/charts/shapes/line","objects.views/charts/shapes/arc","objects.views/charts/shapes/polygon","objects.views/charts/shapes/text","general.utils/color","objects.views/charts/components/axis/radial-axis-helper","objects.utils/font-manager","core.utils/feature-flags"],function(a,b,c,d,e,f,g,h,i,j){function k(a,b,c){return{x0:a.x0,y0:a.y0,x1:a.x1,y1:a.y1,limits:b,colors:c}}var l=[0,1],m=[0,.5,1];return a.extend("GaugeHelper",{init:function(){this._padding=0,this._colorWidth=50,this._maxWidth=50,this._labelPadding=10,this._fontManager=new i,this._fontManager.setRectLimits(100,1e3),this._bigValuesSettings={minFontSize:12,maxFontSize:60}},createBarSegments:function(a,c,d,e,f,h){if(!a||0===a.colors.length)return{shapes:[]};var i,j,n,o,p,q,r,s,t,u,v,w,x=[],y=a.colors,z=a.limits,A=this._colorWidth,B={},C=!1,D={value:0,gradient:!1},E=new g,F=h&&!d;for(f=Math.min(Math.max(f,0),1),z=z.map(function(a){return{value:(a.value-c.getPlotMin())/(c.getPlotMax()-c.getPlotMin()),gradient:a.gradient}}),i=0;i<y.length;i++)s=z[i]?z[i]:{value:1,gradient:!1},n=s.value,o=0===i?0:z[i-1].value,t=c.getPositionOfNormalizedValue(n),v=c.getPositionOfNormalizedValue(o),B.current=new g(y[i].color),B.next=new g(y[i+1]?y[i+1].color:y[i].color),u=(f-o)/(n-o),C=u>=0&&u<=1,d?(A=e.width<10?e.width:this._colorWidth,j=new b(this._relevantPos,t,A,v-t)):(A=this._colorWidth,j=new b(v,this._relevantPos,t-v,A)),w={x0:j.x,y0:j.y+(d?j.height:0),x1:j.x+(d?0:j.width),y1:j.y},D&&D.gradient&&!s.gradient?(B.last=g.getBlend(B.current,B.last,.5),p={gradient:k(w,l,F?[B.current.toRGBA(),B.last.toRGBA()]:[B.last.toRGBA(),B.current.toRGBA()])},q=B.last,r=B.current):s.gradient?(B.next=g.getBlend(B.current,B.next,.5),D.gradient?(B.last=g.getBlend(B.current,B.last,.5),p={gradient:k(w,m,F?[B.next.toRGBA(),B.current.toRGBA(),B.last.toRGBA()]:[B.last.toRGBA(),B.current.toRGBA(),B.next.toRGBA()])},u>.5?(u=(u-.5)/.5,q=B.last,r=B.current):(u/=.5,q=B.current,r=B.next)):(p={gradient:k(w,l,F?[B.next,B.current]:[B.current,B.next])},q=B.current,r=B.next)):p=B.current.toRGBA(),C&&(E=p.gradient?g.getBlend(q,r,u):B.current),j.opacity=1,j.fill=p,j.stroke=p,x.push(j),B.last=B.current,D=s;return{shapes:x,pointerBgColor:E}},createBarProgress:function(a,c,d,e,f){var h,i,j,k,l,m,n=[],o=new g(d),p=new g(this.style.area.color);return a=isNaN(a)?0:a>1?1:a<0?0:a,i=c.getPositionOfValue(c.getPlotMin()),j=c.getPositionOfValue(c.getPlotMax()),k=c.getPositionOfValue((c.getPlotMax()-c.getPlotMin())*a+c.getPlotMin()),this._labelPadding=this._colorWidth/2,l=this._colorWidth,m=this._relevantPos,h=e?new b(m,k,l,f.height):new b(i,m,k-i,l),h.opacity=1,h.fill=o.toHex(),h.stroke=o.createShiftedColor().toHex(),h.strokeWidth=1,n.push(h),h=e?new b(m,0,l,k):new b(k,m,j-k,l),h.opacity=1,h.fill=p.toHex(),h.stroke=p.createShiftedColor(.1).toHex(),h.strokeWidth=1,n.push(h),n},createGaugeMeterValue:function(a,b,c,d,e,g,h,i){var j=new f;return j.text=b,j.ColorWidth=200,j.font=h,j.opacity=1,j.fill=this.style.value.color,d?(a+g/2>e.height?(j.baseline="bottom",a=e.height):a<g/2?(j.baseline="top",a=0):j.baseline="middle",j.x=i?this._relevantPos-this._labelPadding:this._relevantPos+this._colorWidth+this._labelPadding,j.maxWidth=e.width-j.x,j.y=a,j.align=i?"right":"left"):(j.y=this._relevantPos+this._colorWidth+this._labelPadding+g,j.x=Math.max(Math.min(e.width-c/2,a),c/2),j.align="center",j.baseline="bottom"),j},createGaugeMeterPointer:function(a,b,d,f,g){var h,i=a>1?1:a<0?-1:0,j=[],k=this._relevantPos,l=Math.max(Math.round(this._colorWidth/25),2),m=k<50?10:this._colorWidth,n=Math.max(m,10)/6,o=f.isDark()?this.style.pointer.color.light:this.style.pointer.color.dark,p=new e,q=new c,r=!d&&g?1:-1;return q.opacity=1,q.stroke=o,q.strokeWidth=l,p.opacity=1,p.fill=o,p.strokeWidth=l,a=a>1?1:a<0?0:a,h=b.getPositionOfValue((b.getPlotMax()-b.getPlotMin())*a+b.getPlotMin()),d?(0!==i&&(p.set([{x:k+m/2,y:h},{x:k-n+m/2,y:i*n*2+h},{x:k+n+m/2,y:i*n*2+h}]),j.push(p)),q.set(k,h,k+m,h)):(0!==i&&(p.set([{y:k+m/2,x:h},{y:k-n+m/2,x:r*i*n*2+h},{y:k+n+m/2,x:r*i*n*2+h}]),j.push(p)),q.set(h,k,h,k+m)),j.push(q),j},updateLabelStyle:function(a,b,c,d,e){this._bigValuesSettings={minFontSize:this.style.value.minFontSize,maxFontSize:this.style.value.maxFontSize},j.THEMING?a.value.font="normal "+this._fontManager.getFontSize(b,this._bigValuesSettings)+"px 'QlikView Sans'":a.value.font=c.getFont(d,e,null,null,this._fontManager.getFontSize(b,this._bigValuesSettings))},createRadialSegments:function(a,b){if(!a||a.colors.length<1)return[];var c,e,f,h,i,j,n,o,p=[],q=a.limits,r=a.colors,s=this._colorWidth,t=r[0].color,u={value:0,gradient:!1},v=b.getAngleOfNormalizedValue(0),w=this._paddingToAxis;if(q=q.map(function(a){return{value:(a.value-b.getPlotMin())/(b.getPlotMax()-b.getPlotMin()),gradient:a.gradient}}),s=this._colorWidth*(b._relevantAngle>Math.PI?1:Math.sin(b._relevantAngle/4)),this._colorWidth=s,b._radius-s-w<0)return p;for(c=0;c<a.colors.length;c++)f=q[c]?q[c]:{value:1,gradient:!1},j=r[c+1]?r[c+1].color:r[c].color,e=r[c].color,i=b.getAngleOfNormalizedValue(f.value),h=new d(b._centerPoint.x,b._centerPoint.y,b._radius-s-w,b._radius-w,Math.min(v,i),Math.max(v,i),0),o={x0:h.x3,y0:h.y3,x1:h.x4,y1:h.y4},u&&u.gradient&&!f.gradient?(j=new g(e).blend(new g(t),.5),n={gradient:k(o,l,[j,e])}):f.gradient?(j=new g(e).blend(new g(j),.5),u.gradient?(t=new g(e).blend(new g(t),.5),n={gradient:k(o,m,[t,e,j])}):n={gradient:k(o,l,[e,j])}):n=e,h.opacity=1,h.fill=n,h.stroke=n,p.push(h),v=i,u=f,t=e;return p},createRadialGaugeMeter:function(a,b){var c,d,f,g=h.getAngleOfNormalizedValue(a,b),i=Math.max(this._colorWidth,10)/6,j=a>1?-1:1;return a>1||a<0?(d=this._colorWidth*(b._relevantAngle>Math.PI?1:Math.sin(b._relevantAngle/4)),this._colorWidth=d,c=-d*j/2,f=new e([{x:2*i+2,y:c},{x:2,y:i+c},{x:2,y:-i+c}])):f=new e([{x:.5*-i+4,y:0},{x:8*-i,y:i},{x:8*-i,y:-i}]),f.opacity=1,f.translate(b._centerPoint.x+Math.cos(g)*b._radius,b._centerPoint.y+Math.sin(g)*b._radius),f.rotate(g),(a>1||a<0)&&f.rotate(-j*Math.PI/2),f.fill=this.style.pointer.color.dark,f},createRadialProgress:function(a,b,c,f){var i,j,k,l,m=Math.min(c._radialOptions.start,c._radialOptions.end),n=isNaN(a)?m:h.getAngleOfNormalizedValue(a,c),o=Math.max(c._radialOptions.start,c._radialOptions.end),p=Math.min(f.width,f.height),q=[],r=(p>500?this._maxWidth:Math.max(p/500*this._maxWidth,10))/6,s=this._paddingToAxis,t=new g(this.style.area.color);return b=new g(b),j=this._colorWidth*(c._relevantAngle>Math.PI?1:Math.sin(c._relevantAngle/4)),this._colorWidth=j,c._radius-j-s<0?q:((a>1||a<0)&&(l=a>1?-1:1,k=-j*l/2,i=new e([{x:2*r+2,y:k},{x:2,y:r+k},{x:2,y:-r+k}]),i.opacity=1,i.translate(c._centerPoint.x+Math.cos(n)*c._radius,c._centerPoint.y+Math.sin(n)*c._radius),i.rotate(n-l*Math.PI/2),i.fill=b.toHex(),q.push(i)),m<n&&(i=new d(0,0,c._radius-j-s,c._radius-s,m,n,0),i.opacity=1,i.translate(c._centerPoint.x,c._centerPoint.y),i.fill=b.toHex(),i.stroke=b.createShiftedColor().toHex(),q.push(i)),o>n&&(i=new d(0,0,c._radius-j-s,c._radius-s,n,o,0),i.opacity=1,i.translate(c._centerPoint.x,c._centerPoint.y),i.fill=t.toHex(),i.stroke=t.createShiftedColor(.1).toHex(),q.push(i)),q)},createRadialGaugeValue:function(a,b,c,d,e,g){var h=new f;return h.text=b,h.x=d.width/2,h.y=.5*d.height-g/2+.05*Math.min(d.width,d.height),h.align="center",h.font=e,h.baseline="middle",h.maxWidth=1.4*c._radius,h.opacity=1,h.fill=this.style.value.color,[h]},createRadialSpark:function(a,b,c,d){var f,g,i=.4*Math.min(d.width,d.height),j=h.getAngleOfNormalizedValue(a,c)+Math.PI/2,k=0,l=new e;if(l.opacity=1,"string"!=typeof b)if(1===b.colors.length)l.fill=b.colors[0].color;else for(f=0;f<b.colors.length;f++){if(g=b.limits[f]?(b.limits[f].value-c.getPlotMin())/(c.getPlotMax()-c.getPlotMin()):1,a>=k&&a<g){l.fill=b.colors[f].color;break}k=g}else l.fill=b;return d.width<d.height?l.set([{x:0,y:-i},{x:-i/2,y:+i/2},{x:i/2,y:+i/2},{x:0,y:-i}]):l.set([{x:-i/2,y:i/2},{x:0,y:-i},{x:+i/2,y:i/2},{x:-i/2,y:i/2}]),l.translate(c._centerPoint.x,c._centerPoint.y),l.rotate(j),[l]},getGaugeWidth:function(a,b){var c;return a&&(c=b?"width":"height",this._colorWidth=a[c]>500?this._maxWidth:Math.max(a[c]/500*this._maxWidth,10)),this._colorWidth},updateSize:function(a,b,c){var d,e=Math.min(a.width,a.height);d=c?e:b?a.width:a.height,this._colorWidth=d>500?this._maxWidth:Math.max(d/500*this._maxWidth,10),this._relevantPos=(d-this._colorWidth)/2,this._paddingToAxis=Math.min(6,e/200)},getPaddingToAxis:function(){return this._paddingToAxis},getRelevantPos:function(){return this._relevantPos},getPadding:function(){return this._padding}})}),define("extensions.qliktech/gauge/gaugearea",["objects.views/charts/components/chart-component","objects.views/charts/renderers/canvas-renderer","objects.views/charts/chart-style-service","extensions.qliktech/gauge/gauge-helper","client.utils/theme/theme-module","general.utils/color","core.utils/deferred","core.utils/feature-flags"],function(a,b,c,d,e,f,g,h){"use strict";function i(a,b,c){return h.MASTER_MEASURE_COLOR&&b&&b.color&&a.color&&"measure"===a.color.useBaseColors?q.resolveColor(b):c}function j(a,c){if(!this._axis||!this._segmentInfo||void 0===this._axis.getPlotMin()||void 0===this._axis.getPlotMax())return g.resolve();var d,e=this._axis,h=this._style.value.font,i=e.isVertical(),j=b.getFontHeight(h),k=this.renderers.gauge.getTextWidth(a,h),l=this._axis.getPositionOfValue(c),m=(c-e.getPlotMin())/(e.getPlotMax()-e.getPlotMin()),n=[];return this._data.useSegments?(d=this._gaugeHelper.createBarSegments(this._segmentInfo,e,i,this.rect,m,this.yMirrorMode),n=d.shapes,n=n.concat(this._gaugeHelper.createGaugeMeterPointer(m,e,i,d.pointerBgColor,this.yMirrorMode))):(n=this._gaugeHelper.createBarProgress(m,e,this._progressColor,i,this.rect),(m>1||m<0)&&(n=n.concat(this._gaugeHelper.createGaugeMeterPointer(m,e,i,new f(m>1?this._progressColor:this._style.area.color),this.yMirrorMode)))),!isNaN(m)&&(i&&this.rect.width>100||!i&&this.rect.height>100)&&n.push(this._gaugeHelper.createGaugeMeterValue(l,a,k,i,this.rect,j,h,this.yMirrorMode)),this.renderers.gauge.stage.removeChildren(),this.renderers.gauge.stage.addChildren(n),this.renderers.gauge.render()}function k(a,c){if(!this._axis||!this._segmentInfo&&this._data.useSegments||this._axis._radius<=0)return g.resolve();var d=this._axis,e=this._style.value.font,f=b.getFontHeight(e),h=Math.min(this.rect.height,this.rect.width),i=(c-d.getPlotMin())/(d.getPlotMax()-d.getPlotMin()),j=[];return h<50?j=this._gaugeHelper.createRadialSpark(i,this._data.useSegments?this._segmentInfo:this._progressColor,d,this.rect):(this._data.useSegments?(j=this._gaugeHelper.createRadialSegments(this._segmentInfo,d),isNaN(i)||j.push(this._gaugeHelper.createRadialGaugeMeter(i,d))):j=this._gaugeHelper.createRadialProgress(i,this._progressColor,d,this.rect),j=j.concat(this._gaugeHelper.createRadialGaugeValue(c,a,d,this.rect,e,f))),this.renderers.gauge.stage.removeChildren(),this.renderers.gauge.stage.addChildren(j),this.renderers.gauge.render()}function l(a){return q.resolveColor(a)}function m(a,b){return a.paletteColors&&a.paletteColors[b]?q.resolveColor(a.paletteColors[b]):q.resolveColor(a.colors[b].color)}function n(a){return h.THEMING?{value:{color:a.getStyle("label.value","color"),font:"normal "+a.getStyle("label.value","fontSize")+" 'QlikView Sans'",minFontSize:12,maxFontSize:60},area:{color:"#eeeeee"},pointer:{color:{light:"#E6E6E6",dark:"#595959"}}}:{value:{color:a.getValue(p,"value","color"),font:a.getFont(p,"value"),minFontSize:a.getValue(p,"value","minFontSize"),maxFontSize:a.getValue(p,"value","maxFontSize")},area:{color:a.getValue(p,"area","backgroundColor")},pointer:{color:{light:a.getValue(p,"pointer","color","light"),dark:a.getValue(p,"pointer","color","dark")}}}}var o,p="gauge",q=e.get();return o=a.extend({init:function(){this._super.apply(this,arguments),this._gaugeHelper=new d,this._type="bar",this._currentProperties={},this._transitionProperties={},this._inTransition=!1,this._cacheItems=[],this.renderers={gauge:new b(this.container)},h.THEMING?this._styleService=q.initializeService("object.gauge"):this._styleService=c.getInstance()},_updateSize:function(){this.invalidateDisplay("Gauge._updateSize")},_updateProperties:function(){if(this._data){var a=this._data;this._segmentInfo={},a.segmentInfo&&a.segmentInfo.limits&&(this._segmentInfo.limits=a.segmentInfo.limits.concat().sort(function(a,b){return a.value-b.value})),a.segmentInfo&&a.segmentInfo.colors&&(this._segmentInfo.colors=a.segmentInfo.colors.map(function(b,c){return{color:m(a.segmentInfo,c)}})),this._progressColor=i(a,a.qHyperCube.qMeasureInfo[0].baseColor,l(this._data.paletteProgressColor||this._data.progressColor)),this._orientation=a.orientation,this._type=a.gaugetype,this._transitionProperties={value:a.qHyperCube.qDataPages[0].qMatrix[0][0].qNum,text:a.qHyperCube.qDataPages[0].qMatrix[0][0].qText},this._super()}},hasValidData:function(){return this._super()&&this._data},setAxis:function(a){this._axis=a,this._axis.listen("changed",function(){this.invalidateDisplay()},this)},setRefLines:function(a){this._refLines=a},setRefLineLabels:function(a){this._refLineLabels=a},setColorMap:function(a){this._colorMap=a},getColorMap:function(){return this._colorMap},paint:function(){if(!this._axis)return g.resolve();this._style=n(this._styleService),this._gaugeHelper.style=this._style;var a=[];this._gaugeHelper.updateSize(this.rect,this._axis.isVertical(),this._axis.isRadial()),this._refLines&&(this._refLines.setPaddingToAxis(this._gaugeHelper.getPaddingToAxis()),this._refLines.setRelevantPos(this._gaugeHelper.getRelevantPos())),this._refLineLabels&&(this._refLineLabels.setPaddingToAxis(this._gaugeHelper.getPaddingToAxis()),this._refLineLabels.setRelevantPos(this._gaugeHelper.getRelevantPos())),this._gaugeHelper.updateLabelStyle(this._style,this.rect,this._styleService,p,"value");var b=this._data.qHyperCube.qDataPages[0].qMatrix[0][0],c=this.measureFormatters[0],d="U"!==c.type?b.qText:c.formatValue(b.qNum),e=this._currentProperties.value;return this._inTransition&&(d=c.format(e)),this._axis.isRadial()?a.push(k.apply(this,[d,e])):a.push(j.apply(this,[d,e])),this._currentValue=e,this._refLines&&this._refLineLabels&&(this._refLines.setGaugeWidth(this._gaugeHelper.getGaugeWidth()),this._refLineLabels.setGaugeWidth(this._gaugeHelper.getGaugeWidth())),g.all(a)},afterPaint:function(){},clear:function(){},getGaugeWidth:function(a,b){return this._gaugeHelper.getGaugeWidth(a,b)}}),Object.defineProperty(o.prototype,"className",{value:"GaugeArea"}),o}),define("extensions.qliktech/gauge/gauge-ref-lines",["objects.views/charts/components/ref-lines","client.utils/theme/theme-module"],function(a,b){"use strict";function c(a){return d.resolveColor(a)}var d=b.get();return a.extend("GaugeRefLines",{namespace:".gaugereflines",init:function(){this._super.apply(this,arguments),this._width=50},paint:function(){if(this._super.apply(this,[].slice.call(arguments)),this._hasVisibleRefLines){var a,b,d,e,f,g,h,i,j,k,l,m,n,o,p,q=[],r=this._paddingToAxis,s=this._relevantPos;for(a=0;a<this._numRefLinesDataAxes;a+=1)for(d=this._data[a],e=this._axes[a],f=this._axisPlotMinValues[a],g=this._axisPlotMaxValues[a],b=0;b<d.length;b+=1)d[b].show&&void 0!==d[b].refLineExpr&&((h=this._currentProperties["value"+a+b])>g||h<f||(e.isRadial()?(o=e._radius,p=e.getAngleOfValue(h),j=e._centerPoint.x+Math.cos(p)*(o-r),k=e._centerPoint.y+Math.sin(p)*(o-r),l=e._centerPoint.x+Math.cos(p)*(o-r-this._width),m=e._centerPoint.y+Math.sin(p)*(o-r-this._width)):(i=e.getPositionOfValue(h),i=Math.floor(i)-.5,e.isVertical()?(j=s,k=i,l=s+this._width,m=i):(j=i,k=s,l=i,m=s+this._width)),n=void 0!==d[b].color?c(d[b].color):"#000000",q.push({type:"line",stroke:n,strokeWidth:1,shape:{x1:j,y1:k,x2:l,y2:m}})));this.renderer.shapes=q,this.renderer.render()}},setGaugeWidth:function(a){this._width=a,this.updateSize(),this.invalidateDisplay()},setPaddingToAxis:function(a){this._paddingToAxis=a},setRelevantPos:function(a){this._relevantPos=a}})}),define("extensions.qliktech/gauge/gauge-ref-line-labels",["objects.views/charts/components/ref-line-labels","objects.views/charts/shapes/text","client.utils/theme/theme-module"],function(a,b,c){"use strict";function d(a){return String(void 0!==a.label?a.label:a)}function e(a){return f.resolveColor(a)}var f=c.get();return a.extend("GaugeRefLineLabels",{init:function(){this._super.apply(this,arguments)},paint:function(){if(!this._axis)return void this._clearLabels();if(this._axis.updateNow(["properties"]),this._plotMinValue===this._axis.getPlotMin()&&this._plotMaxValue===this._axis.getPlotMax()||(this._hasVisibleRefLines=this.checkIfHavingVisibleRefLines(),this.updateLocalPlotMaxMinValues.call(this)),!this._hasVisibleRefLines)return void this._clearLabels();var a,c,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v="bottom",w=this._relevantPos,x=[],y=[],z=this._axis;for(a=0;a<this._data.length;a+=1)this._data[a].show&&void 0!==this._data[a].refLineExpr&&(c=this._currentProperties["value"+a],f=d(this._data[a].refLineExpr),void 0===c||isNaN(c)||c<this._axis.getPlotMin()||c>this._axis.getPlotMax()||(q=new b,q.font=this._style.label.font,q.maxWidth=this._labelMaxWidthForYAxis,q.maxNumLines=3,m=f,l=m.replace(/[0-9]|\.|\-|\+|e/g,""),l=l.length?m:z.format(c),j=this._data[a].label+" ("+l+")",k=void 0!==this._data[a].color?e(this._data[a].color):"#000000",q.setText(j),q.ellipsis="… ("+l+")",s=q.measure(),z.isRadial()?(o=z._radius,p=z.getAngleOfValue(c),h=z._centerPoint.x+Math.cos(p)*o,i=z._centerPoint.y+Math.sin(p)*o,n=p>Math.PI/2&&p<3*Math.PI/2?"right":"left",v=p>Math.PI&&p<2*Math.PI?"bottom":"top",r=s.width,h-r<0?(q.maxWidth+=h-r,h=q.maxWidth):h+r>this.rect.width&&(q.maxWidth=r+(this.rect.width-(h+r)))):(g=z.getPositionOfValue(c),g=Math.floor(g)-.5,u=s.height/2,z.isVertical()?(n=this.yMirrorMode?"right":"left",v="middle",h=this.yMirrorMode?w-4:w+this._width+4,i=g<u?g+(u-g+4):g>this.rect.height-u?g-(g-(this.rect.height-u-4)):g):(n="center",i=w+this._width,v="top",t=s.width/2,h=g<t?g+(t-g+4):g>this.rect.width-t?g-(g-(this.rect.width-t-4)):g)),q.x=h,q.y=i,q.align=n,q.baseline=v,q.fill=k,y.push(q),x.push({position:g,shapeWrapper:q,tooltipRows:[{label:this._data[a].label,value:l}]})));if(0===(x?x.length:0))return void this._clearLabels();this.renderer.stage.removeChildren(),this.renderer.stage.addChildren(y),this.renderer.render(),this._tooltips.setLabelObjects(x)},setGaugeWidth:function(a){this._width=a,this.invalidateDisplay()},setPaddingToAxis:function(a){this._paddingToAxis=a},setRelevantPos:function(a){this._relevantPos=a}})}),define("text!extensions.qliktech/gauge/gauge.ng.html",[],function(){return'<div class="qv-viz"></div>\n<div qva-popup-disclaimer ng-if="!!dataAttributes.popupDisclaimer.show" pop-close="dataAttributes.popupDisclaimer.onPopClose" pop-message="dataAttributes.popupDisclaimer.message" pop-title="dataAttributes.popupDisclaimer.title" />\n'}),define("extensions.qliktech/gauge/gauge-properties",["translator","core.utils/feature-flags","client.utils/theme/theme-module","client.utils/property-resolver","client.utils/default-property-logic"],function(a,b,c,d,e){var f,g,h,i=c.get(),j=e.getLogicFor("hard","default");return f={uses:"data",items:{measures:{disabledRef:""},dimensions:{disabledRef:""}}},g={type:"items",uses:"settings",component:"expandable-items",translation:"Common.Appearance",items:{presentation:{type:"items",grouped:!0,translation:"properties.presentation",items:{rangeLimits:{type:"items",items:{text:{component:"text",translation:"properties.axis.rangeLimits",style:"sHeader"},min:{ref:"measureAxis.min",translation:"properties.axis.min",type:"number",expression:"optional",invalid:function(a){return a.measureAxis&&a.measureAxis.min>=a.measureAxis.max},change:function(a){d.setValue(a,"disclaimerClosed",!0)}},max:{ref:"measureAxis.max",translation:"Common.Max",type:"number",expression:"optional",defaultValue:100,invalid:function(a){return a.measureAxis&&a.measureAxis.min>=a.measureAxis.max},change:function(a){d.setValue(a,"disclaimerClosed",!0)}}}},type:{ref:"gaugetype",type:"string",component:"item-selection-list",defaultValue:"radial",horizontal:!0,items:[{icon:"¬",component:"icon-item",labelPlacement:"bottom",translation:"properties.gauge.radial",value:"radial"},{icon:"¡",component:"icon-item",labelPlacement:"bottom",translation:"properties.gauge.bar",value:"bar"}],change:function(a){"radial"===a.gaugetype?(h=a.orientation,a.orientation="horizontal"):a.orientation=h}},autoOrientation:{ref:"autoOrientation",translation:"properties.orientation",type:"boolean",defaultValue:!0,component:"switch",undefinedValue:!1,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}],show:function(a){return"bar"===a.gaugetype}},orientation:{ref:"orientation",type:"string",component:"item-selection-list",defaultValue:"horizontal",horizontal:!0,items:[{component:"icon-item",icon:"ƒ",labelPlacement:"bottom",translation:"properties.orientation.vertical",value:"vertical"},{icon:"√",component:"icon-item",labelPlacement:"bottom",translation:"Common.Horizontal",value:"horizontal"}],show:function(a){return"bar"===a.gaugetype&&!a.autoOrientation}},angle:{ref:"angle",translation:"properties.gauge.angle",type:"number",component:"slider",min:.2,max:.98,step:.1,defaultValue:.7,show:function(){return!1}},segments:{type:"items",items:{useSegments:{ref:"useSegments",type:"boolean",defaultValue:!1,translation:"properties.gauge.useSegments",change:function(a){a.useSegments&&1===a.segmentInfo.colors.length?(a.segmentInfo.colors=[{color:a.progressColor}],a.segmentInfo.paletteColors=[a.paletteProgressColor]):(a.progressColor=a.segmentInfo.colors[0].color,a.paletteProgressColor=a.segmentInfo.paletteColors[0])}},useBaseColor:{ref:"color.useBaseColors",type:"string",defaultValue:"measure",translation:"properties.useLibraryMeasureColors",component:"switch",show:function(a,c){return b.MASTER_MEASURE_COLOR&&c.layout.qHyperCube.qMeasureInfo.length&&c.layout.qHyperCube.qMeasureInfo[0].baseColor&&c.layout.qHyperCube.qMeasureInfo[0].baseColor.color&&!a.useSegments},globalChange:function(a){b.MASTER_MEASURE_COLOR&&d.getValue(a,"useSegments")&&d.setValue(a,"color.useBaseColors","off")},options:[{value:"off",translation:"properties.off"},{value:"measure",translation:"properties.on"}]},progressColor:{component:"color-picker",translation:"properties.color",ref:"progressColor",type:"integer",defaultValue:3,show:function(){return!1}},paletteProgressColor:{component:"color-picker",translation:"properties.color",ref:"paletteProgressColor",type:"object",dualOutput:!0,defaultValue:j.color.paletteColor.defaultValue,show:function(a,c){if(!d.getValue(a,"paletteProgressColor")){var e=i.resolveColor(d.getValue(a,"progressColor")),f={index:-1,color:e};d.setValue(a,"paletteProgressColor",f)}return b.MASTER_MEASURE_COLOR?!(a.useSegments||"measure"===d.getValue(a,"color.useBaseColors")&&c.layout.qHyperCube.qMeasureInfo.length&&c.layout.qHyperCube.qMeasureInfo[0].baseColor&&c.layout.qHyperCube.qMeasureInfo[0].baseColor.color):!a.useSegments},change:function(a){var b=d.getValue(a,"paletteProgressColor");d.setValue(a,"progressColor",i.mapIndex(b.index,!0))}},valueMode:{ref:"valueMode",translation:"properties.value",type:"string",component:"dropdown",options:[{value:"absolute",translation:"properties.gauge.absolute"},{value:"relative",translation:"properties.gauge.relative"}],show:function(){return!1},defaultValue:"absolute"},maxSegments:{ref:"maxSegments",type:"number",defaultValue:6,show:!1},segmentInfo:{ref:"segments",type:"items",component:"color-scale-creator",show:function(a){return a.useSegments},items:{limits:{ref:"segmentInfo.limits",type:"array",items:{value:{ref:"value",type:"number",expression:"optional",
invalid:function(a,b){return"number"==typeof a.value&&(a.value<b.measureAxis.min||a.value>b.measureAxis.max)},defaultValue:1},gradient:{translation:"properties.gradient",ref:"gradient",type:"boolean",show:!1}}},colors:{items:{color:{ref:"color",type:"integer",defaultValue:3}},type:"array",ref:"segmentInfo.colors"},paletteColors:{items:{color:{ref:"color",type:"string"},index:{ref:"index",type:"integer",defaultValue:6}},type:"array",ref:"segmentInfo.paletteColors"}}}}},disclaimerClosed:{ref:"disclaimerClosed",type:"boolean",defaultValue:!1,show:!1}}},measureAxis:{type:"items",label:function(b,c){var d=c.getMeasureLayouts()[0];return d?a.get("properties.measureAxisWithInfo",[d.qFallbackTitle]):a.get("properties.measureAxis")},grouped:!0,items:{axis:{type:"items",snapshot:{title:"properties.measureAxis",tid:"property-yAxis"},items:{show:{ref:"measureAxis.show",translation:"properties.axis.labelsAndTitle",type:"string",component:"dropdown",options:[{value:"all",translation:"properties.axis.show.all"},{value:"labels",translation:"properties.axis.show.labels"},{value:"title",translation:"properties.axis.show.title"},{value:"none",translation:"Common.None"}],defaultValue:"all"},spacing:{ref:"measureAxis.spacing",translation:"properties.axis.scale",type:"number",component:"dropdown",defaultValue:1,show:function(a){return a.measureAxis&&"none"!==a.measureAxis.show&&"title"!==a.measureAxis.show},options:[{value:2,translation:"properties.gridLine.wide"},{value:1,translation:"properties.gridLine.medium"},{value:.5,translation:"properties.gridLine.narrow"}]}}}}}}},{type:"items",component:"accordion",items:{data:f,addons:{type:"items",component:"expandable-items",translation:"properties.addons",items:{dataHandling:{uses:"dataHandling",items:{suppressZero:null}},refLines:{uses:"reflines"}}},settings:g}}}),define("text!extensions.qliktech/gauge/popup-disclaimer.ng.html",[],function(){return'<div class="qv-popup-disclaimer">\n\t<div class="icon-close-button" qva-activate="onClose()"></div>\n\t<header class="dm-header">{{popTitle}}</header>\n\t<main class="dm-main">\n\t\t<p class="dm-p">{{popMessage}}</p>\n\t</main>\n</div>'}),define("extensions.qliktech/gauge/popup-disclaimer",["assets/qvangular/qvangular-core","text!extensions.qliktech/gauge/popup-disclaimer.ng.html"],function(a,b){a.directive("qvaPopupDisclaimer",function(){return{template:b,replace:!0,scope:{popMessage:"=",popTitle:"=",popClose:"="},link:function(a){a.onClose=function(){a.popClose()}}}})}),define("extensions.qliktech/gauge/gauge",["jquery","translator","objects.views/charts/chart","core.utils/deferred","extensions.qliktech/gauge/gaugearea","extensions.qliktech/gauge/gauge-ref-lines","extensions.qliktech/gauge/gauge-ref-line-labels","objects.views/charts/components/chart-component","objects.views/charts/components/axis/continuous-axis","objects.backend-api/hypercube-api","text!./gauge.ng.html","extensions.qliktech/gauge/gauge-properties","objects.extension/object-conversion","extensions.qliktech/gauge/popup-disclaimer"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";function n(){var a,b,c;a=-Math.PI*(this._data.angle+.5),b=Math.PI*(this._data.angle-.5),b+=a<0?2*Math.PI:0,a+=a<0?2*Math.PI:0,c=this.yMirrorMode&&"radial"!==this._type,this.components.axis.setRadial("radial"===this._type,c?{start:b,end:a}:{start:a,end:b})}function o(){var b=this.components.dataArea,c=b.rect,d=a.extend({},c),e=this.components.axis,f=e.relevantSize,g=b.getGaugeWidth(b.rect,"vertical"===this._orientation)/2;e.setAlignment("near"),"vertical"===this._orientation?(this.yMirrorMode?(d.x=c.width/2+g,e.setAlignment("far")):d.x=c.width/2-g-f,d.x<0?(d.width=f+d.x,d.x=0):d.width=f):(d.y=c.height/2-g-f,d.y<0?(d.height=f+d.y,d.y=0):d.height=f),(c.width<80||c.height<80)&&(d["vertical"===this._orientation?"width":"height"]=0),e.rect=d}var p;return p=c.extend("Gauge",{namespace:".gauge",init:function(c,d,j,k){var l=this;j=a.extend(!0,j||{},{providers:{},components:{axis:{show:!0,order:0,dock:"center",showFlag:h.prototype.ShowFlags.SPARK,clazz:i},dataArea:{show:!0,order:1,dock:"center",clazz:e,showFlag:h.prototype.ShowFlags.SPARK},gaugeRefLines:{sortKey:5,show:!0,dock:"center",showFlag:h.prototype.ShowFlags.XSMALL},gaugeRefLineLabels:{show:!0,dock:"center",order:3,showFlag:h.prototype.ShowFlags.XSMALL}}}),this._type="vertical",this._orientation="horizontal",this._super(c,d,j,k),this.components.dataArea.setAxis(this.components.axis),this.components.axis.setAlignment("near"),this.components.axis.setDataRangeTransition(!0),this.components.axis.setShowLine(!1),this.components.gaugeRefLines=new f(this.container),this.components.gaugeRefLines.showFlag=h.prototype.ShowFlags.XSMALL,this.components.gaugeRefLines.setUseTransition(!0),this.components.dataArea.setRefLines(this.components.gaugeRefLines),this.layoutEngine.addComponent(this.components.gaugeRefLines),this.components.gaugeRefLineLabels=new g(this.container),this.components.gaugeRefLineLabels.showFlag=h.prototype.ShowFlags.SMALL,this.components.gaugeRefLineLabels.setUseTransition(!0),this.components.dataArea.setRefLineLabels(this.components.gaugeRefLineLabels),this.layoutEngine.addComponent(this.components.gaugeRefLineLabels),this.$scope.dataAttributes.popupDisclaimer={show:!1,message:b.get("Object.Gauge.RangeIsDefault"),title:b.get("Object.Gauge.RangeIsDefaultTitle"),onPopClose:function(){l.$scope.backendApi.model.getProperties().then(function(a){a.disclaimerClosed=!0,l.$scope.backendApi.model.setProperties(a)})}}},_updateData:function(a){if(this._type=a.gaugetype,this._orientation=a.autoOrientation&&"bar"===a.gaugetype?this.components.dataArea.rect.height>this.components.dataArea.rect.width?"vertical":"horizontal":a.orientation,a.refLine){var b={axes:{axis:{component:this.components.axis,data:a.axis,dataIndices:a.qHyperCube.qMeasureInfo.map(function(a,b){return b})}},refLineLabels:{labels:{data:a.refLine.refLines,component:this.components.gaugeRefLineLabels,axis:this.components.axis}},refLines:{component:this.components.gaugeRefLines}};this._super(a,b),this.components.dataArea.setData(a),this.updateAxis(a,this.options),this.updateRefLines(a,b)}else this.components.dataArea.setData(a),this.updateAxis(a,this.options),this._super(a)},updateRefLines:function(a,b){var c,d=b.refLineLabels,e=[],f=[];for(c in d)d[c].component&&(d[c].component.setData(d[c].data),d[c].component.setAxis(d[c].axis),d[c].component.setDock(d[c].axis.getOppositeDock()),f.push(d[c].axis),e.push(d[c].data));b.refLines&&b.refLines.component&&(b.refLines.component.setAxes([b.axes.axis.component]),b.refLines.component.setData([a.refLine.refLines]))},isValid:function(a){var b,c=this.isDataValid(a);for(b in this.components)this.components[b].setHasValidData(c);return c},isDataValid:function(a){return!!a&&!!a.qHyperCube&&a.qHyperCube.qMeasureInfo.length&&!a.qHyperCube.qMeasureInfo.some(function(a){return!!a.qError})},updateAxis:function(a){var b,c,d,e,f=a.measureAxis,g=this.components.axis;b=Math.min.apply(this,a.qHyperCube.qMeasureInfo.filter(function(a){return!isNaN(a.qMin)}).map(function(a){return a.qMin})),c=Math.max.apply(this,a.qHyperCube.qMeasureInfo.filter(function(a){return!isNaN(a.qMax)}).map(function(a){return a.qMax})),d=a.qHyperCube.qMeasureInfo.map(function(a){return a.qFallbackTitle}).join(", "),g.setData(a),g.setTitle(d),g.setShowStrategy(f.show),g.setLabelMode(f.label),g.setOrientation("bar"===this._type?this._orientation:"horizontal"),g.setPlotMin&&(e=this.getAxisOptions(f),g.setPlotMin(e.min),g.setPlotMax(e.max),g.setTickMultiplier(f.spacing),g.setLogScale(f.logarithmic)),b===c&&0===c&&(c=1,b=0),c=Math.max(0,c),b=Math.min(0,b),this.setAxisDataRange(g,c,b,e.max,e.min,1),n.call(this)},getAxisOptions:function(a){if(a)return{min:Number(a.min),max:Number(a.max)}},setAxisDataRange:function(a,b,c,d,e,f){null!==d&&null!==e||null===d&&null===e?a.setDataRange(c,b):null!==d&&d<=c?a.setDataRange(d-f,b):null!==e&&e>=b?a.setDataRange(c,e+f):a.setDataRange(c,b)},_paint:function(){var a,b=[];if(!this.isValid(this._data))return this.clear();if(this._super(),n.call(this),this.layout(),this.$scope.dataAttributes.popupDisclaimer){var c=this._data.disclaimerClosed||this._data.maxMinChanged;!this.inEditState()||this._layoutMode<7||c?this.$scope.dataAttributes.popupDisclaimer.show=!1:this.$scope.dataAttributes.popupDisclaimer.show=!0}for(a in this.components)b.push(this.components[a].invalidateDisplay());return d.all(b)},layout:function(){var a=this.components.axis,b=a.updateSize;a.updateSize=function(){},this.layoutEngine.layout(this.rect,this._layoutMode,this.containerRect),a.updateSize=b,this._data&&this._data.autoOrientation&&"bar"===this._data.gaugetype&&(this._orientation=this.components.dataArea.rect.height>this.components.dataArea.rect.width?"vertical":"horizontal",this.components.axis.setOrientation(this._orientation)),a.preRelevantSizeCalculation(),a.calculatePreliminaryRelevantSize(this.components.dataArea.rect,this.components.dataArea.rect),a.calculateRelevantSize(this.components.dataArea.rect,this.components.dataArea.rect),this.components.axis.isRadial()||o.call(this),a.updateSize()},getPreferredSize:function(){return this._super()}}),{type:"gauge",BackendApi:j,template:k,View:p,definition:l,initialProperties:{qHyperCubeDef:{qDimensions:[],qMeasures:[],qInitialDataFetch:[{qWidth:1,qHeight:1}],qSuppressMissing:!0},segmentInfo:{limits:[],colors:[{color:3}]}},data:{measures:{min:1,max:1}},support:{cssScaling:!1,snapshot:!0,export:!0,exportData:!0,sharing:!0},getDropFieldOptions:function(a,b,c,d,e){a.AddFieldAsMeasure(c,b,e),d()},getDropDimensionOptions:function(a,b,c,d){d()},importProperties:m.axisChart.importProperties.bind(m),exportProperties:m.axisChart.exportProperties.bind(m)}}),define("text!extensions.qliktech/kpi/kpi.ng.html",[],function(){return'<div class="qv-viz" ng-class="{link : linkInteractionOn}">\n\t<div class="kpi-data" qva-activate="onShowVerifyDialog()">\n\t\t<div ng-show="baseLayoutInfo.components[0].show" class="measure-wrapper" ng-class="textAlign" ng-style="measureTitleStyle">\n\t\t\t<div class="measure-title ellips-text" title="{{measureTitle}}">\n\t\t\t\t<span ng-bind="measureTitle"></span>\n\t\t\t\t<i class="info-icon  lui-icon  lui-icon--link" ng-if="linkInteractionOn" title="{{sheetLinkTitle}}"></i>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="value-wrapper" ng-class="textAlign">\n\t\t\t<div class="ellips-text" ng-class="{ \'no-shrink\' : secondaryValues.length && baseLayoutInfo.components[1].components[1].components[0].show}">\n\t\t\t\t<qv-kpi-value value="mainValue.value" formatted-value="mainValue.formattedValue" value-style="mainValue.style" formatter="mainValue.formatter" glyph="mainValue.glyph" show-glyph="mainValue.showGlyph" />\n\t\t\t</div>\n\t\t\t<div ng-show="baseLayoutInfo.components[1].components[1].components[0].show" class="secondary-wrapper ellips-text" ng-repeat="secondaryValue in secondaryValues">\n\t\t\t\t<qv-kpi-value value="secondaryValue.value" formatted-value="secondaryValue.formattedValue" value-style="secondaryValue.style" title-style="secondaryValue.titleStyle" formatter="secondaryValue.formatter" glyph="secondaryValue.glyph" show-glyph="secondaryValue.showGlyph" measure-title="secondaryValue.measureTitle" />\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<!--\n\t<div ng-show="useViz" class="visualization">\n\t\t<qv-object class="cell-content" model="viz.model" options="viz.options"></qv-object>\n\t</div>\n\t-->\n\t<div class="click-again-overlay" ng-class="{show : showVerifyDialog}" ng-style="verifyDialogStyle" qva-activate="linkToSheet()">\n\t\t<span ng-if="!sheetIsMissing" q-translation="properties.kpi.verifyToGoSheet"></span>\n\t\t<span class="sheetLinkTitle ellips-text" ng-bind="sheetLinkTitle"></span>\n\t</div>\n\n</div>\n'}),define("extensions.qliktech/kpi/kpi-properties",["core.utils/feature-flags","client.utils/theme/theme-module","client.utils/property-resolver","client.utils/default-property-logic"],function(a,b,c,d){function e(a){return a.layout.qHyperCube.qMeasureInfo.filter(function(a){return!(!a.baseColor||!a.baseColor.color)}).length>0}var f,g,h=b.get(),i=d.getLogicFor("hard","default");return f={uses:"data",addTranslation:"Properties.AddData",items:{measures:{disabledRef:"",items:{measureAxisMin:{type:"items",ref:"qDef.measureAxis.min",defaultValue:0},measureAxisMax:{type:"items",ref:"qDef.measureAxis.max",defaultValue:100},conditionalColoringUseConditionalColoring:{type:"items",ref:"qDef.conditionalColoring.useConditionalColoring",defaultValue:!1},conditionalColoringUseSingleColor:{type:"items",ref:"qDef.conditionalColoring.singleColor",defaultValue:3},conditionalColoringPaletteSingleColor:{type:"items",ref:"qDef.conditionalColoring.paletteSingleColor",defaultValue:i.color.paletteColor.defaultValue},limits:{type:"items",ref:"qDef.conditionalColoring.segments.limits",defaultValue:[]},colors:{type:"items",ref:"qDef.conditionalColoring.segments.colors",defaultValue:[{color:2}]},paletteColors:{type:"items",ref:"qDef.conditionalColoring.segments.paletteColors",defaultValue:[{index:6}]}}}}},g={type:"items",uses:"settings",component:"expandable-items",translation:"Common.Appearance",items:{presentation:{type:"items",grouped:!1,translation:"properties.presentation",items:{showMeasureTitle:{ref:"showMeasureTitle",component:"checkbox",translation:"properties.ShowTitle",defaultValue:!0},textAlign:{ref:"textAlign",type:"string",component:"dropdown",translation:"properties.Alignment",options:[{value:"left",translation:"properties.dock.left"},{value:"center",translation:"Common.Center"},{value:"right",translation:"properties.dock.right"}],defaultValue:"center"},fontSize:{ref:"fontSize",type:"string",component:"dropdown",translation:"MediaTool.Toolbar.FontSize",options:[{value:"S",translation:"Common.Small"},{value:"M",translation:"Common.Medium"},{value:"L",translation:"Common.Large"}],defaultValue:"M"},linkToSheet:{type:"items",items:{useLink:{ref:"useLink",type:"boolean",component:"switch",translation:"properties.kpi.linkToSheet",defaultValue:!1,options:[{value:!0,translation:"properties.on"},{value:!1,translation:"properties.off"}]},kpiLink:{ref:"sheetLink",type:"string",component:"sheet-dropdown",show:function(a){return a.useLink}},openUrlInNewTab:{ref:"openUrlInNewTab",type:"boolean",component:"switch",translation:"properties.kpi.openUrlInNewTab",defaultValue:!0,options:[{value:!0,translation:"properties.on"},{value:!1,translation:"properties.off"}],show:function(a){return a.useLink}}}}}},color:{type:"items",grouped:!1,translation:"properties.color",items:{useBaseColor:{ref:"color.useBaseColors",type:"string",defaultValue:"measure",translation:"properties.useLibraryMeasureColors",component:"switch",show:function(b,c){return a.MASTER_MEASURE_COLOR&&e(c)},options:[{value:"off",translation:"properties.off"},{value:"measure",translation:"properties.on"}]},conditionalColoring:{type:"array",component:"measures-tab",ref:"qHyperCubeDef.qMeasures",show:function(b,c){return!a.MASTER_MEASURE_COLOR||(!e(c)||b.color&&"measure"!==b.color.useBaseColors)},items:{useConditionalColoring:{ref:"qDef.conditionalColoring.useConditionalColoring",component:"switch",type:"boolean",options:[{value:!0,translation:"properties.on"},{value:!1,translation:"properties.off"}],translation:"properties.kpi.conditionalColoring",defaultValue:!1,change:function(a){a.qDef.conditionalColoring&&a.qDef.conditionalColoring.useConditionalColoring&&1===a.qDef.conditionalColoring.segments.colors.length?a.qDef.conditionalColoring.segments.colors[0].color=a.qDef.conditionalColoring.singleColor:a.qDef.conditionalColoring.singleColor=a.qDef.conditionalColoring.segments.colors[0].color}},singleColorColoring:{component:"color-picker",translation:"properties.color",ref:"qDef.conditionalColoring.singleColor",type:"integer",defaultValue:3,show:function(){return!1}},paletteSingleColor:{component:"color-picker",translation:"properties.color",ref:"qDef.conditionalColoring.paletteSingleColor",type:"object",dualOutput:!0,defaultValue:i.color.paletteColor.defaultValue,show:function(a){if(!c.getValue(a,"qDef.conditionalColoring.paletteSingleColor")){var b=h.resolveColor(c.getValue(a,"qDef.conditionalColoring.singleColor")),d={index:-1,color:b};c.setValue(a,"qDef.conditionalColoring.paletteSingleColor",d)}return a.qDef.conditionalColoring&&!a.qDef.conditionalColoring.useConditionalColoring},change:function(a){var b=c.getValue(a,"qDef.conditionalColoring.paletteSingleColor");c.setValue(a,"qDef.conditionalColoring.singleColor",h.mapIndex(b.index,!0))}},rangeLimits:{type:"items",items:{min:{ref:"qDef.measureAxis.min",translation:"properties.axis.min",type:"number"},max:{ref:"qDef.measureAxis.max",translation:"Common.Max",type:"number",defaultValue:100}},show:function(){return!1}},segmentInfo:{ref:"qDef.conditionalColoring.segments",type:"items",component:"color-scale-creator",conditionalColoringRef:{props:"qHyperCubeDef.qMeasures",layout:"qHyperCube.qMeasureInfo"},useGlyph:!0,useAutoMinMax:!0,show:function(a){return a.qDef.conditionalColoring.useConditionalColoring},items:{limits:{ref:"qDef.conditionalColoring.segments.limits",type:"array",items:{value:{ref:"value",type:"number",expression:"optional",invalid:function(a){return isNaN(a.value)},defaultValue:1},gradient:{translation:"properties.gradient",ref:"gradient",type:"boolean",show:!1}}},colors:{type:"array",ref:"qDef.conditionalColoring.segments.colors",defaultValue:[{color:2}],items:{color:{ref:"color",type:"integer"},icon:{ref:"icon",type:"string",defaultValue:""}}},paletteColors:{type:"array",ref:"qDef.conditionalColoring.segments.paletteColors",defaultValue:[{index:6}],items:{color:{ref:"color",type:"string",defaultValue:""},index:{ref:"index",type:"integer"},icon:{ref:"icon",type:"string",defaultValue:""}}}}}}}}}}},{type:"items",component:"accordion",items:{data:f,addons:{type:"items",component:"expandable-items",translation:"properties.addons",items:{dataHandling:{uses:"dataHandling",items:{suppressZero:null}}}},settings:g}}}),define("client.property-panel/components/color-scale-creator/color-scale-creator-utils",["client.utils/theme/theme-module","general.utils/color","jquery"],function(a,b,c){function d(a,b,d){var e;return e=c.extend(!0,{},a),e&&e.limits&&(e.limits=e.limits.concat().sort(function(a,b){return a.value-b.value}),e.limits.forEach(function(a){a.value=(a.value-b)/(d-b)})),e&&e.colors&&(e.colors=e.colors.concat().map(function(a,b){return{color:k.resolveColorSegment(e,b)}})),e}function e(a,b){if(0!==a.limits.length){return 0===b?a.limits[b].gradient:b===a.colors.length-1?a.limits[b-1].gradient:a.limits[b].gradient||a.limits[b-1].gradient}}function f(a,b,c){if(isNaN(b))return 0;var d,e,f=c?Math.min(c,b):0,g=a.segments.limits.concat().sort(function(a,b){return a.value-b.value}),h=a.segments.colors;for(e=0;e<h.length;e++){if(e===h.length-1)return e;if(d=g[e].value,b<d&&b>=f)return e;f=d}return 0}function g(a,b,c){var d,e,f=a.limits.concat().sort(function(a,b){return a.value-b.value}),g=b>0?f[b-1]:{value:0,gradient:!1},h=a.colors[b-(b>0?1:0)],i=f[b]?f[b]:{value:1,gradient:!1},j=a.colors[b+(b<a.colors.length-1?1:0)],k=c===i.value?1:(c-g.value)/(i.value-g.value);return g&&g.gradient&&i&&i.gradient?c-g.value<i.value-c?(d=h.color,e=.5-k):(d=j.color,e=k-.5):g&&g.gradient?(d=h.color,e=1-(.5+k/2)):i&&i.gradient?(d=j.color,e=k/2):(d=a.colors[b].color,e=c),{color:d,t:e}}function h(a){return l.resolveColor(a)}function i(a,b){return a.paletteColors&&a.paletteColors[b]?l.resolveColor(a.paletteColors[b]):l.resolveColor(a.colors[b].color)}function j(a,c,e,f){var g,h,i,j,k=0,l=d.call(this,a,e,f);if(c<=0)return l.colors[0].color;if(c>=1)return l.colors[l.colors.length-1].color;for(i=0;i<l.colors.length;i++){if(h=l.limits[i]?l.limits[i].value:1,c>=k&&c<h){g=this.getBlendInfo(l,i,c,e,f),j=new b(l.colors[i].color).blend(new b(g.color),g.t);break}k=h}return j}var k={blendValue:j,shouldBlend:e,getBlendInfo:g,resolveColor:h,resolveColorSegment:i,getSegmentIndex:f},l=a.get();return k}),define("extensions.qliktech/kpi/kpi-layout",["objects.views/charts/utils/canvas-renderer"],function(a){function b(a,b,c){var d=a.ratio?a.ratio:1,e=b/c;return a.direction===n.ROW?d>e?n.COLUMN:n.ROW:d>e?n.ROW:n.COLUMN}function c(a){if(!a.components||0===a.components.length)return a;var d,e,f,g,h,i=0,j=a.boundingBox.height,k=a.boundingBox.width,l=a.direction,m=b(a,j,k);for(a.components.forEach(function(a){a.direction=a.direction?a.direction:m,d=a.size.min?a.size.min:a.size?a.size:0,"function"==typeof a.isVisible&&!a.isVisible()||d*j<(a.size.treshold&&a.size.treshold.height?a.size.treshold.height:10)||k<(a.size.treshold&&a.size.treshold.width?a.size.treshold.width:10)?a.show=!1:(i+=d,a.show=!0)}),f=a.components.length-1;f>=0;f--)g=a.components[f],i<1?g.size.stretch&&(g.size.value=g.size.min+(1-i)):g.size.value=null;return a.components.forEach(function(a){e=a.size.value?a.size.value:a.size.min?a.size.min:a.size,h={},l===n.ROW?(h.height=j,h.width=k*e):(h.width=k,h.height=j*e),a.boundingBox=h}),a.components.forEach(function(a){c(a)}),a}function d(a,b,c,g,h,i){var j,k,n;k=a.boundingBox.width,n=a.boundingBox.height,a.components&&a.components.forEach(function(b){d(b,a,k,n,h,i)}),"function"==typeof a.getText&&(h===m.MAX?j=f(a.getText(),k,n):h===m.SCALE&&(j=e(a,k,n)),i===l.ADJUSTTOTEXT&&(a.boundingBox={height:j.height,width:j.width}),a.fontSizes||(a.fontSizes={}),a.fontSizes.fontSize=10*j.fontSize+"%")}function e(a,b,c){if(!a.fontSizes)return{fontSize:"10px"};var d=a.getText(),e=a.fontSizes.min,g=a.fontSizes.max,h=a.fontSizes.maxNrChars,i=f(d,b,c,h),j=Math.min((c-e.height)/(g.height-e.height),1),k=e.fontSize+j*(g.fontSize-e.fontSize);return{fontSize:Math.max(Math.min(i.fontSize,k),e.fontSize)}}function f(a,b,c,d){var e=d?d*j:g.getTextWidth(a,h),f=1.2*i,l=Math.min(b/e,c/f);return{fontSize:Math.max(9*l,k)}}var g=new a,h="10px 'QlikView Sans'",i=g.getFontHeight(h)+1,j=g.getTextWidth("M",h),k=14,l={NONE:0,ADJUSTTOTEXT:1},m={NONE:0,SCALE:1,MAX:2},n={ROW:"row",COLUMN:"column"};return{checkLayout:c,getDirection:b,sizeComponent:d,TextScaleMode:m,ElementScaleMode:l,Direction:n,FixedMobileHeight:150}}),define("client.utils/routing",["general.controllers/route-controller","util"],function(a,b){"use strict";var c={getUrlForSheet:function(c,d,e){var f=["sheet",c,"state",d];return e&&f.splice(0,0,!0,"sense","app",b.getParameterByName("app")),a.buildUrl.apply(a,f)},goToOverview:function(){a.setUrl(a.buildUrl())},goToDataManager:function(b){a.setUrl(a.buildUrl(!0,"sense","app",b,"datamanager","datamanager"))},goToSheet:function(b,d){a.setUrl(c.getUrlForSheet(b,d,!1))},goToStory:function(b,c,d){var e=["story",b,"state",c];d&&e.push("slide",d),a.setUrl(a.buildUrl.apply(a,e))}};return c}),define("general.utils/name-generator",["util"],function(a){"use strict";var b={};return b.nextIndex=function(b,c){var d,e=1;return d=""===c?new RegExp("^\\((\\d+)\\)$"):new RegExp("^"+a.escapeRegExp(c)+" \\((\\d+)\\)$"),b.forEach(function(a){var b=d.exec(a);if(b&&2===b.length){var c=parseInt(b[1],10);e=Math.max(c+1,e)}}),e},b.generateUniqueName=function(a,c){var d=b.nextIndex(a,c);return""===c?"("+d+")":c+" ("+d+")"},b}),define("client.models/sheet",["jquery","core.models/generic-object","general.utils/visualizations","general.utils/name-generator","general.utils/string-limits","util","core.utils/deferred"],function(a,b,c,d,e,f,g){"use strict";function h(a,b){var c,d;for(c=0;c<a.cells.length;++c)if(d=a.cells[c],d.col===b.col&&d.row===b.row)return c;return-1}function i(a,b,c){var d=h(a,b);if(d===-1){if(c)return null;throw new Error("invalid pos")}return a.cells[d]}function j(a,b){a.col=b.col,a.row=b.row,a.colspan=b.colspan,a.rowspan=b.rowspan}function k(a,b,c,d){var e=i(a,b,!0),f=e?e.name:null;return e?(e.name=c,e.type=d):a.cells.push({name:c,type:d,col:b.col,row:b.row,colspan:b.colspan,rowspan:b.rowspan}),f}function l(a,b){var c={col:a.col,row:a.row,colspan:a.colspan,rowspan:a.rowspan},d={col:a.col,row:a.row,colspan:a.colspan,rowspan:a.rowspan};if("left"===b||"right"===b){var e=Math.ceil(a.colspan/2);c.colspan-=e,d.col+=a.colspan-e,d.colspan=e}if("top"===b||"bottom"===b){var f=Math.ceil(a.rowspan/2);c.rowspan-=f,d.row+=a.rowspan-f,d.rowspan=f}if("top"===b||"left"===b){var g=c;c=d,d=g}return{pos1:c,pos2:d}}function m(a,b,c){var d=i(a,b,!1);if(!d||d.colspan!==b.colspan||d.rowspan!==b.rowspan)return!1;var e=l(d,c);return j(d,e.pos1),e.pos2}function n(a,b){return b.filter(function(b){return b.name===a})[0]}function o(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.qInfo.qId=f.generateId(),a.qChildren.push({qChildren:[],qProperty:d})}}var p;return p=b.extend("Sheet",{edit:function(a){var b=this;return b.getProperties().then(function(c){return a(c),b.save()})},getObject:function(a,b){return this.getLayout().then(function(c){return i(c,a,b)})},moveObject:function(a,b){return this.edit(function(c){var d=i(c,a);if(b.split&&!(b=m(c,b.pos,b.split)))return g.reject();j(d,b)})},swapObjects:function(a,b){return this.edit(function(c){var d=i(c,a),e=i(c,b,!0);j(d,b),e&&j(e,a)})},addObject:function(a){var b,d=this,e=a.template,h=a.cell.pos,i=c.getType(e),j=a.init,l=a.children||[];return b=j.qExtendsId?g.resolve(f.extend({qInfo:{qType:e}},j)):i.getInitialProperties(j),g.all({initProps:b,props:d.getFullPropertyTree()}).then(function(a){var b=a.initProps,c=a.props;if(h.split&&!(h=m(c.qProperty,h.pos,h.split)))return g.reject();b.qInfo.qId=f.generateId();var e=k(c.qProperty,h,b.qInfo.qId,b.qInfo.qType),i=!1;if(e)for(var j=0;j<c.qChildren.length;j++)if(c.qChildren[j].qProperty.qInfo.qId===e){c.qChildren[j].qProperty=b,c.qChildren[j].qChildren=[],o(c.qChildren[j],l),i=!0;break}if(!i){var n=c.qChildren.push({qChildren:[],qProperty:b});o(c.qChildren[n-1],l)}return d.saveTree()})},removeNavPoint:function(a){var b=this;return this.getProperties().then(function(c){if(c.navPoints){for(var d=0;d<c.navPoints.length;d++){if(c.navPoints[d].info.id===a){c.navPoints.splice(d,1);break}}return b.setProperties(c)}})},addNavPoint:function(a){var b={info:{type:"odagNavPoint"},title:"",odagLinkRefID:""};b=f.extend(b,a.data),b.info.id||(b.info.id=f.generateId());var c=this;return this.getProperties().then(function(g){g.navPoints||(g.navPoints=[]);var h=g.navPoints.map(function(a){return a.title});if(h.indexOf(b.title)>-1){var i=d.generateUniqueName(h,b.title);i=f.crop(i,e.name),b.title=i}var j=!1;if(a.insertBeforeNavPointID)for(var k=0;k<g.navPoints.length;k++){var l=g.navPoints[k];if(l.info.id===a.insertBeforeNavPointID){g.navPoints.splice(k,0,b),j=!0;break}}return j||g.navPoints.push(b),c.setProperties(g)})},getNavPoints:function(){return this.getProperties().then(function(a){return a.navPoints?a.navPoints:[]})},reorderNavPoints:function(a){var b=this;return this.getProperties().then(function(c){return c.navPoints=a,b.setProperties(c)})},moveNavPoint:function(a,b){var c=this;return this.getProperties().then(function(d){if(a){var e=null,f=null;b||(f=d.navPoints.length-1);for(var g=0;g<d.navPoints.length;g++){var h=d.navPoints[g];if(h.info.id===a?e=g:b&&h.info.id===b&&(f=g),null!==e&&null!==f)break}return e<f&&b&&f--,null!==e&&null!==f&&d.navPoints.splice(f,0,d.navPoints.splice(e,1)[0]),c.setProperties(d)}})},removeRefToLinkIDFromNavPoints:function(a){var b=this;return this.getProperties().then(function(c){for(var d=c.navPoints?c.navPoints:[],e=0;e<d.length;e++){var f=c.navPoints[e];f.odagLinkRefID===a&&(f.odagLinkRefID="")}return b.setProperties(c)})},getObjectById:function(a){var b,c,d=this.layout.cells;for(b=0;b<d.length;++b)if(c=d[b],a===c.name)return c;return null},removeObject:function(a){var b=this;return b.getFullPropertyTree().then(function(c){var d=h(c.qProperty,a),e=c.qProperty.cells[d].name;if(d===-1)throw new Error("invalid pos");c.qProperty.cells.splice(d,1);for(var f=0;f<c.qChildren.length;f++)if(c.qChildren[f].qProperty.qInfo.qId===e){c.qChildren.splice(f,1);break}return b.saveTree()})},setCloneChildrenInfos:function(a){var b=this;return g.all([b.getChildInfos(),a.getChildInfos(),a.getProperties()]).then(function(b){var c=b[0],d=b[1],e=b[2];return c.forEach(function(a,b){var c=n(a.qId,e.cells);c&&(c.name=d[b].qId)}),a.save().then(function(){return a})})},clone:function(){var a=this;return this._super().then(function(b){return a.setCloneChildrenInfos(b)})},draft:function(a){var b=this;return a.rpc("CreateDraft","qDraftId",[this.id]).then(function(a){return p.get(a).then(function(a){return b.setCloneChildrenInfos(a)})})}},{listProperties:{qAppObjectListDef:{qType:"sheet",qData:{title:"/qMetaDef/title",description:"/qMetaDef/description",thumbnail:"/thumbnail",cells:"/cells",rank:"/rank",columns:"/columns",rows:"/rows"}}}}),p.create=function(c,d){var e={qMetaDef:{title:"",description:""},rank:-1,thumbnail:{qStaticContentUrlDef:null},columns:24,rows:12,cells:[],navPoints:[]};return b.create.call(p,a.extend(!0,e,c),d)},p.splitPos=l,p}),define("text!extensions.qliktech/kpi/value.ng.html",[],function(){return'<div class="ellips-text">\n\t<div class="kpi-value" ng-style="valueStyle">\n\t\t<div class="ellips-text">\n\t\t\t<span ng-bind="currentFormattedValue" title="{{currentFormattedValue}}"></span>\n\t\t</div>\n\t\t<div class="glyph-wrapper" ng-if="showGlyph">\n\t\t\t<span class="kpi-icon" ng-bind="glyph"></span>\n\t\t</div>\n\t</div>\n\t<div class="kpi-title ellips-text" ng-style="titleStyle" ng-bind="measureTitle"></div>\n</div>\n'}),define("extensions.qliktech/kpi/value",["qvangular","text!./value.ng.html","util","objects.views/charts/utils/tween"],function(a,b,c,d){a.directive("qvKpiValue",[function(){return{replace:!0,template:b,restrict:"E",scope:{value:"=",formattedValue:"=",valueStyle:"=",formatter:"=",glyph:"=",showGlyph:"=",measureTitle:"=",titleStyle:"="},link:function(a){function b(b,c,e,f){g&&g.destroy(),g=new d(b,{currentValue:c},400).progress(function(){b.currentFormattedValue=f?f.formatValue(b.currentValue):b.currentValue,a.$digest()}).then(function(){b.currentFormattedValue="U"!==f.type?e:f.formatValue(b.currentValue)})}function e(){isNaN(a.formattedValue)||!a.formatter?a.currentFormattedValue=a.formattedValue:"U"===a.formatter.type?(a.tweenFormatter||(a.tweenFormatter=a.formatter.clone()),a.tweenFormatter.pattern=f(a.formattedValue,!0),a.tweenFormatter.prepare(),b(a,a.value,a.formattedValue,a.tweenFormatter)):b(a,a.value,a.formattedValue,a.formatter)}function f(a,b){var d,e,f="0",g=a.match(/(?:-?\d+)([^\d](?=\d))/),h=g?g[1]:"",i=0;if(h&&(e=new RegExp("(?:"+c.escapeRegExp(h)+")(\\d+)"),g=a.match(e),i=g?g[1].length:0),i)for(f+=h,d=0;d<i;d++)f+="0";return b&&(f+="A"),f}var g;a.$watchCollection("[formattedValue,formatter]",function(){e()})}}}])}),define("extensions.qliktech/kpi/kpi",["jquery","qvangular","translator","core.utils/environment","objects.extension/default-view","objects.backend-api/hypercube-api","text!./kpi.ng.html","extensions.qliktech/kpi/kpi-properties","objects.views/charts/utils/chart-formatting","client.property-panel/components/color-scale-creator/color-scale-creator-utils","core.utils/deferred","extensions.qliktech/kpi/kpi-layout","client.utils/routing","client.utils/state","client.models/sheet","objects.extension/object-conversion","core.models/rpc-base","core.utils/feature-flags","client.utils/theme/theme-module","extensions.qliktech/kpi/value"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){"use strict";function t(a){var b=this.$scope,d=this;o.get(a).then(function(a){b.sheet=a,q.bindLayout(b,"sheet",function(a){b.sheetLinkTitle=a&&a.qMeta?a.qMeta.title:"",b.sheetIsMissing=!1,d.updateStyles()})}).catch(function(){b.sheetLinkTitle=c.get("Bookmarks.SheetMissingDialogTitle"),b.sheetIsMissing=!0,d.updateStyles()})}function u(a,b){var c=a.qHyperCube.qMeasureInfo[b];return c.baseColor&&c.baseColor.color}var v,w=b.getService("$timeout"),x=s.get();return v=e.extend("kpi",{namespace:".kpi",init:function(a,d,e,f){var g,h=this,i=function(){b.$apply(a,function(){a.showVerifyDialog=!1})};this._super(a,d,e,f);var j=d.find(".qv-viz");this._$element=j,this.$scope.mainValueStyle={},this.$scope.measureTitleStyle={},this.$scope.viz={},this.$scope.secondaryValues=[],
this.$scope.secondaryLayouts=[],this.$scope.showSecondaryValues=!1,this.$scope.mainValue={formattedValue:"",value:null,style:null},a.showVerifyDialog=!1,a.onShowVerifyDialog=function(){a.linkInteractionOn&&(b.$apply(a,function(){a.showVerifyDialog=!0,a.updateVerifyDialogFontSize()}),g=w(i,3e3))},a.linkToSheet=function(){if(a.linkInteractionOn&&!a.sheetIsMissing&&a.showVerifyDialog){var b=m.getUrlForSheet(a.layout.sheetLink,"analysis");a.layout.openUrlInNewTab||void 0===a.layout.openUrlInNewTab?window.open(b):m.goToSheet(a.layout.sheetLink,n.States.ANALYSIS),w.cancel(g),i()}},a.updateVerifyDialogFontSize=function(){if(a.showVerifyDialog){var b=a.verifyDialogLayoutInfo.components[0];l.checkLayout(a.verifyDialogLayoutInfo),l.sizeComponent(b,a.verifyDialogLayoutInfo,a.verifyDialogLayoutInfo.boundingBox.width,a.verifyDialogLayoutInfo.boundingBox.height,l.TextScaleMode.SCALE,l.ElementScaleMode.NONE),a.verifyDialogStyle={fontSize:b.fontSizes.fontSize}}},this.$scope.baseLayoutInfo={direction:l.Direction.COLUMN,ratio:1e9,boundingBox:{width:j.width(),height:j.height()},components:[{size:{min:.2,treshold:{width:150,height:12}},getText:function(){return a.measureTitle},fontSizes:{maxNrChars:15,min:{fontSize:10,height:15},max:{fontSize:40,height:80}},isVisible:function(){return a.showMeasureTitle}},{size:{min:.8,stretch:!0},ratio:1,components:[{size:{min:.5,stretch:!0},getText:function(){return h.$scope.mainValue.formattedValue+(h.$scope.mainValue.glyph?h.$scope.mainValue.glyph:"")},fontSizes:{maxNrChars:4,min:{fontSize:10,height:20},max:{fontSize:500,height:500}}},{size:.5,components:this.$scope.secondaryLayouts,isVisible:function(){return h.$scope.secondaryLayouts.length>0}}]}]},this.$scope.secondaryLayoutInfo={size:{min:1,treshold:{width:100,height:30}},direction:l.Direction.COLUMN,components:[{size:{min:.6,stretch:!0},fontSizes:{maxNrChars:8,min:{fontSize:10,height:20},max:{fontSize:500,height:500}}},{size:{min:.4},fontSizes:{maxNrChars:15,min:{fontSize:10,height:20},max:{fontSize:30,height:500}}}]},this.$scope.verifyDialogLayoutInfo={size:{min:1,width:20,height:20},boundingBox:{width:0,height:0},components:[{size:{min:.2,treshold:{width:100,height:100}},getText:function(){return c.get("properties.kpi.verifyToGoSheet")},fontSizes:{maxNrChars:16,min:{fontSize:10,height:20},max:{fontSize:13,height:50}}}]},a.$on("$destroy",function(){g&&w.cancel(g)})},isValid:function(a){return!!a&&!!a.qHyperCube&&a.qHyperCube.qMeasureInfo.length&&!a.qHyperCube.qMeasureInfo.some(function(a){return!!a.qError})},updateData:function(a){if(!this.isValid(a))return k.resolve();this._data=a;var b,c,e,f,g,h,i,j=a.qHyperCube.qDataPages[0].qMatrix[0],l=a.qHyperCube.qMeasureInfo.length,m=d.inClient(),n=l-1,o=this.getFormatterForMeasures(a.qHyperCube.qMeasureInfo.length),p=this.$scope.secondaryValues,q=this.$scope.secondaryLayouts,r=this.$scope.sheet&&this.$scope.sheet.qMetaDef&&this.$scope.sheet.qMetaDef.title?this.$scope.sheet.qMetaDef.title:null,s=function(){return f},u=function(){return h};for(this.$scope.showMeasureTitle=a.showMeasureTitle,this.$scope.textAlign=a.textAlign,this.$scope.baseLayoutInfo.components[1].components[0].fontSizes.maxNrChars="S"===a.fontSize?7:"L"===a.fontSize?3:4,this.$scope.useLink=a.useLink,m&&this.$scope.useLink&&a.sheetLink&&(!r||a.sheetLink!==r)&&t.call(this,a.sheetLink),this.$scope.mainValue.value=a.qHyperCube.qDataPages[0].qMatrix[0][0].qNum,this.$scope.mainValue.formattedValue="U"!==o[0].type||isNaN(a.qHyperCube.qDataPages[0].qMatrix[0][0].qNum)?a.qHyperCube.qDataPages[0].qMatrix[0][0].qText:o[0].formatValue(this.$scope.mainValue.value),this.$scope.mainValue.formatter=o[0],i=0;i<n;i++)e=j[i+1].qText,g=j[i+1].qNum,f="U"!==o[i+1].type||isNaN(g)?e:o[i+1].formatValue(g),h=a.qHyperCube.qMeasureInfo[i+1].qFallbackTitle,p[i]||(c=this.createSecondaryValue(s,u),b={style:c.layoutInfo.components[0].fontSizes.value,titleStyle:c.layoutInfo.components[1].fontSizes.value},p.push(b),q.push(c.layoutInfo)),b=p[i],b.value=g,b.formattedValue=f,b.formatter=o[i+1],b.measureTitle=h,q[i].components[0].fontSizes.maxNrChars="S"===a.fontSize?14:"L"===a.fontSize?6:8;return p.length>n&&(q.splice(n,p.length-n),p.splice(n,p.length-n)),this.$scope.measureTitle=a.qHyperCube.qMeasureInfo[0].qFallbackTitle,this.$scope.showSecondaryValues=p.length>0,k.resolve()},updateStyles:function(){if(!this._data)return k.resolve();var a,b,c=this,e=this._data,f=d.inClient(),g=function(a,b){var c,d=e.qHyperCube.qMeasureInfo[b].conditionalColoring,f=e.qHyperCube.qMeasureInfo[b].measureAxis,g=(a-f.min)/(f.max-f.min),h=j.getSegmentIndex(d,a,f.min),i=d.segments.colors[h]?d.segments.colors[h].icon:"";return c=r.MASTER_MEASURE_COLOR&&e.color&&"measure"===e.color.useBaseColors&&u(e,b)?x.resolveColor(e.qHyperCube.qMeasureInfo[b].baseColor):d.useConditionalColoring?j.shouldBlend(d.segments,h)?j.blendValue(d.segments,g,f.min,f.max):j.resolveColorSegment(d.segments,h):j.resolveColor(d.paletteSingleColor||d.singleColor),{color:c,icon:i,useCondColor:d.useConditionalColoring}};this.$scope.linkInteractionOn=f&&this._navigation&&this.$scope.layout.useLink&&!!this.$scope.layout.sheetLink,this.$scope.verifyDialogLayoutInfo.boundingBox.width=this._$element.width(),this.$scope.verifyDialogLayoutInfo.boundingBox.height=this._$element.height(),this.$scope.baseLayoutInfo.boundingBox=this.getBoundingBox(),l.checkLayout(this.$scope.baseLayoutInfo),this.$scope.baseLayoutInfo.components.forEach(function(a){var b=c.backendApi.isSnapshot&&c._data&&!c.options.freeResize,d=b?c._data.snapshotData.isZoomed:c.options.isZoomed;l.sizeComponent(a,c.$scope.baseLayoutInfo,c.$scope.baseLayoutInfo.boundingBox.width,c.$scope.baseLayoutInfo.boundingBox.height,0===c.$scope.secondaryValues.length&&d?l.TextScaleMode.MAX:l.TextScaleMode.SCALE,0===c.$scope.secondaryValues.length&&d?l.ElementScaleMode.ADJUSTTOTEXT:l.ElementScaleMode.NONE)}),b=g(this.$scope.mainValue.value,0),this.$scope.mainValue.glyph=b.icon,this.$scope.mainValue.showGlyph=b.useCondColor&&b.icon&&""!==b.icon,a=this.$scope.baseLayoutInfo.components[1].components[0],this.$scope.mainValue.style={color:b.color,fontSize:a.fontSizes.fontSize},a=this.$scope.baseLayoutInfo.components[0],this.$scope.measureTitleStyle={fontSize:a.fontSizes.fontSize};for(var h=1;h<e.qHyperCube.qMeasureInfo.length;h++)a=this.$scope.baseLayoutInfo.components[1].components[1].components[h-1].components[0],b=g(this.$scope.secondaryValues[h-1].value,h),this.$scope.secondaryValues[h-1].style={color:b.color,fontSize:a.fontSizes.fontSize},a=this.$scope.baseLayoutInfo.components[1].components[1].components[h-1].components[1],this.$scope.secondaryValues[h-1].titleStyle={fontSize:a.fontSizes.fontSize},this.$scope.secondaryValues[h-1].glyph=b.icon,this.$scope.secondaryValues[h-1].showGlyph=b.useCondColor&&b.icon&&""!==b.icon;this.$scope.updateVerifyDialogFontSize();var i=k();return w(function(){i.resolve()},0,!1),i.promise},createSecondaryValue:function(b,c){var d=a.extend({},this.$scope.secondaryLayoutInfo);return d.components[0].getText=b,d.components[1].getText=c,{layoutInfo:d,text:b()}},paint:function(){return this.updateStyles()},resize:function(a,b){return this.paint(a,b)},getFormatterForMeasures:function(a){for(var b,c,d=this._data,e=new i(this.backendApi.localeInfo,d.qHyperCube.qMeasureInfo),f=[],g=0;g<a;g++)b=d.qHyperCube.qMeasureInfo[g],c=e.getMeasureFormatter(g),"U"===c.type&&(c.pattern=c.createPatternFromRange(b.qMax,b.qMax,!0),Math.floor(Math.log(Math.abs(b.qMax))/Math.log(10))%3==2&&(c.pattern=c.pattern.substr(0,c.pattern.length-2),c.pattern+="A")),c.prepare(),f.push(c);return f},on:function(){this.options.navigation&&(this._navigation=!0),this._super(),this.updateStyles()},off:function(){this.options.navigation&&(this._navigation=!1),this._super(),this.updateStyles()},getBoundingBox:function(){return this.backendApi.isSnapshot&&this._data&&!this.options.freeResize&&this._data.snapshotData.elementRatio?{width:this._data.snapshotData.object.size.w,height:this._data.snapshotData.object.size.w*this._data.snapshotData.elementRatio}:{width:this._$element.width(),height:this._$element.height()}},setSnapshotData:function(a){this._super(),a.snapshotData.isZoomed=this.options.isZoomed,a.snapshotData.elementRatio=this._$element.height()/this._$element.width()},getPreferredSize:function(){var a=k();return a.resolve({w:this._$element.width(),h:l.FixedMobileHeight}),a.promise}}),{type:"kpi",BackendApi:f,template:g,View:v,definition:h,initialProperties:{qHyperCubeDef:{qDimensions:[],qMeasures:[],qInitialDataFetch:[{qWidth:500,qHeight:10}],qSuppressMissing:!0},showTitles:!1},data:{measures:{min:1,max:2}},support:{cssScaling:!1,snapshot:!0,export:!0,exportData:!0,sharing:!1},getDropFieldOptions:function(a,b,c,d,e){a.AddFieldAsMeasure(c,b,e),d()},getDropDimensionOptions:function(a,b,c,d){d()},importProperties:function(a,b,c){var d,e,f,g=p.hypercube.importProperties.apply(p,[a,b,c]),h=g.qProperty.qHyperCubeDef.qMeasures;if(h)for(e=0,d=h.length;e<d;e++)f=h[e].qDef,f.measureAxis||(f.measureAxis={min:0,max:100}),f.conditionalColoring||(f.conditionalColoring={useConditionalColoring:!1,singleColor:3,segments:{limits:[],colors:[{color:2}],paletteColors:[{index:6}]}});return g},exportProperties:p.hypercube.exportProperties.bind(p)}}),define("objects.backend-api/map-api",["./backend-api"],function(a){"use strict";return a.extend("MapApi",{init:function(a){this._super(a)},select:function(a,b,c,d){if(b)return this.model[a](b,c,d)},selectRange:function(a,b,c){if(!(this.path.indexOf("qHyperCubeDef")<0)){var d,e=this.path.replace("/geodata","");return b=!!b,c=c||[0],d=a.map(function(a){return{qMeasureIx:a.measure,qRange:{qMin:a.range.min,qMax:a.range.max,qMinInclEq:a.range.minInclEq!==!1,qMaxInclEq:a.range.maxInclEq!==!1}}}),this.model.rangeSelectHyperCubeValues(e,d,c,b)}},selectValues:function(a,b,c,d){return this.model.selectHyperCubeValues(d||this.path,a,b,c)},updateCache:function(){},setInitialData:function(){},getData:function(a,b){return this.model.getHyperCubeData(b,a)},evaluateExpression:function(a){return this.model.app.evaluateExpression(a)},clearSelections:function(){return this.model.resetMadeSelections()},hasSelections:function(){return this.model.layout.qSelectionInfo.qMadeSelections},beginSelections:function(){var a,b,c,d=this.model,e=[];for(a=0;a<d.layout.layers.length;++a)if(b="/layers/"+a+"/","polygon"===d.layout.layers[a].type)c=b+"geodata/",b+="qHyperCubeDef",c+="qHyperCubeDef",e.push(b),e.push(c);else{if(!d.layout.layers[a].qHyperCube)continue;b+="qHyperCubeDef",e.push(b)}return d.app.switchModalSelection(d,e)}})}),define("text!extensions.qliktech/map/map.ng.html",[],function(){return'<div class="qv-viz"></div>\n<div qva-scatter-navigation></div>\n<div qva-chart-disclaimer attributes="dataAttributes" visible="true" direction="options.direction"></div>'}),define("text!client.services/media-tool/media-tool.ng.html",[],function(){return'<div class="qv-st-container">\n\t<form class="qv-st-form">\n\t\t<textarea class="qv-st-instance">{{data}}</textarea>\n\t</form>\n</div>'}),define("client.services/media-tool/theme",[],function(){return{palette:["#b0afae","#7b7a78","#545352","#4477aa","#7db8da","#b6d7ea","#46c646","#f93f17","#ffcf02","#276e27","#ffffff","#000000"],fontSizes:{1:"XS",2:"S",3:"M",4:"L",5:"XL"},fontSizesPx:{10:"1",13:"2",16:"3",22:"4",32:"5"},htmlSizeToMarkdownSize:{1:1,2:2,3:3,4:4,5:5,6:5},markdownSizeToHtmlSize:{1:1,2:2,3:3,4:4,5:5}}}),define("text!client.services/media-tool/toolbar.ng.html",[],function(){return'<lui-popover ng-if="options.style === \'popover\'" style="height: 44px;" align-to="alignTo" position="\'top\'" collision="\'collision\'" width="options.width" class="lui-popover qv-texttool-toolbar"\n\t\t\t\t\t  on-close-view="closeToolbar(event)" ondragstart="return false">\n\t<div qv-media-tool-buttons class="qv-texttool-toolbar"></div>\n</lui-popover>\n\n<div ng-if="options.style === \'inline\'" qv-media-tool-buttons class="qv-texttool-toolbar"></div>\n'}),define("client.services/media-tool/text-selection",[],function(){function a(){return window.getSelection()}var b={};return b.createRange=function(a,b,c){var d=document.createRange();return b=b||0,c=void 0===c?a.childNodes.length:c,d.setStart(a,b),d.setEnd(a,c),d},b.createRangeForElement=function(a){var b=document.createRange();return b.selectNode(a),b},b.addRange=function(b,c){var d=a();c&&d.removeAllRanges(),d.addRange(b)},b.getRange=function(b){var c=window.getSelection();return b=b||0,c.rangeCount>b?a().getRangeAt(b):null},b.rangeEquals=function(a,b){return null===a&&null===b||null!==a&&null!==b&&(0===a.compareBoundaryPoints(window.Range.START_TO_START,b)&&0===a.compareBoundaryPoints(window.Range.END_TO_END,b))},b}),define("text!client.services/media-tool/link-foldout/link-foldout.ng.html",[],function(){return'<immidiate-contextual width="400" align-to="options.alignTo" position="\'bottom\'" collision="\'flipfit\'" on-close-view="closeFoldout(event)"\n\t\t\t\t\t  class="qv-link-foldout qui-immidiateContextual" tid="link-foldout">\n\t<div qva-outside-ignore-for="media-toolbar">\n\t\t<div class="link-header">\n\t\t\t<h1 class="link-header-text" ng-if="linkActive" q-translation="MediaTool.Toolbar.InsertUrlLink.Title"></h1>\n\t\t\t<h1 class="link-header-text" ng-if="!linkActive" q-translation="Common.Bookmarks"></h1>\n\t\t\t<div class="link-submenu" ng-if="inStorytelling()">\n\t\t\t\t<ul>\n\t\t\t\t\t<li class="lui-button" ng-if="!linkActive" qva-activate="toggleLink(true)" q-translation="Common.URL" ></li>\n\t\t\t\t\t<li class="lui-button" ng-if="linkActive" qva-activate="toggleLink(false)" q-translation="Common.Bookmarks" ></li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="link-content" ng-if="linkActive">\n\t\t\t<span class="link-label" q-translation="MediaTool.Toolbar.InsertUrlLink.Label"></span>\n\t\t\t<input class="link-input lui-input" maxlength="255" ng-model="link.url" style="margin-bottom: 10px" qv-enter="onEnter($event)"/>\n\t\t\t<div class="link-remove-container" ng-if="showRemove">\n\t\t\t\t<button class="lui-button" qva-activate="removeLink($event)" q-title-translation="MediaTool.Toolbar.RemoveLink">\n\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--bin"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="bookmark-content" ng-if="!linkActive">\n\t\t\t<ul>\n\t\t\t\t<li ng-if="bookmarks.length < 1" class="bookmark-link-row">\n\t\t\t\t\t<span class="bookmark-link-row-content no-bookmarks" q-translation="Bookmarks.NoBookmarks"></span>\n\t\t\t\t</li>\n\t\t\t\t<li class="bookmark-link-row" ng-repeat="bookmark in bookmarks" ng-class="{ active: bookmark.active}">\n\t\t\t\t\t<span class="bookmark-link-row-content" qva-activate="insertBookmark($event, bookmark.qInfo.qId)" data-bookmark-id="{{bookmark.qInfo.qId}}">{{bookmark.qData.title}}</span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n<!--</div>-->\n</immidiate-contextual>\n'});define("client.models/bookmark",["jquery","core.models/base-object","core.models/app"],function(a,b,c){"use strict";var d;return d=b.extend("Bookmark",{clone:function(){return this._super("CloneBookmark")},apply:function(){return d.apply(this.id,this.app)}},{listProperties:{qBookmarkListDef:{qType:"bookmark",qData:{title:"/qMetaDef/title",description:"/qMetaDef/description",sheetId:"/sheetId",selectionFields:"/selectionFields",creationDate:"/creationDate"}}}}),d.get=function(a,b){function d(){return b.enigmaModel.getBookmark(a)}return b=b||c.current,this.getModel(a,b.session,d)},d.apply=function(a,b){return b=b||c.current,b.rpc("ApplyBookmark","qSuccess",[a])},d.create=function(c,d){var e={qMetaDef:{title:"",description:""},sheetId:c.sheetId||null,selectionFields:c.selectionFields,creationDate:(new Date).toISOString()};return b.create.call(this,a.extend(!0,{},e,c),"CreateBookmark",d)},d.remove=function(a,c){return b.remove(a,"DestroyBookmark",c)},d.extend=function(a,c,e){var f=b.extend.call(this,a,c,e);return f.extend=d.extend,f.create=d.create,f.remove=d.remove,f.get=d.get,f},d}),define("client.services/media-tool/link-foldout/link-foldout",["jquery","text!./link-foldout.ng.html","client.utils/state","client.models/bookmark"],function(a,b,c,d){return{template:b,scope:{alignTo:"=",options:"="},controller:["$scope","$timeout","$element",function(b,e,f){function g(){d.getList().then(function(a){a.getLayout().then(function(a){b.bookmarks=a,h()})})}function h(){b.bookmarks.forEach(function(a){a.qInfo.qId===b.link.bookmark?a.active=!0:a.active=!1})}b.link=b.options.link,b.link.url&&"#"!==b.link.url||(b.link.url=""),b.link.url=decodeURIComponent(b.link.url);var i=b.link.url;b.alignTo=b.options.alignTo,b.linkActive=!0,b.closeFoldout=function(a){var c=encodeURI(b.link.url),d=b.link.$node;if(b.closed=!0,c===i)return void b.options.onCancel(a);c&&c.length>0&&c.indexOf("javascript:")===-1?(0!==c.search("[a-zA-Z0-9]+:")&&(c="http://"+c),b.options.onSave(a,c,d,{cmd:"createLink",formatter:"link"})):b.options.onCancel(a)},b.onEnter=function(a){b.closeFoldout(a)},b.showRemove=!!i,b.removeLink=function(a){b.options.onRemove(a,b.link.$node)},b.inStorytelling=function(){return c.state===c.States.editstory},b.insertBookmark=function(a,c){b.options.onSave(a,c,b.link.$node,{cmd:"createLink",formatter:"bookmark"})},b.toggleLink=function(c){b.linkActive=c,c&&setTimeout(function(){a(".link-input").focus()})},b.exposedApi.closing=function(){b.closed||b.closeFoldout()},b.$on("$destroy",function(){b.closed||b.closeFoldout()}),function(){!b.link.url&&b.link.bookmark?(b.toggleLink(!1),g()):b.toggleLink(!0)}(),b.$watch("linkActive",function(){b.linkActive&&g()}),e(function(){f.find(".link-input").focus()})}]}}),define("general.utils/paths",["util"],function(a){var b={};return b.stripBasePath=function(b){return b=b.replace(a.baseURI,"").replace(/^\.\.\//i,"/"),b=b.replace(location.protocol+"//"+location.host,"")},b.addBasePath=function(b){return a.baseURI+".."+b},b.getUrl=function(a){return require.toUrl(".."+a)},b}),define("general.models/media-library",["core.models/base-object","util","general.utils/paths"],function(a,b,c){"use strict";function d(a,b,c){var d={name:a,type:b};return c&&(d.path=c.qUrl,d.pathDef=c.qUrlDef),"folder"===b&&(d.children=[]),d}function e(a,b){a=a.substring(1).split("/").reverse().slice(1).reverse();var c=b;return a.forEach(function(a){var b=!1;if(c.children.forEach(function(d){if(d.name===a)return c=d,void(b=!0)}),!b){var e=d(a,"folder");c.children.push(e),c=e}}),c}function f(a){a.sort(function(a,b){return a.name.localeCompare(b.name)}).reverse(),a.sort(function(a,b){return"folder"===a.type&&"folder"!==b.type?-1:"folder"===a.type&&"folder"===b.type?a.name.localeCompare(b.name):"folder"!==a.type&&"folder"!==b.type?a.name.localeCompare(b.name):1}),a.forEach(function(a){void 0!==a.children&&f(a.children)})}var g;return g=a.extend("MediaLibrary",{},{listProperties:{qMediaListDef:{}}}),g.createTree=function(a,b,g){b=(b||[]).join("|")||".+?";var h=d("/","folder"),i=new RegExp("\\.("+b+")$","i");return a.forEach(function(a){var b,f=a,j=f.qUrl;if(j=c.stripBasePath(j),b=decodeURIComponent((j+"").replace(/\+/g,"%20")),b=b.split("/").splice(-1)[0],b.match(i)){var k,l=h;g||(k=decodeURIComponent(j).replace(/^(\/content\/default)|(\/content\/Default)/,"").replace(/^(^\/media\/([a-z0-9-])+\/([a-z0-9-])+\/)/,"/media/"),l=e(k,h)),l.children.push(d(b,"file",f))}}),f(h.children),h},g.filterList=function(a){var b,c,d=[],e=a.sort(function(a,b){var c=a.qName.toLowerCase(),d=b.qName.toLowerCase();return c.localeCompare(d)});for(b=0;b<a.length;b++)if(c=a[b],c.qAppSpecific){d.push(c),c.qMeta&&c.qMeta.privileges.indexOf("update")!==-1&&(g.canUpdate=!0);break}for(b=0;b<e.length;b++)c=a[b],c.qAppSpecific||d.push(c);return d},g.getRemainingSpace=function(a){for(var b=0,c=0;c<a.length;c++)if(a[c].qAppSpecific){b=parseInt(a[c].qMeta.remainingLibrarySpace||0,10);break}return b},g}),define("text!general.components/media-library/media-library.ng.html",[],function(){return'<qv-modal-dialog qv-id="media-library-modal" tid="media-library" qv-cancel="cancel($event)" qv-confirm="confirm()" qva-outside-ignore-for="media-toolbar" qva-stop-prop>\n\t<header class="dm-head">\n\t\t<span class="dm-title" q-translation="MediaLibrary.Header"></span>\n\t</header>\n\t<main class="dm-main medialib">\n\t\t<div class="q-section-list" ng-if="lists.length">\n\t\t\t<ul class="qui-menu" tid="menu-list">\n\t\t\t\t<li ng-repeat="list in lists track by list.qName"\n\t\t\t\t\tng-class="{\'qui-menu-item\': true, \'selected\': !isUpload && view === list.qName}"\n\t\t\t\t\tqva-activate="goTo(list.qName, false)">\n\t\t\t\t\t<span ng-if="list.qAppSpecific" q-translation="MediaLibrary.InApp" tid="goto-inapp"></span>\n\t\t\t\t\t<span ng-if="!list.qAppSpecific" tid="goto-library">{{ list.qName }}</span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t<div class="q-section-upload qui-menu-item"\n\t\t\t\tng-if="canUpdate"\n\t\t\t\tng-class="{\'selected\': isUpload}"\n\t\t\t\ttid="goto-upload"\n\t\t\t\tqva-activate="goTo(\'\', true)">\n\t\t\t\t<div class="q-section-upload-text" q-translation="MediaLibrary.UploadMedia"></div>\n\t\t\t\t<div class="qv-loader" ng-if="updateExp.isUploading"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="q-empty" ng-if="state === contentState.isEmpty && !isUpload">\n\t\t\t<p q-translation="MediaLibrary.NoFilesFound" class="nff"></p>\n\t\t</div>\n\t\t<qve-media-list ng-if="state === contentState.hasFiles && !isUpload" ng-class="{\'q-image-library\': !isUpload}" class="q-images-cont" tid="media-lib-items-list"></qve-media-list>\n\t\t<div class="q-media-preview" ng-if="selectedFile && !isUpload">\n\t\t\t<div class="q-media-preview-toolbar" ng-if="canDeleteInView()">\n\t\t\t\t<qui-button-outline-round\n\t\t\t\t\tlight\n\t\t\t\t\ttid="delete"\n\t\t\t\t\tclass-icon="icon-bin"\n\t\t\t\t\tdata-name="delete"\n\t\t\t\t\tq-title-translation="Common.Delete"\n\t\t\t\t\tqva-activate="onDelete($event)">\n\t\t\t\t</qui-button-outline-round>\n\t\t\t</div>\n\t\t\t<div class="q-media-preview-img-wrapper">\n\t\t\t\t<img ng-src="{{ getSrc(selectedFile) }}" class="q-media-img-list"/>\n\t\t\t</div>\n\t\t\t<div class="q-media-preview-bottom-toolbar">\n\t\t\t\t<button class="lui-button"\n\t\t\t\t\t\ttid="insert"\n\t\t\t\t\t\tdata-name="insert"\n\t\t\t\t\t\tq-translation="MediaLibrary.Insert"\n\t\t\t\t\t\tq-title-translation="MediaLibrary.Insert"\n\t\t\t\t\t\tqva-activate="confirm()">\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="q-images-cont" ng-if="canUpdate" ng-show="isUpload">\n\t\t\t<qv-media-update update-exp="updateExp" select-file="selectFile" selected-file="selectedFile" confirm="confirm"></qv-media-update>\n\t\t</div>\n\t</main>\n\t<div class="q-media-zoomed" ng-if="inZoom" qva-stop-prop>\n\t\t<div class="q-media-z-wrapper">\n\t\t\t<div class="q-media-z-cont">\n\t\t\t\t<img class="q-media-z-img" ng-src="{{ getSrc(zoomSrc) }}">\n\t\t\t</div>\n\n\t\t\t<div class="q-media-zoom-footer">\n\t\t\t\t<qv-confirm-cancel-footer light qv-confirm="confirm()" qv-cancel="closeZoom()" qv-confirm-label="Common.Apply" qv-confirm-disabled="updateExp.isUploading"></qv-confirm-cancel-footer>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<footer class="dm-footer">\n\t\t<lui-button x-variant="inverse" qva-activate="cancel($event)"q-translation="Common.Close" tid="cancel" ng-disabled="updateExp.isUploading"></lui-button>\n\t</footer>\n</qv-modal-dialog>\n'}),define("text!general.components/media-library/media-library-grid.ng.html",[],function(){return'<div>\n\t<qv-bouncy-grid min-width="140" padding="15" selector=".q-media-grid" list-len="rootEntry.children.length">\n\t\t<div ng-repeat="entry in rootEntry.children"\n\t\t\t title="{{entry.name}}"\n\t\t\t tid="media-item"\n\t\t\t ng-class="{\'q-media-grid\': true, \'selected-img\': isSelectedImg(entry, $last, \'.q-media-inuse\')}"\n\t\t\t qva-activate="selectFile($event, entry.path, entry.pathDef)">\n\t\t\t<div class="q-media-wrap-img">\n\t\t\t\t<img ng-src="{{staticSrc}}" class="q-media-img" width="100%" height="100%"/>\n\n\t\t\t\t<div class="overlay"></div>\n\t\t\t\t<div class="q-media-inuse" ng-if="input.selectedFile === entry.path">\n\t\t\t\t\t<i class="icon-tick"></i>\n\t\t\t\t</div>\n\t\t\t\t<div class="q-media-buttons" ng-if="selectedFile === entry.path">\n\t\t\t\t\t<qui-button-outline-round small\n\t\t\t\t\t\t\t\t\t\t\t  tid="media-view"\n\t\t\t\t\t\t\t\t\t\t\t  class-icon="icon-hub-view"\n\t\t\t\t\t\t\t\t\t\t\t  data-name="view"\n\t\t\t\t\t\t\t\t\t\t\t  q-title-translation="Common.View"\n\t\t\t\t\t\t\t\t\t\t\t  qva-activate="zoomImage($event, entry)"\n\t\t\t\t\t\t\t></qui-button-outline-round>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="q-media-name">{{entry.name}}</div>\n\t\t</div>\n\t</qv-bouncy-grid>\n</div>'}),define("text!general.components/media-library/media-library-list.ng.html",[],function(){return'<div>\n\t<!--\n\t\t<img ng-src="{{staticSrc}}" class="q-media-img" width="100%" height="100%"/>\n\t-->\n\t<div class="q-media-list-cont" qva-context-menu="onContextMenu($event)">\n\t\t<div ng-repeat="entry in rootEntry.children"\n\t\t\t ng-class="{\'qui-menu-item\': true, \'selected\': isSelectedImg(entry, $last, \'.selected\')}"\n\t\t\t tid="media-item" title="{{entry.name}}"\n\t\t\t qva-activate="selectFile($event, entry.path, entry.pathDef)">\n\t\t\t<div class="list-name">{{entry.name}}</div>\n\t\t</div>\n\t</div>\n</div>'}),define("text!general.services/loader/default-loader.ng.html",[],function(){return'<div class="qv-block-ui" ng-class="{\'qv-fade-out\': fadeOut}">\n\t<div class="qv-loader-container" ng-class="ngClasses">\n\t\t<div class="qv-loader"></div>\n\t</div>\n\t<div class="qv-loader-text" ng-if="messageObj" ng-class="ngClasses">\n\t\t<div ng-show="messageObj.task" q-translation="{{messageObj.task}}"></div>\n\t\t<div ng-show="messageObj.message" q-translation="{{messageObj.message}}"></div>\n\t</div>\n</div>\n'}),define("general.views/bouncy-grid/bouncy-grid",["jquery","qvangular","core.utils/resize"],function(a,b,c){function d(a){return parseInt(a||0,10)}b.directive("qvBouncyGrid",[function(){return{restrict:"E",template:'<div class="qv-bouncy" ng-transclude></div>',transclude:!0,replace:!0,scope:{minWidth:"@",maxWidth:"@",padding:"@",selector:"@",listLen:"="},controller:["$scope","$element",function(b,e){function f(a){clearTimeout(h),h=setTimeout(g,a||50)}function g(){var a,c,g,h,m=d(b.padding);l?(a=l,c=Math.ceil(e.width()/a),g=Math.floor(e.width()/c),h=(c>b.listLen?a:g)-m+"px!important;"):(a=k,c=Math.floor(e.width()/a),g=Math.ceil(e.width()/c),h=(c>b.listLen?a:g)-m+"px!important;"),isNaN(g-m)&&j<20?(j++,f()):i&&i.length&&i.text(b.selector+" { width: "+h+"height: "+h+"}")}var h,i=a("<style></style>").appendTo("body"),j=0,k=d(b.minWidth),l=d(b.maxWidth);c.on("end",f),f(0),b.$watch("listLen",f),b.$on("$destroy",function(){clearTimeout(h),i&&i.remove(),h=null,i=null,c.off("end",f)})}]}}])}),define("text!general.components/media-library/update/media-update.ng.html",[],function(){return'<div id="media-library-upload">\n\t<div class="bouncy-wrap" ng-class="{\'empty\' : isEmpty}">\n\t\t<qv-bouncy-grid min-width="140" padding="15" selector=".preview-media-grid" list-len="previewCounter">\n\t\t\t<div class="media-library-preview-container" ng-hide="isEmpty"></div>\n\t\t</qv-bouncy-grid>\n\t</div>\n\t<div id="media-library-dropzone" class="dropzone" ng-class="{\'empty\' : isEmpty}">\n\t\t<div class="dz-message">\n\t\t\t<div class="upload-drop-text" q-translation="MediaLibrary.ClickOrDropHere"></div>\n\t\t\t<div class="upload-drop-icon-wrap">\n\t\t\t\t<div class="upload-drop-icon" data-icon="upload"></div>\n\t\t\t</div>\n\t\t\t<div class="upload-drop-quota">{{quotaInfo}}</div>\n\t\t</div>\n\t</div>\n</div>\n'}),define("text!general.components/media-library/update/preview-item.ng.html",[],function(){return'<div tid="preview-item"\n\t class="q-media-grid preview-media-grid"\n\t ng-class="{\'selected-img\': selectedFile === file.qUrl}"\n\t qva-activate="onSelectImage( $event, file )"\n\t qva-context-menu="onContextMenu( $event, file, file.name, file.qUrl )">\n\t<div class="q-media-wrap-img">\n\t\t<img class="q-media-img" width="100%" height="100%" data-dz-thumbnail />\n\t\t<div class="overlay"></div>\n\t\t<div class="preview-area">\n\t\t\t<div class="touch-area cancel-upload-area" q-title-translation="Common.Cancel" data-dz-remove qva-activate="onCancelUpload( $event, file )">\n\t\t\t\t<button class="qui-btn-overlay-action-small cancel-upload">\n\t\t\t\t\t<span class="lui-icon  lui-icon--close"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div ng-if="selectedFile === file.qUrl" class="preview-area-edit">\n\t\t\t\t<div class="touch-area delete-image-area" q-title-translation="Common.Delete" qva-activate="onDelete( $event, file, file.name, file.qUrl )">\n\t\t\t\t\t<button class="qui-btn-overlay-action-small delete-image">\n\t\t\t\t\t\t<span class="lui-icon  lui-icon--bin"></span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<qui-button-outline-round\n\t\t\t\t\ttid="insert"\n\t\t\t\t\tclass-icon="icon-add-section"\n\t\t\t\t\tdata-name="insert"\n\t\t\t\t\tq-title-translation="MediaLibrary.Insert"\n\t\t\t\t\tqva-activate="onInsert( $event )">\n\t\t\t\t</qui-button-outline-round>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="error-wrapper" ng-if="showError">\n\t\t\t<div class="error-icon" data-icon="warning-triangle"></div>\n\t\t\t<div class="error-text">{{errorMsg}}</div>\n\t\t</div>\n\t\t<div class="preview-progress">\n\t\t\t<div class="preview-progressbar-wrapper">\n\t\t\t\t<span class="preview-progressbar" data-dz-uploadprogress></span>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="q-media-name" q-title-translation="{{file.name}}">{{file.name}}</div>\n</div>\n'}),function(){var a,b,c,d,e,f,g,h,i=[].slice,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=function(){},b=function(){function a(){}return a.prototype.addEventListener=a.prototype.on,a.prototype.on=function(a,b){return this._callbacks=this._callbacks||{},this._callbacks[a]||(this._callbacks[a]=[]),this._callbacks[a].push(b),this},a.prototype.emit=function(){var a,b,c,d,e,f;if(d=arguments[0],a=2<=arguments.length?i.call(arguments,1):[],this._callbacks=this._callbacks||{},c=this._callbacks[d])for(e=0,f=c.length;e<f;e++)b=c[e],b.apply(this,a);return this},a.prototype.removeListener=a.prototype.off,a.prototype.removeAllListeners=a.prototype.off,a.prototype.removeEventListener=a.prototype.off,a.prototype.off=function(a,b){var c,d,e,f;if(!this._callbacks||0===arguments.length)return this._callbacks={},this;if(!(c=this._callbacks[a]))return this;if(1===arguments.length)return delete this._callbacks[a],this;for(d=e=0,f=c.length;e<f;d=++e)if(c[d]===b){c.splice(d,1);break}return this},a}(),a=function(a){function c(a,b){var e,f,g;if(this.element=a,this.version=c.version,this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,""),this.clickableElements=[],this.listeners=[],this.files=[],"string"==typeof this.element&&(this.element=document.querySelector(this.element)),!this.element||null==this.element.nodeType)throw new Error("Invalid dropzone element.");if(this.element.dropzone)throw new Error("Dropzone already attached.");if(c.instances.push(this),this.element.dropzone=this,e=null!=(g=c.optionsForElement(this.element))?g:{},this.options=d({},this.defaultOptions,e,null!=b?b:{}),this.options.forceFallback||!c.isBrowserSupported())return this.options.fallback.call(this);if(null==this.options.url&&(this.options.url=this.element.getAttribute("action")),!this.options.url)throw new Error("No URL provided.");if(this.options.acceptedFiles&&this.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");this.options.acceptedMimeTypes&&(this.options.acceptedFiles=this.options.acceptedMimeTypes,delete this.options.acceptedMimeTypes),this.options.method=this.options.method.toUpperCase(),
(f=this.getExistingFallback())&&f.parentNode&&f.parentNode.removeChild(f),this.options.previewsContainer!==!1&&(this.options.previewsContainer?this.previewsContainer=c.getElement(this.options.previewsContainer,"previewsContainer"):this.previewsContainer=this.element),this.options.clickable&&(this.options.clickable===!0?this.clickableElements=[this.element]:this.clickableElements=c.getElements(this.options.clickable,"clickable")),this.init()}var d,e;return k(c,a),c.prototype.Emitter=b,c.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached","queuecomplete"],c.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,parallelUploads:2,uploadMultiple:!1,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120,filesizeBase:1e3,maxFiles:null,filesizeBase:1e3,params:{},clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,capture:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",accept:function(a,b){return b()},init:function(){return g},forceFallback:!1,fallback:function(){var a,b,d,e,f,g;for(this.element.className=this.element.className+" dz-browser-not-supported",g=this.element.getElementsByTagName("div"),e=0,f=g.length;e<f;e++)a=g[e],/(^| )dz-message($| )/.test(a.className)&&(b=a,a.className="dz-message");return b||(b=c.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(b)),d=b.getElementsByTagName("span")[0],d&&(d.textContent=this.options.dictFallbackMessage),this.element.appendChild(this.getFallbackForm())},resize:function(a){var b,c,d;return b={srcX:0,srcY:0,srcWidth:a.width,srcHeight:a.height},c=a.width/a.height,b.optWidth=this.options.thumbnailWidth,b.optHeight=this.options.thumbnailHeight,null==b.optWidth&&null==b.optHeight?(b.optWidth=b.srcWidth,b.optHeight=b.srcHeight):null==b.optWidth?b.optWidth=c*b.optHeight:null==b.optHeight&&(b.optHeight=1/c*b.optWidth),d=b.optWidth/b.optHeight,a.height<b.optHeight||a.width<b.optWidth?(b.trgHeight=b.srcHeight,b.trgWidth=b.srcWidth):c>d?(b.srcHeight=a.height,b.srcWidth=b.srcHeight*d):(b.srcWidth=a.width,b.srcHeight=b.srcWidth/d),b.srcX=(a.width-b.srcWidth)/2,b.srcY=(a.height-b.srcHeight)/2,b},drop:function(a){return this.element.classList.remove("dz-drag-hover")},dragstart:g,dragend:function(a){return this.element.classList.remove("dz-drag-hover")},dragenter:function(a){return this.element.classList.add("dz-drag-hover")},dragover:function(a){return this.element.classList.add("dz-drag-hover")},dragleave:function(a){return this.element.classList.remove("dz-drag-hover")},paste:g,reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(a){var b,d,e,f,g,h,i,j,k,l,m,n,o;if(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),this.previewsContainer){for(a.previewElement=c.createElement(this.options.previewTemplate.trim()),a.previewTemplate=a.previewElement,this.previewsContainer.appendChild(a.previewElement),l=a.previewElement.querySelectorAll("[data-dz-name]"),f=0,i=l.length;f<i;f++)b=l[f],b.textContent=a.name;for(m=a.previewElement.querySelectorAll("[data-dz-size]"),g=0,j=m.length;g<j;g++)b=m[g],b.innerHTML=this.filesize(a.size);for(this.options.addRemoveLinks&&(a._removeLink=c.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>"),a.previewElement.appendChild(a._removeLink)),d=function(b){return function(d){return d.preventDefault(),d.stopPropagation(),a.status===c.UPLOADING?c.confirm(b.options.dictCancelUploadConfirmation,function(){return b.removeFile(a)}):b.options.dictRemoveFileConfirmation?c.confirm(b.options.dictRemoveFileConfirmation,function(){return b.removeFile(a)}):b.removeFile(a)}}(this),n=a.previewElement.querySelectorAll("[data-dz-remove]"),o=[],h=0,k=n.length;h<k;h++)e=n[h],o.push(e.addEventListener("click",d));return o}},removedfile:function(a){var b;return a.previewElement&&null!=(b=a.previewElement)&&b.parentNode.removeChild(a.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(a,b){var c,d,e,f;if(a.previewElement){for(a.previewElement.classList.remove("dz-file-preview"),f=a.previewElement.querySelectorAll("[data-dz-thumbnail]"),d=0,e=f.length;d<e;d++)c=f[d],c.alt=a.name,c.src=b;return setTimeout(function(b){return function(){return a.previewElement.classList.add("dz-image-preview")}}(),1)}},error:function(a,b){var c,d,e,f,g;if(a.previewElement){for(a.previewElement.classList.add("dz-error"),"String"!=typeof b&&b.error&&(b=b.error),f=a.previewElement.querySelectorAll("[data-dz-errormessage]"),g=[],d=0,e=f.length;d<e;d++)c=f[d],g.push(c.textContent=b);return g}},errormultiple:g,processing:function(a){if(a.previewElement&&(a.previewElement.classList.add("dz-processing"),a._removeLink))return a._removeLink.textContent=this.options.dictCancelUpload},processingmultiple:g,uploadprogress:function(a,b,c){var d,e,f,g,h;if(a.previewElement){for(g=a.previewElement.querySelectorAll("[data-dz-uploadprogress]"),h=[],e=0,f=g.length;e<f;e++)d=g[e],"PROGRESS"===d.nodeName?h.push(d.value=b):h.push(d.style.width=b+"%");return h}},totaluploadprogress:g,sending:g,sendingmultiple:g,success:function(a){if(a.previewElement)return a.previewElement.classList.add("dz-success")},successmultiple:g,canceled:function(a){return this.emit("error",a,"Upload canceled.")},canceledmultiple:g,complete:function(a){if(a._removeLink&&(a._removeLink.textContent=this.options.dictRemoveFile),a.previewElement)return a.previewElement.classList.add("dz-complete")},completemultiple:g,maxfilesexceeded:g,maxfilesreached:g,queuecomplete:g,previewTemplate:'<div class="dz-preview dz-file-preview">\n  <div class="dz-image"><img data-dz-thumbnail /></div>\n  <div class="dz-details">\n    <div class="dz-size"><span data-dz-size></span></div>\n    <div class="dz-filename"><span data-dz-name></span></div>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n  <div class="dz-success-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Check</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <path d="M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" stroke-opacity="0.198794158" stroke="#747474" fill-opacity="0.816519475" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>\n      </g>\n    </svg>\n  </div>\n  <div class="dz-error-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Error</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <g id="Check-+-Oval-2" sketch:type="MSLayerGroup" stroke="#747474" stroke-opacity="0.198794158" fill="#FFFFFF" fill-opacity="0.816519475">\n          <path d="M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" sketch:type="MSShapeGroup"></path>\n        </g>\n      </g>\n    </svg>\n  </div>\n</div>'},d=function(){var a,b,c,d,e,f,g;for(d=arguments[0],c=2<=arguments.length?i.call(arguments,1):[],f=0,g=c.length;f<g;f++){b=c[f];for(a in b)e=b[a],d[a]=e}return d},c.prototype.getAcceptedFiles=function(){var a,b,c,d,e;for(d=this.files,e=[],b=0,c=d.length;b<c;b++)a=d[b],a.accepted&&e.push(a);return e},c.prototype.getRejectedFiles=function(){var a,b,c,d,e;for(d=this.files,e=[],b=0,c=d.length;b<c;b++)a=d[b],a.accepted||e.push(a);return e},c.prototype.getFilesWithStatus=function(a){var b,c,d,e,f;for(e=this.files,f=[],c=0,d=e.length;c<d;c++)b=e[c],b.status===a&&f.push(b);return f},c.prototype.getQueuedFiles=function(){return this.getFilesWithStatus(c.QUEUED)},c.prototype.getUploadingFiles=function(){return this.getFilesWithStatus(c.UPLOADING)},c.prototype.getActiveFiles=function(){var a,b,d,e,f;for(e=this.files,f=[],b=0,d=e.length;b<d;b++)a=e[b],a.status!==c.UPLOADING&&a.status!==c.QUEUED||f.push(a);return f},c.prototype.init=function(){var a,b,d,e,f,g,h;for("form"===this.element.tagName&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(c.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>")),this.clickableElements.length&&(d=function(a){return function(){return a.hiddenFileInput&&document.body.removeChild(a.hiddenFileInput),a.hiddenFileInput=document.createElement("input"),a.hiddenFileInput.setAttribute("type","file"),(null==a.options.maxFiles||a.options.maxFiles>1)&&a.hiddenFileInput.setAttribute("multiple","multiple"),a.hiddenFileInput.className="dz-hidden-input",null!=a.options.acceptedFiles&&a.hiddenFileInput.setAttribute("accept",a.options.acceptedFiles),null!=a.options.capture&&a.hiddenFileInput.setAttribute("capture",a.options.capture),a.hiddenFileInput.style.visibility="hidden",a.hiddenFileInput.style.position="absolute",a.hiddenFileInput.style.top="0",a.hiddenFileInput.style.left="0",a.hiddenFileInput.style.height="0",a.hiddenFileInput.style.width="0",document.body.appendChild(a.hiddenFileInput),a.hiddenFileInput.addEventListener("change",function(){var b,c,e,f;if(c=a.hiddenFileInput.files,c.length)for(e=0,f=c.length;e<f;e++)b=c[e],a.addFile(b);return d()})}}(this))(),this.URL=null!=(g=window.URL)?g:window.webkitURL,h=this.events,e=0,f=h.length;e<f;e++)a=h[e],this.on(a,this.options[a]);return this.on("uploadprogress",function(a){return function(){return a.updateTotalUploadProgress()}}(this)),this.on("removedfile",function(a){return function(){return a.updateTotalUploadProgress()}}(this)),this.on("canceled",function(a){return function(b){return a.emit("complete",b)}}(this)),this.on("complete",function(a){return function(b){if(0===a.getUploadingFiles().length&&0===a.getQueuedFiles().length)return setTimeout(function(){return a.emit("queuecomplete")},0)}}(this)),b=function(a){return a.stopPropagation(),a.preventDefault?a.preventDefault():a.returnValue=!1},this.listeners=[{element:this.element,events:{dragstart:function(a){return function(b){return a.emit("dragstart",b)}}(this),dragenter:function(a){return function(c){return b(c),a.emit("dragenter",c)}}(this),dragover:function(a){return function(c){var d;try{d=c.dataTransfer.effectAllowed}catch(a){}return c.dataTransfer.dropEffect="move"===d||"linkMove"===d?"move":"copy",b(c),a.emit("dragover",c)}}(this),dragleave:function(a){return function(b){return a.emit("dragleave",b)}}(this),drop:function(a){return function(c){return b(c),a.drop(c)}}(this),dragend:function(a){return function(b){return a.emit("dragend",b)}}(this)}}],this.clickableElements.forEach(function(a){return function(b){return a.listeners.push({element:b,events:{click:function(d){if(b!==a.element||d.target===a.element||c.elementInside(d.target,a.element.querySelector(".dz-message")))return a.hiddenFileInput.click()}}})}}(this)),this.enable(),this.options.init.call(this)},c.prototype.destroy=function(){var a;return this.disable(),this.removeAllFiles(!0),(null!=(a=this.hiddenFileInput)?a.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,c.instances.splice(c.instances.indexOf(this),1)},c.prototype.updateTotalUploadProgress=function(){var a,b,c,d,e,f,g,h;if(d=0,c=0,a=this.getActiveFiles(),a.length){for(h=this.getActiveFiles(),f=0,g=h.length;f<g;f++)b=h[f],d+=b.upload.bytesSent,c+=b.upload.total;e=100*d/c}else e=100;return this.emit("totaluploadprogress",e,c,d)},c.prototype._getParamName=function(a){return"function"==typeof this.options.paramName?this.options.paramName(a):this.options.paramName+(this.options.uploadMultiple?"["+a+"]":"")},c.prototype.getFallbackForm=function(){var a,b,d,e;return(a=this.getExistingFallback())?a:(d='<div class="dz-fallback">',this.options.dictFallbackText&&(d+="<p>"+this.options.dictFallbackText+"</p>"),d+='<input type="file" name="'+this._getParamName(0)+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>',b=c.createElement(d),"FORM"!==this.element.tagName?(e=c.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>'),e.appendChild(b)):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),null!=e?e:b)},c.prototype.getExistingFallback=function(){var a,b,c,d,e,f;for(b=function(a){var b,c,d;for(c=0,d=a.length;c<d;c++)if(b=a[c],/(^| )fallback($| )/.test(b.className))return b},f=["div","form"],d=0,e=f.length;d<e;d++)if(c=f[d],a=b(this.element.getElementsByTagName(c)))return a},c.prototype.setupEventListeners=function(){var a,b,c,d,e,f,g;for(f=this.listeners,g=[],d=0,e=f.length;d<e;d++)a=f[d],g.push(function(){var d,e;d=a.events,e=[];for(b in d)c=d[b],e.push(a.element.addEventListener(b,c,!1));return e}());return g},c.prototype.removeEventListeners=function(){var a,b,c,d,e,f,g;for(f=this.listeners,g=[],d=0,e=f.length;d<e;d++)a=f[d],g.push(function(){var d,e;d=a.events,e=[];for(b in d)c=d[b],e.push(a.element.removeEventListener(b,c,!1));return e}());return g},c.prototype.disable=function(){var a,b,c,d,e;for(this.clickableElements.forEach(function(a){return a.classList.remove("dz-clickable")}),this.removeEventListeners(),d=this.files,e=[],b=0,c=d.length;b<c;b++)a=d[b],e.push(this.cancelUpload(a));return e},c.prototype.enable=function(){return this.clickableElements.forEach(function(a){return a.classList.add("dz-clickable")}),this.setupEventListeners()},c.prototype.filesize=function(a){var b,c,d,e,f,g,h,i;for(g=["TB","GB","MB","KB","b"],d=e=null,c=h=0,i=g.length;h<i;c=++h)if(f=g[c],b=Math.pow(this.options.filesizeBase,4-c)/10,a>=b){d=a/Math.pow(this.options.filesizeBase,4-c),e=f;break}return"<strong>"+(d=Math.round(10*d)/10)+"</strong> "+e},c.prototype._updateMaxFilesReachedClass=function(){return null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")},c.prototype.drop=function(a){var b,c;a.dataTransfer&&(this.emit("drop",a),b=a.dataTransfer.files,b.length&&(c=a.dataTransfer.items,c&&c.length&&null!=c[0].webkitGetAsEntry?this._addFilesFromItems(c):this.handleFiles(b)))},c.prototype.paste=function(a){var b,c;if(null!=(null!=a&&null!=(c=a.clipboardData)?c.items:void 0))return this.emit("paste",a),b=a.clipboardData.items,b.length?this._addFilesFromItems(b):void 0},c.prototype.handleFiles=function(a){var b,c,d,e;for(e=[],c=0,d=a.length;c<d;c++)b=a[c],e.push(this.addFile(b));return e},c.prototype._addFilesFromItems=function(a){var b,c,d,e,f;for(f=[],d=0,e=a.length;d<e;d++)c=a[d],null!=c.webkitGetAsEntry&&(b=c.webkitGetAsEntry())?b.isFile?f.push(this.addFile(c.getAsFile())):b.isDirectory?f.push(this._addFilesFromDirectory(b,b.name)):f.push(void 0):null!=c.getAsFile&&(null==c.kind||"file"===c.kind)?f.push(this.addFile(c.getAsFile())):f.push(void 0);return f},c.prototype._addFilesFromDirectory=function(a,b){var c,d;return c=a.createReader(),d=function(a){return function(c){var d,e,f;for(e=0,f=c.length;e<f;e++)d=c[e],d.isFile?d.file(function(c){if(!a.options.ignoreHiddenFiles||"."!==c.name.substring(0,1))return c.fullPath=b+"/"+c.name,a.addFile(c)}):d.isDirectory&&a._addFilesFromDirectory(d,b+"/"+d.name)}}(this),c.readEntries(d,function(a){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log(a):void 0})},c.prototype.accept=function(a,b){return a.size>1024*this.options.maxFilesize*1024?b(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(a.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):c.isValidFile(a,this.options.acceptedFiles)?null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(b(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",a)):this.options.accept.call(this,a,b):b(this.options.dictInvalidFileType)},c.prototype.addFile=function(a){return a.upload={progress:0,total:a.size,bytesSent:0},this.files.push(a),a.status=c.ADDED,this.emit("addedfile",a),this._enqueueThumbnail(a),this.accept(a,function(b){return function(c){return c?(a.accepted=!1,b._errorProcessing([a],c)):(a.accepted=!0,b.options.autoQueue&&b.enqueueFile(a)),b._updateMaxFilesReachedClass()}}(this))},c.prototype.enqueueFiles=function(a){var b,c,d;for(c=0,d=a.length;c<d;c++)b=a[c],this.enqueueFile(b);return null},c.prototype.enqueueFile=function(a){if(a.status!==c.ADDED||a.accepted!==!0)throw new Error("This file can't be queued because it has already been processed or was rejected.");if(a.status=c.QUEUED,this.options.autoProcessQueue)return setTimeout(function(a){return function(){return a.processQueue()}}(this),0)},c.prototype._thumbnailQueue=[],c.prototype._processingThumbnail=!1,c.prototype._enqueueThumbnail=function(a){if(this.options.createImageThumbnails&&a.type.match(/image.*/)&&a.size<=1024*this.options.maxThumbnailFilesize*1024)return this._thumbnailQueue.push(a),setTimeout(function(a){return function(){return a._processThumbnailQueue()}}(this),0)},c.prototype._processThumbnailQueue=function(){if(!this._processingThumbnail&&0!==this._thumbnailQueue.length)return this._processingThumbnail=!0,this.createThumbnail(this._thumbnailQueue.shift(),function(a){return function(){return a._processingThumbnail=!1,a._processThumbnailQueue()}}(this))},c.prototype.removeFile=function(a){if(a.status===c.UPLOADING&&this.cancelUpload(a),this.files=h(this.files,a),this.emit("removedfile",a),0===this.files.length)return this.emit("reset")},c.prototype.removeAllFiles=function(a){var b,d,e,f;for(null==a&&(a=!1),f=this.files.slice(),d=0,e=f.length;d<e;d++)b=f[d],(b.status!==c.UPLOADING||a)&&this.removeFile(b);return null},c.prototype.createThumbnail=function(a,b){var c;return c=new FileReader,c.onload=function(d){return function(){return"image/svg+xml"===a.type?(d.emit("thumbnail",a,c.result),void(null!=b&&b())):d.createThumbnailFromUrl(a,c.result,b)}}(this),c.readAsDataURL(a)},c.prototype.createThumbnailFromUrl=function(a,b,c){var d;return d=document.createElement("img"),d.onload=function(b){return function(){var e,g,h,i,j,k,l,m;if(a.width=d.width,a.height=d.height,h=b.options.resize.call(b,a),null==h.trgWidth&&(h.trgWidth=h.optWidth),null==h.trgHeight&&(h.trgHeight=h.optHeight),e=document.createElement("canvas"),g=e.getContext("2d"),e.width=h.trgWidth,e.height=h.trgHeight,f(g,d,null!=(j=h.srcX)?j:0,null!=(k=h.srcY)?k:0,h.srcWidth,h.srcHeight,null!=(l=h.trgX)?l:0,null!=(m=h.trgY)?m:0,h.trgWidth,h.trgHeight),i=e.toDataURL("image/png"),b.emit("thumbnail",a,i),null!=c)return c()}}(this),null!=c&&(d.onerror=c),d.src=b},c.prototype.processQueue=function(){var a,b,c,d;if(b=this.options.parallelUploads,c=this.getUploadingFiles().length,a=c,!(c>=b)&&(d=this.getQueuedFiles(),d.length>0)){if(this.options.uploadMultiple)return this.processFiles(d.slice(0,b-c));for(;a<b;){if(!d.length)return;this.processFile(d.shift()),a++}}},c.prototype.processFile=function(a){return this.processFiles([a])},c.prototype.processFiles=function(a){var b,d,e;for(d=0,e=a.length;d<e;d++)b=a[d],b.processing=!0,b.status=c.UPLOADING,this.emit("processing",b);return this.options.uploadMultiple&&this.emit("processingmultiple",a),this.uploadFiles(a)},c.prototype._getFilesWithXhr=function(a){var b;return function(){var c,d,e,f;for(e=this.files,f=[],c=0,d=e.length;c<d;c++)b=e[c],b.xhr===a&&f.push(b);return f}.call(this)},c.prototype.cancelUpload=function(a){var b,d,e,f,g,h,i;if(a.status===c.UPLOADING){for(d=this._getFilesWithXhr(a.xhr),e=0,g=d.length;e<g;e++)b=d[e],b.status=c.CANCELED;for(a.xhr.abort(),f=0,h=d.length;f<h;f++)b=d[f],this.emit("canceled",b);this.options.uploadMultiple&&this.emit("canceledmultiple",d)}else(i=a.status)!==c.ADDED&&i!==c.QUEUED||(a.status=c.CANCELED,this.emit("canceled",a),this.options.uploadMultiple&&this.emit("canceledmultiple",[a]));if(this.options.autoProcessQueue)return this.processQueue()},e=function(){var a,b;return b=arguments[0],a=2<=arguments.length?i.call(arguments,1):[],"function"==typeof b?b.apply(this,a):b},c.prototype.uploadFile=function(a){return this.uploadFiles([a])},c.prototype.uploadFiles=function(a){var b,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L;for(w=new XMLHttpRequest,x=0,B=a.length;x<B;x++)b=a[x],b.xhr=w;p=e(this.options.method,a),u=e(this.options.url,a),w.open(p,u,!0),w.withCredentials=!!this.options.withCredentials,s=null,g=function(c){return function(){var d,e,f;for(f=[],d=0,e=a.length;d<e;d++)b=a[d],f.push(c._errorProcessing(a,s||c.options.dictResponseError.replace("{{statusCode}}",w.status),w));return f}}(this),t=function(c){return function(d){var e,f,g,h,i,j,k,l,m;if(null!=d)for(f=100*d.loaded/d.total,g=0,j=a.length;g<j;g++)b=a[g],b.upload={progress:f,total:d.total,bytesSent:d.loaded};else{for(e=!0,f=100,h=0,k=a.length;h<k;h++)b=a[h],100===b.upload.progress&&b.upload.bytesSent===b.upload.total||(e=!1),b.upload.progress=f,b.upload.bytesSent=b.upload.total;if(e)return}for(m=[],i=0,l=a.length;i<l;i++)b=a[i],m.push(c.emit("uploadprogress",b,f,b.upload.bytesSent));return m}}(this),w.onload=function(b){return function(d){var e;if(a[0].status!==c.CANCELED&&4===w.readyState){if(s=w.responseText,w.getResponseHeader("content-type")&&~w.getResponseHeader("content-type").indexOf("application/json"))try{s=JSON.parse(s)}catch(a){d=a,s="Invalid JSON response from server."}return t(),200<=(e=w.status)&&e<300?b._finished(a,s,d):g()}}}(this),w.onerror=function(b){return function(){if(a[0].status!==c.CANCELED)return g()}}(),r=null!=(G=w.upload)?G:w,r.onprogress=t,j={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"},this.options.headers&&d(j,this.options.headers);for(h in j)i=j[h],w.setRequestHeader(h,i);if(f=new FormData,this.options.params){H=this.options.params;for(o in H)v=H[o],f.append(o,v)}for(y=0,C=a.length;y<C;y++)b=a[y],this.emit("sending",b,w,f);if(this.options.uploadMultiple&&this.emit("sendingmultiple",a,w,f),"FORM"===this.element.tagName)for(I=this.element.querySelectorAll("input, textarea, select, button"),z=0,D=I.length;z<D;z++)if(l=I[z],m=l.getAttribute("name"),n=l.getAttribute("type"),"SELECT"===l.tagName&&l.hasAttribute("multiple"))for(J=l.options,A=0,E=J.length;A<E;A++)q=J[A],q.selected&&f.append(m,q.value);else(!n||"checkbox"!==(K=n.toLowerCase())&&"radio"!==K||l.checked)&&f.append(m,l.value);for(k=F=0,L=a.length-1;0<=L?F<=L:F>=L;k=0<=L?++F:--F)f.append(this._getParamName(k),a[k],a[k].name);return w.send(f)},c.prototype._finished=function(a,b,d){var e,f,g;for(f=0,g=a.length;f<g;f++)e=a[f],e.status=c.SUCCESS,this.emit("success",e,b,d),this.emit("complete",e);if(this.options.uploadMultiple&&(this.emit("successmultiple",a,b,d),this.emit("completemultiple",a)),this.options.autoProcessQueue)return this.processQueue()},c.prototype._errorProcessing=function(a,b,d){var e,f,g;for(f=0,g=a.length;f<g;f++)e=a[f],e.status=c.ERROR,this.emit("error",e,b,d),this.emit("complete",e);if(this.options.uploadMultiple&&(this.emit("errormultiple",a,b,d),this.emit("completemultiple",a)),this.options.autoProcessQueue)return this.processQueue()},c}(b),a.version="4.0.1",a.options={},a.optionsForElement=function(b){return b.getAttribute("id")?a.options[c(b.getAttribute("id"))]:void 0},a.instances=[],a.forElement=function(a){if("string"==typeof a&&(a=document.querySelector(a)),null==(null!=a?a.dropzone:void 0))throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return a.dropzone},a.autoDiscover=!0,a.discover=function(){var b,c,d,e,f,g;for(document.querySelectorAll?d=document.querySelectorAll(".dropzone"):(d=[],b=function(a){var b,c,e,f;for(f=[],c=0,e=a.length;c<e;c++)b=a[c],/(^| )dropzone($| )/.test(b.className)?f.push(d.push(b)):f.push(void 0);return f},b(document.getElementsByTagName("div")),b(document.getElementsByTagName("form"))),g=[],e=0,f=d.length;e<f;e++)c=d[e],a.optionsForElement(c)!==!1?g.push(new a(c)):g.push(void 0);return g},a.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i],a.isBrowserSupported=function(){var b,c,d,e,f;if(b=!0,window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a"))for(f=a.blacklistedBrowsers,d=0,e=f.length;d<e;d++)c=f[d],c.test(navigator.userAgent)&&(b=!1);else b=!1;else b=!1;return b},h=function(a,b){var c,d,e,f;for(f=[],d=0,e=a.length;d<e;d++)(c=a[d])!==b&&f.push(c);return f},c=function(a){return a.replace(/[\-_](\w)/g,function(a){return a.charAt(1).toUpperCase()})},a.createElement=function(a){var b;return b=document.createElement("div"),b.innerHTML=a,b.childNodes[0]},a.elementInside=function(a,b){if(a===b)return!0;for(;a=a.parentNode;)if(a===b)return!0;return!1},a.getElement=function(a,b){var c;if("string"==typeof a?c=document.querySelector(a):null!=a.nodeType&&(c=a),null==c)throw new Error("Invalid `"+b+"` option provided. Please provide a CSS selector or a plain HTML element.");return c},a.getElements=function(a,b){var c,d,e,f,g,h,i;if(a instanceof Array){d=[];try{for(e=0,g=a.length;e<g;e++)c=a[e],d.push(this.getElement(c,b))}catch(a){a,d=null}}else if("string"==typeof a)for(d=[],i=document.querySelectorAll(a),f=0,h=i.length;f<h;f++)c=i[f],d.push(c);else null!=a.nodeType&&(d=[a]);if(null==d||!d.length)throw new Error("Invalid `"+b+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return d},a.confirm=function(a,b,c){return window.confirm(a)?b():null!=c?c():void 0},a.isValidFile=function(a,b){var c,d,e,f,g;if(!b)return!0;for(b=b.split(","),d=a.type,c=d.replace(/\/.*$/,""),f=0,g=b.length;f<g;f++)if(e=b[f],e=e.trim(),"."===e.charAt(0)){if(a.name.toLowerCase().indexOf(e.toLowerCase(),a.name.length-e.length)!==-1)return!0}else if(/\/\*$/.test(e)){if(c===e.replace(/\/.*$/,""))return!0}else if(d===e)return!0;return!1},"undefined"!=typeof jQuery&&null!==jQuery&&(jQuery.fn.dropzone=function(b){return this.each(function(){return new a(this,b)})}),"undefined"!=typeof module&&null!==module?module.exports=a:window.Dropzone=a,a.ADDED="added",a.QUEUED="queued",a.ACCEPTED=a.QUEUED,a.UPLOADING="uploading",a.PROCESSING=a.UPLOADING,a.CANCELED="canceled",a.ERROR="error",a.SUCCESS="success",e=function(a){var b,c,d,e,f,g,h,i,j;for(a.naturalWidth,g=a.naturalHeight,c=document.createElement("canvas"),c.width=1,c.height=g,d=c.getContext("2d"),d.drawImage(a,0,0),e=d.getImageData(0,0,1,g).data,j=0,f=g,h=g;h>j;)b=e[4*(h-1)+3],0===b?f=h:j=h,h=f+j>>1;return i=h/g,0===i?1:i},f=function(a,b,c,d,f,g,h,i,j,k){var l;return l=e(b),a.drawImage(b,c,d,f,g,h,i,j,k/l)},d=function(a,b){var c,d,e,f,g,h,i,j,k;if(e=!1,k=!0,d=a.document,j=d.documentElement,c=d.addEventListener?"addEventListener":"attachEvent",i=d.addEventListener?"removeEventListener":"detachEvent",h=d.addEventListener?"":"on",f=function(c){if("readystatechange"!==c.type||"complete"===d.readyState)return("load"===c.type?a:d)[i](h+c.type,f,!1),!e&&(e=!0)?b.call(a,c.type||c):void 0},g=function(){try{j.doScroll("left")}catch(a){return a,void setTimeout(g,50)}return f("poll")},"complete"!==d.readyState){if(d.createEventObject&&j.doScroll){try{k=!a.frameElement}catch(a){}k&&g()}return d[c](h+"DOMContentLoaded",f,!1),d[c](h+"readystatechange",f,!1),a[c](h+"load",f,!1)}},a._autoDiscoverFunction=function(){if(a.autoDiscover)return a.discover()},d(window,a._autoDiscoverFunction)}.call(this),define("dropzone",function(a){return function(){return a.Dropzone}}(this)),define("general.components/media-library/update/media-update",["jquery","qvangular","translator","text!general.components/media-library/update/media-update.ng.html","text!general.components/media-library/update/preview-item.ng.html","general.models/media-library","core.models/app","xsrfplugin","general.utils/dom-util","general.controllers/error-handler-controller","dropzone","core.utils/deferred","util","general.components/context-menu/context-menu-service"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";function n(a,b){b.getContentLibraries().then(function(b){var d=f.getRemainingSpace(b)/1024/1024;d=d.toString().split("e"),d=Math.floor(+(d[0]+"e"+(d[1]?+d[1]+1:1))),d=d.toString().split("e"),d=+(d[0]+"e"+(d[1]?+d[1]-1:-1)),a.quotaInfo=c.get("MediaLibrary.QuotaInfo",[d])})}function o(a,b,c){return g.get().then(function(d){var e={params:{externalpath:c,xrfkey:p},headers:{"X-Qlik-XrfKey":p}},f=m.basePath+"qrs/appcontent/"+d.id+"/deletecontent";return b.delete(f,e).success(function(){n(a,d)}).error(function(a,b){var c=b;0===b&&(c=500),j.showDialog({code:c})})})}var p=h.getRandomString(16);b.directive("qvMediaUpdate",function(){return{restrict:"E",replace:!0,scope:{updateExp:"=",selectedFile:"=",selectFile:"&",confirm:"&"},template:d,controller:["$scope","$element","$compile","$timeout","$http","$delayedModal","qvContextMenu",function(b,d,f,h,j,q,r){function s(c,d){var e=b.$new()
;e.file=d,f(a(c))(e)}function t(a,d,e,f){var g=new l,h=e.split("\\").splice(-1)[0];return b.updateExp.deleteDialogShown=!0,q.open({title:"MediaLibrary.Confirm.Delete.Title",content:c.get("MediaLibrary.Confirm.Delete.Description",[h]),buttons:[{name:"Common.Cancel",callback:function(){b.updateExp.deleteDialogShown=!1,g.reject()}},{name:"Common.Delete",defaultButton:!0,callback:function(){o(b,j,e).then(function(){b.selectedFile===f&&b.selectFile()(a,null,null),d&&u.removeFile(d),g.resolve()},function(){g.reject()}),b.updateExp.deleteDialogShown=!1}}]}),g.promise}var u;b.isEmpty=!0,b.previewCounter=0,k.autoDiscover=!1,k.confirm=function(a,b,c){if(null!=c)return c()},b.updateExp.deleteFile=function(a,b,c){for(var d=u.getFilesWithStatus(k.SUCCESS),e=null,f=0;f<d.length;f++)if(b===d[f].name){e=d[f];break}return t(a,e,b,c)},b.onCancelUpload=function(a,b){a.preventDefault(),a.stopPropagation(),u.cancelUpload(b)},b.onDelete=function(a,b,c,d){a.preventDefault(),a.stopPropagation(),t(a,b,c,d)},b.onInsert=function(a){a.preventDefault(),a.stopPropagation(),b.confirm()()},b.onSelectImage=function(c,d){if(i.scrollElmentIntoView(a(d.previewElement),".media-library-preview-container",!1,!0),d.status!==k.SUCCESS)return c.preventDefault(),void c.stopPropagation();b.selectFile()(c,d.qUrl,d.qUrlDef)},b.onContextMenu=function(a,c,d,e){if(a.preventDefault(),a.stopPropagation(),c.status===k.SUCCESS){var f=r.menu();b.updateExp.isUploading||f.addItem({translation:"MediaLibrary.Insert",tid:"insert",select:function(){b.selectedFile!==c.qUrl&&b.selectFile()(a,c.qUrl,c.qUrlDef),b.onInsert(a)}}),f.addItem({translation:"Common.Delete",tid:"delete",select:function(){b.onDelete(a,c,d,e)}}),r.show(f,{position:{x:a.pageX,y:a.pageY},docking:"BottomRight"})}},g.get().then(function(d){var f=m.basePath+"qrs/appcontent/"+d.id+"/uploadfile?",g="/appcontent/"+d.id+"/";n(b,d),u=new k("#media-library-dropzone",{url:f,headers:{"X-Qlik-XrfKey":p},acceptedFiles:".png,.gif,.jpg,.jpeg",maxFilesize:5,parallelUploads:4,filesizeBase:1024,thumbnailWidth:200,thumbnailHeight:200,previewTemplate:e,previewsContainer:".media-library-preview-container",dictInvalidFileType:c.get("ErrorCode.3004"),dictFileTooBig:c.get("MediaLibrary.Error.MaxFileSizeExceeded"),dictResponseError:c.get("ErrorCode.500")}),u.on("processing",function(a){this.options.url=f+"externalpath="+encodeURIComponent(a.name)+"&overwrite=false&xrfkey="+p}),u.on("addedfile",function(c){s(c.previewElement,c),h(function(){b.isEmpty=!1,b.previewCounter++,b.updateExp.isUploading=!0,i.scrollElmentIntoView(a(c.previewElement),".media-library-preview-container",!1,!0);try{encodeURIComponent(c.name)}catch(a){c.qErrorMsg="MediaLibrary.Error.IllegalCharsInFilename",u.cancelUpload(c)}})}),u.on("removedfile",function(){h(function(){0===--b.previewCounter&&(b.isEmpty=!0)})}),u.on("success",function(a){a.qUrl=g+encodeURIComponent(a.name).replace(/[!'()*]/g,function(a){return"%"+a.charCodeAt(0).toString(16).toUpperCase()}),a.qUrlDef=g+a.name,n(b,d)}),u.on("queuecomplete",function(){h(function(){b.updateExp.isUploading=!1})}),u.on("error",function(b,d,e){var f=a(b.previewElement).scope();f.showError=!0,e&&e.status?409===e.status?f.errorMsg=c.get("MediaLibrary.Error.FileAlreadyExists"):413===e.status?f.errorMsg=c.get("MediaLibrary.Error.MaxFileSizeExceeded"):f.errorMsg=c.get("ErrorCode."+e.status):f.errorMsg=c.get(b.qErrorMsg?b.qErrorMsg:d)})}),b.$on("$destroy",function(){u.destroy(),b.updateExp.deleteDialogShown&&q.close()})}]}})}),define("general.components/media-library/media-library",["jquery","qvangular","require","core.models/app","general.models/media-library","general.utils/paths","text!./media-library.ng.html","text!./media-library-grid.ng.html","text!./media-library-list.ng.html","text!general.services/loader/default-loader.ng.html","general.services/show-service/show-service","general.utils/dom-util","general.views/bouncy-grid/bouncy-grid","general.components/media-library/update/media-update","general.components/context-menu/context-menu-service"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a){var b={onCancel:a.onCancel,onConfirm:a.onConfirm,selectedFile:a.selectedFile,filter:["png","gif","jpg","jpeg"]};k.show(q,b),p.isShown=!0}function n(){if(p.isShown){var b=a('[qv-id="media-library-modal"]');b.length&&b.scope().cancel(null,!0)}}function o(){return p.isShown}var p={isShown:!1};b.directive("qveMediaList",function(){return{replace:!0,restrict:"E",template:i}}),b.directive("qveMediaGrid",function(){return{replace:!0,restrict:"E",template:h}});var q={template:g,controller:["$scope","$element","qvLoader","qvContextMenu",function(b,g,h,i){function k(a){clearTimeout(r),h.close(a)}function m(a,c){a=a||null,c=c||null,b.selectedFile=a,b.selectedFileDef=c}function n(){var a=b.view;d.get().then(function(c){c.getLibraryContent(b.view).then(function(c){var d=e.createTree(c,b.input.filter,!0);b.rootEntry=d,a===b.view&&(h.isOpen()?h.close().then(function(){b.state=d.children.length>0?u.hasFiles:u.isEmpty}):(clearTimeout(r),b.state=d.children.length>0?u.hasFiles:u.isEmpty))})})}function o(a){return a.split("/").slice(3).join("\\")}function q(a){n(),b.input.selectedFile&&a===b.input.selectedFile&&(t=!0)}var r,s=c.toUrl("img/medialibrary/thumb.png"),t=!1,u={notReady:0,isLoading:1,isEmpty:2,hasFiles:3};b.inZoom=!1,b.firstTimeRenderCheck=!0,b.lists=[],b.selectedFile=null,b.contentState=u,b.state=u.notReady,b.view=null,s=f.stripBasePath(s),s=f.addBasePath(s),b.staticSrc=s,b.updateExp={},b.getSrc=function(a){return a=f.stripBasePath(a),a=f.addBasePath(a)},b.zoomImage=function(a,c){a.preventDefault(),a.stopPropagation(),b.zoomSrc=c.path,b.inZoom=!0},b.closeZoom=function(){b.inZoom=!1,b.zoomSrc=null},b.goTo=function(a,c){var d;b.view!==a&&(m(null,null),k(!0),b.state=u.notReady,b.isUpload=c,b.view=a,b.isUpload||(r=setTimeout(function(){b.state=u.isLoading,h.show({template:j,messageObj:{task:"MediaLibrary.LoadingFiles"},appendTo:g.find(".medialib")[0],bigLoader:!0})},1e3),d=g.find(".q-images-cont"),d.length&&(d[0].scrollTop=0),n(),b.firstTimeRenderCheck=!0,d=null))},b.isSelectedImg=function(a,c,d){return c&&b.firstTimeRenderCheck&&d&&setTimeout(function(){var a=g.find(d);b.firstTimeRenderCheck=!1,a.length&&l.scrollElmentIntoView(a,".q-images-cont",!0),a=null},250),b.selectedFile===a.path},b.selectFile=function(c,d,e){var f=a(c.target).closest(".q-media-grid, .qui-menu-item");c.preventDefault(),c.stopPropagation(),l.scrollElmentIntoView(f,".q-images-cont",!1),b.selectedFile===d&&(d=null,e=null),f=null,m(d,e)},b.confirm=function(){b.selectedFile&&!b.updateExp.isUploading&&(b.input.onConfirm(b.selectedFile,b.selectedFileDef),b.destroyComponent())},b.inInAppView=function(){return b.view===b.lists[0].qName},b.canDeleteInView=function(){return b.inInAppView()&&b.canUpdate},b.onDelete=function(a){var c=b.selectedFile,d=o(b.selectedFileDef);a.preventDefault(),a.stopPropagation(),b.updateExp.deleteFile(a,d,b.selectedFile).then(function(){q(c)})},b.onContextMenu=function(c){c.preventDefault(),c.stopPropagation();var d=i.menu();b.updateExp.isUploading||d.addItem({translation:"MediaLibrary.Insert",tid:"insert",select:function(){var d=a(c.target).closest(".qui-menu-item").scope().entry;m(d.path,d.pathDef),b.confirm()}}),b.canDeleteInView()&&d.addItem({translation:"Common.Delete",tid:"delete",select:function(){var d=a(c.target).closest(".qui-menu-item").scope().entry,e=d.path,f=o(d.pathDef);b.updateExp.deleteFile(c,f,d.path).then(function(){q(e)})}}),i.show(d,{position:{x:c.pageX,y:c.pageY},docking:"BottomRight"})},b.cancel=function(a,c){if(a&&(a.preventDefault(),a.stopPropagation()),!c){if(b.inZoom)return void b.closeZoom();if(b.updateExp.deleteDialogShown)return void(b.updateExp.deleteDialogShown=!1)}!c&&b.updateExp.isUploading||(b.input.onCancel(t),b.destroyComponent())},d.get().then(function(a){a.getContentLibraries().then(function(a){b.lists=e.filterList(a),!b.view&&b.lists.length&&(b.view=b.lists[0].qName,n()),b.canUpdate=!b.$root.isPersonalMode&&!!e.canUpdate})}),b.$watch("updateExp.isUploading",function(a){a===!1&&b.inInAppView()&&n()}),b.$on("$destroy",function(){p.isShown=!1,b.closeZoom(),k(!0)})}]};return{show:m,hide:n,isShown:o}}),define("general.services/media-library/media-library",["general.components/media-library/media-library"],function(a){function b(b){a.show(b)}function c(){a.hide()}function d(){return a.isShown()}return{show:b,hide:c,isShown:d}}),define("text!client.services/media-tool/font-size-foldout.ng.html",[],function(){return'<lui-popover class="qv-toolbar-fontsize-foldout" ng-if="input.foldouts.fontSizes" qva-activate="openFontsizeFoldout" style="min-width: 40px; width: 44px;" qva-outside-ignore-for="media-toolbar">\n\t<lui-popover-body class="lui-popover__body--nopad" collision="\'flipfit\'">\n\t\t<ul class="lui-list lui-list--inverse qv-media-tool-fontsize">\n\t\t\t<button class="lui-fade-button lui-fade-button--inverse lui-fade-button--large" style="border-bottom: 1px solid rgba(0, 0, 0, 0.3);" ng-repeat="size in input.fontSizes" qva-activate="input.setFontSize($event, size)" ng-class="{\'lui-active\':input.textTool.fontSize == size}">\n\t\t\t\t<span class="lui-list__text lui-list__action" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">{{input.shortFontSize(size)}}</span>\n\t\t\t</button>\n\t\t</ul>\n\t</lui-popover-body>\n</lui-popover>\n\n\n'}),define("text!client.services/media-tool/media-tool-buttons.ng.html",[],function(){return'<div>\n\t<div ng-if="textTool.showUsage" class="usage"><span q-translation="MediaTool.YouHaveUsed"></span> <span>{{textTool.usage}}%</span></div>\n\n\t<div class="lui-buttongroup" ng-show="buttons.color">\n\t\t<div id="qv-toolbar-colorpicker" tid="colorpicker" q-title-translation="MediaTool.Toolbar.FontColor">\n\t\t\t<button qv-color-picker-button style="width: 66px;" class="lui-fade-button lui-fade-button--large lui-fade-button--inverse no-border-radius" ng-click="onClick($event, \'inverse\')" x-variant="inverse" on-close="closecolorpickerfoldout" ng-model="color" ng-disabled="!haveSelection()"></button>\n\t\t</div>\n\t</div><div class="lui-buttongroup" ng-show="buttons.fontSize">\n\n\t\t<button id="qv-toolbar-fontsize" style="width: 66px" qva-activate="openFontsizeFoldout()" tid="fontSize" ng-disabled="!haveSelection()"\n\t\t\t\tng-class="{\'lui-active\':foldouts.fontSizes}" q-title-translation="MediaTool.Toolbar.FontSize" class="lui-fade-button lui-fade-button--large lui-fade-button--inverse">\n\t\t\t<span class="lui_button__text">{{shortFontSize(textTool.fontSize)}}</span><span class="lui-button__caret  lui-caret"></span>\n\t\t</button>\n\t</div><div class="lui-buttongroup" ng-show="buttonGroup1">\n\t\t<button ng-class="{\'lui-active\':textTool.states.bold}" style="border-right: 1px solid rgba(0, 0, 0, 0.3);" ng-show="buttons.bold" tid="bold" ng-disabled="!haveSelection()"\n\t\t\t q-title-translation="MediaTool.Toolbar.Bold" class="lui-fade-button lui-fade-button--large lui-fade-button--inverse no-border-radius" qva-press="exec($event,\'bold\')">\n\t\t\t<span class="lui-fade-button__icon  lui-icon  lui-icon--bold"></span>\n\t\t</button>\n\t\t<button ng-class="{\'lui-active\':textTool.states.italic}" style="border-right: 1px solid rgba(0, 0, 0, 0.3);"  ng-show="buttons.italic" tid="italic" ng-disabled="!haveSelection()"\n\t\t\t q-title-translation="MediaTool.Toolbar.Italic" class="lui-fade-button lui-fade-button--large lui-fade-button--inverse no-border-radius" qva-press="exec($event,\'italic\')">\n\t\t\t<span class="lui-fade-button__icon  lui-icon  lui-icon--italic"></span>\n\t\t</button>\n\t\t<button ng-class="{\'lui-active\':textTool.states.underline}" ng-show="buttons.underline" tid="underline" ng-disabled="!haveSelection()"\n\t\t\t q-title-translation="MediaTool.Toolbar.Underline" class="lui-fade-button lui-fade-button--large lui-fade-button--inverse no-border-radius" qva-press="exec($event,\'underline\')">\n\t\t\t<span class="lui-fade-button__icon  lui-icon  lui-icon--underline"></span>\n\t\t</button>\n\t</div><div class="lui-buttongroup" ng-show="buttonGroup2">\n\t\t<button ng-class="{\'lui-active\':textTool.states.justifyLeft}" ng-show="buttons.justifyLeft" tid="justifyLeft"\n\t\t\t\tclass="lui-fade-button lui-fade-button--large lui-fade-button--inverse no-border-radius" q-title-translation="Common.Text.AlignLeft" qva-activate="exec($event,\'justifyLeft\')">\n\t\t\t<span class="lui-fade-button__icon  lui-icon  lui-icon--align-left"></span>\n\t\t</button>\n\t\t<button ng-class="{\'lui-active\':textTool.states.justifyCenter}" ng-show="buttons.justifyCenter" tid="justifyCenter"\n\t\t\t\tclass="lui-fade-button lui-fade-button--large lui-fade-button--inverse no-border-radius" q-title-translation="Common.Text.AlignCenter" qva-activate="exec($event,\'justifyCenter\')">\n\t\t\t<span class="lui-fade-button__icon  lui-icon  lui-icon--align-center"></span>\n\t\t</button>\n\t\t<button ng-class="{\'lui-active\':textTool.states.justifyRight}" ng-show="buttons.justifyRight" tid="justifyRight"\n\t\t\t\tclass="lui-fade-button lui-fade-button--large lui-fade-button--inverse no-border-radius" q-title-translation="Common.Text.AlignRight" qva-activate="exec($event,\'justifyRight\')">\n\t\t\t<span class="lui-fade-button__icon  lui-icon  lui-icon--align-right"></span>\n\t\t</button>\n\t</div><div class="lui-buttongroup" ng-show="buttons.link">\n\t\t<button id="qv-toolbar-link" qva-activate="openLinkFoldout($event)" style="width: 66px;" tid="link"\n\t\t\t\tclass="lui-fade-button lui-fade-button--large lui-fade-button--inverse no-border-radius" ng-class="{\'lui-active\':foldouts.link}" q-title-translation="{{ textTool.states.link ? \'MediaTool.Toolbar.EditURLLink\' : \'MediaTool.Toolbar.CreateURLLink\' }}"\n\t\t\t\tng-disabled="linkDisabled()">\n\t\t\t<span class="lui-fade-button__icon  lui-icon  lui-icon--link" ng-class="{\'lui-active\':textTool.states.link}"></span><span class="lui-button__caret  lui-caret"></span>\n\t\t</button>\n\t</div><div class="lui-buttongroup" ng-show="buttons.image">\n\t\t<button id="qv-toolbar-image" qva-activate="openMediaLibrary($event)" ng-class="{\'lui-active\':foldouts.mediaLibrary}" tid="image"\n\t\t\t\tclass="lui-fade-button lui-fade-button--large lui-fade-button--inverse no-border-radius" q-title-translation="MediaTool.Toolbar.InsertImage">\n\t\t\t<span class="lui-fade-button__icon  lui-icon  lui-icon--image"></span>\n\t\t</button>\n\t</div>\n</div>\n'}),define("client.services/media-tool/media-tool-buttons",["qvangular","text!./media-tool-buttons.ng.html"],function(a,b){a.directive("qvMediaToolButtons",function(){return{restrict:"A",replace:!0,template:b}})}),define("client.services/media-tool/toolbar",["jquery","touche","text!./toolbar.ng.html","client.services/media-tool/theme","client.services/media-tool/text-selection","client.services/media-tool/link-foldout/link-foldout","general.services/media-library/media-library","general.services/show-service/show-service","text!./font-size-foldout.ng.html","client.services/media-tool/media-tool-buttons"],function(a,b,c,d,e,f,g,h,i){var j,k=d.palette,l=d.fontSizes,m={fontSizes:!1,link:!1,mediaLibrary:!1,colorpicker:!1},n={color:!0,fontSize:!0,bold:!0,italic:!0,underline:!0,justifyLeft:!0,justifyCenter:!0,justifyRight:!0,link:!0,image:!0};return{template:c,scope:{textTool:"=",options:"=",alignTo:"="},controller:["$scope","$timeout","luiPopover",function(c,o,p){c.palette=k,c.fontSizes=Object.keys(l),c.foldouts=m,"all"===c.options.buttons?(c.buttons=n,c.buttonGroup1=!0,c.buttonGroup2=!0):"object"==typeof c.options.buttons&&(c.buttons=c.options.buttons,c.buttonGroup1=c.buttons.bold||c.buttons.italic||c.buttons.underline,c.buttonGroup2=c.buttons.justifyLeft||c.buttons.justifyCenter||c.buttons.justifyRight),c.exec=function(a,d){a.preventDefault(),a.stopPropagation(),b.preventGestures(),0===d.indexOf("justify")?c.textTool.setJustify(d):c.haveSelection()&&c.textTool.setBIU(d)},c.setActiveFoldout=function(a){Object.keys(c.foldouts).forEach(function(b){b===a&&c.foldouts[b]?c.foldouts[b]=!1:c.foldouts[b]=b===a})},c.shortFontSize=function(a){return l[a]||a},c.openMediaLibrary=function(){c.textTool.saveRange(),c.setActiveFoldout("mediaLibrary"),g.show({onCancel:function(){c.setActiveFoldout(),c.textTool.restoreRange(),c.textTool.focus()},onConfirm:function(a,b){c.setActiveFoldout(),o(function(){b?c.textTool.insertImage(a,b):(c.textTool.restoreRange(),c.textTool.focus())},100)},selectedFile:null})},c.closeColorpickerFoldout=function(d){a(d.target).closest("#qv-toolbar-colorpicker").length&&b.preventGestures(),c.setActiveFoldout()},c.openFontsizeFoldout=function(){if(c.foldouts.fontSizes&&j)return j.close(),void(j=null);j=p.show({template:i,input:{foldouts:c.foldouts,fontSizes:c.fontSizes,textTool:c.textTool,shortFontSize:c.shortFontSize,setFontSize:c.setFontSize,closeFontsizeFoldout:c.closeFontsizeFoldout},alignTo:a("#qv-toolbar-fontsize")[0],variant:"inverse",closeOnEscape:!0,autoFocus:!1}),c.setActiveFoldout("fontSizes"),j.closing.then(function(d){d&&a(d.target).closest("#qv-toolbar-fontsize").length&&b.preventGestures(),c.setActiveFoldout()}),j.closed.then(function(){j=null})};var q=null;c.openLinkFoldout=function(){var b,d=c.textTool.currentRange,g={};d&&(b=a(d.commonAncestorContainer).closest("a"),b.length&&(g.url=b.attr("href"),g.bookmark=b.attr("data-bookmark-id"),g.$node=b),c.textTool.saveRange(),q=h.show(f,{options:{toolbarScope:c,alignTo:a("#qv-toolbar-link"),link:g,onSave:function(a,b,d,e){var f;d?(f=document.createRange(),f.setStartBefore(d[0]),f.setEndAfter(d[0]),c.textTool.insertLink(b,f,e)):o(function(){c.textTool.insertLink(b,null,e)}),c.closeLinkFoldout(a)},onCancel:function(a){c.closeLinkFoldout(a)},onRemove:function(a,b){if(b){var d=e.createRangeForElement(b[0]);c.textTool.removeLink(d)}c.closeLinkFoldout(a)}}}),c.setActiveFoldout("link"))},c.setFontSize=function(a,b){a.preventDefault(),c.setActiveFoldout(),c.textTool.setFontSize(b),j&&(j.close(),j=null)},c.closeLinkFoldout=function(d){d&&a(d.target).closest("#qv-toolbar-link").length&&b.preventGestures(),c.setActiveFoldout(),q&&(q.destroy(),q=null)},c.linkDisabled=function(){var a=c.textTool.currentRange;return!!!c.textTool.states.link&&(!a||a.collapsed)},c.haveSelection=function(){var a=c.textTool.currentRange;return!(!a||a.collapsed)},Object.defineProperty(c,"color",{get:function(){return c.haveSelection()?d.palette.indexOf(c.textTool.color):d.palette[10]},set:function(a){c.textTool.setColor(d.palette[a])}}),c.$on("$destroy",function(){c.setActiveFoldout(),q&&(q.destroy(),q=null)}),o(function(){c.textTool.refreshState()})}]}}),define("client.services/media-tool/command-queue",[],function(){var a=function(){this.queue=[]};return a.prototype.push=function(a){this.queue.push(a)},a.prototype.execAll=function(a){this.queue.forEach(a)},a.prototype.remove=function(a){var b,c,d=!1;for(b=this.queue.length-1;b>=0;b--)c=this.queue[b],c.cmd===a&&(d=!0,this.queue.splice(b,1));return d},a.prototype.clear=function(){this.queue=[]},a}),define("client.services/media-tool/feature-detection",["angular","client.services/media-tool/text-selection"],function(a,b){var c=a.element("<div contenteditable style='position:absolute;top: -999999px;'>")[0];return{usesAlign:function(a,d){var e=document.activeElement;return document.body.appendChild(c),c.innerHTML="Feature detection.",c.focus(),b.addRange(b.createRange(c),!0),document.execCommand(a,!1,d),document.activeElement=e,document.body.removeChild(c),c.innerHTML}("justifyCenter").indexOf(" align=")>-1}}),define("client.utils/rtl/direction-service",["client.models/app-generic-props-wrapper","core.utils/notification"],function(a,b){"use strict";function c(a){d.setRtl(a.rtl)}var d={},e=!1,f="ltr",g=!1;return b.mixin(d),d.notification("DirectionChanged"),d.init=function(){return a.getProperties().then(function(a){return g=!0,d.setRtl(a&&a.rtl)})},d.setRtl=function(a){return e!==a&&(e=a,f=e?"rtl":"ltr",d.DirectionChanged.emit(f)),f},Object.defineProperty(d,"isInit",{get:function(){return g}}),Object.defineProperty(d,"isRtl",{get:function(){return e}}),Object.defineProperty(d,"direction",{get:function(){return f}}),a.UpdateObjProps.bind(c),d}),define("client.services/media-tool/markdown-html-parser",["util"],function(a){function b(){var b=g.formatters.map(function(b){return b.character?a.escapeRegExp(b.character):""}),c="("+b.join("|")+"){1}\\[",d="((?![\\s\\S]*?"+c+"[\\s\\S]*?)[\\s\\S]*?)";g.markdownRegex=new RegExp(c+d+"\\]\\(([^\\\\)]*(?:\\\\.[^\\\\)]*)*)\\)","mg")}function c(a,b,d){for(var e=a.exec(b),f=[];e&&!(f.indexOf(e.index)>-1);)f.push(e.index),b=d(b,e),e=a.exec(b);return f.length?c(a,b,d):b}function d(a){return a.split("").reverse().join("")}function e(){var a=g.formatters.filter(function(a){return!!a.toHTML});return a.sort(function(a,b){var c=a.toHTML.priority||0;return(b.toHTML.priority||0)-c}),a}function f(){var a=g.formatters.filter(function(a){return!!a.toMarkdown});return a.sort(function(a,b){var c=a.toMarkdown.priority||0;return(b.toMarkdown.priority||0)-c}),a}var g={};return g.register=function(a){g.formatters.push(a),b()},g.toHTML=function(a,b){var f=b||e(),h=!1;return a=a.replace(/\$\&amp;/g,"&#36;&amp;"),a=c(g.markdownRegex,a,function(a,b){return a.replace(b[0],function(){return g.getFormatter(b[1]).toHTML.callback(b[2],b[4])})}),f.forEach(function(b){b.toHTML&&b.toHTML.regex&&(b.toHTML.reverse&&(a=d(a)),a=c(b.toHTML.regex,a,function(a,c){var d=c.splice(0,1)[0];return h=!0,a.replace(d,b.toHTML.callback.apply(b.toHTML.callback,c))}),b.toHTML.reverse&&(a=d(a)))}),h?g.toHTML(a,b):a},g.toMarkdown=function(a,b){var c=b||f(),d=new Option;return d.innerHTML=a,c.forEach(function(a){a.toMarkdown.tags.forEach(function(b){Array.prototype.slice.call(d.getElementsByTagName(b.name)).reverse().forEach(function(c){var d=!b.attr.length||b.attr.some(function(a){return c.hasAttribute(a)}),e=b.dontMatchAttr&&b.dontMatchAttr.some(function(a){return c.hasAttribute(a)});if("img"===b.name&&c.hasAttribute("src")&&!c.hasAttribute("data\\-measure")){var f=c.getAttribute("src");c.setAttribute("src",f.replace(/\\/g,""))}var g;if(g=a.toMarkdown.regex?d&&!e&&a.toMarkdown.regex.exec(c.outerHTML.trim()):[c.outerHTML.trim()],!e&&d&&g){var h=document.createElement("span");h.innerHTML=a.toMarkdown.callback.apply(c,g.slice(1)),c.parentNode.replaceChild(h,c)}})})}),d.innerHTML.replace(/<(\/)?span>/g,"")},g.getFormatter=function(a){var b,c=g.formatters;for(b=0;b<c.length;b++)if(c[b].character===a)return c[b];return null},g.escapeMarkdown=function(a){return a.replace(/\*/g,"\\*").replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/\_/g,"\\_").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\~/g,"\\~").replace(/\-/g,"\\-")},g.unescapeMarkdown=function(a){return a.replace(/\\\*/g,"*").replace(/\\\[/g,"[").replace(/\\\]/g,"]").replace(/\\\_/g,"_").replace(/\\\(/g,"(").replace(/\\\)/g,")").replace(/\\\~/g,"~").replace(/\\\-/g,"-")},g.reset=function(){g.formatters=[],g.markdownRegex=null},g.reset(),g}),define("client.services/media-tool/formatters/font-color",["sirtrevor","client.services/media-tool/theme","client.services/media-tool/markdown-html-parser"],function(a,b,c){var d=b.palette;return c.register({name:"font-color",character:"#",toHTML:{callback:function(a,b){return'<font color="'+d[b]+'">'+a+"</font>"}},toMarkdown:{priority:2,regex:/^<font(?: size="([0-7]|undefined)")? color="(#[a-f0-9]{3,6})"(?: size="([0-7]|undefined)")?.*?>([\s\S]+)<\/font>$/,callback:function(a,c,e,f){if(""===f)return"";var g=a||e;return null!==g&&void 0!==g&&(g=b.htmlSizeToMarkdownSize[g],f="%["+f+"]("+g+")"),d.indexOf(c)===-1?f:"#["+f+"]("+d.indexOf(c)+")"},tags:[{name:"font",attr:["color"]}]}}),a.Formatter.extend({title:"color",cmd:"foreColor",text:"color",onClick:function(a){document.execCommand(a.cmd,!1,a.param)}})}),define("client.services/media-tool/formatters/font-size",["sirtrevor","client.services/media-tool/theme","client.services/media-tool/markdown-html-parser"],function(a,b,c){return c.register({name:"font-size",character:"%",toHTML:{callback:function(a,c){return"<font size='"+b.markdownSizeToHtmlSize[c]+"'>"+a+"</font>"}},toMarkdown:{regex:/^<font size="([0-7])".*?>([\s\S]+)<\/font>$/,callback:function(a,c){return""===c?"":(a>7&&(a=b.fontSizesPx[a]),null!==a&&void 0!==a?(a=b.htmlSizeToMarkdownSize[a],"%["+c+"]("+a+")"):c)},tags:[{name:"font",attr:["size"]}]}}),a.Formatter.extend({title:"fontsize",cmd:"fontSize",text:"fontsize"})}),define("client.services/media-tool/formatters/justify",["sirtrevor","qvangular","encoder","client.services/media-tool/markdown-html-parser","client.services/media-tool/feature-detection","client.utils/rtl/rtl-util"],function(a,b,c,d,e,f){var g=e.usesAlign;d.register({name:"justify",character:"^",toHTML:{callback:function(a,b){var d=f.supportDirAuto()?"auto":f.detectTextDirection(a.replace(/<\/?[^>]+(>|$)/g,""));return a||(a="&nbsp;"),g?"<div dir="+d+' align="'+c.encodeForAttr2(b)+'">'+a+"</div>":"<div dir="+d+' style="text-align: '+c.encodeForAttr2(b)+';">'+a+"</div>"}},toMarkdown:{regex:/^<(?:div|p).*?(?:style="text(?:\\)?-)?align(?:="|: )(left|center|right|justified|inherit)(?:"|;).*?>([\s\S]+)<\/(?:div|p)>$/,callback:function(a,b){return"^["+b+"]("+a+")"},tags:[{name:"div",attr:["align","style"]},{name:"p",attr:["align"]}]}});var h=a.Formatter.extend({title:"align left",cmd:"justifyLeft",text:"left",isActive:function(a){var b=a.getParentParagraph(),c=window.getComputedStyle(b);return!!/left/.test(c.textAlign)||!(!c||"ltr"!==c.direction||/right/.test(c.textAlign)||/center/.test(c.textAlign))},onClick:function(){var a=b.getService("qvMediaTool").getParagraph().el.style,c=a.direction;"ltr"!==c&&c||(c="ltr",a.direction="rtl"),document.execCommand("justifyLeft",!1),"ltr"===c&&(a.direction="ltr")}}),i=a.Formatter.extend({title:"align center",cmd:"justifyCenter",text:"center",onClick:function(){document.execCommand("justifyCenter",!1)}});return{Left:h,Right:a.Formatter.extend({title:"align right",cmd:"justifyRight",text:"right",isActive:function(a){var b=a.getParentParagraph(),c=window.getComputedStyle(b);return!!/right/.test(c.textAlign)||!(!c||"rtl"!==c.direction||/left/.test(c.textAlign)||/center/.test(c.textAlign))},toMarkdown:function(a){return d.toMarkdown(a)},toHTML:function(a){return d.toHTML(a)},onClick:function(){var a=b.getService("qvMediaTool").getParagraph().el.style,c=a.direction;"rtl"===c&&(a.direction="ltr"),document.execCommand("justifyRight",!1),"rtl"===c&&(a.direction="rtl")}}),Center:i}}),define("client.services/media-tool/formatters/bold",["sirtrevor","client.services/media-tool/markdown-html-parser"],function(a,b){return b.register({name:"bold",character:"**",toHTML:{priority:5,regex:/\*\*(?!\\)([\s\S]+?(?!\*\\))\*\*/g,callback:function(a){return">b/<"+a+">b<"},reverse:!0},toMarkdown:{priority:-5,regex:/^<(?:b|strong)>([\s\S]+)<\/(?:b|strong)>$/,callback:function(a){return""===a?"":"**"+a+"**"},tags:[{name:"b",attr:[]},{name:"strong",attr:[]}]}}),a.Formatter.extend({title:"bold",cmd:"bold",text:"B",isActive:function(a){return a.rangeCollapsed?a.hasStartAncestorTag(["b","strong"])||a.hasEndAncestorTag(["b","strong"]):a.hasStartAncestorTag(["b","strong"])&&a.hasEndAncestorTag(["b","strong"])},toMarkdown:function(a){return a},toHTML:function(a){return a}})}),define("client.services/media-tool/formatters/italic",["sirtrevor","client.services/media-tool/markdown-html-parser"],function(a,b){return b.register({name:"italic",character:"_",toHTML:{priority:5,regex:/\_(?!\\)([\s\S]+?(?!\_\\))\_/g,callback:function(a){return">i/<"+a+">i<"},reverse:!0},toMarkdown:{priority:-5,regex:/^<(?:i|em)>([\s\S]+)<\/(?:i|em)>$/,callback:function(a){return""===a?"":"_"+a+"_"},tags:[{name:"i",attr:[]},{name:"em",attr:[]}]}}),a.Formatter.extend({title:"italic",cmd:"italic",text:"I",isActive:function(a){return a.rangeCollapsed?a.hasStartAncestorTag(["i","em"])||a.hasEndAncestorTag(["i","em"]):a.hasStartAncestorTag(["i","em"])&&a.hasEndAncestorTag(["i","em"])},toMarkdown:function(a){return a},toHTML:function(a){return a}})}),define("client.services/media-tool/formatters/underline",["sirtrevor","client.services/media-tool/markdown-html-parser"],function(a,b){return b.register({name:"underline",character:"~",toHTML:{priority:5,regex:/~(?!\\)([\s\S]+?(?!~\\))~/g,callback:function(a){return">u/<"+a+">u<"},reverse:!0},toMarkdown:{priority:-5,regex:/^<u>([\s\S]+)<\/u>$/,callback:function(a){return""===a?"":"~"+a+"~"},tags:[{name:"u",attr:[]}]}}),a.Formatter.extend({title:"underline",cmd:"underline",text:"U",isActive:function(a){return a.rangeCollapsed?a.hasStartAncestorTag("u")||a.hasEndAncestorTag("u"):a.hasStartAncestorTag("u")&&a.hasEndAncestorTag("u")},toMarkdown:function(a){return a},toHTML:function(a){return a}})}),define("client.services/media-tool/formatters/bookmark",["jquery","qvangular","sirtrevor","encoder","client.services/media-tool/markdown-html-parser"],function(a,b,c,d,e){function f(c,d){var e=b.getService("qvMediaTool"),f=e.getRange().commonAncestorContainer,g=a(f).find("a[href="+d+"]");return"#text"===f.nodeName&&(g="A"!==c.nodeName?a(c).find("a[href="+d+"]"):a(c)),0===g.length&&(g=a(f).find("a:not([href])")),g}return e.register({name:"bookmark",character:"$",toHTML:{callback:function(a,b){return'<a href="#" class="bookmark-link" data-bookmark-id="'+d.encodeForAttr2(b)+'">'+a+"</a>"}},toMarkdown:{regex:/^<a (?=.*data\\-bookmark\\-id="([^"]+)").*?>([\s\S]+?)<\/a>$/,callback:function(a,b){return"$["+b+"]("+a+")"},tags:[{name:"a",attr:["data\\-bookmark\\-id"]}]}}),c.Formatter.extend({title:"bookmark",cmd:"createLink",text:"Bookmark",isActive:function(a){return a.rangeCollapsed?a.hasStartAncestorTag("a")||a.hasEndAncestorTag("a"):a.hasStartAncestorTag("a")&&a.hasEndAncestorTag("a")},onClick:function(b){var c=b.url;a(document).on("DOMNodeInserted.bookmark",function(b){var d=f(b.target,c);a.each(d,function(b,d){a(d).hasClass("bookmark-link")||setTimeout(function(){d.setAttribute("href","#"),d.removeAttribute("_moz_dirty"),d.className+="bookmark-link",d.setAttribute("data-bookmark-id",c)})}),setTimeout(function(){a(document).off("DOMNodeInserted.bookmark")},250)}),document.execCommand("unlink",!1,!1),document.execCommand(this.cmd,!1,c)}})}),define("client.services/media-tool/formatters/link",["sirtrevor","client.services/media-tool/markdown-html-parser"],function(a,b){return b.register({name:"link",character:"@",toHTML:{callback:function(a,b){return 0===b.indexOf("javascript:")&&(b=""),0!==b.search("[a-zA-Z0-9]+:")&&(b="http://"+b),b=b.replace(/\\(["'])/g,"%5C$1").replace(/'/g,"%27").replace(/"/g,"%22").replace(/\$/g,"%24"),"<a href='"+decodeURI(b)+"' target='\\_blank' title='"+decodeURI(b)+"'>"+a+"</a>"}},toMarkdown:{regex:/^<a.*?href="(?!#)([^"]+)".*?>([\s\S]+?)<\/a>$/,callback:function(a,b){return"@["+b+"]("+a+")"},tags:[{name:"a",attr:["href"]}]}}),a.Formatter.extend({title:"link",cmd:"createLink",text:"Link",isActive:function(a){return a.rangeCollapsed?a.hasStartAncestorTag("a")||a.hasEndAncestorTag("a"):a.hasStartAncestorTag("a")&&a.hasEndAncestorTag("a")},onClick:function(a){var b=a.url;document.execCommand(this.cmd,!1,b)}})}),define("client.services/media-tool/formatters/unlink",["sirtrevor"],function(a){return a.Formatter.extend({title:"unlink",cmd:"unlink",text:"Unlink",onClick:function(a){var b=a.url;document.execCommand(this.cmd,!1,b)}})}),define("client.services/media-tool/formatters/measure",["qvangular","sirtrevor","util","translator","lz-string","general.utils/array-util","objects.views/charts/utils/canvas-renderer","client.services/media-tool/markdown-html-parser","general.utils/string-limits"],function(a,b,c,d,e,f,g,h,i){function j(a,b){var c,d=a.qHyperCube.qMeasureInfo;for(c=0;c<d.length;++c)if(d[c].cId===b)return d[c];return null}function k(a,b){var c,d,e=a.qHyperCube.qMeasureInfo;for(c=0;c<e.length;++c)if(e[c].cId===b)return d=a.qHyperCube.qGrandTotalRow[c],!d||!d.qText||"NaN"===d.qNum&&"-"===d.qText?"":h.escapeMarkdown(d.qText);return""}function l(a){var b,c=g.getDevicePixelToBackingStoreRatio(),d=m.getContext("2d"),e=g.measureTextObject({shape:{text:a,
width:112,font:"13px 'QlikView Sans'"}});b=Math.ceil(Math.min(e.width+50,150)),m.height=30*c,m.width=b*c,m.style.height="30px",m.style.width=b+"px",d.clearRect(0,0,m.width,m.height),d.save(),d.scale(c,c),d.font="15px 'LUI icons'",d.globalAlpha=.35,d.fillText("3",2,23),d.globalAlpha=1,d.font="13px 'QlikView Sans'",d.fillText(e.lines[0],32,20),d.restore();var f=m.toDataURL("image/png"),h=document.createElement("img");return h.setAttribute("src",f),h.setAttribute("class","tokenized-measure"),h.setAttribute("width",b+"px"),h.setAttribute("height","30px"),h}var m=document.createElement("canvas");return h.register({name:"measure",character:"=",toHTML:{callback:function(b,c){var f,g,h=a.getService("qvMediaTool");if(h.isActive()){var m=h.getOptions();if(!m.useMeasures)return"";var n,o=m.propertyHandler.getMeasure(c),p=!1;if(o){var q=j(m.layout,c);!q||q.qError?(p=!0,n=d.get("Object.ErrorMessage.MissingMeasure")):n=q.qFallbackTitle||""}else n=m.copiedMeasures[c];var r=JSON.stringify(o);g=l(n),g.setAttribute("data-measure-id",c),g.setAttribute("data-measure-name",e.compressToBase64(n)),g.setAttribute("data-measure",e.compressToBase64(r)),g.setAttribute("data-tid","ti-measure"),p&&g.classList.add("invalid-measure")}else{f=h.getCurrentLayout();var s=k(f,c);if(null===s)return"";s.length>i.textImage&&(s=s.substr(0,i.textImage-1)+"…"),g=document.createElement("span"),g.setAttribute("data-tid","ti-measure"),g.appendChild(document.createTextNode(s))}return g.outerHTML}},toMarkdown:{callback:function(){var b=this.getAttribute("data\\-measure\\-id"),d=a.getService("qvMediaTool").getOptions();if(!j(d.layout,b)&&!d.copiedMeasures[b]){var g=e.decompressFromBase64(this.getAttribute("data\\-measure")),h=JSON.parse(g);b=c.generateId(),h.qDef.cId=b;var i=d.properties;i.qHyperCubeDef.qMeasures.push(h),f.indexAdded(i.qHyperCubeDef.qInterColumnSortOrder,i.qHyperCubeDef.qDimensions.length+i.qHyperCubeDef.qMeasures.length-1);var k=e.decompressFromBase64(this.getAttribute("data\\-measure\\-name"));d.copiedMeasures[b]=k}return"=[]("+b+")"},tags:[{name:"img",attr:["data\\-measure\\-id"]}]}}),b.Formatter.extend({title:"measure",cmd:"",text:"measure",toMarkdown:function(a){return a},toHTML:function(a){return a}})}),define("client.services/media-tool/formatters/image",["qvangular","sirtrevor","client.services/media-tool/markdown-html-parser","general.utils/paths"],function(a,b,c,d){function e(a,b,c){for(var d=c?"qStaticContentUrl":"qStaticContentUrlDef",e=0;e<b.length;e++)if(b[e].id===a)return b[e].url[d].qUrl;return""}function f(a){return a.replace(/\\(["'])/g,"%5C$1").replace(/'/g,"%27").replace(/"/g,"%22").replace(/\$/g,"%24")}return c.register({name:"image",character:"!",toHTML:{callback:function(b,g){var h=a.getService("qvMediaTool");if(h.useImageArray()){var i,j=g;i=h.isActive()?h.getOptions().layout:h.getCurrentLayout(),g=e(b,i.images,!0),g=g?c.escapeMarkdown(g):j}return g=d.stripBasePath(g),g=f(g),g=d.getUrl(g),b||(b="image"),b=f(b),"<img src='"+g+"' data-image-id='"+b+"'>"}},toMarkdown:{priority:1,regex:/^<img.*?src="([^"]+)".*?>$/,callback:function(a){var b=this.getAttribute("data\\-image\\-id")||"";return b||(b=""),a=c.unescapeMarkdown(a),a=d.stripBasePath(a),a=c.escapeMarkdown(a),"!["+b+"]("+a+")"},tags:[{name:"img",attr:["src"],dontMatchAttr:["data\\-measure\\-id"]}]}}),b.Formatter.extend({title:"image",cmd:"insertImage",text:"image",onClick:function(a){document.execCommand(a.cmd,!1,a.param)}})}),define("client.services/media-tool/formatters/paste",["client.services/media-tool/markdown-html-parser","util"],function(a,b){var c=/color: rgb\\\((\d{1,3}), (\d{1,3}), (\d{1,3})/i,d=/font\\\-size: (\d+)px/i,e=/text\\\-decoration: underline/i,f=/font\\\-weight: bold/i;a.register({name:"paste",character:"`",toMarkdown:{regex:/^<(span|font|i|b|u) style="(.+?)">(.+?)<\/(?:span|font|i|b|u)>$/,callback:function(g,h,i){var j;return c.test(h)&&(h=h.replace(/rgb\\\(/g,"rgb(").replace(/\\\);/g,");"),i=a.getFormatter("#").toMarkdown.callback(null,b.normalizeToHex(h),null,i)),j=d.exec(h),j&&(i=a.getFormatter("%").toMarkdown.callback(j[1],i)),j=e.exec(h),j&&(i=a.getFormatter("~").toMarkdown.callback(i)),j=f.exec(h),j&&(i=a.getFormatter("**").toMarkdown.callback(i)),this.innerHTML=i,this.removeAttribute("style"),a.toMarkdown(this.outerHTML.trim())},tags:[{name:"span",attr:["style"]},{name:"font",attr:["style"]},{name:"b",attr:["style"]},{name:"i",attr:["style"]},{name:"u",attr:["style"]}]}}),a.register({name:"word",character:"``",toMarkdown:{regex:/^.+$/i,callback:function(){return" "},tags:[{name:"style",attr:[]},{name:"w:WordDocument",attr:[]}]}})}),define("client.services/media-tool/sir-trevor-extensions",["sirtrevor","underscore","client.services/media-tool/text-selection","client.services/media-tool/formatters/font-color","client.services/media-tool/formatters/font-size","client.services/media-tool/formatters/justify","client.services/media-tool/formatters/bold","client.services/media-tool/formatters/italic","client.services/media-tool/formatters/underline","client.services/media-tool/formatters/bookmark","client.services/media-tool/formatters/link","client.services/media-tool/formatters/unlink","client.services/media-tool/formatters/measure","client.services/media-tool/formatters/image","general.utils/string-limits","client.services/media-tool/formatters/paste"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(a){for(var b=[],c=0;c<a.childNodes.length;c++)3===a.childNodes[c].nodeType?b.push(a.childNodes[c]):b.push.apply(b,p(a.childNodes[c]));return b}function q(){var a=this,b=a.textContent.length-o.textImage;if(b>0){var d=c.getRange(),e=d.commonAncestorContainer;if(3===e.nodeType){var f=p(document.activeElement),g=f.indexOf(e);f=f.splice(0,g+1),f.reverse().forEach(function(a){if(b<=0)return!1;a.nodeValue.length>b?(a.splitText(a.nodeValue.length-b),a.parentNode.removeChild(a.nextSibling),c.addRange(d,!0)):a.parentNode.removeChild(a),b-=a.nodeValue.length})}}}delete a.Formatters.Bold,delete a.Formatters.Italic,delete a.Formatters.Link,delete a.Formatters.Unlink,a.Formatters.bold=new g,a.Formatters.italic=new h,a.Formatters.underline=new i,a.Formatters.justifyLeft=new f.Left,a.Formatters.justifyCenter=new f.Center,a.Formatters.justifyRight=new f.Right,a.Formatters.fontSize=new e,a.Formatters.foreColor=new d,a.Formatters.bookmark=new j,a.Formatters.link=new k,a.Formatters.unlink=new l,a.Formatters.measure=new m,a.Formatters.insertImage=new n,a.Blocks.Paragraph=function(){return a.Block.extend({type:"paragraph",className:"st-block",icon_name:"paragraph",editorHTML:'<div class="st-required st-text-block" contenteditable="true" autocomplete="off" autocorrect="off"></div>',attributes:function(){return b.extend(a.SimpleBlock.fn.attributes.call(this),{})},title:function(){return"Paragraph"},loadData:function(b){this.getTextBlock().html(a.toHTML(b.text,this.type))},focus:function(){this.getTextBlock().focus()},_initTextBlocks:function(){this.getTextBlock().bind("input",q).bind("paste",this._handleContentPaste).bind("keyup",this.getSelectionForFormatter).bind("mouseup",this.getSelectionForFormatter)},_initUIComponents:function(){this.onFocus(),this.onBlur()},_blockPrepare:function(){this._initUI(),this._initMessages(),this.checkAndLoadData(),this.$el.addClass("st-item-ready")},toData:function(){a.log("toData for "+this.blockID);var b=this.getTextBlock().html();this.setData({text:a.toMarkdown(b,this.type)})}})}(),a.FloatingBlockControls=function(){return a.FloatingBlockControls.extend({className:"",bound:[],initialize:function(){},attributes:function(){}})}(),a.BlockControls=function(){return a.FloatingBlockControls.extend({className:"",bound:[],html:"",initialize:function(){},hide:function(){},show:function(){},handleControlButtonClick:function(){}})}(),a.FormatBar=function(){return a.FormatBar.extend({className:"",initialize:function(){}})}()}),define("client.services/media-tool/media-tool",["jquery","underscore","util","general.utils/dom-util","qvangular","sirtrevor","text!./media-tool.ng.html","client.services/media-tool/theme","client.services/media-tool/toolbar","client.services/media-tool/command-queue","client.services/media-tool/text-selection","general.utils/string-limits","general.utils/paths","general.utils/support","client.services/media-tool/feature-detection","client.utils/rtl/direction-service","client.utils/rtl/rtl-util","./sir-trevor-extensions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=e.getService("$sce"),s={bold:!1,italic:!1,underline:!1,justifyLeft:!1,justifyCenter:!1,justifyRight:!1,link:!1,fontSize:!1};return{controller:["$scope","$element","$timeout","luiPopover",function(g,t,u,v){function w(){x(),"inline"===g.options.toolbar.style?B=g.options.target.showComponent(i,{textTool:g,options:g.options.toolbar||{}}):(B=v.show({template:i.template,controller:i.controller,input:{textTool:g,options:g.options.toolbar||{}},alignTo:g.options.target||t[0],dock:"top",variant:"inverse",closeOnOutside:!0,outsideIgnore:"media-toolbar",showArrow:!1,autoFocus:!1}),B.closed.then(function(){B=null}))}function x(){B&&(g.editor.formatBar.$el.remove(),B=null)}function y(){function a(a){return g.getEditorElement()[0]===a}function b(a,c){return Array.isArray(a)?a.some(function(a){return b(a,c)}):c.some(function(b){return b.nodeName.toLowerCase()===a})}function c(){for(var a=g.currentRange.startContainer;a.parentNode&&"DIV"!==a.tagName&&"P"!==a.tagName;)a=a.parentNode;return a}var e=d.getAncestorsUntil(g.currentRange.startContainer,a),f=d.getAncestorsUntil(g.currentRange.endContainer,a);return{rangeCollapsed:g.currentRange.collapsed,hasStartAncestorTag:function(a){return b(a,e)},hasEndAncestorTag:function(a){return b(a,f)},getParentParagraph:c}}function z(b){function c(a){g.saveRange(),g.cmdQueue.clear(),a&&g.refreshState()}var e=!n.treatAsDesktop();a("body").on("mouseup.texttool",function(b){a(b.target).closest(".qv-texttool-toolbar, .qui-immidiateContextual, .qv-modal-container-centered, .lui-popover").length?d.isInput(document.activeElement)||(g.focus(),g.restoreRange()):e||document.activeElement===g.getEditorElement()[0]&&u(function(){c(!0),g.$apply()})}),e&&a(document).on("selectionchange.texttool",function(){if(document.activeElement===g.getEditorElement()[0]){var a=k.getRange();a&&!k.rangeEquals(a,g.currentRange)&&c(!0)}}),b.on("qv-activate","img",function(a){var b=k.createRangeForElement(a.target);g.focus(),k.addRange(b,!0),g.saveRange(),g.refreshState()}),b.on("scroll",function(){g.saveScroll()}),b.on("keydown input",function(a){13!==a.which&&(g.cmdQueue.execAll(function(a){g.execCustom(a)}),g.cmdQueue.clear()),u(function(){g.$apply()})}),e||b.on("keyup",function(){u(c.bind(this,!0),0)}),b.on("DOMNodeInserted.autoDirection",function(c){var d=a(c.target);"x-auto-direction-for-paragraphs"in b[0].attributes&&d.is("div,p")&&d[0]!==b[0]&&(q.supportDirAuto()&&d.attr("dir","auto"),d.is("[align],[style]")||(o.usesAlign?d.attr("align","inherit"):d.css("text-align","inherit"),""===d[0].textContent&&d.css("direction",p.direction)))})}var A=r.getTrustedHtml(f.toHTML(g.options.markdown));g.data={data:[{type:"paragraph",data:{text:f.toMarkdown(A)}}]},g.states=s,g.cmdQueue=new j;var B;this.scope=function(){return g},this.closing=function(){var a=this.scope().options;B&&("inline"===a.toolbar.style?a.target.empty():B.close())},g.getParagraph=function(){return g.editor.blocks[0]},g.getEditorElement=function(){return g.getParagraph().getTextBlock()},g.destroy=function(){x(),g.destroyComponent()},g.calculateUsage=function(){var a=g.getEditorElement()[0];g.usage=Math.min(100,(a.textContent.length/l.textImage*100).toFixed(0)),g.showUsage=g.usage>=90},g.refreshState=function(){g.currentRange&&e.$apply(g,function(){g.calculateUsage();var a=y();Object.keys(g.states).forEach(function(b){g.states[b]=f.Formatters[b].isActive(a)});var b;g.currentRange&&void 0!==(b=document.queryCommandValue("foreColor"))&&(b=c.normalizeToHex(b)),g.color=b||"#545352";var e,i;g.currentRange&&(i=d.getParentElementWithAttribute(g.currentRange.endContainer,"font","size"),i&&(e=i.getAttribute("size"),e=h.htmlSizeToMarkdownSize[e],e=h.markdownSizeToHtmlSize[e]),"undefined"===e&&(e=null),i||e||"<br>"!==g.currentRange.endContainer.innerHTML&&!g.currentRange.endContainer.textContent||(g.fontSize=3)),e?g.fontSize=e:e||g.fontSize||(g.fontSize=3)})},g.saveRange=function(){var a=k.getRange();g.currentRange=a?a.cloneRange():null},g.restoreRange=function(){if(g.currentRange){var a=k.getRange();a?a&&(k.rangeEquals(a,g.currentRange)||k.addRange(g.currentRange,!0)):k.addRange(g.currentRange,!0)}},g.saveScroll=function(){g.currentScrollTop=g.getEditorElement()[0].scrollTop},g.restoreScroll=function(){g.currentScrollTop&&(g.getEditorElement()[0].scrollTop=g.currentScrollTop)},g.setJustify=function(a){g.focus(),g.restoreScroll(),g.restoreRange(),g.execCustom({cmd:a}),g.saveRange(),g.refreshState()},g.setBIU=function(a){if(g.focus(),g.restoreScroll(),g.restoreRange(),g.states[a]=!g.states[a],g.currentRange.collapsed){g.cmdQueue.remove(a)||g.cmdQueue.push({cmd:a})}else g.execCustom({cmd:a});g.saveRange()},g.setFontSize=function(a){g.focus(),g.restoreScroll(),g.restoreRange(),g.currentRange.collapsed?(g.cmdQueue.remove("fontSize"),g.cmdQueue.push({param:a,cmd:"fontSize"})):g.execCustom({param:a,cmd:"fontSize"}),g.saveRange(),g.fontSize=a},g.setColor=function(a){g.focus(),g.restoreScroll(),g.restoreRange(),g.currentRange.collapsed?(g.cmdQueue.remove("foreColor"),g.cmdQueue.push({param:a,cmd:"foreColor"})):g.execCustom({param:a,cmd:"foreColor"}),g.saveRange(),g.color=a},g.insertImage=function(a,b){a=m.addBasePath(a),b=m.addBasePath(b),g.focus(),g.restoreRange(),g.execCustom({param:a,cmd:"insertImage"}),g.options.insertedImages.push({url:a,urlDef:b}),g.saveRange(),g.focus()},g.insertLink=function(a,b,c){b?k.addRange(b,!0):g.restoreRange(),g.focus(),g.execCustom({url:a,cmd:c.cmd,formatter:c.formatter}),g.saveRange(),g.refreshState()},g.removeLink=function(a){k.addRange(a,!0),g.execCustom({cmd:"unlink",range:a}),g.saveRange(),g.refreshState(),g.focus()},g.execCustom=function(a){var c=f.Formatters[a.formatter||a.cmd];b.isUndefined(c)||(!b.isUndefined(c.onClick)&&b.isFunction(c.onClick)?c.onClick(a):document.execCommand(a.cmd,!1,a.param))},g.focus=function(){g.getEditorElement().focus()},u(function(){g.editor=new f.Editor({el:t.find("textarea"),defaultType:"paragraph",onEditorRender:function(){var a=t.find(".st-text-block");z(a),"function"==typeof g.options.onOpen&&g.options.onOpen(g),g.options.toolbar&&w(),u(function(){g.refreshState()})}})}),g.$on("$destroy",function(){x(),a(t.find(".st-text-block")).off("DOMNodeInserted.autoDirection"),a("body").off(".texttool"),a(document).off(".texttool")})}],template:g}}),define("client.services/media-tool/media-tool-service",["qvangular","sirtrevor","client.services/media-tool/media-tool"],function(a,b,c){var d=a.getService("$sce");return a.service("qvMediaTool",[function(){var a,e,f,g,h={};return h.show=function(b,d){g=d,a=b.showComponent(c,{options:d})},h.hide=function(){a&&(a.scope().destroy(),a=null,g=null)},h.closing=function(){a&&a.closing()},h.isActive=function(){return g&&"function"==typeof g.isActive?g.isActive():!!a},h.getCurrentLayout=function(){return e},h.useImageArray=function(){return f},h.getOptions=function(){return g||{}},h.getMarkdown=function(){var b,c=a.scope().getParagraph();return c&&(b=c.saveAndGetData())?b.text:null},h.hasContent=function(a){return a&&"^[\n](left)"!==a},h.getParagraph=function(){return a.scope().getParagraph()},h.getEditorElement=function(){return a.scope().getEditorElement()},h.getRange=function(){return a.scope().currentRange},h.toHTML=function(a,c,g){if(e=c,f=g,a){var h=b.toHTML(a);return a=b.toMarkdown(h),d.getTrustedHtml(b.toHTML(a))}return""},h.toMarkdown=function(a){return a?b.toMarkdown(a):""},h}])}),define("extensions.qliktech/map/map-properties",["client.utils/property-resolver","client.services/media-tool/media-tool-service","core.utils/help-url","client.property-panel/default-properties","client.utils/default-property-logic"],function(a,b,c,d,e){function f(a){if(!a||a.qLibraryId)return!1;var b=a.qDef.qFieldDefs[0];return b&&b.length&&"="===b[0]}function g(b){var c=a.getValue(b,"color.auto"),d=a.getValue(b,"color.mode"),e=a.getValue(b,"color.expressionIsColor");return c||"primary"===d||"byExpression"===d&&(e||void 0===e)}function h(b){return"byExpression"===a.getValue(b,"color.mode")&&a.getValue(b,"color.expressionIsColor")===!1}function i(b){return"byExpression"===a.getValue(b,"color.mode")&&a.getValue(b,"color.expressionIsColor")===!0}var j=[{value:"primary",translation:"properties.colorMode.primary"},{value:"byDimension",translation:"properties.colorMode.byDimension"}],k=j.concat({value:"byMeasure",translation:"properties.colorMode.byMeasure"}),l=k.concat({value:"byExpression",translation:"properties.colorMode.byExpression"}),m={component:"text",translation:"Common.Dimension",style:"sHeader"},n={component:"text",translation:"Common.Measure",style:"sHeader"},o={ref:"qHyperCubeDef.qDimensions.0.qDef.qFieldDefs.0",type:"string",component:"expression",expressionType:"dimension",translation:"Common.Field",show:function(a){var b=a.qHyperCubeDef.qDimensions[0];return!b||!b.qLibraryId},readOnly:!0},p={type:"string",ref:"qHyperCubeDef.qDimensions.0.qLibraryId",component:"library-item",libraryItemType:"dimension",translation:"Common.Dimension",show:function(a){var b=a.qHyperCubeDef.qDimensions[0];return b&&b.qLibraryId}},q={type:"string",ref:"qHyperCubeDef.qMeasures.0.qLibraryId",component:"library-item",libraryItemType:"measure",translation:"Common.Measure",show:function(a){var b=a.qHyperCubeDef.qMeasures[0];return b&&b.qLibraryId}},r={ref:"qHyperCubeDef.qMeasures.0.qDef.qLabel",type:"string",translation:"Common.Label",show:function(a){var b=a.qHyperCubeDef.qMeasures[0];return!b||!b.qLibraryId}},s={type:"items",items:{firstMeasureScope:{ref:"qHyperCubeDef.qMeasures.0",component:"scope",item:d.data.items.measures.items.numberFormatting}},show:function(a){return!!a.qHyperCubeDef.qMeasures[0]}},t={type:"boolean",ref:"qHyperCubeDef.qSuppressZero",defaultValue:!1,translation:"properties.hyperCube.showZero",inverted:!0,show:function(a){return!!a.qHyperCubeDef.qMeasures[0]}},u={ref:"layers",type:"array",translation:"Common.Data",addTranslation:"properties.layers.add",component:"layers",allowMove:!0,max:1,items:{polygon3Layer:{type:"items",component:"expandable-items",sourceType:"polygon3Layer",grouped:!0,items:{dimensions:{type:"items",items:{text:m,field:o,libraryDimension:p,geodata:{ref:"geodata.qHyperCubeDef.qMeasures.0.qDef.qDef",type:"string",translation:"properties.layers.regionData",component:"expression",expressionType:"measure",show:function(a){return a&&a.qHyperCubeDef&&a.qHyperCubeDef.qDimensions&&f(a.qHyperCubeDef.qDimensions[0])}},nullSuppression:{type:"boolean",ref:"geodata.qHyperCubeDef.qDimensions.0.qNullSuppression",defaultValue:!1,translation:"properties.dimensions.showNull",inverted:!0,change:function(b){var c=a.getValue(b,"geodata.qHyperCubeDef.qDimensions.0.qNullSuppression");a.setValue(b,"qHyperCubeDef.qDimensions.0.qNullSuppression",c)}},showExcluded:{type:"boolean",ref:"showExcluded",defaultValue:!0,translation:"properties.dimensions.showExcluded",change:function(b){var c=b.showExcluded,d=a.getValue(b,"geodata.qHyperCubeDef.qMeasures.0.qDef.qDef");d.indexOf("GeoReduceGeometry(")!==-1&&(c&&d.indexOf("{1}")===-1?d=d.replace("GeoReduceGeometry(","GeoReduceGeometry({1}"):c||d.indexOf("{1}")===-1||(d=d.replace("GeoReduceGeometry({1}","GeoReduceGeometry(")),a.setValue(b,"geodata.qHyperCubeDef.qMeasures.0.qDef.qDef",d))}}}},appearance:{type:"items",items:{opacity:{ref:"opacity",type:"number",translation:"properties.opacity",component:"slider",min:0,max:1,step:.05,defaultValue:1},show:{type:"boolean",ref:"show",translation:"Common.Show",show:function(b,c,d){return a.getValue(d.properties,"background.show",!1)}}}}}},pointLayer:{type:"items",component:"expandable-items",grouped:!0,items:{dimensions:{type:"items",items:{text:m,field:o,libraryDimension:p,geodata:{ref:"qHyperCubeDef.qDimensions.1.qDef.qFieldDefs.0",type:"string",component:"expression",expressionType:"dimension",translation:"properties.layers.pointData",change:function(a){var b=a.qHyperCubeDef.qDimensions[1].qDef;b.qFieldLabels||(b.qFieldLabels=[]),b.qFieldLabels[0]=b.qFieldDefs[0]},show:function(a){return a&&a.qHyperCubeDef&&a.qHyperCubeDef.qDimensions&&f(a.qHyperCubeDef.qDimensions[0])}},nullSuppression:{type:"boolean",ref:"qHyperCubeDef.qDimensions.0.qNullSuppression",defaultValue:!1,translation:"properties.dimensions.showNull",inverted:!0}}},measure:{type:"items",items:{text:n,expression:{ref:"qHyperCubeDef.qMeasures.0.qDef.qDef",type:"string",translation:"Common.Expression",component:"expression",expressionType:"measure",change:function(a){var b=a.qHyperCubeDef.qMeasures[0];b&&""===b.qDef.qDef?(a.qHyperCubeDef.qMeasures.length=0,2===a.qHyperCubeDef.qInterColumnSortOrder[0]&&a.qHyperCubeDef.qInterColumnSortOrder.splice(0,1)):(b.qSortBy={qSortByLoadOrder:1,qSortByNumeric:-1},2!==a.qHyperCubeDef.qInterColumnSortOrder[0]&&a.qHyperCubeDef.qInterColumnSortOrder.splice(0,0,2))},show:function(a){var b=a.qHyperCubeDef.qMeasures[0];return!b||!b.qLibraryId}},libraryMeasure:q,label:r,numberFormatting:s,suppressZero:t,bubbleSizes:{ref:"bubbleSizes",type:"integer",translation:"properties.dataPoints.bubbleSizes",component:"slider",min:1,max:32,step:1,defaultValue:8,show:function(a){return!a.qHyperCubeDef.qMeasures[0]}},rangeBubbleSizes:{ref:"rangeBubbleSizes",type:"array",translation:"properties.dataPoints.bubbleSizes",component:"slider",min:1,max:32,step:1,defaultValue:[1,32],show:function(a){return a.qHyperCubeDef.qMeasures[0]}},customRange:{type:"items",items:{autoMinMax:{ref:"autoMinMax",type:"boolean",translation:"properties.axis.range",component:"switch",options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}],defaultValue:!0,show:function(a){return a.qHyperCubeDef.qMeasures[0]}},customMin:{ref:"customMin",translation:"properties.axis.min",expression:"optional",type:"number",defaultValue:0,show:function(a){return a.qHyperCubeDef.qMeasures[0]&&a.autoMinMax===!1},invalid:function(b){return"minMax"===a.getValue(b,"minMax")&&a.getValue(b,"customMin")>=a.getValue(b,"customMax")}},customMax:{ref:"customMax",translation:"Common.Max",expression:"optional",type:"number",defaultValue:10,show:function(a){return a.qHyperCubeDef.qMeasures[0]&&a.autoMinMax===!1},invalid:function(b){return"minMax"===a.getValue(b,"minMax")&&a.getValue(b,"customMin")>=a.getValue(b,"customMax")}}}}}},appearance:{type:"items",items:{opacity:{ref:"opacity",type:"number",translation:"properties.opacity",component:"slider",min:0,max:1,step:.05,defaultValue:1},show:{ref:"show",type:"boolean",translation:"Common.Show",show:function(b,c,d){return a.getValue(d.properties,"background.show",!1)}}}}}}}},v={component:"items",type:"items",translation:"properties.background",grouped:!0,items:{show:{ref:"background.show",type:"boolean",translation:"properties.show",component:"switch",options:[{value:!0,translation:"properties.on"},{value:!1,translation:"properties.off"}],defaultValue:!1,change:function(b){b.layers.length&&!b.background.show&&(b.layers[0].show=!0),b.background&&b.background.show&&void 0===b.background.defaultMapService&&a.setValue(b,"background.defaultMapService",!0)}},baseLayers:{type:"items",show:function(b){return a.getValue(b,"background.show")},items:{defaultMapService:{ref:"background.defaultMapService",type:"boolean",translation:"properties.mapService",component:"switch",defaultValue:!0,undefinedValue:!1,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}]},customMapService:{type:"items",items:{type:{ref:"background.layers.0.type",type:"string",translation:"properties.type",component:"dropdown",options:[{translation:"properties.layers.type.slippy",value:"XYZ"}],defaultValue:"XYZ"},urls:{ref:"background.layers.0.urls.0",type:"string",translation:"Common.URL",minlength:1},attribution:{ref:"background.layers.0.attribution",type:"string",translation:"properties.attribution",component:"textarea",maxlength:1024,resolveFunctions:{get:function(a,c){var d=a(c.type);return b.toHTML(d)},set:function(a,c,d){var e=b.toMarkdown(a);c(d.type,e)}}},helpLink:{component:"link",url:function(){return c.path+"map.htm"},translation:"properties.background.help"}},show:function(b){return!a.getValue(b,"background.defaultMapService")}}}}}},w=e.getLogicFor("hard","default"),x={uses:"settings",items:{presentation:{type:"items",translation:"properties.presentation",grouped:!0,items:{showNavigation:{ref:"navigation",type:"boolean",translation:"Common.Navigation",component:"switch",defaultValue:!1,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"properties.off"}]},autoZoomOnSelection:{ref:"autoZoomOnSelection",type:"boolean",defaultValue:!0,translation:"properties.autoZoomOnSelection",show:function(a){return a&&a.layers&&a.layers[0]&&"point"===a.layers[0].type}}}},colorsAndLegend:{uses:"colorsAndLegend",items:{colors:{items:{colorMode:{options:function(a,b){var c=b.getDimensions(),d=c?c.length:0;switch(b.getLayerTypeAndVersion()[0]){case"point":case"polygon":return d>0?l:j}return j},globalChange:function(a,b){w.color.colorBy.globalChange(a,b,"layers.0.qHyperCubeDef.")}},persistentColors:{show:function(b){return!(a.getValue(b,"color.auto")||"byDimension"!==a.getValue(b,"color.mode")||"point"===b.layers[0].type||"polygon"===b.layers[0].type&&"2"===b.layers[0].version)}},baseMeasureColors:{type:"items",show:!1,items:{useBaseColor:{ref:"color.useBaseColors",show:!1,defaultValue:"off"}}},attributeExpression:{ref:"layers.0.qHyperCubeDef.qDimensions.0.qAttributeExpressions.0.qExpression",change:function(b){var c=a.getValue(b,"layers.0.qHyperCubeDef.qDimensions.0.qAttributeExpressions.0"),d=a.getValue(b,"color");c&&(c.id="colorByExpression",d&&(d.colorExpression=c.qExpression))},globalChange:function(b){var c,d,e,f=a.getValue(b,"layers.0.qHyperCubeDef.qDimensions",[]),g=a.getValue(b,"layers.0.qHyperCubeDef.qLayoutExclude.qHyperCubeDef.qDimensions",[]),h=null,i=function(a,b){"colorByExpression"===a.id&&(d=b)};if(f.length+g.length>1){for(c=g.length-1;c>=0;--c)e=g[c].qAttributeExpressions||[],d=-1,e.every(i),d>=0&&(h=e.splice(d,1)[0]);for(c=f.length-1;c>=0;--c)e=f[c].qAttributeExpressions||[],d=-1,e.every(i),d>=0&&(h=e.splice(d,1)[0]);!f[0].qAttributeExpressions&&h&&(f[0].qAttributeExpressions=[]),h&&f[0].qAttributeExpressions.splice(0,0,h)}f.forEach(function(a){a.qAttributeExpressions&&a.qAttributeExpressions.length>1&&a.qAttributeExpressions.splice(0,a.qAttributeExpressions.length-1)});var j=a.getValue(b,"color.colorExpression");1!==f.length||f[0].qAttributeExpressions&&0!==f[0].qAttributeExpressions.length||!j||(f[0].qAttributeExpressions=[{qExpression:j,id:"colorByExpression"}])},show:function(b,c){return!a.getValue(b,"color.auto")&&"byExpression"===a.getValue(b,"color.mode")&&c.getDimensions().length>0}},expressionIsColor:{show:function(b,c){return!a.getValue(b,"color.auto")&&"byExpression"===a.getValue(b,"color.mode")&&c.getDimensions().length>0}},expressionLabel:{change:function(b){var c=a.getValue(b,"layers.0.qHyperCubeDef.qMeasures.0.qAttributeExpressions.0"),d=a.getValue(b,"color");c&&(c.label=a.getValue(b,"color.expressionLabel"),d&&(d.colorExpression=c.qExpression))},show:function(b,c){return!a.getValue(b,"color.auto")&&h(b)&&c.getDimensions().length>0}}}},legend:{items:{show:{show:function(a){return!g(a)}},showTitle:{show:function(b){return a.getValue(b,"legend.show")&&!g(b)&&!i(b)}},dock:{show:function(b){return a.getValue(b,"legend.show")&&!g(b)}}}}}}}};return{type:"items",component:"accordion",items:{data:u,background:v,addons:{type:"items",component:"expandable-items",translation:"properties.addons",items:{dataHandling:{uses:"dataHandling",items:{calcCond:{items:{expr:{ref:"calcCond",expressionType:"measure",change:function(a,b){b.rippleToHyperCubes("qCalcCond",a.calcCond)}},customErrorMessage:{ref:"customErrorMessage.calcCond",show:function(b){return""!==a.getValue(b,"calcCond")},change:function(a,b){b.rippleToHyperCubes("customErrorMessage.calcCond",a.customErrorMessage.calcCond)}}}},suppressZero:null}}}},settings:x}}}),define("extensions.qliktech/map/projection/mercator-projection",["core.utils/class","general.utils/shapes/point"],function(a,b){var c=Math.PI,d=c/2,e=c/4,f=c/180,g=Math.max,h=Math.min,i=85.0511287798059*f,j=180/c;return a.extend("MercatorProjection",{init:function(){},getProjectionType:function(){return"Mercator"},project:function(a){if(a){var c=g(h(a.y*f,i),-i),d=a.x*f,k=d-0,l=Math.log(Math.tan(e+c/2));return k*=j,l*=j,new b(k,l)}},invProject:function(a){if(a){var c=a.x*f,e=a.y*f,g=c+0,h=2*Math.atan(Math.pow(Math.E,e))-d;return g*=j,h*=j,new b(g,h)}}})}),define("extensions.qliktech/map/projection/viewport-projection-mercator",["objects.views/charts/utils/viewport-projection","general.utils/shapes/point","extensions.qliktech/map/projection/mercator-projection","general.utils/shapes/rect"],function(a,b,c,d){var e=new b(0,0);return a.extend("ViewportProjectionMercator",{init:function(){this._super(),this._boundingBox=new d(-180,-180,360,360),this.helpFunctions.updateProjectedDataBoundingBox.call(this),this._mercatorProjection=new c,this._mirrorYAxis=!0},getMercatorProjection:function(){return this._mercatorProjection},setMapCenterInLatLong:function(a){if(!a)return!1;var b,c;return b=this._mercatorProjection.project(a),c=this._projection.invProject(b),this.setDataCenter(c)},getMapCenterInLatLong:function(){var a;return a=this._projection.project(this._currentDataCenter),this._mercatorProjection.invProject(a)},fromLatLongToViewport:function(a){var b;return b=this._mercatorProjection.project(a),this.transform(b)},fromLatLongRectToViewportRect:function(a){var c,e;return c=this.fromLatLongToViewport(new b(a.x,a.y)),e=this.fromLatLongToViewport(new b(a.x+a.width,a.y+a.height)),new d(c.x,c.y,e.x-c.x,e.y-c.y)},fromViewportToLatLong:function(a){var b;return b=this.invTransform(a),this._mercatorProjection.invProject(b)},fromViewportRectToLatLongRect:function(a){var c,e;return c=this.fromViewportToLatLong(new b(a.x,a.y)),e=this.fromViewportToLatLong(new b(a.x+a.width,a.y+a.height)),new d(c.x,c.y,e.x-c.x,e.y-c.y)},fromLatLongToPixel:function(a,c){var d,e,f,g=Math.pow(2,c+7);return d=this._mercatorProjection.project(a),e=this.helpFunctions.translateProjectedDataCenterToZeroPoint.call(this,d),f=this.helpFunctions.scaleProjectedDataToZoomLevel.apply(this,[e,c]),new b(f.x+g,g-f.y)},fromPixelToLatLong:function(a,c){var d,e,f,g=Math.pow(2,c+7);return f=new b(a.x-g,g-a.y),e=this.helpFunctions.invScaleProjectedDataToZoomLevel.apply(this,[f,c]),d=this.helpFunctions.invTranslateProjectedDataCenterToZeroPoint.call(this,e),this._mercatorProjection.invProject(d)},getViewRectangleInLatLong:function(){var a,b;return a=this.fromViewportToLatLong(e),b=this.fromViewportToLatLong(this._viewportSize),new d(Math.min(a.x,b.x),Math.min(a.y,b.y),Math.abs(a.x-b.x),Math.abs(a.y-b.y))}})}),define("extensions.qliktech/map/map-layer",["objects.views/charts/components/chart-component","objects.views/charts/utils/canvas-renderer"],function(a,b){"use strict";function c(){this._viewportProjectionChanged=!0,this._shouldPaintOnDataChanged||this.invalidateDisplay("onViewportProjectionChanged")}function d(){this._viewportProjectionChanged=!0,this.paint()}function e(){void 0!==this._layerData.opacity&&(this.container.style.opacity=this._layerData.opacity,this.container.style.filter="alpha(opacity="+100*this._layerData.opacity+")")}function f(){this._toggledOnCacheItems.forEach(function(a){a.selected=!1}),this._toggledOnCacheItems=[],this._selectedRows=[]}function g(a){var b=this,c=this._toggledOnCacheItems.map(function(a){return a.row});this.updateBackendApi(),this.backendApi.select("selectHyperCubeCells",this._layerPath,c,a).then(function(a){b._selectionFailed=!a,b._selectionFailed&&f.call(b)})}return a.extend("MapLayer",{init:function(){
this._super.apply(this,arguments),this._viewportProjectionChanged=!1,this._data=void 0,this._layerData=void 0,this._qData=void 0,this._qMatrix=void 0,this._qSelectionInfo=void 0,this._numItems=0,this._layoutMode=void 0,this._selectableShapes=[],this._shapes=[],this._cacheItems=[],this._colorMap=void 0,this._layerS2Bounds=void 0,this._cacheItems=null,this._renderer=new b(this.container),this._firstAutoZoomed=!1,this._numPoints=0,this._toggledOnCacheItems=[],this._selectedRows=[]},setData:function(a,b){var c;this._skipInvalidateOnGlobalOpacityChange=!0,this._data=a,this._layerData=b,this._toggledOnCacheItems=[],this._selectedRows=[],c=!!this._layerData&&this._layerData.show,c?this.showComponent():this.hideComponent(),this._qSelectionInfo=this._data?this._data.qSelectionInfo:void 0,e.call(this)},getData:function(){return this._data},getLayerData:function(){return this._layerData},setLayerIndex:function(a){this._layerIndex=a},getLayerIndex:function(){return this._layerIndex},setLayerType:function(a){this._layerType=a},getLayerType:function(){return this._layerType},setVersion:function(a){this._version=a},getVersion:function(){return this._version},setFirstAutoZoomed:function(a){this._firstAutoZoomed=a},getFirstAutoZoomed:function(){return this._firstAutoZoomed},getLayerPath:function(){return this._layerPath},getNumPoints:function(){return this._numPoints},getLayerBounds:function(){return this._layerS2Bounds},setViewportProjection:function(a){this._viewportProjection!==a&&(this._viewportProjection&&(this._viewportProjection.stopListen("changed",c,this),this._viewportProjection.stopListen("changedByInteraction",d,this)),this._viewportProjection=a,this._viewportProjection&&(this._viewportProjection.listen("changed",c,this),this._viewportProjection.listen("changedByInteraction",d,this)))},setBackendApi:function(a){this.backendApi=a},setSelectionsApi:function(a){this.selectionsApi=a},setColorMap:function(a){this._colorMap=a},getColorMap:function(){return this._colorMap},getLayerOutputData:function(){return this._layerData?{color:this._data.color,legend:this._data.legend,qSelectionInfo:this._data.qSelectionInfo,qHyperCube:this._layerData.qHyperCube}:void 0},getMeasureInfo:function(){if(this._layerData)return this._layerData.qHyperCube.qMeasureInfo},getSelectedRows:function(){return this._toggleOnCacheItemsChanged&&(this._selectedRows=this._toggledOnCacheItems.map(function(a){return a.row}),this._toggleOnCacheItemsChanged=!1),this._selectedRows},setGlobalOpacity:function(a,b){var c=this;this._skipInvalidateOnGlobalOpacityChange=!1,this._globalAlpha=a,b||setTimeout(function(){c._skipInvalidateOnGlobalOpacityChange||(f.call(c),c.invalidateDisplay("MapLayer.setGlobalOpacity"),c._skipInvalidateOnGlobalOpacityChange=!0)},100)},setPreselectionMode:function(a){this._preselectionMode=a},toggleShapes:function(a){var b,c,d,e=a?a.length:0;if(this.isVisible()&&0!==e)for(this._skipInvalidateOnGlobalOpacityChange=!0,b=0;b<e;b++)d=a[b],(d.id===-3||d.id>=0)&&(d.selected&&this._toggledOnCacheItems.indexOf(d)<0?(this._toggledOnCacheItems[this._toggledOnCacheItems.length]=d,this._toggleOnCacheItemsChanged=!0):d.selected||(c=this._toggledOnCacheItems.indexOf(d))>=0&&(this._toggledOnCacheItems.splice(c,1),this._toggleOnCacheItemsChanged=!0))},selectOnLayer:function(a,b){this.isVisible()&&(this._toggledOnCacheItems.length?g.call(this,b):a&&a.length&&a.every(function(a){return!a.selected})&&this.clearSelections())},clearSelections:function(){this.updateBackendApi(),this.selectionsApi.clear()},updateBackendApi:function(){this.backendApi&&this.backendApi.path!==this._layerPath&&(this.backendApi.path=this._layerPath,this.backendApi.path&&(this.backendApi.dataPath=this.backendApi.path.slice(1,-3)))},afterPaint:function(){},clear:function(){this._renderer&&this._renderer.shapes&&this._renderer.shapes.length&&(this._renderer.shapes=[],this._renderer.render(),this.afterPaint())},updateSize:function(){this._super(),this.rect.x*=this.layoutToContainerRatios.x||1,this.rect.width*=this.layoutToContainerRatios.x||1,this.rect.y*=this.layoutToContainerRatios.y||1,this.rect.height*=this.layoutToContainerRatios.y||1,this.layoutToContainerRatios={x:1,y:1};for(var a in this.renderers)this.renderers[a].setDimensions(0,0,this.rect.width,this.rect.height),this.renderers[a].setDimensionsToContainerRatio(this.layoutToContainerRatios.x,this.layoutToContainerRatios.y);this._windowSizeMultiplier=Math.min(Math.min(this.rect.width,this.rect.height)/600,1)},release:function(){this._super(),this._viewportProjection&&(this._viewportProjection.stopListen("changed"),this._viewportProjection.stopListen("changedByInteraction")),this._viewportProjection=null,this.backendApi=null}})}),define("extensions.qliktech/map/geo-region",["general.utils/shapes/rect","general.utils/shapes/geometry-math"],function(a,b){"use strict";function c(a,b){var c=a?a.length:0,d=[];if(this._id=b,0===c)return void this.setGeoPolygons(d);this.setGeoPolygons(a)}return c.prototype={setId:function(a){this._id=a},getId:function(){return this._id},setGeoPolygons:function(a){this.geopolygons!==a&&(this.geopolygons=a,this._numGeoPolygons=this.geopolygons?this.geopolygons.length:0,this._numPoints=0,this._centerPoint=null,this._boundsNeedToUpdate=!0,this._pointsNeedToUpdate=!0,this._numPointsNeedToUpdate=!0)},validateGeoPolygons:function(){var a;for(a=0;a<this._numGeoPolygons;a++)this.geopolygons[a].validatePolygons()},getGeoPolygons:function(){return this.geopolygons},getNumGeoPolygons:function(){return this._numGeoPolygons},getNumPoints:function(){if(this._numPointsNeedToUpdate){var a,b=0;for(a=0;a<this._numGeoPolygons;a++)b+=this.geopolygons[a].getNumPoints();this._numPoints=b,this._numPointsNeedToUpdate=!1}return this._numPoints},getPoints:function(){if(this._pointsNeedToUpdate){this.points=[];var a;for(a=0;a<this._numGeoPolygons;a++)this.geopolygons[a]&&(this.points=this.points.concat(this.geopolygons[a].getPoints()))}return this.points},pointInside:function(a,b){if(this.calculateBounds(),void 0===this._bounds||a<=this._bounds.x||a>=this._bounds.x+this._bounds.width||b<=this._bounds.y||b>=this._bounds.y+this._bounds.height)return!1;var c;for(c=0;c<this._numGeoPolygons;c++)if(this.geopolygons[c].pointInside(a,b))return!0;return!1},intersectsLine:function(a){if(!a)return!1;var b;for(b=0;b<this._numGeoPolygons;b++)if(this.geopolygons[b].intersectsLine(a))return!0;return!1},intersectsRect:function(a){if(!a)return!1;var b;for(b=0;b<this._numGeoPolygons;b++)if(this.geopolygons[b].intersectsRect(a))return!0;return!1},calculateBounds:function(){if(this._boundsNeedToUpdate||!this._bounds){if(this._boundsNeedToUpdate=!1,0===this._numGeoPolygons)return null;var c=b.calculateBounds(this.geopolygons);this._bounds=new a(c.x,c.y,c.width,c.height)}return this._bounds},getBoundingRect:function(){return this.calculateBounds()},toString:function(){var a,b="";for(a=0;a<this._numGeoPolygons-1;a++)b+=this.geopolygons[a].toString()+";";return b+=this.geopolygons[this._numGeoPolygons-1].toString()}},c}),define("extensions.qliktech/map/geo-regions-data",["core.utils/class","general.utils/shapes/point","general.utils/shapes/rect","general.utils/shapes/geometry-math","objects.views/charts/utils/unit-projection"],function(a,b,c,d,e){function f(){var a,b,c,d,e,f,g,h,i,j;for(this._projectedGeoRegions&&this._projectedGeoRegions.length===this._numGeoRegions||(this._projectedGeoRegions=new Array(this._numGeoRegions)),a=0;a<this._numGeoRegions;a++)for(e=this._geoRegions[a].getGeoPolygons(),f=e?e.length:0,this._projectedGeoRegions[a]&&this._projectedGeoRegions[a].length===f||(this._projectedGeoRegions[a]=new Array(f)),b=0;b<f;b++)for(g=e[b].getPolygons(),h=g?g.length:0,this._projectedGeoRegions[a][b]&&this._projectedGeoRegions[a][b].length===h||(this._projectedGeoRegions[a][b]=new Array(h)),c=0;c<h;c++)for(i=g[c].points,j=i?i.length:0,this._projectedGeoRegions[a][b][c]&&this._projectedGeoRegions[a][b][c].length===j||(this._projectedGeoRegions[a][b][c]=new Array(j)),d=0;d<j;d++)this._projectedGeoRegions[a][b][c][d]=this._projection.project(i[d])}function g(){var a;for(this._regionIdToRegionIndexMapping={},a=0;a<this._numGeoRegions;a++)this._regionIdToRegionIndexMapping[this._geoRegions[a].getId()]=a}return a.extend("GeoRegionsData",{init:function(){this._numGeoRegions=0,this._mapBoundsNeedToUpdate=!0,this._projectedMapBoundsNeedToUpdate=!0,this._regionIdToRegionIndexMappingNeedToUpdate=!0,this._projectedGeoRegionsNeedToUpdate=!1,this._projection=new e,this._numPointsNeedToUpdate=!0},getNumGeoRegions:function(){return this._numGeoRegions},getNumPoints:function(){if(this._numPointsNeedToUpdate){var a,b=0;for(a=0;a<this._numGeoRegions;a++)b+=this._geoRegions[a].getNumPoints();this._numPoints=b,this._numPointsNeedToUpdate=!1}return this._numPoints},setGeoRegions:function(a){this._geoRegions=a,this._numGeoRegions=this._geoRegions?this._geoRegions.length:0,this._projectedGeoRegionsNeedToUpdate=!0,this._mapBoundsNeedToUpdate=!0,this._projectedMapBoundsNeedToUpdate=!0,this._regionIdToRegionIndexMappingNeedToUpdate=!0},getGeoRegions:function(){return this._geoRegions},getGeoRegionById:function(a){this._regionIdToRegionIndexMappingNeedToUpdate&&(g.call(this),this._regionIdToRegionIndexMappingNeedToUpdate=!1);var b=this._regionIdToRegionIndexMapping[a];return this._geoRegions[b]},setProjection:function(a){this._projection&&a&&this._projection.getProjectionType()===a.getProjectionType()||(this._projection=a,this._projectedGeoRegionsNeedToUpdate=!0,this._projectedMapBoundsNeedToUpdate=!0)},getProjection:function(){return this._projection},getProjectedGeoRegions:function(){return this._projectedGeoRegionsNeedToUpdate&&this._projection&&(f.call(this),this._projectedGeoRegionsNeedToUpdate=!1),this._projectedGeoRegions},getProjectedGeoRegionById:function(a){this._regionIdToRegionIndexMappingNeedToUpdate&&(g.call(this),this._regionIdToRegionIndexMappingNeedToUpdate=!1),this._projectedGeoRegionsNeedToUpdate&&this._projection&&(f.call(this),this._projectedGeoRegionsNeedToUpdate=!1);var b=this._regionIdToRegionIndexMapping[a];return this._projectedGeoRegions[b]},calculateBounds:function(){if(this._mapBoundsNeedToUpdate){this._mapBoundsNeedToUpdate=!1;var a=d.calculateBounds(this._geoRegions);this._mapBounds=a?new c(a.x,a.y,a.width,a.height):null}return this._mapBounds},calculateProjectedBounds:function(){if(this._projectedMapBoundsNeedToUpdate){this._projectedMapBoundsNeedToUpdate=!1;var a,d,e=this.calculateBounds();e?(a=this._projection.project(new b(e.x,e.y)),d=this._projection.project(new b(e.x+e.width,e.y+e.height)),this._projectedMapBounds=new c(a.x,a.y,d.x-a.x,d.y-a.y)):this._projectedMapBounds=null}return this._projectedMapBounds},calculateBoundsOfRegionIds:function(a){var b,e,f=a?a.length:0,g=new Array(f);for(b=0;b<f;b++)g[b]=this.getGeoRegionById(a[b]);return e=d.calculateBounds(g),e?new c(e.x,e.y,e.width,e.height):null},calculateProjectedBoundsOfRegionIds:function(a){var d,e,f,g=this.calculateBoundsOfRegionIds(a);return g?(d=this._projection.project(new b(g.x,g.y)),e=this._projection.project(new b(g.x+g.width,g.y+g.height)),f=new c(d.x,d.y,e.x-d.x,e.y-d.y)):f=null,f}})}),define("extensions.qliktech/map/geo-polygon",["general.utils/shapes/polygon","general.utils/shapes/rect","general.utils/shapes/line","general.utils/shapes/point","general.utils/shapes/geometry-math"],function(a,b,c,d,e){"use strict";function f(a){var b,c=a?a.length:0,e=Math.floor(c/2),f=new Array(e);for(b=0;b<e;b++)f[b]=new d(a[2*b],a[2*b+1]);return f}function g(a,b){var c,d=b-1;if(0===b)return-1;for(c=0;c<d;)if(a[c].x+180<p){if(a[c+1].x+180<p)return c;c+=2}else c++;return-1}function h(a,b,c){var d,e;return d=a[c],e=a[c+1],180-Math.abs(d.x)<p&&180-Math.abs(e.x)<p}function i(a,b){return b<0?b+a:b>=a?b-a:b}function j(a,b,c){var d=b-1;if(h(a,b,i(d,c+2))){if(0===c){if(a[b-2].x>=0)return!0}else if(c===b-2){if(a[b-3].x>=0)return!0}else if(a[c-1].x>=0)return!0}else if(h(a,b,i(d,c-2))){if(0===c){if(a[2].x>=0)return!0}else if(c===b-2){if(a[1].x>=0)return!0}else if(a[c+2].x>=0)return!0}else if(0===c){if(a[b-2].x>=0&&a[2].x>=0)return!0}else if(c===b-2){if(a[b-3].x>=0&&a[1].x>=0)return!0}else if(a[c-1].x>=0&&a[c+2].x>=0)return!0;return!1}function k(a,b,c){0===c?(a[c].x=180,a[c+1].x=180,a[b-1].x=180):c===b-2?(a[c].x=180,a[c+1].x=180,a[0].x=180):(a[c].x=180,a[c+1].x=180)}function l(){var a,b,c=this.calculateBounds(),d=q.length;for(a=0;a<d;a++)if(b=q[a],b.rectInside(c))return!0}function m(a){var b,c=a?a.points:null,d=c?c.length:0;(b=g(c,d))<0||j(c,d,b)&&k(c,d,b)}function n(a){var b,c=a?a.length:0;for(b=0;b<c;b++)m(a[b])}function o(b){var c,d=b?b.length:0,e=[];if(0===d)return void this.setPolygons(e);if(b[0].getPoints)this.setPolygons(b);else{for(c=0;c<d;c++)b[c]&&b[c].length&&e.push(new a(f(b[c])));this.setPolygons(e)}}var p=1e-5,q=[new b(-177,-44.5,1,1),new b(-178.6,-30.5,1,1.5)];return o.prototype={setPolygons:function(a){this.polygons!==a&&(this.polygons=a,this._numPolygons=this.polygons?this.polygons.length:0,this._numPoints=0,this._centerPoint=null,this._boundsNeedToUpdate=!0,this._pointsNeedToUpdate=!0,this._numPointsNeedToUpdate=!0)},validatePolygons:function(){n(this.polygons),l.call(this)&&this.translate(360,0)},getPolygons:function(){return this.polygons},getNumPolygons:function(){return this._numPolygons},getPoints:function(){if(this._pointsNeedToUpdate){this.points=[];var a;for(a=0;a<this._numPolygons;a++)this.polygons[a]&&(this.points=this.points.concat(this.polygons[a].getPoints()))}return this.points},getNumPoints:function(){if(this._numPointsNeedToUpdate){var a,b=0;for(a=0;a<this._numPolygons;a++)b+=this.polygons[a].getNumPoints();this._numPoints=b,this._numPointsNeedToUpdate=!1}return this._numPoints},pointInside:function(a,b){if(this.calculateBounds(),void 0===this._bounds||a<=this._bounds.x||a>=this._bounds.x+this._bounds.width||b<=this._bounds.y||b>=this._bounds.y+this._bounds.height)return!1;var c,d,e;if(0===this._numPolygons)return!1;if(this.polygons[0].pointInside(a,b)){for(d=this._innerPolygons?this._innerPolygons.length:0,c=0;c<d;c++)if(this.polygons[this._innerPolygons[c]].pointInside(a,b))return!1;return!0}for(e=this._outerPolygons?this._outerPolygons.length:0,c=0;c<e;c++)if(this.polygons[this._outerPolygons[c]].pointInside(a,b))return!0;return!1},intersectsLine:function(a){if(!a)return!1;if(this.pointInside(a.x1,a.y1)||this.pointInside(a.x2,a.y2))return!0;var b;for(b=0;b<this._numPolygons;b++)if(this.polygons[b].intersectsLine(a))return!0;return!1},intersectsLines:function(a){var b,c=a?a.length:0;for(b=0;b<c;b++)if(this.intersectsLine(a[b]))return!0;return!1},intersectsRect:function(a){if(!a)return!1;if(this.calculateBounds(),!this._bounds)return!1;if(a.rectInside(this._bounds))return!0;if(!this._bounds.intersectsWith(a))return!1;var b,d,e,f,g;return b=a.x,d=a.getRight(),e=a.y,f=a.getBottom(),!!(this.pointInside(b,e)||this.pointInside(d,e)||this.pointInside(d,f)||this.pointInside(b,f))||(g=[new c(b,e,d,e),new c(b,f,d,f),new c(b,e,b,f),new c(d,e,d,f)],this.intersectsLines(g))},calculateBounds:function(){if(this._boundsNeedToUpdate||!this._bounds){if(this._boundsNeedToUpdate=!1,0===this._numPolygons)return null;var a,c,d,f=e.calculateBounds(this.polygons);for(this._bounds=new b(f.x,f.y,f.width,f.height),a=this.polygons[0].calculateBounds(),this._innerPolygons=[],this._outerPolygons=[],d=1;d<this._numPolygons;d++)c=this.polygons[d].calculateBounds(),a.rectInside(c)&&this.polygons[0].pointInside(this.polygons[d].points[0].x,this.polygons[d].points[0].y)?this._innerPolygons.push(d):this._outerPolygons.push(d)}return this._bounds},getBoundingRect:function(){return this.calculateBounds()},translate:function(a,b){if(a||b){for(var c=0;c<this._numPolygons;c++)this.polygons[c].translate(a,b);this._boundsNeedToUpdate=!0}},toString:function(){var a,b="";for(a=0;a<this._numPolygons-1;a++)b+=this.polygons[a].toString()+";";return b+=this.polygons[this._numPolygons-1].toString()}},o}),define("extensions.qliktech/map/map-polygon3-layer",["extensions.qliktech/map/map-layer","objects.views/selections/cache-item-base","general.utils/color","general.utils/shapes/point","general.utils/shapes/polygon","extensions.qliktech/map/geo-region","extensions.qliktech/map/geo-regions-data","extensions.qliktech/map/geo-polygon","core.utils/deferred"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(){return this._showExcluded?this._allItemsS2Bounds:k.call(this)}function k(){var a,b=new Array(this._numItems);for(a=0;a<this._numItems;a++)b[a]=this._qMatrix[a][0].qText;return"$mercator"!==this._geoData.qMeasureInfo[0].projection?this._geoRegionsData.calculateProjectedBoundsOfRegionIds(b):this._geoRegionsData.calculateBoundsOfRegionIds(b)}function l(){return this._qData&&this._qData.qDimensionInfo&&this._qData.qDimensionInfo[0]?this._dimensionTitle!==this._qData.qDimensionInfo[0].qFallbackTitle&&(this._dimensionTitle=this._qData.qDimensionInfo[0].qFallbackTitle,!0):void 0!==this._dimensionTitle&&(this._dimensionTitle=void 0,!0)}function m(){var a=this._geoData.qMeasureInfo.length;return JSON.stringify(this._geometryMeasureInfo)!==JSON.stringify(this._geoData.qMeasureInfo[a-1])?(this._geometryMeasureInfo=this._geoData.qMeasureInfo[a-1],!0):!this._rawGeoRegions&&!this._loadingGeometryData}function n(a){var b,c=a?a.length:0;for(b=0;b<c;b++)a[b]=new d(a[b][0],a[b][1]);return new e(a)}function o(a){var b,c=a?a.length:0,d=new Array(c);for(b=0;b<c;b++)d[b]=n(a[b]);return new h(d)}function p(a,b){var c,d="-"===b?[]:JSON.parse(b),e=d.length;for(c=0;c<e;c++)d[c]=o(d[c]);return new f(d,a)}function q(a){this._rawGeoRegions=a,this._geoRegionsData.setGeoRegions(a),"$mercator"!==this._geoData.qMeasureInfo[0].projection&&this._geoRegionsData.setProjection(this._viewportProjection.getMercatorProjection()),this._allItemsS2Bounds=this._geoRegionsData.calculateProjectedBounds(),this.fire("boundsChanged",[this]),this._regionsChanged=!0}function r(){var a=this,b=this._layerIndex,c=Math.min(this._geoData.qSize.qcy||v,v),d=[{qTop:0,qLeft:0,qWidth:2,qHeight:c}];this._loadingGeometryData=!0;var e=i();return this.backendApi.getData(d,"/layers/"+b+"/geodata/qHyperCubeDef").then(function(b){if(!a.backendApi||!a._viewportProjection)return void e.resolve();a._loadingGeometryData=!1,a._rawGeoRegions={};var c,d,f,g,h,j=0,k=b?b instanceof Array&&b[0]?b[0].qMatrix:b.qMatrix:void 0;for(h=k?k.length:0,a._geoDataCubeMatrix=k,a._numRegions=h,a._geometryDimensionIdx=1,f=new Array(h),c=0;c<h;c++)g=k[c][0].qText,d=k[c][a._geometryDimensionIdx].qText,f[c]=p(g,d),f[c].validateGeoPolygons(),j+=f[c].getNumPoints();q.call(a,f),a._dataChanged=!0,a.fire("dataChanged"),a._numPoints!==j&&(a._numPoints=j,a.fire("numPointsChanged",[a])),i.all([a.invalidateProperties("MapPolygonLayer.setGeoRegionsData"),a.invalidateDisplay("MapPolygonLayer.setGeoRegionsData")]).then(function(){e.resolve()})}),e.promise}function s(a,b){var c,d,f,g,i,j,k,l,m,n=a?a.length:0,o=new Array(n);for(j=0;j<n;j++){for(c=a[j],d=c?c.length:0,m=new Array(d),k=0;k<d;k++){for(f=c[k],i=f?f.length:0,g=new Array(i),l=0;l<i;l++)g[l]=this._viewportProjection.project(f[l]);m[k]=new e(g)}o[j]=new h(m)}b.setGeoPolygons(o)}function t(a){return void 0===a||null===a||""===a}function u(a,c,d,e,f){var g=new b([a],[],[],[],c,0,d);return g.selected=!1,g.layerIndex=f,g.addShape("dataArea",e,!0),g}var v=3333,w=new c("#ddd");return a.extend("MapPolygonLayer",{init:function(){this._super.apply(this,arguments),this._geoRegionsData=new g,this.renderers={polygonlayer:this._renderer},this._numRegions=0},setLayerIndex:function(a){this._layerIndex=a,this._layerPath="/layers/"+this._layerIndex+"/geodata/qHyperCubeDef"},getDataType:function(){return"hyperCube"},setData:function(a,b){return this._super(a,b),this._qData=this._layerData?this._layerData.qHyperCube:void 0,this._geoData=this._layerData?this._layerData.geodata.qHyperCube:void 0,this._qMatrix=this._qData&&this._qData.qDataPages[0]?this._qData.qDataPages[0].qMatrix:void 0,this._numItems=this._qMatrix?this._qMatrix.length:0,this._qMeasureInfo=this._qData?this._qData.qMeasureInfo:void 0,this._hasMeasure=this._qMeasureInfo&&this._qMeasureInfo.length>0,this._geoDataHeight=this._geoData&&this._geoData.qSize?this._geoData.qSize.qcy:0,this._showExcluded=void 0===b.showExcluded||b.showExcluded,this.show&&(this._geoDataHeight!==this._numRegions||l.call(this)||m.call(this))?r.call(this):(this._dataChanged=!0,this.fire("dataChanged"),this.invalidateProperties("MapPolygonLayer.setData"))},hasValidData:function(){return this._super()&&this._layerData},getNumSelectedItems:function(){return this._numSelectedItems},getSelectedCacheItem:function(){return this._selectedCacheItem},paint:function(){if(this._super(this._layoutMode,this._layerData),this._rawGeoRegions){if(!this.show||!this._viewportProjection||!this._geoData||!this._geoData.qMeasureInfo||0===this._geoData.qMeasureInfo.length||t(this._geoData.qMeasureInfo[0].qFallbackTitle))return this._regionsChanged=!1,this._viewportProjectionChanged=!1,void this.clear();if(void 0===this._nodes&&this._updateProperties(),0!==this._numRegions){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o=this._geoDataCubeMatrix,p=this._hasMeasure?0:-1,q=[],r=[],u=0,v=0;for(n=this._rowIndexList?this._rowIndexList.length:0,this._selectionByLayer=this._preselectionMode||this._qSelectionInfo&&this._qSelectionInfo.qInSelections||this._nodes.some(function(a){return a.cacheItem.selected}),a=0;a<n;a++)b=this._rowIndexList[a],isNaN(b)||null===b||(c=o[b],d=c[0],e=d.qText,f=this._nodeMap[e],g=f.shapeWrapper,h=g.shape,i=this._geoRegionsData.getProjectedGeoRegionById(e),s.apply(this,[i,h]),j=f.cacheItem,k=f.index!==-1,m=f.color,!k&&j.selected&&(m=this._colorMap.getColor(d.qElemNumber,NaN,p,b)),g.fill=m.toRGBA(),this._selectionByLayer?(l=j.selected,g.stroke="#333",g.strokeWidth=l?2:1):(l=k,g.stroke="#333",g.strokeWidth=1),l?(g.opacity=1,r[v++]=g):(g.opacity=this._globalAlpha,q[u++]=g));this._rendererShapes=q.concat(r),this._renderer.shapes=this._rendererShapes,this._renderer.render(),this._regionsChanged=!1,this._viewportProjectionChanged=!1}}},getSnapshotLayerData:function(a){var b=Math.min(this._geoData.qSize.qcy||v,v);return this.backendApi.getData([{qTop:0,qLeft:0,qWidth:2,qHeight:b}],"/layers/"+this._layerIndex+"/geodata/qHyperCubeDef").then(function(b){a.geodata.qHyperCube.qDataPages=b})},_updateProperties:function(){if(this.show&&this._layerData&&this._dataChanged&&this._rawGeoRegions){var a,b,c,d,e,g,h,i,k,l,m,n,o,p,q=this._geoDataCubeMatrix,r=this._qData&&this._qData.qDimensionInfo&&this._qData.qDimensionInfo[0],s=this._hasMeasure?0:-1,t=this._hasMeasure?this._qMeasureInfo[0].qFallbackTitle:"";if(this._regionsChanged=!0,this._numSelectedItems=0,this._regionIdDictionary={},this._nodeMap={},this._showExcluded)for(this._nodes=new Array(this._numRegions),m=new Array,this._rowIndexList=new Array(this._numRegions),a=0;a<this._numRegions;a++)c=q[a],d=c[0],g=d.qText,h=d.qElemNumber||0,i=new f(void 0,g),l=u(g,a,h,i,this._layerIndex),m[a]=l,k={type:"multipolygon",shape:i},this._nodeMap[g]=this._nodes[a]={shapeWrapper:k,cacheItem:l,color:w,index:-1},this._rowIndexList[a]=a;else{for(q=this._qMatrix,a=0;a<this._numItems;a++)g=q[a][0].qText,this._regionIdDictionary[g]=!0;for(this._nodes=new Array(this._numItems),m=new Array,this._rowIndexList=new Array(this._numItems),b=0,q=this._geoDataCubeMatrix,a=0;a<this._numRegions;a++)c=q[a],d=c[0],g=d.qText,this._regionIdDictionary[g]&&(h=d.qElemNumber||0,i=new f(void 0,g),l=u(g,a,h,i,this._layerIndex),m[b]=l,k={type:"multipolygon",shape:i},this._nodeMap[g]=this._nodes[b]={shapeWrapper:k,cacheItem:l,color:w,index:-1},this._rowIndexList[b]=a,b++)}for(q=this._qMatrix,a=0;a<this._numItems;a++)c=q[a],d=c[0],e=c[1],g=d.qText,(o=this._nodeMap[g])&&(i=o.shapeWrapper.shape,i.rowIndex=a,l=o.cacheItem,n=this._hasMeasure?e.qNum:null,o.color=this._colorMap.getColor(d.qElemNumber,n,s,a),this._hasMeasure&&l.addMeasure(t,n,e.qText),d.qAttrDims&&r.qAttrDimInfo&&r.qAttrDimInfo.length&&d.qAttrDims.qValues.forEach(function(a,b){l.addAttributeDimension(a.qElemNo,a.qText,r.qAttrDimInfo[b].qFallbackTitle)}),d.qAttrExps&&r.qAttrExprInfo&&r.qAttrExprInfo.length&&d.qAttrExps.qValues.forEach(function(a,b){l.addMeasure(r.qAttrExprInfo[b].label,a.qNum)}),o.index=a,this._selectedCacheItem=l);this._numSelectedItems=this._numItems,this.setSelectableShapes(m),this.fire("selectableShapesChanged"),this._dataChanged=!1,p=j.call(this),p&&p.equal(this._layerS2Bounds)||(this._layerS2Bounds=p,!this._layerS2Bounds||0===this._layerS2Bounds.width&&0===this._layerS2Bounds.height||this.fire("boundsChanged",[this]))}}})}),define("core.models/session-object",["core.models/generic-object","core.models/app"],function(a,b){"use strict";var c;return c=a.extend("SessionObject",{remove:function(){return c.remove(this.id,b.current)}}),c.get=function(a,c){function d(){return c.enigmaModel.createSessionObject(a)}var e=a.qInfo.qId||a.qInfo.qType;if(!e)throw new Error("no id");return a.qInfo.qId=e,c=c||b.current,this.getModel(e,c.session,d)},c.remove=function(b,c){return a.remove(b,"DestroySessionObject",c)},c.extend=function(){var b=a.extend.apply(this,arguments);return b.get=c.get,b.remove=c.remove,b},c}),define("extensions.qliktech/map/map-glyph-layer",["extensions.qliktech/map/map-layer","extensions.qliktech/scatterplot/scatter-helper","objects.views/selections/cache-item-combo","general.utils/shapes/rect","core.models/session-object"],function(a,b,c,d,e){"use strict";function f(){var a,b,c,e,f,g=Number.MAX_VALUE,h=Number.MAX_VALUE,i=-Number.MAX_VALUE,j=-Number.MAX_VALUE;for(a=0;a<this._numItems;a++)b=this._nodes[a].shapeWrapper.shape,!(c=b.position)||isNaN(c.x)||isNaN(c.y)||(g=Math.min(g,c.x),h=Math.min(h,c.y),i=Math.max(i,c.x),j=Math.max(j,c.y));return g===Number.MAX_VALUE||h===Number.MAX_VALUE||i===-Number.MAX_VALUE||j===-Number.MAX_VALUE?void 0:(e=i-g,f=j-h,0===e&&this._wholeBoundingBox&&this._totalNumPoints&&(e=Math.abs(this._wholeBoundingBox.qRight-this._wholeBoundingBox.qLeft)/this._totalNumPoints,g-=e/2),0===f&&this._wholeBoundingBox&&this._totalNumPoints&&(f=Math.abs(this._wholeBoundingBox.qTop-this._wholeBoundingBox.qBottom)/this._totalNumPoints,h-=f/2),new d(g,h,e,f))}function g(){var a,c,d,e,f;for(a=0;a<this._numItems;a++)if(d=this._nodes[a].shapeWrapper.shape)if(0===d.type)d.position?(e=this._viewportProjection.project(d.position),d.setPosition(e.x,e.y)):d.setPosition(NaN,NaN);else if(d.position){if(e=this._viewportProjection.project(d.position),!(f=d.points)||13!==f.length)for(f=new Array(13),c=0;c<13;c++)f[c]={};f=b.updateCross(f,e.x,e.y,3,1),d.set(f)}else d.set([])}function h(){this._hasMeasure?void 0===this._layerData.autoMinMax||this._layerData.autoMinMax===!0?(this._qMin=this._qMeasureInfo[0].qMin,this._qMax=this._qMeasureInfo[0].qMax):(this._qMin=void 0===this._layerData.customMin?0:this._layerData.customMin,this._qMax=void 0===this._layerData.customMax?10:this._layerData.customMax):(this._qMin=void 0,this._qMax=void 0)}function i(){return!isNaN(this._qMin)&&void 0!==this._qMin&&null!==this._qMin&&(!isNaN(this._qMax)&&void 0!==this._qMax&&null!==this._qMax&&!(this._qMax<this._qMin))}function j(){var a=this;if(this.backendApi&&this.backendApi.isSnapshot)return void a.fire("boundsChanged",[a]);var b=a._layerS2Bounds.x,c=a._layerS2Bounds.y,f=a._layerS2Bounds.width,g=a._layerS2Bounds.height;if(f>0||g>0)return f>0?(g=f/2,c-=g/2):g>0&&(f=g/2,b-=f/2),a._layerS2Bounds=new d(b,c,f,g),void a.fire("boundsChanged",[a]);var h=this._qDimensionInfo[1].qFallbackTitle;"="===h.substr(0,1)&&(h=h.substr(1)),"geomakepoint"!==h.substr(0,12).toLowerCase()&&(h="["+h+"]"),e.get({qInfo:{qId:h,qType:"PointStats"},pointsStatistic:{boundingBox:{qStringExpression:"GeoBoundingBox({1}"+h+")"},numPoints:{qValueExpression:"Count({1}"+h+")"}}}).then(function(b){return b.getLayout().then(function(b){var c=JSON.parse(b.pointsStatistic.boundingBox);if(!a._geoDataIsProjectedToS2){var e,f,g;e=a._viewportProjection.getMercatorProjection(),f=e.project({x:c.qLeft,y:c.qBottom}),g=e.project({x:c.qRight,y:c.qTop}),c.qLeft=f.x,c.qRight=g.x,c.qBottom=f.y,c.qTop=g.y}if(a._wholeBoundingBox=c,a._totalNumPoints=b.pointsStatistic.numPoints,a._layerS2Bounds&&(0===a._layerS2Bounds.width||0===a._layerS2Bounds.height)){var h,i,j,k;j=Math.abs(a._wholeBoundingBox.qRight-a._wholeBoundingBox.qLeft)/a._totalNumPoints,h=a._layerS2Bounds.x-j/2,k=Math.abs(a._wholeBoundingBox.qTop-a._wholeBoundingBox.qBottom)/a._totalNumPoints,i=a._layerS2Bounds.y-k/2,a._layerS2Bounds=new d(h,i,j,k),a.fire("boundsChanged",[a])}})})}return a.extend("MapPointLayer",{init:function(){this._super.apply(this,arguments),this.renderers={pointlayer:this._renderer},this._layerS2Bounds=void 0},setLayerIndex:function(a){this._layerIndex=a,this._layerPath="/layers/"+this._layerIndex+"/qHyperCubeDef"},getDataType:function(){return"hyperCube"},setData:function(a,b){return this._super(a,b),this._qData=this._layerData?this._layerData.qHyperCube:void 0,this._qMatrix=this._qData.qDataPages[0]?this._qData.qDataPages[0].qMatrix:void 0,this._qDimensionInfo=this._qData?this._qData.qDimensionInfo:void 0,this._qMeasureInfo=this._qData?this._qData.qMeasureInfo:void 0,this._numMeasures=this._qMeasureInfo?this._qMeasureInfo.length:0,this._hasMeasure=!!(this._numMeasures>0&&this._qMeasureInfo[0].qFallbackTitle),this._data&&this._data.color&&!this._data.color.persistent&&(this._data.color.persistent=!0),h.call(this),this._isValidMinMax=i.call(this),this._qRange=this._qMax-this._qMin,this._numItems=this._qMatrix?this._qMatrix.length:0,this._needUpdateProperties=!0,this._needPaint=!0,this._hasMeasure?this._maxDotSize=this._layerData.rangeBubbleSizes&&this._layerData.rangeBubbleSizes[1]?this._layerData.rangeBubbleSizes[1]:32:this._maxDotSize=this._layerData.bubbleSizes?this._layerData.bubbleSizes:8,this.fire("dataChanged"),this.invalidateProperties("MapPointLayer.setData")},hasValidData:function(){return this._super()&&this._qDimensionInfo&&this._qDimensionInfo[0]&&this._qDimensionInfo[0].qFallbackTitle&&this._qDimensionInfo[1]&&this._qDimensionInfo[1].qFallbackTitle},getNumSelectedItems:function(){return this._numItems},getLayerBounds:function(){var a,b,c,d,e;return a=this._viewportProjection.getSize(),this._layerS2Bounds&&0!==this._layerS2Bounds.width&&0!==this._layerS2Bounds.height?(this._layerS2Bounds2=this._layerS2Bounds.clone(),a&&(e=2*(this._maxDotSize+1),c=a.x-e,d=a.y-e,b=Math.min(c/this._layerS2Bounds.width,d/this._layerS2Bounds.height),c=b*this._layerS2Bounds.width,d=b*this._layerS2Bounds2.height,b=Math.min(a.x/c,a.y/d),this._layerS2Bounds2.scale(b)),this._layerS2Bounds2):this._layerS2Bounds},paint:function(){if(this._super(this._layoutMode,this._data),!(this.show&&this._qDimensionInfo&&this._qDimensionInfo[0]&&this._qDimensionInfo[0].qFallbackTitle&&this._qDimensionInfo[1]&&this._qDimensionInfo[1].qFallbackTitle&&this._viewportProjection&&0!==this._qMatrix.length&&void 0!==this._qMatrix[0][1]))return this._glyphsChanged=!1,this._viewportProjectionChanged=!1,this._needPaint=!1,this.clear();if(void 0===this._nodes&&this._updateProperties(),void 0!==this._nodes){var a,b,c,d,e,f,h,i,j,k=[],l=[],m=0,n=0;for((this._glyphsChanged||this._viewportProjectionChanged)&&g.call(this),a=0;a<this._numItems;a++)b=this._nodes[a],i=b.shapeWrapper,(j=i.shape)&&j.position&&(c=b.color,d=b.cacheItem.selected,d?(e="#333",f=2,h=1,l[n++]=i):(e=c.createShiftedColor().toRGBA(),f=1,h=this._globalAlpha,k[m++]=i),i.stroke=e,i.strokeWidth=f,i.opacity=h);this._rendererShapes=0===this._numItems?[]:k.concat(l),this._renderer.shapes=this._rendererShapes,this._renderer.render(),this._glyphsChanged=!1,this._viewportProjectionChanged=!1,this._needPaint=!1,this.afterPaint()}},setRect:function(a,b,c,d){this._super(a,b,c,d),this.rect&&this.rect.x===a&&this.rect.y===b&&this.rect.width===c&&this.rect.height===d||!this._layerS2Bounds||0===this._layerS2Bounds.width&&0===this._layerS2Bounds.height||this.fire("boundsChanged",[this])},getSnapshotLayerData:function(a){var b=Math.min(this._qData.qSize.qcy||3333,3333);return this.backendApi.getData([{qTop:0,qLeft:0,qWidth:3,qHeight:b
}],"/layers/"+this._layerIndex+"/qHyperCubeDef").then(function(b){a.qHyperCube.qDataPages=b})},_updateProperties:function(){if(this.show&&this._needUpdateProperties&&this._qDimensionInfo&&this._qDimensionInfo[0]&&this._qDimensionInfo[0].qFallbackTitle&&this._qDimensionInfo[1]&&this._qDimensionInfo[1].qFallbackTitle){var a,d,e,g,h,i,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=this._qMatrix,z=this._hasMeasure?0:-1,A=this._qDimensionInfo&&this._qDimensionInfo[1];for(v=this._layerData.rangeBubbleSizes&&this._layerData.rangeBubbleSizes[0]?this._layerData.rangeBubbleSizes[0]:2,w=this._layerData.rangeBubbleSizes&&this._layerData.rangeBubbleSizes[1]?this._layerData.rangeBubbleSizes[1]:32,u=this._layerData.bubbleSizes?this._layerData.bubbleSizes:8,this._glyphsChanged=!0,this._nodes=new Array(this._numItems),n=[],o={},p=0,this._geoDataIsProjectedToS2=this._qDimensionInfo&&this._qDimensionInfo[1]&&this._qDimensionInfo[1].qTags&&this._qDimensionInfo[1].qTags.indexOf("$mercator")>-1,s=this._viewportProjection.getMercatorProjection(),d=0;d<this._numItems;d++)g=y[d][0].qText,h=y[d][0].qElemNumber||0,i=y[d][2]?y[d][2].qNum:void 0,a=y[d][1],this._hasMeasure?this._isValidMinMax?(t=b.getDotRadius(i,this._qMin,this._qMax,v,w),isNaN(t)?(k=b.createShape("polygon"),k.type=1,l="polygon"):(k=b.createShape("circle",[0,0,t,0]),k.type=0,l="circle")):(k=b.createShape("polygon"),k.type=1,l="polygon"):(k=b.createShape("circle",[0,0,u,0]),k.type=0,l="circle"),"-"===y[d][1].qText?k.position=void 0:(e=y[d][1].qText.replace(/^\[|\]$/g,"").split(","),k.position=this._geoDataIsProjectedToS2?{x:e[0],y:e[1]}:s.project({x:Number(e[0]),y:Number(e[1])})),k.rowIndex=d,o[g]?m=o[g].cacheItem:(m=new c([g],[],[],[],d,0,h),m.selected=!1,m.layerIndex=this._layerIndex,o[g]={cacheItem:m,numShapes:0},n[p++]=m),m.addShape("dataArea",k,!0,[o[g].numShapes]),o[g].numShapes++,this._hasMeasure&&m.addMeasure(this._qMeasureInfo[0].qFallbackTitle,y[d][2].qNum,y[d][2].qText),a.qAttrDims&&A.qAttrDimInfo&&A.qAttrDimInfo.length&&a.qAttrDims.qValues.forEach(function(a,b){m.addAttributeDimension(a.qElemNo,a.qText,A.qAttrDimInfo[b].qFallbackTitle)}),a.qAttrExps&&A.qAttrExprInfo&&A.qAttrExprInfo.length&&a.qAttrExps.qValues.forEach(function(a,b){m.addMeasure(A.qAttrExprInfo[b].label,a.qNum)}),r=this._colorMap.getColor([y[d][0].qElemNumber,a.qElemNumber],i,z,d),q={type:l,fill:r.toRGBA(),shape:k},this._nodes[d]={shapeWrapper:q,cacheItem:m,color:r};this.setSelectableShapes(n),this.fire("selectableShapesChanged"),this._geofieldName!==this._qDimensionInfo[1].qFallbackTitle&&(this._geofieldName=this._qDimensionInfo[1].qFallbackTitle,this._wholeBoundingBox=void 0,this._totalNumPoints=void 0),this._dimensionTitle=this._qDimensionInfo[0].qFallbackTitle,this._needUpdateProperties=!1,x=f.call(this),x&&x.equal(this._layerS2Bounds)||(this._layerS2Bounds=x,!this._layerS2Bounds||0!==this._layerS2Bounds.width&&0!==this._layerS2Bounds.height||this._wholeBoundingBox?this.fire("boundsChanged",[this]):j.call(this))}}})}),define("extensions.qliktech/map/wmts-provider",[],function(){"use strict";return{getTileUrl:function(a){return"https://cartobase-"+(a||"a")+".global.ssl.fastly.net/light_all/${z}/${x}/${y}.png?api_key=837eb4e1cc983921567462bd3557215b06cccaea"},getAttributionLink:function(){return"&copy; <a href='http://www.openstreetmap.org/copyright'>OpenStreetMap</a> contributors, &copy; <a href='http://cartodb.com/attributions'>CartoDB</a>"}}}),define("extensions.qliktech/map/base-map-layer",["jquery","angular","objects.views/charts/components/chart-component","general.utils/shapes/rect","general.utils/shapes/point","openlayers","client.services/media-tool/media-tool-service","./wmts-provider","core.utils/deferred"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(){var a,b,c,d;(a=this._viewportProjection?this._viewportProjection.getViewRectangleInLatLong():void 0)&&(b=new f.Geometry.Point(a.x,a.y),b.transform(y,x),c=new f.Geometry.Point(a.x+a.width,a.y+a.height),c.transform(y,x),d=new f.Bounds,d.extend(b),d.extend(c),d.toBBOX(),this._openLayers.zoomToExtent(d))}function k(a){this._attribution=g.toHTML(a),this.fire("attributionChanged",[a])}function l(){var a,b;a=this._viewportProjection.getZoomLevel(),b=this._viewportProjection.getMapCenterInLatLong(),this.setMapCenter(b),this.setZoomLevel(a)}function m(){if(this._viewportProjection&&this.show){var a,b,c,d,e=!1;a=this.getZoomLevel(),b=this.getMapCenter(),c=this._viewportProjection.getZoomLevel(),d=this._viewportProjection.getMapCenterInLatLong(),b||(b=d),Math.abs(a-c)<.001&&(!d||d.closeTo(b,1e-6))||(this._viewportProjection.enabledChangeEvent=!1,e=e||this._viewportProjection.setZoomLevel(a),e=e||this._viewportProjection.setMapCenterInLatLong(b),this._viewportProjection.inResetZoomMode&&(this._viewportProjection.inResetZoomMode=!1,this._viewportProjection.fire("resetZoomFinished")),e&&this._viewportProjection.fire("changed"),this._viewportProjection.enabledChangeEvent=!0)}}function n(){this._dfd&&(this._dfd.resolve(),this._dfdResolved=!0),this._dfdPaint&&this._dfdPaint.resolve()}function o(){clearTimeout(this._safeGuardTimer)}function p(){if(this._openLayers&&this._openLayers.tileManager){var a=this._openLayers.tileManager.tileQueue[this._openLayers.id];if(a&&a.length)return}n.call(this)}function q(){clearTimeout(this._safeGuardTimer);var a=this;this._safeGuardTimer=setTimeout(function(){n.call(a)},500)}function r(){clearTimeout(this._safeGuardTimer);var a=this;this._safeGuardTimer=setTimeout(function(){n.call(a)},500)}function s(a){t.call(this),a.events.register("loadend",this,m),a.events.register("loadstart",this,o),a.events.register("loadend",this,p),a.events.register("moveend",this,q),this._openLayers.events.register("updatesize",this,r),this._openLayers.addLayer(a),this._openLayers.setBaseLayer(a),this._baseLayer=a}function t(){this._baseLayer&&(this._openLayers.removeLayer(this._baseLayer),this._baseLayer.events.unregister("loadend",this,m),this._baseLayer.events.unregister("loadstart",this,o),this._baseLayer.events.unregister("loadend",this,p),this._baseLayer.events.unregister("moveend",this,q)),this._openLayers.events.unregister("updatesize",this,r),this._baseLayer=void 0}function u(a,c){var d,e=a.urls,g=a.attribution||"";this._urls===e&&this._attribution===g||(b.equals(this._urls,e)||(this._urls=e,this._urls&&this._urls.some(function(a){return a&&a.trim()})?(d=new f.Layer.XYZ("XYZ",this._urls,{numZoomLevels:c,wrapDateLine:!0}),s.call(this,d)):t.call(this)),this._attribution!==g&&k.call(this,g))}function v(a){var c,d=a.urls,e=a.params||"";try{e=JSON.parse(e)}catch(a){return}this._urls===d&&this._params===e||(this._params=e,b.equals(this._urls,d)||(this._urls=d,this._urls?(c=new f.Layer.WMS("WMS",this._urls,this._params),s.call(this,c)):t.call(this)))}function w(a){var c,d=a.urls,e=a.params||"";try{e=JSON.parse(e)}catch(a){return}b.equals(this._urls,d)||(this._params=e,this._urls!==d&&(this._urls=d,this._urls?(c=new f.Layer.TMS("TMS",this._urls?this._urls:"blank",this._params),s.call(this,c)):t.call(this)))}var x,y,z,A=19,B=0;return function(){f.Map.prototype.adjustZoom=function(a){return a};var a=f.Element.hasClass;f.Element.hasClass=function(b,c){return b&&a(b,c)};var b=f.Event.observe;f.Event.observe=function(a,c,d,e){f.Util.getElement(a)&&b.apply(this,[a,c,d,e])},x=new f.Projection("EPSG:900913"),y=new f.Projection("EPSG:4326")}(),c.extend("BaseMapLayer",{init:function(){this._super.apply(this,arguments),this._attribution=null,this._mapCenter=null,this._zoomLevel=null,this._layerNames=["OSM","MQ-OSM","MQSatellite"],this._selectedLayerName="OSM",this._googleMapLayersAdded=!1,this._isBingMapUsed=!1,this._needToSetBackgroundMapType=!1;var b=this;a(this.container).css({width:"100%",height:"100%"}),function(){z=new f.Control.TouchNavigation({dragPanOptions:{enableKinetic:!0}}),b._openLayers=new f.Map({div:b.container,transitionEffect:null,zoomMethod:null,controls:[z],projection:new f.Projection("EPSG:900913"),displayProjection:new f.Projection("EPSG:4326"),maxExtent:new f.Bounds(-20037508.34,-20037508.34,20037508.34,20037508.34),displayOutsideMaxExtent:!0,numZoomLevels:A+1,wrapDateLine:!0}),!b._on&&b._openLayers.controls.length&&z.deactivate(),b._minZoomLevel=0,b._maxZoomLevel=A,j.call(b),b._zoomCenterInitialized=!1,b._viewportProjection&&(b.updateViewportToBaseMap(!1),b._zoomCenterInitialized=!0),b._ready=!0}()},getAttribution:function(){return void 0===this._attribution?"":this._attribution},setViewportProjection:function(a){this._viewportProjection!==a&&(this._viewportProjection&&(this._viewportProjection.stopListen("changed",l,this),this._viewportProjection.stopListen("changedByInteraction",l,this)),this._viewportProjection=a,this._viewportProjection&&(this._viewportProjection.listen("changed",l,this),this._viewportProjection.listen("changedByInteraction",l,this)),this.updateViewportToBaseMap(!0))},setRect:function(a,b,c,e){this._super(a,b,c,e),this._viewport=new d(a,b,c,e)},getViewport:function(){return this._viewport},setFirstAutoZoomed:function(a){this._firstAutoZoomed=a},getFirstAutoZoomed:function(){return this._firstAutoZoomed},hasValidSize:function(){if(!this._openLayers)return!1;var a=this._openLayers.getSize();return a&&a.w>0&&a.h>0},isReady:function(){return this._ready&&this._openLayers&&this._openLayers.layers&&this._openLayers.layers.length>0&&this._baseLayer},on:function(){this._on=!0},off:function(){this._on=!1,this._openLayers&&0!==this._openLayers.controls.length&&z.deactivate()},showComponent:function(){this._super(),this._openLayers&&this._openLayers.baseLayer&&this._openLayers.baseLayer.setVisibility(!0),this.updateViewportToBaseMap(!0)},hideComponent:function(){this._super(),this._openLayers&&this._openLayers.baseLayer&&this._openLayers.baseLayer.setVisibility(!1)},getMapCenter:function(){if(this.show&&this.isReady()&&this.hasValidSize()){var a=this._openLayers.getCenter();if(a)return a.transform(this._openLayers.getProjectionObject(),y),new e(a.lon,a.lat)}},setMapCenter:function(a){if(!(a&&this.show&&this.isReady()&&this.hasValidSize()))return!1;var b,c;return(!(b=this.getMapCenter())||!b.closeTo(a,1e-9))&&(this._mapCenter=a,c=new f.LonLat(a.x,a.y),c.transform(y,this._openLayers.getProjectionObject()),this._openLayers.setCenter(c),!0)},getZoomLevel:function(){return this.show&&this.isReady()&&this.hasValidSize()?this._openLayers.zoom:0},setZoomLevel:function(a){return!(!(this.show&&this._openLayers&&this.hasValidSize())||Math.abs(this.getZoomLevel()-a)<1e-4||!this.isReady())&&(this._zoomLevel=a,this._openLayers.zoomTo(a),!0)},panBy:function(a,b){return!!(this.show&&this.isReady()&&this.hasValidSize())&&(this._openLayers.moveByPx(a,b),!0)},fromLatLongToViewport:function(a){if(this.show&&this.isReady()&&this.hasValidSize()){var b,c;return b=new f.LonLat(a.x,a.y),b.transform(y,this._openLayers.getProjectionObject()),c=this._openLayers.getViewPortPxFromLonLat(b),new e(c.x,c.y)}},fromViewportToLatLong:function(a){if(this.show&&this.isReady()&&this.hasValidSize()){var b,c,d;return b=new f.Pixel(a.x,a.y),c=this._openLayers.getLonLatFromViewPortPx(b),d=this._openLayers.getProjectionObject(),c.transform(d,y),new e(c.lon,c.lat)}},updateViewportToBaseMap:function(a){var b,c,d,e,f=!1;return this._viewportProjection&&this.isReady()?(c=this._viewportProjection.getZoomLevel(),b=this._viewportProjection.getMapCenterInLatLong(),b=b||{x:0,y:0},c=Math.min(A,Math.max(B,c)),this.setMapCenter(b),this.setZoomLevel(c),a&&(d=this.getMapCenter(),e=this.getZoomLevel(),this._viewportProjection.enabledChangeEvent=!1,Math.abs(e-c)>1e-4&&(f=f||this._viewportProjection.setZoomLevel(e)),d&&b&&!d.closeTo(b)&&(f=f||this._viewportProjection.setMapCenterInLatLong(d)),f&&(this._viewportProjection.fire("changedByBaseMap"),this._viewportProjection.fire("changedByInteraction")),this._viewportProjection.enabledChangeEvent=!0),f):f},setData:function(a){this._super(a),this._dfdResolved||(clearTimeout(this._safeGuardTimer),n.call(this)),this._dfd=i(),this._dfdResolved=!1;var b,c,d;if(d=this._data.background.defaultMapService,d?(b={urls:[h.getTileUrl("a"),h.getTileUrl("b"),h.getTileUrl("c"),h.getTileUrl("d")],type:"XYZ",attribution:h.getAttributionLink()},c="XYZ"):(b=this._data.background.layers?this._data.background.layers[0]:{},c=b.type||"XYZ"),b&&(this._urls||b.urls))switch(c){case"XYZ":u.call(this,b,d?23:A+1);break;case"WMS":v.call(this,b);break;case"TMS":w.call(this,b)}if(this._openLayers&&this._baseLayer&&(B=this._openLayers.getMinZoom(),A=this._openLayers.getNumZoomLevels()+B-1,this._minZoomLevel===B&&this._maxZoomLevel===A||(this._minZoomLevel=B,this._maxZoomLevel=A,this.fire("maxMinZoomLevelChanged",[A,B]))),this._data&&this._data.background&&this._data.background.show&&(d||this._data.background.layers&&this._data.background.layers.length>0&&this._data.background.layers[0].urls&&this._data.background.layers[0].urls.length>0&&this._data.background.layers[0].urls.some(function(a){return a&&a.trim()}))){this.showComponent();var e=this;clearTimeout(this._safeGuardTimer),this._safeGuardTimer=setTimeout(function(){n.call(e)},500)}else this.hideComponent(),n.call(this);return this.fire("baseLayerChanged"),this.invalidateProperties("BaseMapLayer.setData"),this._dfd.promise},hasValidData:function(){return!0},paint:function(){this._super(this._layoutMode);var a,b,c;return this._openLayers&&(a=this._openLayers.getSize(),b=a.w,c=a.h,b!==this.rect.width||c!==this.rect.height)?(this._dfdPaint=i(),this._openLayers.updateSize(),this._dfdPaint.promise):i.resolve()},afterPaint:function(){},release:function(){this._super(),clearTimeout(this._safeGuardTimer),t.call(this),z.destroy(),this._openLayers.destroy()}})}),define("extensions.qliktech/map/layer-dependency",["objects.views/charts/events/event-launcher"],function(a){"use strict";function b(){this._layer&&(this._colorMapData=this._layer.getLayerOutputData(),this.fire("changed"))}return a.extend("LayerDependency",{init:function(){this._super()},setLayer:function(a){this._layer!==a&&(this._layer&&this._layer.stopListen("dataChanged",b,this),this._layer=a,this._layer&&this._layer.listen("dataChanged",b,this))},getColorMapData:function(){return this._colorMapData},release:function(){this._layer&&this._layer.stopListen("dataChanged",b,this),this._layer=null}})}),define("extensions.qliktech/map/map-area",["jquery","objects.views/charts/components/chart-component","general.utils/shapes/rect","core.utils/deferred","extensions.qliktech/map/map-polygon3-layer","extensions.qliktech/map/map-glyph-layer","extensions.qliktech/map/base-map-layer","extensions.qliktech/map/layer-dependency","objects.views/charts/utils/chart-formatting","touche"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(a){switch(a.type){case"polygon":return e;case"point":return f}return null}function k(a){var b;a.setLayoutMode(this._layoutMode),b=this.rect,a.setRect(b.x,b.y,b.width,b.height),b=this.outerRect,a.setOuterRect(b.x,b.y,b.width,b.height),b=this.containerRect,a.setContainerRect(b.x,b.y,b.width,b.height),b=this.layoutToContainerRatios,a.setLayoutToContainerRatios(b.x,b.y),a.setViewportProjection(this._viewportProjection)}function l(a,b,c,d){var e="layer."+d+"."+b+(void 0===c?"":c),f=new a(this.layersContainer,{clazz:a},e);return f.setLayerType(b),f.setVersion(c),f}function m(){var a,b,c,d,e,f,h,i;for(b=this._data?this._data.layers:null,d=b?b.length:0,d=Math.min(d,this._maxNumLayers),!this.baseMapLayer&&this._data&&this._data.background&&this._data.background.show&&(this._data.background.defaultMapService||this._data.background.layers&&this._data.background.layers.length>0&&this._data.background.layers[0].urls&&this._data.background.layers[0].urls.length>0&&this._data.background.layers[0].urls.some(function(a){return a&&a.trim()}))&&(this.addBaseMapLayer(new g(this.layersContainer,{clazz:g},"BaseMapLayer")),this.addAttributionLayer(document.createElement("div"))),a=0;a<d;a++)c=b[a],f=c.type,h=c.version,(i=j(c))&&(e=this.layers[a],e?e.getLayerType()===f&&e.getVersion()===h||this.removeLayer(e,!0):(e=l.apply(this,[i,f,h,a]),this.addLayer(e,a)));if(this._numLayers>d)for(a=d;a<this._numLayers;a++)(e=this._layers[a])&&this.removeLayer(e);this._numLayers=d,this.attributionLayer&&this.container.appendChild(this.attributionLayer)}function n(){for(var a=[],b=0;b<this._numLayers;b++)a.push(this.layers[b].setData(this._data,this._data.layers[b]));return this.baseMapLayer&&(a.push(this.baseMapLayer.setData(this._data)),u.call(this)),d.all(a)}function o(){this._numLayers<1||this.layers[this._numLayers-1].updateBackendApi()}function p(a,b){var c,d,e,f,g,h,i,j;a&&(c=a.x,d=a.x+a.width,e=a.y,f=a.y+a.height,g=b.x,h=b.x+b.width,i=b.y,j=b.y+b.height,c<g&&(c=g),d>h&&(d=h),e<i&&(e=i),f>j&&(f=j),a.set(c,e,d-c,f-e))}function q(){var a,b;for(a=0;a<this._numLayers;a++)(b=this.layers[a])&&!b.hasValidData()&&b.clear()}function r(){var a,b,c=Math.min(this._numLayers,this._maxNumLayers);for(a=0;a<c;a++)if((b=this._data.layers[a])&&b.qHyperCube&&b.qHyperCube.qDimensionInfo&&b.qHyperCube.qDimensionInfo.length>0)return this.layers[a]}function s(){this._colorMap.getLegendDataProvider().setLegendMarker("point"===this.coloredLayer.getLayerData().type?"circle":"rect")}function t(a,b){this._interactionController.setMaxZoomLevel(a),this._interactionController.setMinZoomLevel(b)}function u(){this.attributionLayer.innerHTML=this.baseMapLayer&&this.baseMapLayer.show&&this.baseMapLayer.isReady()?this.baseMapLayer.getAttribution():""}function v(){var a=this.baseMapLayer&&this.baseMapLayer.show&&this.baseMapLayer.isReady();this.map.setFractionalZoomMode(!a)}function w(){this.updateSelectableShapes()}function x(){var a,b,c,d,e,f,g=!1,h=!1,i=this._changedBoundsLayers?this._changedBoundsLayers.length:0;if(this.layersReady&&0!==i){for(b=0;b<this._numLayers;b++)this.layers[b].isVisible()&&(c=this.layers[b].getLayerBounds())&&(d=d?d.union(c):c.clone());if(this.map.isSnapshot()||this.map.options.viewState)try{e=(this.map.options.viewState||this.map.getSnapshotStoredChartData()).mapRect}catch(a){}if(f=e&&void 0!==e.width&&void 0!==e.height&&void 0!==e.x&&void 0!==e.y,d&&(0===d.width||0===d.height)&&f&&d.set(e.x,e.y,e.width,e.height),p.apply(this,[d,this._worldBounds]),void 0===d&&void 0===this._unionBounds?this._unionBounds=this._worldBounds:this._unionBounds=d,this._unionBounds&&this._unionBounds.hasNaN()&&(this._unionBounds=this._worldBounds),this._unionBounds&&void 0!==d){for(b=0;b<i;b++)(a=this._changedBoundsLayers[b])&&(g=!0,a.getFirstAutoZoomed()&&!this.map.getAutoZoomOnDataChange()||(this._unionBounds.width||this._unionBounds.height)&&(h=!0,a.setFirstAutoZoomed(!0)));g&&this.map.setMapBounds(this._unionBounds),h&&!f&&this.map.zoomOnMapBounds()}else 0===i&&this.baseMapLayer&&void 0===d&&!this.baseMapLayer.getFirstAutoZoomed()&&((void 0===this._unionBounds||this._unionBounds.hasNaN())&&(this._unionBounds=this._worldBounds),this.map.setMapBounds(this._unionBounds),!this._unionBounds.width||!this._unionBounds.height||this.map.isSnapshot()&&f||(this.map.zoomOnMapBounds(),this.baseMapLayer.setFirstAutoZoomed(!0)));this._changedBoundsLayers=[]}}function y(a){this._changedBoundsLayers.indexOf(a)===-1&&(this._changedBoundsLayers.push(a),x.call(this))}function z(){var a,b,c,d=0;for(a=0;a<this._numLayers;a++)b=this.layers[a],c=b&&b.getNumPoints?b.getNumPoints():0,d+=c;this.map.setZoomPanByWebkitTransform(d>D)}function A(){var a=this._layerDependency.getColorMapData();this._colorMap.setData(a,this.backendApi.model.layout.qInfo.qType);var b=this._colorMap.getColorDataInfo();b.valid&&b.legendPath&&(b.legendPath="/layers/0"+b.legendPath),this._legend.setData(a),this._chartContext.refresh(a),s.call(this),this.layersReady=!0,this.map.layersReadyDfd.resolve(),x.call(this)}function B(){this.attributionLayer&&(this.yMirrorMode?(this.attributionLayer.style.left="0",this.attributionLayer.style.right=""):(this.attributionLayer.style.left="",this.attributionLayer.style.right="0"))}var C,D=3e4,E=0;return C=b.extend("MapArea",{init:function(a,b){this._super.apply(this,Array.prototype.slice.call(arguments)),this.id="MapArea"+E++,this.layers=[],this._maxNumLayers=1,this._numLayers=0,this.options=b,this._unionBounds=void 0,this._worldBounds=new c(-180,-180,360,360),this._changedBoundsLayers=[],this._layerDependency=new h,this._layerDependency.listen("changed",A,this)},setYMirrorMode:function(a){this.yMirrorMode=a,B.call(this)},setMaxNumLayers:function(a){isNaN(a)&&(a=0),this._maxNumLayers=a},getMaxNumLayers:function(){return this._maxNumLayers},setData:function(a){var b=[];return this.layersReady=!1,this._data=a,m.call(this),o.call(this),this.coloredLayer=r.call(this),this.coloredLayer&&this._layerDependency.setLayer(this.coloredLayer),b.push(n.call(this)),q.call(this),this.coloredLayer&&this.map.setFormatter(new i(this.backendApi.localeInfo,this.coloredLayer.getMeasureInfo())),d.all(b)},addLayer:function(a,b){a&&(a.setLayerIndex(b),a.setBackendApi(this.backendApi),a.setSelectionsApi(this.selectionsApi),a.listen("selectableShapesChanged",w,this),a.listen("boundsChanged",y,this),a.listen("numPointsChanged",z,this),a.setColorMap(this._colorMap),k.call(this,a),this.layers[b]=a)},removeLayer:function(a,b){if(a){var c,d,e=this.layers.indexOf(a);a.stopListen("selectableShapesChanged",w,this),a.stopListen("boundsChanged",y,this),a.stopListen("numPointsChanged",z,this),a.clear(),a.release(),a.off(),a.container&&a.container.parentElement&&(c=a.container,d=c.parentElement,d.removeChild(c)),!b&&e>-1&&this.layers.splice(e,1)}},addBaseMapLayer:function(a){this.baseMapLayer||(this.baseMapLayer=a,this.layersContainer.insertBefore(a.container,this.layersContainer.firstChild),k.call(this,a),a.listen("maxMinZoomLevelChanged",t,this),a.listen("attributionChanged",u,this),a.listen("baseLayerChanged",v,this),this._on?a.on():a.off())},removeBaseMapLayer:function(){if(this.baseMapLayer){var a,b;this.baseMapLayer.stopListen("maxMinZoomLevelChanged",t,this),this.baseMapLayer.stopListen("attributionChanged",u,this),this.baseMapLayer.stopListen("baseLayerChanged",v,this),this.baseMapLayer.container&&this.baseMapLayer.container.parentElement&&(a=this.baseMapLayer.container,b=a.parentElement,b.removeChild(a))}},addAttributionLayer:function(a){this.attributionLayer||(this.attributionLayer=a,a.style.position="absolute",a.style.bottom="0",B.call(this),Touche(a).tap({id:".maparea",options:{preventDefault:!1},start:function(){Touche.preventGestures(this.gestureHandler)}}),this.container.appendChild(a))},removeAttributionLayer:function(){this.attributionLayer&&(Touche(this.attributionLayer).off(),this.container.removeChild(this.attributionLayer))},setBackendApi:function(a){this.backendApi=a;for(var b=0;b<this._numLayers;b++)this.layers[b].setBackendApi(a)},setSelectionsApi:function(a){this.selectionsApi=a;for(var b=0;b<this._numLayers;b++)this.layers[b].setSelectionsApi(a)},setMap:function(a){this.map=a},getMap:function(){return this.map},setViewportProjection:function(a){if(this._viewportProjection!==a){this._viewportProjection=a;for(var b=0;b<this._numLayers;b++)this.layers[b].setViewportProjection(this._viewportProjection);this.baseMapLayer&&this.baseMapLayer.setViewportProjection(this._viewportProjection)}},setColorMap:function(a){this._colorMap=a},getColorMap:function(){return this._colorMap},setLegend:function(a){this._legend=a},setChartContext:function(a){this._chartContext=a},setInteractionController:function(a){this._interactionController=a},setHasValidData:function(a){this._super(a);for(var b=0;b<this._numLayers;b++)this.layers[b].setHasValidData(a)},hasValidData:function(){return this._super()&&this._data},setLayoutMode:function(a){this._super(a);for(var b=0;b<this._numLayers;b++)this.layers[b].setLayoutMode(a);this.baseMapLayer&&this.baseMapLayer.setLayoutMode(a)},setRect:function(a,b,c,d){this._super(a,b,c,d);for(var e=0;e<this._numLayers;e++)this.layers[e].setRect(0,0,c,d);this.baseMapLayer&&this.baseMapLayer.setRect(0,0,c,d)},setOuterRect:function(a,b,c,d){this._super(a,b,c,d);for(var e=0;e<this._numLayers;e++)this.layers[e].setOuterRect(0,0,c,d);this.baseMapLayer&&this.baseMapLayer.setOuterRect(0,0,c,d)},setLayoutToContainerRatios:function(a,b){this._super(a,b);for(var c=0;c<this._numLayers;c++)this.layers[c].setLayoutToContainerRatios(a,b);this.baseMapLayer&&this.baseMapLayer.setLayoutToContainerRatios(a,b)},updateSize:function(){this._super(),this.rect.x*=this.layoutToContainerRatios.x||1,this.rect.width*=this.layoutToContainerRatios.x||1,this.rect.y*=this.layoutToContainerRatios.y||1,this.rect.height*=this.layoutToContainerRatios.y||1,this.layoutToContainerRatios={x:1,y:1};for(var a in this.renderers)this.renderers[a].setDimensions(0,0,this.rect.width,this.rect.height),this.renderers[a].setDimensionsToContainerRatio(this.layoutToContainerRatios.x,this.layoutToContainerRatios.y);this._windowSizeMultiplier=Math.min(Math.min(this.rect.width,this.rect.height)/600,1);for(var b=0;b<this._numLayers;b++)this.layers[b].updateSize();this.chartScale=1},setContainerRect:function(a,b,c,d){this._super(a,b,c,d);for(var e=0;e<this._numLayers;e++)this.layers[e].setContainerRect(0,0,c,d);this.baseMapLayer&&this.baseMapLayer.setContainerRect(0,0,c,d)},showComponent:function(){this._super();var a,b;for(a=0;a<this._numLayers;a++)for(b=0;b<this.layers[a].renderers.length;b++)this.layers[a].renderers[b].show();this.baseMapLayer&&(this.baseMapLayer.showComponent(),u.call(this))},hideComponent:function(){this._super();var a,b;for(a=0;a<this._numLayers;a++)for(b=0;b<this.layers[a].renderers.length;b++)this.layers[a].renderers[b].hide();this.baseMapLayer&&(this.baseMapLayer.hideComponent(),u.call(this))},hasVisibleLayer:function(){for(var a=0;a<this._numLayers;a++)if(this.layers[a].show)return!0;return!1},hasVisibleBaseLayer:function(){return this.baseMapLayer&&this.baseMapLayer.show},isVisible:function(a){return this._super(a)&&this.rect&&this.rect.width>0&&this.rect.height>0},clear:function(){for(var a=0;a<this._numLayers;a++)this.layers[a].clear()},release:function(){for(var a=0;a<this._numLayers;a++)this.layers[a].release();this.baseMapLayer&&(this.baseMapLayer.release(),this.baseMapLayer.stopListen("attributionChanged"),this.baseMapLayer.stopListen("baseLayerChanged")),this.attributionLayer&&Touche(this.attributionLayer).off(),this.map=null,this.baseMapLayer=null,this.backendApi=null},setGlobalOpacity:function(a,b){this._globalAlpha=a;for(var c=0;c<this._numLayers;c++)this.layers[c].setGlobalOpacity(a,b)},updateSelectableShapes:function(){if(0!==this._numLayers){var a,b,c;for(c=this.layers[0].getSelectableShapes(),a=1;a<this._numLayers;a++)(b=this.layers[a].getSelectableShapes())&&b.length>0&&(c=c.concat(b));this.setSelectableShapes(c)}},paint:function(a,b){var c=[];if(!this.layersReady||!b)return d.resolve();this._super(a,b);for(var e=0;e<this._numLayers;e++)this.layers[e].invalidateProperties("MapArea.paint"),c.push(this.layers[e].invalidateDisplay("MapArea.paint"));return this.baseMapLayer&&c.push(this.baseMapLayer.invalidateDisplay("MapArea.paint")),d.all(c)},isSelectionLocked:function(){return this._selectionLocked},setPreselectionMode:function(a){this._preselectionMode=a;for(var b=0;b<this._numLayers;b++)this.layers[b].setPreselectionMode(a)},_updateProperties:function(){this._data&&this.invalidateDisplay("MapArea._updateProperties")},_createRenderArea:function(){this.parentContainer&&(this.container=document.createElement("div"),this._$renderAreaWrap=a(this.container),this._$renderAreaWrap.attr("tid",this.testId),this._$renderAreaWrap.css({position:"absolute",overflow:"hidden"}).addClass("qv-chart-component"),this.parentContainer.appendChild(this.container),this.layersContainer=document.createElement("div"),this._$layersContainerWrap=a(this.layersContainer),this._$layersContainerWrap.css({position:"absolute",width:"100%",height:"100%"}),this.container.appendChild(this.layersContainer))}}),Object.defineProperty(C.prototype,"className",{value:"MapArea"}),C}),define("extensions.qliktech/map/map-handler",["objects.utils/data-properties/hypercube-handler","core.utils/deferred","general.utils/array-util","util"],function(a,b,c,d){"use strict";function e(){var a=d.generateId(),b={type:"polygon",version:"3",cId:a,show:!0,qHyperCubeDef:{qDimensions:[],qMeasures:[],qInitialDataFetch:[{qLeft:0,qTop:0,qWidth:2,qHeight:n}],qInterColumnSortOrder:[],qReductionMode:"N",qMode:"S",qCalcCond:this.properties.calcCond,customErrorMessage:this.properties.customErrorMessage},geodata:{qHyperCubeDef:{qDimensions:[],qMeasures:[],qInterColumnSortOrder:[],qReductionMode:"N",qMode:"S",qCalcCond:this.properties.calcCond,customErrorMessage:this.properties.customErrorMessage}},measureDef:""};return this.properties.layers.push(b),b}function f(a){var b,c,d=a?a.length:0;for(b=0;b<d;b++){if(c=a[b],c.qHyperCubeDef&&c.qHyperCubeDef.qDimensions&&1===c.qHyperCubeDef.qDimensions.length&&c.qHyperCubeDef.qDimensions[0].qDef&&(c.qHyperCubeDef.qDimensions[0].qLibraryId||c.qHyperCubeDef.qDimensions[0].qDef.qFieldDefs[0]))return c;if(c.qHyperCubeDef&&c.qHyperCubeDef.qDimensions&&2===c.qHyperCubeDef.qDimensions.length&&c.qHyperCubeDef.qDimensions[0].qDef&&(c.qHyperCubeDef.qDimensions[0].qLibraryId||c.qHyperCubeDef.qDimensions[0].qDef.qFieldDefs[0])&&c.qHyperCubeDef.qDimensions[1].qDef&&c.qHyperCubeDef.qDimensions[1].qDef.qFieldDefs[0])return c}}function g(){var a=this.properties.color;a.auto&&"primary"===a.mode&&(a.auto=!1,a.mode="byMeasure",this.updateGlobalChangeListeners())}function h(a){var b,c,d="";return b=void 0===a.tags?a.qTags:a.tags,c=void 0===a.name?a.qName:a.name,c="["+c+"]",b&&b.indexOf("$mercator")>-1&&(d="$mercator"),{qExpr:"GeoReduceGeometry({1}"+c+")",geoType:"polygon",projection:d}}function i(a){var b=h(a),c=b.qExpr,d=this.createExpressionMeasure(c,c);return d.qDef.projection=b.projection,d.qDef.qAggrFunc="None",d.qSortBy={qSortByLoadOrder:1,qSortByNumeric:-1},d}function j(a,b,c){var d,e;for(d=0;d<b.length&&(e=b[d],d!==b.length-1);++d)a&&(a[e]||(a[e]={}),a=a[e]);a&&(a[e]=c)}var k,l,m,n=3333;return m=[{qSortByState:1,qSortByAscii:1,qSortByNumeric:1,qSortByLoadOrder:1}],l={qDef:{qFieldDefs:[],qFieldLabels:[],qSortCriterias:[]}},k=a.extend({init:function(a){this._super(a),this.dimensionProperties=this.autoSortDimension(l)},rippleToHyperCubes:function(a,b){var c,d,e=a.split(".");for(c=0;c<this.properties.layers.length;++c)d=this.properties.layers[c],j(d.qHyperCubeDef,e,b),d.geodata&&j(d.geodata.qHyperCubeDef,e,b)},setProperties:function(a){a&&a.layers&&a.layers[0]&&"point"===a.layers[0].type&&a.color&&a.color.persistent===!1&&(a.color.persistent=!0),this._super(a)},getDimensions:function(a){return a||(a=f(this.properties.layers)),a&&a.qHyperCubeDef?a.qHyperCubeDef.qDimensions:[]},getMeasures:function(a){if(a||(a=f(this.properties.layers)),!a)return[];if(a.qHyperCubeDef){if("polygon"!==a.type)return a.qHyperCubeDef.qMeasures;var b=a.qHyperCubeDef.qMeasures;if(b&&b[0]&&(b[0].qLibraryId||b[0].qDef&&void 0!==b[0].qDef.qDef&&""!==b[0].qDef.qDef.trim()))return[b[0]]}return[]},getLayerType:function(a){return a||(a=f(this.properties.layers)),a?a.type:void 0},getLayerTypeAndVersion:function(a){return a||(a=f(this.properties.layers)),a?[a.type,a.version]:[void 0,void 0]},addPointLayer:function(){var a=d.generateId(),b={type:"point",cId:a,show:!0,opacity:1,qHyperCubeDef:{qDimensions:[],qMeasures:[],qInterColumnSortOrder:[],qInitialDataFetch:[{qLeft:0,qTop:0,qWidth:3,qHeight:n}],qReductionMode:"N",qMode:"S",qCalcCond:this.properties.calcCond,customErrorMessage:this.properties.customErrorMessage},useSize:!0,bubbleSizes:8,rangeBubbleSizes:[2,32],autoMinMax:!0,customMin:0,customMax:10};return this.properties.layers.push(b),void 0===this.properties.background&&(this.properties.background={}),this.properties.background.show=!0,void 0===this.properties.color&&(this.properties.color={}),this.properties.color.persistent=!0,b},canColorBy:function(){return this._super(this.properties&&this.properties.layers&&this.properties.layers.length?{qHyperCubeDef:this.properties.layers[0].qHyperCubeDef}:{qHyperCubeDef:{qDimensions:[],qMeasures:[]}})},addPolygonLayer:e,
autoSortDimension:function(a){return b.resolve(k.autoSortDimension(a))},createFieldDimension:function(a){var b=d.extend(!0,{},l);return b.qDef.qFieldDefs[0]=a,b.qDef.qFieldLabels[0]="",b},getLayers:function(){return this.properties.layers},getLayersWithoutMeasure:function(){var a=this;return this.properties.layers.filter(function(b){switch(b.type){case"polygon":var c=a.getMeasures(b);return!(c&&c[0]&&(c[0].qDef&&c[0].qDef.qDef||c[0].qLibraryId));case"point":return!b.qHyperCubeDef.qMeasures.length}return!1})},addHypercubeDimension:function(a,e){var f=this.getDimensions(e);return a.qDef.cId||(a.qDef.cId=d.generateId()),f.length<2&&(f.push(a),c.indexAdded(e.qHyperCubeDef.qInterColumnSortOrder,f.length-1)),"polygon"===e.type&&(f=e.geodata.qHyperCubeDef.qDimensions,a=d.extend(!0,{},a),a.qDef.cId=d.generateId(),f.length<2&&f.push(a)),b.resolve(a)},addDimension:function(a){var c,d=this.properties.layers.length;return d>0&&(c=this.properties.layers[d-1],c.qHyperCubeDef)?this.addHypercubeDimension(a,c):b.resolve(a)},replaceDimension:function(a,c){var e,f,g,h=this.properties.layers.length;return h>0&&(e=this.properties.layers[h-1],e.qHyperCubeDef&&(f=this.getDimensions(e),g=f[a],c.qDef.cId=d.generateId(),f[a]=c,"function"==typeof this.dimensionDefinition.replace&&this.dimensionDefinition.replace.call(null,c,g,a,this.properties,this))),b.resolve(c)},removeDimension:function(){return this.properties.layers=[],b.resolve()},getDimensionLayout:function(){return""},addFieldAsGeoPolygonField:function(a){this.properties.layers[this.properties.layers.length-1].geodata.qHyperCubeDef.qMeasures[0]=i.call(this,a)},addMeasureToPolygonLayer:function(a,b){b.qSortBy={qSortByLoadOrder:1,qSortByNumeric:-1},b.qDef.qAggrFunc="None",a.qHyperCubeDef.qMeasures[0]=b,a.measureDef=b.qDef.qDef,g.call(this)},addMeasureToPointLayer:function(a,b){b.qSortBy={qSortByLoadOrder:1,qSortByNumeric:-1},a.qHyperCubeDef.qMeasures.length?a.qHyperCubeDef.qMeasures[0]=b:(a.qHyperCubeDef.qMeasures.push(b),a.qHyperCubeDef.qInterColumnSortOrder.splice(0,0,2))}}),k.autoSortDimension=function(a){return a.qDef.qSortCriterias=d.extend(!0,[],m),a},k}),define("extensions.qliktech/map/map-util",["general.utils/array-util","core.utils/deferred"],function(a,b){function c(a){var b,c,d,e=[],f=[];if(b=a.split("["),b.length>1){for(d=0;d<b.length;d++)c=b[d].split("]"),c.length>1&&(e=e.concat(c.splice(0,1))),f=f.concat(c);f=f.join(" ")}else f=a;return{fields:e,rest:f}}function d(a,b){for(var c in b)(!a[c]||a[c].distance>b[c].distance)&&(a[c]=b[c])}var e={extract2FieldNamesOfGeoMakePoint:function(a){var b,d,e,f,g,h,i,j,k,l;for(b=c(a),d=b.fields,e=b.rest,f=e.replace("("," ( "),g=f.split(" "),h=0;h<g.length;)""===g[h]?g.splice(h,1):h++;for(h=0;h<g.length-1;)"("===g[h+1]?g.splice(h,1):h++;for(f=g.join(""),i=[",","\\+","-","\\(","\\)","\\*","/","=","\\>","\\<"],i.join("|"),g=f.split(new RegExp(i.join("|"),"g")),h=0;h<g.length;)""===g[h]?g.splice(h,1):h++;for(j=d.concat(g),h=0;h<j.length;h++)k=j[h],l=k.substring(0,1),'"'!==l&&"'"!==l||(k=k.substring(1)),l=k.substring(k.length-1),'"'!==l&&"'"!==l||(k=k.substring(0,k.length-1)),j[h]=k;return j},findFieldsInGeoMakePointFunction:function(a,b){var c,d=this.extract2FieldNamesOfGeoMakePoint(a),e=b?b.length:0,f=d?d.length:0,g=[],h={};for(c=0;c<e;c++)h[b[c].qName]=c;for(c=0;c<f;c++)void 0!==h[d[c]]&&(g[g.length]=b[h[d[c]]]);return g},isGeoMakePointField:function(a){return this.isGeoMakePointExpression(a.qName)},isGeoMakePointExpression:function(a){var b,c,d=a.split("(")[0],e=["="," "];for(e.join("|"),b=d.split(new RegExp(e.join("|"),"g")),c=0;c<b.length;)""===b[c]?b.splice(c,1):c++;return b&&1===b.length&&"geomakepoint"===b[0].toLowerCase()},isNormalGeoField:function(a){return e.isNormalGeoPointField(a)||e.isGeoPolygonField(a)},isNormalGeoPointField:function(a){return a.qTags.indexOf("$geopoint")>-1||a.qTags.indexOf("$geotag")>-1},isGeoField:function(a){return e.isGeoPointField(a)||e.isGeoPolygonField(a)},isGeoPointField:function(a){return this.isNormalGeoPointField(a)||this.isGeoMakePointField(a)},isGeoPolygonField:function(a){return a.qTags.indexOf("$geomultipolygon")>-1||a.qTags.indexOf("$geopolygon")>-1},getRelatedFieldName:function(a){var b,c=a.qTags,d=c?c.length:0;for(b=0;b<d;b++)if("$relates_"===c[b].substring(0,9))return c[b].substring(9,c[b].length);return null},getRelatedField:function(a,b){var c=this.getRelatedFieldName(a);if(c)for(var d=0;d<b.length;d++)if(b[d].qName===c)return b[d];return null},getFieldsInTable:function(b,c){var d,e,f=[];for(d=0;d<c.length;d++)e=c[d],a.contains(e.qSrcTables,b)&&f.push(e);return f},simplifyGeoMakePointExpression:function(a){var b,c,d,f,g,h,i,j;return b=e.extract2FieldNamesOfGeoMakePoint(a),c=b[0],d=b[1],f=a.indexOf(c),g=a.indexOf(d),h=a.substring(0,f),i=a.substring(f+c.length,g),j=a.substring(g+d.length),h.trim()+c+i.trim()+d+j.trim()},getFieldsInArchipelagoForGeoMakePointField:function(a,b){var c,e=this.findFieldsInGeoMakePointFunction(a.qName,b),f=e?e.length:0,g={};for(c=0;c<f;c++)d(g,this.getFieldsInArchipelago(e[c],b));return g},getFieldsInArchipelago:function(a,b){function c(a,g){var h,i,j,k,l;for(h=0;h<a.length;h++)if(j=a[h],!f[j])for(f[j]=!0,k=e.getFieldsInTable(j,b),i=0;i<k.length;i++)l=k[i],d[l.qName]||(d[l.qName]={field:l,distance:g},c(l.qSrcTables,++g))}var d={},f={},g=this.getRelatedField(a,b);return g?d[g.qName]={field:g,distance:0}:c(a.qSrcTables,0),d},filterFields:function(a,b){function c(a,b){return Array.isArray(b)?b.some(function(b){return c(a,b)}):a.qTags.indexOf(b)>-1}var d,e,f=a?a.length:0,g=[];for(d=0;d<f;d++)e=a[d],c(e,b)&&g.push(e);return g},findGeoAssociatedFields:function(a,b){var c,d,f,g,h,i,j,k={};for(c=0;c<b.length;c++)for(f=b[c],i=e.getFieldsInArchipelago(f,a),g=Object.keys(i),d=0;d<g.length;d++)h=g[d],j=i[h].field,k[h]?k[h].geoFields.push(f):k[h]={field:j,geoFields:[f],distance:i[h]};return Object.keys(k).map(function(a){return k[a]})},addLayer:function(a,c,d){var f,g,h=a.geoField;return g="field"===a.type?d.createFieldDimension(a.value):d.createLibraryDimension(a.libraryId),e.isGeoPointField(h)?(f=d.addPointLayer(),d.addDimension(g),d.addDimension(d.createFieldDimension(h.qName))):(f=d.addPolygonLayer(),d.addDimension(g),d.addFieldAsGeoPolygonField(h)),b.resolve(f)}};return e}),define("extensions.qliktech/map/map-autocomplete",["extensions.qliktech/map/map-util","translator"],function(a,b){function c(a){return a.sort(function(a,b){var c;return c=a.distance<b.distance?-1e3:a.distance>b.distance?1e3:0,a.value<b.value?c-=10:a.value>b.value&&(c+=10),c})}return{getFieldSuggestions:function(d,e){var f=b.get("Common.Fields");return c(e.map(function(b){var c=b.field.qName,e={label:c,value:c,field:b.field,geoFields:b.geoFields,associatedFields:[],distance:b.distance,category:f,type:"field"};if(a.isGeoField(b.field)){var g=a.getFieldsInArchipelago(b.field,d),h=a.isGeoPointField(b.field),i=d.filter(function(c){var d=c.qName;return g[d]&&(!a.isGeoField(c)||h&&d===b.field.qName)});e.associatedFields=i,e.hasAlternatives=i.length>1}else e.hasAlternatives=b.geoFields.length>1;return e}))},getDimensionSuggestions:function(d,e,f){function g(b,c,d){var e,f,g;if(e=a.isGeoMakePointExpression(c),e&&(c=a.simplifyGeoMakePointExpression(c)),b&&c)for(f=0;f<b.length;f++)if(g=b[f],g.field.qName===c)return g;if(e&&d)return{geoFields:[d.qData.info[0]],field:d.qData.info[0],distance:{distance:Math.MAX_VALUE,field:d.qData.info[0]}}}var h=b.get("Common.Dimensions");return c(d.map(function(a){var b=a&&a.qData&&a.qData.info&&a.qData.info[0]?a.qData.info[0].qName:"",c=""===b?null:g(f,b,a);if(c)return{dimension:a,associatedField:c}}).filter(function(a){return!!a}).map(function(b){var c,d,f=b.dimension.qData.title,g=b.associatedField,i={label:f,value:f,field:g.field,libraryId:b.dimension.qInfo.qId,geoFields:g.geoFields,associatedFields:[],distance:b.distance,category:h,type:"dimension"};if(a.isGeoMakePointField(g.field))c=a.getFieldsInArchipelagoForGeoMakePointField(g.field,e),d=e.filter(function(b){var d=b.qName;return c[d]&&(!a.isGeoField(b)||d===g.field.qName)}),i.associatedFields=d,i.hasAlternatives=d.length>1;else{var j=a.isNormalGeoPointField(g.field),k=a.isGeoPolygonField(g.field);j||k?(c=a.getFieldsInArchipelago(g.field,e),d=e.filter(function(b){var d=b.qName;return c[d]&&(!a.isGeoField(b)||j&&d===g.field.qName)}),i.associatedFields=d,i.hasAlternatives=d.length>1):i.hasAlternatives=g.geoFields.length>1}return i}))}}}),define("general.models/field",["core.models/base-object","core.models/app"],function(a,b){"use strict";var c;return c=a.extend("Field",{clear:function(){return this.rpc("Clear","qReturn")},lock:function(){return this.rpc("Lock","qReturn")},unlock:function(){return this.rpc("Unlock","qReturn")},clearOther:function(a){return this.rpc("ClearAllButThis","qReturn",[a||!1])},selectPossible:function(a){return this.rpc("SelectPossible","qReturn",[a||!1])},selectExcluded:function(a){return this.rpc("SelectExcluded","qReturn",[a||!1])},selectAll:function(a){return this.rpc("SelectAll","qReturn",[a||!1])},selectAlternative:function(a){return this.rpc("SelectAlternative",null,[a||!1])},selectMatch:function(a,b){return this.rpc("Select","qReturn",[a||"",b||!1])},toggleSelect:function(a,b){return this.rpc("ToggleSelect","qReturn",[a||"",b||!1])},select:function(a,b,c){return this.rpc("LowLevelSelect","qReturn",[a,b||!1,c||!1])},selectValues:function(a,b,c){return this.rpc("SelectValues","qReturn",[a,b||!1,c||!1])}},{listProperties:{qFieldListDef:{qShowSystem:!1,qShowHidden:!1,qShowSrcTables:!0,qShowSemantic:!0,qShowDerivedFields:!0}}}),c.get=function(a,c,d){function e(){return d.enigmaModel.getField(a,c)}c=c||"$";var f="FIELD_"+a+"_"+c;return d=d||b.current,this.getModel(f,d.session,e)},c}),define("extensions.qliktech/map/field-on-fly",["general.models/field"],function(a){"use strict";return a.extend("FieldOnFly",{},{listProperties:{qFieldListDef:{qShowSystem:!1,qShowHidden:!0,qShowSrcTables:!0,qShowSemantic:!0,qShowDerivedFields:!0,qShowDefinitionOnly:!0}}})}),define("text!extensions.qliktech/map/add-popover/add-layer-popover.ng.html",[],function(){return'<lui-popover style="min-width: 200px;width: 230px;" align-to="alignTo" position="position" collision="\'flipfit\'" on-close-view="closeAddPopover(event)" qva-outside-ignore-for="{{qvaOutsideIgnoreFor}}">\n\t<div class="object-add-popover" ng-show="!step2">\n\t\t<object-add-typeahead>\n\t\t\t<lui-popover-header>\n\t\t\t\t<div class="lui-input-group">\n\t\t\t\t\t<input class="lui-input" type="text" name="new-dimension" autocomplete="off" ng-model="search.term" tid="add-dimension-input" qva-focus="autoFocus"\n\t\t\t\t\t   object-add-typeahead-input on-escape="onEscape($event)" maxlength="255"/>\n\t\t\t\t</div>\n\t\t\t</lui-popover-header>\n\t\t\t<div class="object-add-popover-content" object-add-typeahead-menu>\n\t\t\t\t<div class="object-add-popover-list-header" ng-if="dimensions.length" q-translation="Common.Dimensions"></div>\n\t\t\t\t<ul class="lui-list">\n\t\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="dimension in dimensions" tid="dimension-item"\n\t\t\t\t\t\tobject-add-typeahead-item="dimension" on-select="selectItem(dimension)">\n\t\t\t\t\t\t<span qve-highlight text="{{dimension.label}}" title="{{dimension.label}}" query="search.term" class="lui-list__text lui-list__text--ellipsis"></span>\n\t\t\t\t\t\t<i class="object-add-popover-toogle-step2-icon  lui-list__aside  lui-icon  lui-icon--triangle-right" ng-if="dimension.hasAlternatives"></i>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t\t<div class="object-add-popover-list-header" ng-if="fields.length" q-translation="Common.Fields"></div>\n\t\t\t\t<ul class="lui-list">\n\t\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="field in fields" tid="field-item"\n\t\t\t\t\t\tobject-add-typeahead-item="field" on-select="selectItem(field)">\n\t\t\t\t\t\t<i ng-if="isDirectDiscoveryField( field )" class="icon-directdiscovery lui-list__aside" q-title-translation="{{ getDirectDiscoveryTypeTranslationKey( field.qTags ) }}"></i>\n\t\t\t\t\t\t<span qve-highlight text="{{field.label}}" title="{{field.label}}" query="search.term" class="lui-list__text lui-list__text--ellipsis"></span>\n\t\t\t\t\t\t<i class="object-add-popover-toogle-step2-icon  lui-list__aside  lui-icon  lui-icon--triangle-right" ng-if="field.hasAlternatives"></i>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t\t<div class="object-add-popover-nohits" ng-if="!dimensions.length && !fields.length" q-translation="Toolbox.Search.Nohits"></div>\n\t\t\t</div>\n\t\t</object-add-typeahead>\n\t</div>\n\t<div class="object-add-popover back" ng-show="step2">\n\t\t<div class="object-add-popover-header">\n\t\t\t<div qva-activate="goBack($event);">\n\t\t\t\t<i class="object-add-popover-back-icon  lui-icon  lui-icon--triangle-left"></i>\n\t\t\t\t<span q-translation="Visualization.Requirements.Back"></span>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="object-add-popover-content">\n\t\t\t<div class="object-add-popover-list-header">{{headerLabel}}</div>\n\t\t\t<ul class="lui-list">\n\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="suggestedItem in suggestedItems"\n\t\t\t\t\tqva-activate="selectItem(suggestedItem)" tid="from-field-item">\n\t\t\t\t\t<span class="lui-list__text lui-list__text--ellipsis" title="{{getSuggestionLabel(suggestedItem)}}">{{getSuggestionLabel(suggestedItem)}}</span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n</lui-popover>\n\n'}),define("text!objects.add-popovers/object-add-typeahead.ng.html",[],function(){return"<div ng-transclude></div>"}),define("objects.add-popovers/object-add-typeahead",["qvangular","text!./object-add-typeahead.ng.html","general.services/aligner/aligner"],function(a,b){a.directive("objectAddTypeahead",[function(){return{template:b,scope:{},transclude:!0,replace:!0,restrict:"E",controller:["$scope",function(a){function b(){var b=a.menu;if(a.activeItem){var c=a.activeItem,d=c.getPosition();d.top<0?b.setScrollTop(c.getOffsetTop()):d.top+c.getHeight()>b.getHeight()&&c.scrollIntoView(!1)}else b.setScrollTop(0)}var c=this;a.items=[],this.activate=function(b){a.activeItem=b},this.nextItem=function(d){var e=a.items.indexOf(a.activeItem);void 0!==d&&(e=(e+d)%a.items.length),e===a.items.length-1?c.activate(null):e===-1?c.activate(a.items[0]):c.activate(a.items[e+1]),b()},this.prevItem=function(d){var e=a.items.indexOf(a.activeItem);void 0!==d&&(e=(e-d+a.items.length)%a.items.length),0===e?c.activate(null):e===-1?c.activate(a.items[a.items.length-1]):c.activate(a.items[e-1]),b()},this.getActiveItem=function(){return a.activeItem},this.selectActiveItem=function(){a.activeItem&&a.activeItem.select()},this.select=function(b){a.select({item:b}),a.activeItem=null},this.setMenu=function(b){a.menu=b},this.addItem=function(b){a.items.push(b)},this.removeItem=function(b){var c=a.items.indexOf(b);c>=0&&a.items.splice(c,1)}}]}}]),a.directive("objectAddTypeaheadInput",[function(){return{require:["^objectAddTypeahead","ngModel"],link:function(a,b,c,d){var e=d[0],f=d[1];b.on("keydown",function(b){b.stopPropagation(),13===b.which||9===b.which?(b.preventDefault(),e.getActiveItem()?a.$apply(function(){e.selectActiveItem()}):a.$apply(function(){a.$eval(c.onEnter,{$event:b})})):33===b.which?(b.preventDefault(),a.$apply(function(){e.prevItem(10)})):34===b.which?(b.preventDefault(),a.$apply(function(){e.nextItem(10)})):40===b.which?(b.preventDefault(),a.$apply(function(){e.nextItem()})):38===b.which?(b.preventDefault(),a.$apply(function(){e.prevItem()})):27===b.which&&(b.preventDefault(),a.$apply(function(){a.$eval(c.onEscape,{$event:b})}))}),a.$watch(e.getActiveItem,function(a){a?a.item.label&&b.val(a.item.label):b.val(f.$modelValue)}),a.$watch(f.$modelValue,function(a){a||e.activate(null)})}}}]),a.directive("objectAddTypeaheadMenu",[function(){return{require:"^objectAddTypeahead",link:function(a,b,c,d){a.controller=d,d.setMenu({getHeight:function(){return b.height()},setScrollTop:function(a){b[0].scrollTop=a}})}}}]),a.directive("objectAddTypeaheadItem",[function(){return{require:"^objectAddTypeahead",link:function(a,b,c,d){function e(){a.$eval(c.onSelect,{item:f})}var f=a.$eval(c.objectAddTypeaheadItem),g={item:f,getOffsetTop:function(){return b[0].offsetTop},scrollIntoView:function(a){b[0].scrollIntoView(a)},getPosition:function(){return b.position()},getHeight:function(){return b.height()},select:function(){e()}};d.addItem(g),a.$on("$destroy",function(){d.removeItem(g)}),a.$watch(function(){var a=d.getActiveItem();return!!a&&a.item===f},function(a){a?b.addClass("object-add-typeahead-active"):b.removeClass("object-add-typeahead-active")}),b.on("mouseenter",function(){b.addClass("object-add-typeahead-hover")}),b.on("mouseleave",function(){b.removeClass("object-add-typeahead-hover")}),b.on("qv-activate",function(b){b.preventDefault(),a.$apply(function(){e()})})}}}])}),define("extensions.qliktech/map/add-popover/add-layer-popover",["core.utils/deferred","general.utils/string-normalization","translator","general.utils/array-util","general.utils/support","extensions.qliktech/map/map-util","extensions.qliktech/map/map-autocomplete","extensions.qliktech/map/field-on-fly","general.models/library/dimension","text!./add-layer-popover.ng.html","client.assets/tab-contents/fields/assets-directdiscovery-service","objects.add-popovers/object-add-typeahead"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function l(a,c){return""===c?a:a.filter(function(a){return void 0!==a.value&&b.string(a.value.toLowerCase()).indexOf(b.string(c.toLowerCase()))>-1})}var m=100;return{template:j,controller:["$scope",function(b){b.search={term:""},b.isDirectDiscoveryField=k.isDirectDiscoveryField,b.getDirectDiscoveryTypeTranslationKey=k.getTypeTranslationKey,b.autoFocus=e.treatAsDesktop(),b.suggestedItems=[],b.position||(b.position="right"),b.getSuggestionLabel=function(a){return f.isGeoPointField(a.geoFields[0])?c.get("properties.layers.autocomplete.pointSuggestion",[a.label]):c.get("properties.layers.autocomplete.regionSuggestion",[a.label])},b.selectItem=function(a){1!==a.geoFields.length||a.field&&f.isGeoField(a.field)?f.isGeoField(a.field)?(b.headerLabel=f.isGeoPointField(a.field)?c.get("Visualization.Requirements.SelectFieldForPointLayer"):c.get("Visualization.Requirements.SelectFieldForAreaLayer"),b.suggestedItems=a.associatedFields.map(function(b){return{label:b.qName,value:b.qName,type:"field",geoFields:[a.field]}}),b.step2=!0):(b.headerLabel=c.get("Visualization.Requirements.SelectGeoFieldForLayer"),b.suggestedItems=a.geoFields.map(function(b){return{label:b.qName,value:a.value,libraryId:a.libraryId,type:a.type,geoFields:[b]}}),b.step2=!0):"dimension"===a.type?b.addLibraryDimension({libraryId:a.libraryId,type:a.type,geoField:a.geoFields[0]}):b.addFieldDimension({value:a.value,type:a.type,geoField:a.geoFields[0]})},b.onEscape=function(a){""!==b.search.term?(a.stopPropagation(),b.search.term=""):b.close()},b.goBack=function(a){a.preventDefault(),b.suggestedItems=[],b.step2=!1};var j=null;b.$watch("search.term",function(c){function e(){var a=l(j.fields,c),e=l(j.dimensions,c);e.length>m?(e=d.limit(e,m),a=[]):a.length+e.length>m&&(a=d.limit(a,m-e.length)),b.fields=a,b.dimensions=e}j?e():a.all({fields:h.getListLayout(),dimensions:i.getListLayout()}).then(function(a){var b=f.filterFields(a.fields,["$geomultipolygon","$geopolygon","$geopoint"]),c=f.findGeoAssociatedFields(a.fields,b);c=c.filter(function(a){return!(a.field.qTags&&a.field.qTags.indexOf("$hidden")>-1)});var d=c.filter(function(a){return!a.field.qIsDefinitionOnly});j={fields:g.getFieldSuggestions(a.fields,d),dimensions:g.getDimensionSuggestions(a.dimensions,a.fields,c)},e()})})}],scope:{alignTo:"=",addFieldDimension:"=",addLibraryDimension:"=",close:"=",position:"=",qvaOutsideIgnoreFor:"="}}}),define("extensions.qliktech/map/map-layer-creation",["translator","qvangular","core.models/app","extensions.qliktech/map/map-util","general.models/field","util"],function(a,b,c,d,e,f){"use strict";function g(a,b,c,d){c.addPolygonLayer(),c.addDimension(a),c.addFieldAsGeoPolygonField(b),d.setProperties(c.properties)}function h(a,b,c,d){c.addPointLayer(),c.addDimension(a),c.addDimension(b),d.setProperties(c.properties)}function i(a,c,d,e,f,h){c.addItem({translation:d,tid:"add-as-polygon-layer",select:function(){g(e,a,f,h),b.$rootScope.$broadcast("pp-open-path","data."+f.properties.layers[0].cId)}})}function j(a,c,d,e,f,g){c.addItem({translation:d,tid:"add-as-point-layer",select:function(){var c=f.createFieldDimension(a.qName);h(e,c,f,g),b.$rootScope.$broadcast("pp-open-path","data."+f.properties.layers[0].cId)}})}function k(a,b,c,d,e){var f;1===b.length?j(a,c.menu,"Object.Map.DropActions.AddAsPointLayer",b[0].dimension,d,e):b.length>1&&(f=c.menu.addItem({translation:"Object.Map.DropActions.AddAsPointLayer",tid:"add-as-point-layer"}),b.forEach(function(b){j(a,f,["properties.layers.autocomplete.pointSuggestion",b.name],b.dimension,d,e)}))}function l(a,b,c,d,e){var f;1===b.length?i(a,c.menu,"Object.Map.DropActions.AddAsRegionLayer",b[0].dimension,d,e):b.length>1&&(f=c.menu.addItem({translation:"Object.Map.DropActions.AddAsRegionLayer",tid:"add-as-polygon-layer"}),b.forEach(function(b){i(a,f,["properties.layers.autocomplete.regionSuggestion",b.name],b.dimension,d,e)}))}function m(a,b,c,e,f){d.isGeoPointField(a)?k(a,b,c,e,f):l(a,b,c,e,f)}function n(a,b,c,e,f){var g=[],h=[];b.forEach(function(a){d.isGeoPointField(a)?g.push(a):h.push(a)});var k;1===h.length?i(h[0],c.menu,"Object.Map.DropActions.AddAsRegionLayer",a,e,f):h.length>1&&(k=c.menu.addItem({translation:"Object.Map.DropActions.AddAsRegionLayer",tid:"add-as-polygon-layer"}),h.forEach(function(b){i(b,k,["properties.layers.autocomplete.regionSuggestion",b.qName],a,e,f)})),1===g.length?j(g[0],c.menu,"Object.Map.DropActions.AddAsPointLayer",a,e,f):g.length>1&&(k=c.menu.addItem({translation:"Object.Map.DropActions.AddAsPointLayer",tid:"add-as-point-layer"}),g.forEach(function(b){j(b,k,["properties.layers.autocomplete.pointSuggestion",b.qName],a,e,f)}))}function o(b,c,d,e){b.forEach(function(b){if("polygon"!==b.type){var g=c.properties.layers.indexOf(b),h=p>1?"Add as measure in layer "+(g+1):a.get("contextMenu.addFieldAsMeasure"),i=f.escapeField(d.item.name),j=d.menu.addItem({translation:h,tid:"add-as-measure"});["Sum","Count","Avg","Min","Max"].forEach(function(a){var d=a+"("+i+")";j.addItem({label:d,tid:a.toLowerCase(),select:function(){var a;switch(b.type){case"polygon":a=b.qHyperCubeDef?c.createExpressionMeasure(d,d):{qExpr:d,qLabel:d},c.addMeasureToPolygonLayer(b,a);break;case"point":a=c.createExpressionMeasure(d,d),c.addMeasureToPointLayer(b,a);break;default:return}e.setProperties(c.properties)}})})}})}var p=1;return{getDropFieldOptions:function(a,b,f,i,j){var k=a.item,l=b.getLayers(),q=b.getLayersWithoutMeasure();a.ColorBy(f,b,j);var r={qTags:k.tags,qSrcTables:k.srcTables,qName:k.name},s=d.isGeoPointField(r),t=d.isGeoPolygonField(r);s||t?q.length?(o(q,b,a,f),i()):l.length>=p?i():e.getListLayout().then(function(c){var e=d.getFieldsInArchipelago(r,c),g=c.filter(function(a){var b=a.qName;return e[b]&&(!d.isGeoField(a)||s&&b===r.qName)}),h=g.map(function(a){var c=b.createFieldDimension(a.qName);return{name:a.qName,dimension:c}});m(r,h,a,b,f),i()}):c.current.findMatchingFields(a.item.name,["$geomultipolygon","$geopolygon","$geopoint"]).then(function(c){var e,j,m=c.qFieldNames;q.length?(o(q,b,a,f),i()):l.length>=p||0===m.length?i():1===m.length?(e=b.createFieldDimension(k.name),d.isGeoPointField(m[0])?(j=b.createFieldDimension(m[0].qName),h(e,j,b,f)):g(e,m[0],b,f)):(e=b.createFieldDimension(k.name),n(e,m,a,b,f),i())})},getDropDimensionOptions:function(a,b,f,i,j){if(b.getLayers().length>0)return a.ColorBy(f,b,j),void i();var l=a.item;d.isGeoMakePointField(l.info[0])?e.getListLayout().then(function(c){var e=d.getFieldsInArchipelagoForGeoMakePointField(l.info[0],c);if(e){var g=c.filter(function(a){var b=a.qName;return e[b]&&!d.isGeoField(a)}),h=g.map(function(a){var c=b.createFieldDimension(a.qName);return{name:a.qName,dimension:c}});k(l.info[0],h,a,b,f)}i()}):d.isGeoField(l.info[0])?e.getListLayout().then(function(c){for(var e,g=0;g<c.length;g++)if(c[g].qName===l.info[0].qName){e=c[g];break}if(e){var h=d.getFieldsInArchipelago(e,c),j=d.isGeoPointField(e),k=c.filter(function(a){var b=a.qName;return h[b]&&(!d.isGeoField(a)||j&&b===e.qName)}),n=k.map(function(a){var c=b.createFieldDimension(a.qName);return{name:a.qName,dimension:c}});m(e,n,a,b,f)}i()}):c.current.findMatchingFields(l.info[0].qName,["$geomultipolygon","$geopolygon","$geopoint"]).then(function(c){var e,j,k=a.item,l=c.qFieldNames;0===l.length?i():1===l.length?(e=b.createLibraryDimension(k.id),d.isGeoPointField(l[0])?(j=b.createFieldDimension(l[0].qName),h(e,j,b,f)):g(e,l[0],b,f)):(e=b.createLibraryDimension(k.id),n(e,l,a,b,f),i())})},getDropMeasureOptions:function(a,c,d,e,f){a.ColorBy(d,c,f);var g=a.item,h=c.getLayersWithoutMeasure();h.length&&h.forEach(function(e){"polygon"!==e.type&&a.menu.addItem({translation:["contextMenu.add",g.name],tid:"add",select:function(){var a;switch(e.type){case"polygon":a=e.qHyperCubeDef?c.createLibraryMeasure(g.id):{qLibraryId:g.id},c.addMeasureToPolygonLayer(e,a);break;case"point":a=c.createLibraryMeasure(g.id),c.addMeasureToPointLayer(e,a);break;default:return}d.setProperties(c.properties),b.$rootScope.$broadcast("pp-open-path","data."+e.cId)}})}),e()},addFieldDimension:function(a,c){return c.model.getProperties().then(function(e){if(!(e.layers.length>=p)){var f=c.getCreatePropertyHandler();return f.setProperties(e),d.addLayer(a,e,f).then(function(){b.$rootScope.$broadcast("pp-open-path","data."+e.layers[0].cId),c.model.setProperties(e)})}})},addLibraryDimension:function(a,c){return c.model.getProperties().then(function(e){if(!(e.layers.length>=p)){var f=c.getCreatePropertyHandler();return f.setProperties(e),d.addLayer(a,e,f).then(function(){b.$rootScope.$broadcast("pp-open-path","data."+e.layers[0].cId),c.model.setProperties(e)})}})}}}),define("extensions.qliktech/map/interaction-controller",["jquery","objects.views/charts/utils/pan-zoom-controller","general.utils/shapes/point","general.utils/shapes/rect"],function(a,b,c,d){"use strict";function e(){var a,b,c,d,e,f,g,h,i,j,k,l;a={x:this._dataBounds.x,y:this._dataBounds.y},b={x:this._dataBounds.x+this._dataBounds.width,y:this._dataBounds.y+this._dataBounds.height},c=this._viewportProjection.project(a),d=this._viewportProjection.project(b),e=Math.max(c.x,d.x),f=Math.min(c.x,d.x),g=this._viewportProjection.getSize(),(e<0||f>g.x)&&(h=this._viewportProjection.invProject({x:0,y:0}),i=this._viewportProjection.invProject({x:g.x,y:0}),j=Math.abs(i.x-h.x),l=this._viewportProjection.getMapCenterInLatLong(),j>=360?(k=Math.floor(j/360),l.x=l.x+360*k*(l.x<0?1:-1),this._viewportProjection.setMapCenterInLatLong(l)):Math.abs(l.x)>180&&(l.x=l.x%360,l.x>180?l.x-=360:l.x<-180&&(l.x+=360),this._viewportProjection.setMapCenterInLatLong(l)))}return b.extend("InteractionController",{init:function(b,c){var f=this,g=function(){this.getZoomPanByWebkitTransform()||this._viewportProjection.fire("changedByInteraction")};this._minZoomLevel=0,this.chart=b,this.dataArea=this.chart.components.dataArea,this._worldBounds=new d(-180,-180,360,360),this._super(a(this.dataArea.layersContainer),{update:function(){g.call(f)},end:function(){g.call(f)}},null,c),this.helpFunctions.onInteractionStart=function(){f._interactionStarted||(f._localMatrix.identity(),f._globalMatrix=f._viewportProjection.getTransformMatrix().clone(),f._interactionStarted=!0)},this.helpFunctions.onInteractionEnd=function(){if(!(f._zooming||f._panning||f._pinching)){var a=!1;f.helpFunctions.setTransform(f.dataArea.layersContainer,"matrix(1,0,0,1,0,0)"),f._viewportProjection.enabledChangeEvent=!1,f._viewportProjection.setTransformMatrix(f._globalMatrix),f.dataArea.hasVisibleBaseLayer()&&(e.call(f),a=f.dataArea.baseMapLayer.updateViewportToBaseMap(f)),a||f._viewportProjection.fire("changedByInteraction"),f._viewportProjection.enabledChangeEvent=!0,f._interactionStarted=!1}}},setMapCenter:function(a,b){this._viewportProjection&&(b?this._viewportProjection.setMapCenterInLatLong(a):this._viewportProjection.setDataCenter(a))},getMapCenter:function(){return this._viewportProjection?this._viewportProjection.getDataCenter():null},moveViewport:function(a,b){var d,e,f,g,h,i,j,k,l,m,n,o,p;d={x:this._dataBounds.x,y:this._dataBounds.y},e={x:this._dataBounds.x+this._dataBounds.width,y:this._dataBounds.y+this._dataBounds.height},h=this._viewportProjection.project(d),i=this._viewportProjection.project(e),j=Math.max(h.x,i.x),k=Math.min(h.x,i.x),l=this._viewportProjection.getSize(),a>0&&k+a<=l.x||a<0&&j+a>=0||!(this.dataArea.baseMapLayer&&this.dataArea.baseMapLayer.isReady()&&this.dataArea.baseMapLayer.show)?this.setMapCenter(this._viewportProjection.invProject(new c(l.x/2-a,l.y/2-b))):(f=this._viewportProjection.invProject({x:0,y:0}),g=this._viewportProjection.invProject({x:l.x,y:0}),n=Math.abs(g.x-f.x),n>=360?(o=l.x/n*360,p=Math.floor(n/360),a>0&&k+a>l.x?a-=o*p:a<0&&j+a<0&&(a=o*p-a),this.setMapCenter(this._viewportProjection.invProject(new c(l.x/2-a,l.y/2-b)))):(this.dataArea.baseMapLayer.panBy(-a,-b),m=this.dataArea.baseMapLayer.getMapCenter(),this.setMapCenter(m,!0)))},zoomOnPixel:function(a,b){var c,d,f=this.getZoomLevel();f<=this._minZoomLevel&&b<=1||f>=this._maxZoomLevel&&b>=1||(c=Math.pow(2,this._minZoomLevel-f),d=Math.pow(2,this._maxZoomLevel-f),b=Math.min(Math.max(b,c),d),this._viewportProjection.zoomOnPixel(a,b),this.dataArea.hasVisibleBaseLayer()&&e.call(this))},zoomOnDataRectangle:function(a,b){this._viewportProjection.zoomOnDataRectangle(a,b)},zoomOnMapBounds:function(){var a=this._dataBounds&&!this._dataBounds.hasNaN()?this._dataBounds:this._worldBounds;if(a)return this.zoomOnDataRectangle(a,!1),this.dataArea.hasVisibleBaseLayer()&&(this._viewportProjection.inResetZoomMode=!0),this._viewportProjection.fire("resetZoomFinished"),!0},release:function(){this._super(),this.chart=null,this.dataArea=null}})}),define("extensions.qliktech/map/map",["jquery","objects.views/charts/chart","objects.views/charts/components/chart-component","objects.backend-api/map-api","objects.views/charts/representation/combo-color-map","objects.views/charts/utils/binding","text!./map.ng.html","extensions.qliktech/map/map-properties","extensions.qliktech/map/projection/viewport-projection-mercator","objects.views/charts/utils/unit-projection","extensions.qliktech/map/map-area","general.utils/shapes/rect","objects.utils/event-utils","client.utils/property-mapper","extensions.qliktech/map/map-handler","objects.views/charts/components/axis/axis","objects.views/charts/components/legend/color-legend","extensions.qliktech/map/add-popover/add-layer-popover","extensions.qliktech/map/map-layer-creation","extensions.qliktech/map/interaction-controller","core.utils/deferred","general.utils/support","extensions.qliktech/scatterplot/directives/navigation/scatterplot-navigation","touche"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){"use strict";function w(a){var b=a&&a.qDimensionInfo.length&&!a.qDimensionInfo.some(function(a){return!!a.qError});return a.qMeasureInfo&&a.qMeasureInfo.length&&(b=b&&!a.qMeasureInfo.some(function(a){return!!a.qError})),b}function x(a){if(!(a&&(a.layers&&0!==a.layers.length||a.background&&a.background.show)))return!1;var b,c,d=Math.min(a.layers.length,L);for(b=0;b<d;b++){if(c=a.layers[b],!c.qHyperCube)return!1;if(w(c.qHyperCube))return!0}return a.background&&a.background.show}function y(a){return a&&a.qDimensionInfo.every(function(a){return a.qLocked!==!0})}function z(a){this._projection&&a&&this._projection.getProjectionType()===a.getProjectionType()||(this._projection=a,this._projection||(this._projection=this._unitProjection),this._viewportProjection.setProjection(this._projection))}function A(a){this._inZoomOnMapBoundsMode&&(this._mapRectInZoomOnMapBoundsModeNeedToUpdate=!0),this._viewportProjection.setSize(a)}function B(){this._inZoomOnMapBoundsMode&&(this._mapRectInZoomOnMapBoundsMode=this._viewportProjection.getDataRectOfViewport(),
this._mapRect=this._mapRectInZoomOnMapBoundsMode.clone())}function C(){this._mapRect=this._viewportProjection.getDataRectOfViewport(),this._mapRectInZoomOnMapBoundsModeNeedToUpdate&&(this._mapRectInZoomOnMapBoundsMode=this._mapRect.clone(),this._mapRectInZoomOnMapBoundsModeNeedToUpdate=!1),this.updateNavigation()}function D(){var a=this.selections&&this.selections.cache||this.tooltips&&this.tooltips.cache;if(a){var b=this.components.dataArea.getSelectableShapes(),c=this.components.dataArea.layers,d=!(!this.selections||!this.selections.getActiveType)&&this.selections.getActiveType(),e=!!d;a.clear(),b.forEach(function(b){a.add(b)}),e&&(/^item/.test(d.getActiveMode())?b.forEach(function(a){var b=c[a.layerIndex].getSelectedRows();a.selected=b&&b.indexOf(a.rowIndex)>=0}):(d.activeComponent instanceof p&&!d.activeComponent.isDiscrete()||d.activeComponent instanceof q&&"range"===d.getActiveMode())&&d.updateShapesState()),Object.keys(this.components).forEach(function(a){["colorLegend","xAxis","dimensionAxis"].contains(a)&&this.components[a].setSelectableShapes(b)},this)}}function E(a){var b,c,d,e=a?a.length:0,f=[];for(b=0;b<e;b++)c=a[b],d=c.layerIndex,void 0===f[d]&&(f[d]=[]),f[d][f[d].length]=c;return f}function F(a,b,c){var d,e,f,g,h;for(d=c;d>-1;d--)for(e=b[d],f=e?e.length:0,g=0;g<f;g++)h=e[g],h.selected=!1}function G(){this._mapRectInZoomOnMapBoundsMode=this._viewportProjection.getDataRectOfViewport(),this._mapRect=this._mapRectInZoomOnMapBoundsMode.clone(),this.updateNavigation()}function H(){if(!this._mapRectInZoomOnMapBoundsMode)return!1;var a=this._mapRectInZoomOnMapBoundsMode.x-this._mapRect.x,b=this._mapRectInZoomOnMapBoundsMode.y-this._mapRect.y,c=this._mapRect.width-this._mapRectInZoomOnMapBoundsMode.width,d=this._mapRect.height-this._mapRectInZoomOnMapBoundsMode.height;return Math.abs(a)<K&&Math.abs(c)<K&&Math.abs(b)<K&&Math.abs(d)<K}function I(a,b,c){var d=this;this.$scope.navigationVisible=a,this.$scope.navigationHomeOnly=b,this.$scope.navigationDefaultPosition=c,this.yMirrorMode?this.$scope.navigationStyle={top:this.components.dataArea.rect.y+13+"px",left:this.components.dataArea.rect.x+15+"px"}:this.$scope.navigationStyle={top:this.components.dataArea.rect.y+13+"px",right:this.rect.width-this.components.dataArea.rect.x-this.components.dataArea.rect.width+13+"px"},void 0===this._timeoutID&&(this._timeoutID=setTimeout(function(){d._timeoutID=void 0,d.$scope.$digest()}))}var J,K=1e-9,L=1;return J=b.extend("Map",{namespace:".map",init:function(b,d,g,h,m){var n=this;g=a.extend(!0,g||{},{providers:{colorMap:{clazz:e,multiDimScheme:"first",colorBy:"primary",autoMode:"primary"}},components:{dataArea:{show:!0,dock:"center",clazz:k,showFlag:c.prototype.ShowFlags.SPARK},colorLegend:{show:!0,dock:"right",relevantSize:126,label:"colorLegend",showFlag:c.prototype.ShowFlags.MEDIUM}}}),this._super(b,d,g,h,m),this.backendApi=h,this.components.colorLegend.hideComponent(),this._autoZoomOnDataChange=!0,this._worldBounds=new l(-180,-180,360,360),this._unitProjection=new j,this.setViewportProjection(new i),z.call(this,this._unitProjection),this.interactionController=new t(this,this._viewportProjection),this.interactionController.setZoomPanByWebkitTransform(!v.treatAsDesktop()),this.components.dataArea.setMaxNumLayers(L),this.components.dataArea.setMap(this),this.components.dataArea.setBackendApi(this.backendApi),this.components.dataArea.setSelectionsApi(this.selectionsApi),this.components.dataArea.setLegend(this.components.colorLegend),this.components.dataArea.setChartContext(this._chartContext),this.components.dataArea.setInteractionController(this.interactionController),this._changeWatchers=this._changeWatchers||[],this._changeWatchers.push(f.bindProperty(this.components.dataArea,"dimensionTree",this._chartContext,"dimensionTree")),this._changeWatchers.push(f.bindProperty(this.providers.colorMap,"dimensionTree",this._chartContext,"dimensionTree")),this.onNavigationPressed=b.$on("navigationPressed",function(a,b){a.preventDefault(),n.interactionController.navigate(b)}),this.$scope.navigationDisabled=!0,this.$scope.dataAttributes={},this._scaleMapOnResize=!0},setFormatter:function(a){var b;if(this.chartFormatter=a,this.chartFormatter){for(b in this.components)this.components[b].chartFormatter=this.chartFormatter,this.components[b].measureFormatters=this.chartFormatter.getFormatters(),this.components[b].combinedMeasuresFormatter=this.chartFormatter.getCombinedMeasuresFormatter();this.providers.colorMap&&(this.providers.colorMap.setMeasureFormatters(this.chartFormatter.getFormatters()),this.providers.colorMap.setGenericFormatter(this.chartFormatter.createFormatter())),this.tooltips&&(this.tooltips.measureFormatters=this.chartFormatter.getFormatters())}},setViewportProjection:function(a){this._viewportProjection&&(this._viewportProjection.stopListen("resetZoomFinished",G,this),this._viewportProjection.stopListen("changedByBaseMap",B,this),this._viewportProjection.stopListen("changed",C,this),this._viewportProjection.stopListen("changedByInteraction",C,this)),this._viewportProjection=a,this.components.dataArea.setViewportProjection(this._viewportProjection),this._viewportProjection&&(this._viewportProjection.listen("resetZoomFinished",G,this),this._viewportProjection.listen("changedByBaseMap",B,this),this._viewportProjection.listen("changed",C,this),this._viewportProjection.listen("changedByInteraction",C,this))},getViewportProjection:function(){return this._viewportProjection},suppressOnPaint:function(a){var b;return this.$scope.object._forcePaint?(this.$scope.object._forcePaint=!1,b=!1):b=a.qSelectionInfo&&a.qSelectionInfo.qInSelections,b&&this.prePaint(a),b},prePaint:function(a){this._super(a);var b=this,c=!1;a.layers.forEach(function(a){var d=a.qHyperCube,e=d&&d.qDataPages&&d.qDataPages[0]&&d.qDataPages[0].qMatrix?d.qDataPages[0].qMatrix.length:0;b.$scope.dataAttributes.limitedData=e>0&&d.qSize.qcy>e,b.$scope.dataAttributes.limitedData&&(c=!0)}),this.$scope.options.showDisclaimerStar=c,this.$element.toggleClass("qv-viz-with-disclaimer",c)},_updateData:function(a,b){var c=[];this.layersReadyDfd=u(),this.layersReady=this.layersReadyDfd.promise,c.push(this.layersReady),this._data=a,this._readStoredData=a&&a.snapshotData&&a.snapshotData.content&&this.backendApi.isSnapshot,this.setAutoZoomOnDataChange(this._data.autoZoomOnSelection||void 0===this._data.autoZoomOnSelection),this.updateSelectableState(a),c.push(this.components.dataArea.setData(a)),this.tooltips&&(this.tooltips.enabled=this.components.dataArea.hasVisibleLayer(),this.tooltips.parentScope=this.$scope,this.tooltips.colorMap=this.providers.colorMap),this.updateLegend(a,b);var d=u.all(c);return this._dfdUpdatingData=d,this._dfdUpdatingData},updateLegend:function(a){if(this.components.colorLegend){this.components.colorLegend.attributeSelectionsCache=this.attributeSelectionsCache,this._updateLegendDock(this.components.colorLegend,a);var b=a&&a.legend&&a.legend.show;b=b&&this.components.dataArea.hasVisibleLayer(),b?this.components.colorLegend.showComponent():this.components.colorLegend.hideComponent()}},isValid:function(a){return this.isDataValid(a)},isDataValid:function(a){var b,c=x(a);for(b in this.components)this.components[b].setHasValidData(c);return c},isDataSelectable:function(a){if(!this.isValid(a)||!this.inAnalysisState())return!1;var b,c=Math.min(a.layers.length,L);for(b=0;b<c;b++)if(a.layers[b].qHyperCube&&y(a.layers[b].qHyperCube))return!0;return!1},setAutoZoomOnDataChange:function(a){this._autoZoomOnDataChange=!!a},getAutoZoomOnDataChange:function(){return this._autoZoomOnDataChange},setScaleMapOnResize:function(a){this._scaleMapOnResize=a},getScaleMapOnResize:function(){return this._scaleMapOnResize},setMapCenter:function(a){this.interactionController.setMapCenter(a)},getMapCenter:function(){return this.interactionController.getMapCenter()},setZoomLevel:function(a){this.interactionController.setZoomLevel(a)},getZoomLevel:function(){return this.interactionController.getZoomLevel()},setMapBounds:function(a){this._mapBounds=a.clone(),this.interactionController.setBoundsRect(a),this._autoZoomOnDataChange||(this._mapRectInZoomOnMapBoundsMode=this._viewportProjection.getDataRectOfViewportIfZoomOnADataRect(this._mapBounds),this.updateNavigation())},zoomOnMapBounds:function(){this._inZoomOnMapBoundsMode=!0,this._mapRectInZoomOnMapBoundsModeNeedToUpdate=!0;var a=this.interactionController.zoomOnDataBounds();return this._mapRectInZoomOnMapBoundsModeNeedToUpdate=!1,a},setFractionalZoomMode:function(a){this.interactionController.setFractionalZoomMode(a)},getFractionalZoomMode:function(){return this.interactionController.getFractionalZoomMode()},setZoomPanByWebkitTransform:function(a){this.interactionController.setZoomPanByWebkitTransform(a||!v.treatAsDesktop())},getZoomPanByWebkitTransform:function(){return this.interactionController.getZoomPanByWebkitTransform()},on:function(){if(this._on)return void this._super();this._navigation&&(this.interactionController.on(".map",this.components.dataArea.container),this.$scope.navigationDisabled=!1),this._super()},off:function(){this.$scope.navigationDisabled=!0,this._on&&(this._navigation&&(this.interactionController.off(),Touche(this.components.dataArea.container).off("*",".map"),Touche(this.container).off("*",".map"),a(this.components.dataArea.container).off(".map"),a(this.container).off(".map")),this._super())},initSelections:function(){this.selections._disableSelections=this.options._disableSelections,this.selections.types.dataArea.setComponent("dataArea",this.components.dataArea),this.selections.types.colorLegend.setComponent("colorLegend",this.components.colorLegend),this.options._disableSelections||(this.selections.Activated.bind(this.Activated.bind(this)),this.selections.Deactivated.bind(this.Deactivated.bind(this)),this.selections.Lasso.bind(this.onToggleLasso.bind(this)),this.selections.Select.bind(this.Select.bind(this)),this.selections.SelectRange.bind(this.onSelection.SelectRange.bind(this)),this.selections.SelectAttributeDim.bind(this.onSelection.SelectAttributeDim.bind(this)),this.selections.ToggleShapes.bind(this.ToggleShapes.bind(this)),this.selections.Confirm.bind(this.onSelection.Confirm.bind(this)),this.selections.Cancel.bind(this.Cancel.bind(this)),this.selections.Clear.bind(this.Clear.bind(this)),this.selections.SelectWhileLocked.bind(this.selectWhileLocked.bind(this)))},initTooltips:function(){this.tooltips.setComponent("dataArea",this.components.dataArea)},selectWhileLocked:function(a){var b,c=[];this._data.layers.forEach(function(a){b=a.qHyperCube.qDimensionInfo,c.push(b instanceof Array?b[0]:b)}),m.showLockedFeedback(a||c)},ToggleShapes:function(a,b){if(a&&0!==a.length){var c,d,e,f,g,h,i,j=this;for(this._haveToggledShapes=!1,this._renderOnToggleShapes=!0,setTimeout(function(){j._renderOnToggleShapes&&j.onSelection.scheduleInvalidation.call(j,!0),j._renderOnToggleShapes=!1},50),e=this._data&&this._data.layers?Math.min(this._data.layers.length,L):0,d=E(a),h=4==(4&b),this._layerIndexOfClick=-1,f=e-1;f>-1;f--)if(c=this.components.dataArea.layers[f],g=d[f],i=g?g.length:0,c.isVisible()&&0!==i&&(c.toggleShapes(g),h))return this._layerIndexOfClick=f,void F(a,d,f-1)}},Activated:function(){this.onSelection.Activated.apply(this,[].slice.call(arguments)),this.setPreselectionMode(!0)},Deactivated:function(){this._renderOnToggleShapes=!1,this.onSelection.Deactivated.apply(this,[].slice.call(arguments)),this.setPreselectionMode(!1)},Cancel:function(){this.onSelection.Cancel.apply(this,[].slice.call(arguments)),this.setPreselectionMode(!1)},Clear:function(){this.onSelection.Clear.apply(this,[].slice.call(arguments)),this.setPreselectionMode(!1)},Select:function(a,b,c){var d,e=E(a),f=Array.isArray(c)?c:[c||0],g=this.components.dataArea.layers,h=g?g.length:0;if(this._layerIndexOfClick===-1){for(d=0;d<h;d++)"hyperCube"===g[d].getDataType()&&g[d].selectOnLayer(e[d],f);for(d=0;d<h;d++)"listObject"===g[d].getDataType()&&g[d].selectOnLayer(e[d],f)}else d=this._layerIndexOfClick,g[d].selectOnLayer(e[d],f)},_initiateBindings:function(){this._changeWatchers||(this._changeWatchers=[]);var a;for(a in this.components)this._changeWatchers.push(f.bindProperty(this.components[a],"layoutMode",this,"layoutMode"));this.components.dataArea&&this._changeWatchers.push(f.bindSetter(D.bind(this),this.components.dataArea,"selectableShapes"))},resize:function(){return this._resizing=!0,this._super().then(function(){this._resizing=!1}.bind(this))},layout:function(){this._super();var b=this.components.dataArea?this.components.dataArea.rect:this.rect;A.call(this,{x:b.width,y:b.height}),this.components.dataArea.setRect(b.x,b.y,b.width,b.height),this.components.dataArea.updateSize(),this.components.dataArea&&this.interactionController.setOffset(a(this.components.dataArea.container).offset())},setPreselectionMode:function(a){this._preselectionMode=a,this.components.dataArea.setPreselectionMode(a)},_paint:function(){var a=this._super.bind(this);return this.layersReady.then(function(){return a().then(function(a){if(!a||!a.invalid){var b,c=[];if(this.layout(),this.options.viewState||this.backendApi.isSnapshot&&this._readStoredData){var d=this.options.viewState||this.getSnapshotStoredChartData(),e=d.mapRect;d.inZoomOnMapBoundsMode||!e||void 0===e.width||void 0===e.height||void 0===e.x||void 0===e.y?this.zoomOnMapBounds():this._viewportProjection.zoomOnDataRectangle(e,!0)}else!this._inZoomOnMapBoundsMode||this._firstTimeZoomOnMapBound&&!this._autoZoomOnDataChange?this._scaleMapOnResize&&this._mapRect&&this._viewportProjection.zoomOnDataRectangle(this._mapRect,!0):this._firstTimeZoomOnMapBound=this.zoomOnMapBounds();for(b in this.components)c.push(this.components[b].invalidateDisplay("Map._paint"));return this._dfdUpdatingData&&c.push(this._dfdUpdatingData),this.updateNavigation(),this._dataChanged=!1,u.all(c)}}.bind(this))}.bind(this))},updateNavigation:function(a){if(this._data&&this.rect&&this._mapRect&&this._navigation){var b,c=this.rect.width>=400&&this.rect.height>=400,d=this._layoutMode>=3,e=this.inAnalysisState()||this.inEditState(),f=this._data.navigation?d&&!c:d;this._inZoomOnMapBoundsMode=H.call(this),b=void 0===a?!this._inZoomOnMapBoundsMode||e&&d&&!!this._data.navigation:!a,I.apply(this,[b,f,this._inZoomOnMapBoundsMode])}},getContextMenu:function(a,b){var c=a,d=c.model,e=this.inEditState(),f=d.layout;c.isReadonly&&e||b.addItem({translation:"Common.Navigation",tid:"navigation",icon:"icon-hub-home",select:function(){if(e)d.getProperties().then(function(a){a.navigation=!a.navigation,d.setProperties(a)});else{var a=[{qPath:"/navigation",qOp:void 0===f.navigation?"add":"replace",qValue:f.navigation?"false":"true"}];c.backendApi.applyPatches(a,!0)}}})},destroy:function(){this._super(),this._viewportProjection&&(this._viewportProjection.stopListen("resetZoomFinished"),this._viewportProjection.stopListen("changedByBaseMap"),this._viewportProjection.stopListen("changed"),this._viewportProjection.stopListen("changedByInteraction")),this.onNavigationPressed(),this.interactionController.release()},setSnapshotData:function(a){var b=[];if(this._super(a),this.isSnapshot())return u.resolve();for(var c=0;c<this._data.layers.length;c++)this.components.dataArea.layers[c]&&(b[c]=this.components.dataArea.layers[c].getSnapshotLayerData(a.layers[c]));return u.all(b)},getSnapshotChartData:function(){return a.extend(!0,this._super()||{},{inZoomOnMapBoundsMode:this._inZoomOnMapBoundsMode,mapRect:this._viewportProjection.getDataRectOfViewport()})},getViewState:function(){return{inZoomOnMapBoundsMode:this._inZoomOnMapBoundsMode,mapRect:this._viewportProjection.getDataRectOfViewport()}},isSnapshot:function(){return this.backendApi&&this.backendApi.isSnapshot},getPreferredSize:function(){return this._super()},setInteractionState:function(a){this._super(a),this.components.dataArea.baseMapLayer&&(this.updateNavigation(),this.inAnalysisState()?this.components.dataArea.baseMapLayer.on():this.components.dataArea.baseMapLayer.off())}}),{type:"map",BackendApi:d,template:g,View:J,definition:h,initialProperties:{layers:[]},exportProperties:null,importProperties:null,getDimensionInfo:function(){return[]},getMeasureInfo:function(){return[]},mapProperties:function(){this.mappedDefinition=n.mapDefinition(this.definition,this.type),this.globalChangeListeners=n.findGlobalListeners(this.mappedDefinition),this.dimensionDefinition={min:1,max:1,ppPath:"data"}},addFieldDimension:s.addFieldDimension,addLibraryDimension:s.addLibraryDimension,addDimensionPopoverComponent:r,getDropFieldOptions:s.getDropFieldOptions,getDropDimensionOptions:s.getDropDimensionOptions,getDropMeasureOptions:s.getDropMeasureOptions,getCreatePropertyHandler:function(a){return new o({app:a,dimensionDefinition:this.dimensionDefinition,globalChangeListeners:this.globalChangeListeners,path:"layers.0"})},hasError:function(a){var b,c,d=a.layout;for(b=0;b<d.layers.length;++b){if(c=d.layers[b],c.qHyperCube&&c.qHyperCube.qError)return c.qHyperCube.qError;if(c.geodata&&c.geodata.qHyperCube&&c.geodata.qHyperCube.qError)return c.geodata.qHyperCube.qError}return!1},showRequirements:function(a){var b=a.layout.layers;return!b||!b.length||b[0].qHyperCube.qDimensionInfo.some(function(a){return a.qError&&a.qError.qErrorCode})},support:{cssScaling:!1,snapshot:!0,export:!0,exportData:!1,sharing:!0},options:{selections:{dataArea:{},colorLegend:{}},tooltips:{}}}}),define("extensions.qliktech/combochart/markerarea",["core.utils/deferred","objects.views/charts/components/chart-component","objects.views/charts/renderers/canvas-renderer","objects.views/charts/shapes/container","objects.views/charts/shapes/circle","objects.views/charts/shapes/polygon","objects.views/charts/shapes/rect","extensions.qliktech/linechart/layers/oob-layer"],function(a,b,c,d,e,f,g,h){function i(a){switch(a){case"diamond":case"triangle":return new f;case"circle":return new e;case"line":default:return new g}}function j(a,b,c,d,e,f){var g,h=e.type,i=e.rgb,j=e.shiftedRgb,k=e.isFilled;switch(h){case"circle":a.set(b,c,Math.max(2,Math.min(6,.125*d)));break;case"diamond":g=Math.max(4,Math.min(12,.25*d)),a.set([{x:b,y:c-g/2},{x:b-g/2,y:c},{x:b,y:c+g/2},{x:b+g/2,y:c}]);break;case"triangle":g=Math.max(4,Math.min(12,.25*d)),a.set([{x:b,y:c-g/2},{x:b-g/2,y:c+g/2},{x:b+g/2,y:c+g/2}]);break;case"line":g=Math.max(4,.5*d),g<24?a.set(b-g/2,Math.floor(c)-.5,g,Math.min(3,Math.max(2,Math.round(g/4)))):a.set(Math.floor(b-g/2)-.5,Math.floor(c)-.5,Math.ceil(g),Math.min(3,Math.max(2,Math.round(g/4)))),k=!0;break;default:g=Math.max(4,Math.min(12,.25*d)),a.set(b-g/2,c-g/2,g,g)}k!==!1?(a.fill=i,a.stroke=j):(a.stroke=i,delete a.fill),f&&(a.stroke="#000000")}function k(a){var b,c,d,e,f,g,h,i=this._shapes?this._shapes.length:0,k=this.rect.width,l=this._majorAxis;for(this._outOfRange={up:{},down:{},points:[]},b=0;b<i;b++){h=this._shapes[b],e=this._minorAxes[h.data.axisIdx],f=a[this._measureToAxisIndex[h.data.measureIdx]],g=this.isDimensionContinuous?2:l.getWidthOfId(h.data.axisId),c=this.isDimensionContinuous?this._activeDimAxis.getPositionOfValue(h.data.axisNum):l.getPositionOfId(h.data.axisId),d=e.getPositionOfValue(h.data.end),h.data.x=c,h.data.y=d,h.data.outOfRangeUp=d<f.topCutoff,h.data.outOfRangeDown=d>f.bottomCutoff,h.data.selected=h.data.cacheItem&&h.data.cacheItem.selected,h.opacity=h.data.outOfRangeUp||h.data.outOfRangeDown?0:h.data.selected?1:this._globalAlpha,d=h.data.outOfRangeUp?f.topCutoff+4:h.data.outOfRangeDown?f.bottomCutoff-4:Math.floor(d);var m=h.data.cacheItem&&h.data.cacheItem.selected;this.isDimensionContinuous&&this.selectedRanges&&!m&&(m=this.selectedRanges.some(function(a){return h.data.axisNum>=a.min&&(a.maxIncluded?h.data.axisNum<=a.max:h.data.axisNum<a.max)})),j(h,c,d,g,h.data,m),h.data.isVisible=c>0&&c<k,h.data.isVisible&&(h.data.outOfRangeUp||h.data.outOfRangeDown)&&(h.data.outOfRangeUp&&!this._outOfRange.up[c]?(this._outOfRange.points.push(h),this._outOfRange.up[c]=!0):h.data.outOfRangeDown&&!this._outOfRange.down[c]&&(this._outOfRange.points.push(h),this._outOfRange.down[c]=!0))}}return b.extend("MarkerArea",{init:function(){this._super.apply(this,arguments),this.renderers={markers:new c(this.container,{name:"marker-layer"})},this._oobLayer=new h(this.container),this.layers=[this._oobLayer],this._markerRenderer=this.renderers.markers},setColorMap:function(a){this._colorMap=a},getColorMap:function(){return this._colorMap},getMeasureIndices:function(){return this._measureIndices},setMeasureIndices:function(a){this._measureIndices=a},setMajorAxis:function(a){this._majorAxis=a,this._majorAxis.listen("changed",function(){this.invalidateDisplay("MarkerArea.setMajorAxis")},this)},setMinorAxis:function(a){this._minorAxis=a,this._minorAxis.listen("changed",function(){this.invalidateDisplay("MarkerArea.setMinorAxis")},this)},setSecondaryMinorAxis:function(a){this._secondaryMinorAxis=a,this._secondaryMinorAxis.listen("changed",function(){this.invalidateDisplay("MarkerArea.setSecondaryMinorAxis")},this)},setTimeAxis:function(a){this.timeAxis=a,this.timeAxis.listen("changed",function(){this.invalidateDisplay()},this)},setContinuousAxis:function(a){this.continuousAxis=a,this.continuousAxis.listen("changed",function(){this.invalidateDisplay()},this)},setActiveDimensionAxis:function(a){this._activeDimAxis=a},setIsDimensionContinuous:function(a){this.isDimensionContinuous=a},setDimensionTree:function(a){this._tree=a,this.invalidateProperties()},hasValidData:function(){return this._super()&&this._data},getMajorAxisData:function(){return this._majorAxisData},createAxisData:function(a,b,c,d){return d||(this._cacheIndex=0),a.children.map(function(a){var c;return"dimension"===b.types[d]&&(c={label:a.data.qText,group:!1,id:a.data.id,cacheIndex:[]},"measure"===b.types[d+1]&&c.cacheIndex.push(this._cacheIndex++)),c},this)},_createMeasureDisplayNode:function(a,b,c,d){var e=i(c),f=a.children[0].data,g=a.parent.cacheItem,h=this.measureFormatters[b],j=void 0!==f.qValue?f.qValue:f.qNum,k=a.ancestors.filter(function(a){return"qElemNo"in a.data}).map(function(a){return a.data.qElemNo}).reverse();return e.data={qText:a.data.qText,qNum:j,start:0,end:j,valueLabel:h&&"U"===h.type?h.formatValue(j):a.data.qText,cacheItem:g,type:c,isFilled:d,measureIdx:b,color:this._colorMap.getColor(k,j,b,a.data.rowIndex)},g.addShape("dataArea",e,!0),e.fill=e.data.color.toHex(),e.data.rgb=e.data.color.toRGBA(),e.data.shiftedRgb=e.data.color.createShiftedColor().toRGBA(),e},_createDimensionDisplayNode:function(a){var b=new d;return b.data={qText:a.data.qText},b},_applyIds:function(a,b,c,d){var e;a.children.forEach(function(f,g){e=a.data.id?a.data.id+";"||"":"","dimension"===c[d]?(f.data.id=e+b[d]+":"+f.data.qElemNo,this._applyIds(f,b,c,d+1)):"measure"===c[d]&&(f.data.id=e+b[d+g])},this)},getRenderTree:function(a,b,c,d){var e,f,g;return f=a.children,"measure"===b.types[d]&&this._measureIndices&&(f=f.filter(function(a,b){return this._measureIndices.indexOf(b)>=0},this)),f.map(function(a,f){var h;return"dimension"===b.types[d]?(h=this._createDimensionDisplayNode(a),e=this.getRenderTree(a,b,c,d+1),e.forEach(function(a){h.addChild(a)})):"measure"===b.types[d]&&(g=this._measureIndices?this._measureIndices[f]:f,h=this._createMeasureDisplayNode(a,g,this._data.qHyperCube.qMeasureInfo[g].series.marker||"circle",this._data.qHyperCube.qMeasureInfo[g].series.markerFill),h.data.axisId=a.parent.data.id,h.data.axisNum=a.parent.data.qNum,h.data.axisIdx=b.measureToAxisIndex[g],c.shapes.push(h)),h},this)},updateRangeSelection:function(a){this.isMini||(this.selectedRanges=a)},_updateProperties:function(){if(this._markerRenderer.stage.removeChildren(),this._data&&this._tree){var a,b,c=this._data.qHyperCube.qDimensionInfo.length,d=this._measureIndices?this._measureIndices.length:this._data.qHyperCube.qMeasureInfo.length,e=c+1,f=new Array(c).join(",").split(",").map(function(){return"dimension"}),g=this._data.qHyperCube.qDimensionInfo.concat(this._data.qHyperCube.qMeasureInfo).map(function(a){return a.cId}),h=this._data.qHyperCube.qDimensionInfo.map(function(a){return a.qApprMaxGlyphCount});h.push(this._data.qHyperCube.qMeasureInfo.reduce(function(a,b){return Math.max(a,b.qApprMaxGlyphCount)},0)),this._minorAxes=[this._minorAxis],this._secondaryMinorAxis&&this._minorAxes.push(this._secondaryMinorAxis);var i=this._minorAxes,j=[],k=[];if(this._measureIndices)k=this._measureIndices;else if(d>0&&d<20)for(;k.length<d;)k.push(k.slice(-1)[0]+1||0);k.forEach(function(a){j[a]=i.filter(function(b){return!b._dataIndices||b._dataIndices.indexOf(a)>=0})[0]}),this._measureToAxis=j,this._measureToAxisIndex=j.map(function(a){return i.indexOf(a)}),f.push("measure"),a={shapes:[],shapesToLabel:[],globalPositiveSum:0,globalNegativeSum:0},b={colIds:g,types:f,numLevels:e,numMeasures:d,measureToAxisIndex:this._measureToAxisIndex,axesSettings:this._minorAxes.map(this._getAxisDetails)},this._applyIds(this._tree,g,f,0);var l=this.getRenderTree(this._tree,b,a,0);this._objects=l,this._shapes=a.shapes,l.forEach(function(a){this._markerRenderer.stage.addChild(a)},this);var m=this.createAxisData(this._tree,b,a,0),n=f.map(function(a,b){return{qApprMaxGlyphCount:h[b],show:b<f.length-1}});this._majorAxisData={data:m,info:n},this.setSelectableShapes(a.shapes.map(function(a){return a.data.cacheItem}))}},paint:function(){this._super(this._layoutMode,this._data);var b=this._minorAxes.map(this._getAxisDetails),c=[];return k.call(this,b),this._oobLayer&&(this._oobLayer.update(this._outOfRange.points,{measureToAxisIndex:this._measureToAxisIndex,axesSettings:b,style:{outOfRange:"#999999"},globalAlpha:this._globalAlpha,markerSize:Math.min(8,this._majorAxis.getDiscreteSpacing()/2)}),c.push(this._oobLayer.render())),c.push(this._markerRenderer.render()),a.all(c)},updateSize:function(){this._super(),this.renderers.markers.setDimensions(0,-1,this.rect.width,this.rect.height),this.layers.forEach(function(a){a.rect=this.rect,a.renderer.setDimensions(0,0,this.rect.width,this.rect.height),a.renderer.setDimensionsToContainerRatio(this.layoutToContainerRatios.x,this.layoutToContainerRatios.y)},this)},release:function(){this.layers.forEach(function(a){a.release()}),this._super(),this._majorAxis&&this._majorAxis.stopListen("changed",null,this),this._minorAxis&&this._minorAxis.stopListen("changed",null,this),this._secondaryMinorAxis&&this._secondaryMinorAxis.stopListen("changed",null,this),this.timeAxis&&this.timeAxis.stopListen("changed",null,this),this.continuousAxis&&this.continuousAxis.stopListen("changed",null,this)},clear:function(){this._super(),this.layers.forEach(function(a){a.clear()})},_getAxisDetails:function(a){var b=a.getPlotMin(),c=a.getPlotMax(),d=c-b,e=a.getPadding(),f=e.top-1,g=a.rect.height-e.bottom,h=0;return h=b>0?g:c<0?f:Math.floor(a.getPositionOfValue(0))-.5,{plotMin:b,plotMax:c,posMin:a.getPositionOfValue(b),posMax:a.getPositionOfValue(c),plotRange:d,topCutoff:f,bottomCutoff:g,areaStartBase:h,zeroPos:Math.floor(a.getPositionOfValue(0))-.5}}})}),define("extensions.qliktech/combochart/comboarea",["objects.views/charts/components/chart-component","extensions.qliktech/linechart/linearea","extensions.qliktech/barchart/bararea","extensions.qliktech/combochart/markerarea","core.utils/deferred"],function(a,b,c,d,e){"use strict";return a.extend("ComboArea",{init:function(){var a=new(Function.prototype.bind.apply(c,[null].concat([].slice.call(arguments)))),e=new(Function.prototype.bind.apply(b,[null].concat([].slice.call(arguments)))),f=new(Function.prototype.bind.apply(d,[null].concat([].slice.call(arguments))));this._super.apply(this,arguments),this._data=null,this._layoutMode=null,this._selectableShapes=[],this._shapes=[],this._cacheItems=[],this._colorMap=null,e.setShowDataPoints(!this.isMini),e.setShowDataPointLabels(!1),a.setShowDataPoints(!1),this.subComponents=[a,e,f],this.lineArea=e,this.barArea=a,this.markerArea=f},setYMirrorMode:function(a){this.yMirrorMode=a,this.subComponents.forEach(function(b){b.setYMirrorMode(a)})},setColorMap:function(a){this._colorMap=a,this.subComponents.forEach(function(b){b.setColorMap(a)})},getColorMap:function(){return this._colorMap},setShowDataPoints:function(){},setMajorAxis:function(a){this.subComponents.forEach(function(b){b.setMajorAxis(a)}),this._majorAxis=a},setMinorAxis:function(a){this._minorAxis=a,this.subComponents[0].setMinorAxis(this._minorAxis),this.subComponents[2].setMinorAxis(this._minorAxis)},setTimeAxis:function(a){this.timeAxis=a,this.subComponents.forEach(function(b){b.setTimeAxis(a)})},setContinuousAxis:function(a){this.continuousAxis=a,this.subComponents.forEach(function(b){b.setContinuousAxis(a)})},setActiveDimensionAxis:function(a){this._activeDimAxis=a,this.subComponents.forEach(function(b){b.setActiveDimensionAxis(a)})},setIsDimensionContinuous:function(a){this.isDimensionContinuous=a,this.subComponents.forEach(function(b){b.setIsDimensionContinuous(a)})},getMinorAxisData:function(){return this.barArea.getMinorAxisData()},setSecondaryMinorAxis:function(a){this._secondaryMinorAxis=a},setDimensionTree:function(a){this._tree=a,this.subComponents.forEach(function(b){b.setDimensionTree(a)})},setData:function(a){this._super(a);for(var b=[],c=[],d=[],e=0;e<a.qHyperCube.qMeasureInfo.length;e++)a.qHyperCube.qMeasureInfo[e].series&&"line"===a.qHyperCube.qMeasureInfo[e].series.type?b.push(e):a.qHyperCube.qMeasureInfo[e].series&&"marker"===a.qHyperCube.qMeasureInfo[e].series.type?d.push(e):c.push(e);this.subComponents[0].setHasValidData(c.length>0),this.subComponents[1].setHasValidData(b.length>0),this.subComponents[2].setHasValidData(d.length>0),this.lineArea.setMeasureIndices(b),this.barArea.setMeasureIndices(c),this.markerArea.setMeasureIndices(d),this.subComponents.forEach(function(b){b.setData(a)}),this.barArea.setMinorAxis(this._minorAxis),this.lineArea.setMinorAxis(this._secondaryMinorAxis),this.lineArea.setSecondaryMinorAxis(this._minorAxis),this.markerArea.setMinorAxis(this._minorAxis),this.markerArea.setSecondaryMinorAxis(this._secondaryMinorAxis),this.invalidateProperties()},setHasValidData:function(a){this.subComponents.forEach(function(b){b.setHasValidData(a)})},setLayoutMode:function(a){this._super(a),this.subComponents.forEach(function(b){b.setLayoutMode(a)})},setRect:function(a,b,c,d){this._super(a,b,c,d),this.subComponents.forEach(function(e){e.setRect(a,b,c,d)})},setOuterRect:function(a,b,c,d){this._super(a,b,c,d),this.subComponents.forEach(function(e){e.setOuterRect(a,b,c,d)})},setLayoutToContainerRatios:function(a,b){this._super(a,b),this.subComponents.forEach(function(c){c.setLayoutToContainerRatios(a,b)})},setContainerRect:function(a,b,c,d){this._super(a,b,c,d),this.subComponents.forEach(function(e){e.setContainerRect(a,b,c,d)})},insertAdjacentTo:function(){this._super.apply(this,[].slice.call(arguments)),this.subComponents.forEach(function(a){a.setRect(this.rect.x,this.rect.y,this.rect.width,this.rect.height)},this)},setGlobalOpacity:function(a,b){this._super(a,b),this.subComponents.forEach(function(c){c.setGlobalOpacity(a,b)},this)},setLineType:function(){},updateSize:function(){this._super(),this.subComponents.forEach(function(a){a.updateSize()},this)},_updateDisplay:function(){var a=[];return this.subComponents.forEach(function(b){a.push(b.invalidateDisplay())}),e.all(a)},_updateSize:function(){},updateRangeSelection:function(a){this.isMini?this.lineArea.updateRangeSelection(a):this.subComponents.forEach(function(b){b.updateRangeSelection(a)})},_updateProperties:function(){if(this._data&&this._tree){this.subComponents[0].updateNow(["properties"]),this.subComponents[1].updateNow(["properties"]),this.subComponents[2].updateNow(["properties"]);var a=this.subComponents[0].getSelectableShapes();a&&a.length||(a=this.subComponents[1].getSelectableShapes()),a&&a.length||(a=this.subComponents[2].getSelectableShapes()),this.setSelectableShapes(a)}},invalidateProperties:function(){this._super.apply(this,Array.prototype.slice.call(arguments)),this.subComponents.forEach(function(a){a.invalidateProperties("ComboArea.invalidateProperties")})},hasValidData:function(){
return this._super()&&this._majorAxis&&this._minorAxis&&this._data},paint:function(){this._majorAxis.updateNow(),this._minorAxis.updateNow(),this._activeDimAxis&&this._activeDimAxis.updateNow()},clear:function(){this._super(),this.subComponents.forEach(function(a){a.clear()})},release:function(){this.subComponents.forEach(function(a){a.release()})}})}),define("extensions.qliktech/combochart/combochart-properties",["translator","client.utils/property-resolver","objects.utils/continuous-utils"],function(a,b,c){function d(a,c,d){var e,f=d||0;return e=c?c.getMeasureLayouts():b.getValue(a,"qHyperCubeDef.qMeasures",[]).map(function(a){return a.qDef}),e.filter(function(a){return b.getValue(a,"series.axis",0)===f||0===f&&"bar"===b.getValue(a,"series.type","bar")})}function e(a,b){return b?b.getDimensionLayouts():a.qHyperCubeDef.qDimensions.map(function(a){return a.qDef})}function f(a,b){return b.getMeasures().filter(function(a){return a.qDef.series&&"line"===a.qDef.series.type}).length>0}function g(a,b,c){return b.getMeasures().filter(function(a){return!a.qDef.series||"bar"===a.qDef.series.type}).length>c}var h,i,j,k;return h={uses:"settings",items:{presentation:{type:"items",translation:"properties.presentation",grouped:!0,show:function(a,b,d){return f(a,b)||g(a,b,0)&&!c.isContinuousChart(d.layout)},items:{grouping:{ref:"barGrouping.grouping",type:"string",component:"item-selection-list",defaultValue:"grouped",horizontal:!0,items:[{icon:"∫",component:"icon-item",labelPlacement:"bottom",translation:"properties.grouping.grouped",value:"grouped"},{icon:"ª",component:"icon-item",labelPlacement:"bottom",translation:"properties.grouping.stacked",value:"stacked"}],show:function(a,b,d){return g(a,b,1)&&!c.isContinuousChart(d.layout)}},orientation:{ref:"orientation",type:"string",component:"item-selection-list",defaultValue:"vertical",horizontal:!0,show:!1,items:[{component:"icon-item",icon:"º",labelPlacement:"bottom",translation:"properties.orientation.vertical",value:"vertical"},{icon:"Ω",component:"icon-item",labelPlacement:"bottom",translation:"Common.Horizontal",value:"horizontal"}]},scrollStartPos:{ref:"scrollStartPos",type:"number",translation:"properties.ScrollAlignment",component:"dropdown",defaultValue:0,options:[{value:0,translation:"properties.ScrollAlignStart"},{value:1,translation:"properties.ScrollAlignEnd"}],show:function(a,b,d){return!c.isContinuousChart(d.layout)}},nullMode:{type:"string",component:"dropdown",ref:"nullMode",translation:"properties.nullMode",options:[{value:"gap",translation:"properties.nullMode.gap"},{value:"connect",translation:"properties.nullMode.connect"},{value:"zero",translation:"properties.nullMode.zero"}],defaultValue:"gap",show:function(a,b){return f(a,b)&&b.getMeasures().length>1}},dataPoints:{ref:"dataPoint.show",translation:"properties.dataPoints.showDataPoints",type:"boolean",defaultValue:!1,show:function(a,b){return f(a,b)}}}},colorsAndLegend:{uses:"colorsAndLegend",items:{legend:{items:{show:{snapshot:{tid:"property-legend"}}}}}},dimensionAxis:{uses:"axis.dimensionAxis",label:function(b,c){var d=e(b,c).map(function(a){return a.qFallbackTitle||""}).join(", ");return d?a.get("properties.xAxisWithInfo",[d]):a.get("properties.xAxis")},items:{othersGroup:{items:{dock:{options:[{value:"near",translation:"Common.Bottom"},{value:"far",translation:"Common.Top"}]}}}}},measureAxis:{uses:"axis.measureAxis",label:function(b,c){var e=d(b,c,0).map(function(a){return a.qFallbackTitle});return e.length?a.get("properties.yAxisWithInfo",[e.join(",")]):a.get("properties.yAxis")},show:function(a){return d(a,null,0).length>0},items:{axis:{items:{show:{ref:"measureAxes.0.show",snapshot:{title:"properties.yAxis",tid:"property-yAxis"}},dock:{ref:"measureAxes.0.dock",show:function(a){return"none"!==a.measureAxes[0].show},options:[{value:"near",translation:"properties.dock.left"},{value:"far",translation:"properties.dock.right"}]},spacing:{ref:"measureAxes.0.spacing",show:function(a){return a.measureAxes[0]&&"none"!==a.measureAxes[0].show}}}},minMax:{items:{autoMinMax:{ref:"measureAxes.0.autoMinMax"},minMax:{ref:"measureAxes.0.minMax",defaultValue:"min",show:function(a){return!a.measureAxes[0].autoMinMax}},min:{ref:"measureAxes.0.min",show:function(a){return["min","minMax"].contains(a.measureAxes[0].minMax)&&!a.measureAxes[0].autoMinMax},invalid:function(a){return"minMax"===a.measureAxes[0].minMax&&a.measureAxes[0].min>=a.measureAxes[0].max}},max:{ref:"measureAxes.0.max",show:function(a){return["max","minMax"].contains(a.measureAxes[0].minMax)&&!a.measureAxes[0].autoMinMax},invalid:function(a){return"minMax"===a.measureAxes[0].minMax&&a.measureAxes[0].min>=a.measureAxes[0].max}}}}}},secondaryMeasureAxis:{uses:"axis.measureAxis",label:function(b,c){var e=d(b,c,1).map(function(a){return a.qFallbackTitle});return e.length?a.get("properties.yAxisWithInfo",[e.join(",")]):a.get("properties.yAxis")},show:function(a){return d(a,null,1).length>0},items:{axis:{items:{show:{ref:"measureAxes.1.show"},dock:{ref:"measureAxes.1.dock",defaultValue:"far",show:function(a){return"none"!==a.measureAxes[1].show},options:[{value:"near",translation:"properties.dock.left"},{value:"far",translation:"properties.dock.right"}]},spacing:{ref:"measureAxes.1.spacing",show:function(a){return a.measureAxes[1]&&"none"!==a.measureAxes[1].show}}}},minMax:{type:"items",items:{autoMinMax:{ref:"measureAxes.1.autoMinMax"},minMax:{ref:"measureAxes.1.minMax",defaultValue:"min",show:function(a){return!a.measureAxes[1].autoMinMax}},min:{ref:"measureAxes.1.min",show:function(a){return["min","minMax"].contains(a.measureAxes[1].minMax)&&!a.measureAxes[1].autoMinMax},invalid:function(a){return"minMax"===a.measureAxes[1].minMax&&a.measureAxes[1].min>=a.measureAxes[1].max}},max:{ref:"measureAxes.1.max",show:function(a){return["max","minMax"].contains(a.measureAxes[1].minMax)&&!a.measureAxes[1].autoMinMax},invalid:function(a){return"minMax"===a.measureAxes[1].minMax&&a.measureAxes[1].min>=a.measureAxes[1].max}}}}}}}},i={uses:"data",items:{dimensions:{items:{nullSuppression:{show:function(a,b,d){return!c.isContinuousChart(d.layout)}}}},measures:{items:{series:{type:"items",items:{seriesType:{ref:"qDef.series.type",type:"string",component:"item-selection-list",defaultValue:"bar",horizontal:!0,items:[{icon:function(a){return"stacked"===a.barGrouping.grouping||c.isContinuousChart(a)?"ª":"∫"},component:"icon-item",labelPlacement:"bottom",translation:"properties.style.bar",value:"bar"},{icon:"æ",component:"icon-item",labelPlacement:"bottom",translation:"properties.style.line",value:"line"},{icon:"É",component:"icon-item",labelPlacement:"bottom",translation:"properties.style.marker",value:"marker"}],change:function(){}},seriesAxis:{ref:"qDef.series.axis",type:"integer",component:"dropdown",defaultValue:0,options:[{translation:"properties.axis.primary",value:0},{translation:"properties.axis.secondary",value:1}],show:function(a){return a.qDef&&a.qDef.series&&a.qDef.series.type&&"bar"!==a.qDef.series.type}},seriesMarker:{ref:"qDef.series.marker",type:"string",component:"dropdown",defaultValue:"circle",options:[{translation:"properties.marker.circle",value:"circle"},{translation:"properties.marker.rect",value:"rect"},{translation:"properties.marker.diamond",value:"diamond"},{translation:"properties.marker.triangle",value:"triangle"},{translation:"properties.marker.line",value:"line"}],show:function(a){return a.qDef&&a.qDef.series&&"marker"===a.qDef.series.type}},seriesMarkerFill:{ref:"qDef.series.markerFill",translation:"properties.series.fill",type:"boolean",defaultValue:!0,show:function(a){return a.qDef&&a.qDef.series&&"marker"===a.qDef.series.type&&!["line"].contains(a.qDef.series.marker)}}}}}}}},k={type:"items",translation:"properties.sorting",items:{noContinuousSortingMessage:{component:"text",translation:"properties.sorting.noContinuousSortingMessage",show:function(a,b,d){return c.isContinuousChart(d.layout)}},defaultSorting:{uses:"sorting",show:function(a,b,d){return!c.isContinuousChart(d.layout)}}}},j={type:"items",component:"expandable-items",translation:"properties.addons",items:{dataHandling:{uses:"dataHandling"}}},{type:"items",component:"accordion",items:{data:i,sorting:k,addons:j,settings:h}}}),define("extensions.qliktech/combochart/combochart-explore-properties",["objects.utils/continuous-utils"],function(a){function b(a){return a.qHyperCubeDef.qMeasures.filter(function(a){return a.qDef.series&&"line"===a.qDef.series.type}).length>0}function c(a){return a.qHyperCubeDef.qMeasures.filter(function(a){return!a.qDef.series||"bar"===a.qDef.series.type}).length>1}return{type:"items",component:"accordion",items:{data:{uses:"data"},sort:{uses:"sort",show:function(b,c){return!a.isContinuousChart(c)}},presentation:{uses:"presentation",type:"items",translation:"properties.presentation",grouped:!0,show:function(d,e){return b(d)||c(d)&&!a.isContinuousChart(e)},items:{grouping:{ref:"barGrouping.grouping",type:"string",component:"item-selection-list",horizontal:!0,items:[{icon:"∫",component:"icon-item",labelPlacement:"bottom",translation:"properties.grouping.grouped",value:"grouped"},{icon:"ª",component:"icon-item",labelPlacement:"bottom",translation:"properties.grouping.stacked",value:"stacked"}],show:function(a,b){return c(a)}},nullMode:{type:"string",component:"radio-list",ref:"nullMode",translation:"properties.nullMode",options:function(){return[{value:"gap",translation:"properties.nullMode.gap"},{value:"connect",translation:"properties.nullMode.connect"},{value:"zero",translation:"properties.nullMode.zero"}]},show:function(a){return b(a)&&a.qHyperCubeDef.qMeasures.length>1}},dataPoints:{ref:"dataPoint.show",translation:"properties.dataPoints.showDataPoints",type:"boolean",show:function(a){return b(a)}}}},color:{uses:"color"}}}}),define("extensions.qliktech/combochart/combochart-data",["client.utils/property-resolver"],function(a){function b(b,c){var d=c.getMeasures(),e=a.getValue(b,"color.mode");"byDimension"===e&&1===d.length&&"line"===a.getValue(d[0].qDef,"series.type")?a.setValue(b,"color.mode","primary"):"byDimension"===e&&d.length>1&&a.setValue(b,"color.mode","byMultiple")}return{dimensions:{min:1,max:1,add:function(a,c,d){b(c,d)},move:function(a,c,d){b(c,d)}},measures:{min:1,max:15,add:function(a,c,d){b(c,d)},move:function(a,c,d){b(c,d)},replace:function(a,b){b.qDef.series&&(a.qDef.series.type=b.qDef.series.type||"bar")}}}}),define("objects.utils/hypercube-util",["util"],function(a){function b(b,c){return b?(b=c?a.getValue(b,c):b,b&&b.qHyperCube?b.qHyperCube:null):null}return{getHyperCube:b}}),define("objects.backend-api/generic-api",["./backend-api"],function(a){"use strict";function b(a,b){if(b){if(a[b]){if(a[b].qHyperCube)return b+".qHyperCube";if(a[b].qListObject)return b+".qListObject"}return b.indexOf("Def",b.length-3)!==-1?b.slice(0,b.length-3):b}return a.qHyperCube?"qHyperCube":"qListObject"}var c;return c=a.extend("GenericApi",{init:function(a,c){var d=b(a.layout,c);this._super(a,"/"+d+"Def"),this.isHyperCube=this.dataPath.indexOf("qHyperCube")!==-1,this.cacheCube.setMethodName(this.isHyperCube?"getHyperCubeData":"getListObjectData")},getBackendApi:function(a){return new c(this.model,a)},getProperties:function(){return this.model.getProperties()},setProperties:function(a){return this.model.setProperties(a)},applyPatches:function(a,b){return this.model.applyPatches(a,b)},clearSoftPatches:function(){return this.model.clearSoftPatches()},save:function(){return this.model.setProperties(this.model.properties)},clearSelections:function(){return this.model.resetMadeSelections()},hasSelections:function(){return this.model.layout.qSelectionInfo.qMadeSelections},updateCache:function(a){a&&a[this.dataPath]?(this.cacheCube.set(a[this.dataPath].qDataPages),this.cacheCube.setCubeSize(a[this.dataPath].qSize)):this.cacheCube.clear()},getData:function(a){var b=this.cacheCube.getData(a),c=this;return b.then(function(a){c.model.layout[c.dataPath].qDataPages.push(a[0])}),b},getDataRow:function(a){var b=this.model.layout[this.dataPath];if(b)for(var c=b.qDataPages.length,d=0;d<c;d++){var e=b.qDataPages[d];if(a>=e.qArea.qTop&&a<e.qArea.qTop+e.qArea.qHeight)return e.qMatrix[a-e.qArea.qTop]}return null},selectValues:function(a,b,c){return this.isHyperCube?this.model.selectHyperCubeValues(this.path,a,b,c):this.model.selectListObjectValues(this.path,b,c)},select:function(a,b,c){return this.selectValues(b,a,c)},getReducedData:function(a,b,c){return this.isHyperCube?this.model.getHyperCubeReducedData(this.path,a,b,c||"D1"):null},selectRange:function(a,b,c){return b=!!b,c=c||[],this.model.rangeSelectHyperCubeValues(this.path,a,c,b)},search:function(a){return this.isHyperCube?null:this.model.searchListObjectFor(this.path,a)},abortSearch:function(){return this.isHyperCube?null:this.model.abortListObjectSearch(this.path)},acceptSearch:function(a){return this.isHyperCube?null:this.model.acceptListObjectSearch(this.path,a)},getPivotData:function(a){return this.isHyperCube?this.model.getHyperCubePivotData(this.path,a):null},getStackData:function(a,b){return this.isHyperCube?this.model.getHyperCubeStackData(this.path,a,b||1e3):null},expandTop:function(a,b,c){return this.model.expandTop(this.path,a,b,c||!1)},expandLeft:function(a,b,c){return this.model.expandLeft(this.path,a,b,c||!1)},collapseTop:function(a,b,c){return this.model.collapseTop(this.path,a,b,c)},collapseLeft:function(a,b,c){return this.model.collapseLeft(this.path,a,b,c)}})}),define("objects.utils/data-properties/listobject-handler",["core.utils/deferred","./data-property-handler","objects.utils/data-properties/listobject-util","objects.utils/data-properties/library-utils","util"],function(a,b,c,d,e){"use strict";return b.extend({init:function(a){this._super(a)},minDimensions:function(){return 1},maxDimensions:function(){return 1},minMeasures:function(){return 0},maxMeasures:function(){return 0},autoSortDimension:function(a){return c.autoSortDimension(a)},getDimensions:function(){var a=this.properties.qListObjectDef.qDef;return a&&a.qFieldDefs&&a.qFieldDefs.length||this.properties.qListObjectDef.qLibraryId?[this.properties.qListObjectDef]:[]},addDimension:function(a){function b(){f.properties.qListObjectDef=e.extend(!0,f.properties.qListObjectDef,a),"function"==typeof f.dimensionDefinition.add&&f.dimensionDefinition.add.call(null,a,f.properties,f)}var f=this;return a.qLibraryId?this.app.getDimensionList().then(function(e){var f=d.findLibraryDimension(a.qLibraryId,e);return f&&c.autoSortDimension(a,f.qData.info),b(),a}):this.app.getFieldList().then(function(e){var f=d.findField(a.qDef.qFieldDefs[0],e);return f&&c.autoSortDimension(a,[f]),b(),a})},replaceDimension:function(b,d){var f=this,g=e.extend(!0,this.properties.qListObjectDef,d);return c.autoSortDimension(d),d.qLibraryId?(delete g.qDef.qFieldDefs,delete g.qDef.qFieldLabels):delete g.qLibraryId,f.properties.qListObjectDef=g,a.resolve(d)},removeDimension:void 0,getDimensionLayouts:function(){return[this.getDimensionLayout()]},getDimensionLayout:function(){return this.layout&&this.layout.qListObject&&this.layout.qListObject.qDimensionInfo?this.layout.qListObject.qDimensionInfo:""},getMeasures:function(){return this.properties.qListObjectDef.qExpressions},getMeasureLayout:function(){return this.layout&&this.layout.qListObject&&this.layout.qListObject.qExpressions&&this.layout.qListObject.qExpressions[0]?this.layout.qListObject.qExpressions[0].qExpr:""}})}),define("text!objects.extension/default-template.ng.html",[],function(){return'<div style="height: 100%; position: relative;"></div>\n'}),define("objects.extension/default-extension",["qvangular","util","core.utils/deferred","objects.utils/hypercube-util","objects.backend-api/generic-api","client.utils/property-mapper","objects.utils/data-properties/hypercube-handler","objects.utils/data-properties/listobject-handler","text!./default-template.ng.html","general.utils/visualizations","objects.utils/data-properties/library-utils","objects.extension/object-conversion","client.soft-property-panel/default-explore-properties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(a,b){var c=d.getHyperCube(a,b);if(c)return c.qDimensionInfo||[];if(a.qChildList){return(a.qChildList.qItems||[]).map(function(){return{}})}return a.qListObject&&a.qListObject.qDimensionInfo&&!a.qListObject.qDimensionInfo.qError?[a.qListObject.qDimensionInfo]:[]}function o(a,b){var c=d.getHyperCube(a,b);return c?c.qMeasureInfo||[]:[]}function p(a,b,c){var d,e,f,g,h,i;for(d=0;d<a.data.length;++d){for(e=0;e<a.data[d].dimensions.length;++e)f=a.data[d].dimensions[e],f.qLibraryId&&(h=k.findLibraryDimension(f.qLibraryId,b))&&(f.title=h.qData.title);for(e=0;e<a.data[d].measures.length;++e)g=a.data[d].measures[e],g.qLibraryId&&(i=k.findLibraryMeasure(g.qLibraryId,c))&&(g.title=i.qData.title);for(e=0;e<a.data[d].excludedDimensions.length;++e)f=a.data[d].excludedDimensions[e],f.qLibraryId&&(h=k.findLibraryDimension(f.qLibraryId,b))&&(f.title=h.qData.title);for(e=0;e<a.data[d].excludedMeasures.length;++e)g=a.data[d].excludedMeasures[e],g.qLibraryId&&(i=k.findLibraryMeasure(g.qLibraryId,c))&&(g.title=i.qData.title)}}return{BackendApi:e,template:i,hasDefaultTemplate:function(){return this.template===i},mapProperties:function(){this.mappedDefinition=f.mapDefinition(this.definition,this.type),this.globalChangeListeners=f.findGlobalListeners(this.mappedDefinition);var a=this.data&&this.data.dimensions;a?(a.min=void 0!==a.min?a.min:1,a.max=void 0!==a.max?a.max:1e3):this.data||(a=f.findDefinition(this.mappedDefinition,"qHyperCubeDef.qDimensions",!0),a||(a=f.findDefinition(this.mappedDefinition,"qListObjectDef",!0)),a&&(a.obsolete=!0)),this.dimensionDefinition=a;var b=this.data&&this.data.measures;b?(b.min=void 0!==b.min?b.min:1,b.max=void 0!==b.max?b.max:1):this.data||(b=f.findDefinition(this.mappedDefinition,"qHyperCubeDef.qMeasures",!0))&&(b.obsolete=!0),this.measureDefinition=b},getCreatePropertyHandler:function(a){var b,c,d=this.mappedDefinition,e=this.globalChangeListeners;return this.model.layout.qListObject?(b=f.mapProperties(this.dimensionDefinition),new h({app:a,dimensionDefinition:this.dimensionDefinition,dimensionProperties:b})):(this.dimensionDefinition&&this.dimensionDefinition.obsolete?b=f.mapProperties(this.dimensionDefinition):this.dimensionDefinition&&(b=f.mapProperties(d.items.data.items.dimensions)),this.measureDefinition&&this.measureDefinition.obsolete?c=f.mapProperties(this.measureDefinition):this.measureDefinition&&(c=f.mapProperties(d.items.data.items.measures)),new g({app:a,dimensionDefinition:this.dimensionDefinition,measureDefinition:this.measureDefinition,dimensionProperties:b,measureProperties:c,globalChangeListeners:e}))},mapSoftProperties:function(){function a(b){var c=[{diffs:b.ref||b.sortIndexRef?[b.ref||b.sortIndexRef]:b.diffs||[]}];return b.items&&Object.keys(b.items).forEach(function(d){c.push({diffs:a(b.items[d])})}),b._diffs=c,c}if(this.softDefinition){var b=f.mapDefinition(this.softDefinition,null,m);a(b),this.mappedSoftDefinition=b}},hasError:function(a){var b=a.layout,c=a.ext&&a.ext.options.hyperCubePath?b[a.ext.options.hyperCubePath].qHyperCube:b.qHyperCube;return c?!!c.qError:!!b.qListObject&&!!b.qListObject.qError},showRequirements:function(a){var b,c=a.ext.dimensionDefinition?a.ext.dimensionDefinition.min:0,d=a.ext.measureDefinition?a.ext.measureDefinition.min:0,e=n(a.layout,a.ext.options.hyperCubePath),f=o(a.layout,a.ext.options.hyperCubePath);if(c>0&&e.length<c)return!0;for(b=0;b<e.length;++b)if(e[b].qError)return!0;if(d>0&&f.length<d)return!0;for(b=0;b<f.length;++b)if(f[b].qError)return!0;return!1},addFieldDimension:function(b,c){return c.model.getProperties().then(function(d){var e=c.getCreatePropertyHandler();return e.setProperties(d),e.addFieldDimension(b.value,b.trimmedValue).then(function(b){return e.updateGlobalChangeListeners(),a.$rootScope.$broadcast("pp-open-path","data."+b.qDef.cId),c.model.setProperties(d)})})},addLibraryDimension:function(b,c){return c.model.getProperties().then(function(d){var e=c.getCreatePropertyHandler();return e.setProperties(d),e.addLibraryDimension(b.libraryId).then(function(b){return e.updateGlobalChangeListeners(),a.$rootScope.$broadcast("pp-open-path","data."+b.qDef.cId),c.model.setProperties(d)})})},addLibraryMeasure:function(b,c){return c.model.getProperties().then(function(d){var e=c.getCreatePropertyHandler();return e.setProperties(d),e.addLibraryMeasure(b.libraryId).then(function(b){e.updateGlobalChangeListeners(),a.$rootScope.$broadcast("pp-open-path","data."+b.qDef.cId),c.model.setProperties(d)})})},addExpressionMeasure:function(b,c){return c.model.getProperties().then(function(d){var e=c.getCreatePropertyHandler();return e.setProperties(d),e.addExpressionMeasure(b.value,b.trimmedValue).then(function(b){return e.updateGlobalChangeListeners(),a.$rootScope.$broadcast("pp-open-path","data."+b.qDef.cId),c.model.setProperties(d)})})},getDropFieldOptions:function(a,b,c,d,e){a.Add(c,b,e),a.ReplaceDimensions(c,b,e),a.AddFieldAsMeasure(c,b,e),a.ColorBy(c,b,e),d()},getDropDimensionOptions:function(b,c,d,e,f){c.getDimensions().length<c.minDimensions()?c.addLibraryDimension(b.item.id).then(function(b){d.setProperties(c.properties),a.$rootScope.$broadcast("pp-open-path","data."+b.qDef.cId)}):(b.Add(d,c,f),b.ReplaceDimensions(d,c,f),b.ColorBy(d,c,f),e())},getDropMeasureOptions:function(b,c,d,e,f){var g=c.getMeasures().length;g<c.minMeasures()||0===g&&g<c.maxMeasures()?"expression"===b.item.type?c.addExpressionMeasure(b.item.name,"").then(function(b){d.setProperties(c.properties),a.$rootScope.$broadcast("pp-open-path","data."+b.qDef.cId)}):c.addLibraryMeasure(b.item.id).then(function(b){d.setProperties(c.properties),a.$rootScope.$broadcast("pp-open-path","data."+b.qDef.cId)}):(b.Add(d,c,f),b.ReplaceMeasures(d,c,f),b.ColorBy(d,c,f),e())},getDropTemplateOptions:function(a,b,c,d,e){var f=this,g=j.getType(a.item.template),h=["contextMenu.convertTo",a.item.name];f.type!==g.type?g.getExtensionType().then(function(b){!e.isReadonly&&!c.layout.qHasSoftPatches&&f.exportProperties&&b.importProperties&&a.menu.addItem({translation:h,tid:"convert",select:function(){f._convert(g,b,a.item)}}),d()},function(){d()}):d()},getDropOptions:function(a,c,d){var e,f,g,h=a.model,i=this;if(f={field:"getDropFieldOptions",dimension:"getDropDimensionOptions",measure:"getDropMeasureOptions",template:"getDropTemplateOptions",expression:"getDropMeasureOptions"},e=c.item.type,g=f[e])return h.getProperties().then(function(e){var f=a.getCreatePropertyHandler(),j=b.extend(!0,{},e);return f.setProperties(j),f.setLayout(a.model&&a.model.layout),i[g](c,f,h,d,a)});d()},_convert:function(a,b,d){var e,f,g=this;c.all({initialProperties:a.getInitialProperties(d.init),propertyTree:g.model.getFullPropertyTree()}).then(function(a){try{e=g.exportProperties(a.propertyTree,g.options?g.options.hyperCubePath:void 0),c.all({dimensionList:g.model.app.getDimensionList(),measureList:g.model.app.getMeasureList()}).then(function(c){p(e,c.dimensionList,c.measureList),f=b.importProperties(e,a.initialProperties,b,b.options?b.options.hyperCubePath:void 0),g.model.getLayout().then(function(a){a.qHasSoftPatches?(g.model.markAsCancelled(),g.model.clearSoftPatches().then(function(){g.model.setFullPropertyTree(f).then(function(){g.model.markAsInvalid()})})):g.model.setFullPropertyTree(f)})})}catch(a){}})},exportProperties:function(a){return a.qProperty.qHyperCubeDef?l.hypercube.exportProperties(a):a.qProperty.qListObjectDef?l.listbox.exportProperties(a):l.other.exportProperties(a)},importProperties:function(a,b,c){return b.qHyperCubeDef?l.hypercube.importProperties(a,b,c):b.qListObjectDef?l.listbox.importProperties(a,b,c):l.other.importProperties(a,b,c)},support:{cssScaling:!1,sharing:!1,snapshot:!1,export:!1,exportData:!0},options:{},hasNewType:function(a,b){return a.type!==b}}}),define("text!extensions.qliktech/combochart/combochart.ng.html",[],function(){return'<div class="qv-viz"></div>\n<span class="qv-viz-center-disclaimer" ng-if="dataAttributes.noDataExist && dataAttributes.layoutMode > 2" q-translation="Object.Disclaimer.NoDataExist" q-title-translation="Object.Disclaimer.NoDataExist" dir="ltr"></span>\n<div qva-chart-disclaimer attributes="dataAttributes" visible="!dataAttributes.noDataExist" direction="options.direction"></div>'}),define("extensions.qliktech/combochart/combochart",["jquery","util","qvangular","core.utils/deferred","objects.views/charts/scrollable-chart","objects.views/charts/components/chart-component","objects.views/charts/components/axis/continuous-axis","objects.views/charts/components/data-title/data-title","extensions.qliktech/combochart/comboarea","extensions.qliktech/combochart/combochart-properties","extensions.qliktech/combochart/combochart-explore-properties","extensions.qliktech/combochart/combochart-data","objects.views/charts/disclaimers/chart-utils","objects.views/charts/components/axis/axis-utils","objects.backend-api/hypercube-api","objects.extension/default-extension","objects.extension/object-conversion","text!./combochart.ng.html","objects.utils/continuous-utils"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){"use strict";function t(a){var b=[],c=[];return a.qHyperCube.qMeasureInfo.forEach(function(a){a.series&&"bar"!==a.series.type&&1===a.series.axis?c.push(a):b.push(a)}),{primaryMeasures:b,secondaryMeasures:c}}function u(a,c,d,e,f,g){if(c.length){var h,i,j;f?(h=f.min,i=f.max):(h=Math.min.apply(this,c.filter(function(a){return!isNaN(a.qMin)}).map(function(a){return a.qMin})),i=Math.max.apply(this,c.filter(function(a){return!isNaN(a.qMax)}).map(function(a){return a.qMax}))),b.isNumeric(h)||(h=-1),b.isNumeric(i)||(i=1),j=this.getAxisOptions(d),e&&(i=Math.max(0,i),h=Math.min(0,h)),g&&(g.min=h,g.max=i,g.minMeasure&&g.maxMeasure?(this._cutMode=this.getSpikeSettings(g,j),h=this._cutMode.min,i=this._cutMode.max):this._cutMode={positive:!1,negative:!1}),a.setRealDataRange(void 0,void 0),this.setAxisDataRange(a,i,h,j.max,j.min,1)}}function v(a,b){var d,e=this.item,f=["contextMenu.add",e.name];b.canAddMeasure()&&(d=this.menu.addItem({translation:f,tid:"add-as"}),d.addItem({translation:"contextMenu.asBar",tid:"as-bar",icon:"icon-bar-chart-vertical",select:function(){b.addLibraryMeasure(e.id).then(function(d){d.qDef.series.type="bar",b.updateGlobalChangeListeners(),a.setProperties(b.properties),c.$rootScope.$broadcast("pp-open-path","data."+d.qDef.cId)})}}),d.addItem({translation:"contextMenu.asLine",tid:"as-line",icon:"icon-line-chart",select:function(){b.addLibraryMeasure(e.id).then(function(d){d.qDef.series.type="line",d.qDef.series.axis=1,b.updateGlobalChangeListeners(),a.setProperties(b.properties),c.$rootScope.$broadcast("pp-open-path","data."+d.qDef.cId)})}}),d.addItem({translation:"contextMenu.asMarker",tid:"as-marker",icon:"icon-shapes",select:function(){b.addLibraryMeasure(e.id).then(function(c){c.qDef.series.type="marker",c.qDef.series.axis=1,b.updateGlobalChangeListeners(),a.setProperties(b.properties)})}})),b.canColorBy().byMeasure&&this.menu.addItem({translation:["contextMenu.colorBy",e.name],tid:"colorby",select:function(){b.setColorByDef(e),b.updateGlobalChangeListeners(),a.setProperties(b.properties)}})}var w,x={NONE:0,ONE_DIM:1,TWO_DIM:2};return w=e.extend("ComboChart",{namespace:".combochart",init:function(b,c,d,e,j){if(d=a.extend(!0,{components:{dataArea:{clazz:i},miniChart:{components:{dataArea:{clazz:i},secondaryMeasureAxis:{show:!1,dock:"right",clazz:g}}},axis:{show:!0,order:1.1,reductionOrder:2.1,dock:"right",relevantSize:90,showFlag:f.prototype.ShowFlags.XSMALL,clazz:g},secondaryMeasureAxisTitle:{show:!0,order:1.2,dock:"right",relevantSize:30,reductionOrder:1,showFlag:f.prototype.ShowFlags.SMALL,clazz:h}}},d||{}),this._super(b,c,d,e,j),this.components.scrollArea.setUseMiniChart(!1),this.components.axis.setShowStrategy("all"),this.components.dataArea.setSecondaryMinorAxis(this.components.axis),this.components.secondaryMeasureAxisTitle.setType("measure"),this.components.secondaryMeasureAxisTitle.setModel(b.ext.model),this.components.miniChart){var k=this.components.miniChart;this.components.miniChart.setBackendApi(this.backendApi),this.components.scrollArea.setMiniChart(k),k.setColorMap(this.providers.colorMap),k.components.measureAxis.setDock("left"),k.components.dimensionAxis.setDock("bottom"),k.components.dataArea.setMinorAxis(k.components.measureAxis),k.components.dataArea.setMajorAxis(k.components.dimensionAxis),k.components.dataArea.setSecondaryMinorAxis(k.components.secondaryMeasureAxis)}},getVerticalComponents:function(){var a,b=this._super();return this._data&&this.components&&(this.components.measureAxis&&this.components.measureAxis.isVertical()&&this._data.measureAxes&&(a=this._data.measureAxes[0].dock,b.push({comp:this.components.measureAxis,dock:a}),this.components.measureAxisTitle&&b.push({comp:this.components.measureAxisTitle,dock:a})),this.components.axis&&this.components.axis.isVertical()&&this._data.measureAxes&&this._data.measureAxes.length>1&&(a=this._data.measureAxes[1].dock,b.push({comp:this.components.axis,dock:a}),this.components.secondaryMeasureAxisTitle&&b.push({comp:this.components.secondaryMeasureAxisTitle,dock:a}))),b},partialUpdate:function(a){var b,c,e,f=[],g=this._dataOptions.primary.indexOf(this._dataOptions.barSeries[0])>=0;this._enablePagingTransitions(),this._chartContext.refresh(a),this.providers.colorMap.setData(a),c=a.qHyperCube.qStackedDataPages.length>0?this._pagingInfo.y:a.qHyperCube.qDataPages[0].qArea.qTop,this.components.dimensionAxis.setInnerOffset(c*this.scrollMultiplicator);for(b in this.components)"miniChart"!==b&&this.components[b].invalidateProperties("ScrollableChart.partialUpdate");this.components.dataArea.updateNow(["properties"]),e=this.components.dataArea.barArea.getMeasureIndices().length?this.components.dataArea.barArea.getMajorAxisData():this.components.dataArea.markerArea.getMeasureIndices().length?this.components.dataArea.markerArea.getMajorAxisData():this.components.dataArea.lineArea.getMajorAxisData(),this.components.dimensionAxis.setDataRange(e.data,e.info);var h=this.components.dataArea.barArea.getMinorAxisData();return h&&this._dataOptions.primary.forEach(function(a){this._dataOptions.barSeries.indexOf(a)<0&&!isNaN(a.qMin)&&(h.min=Math.min(a.qMin,h.min),h.max=Math.max(a.qMax,h.max))},this),u.apply(this,[this.components.measureAxis,this._dataOptions.primary,this._dataOptions.axes.measureAxis,g,h,h?this.getPrimaryMeasureSettings(a,this._dataOptions):null]),this.components.dimensionAxis.updateNow(["properties"]),this.components.colorLegend.updateNow(["properties"]),this.components.dimensionAxis.updateLevels(),f.push(this.components.dimensionAxis.invalidateDisplay("ScrollableChart.partialUpdate")),f.push(this.components.dataArea.invalidateDisplay("ScrollableChart.partialUpdate")),f.push(this.components.colorLegend.invalidateDisplay("ScrollableChart.partialUpdate")),d.all(f)},isValid:function(a){return this._super(a)&&!this.supressChartRendering},_paint:function(){if(!this.isValid(this._data))return this.clear();this._super();var a,b=this.components.scrollArea,c=this.rect.height,e=this.getSnapshotStoredChartData(),f=0,g=[];(this._cutMode.positive||this._cutMode.negative)&&(this._layoutMode>=31&&(f=48),f=this._layoutMode>=15?32:this._layoutMode>=7?16:8),this.components.measureAxis.setPadding(this._cutMode.positive?f:0,0,this._cutMode.negative?f:0,0),this.components.axis.setPadding(this._cutMode.positive?f:0,0,this._cutMode.negative?f:0,0),this.components.dimensionAxis.setMaxDiscreteUnitSize(Math.max(1,Math.ceil(c/4))),this.components.dataArea.updateNow(["properties"]),this.components.dimensionAxis.updateNow(["properties"]),this.layout(),this._readStoredData?(this.components.dimensionAxis.setInnerOffset(e.axisInnerOffset),this.components.scrollArea.setOffset(e.scrollOffset),this.components.scrollArea.setViewRange(e.viewRange)):this.options.viewState&&(this.components.dimensionAxis.setInnerOffset(this.options.viewState.axisInnerOffset),this.components.scrollArea.setOffset(this.options.viewState.scrollOffset))
;var h=this.checkPage();if(h)g.push(h);else{for(a in this.components)g.push(this.components[a].invalidateDisplay("ComboChart.paint"));b.viewState.min+b.viewState.range>b.fullState.max&&b.setOffset(b.fullState.max-b.viewState.range)}return d.all(g)},prePaint:function(a){this._super(a),m.applyDisclaimerAttributes({paging:!0},this.$scope.dataAttributes,this.$element,this.$scope,a),this.supressChartRendering=this.$scope.dataAttributes.noDataExist},updateData:function(a){if(this.setIsDimensionContinuous(s.isContinuousChart(a)),this._setActiveDimensionAxis(a),this.isDimensionContinuous){var b=this,c=this._super;return this.updateFullContinuousData(a).then(function(a){return c.call(b,a)})}return this._super(a)},_updateData:function(b){var c=[];this._checkPage=!1;var e,g,h,i,j,k,l,m,n,o,p=this.getSnapshotStoredChartData();if(this.components.scrollArea.setUseMiniChart(this.isDimensionContinuous),e=b.qHyperCube.qMeasureInfo.filter(function(a){return a.series&&"line"===a.series.type}),g=b.qHyperCube.qMeasureInfo.filter(function(a){return!a.series||"bar"===a.series.type}),h=b.qHyperCube.qMeasureInfo.filter(function(a){return a.series&&"marker"===a.series.type}),i=t(b),j=i.primaryMeasures,k=i.secondaryMeasures,this.isStacked=!1,this.components.measureAxis.isStacked=("stacked"===b.barGrouping.grouping||this.isDimensionContinuous)&&g.length>1,this.components.axis.isStacked=!1,this._pagingMode=x.NONE,this.scrollMultiplicator="grouped"===b.barGrouping.grouping&&g.length>1?g.length+1:1,this.components.dataArea.setIsDimensionContinuous(this.isDimensionContinuous),this.isDimensionContinuous)this._pagingMode=x.NONE;else{if(b.qHyperCube.qSize.qcy>b.qHyperCube.qDataPages[0].qArea.qHeight){this._pagingMode=x.ONE_DIM;var q=b.qHyperCube.qSize.qcy;"grouped"===b.barGrouping.grouping&&g.length>1&&(this.scrollMultiplicator=g.length+1,q*=this.scrollMultiplicator),this.components.dimensionAxis.setNumDiscreteUnits(q)}else this.components.dimensionAxis.setNumDiscreteUnits(null);this.components.dimensionAxis.isDiscrete()||(this._pagingMode=x.NONE)}var r=a.extend(!0,{},b.measureAxes[0],{show:j.length?b.measureAxes[0].show:"none"}),s=a.extend(!0,{},b.measureAxes[1],{show:k.length?b.measureAxes[1].show:"none",dock_:["near","far"].contains(b.measureAxes[0].dock)?"near"===b.measureAxes[0].dock?"far":"near":f.prototype.getOppositeDock.call({options:{dock:b.measureAxes[0].dock}})});l={primary:j,secondary:k,lineSeries:e,markerSeries:h,barSeries:g,axes:{measureAxis:{component:this.components.measureAxis,data:r,dataIndices:j.map(function(a){return b.qHyperCube.qMeasureInfo.indexOf(a)})},secondaryMeasureAxis:{component:this.components.axis,data:s,dataIndices:k.map(function(a){return b.qHyperCube.qMeasureInfo.indexOf(a)})},dimensionAxis:{component:this.components.dimensionAxis,data:b.dimensionAxis,dataIndices:b.qHyperCube.qDimensionInfo.map(function(a,b){return b})},timeAxis:{component:this.components.timeAxis,data:b.dimensionAxis},continuousAxis:{component:this.components.continuousAxis,data:b.dimensionAxis}},axisTitles:{dimensionAxisTitle:{component:this.components.dimensionAxisTitle,data:b.dimensionAxis},measureAxisTitle:{component:this.components.measureAxisTitle,data:r},secondaryMeasureAxisTitle:{component:this.components.secondaryMeasureAxisTitle,data:s}}},m=this.components.dimensionAxisTitle,n=this.components.measureAxisTitle,o=this.components.secondaryMeasureAxisTitle,this._dataOptions=l;var u=[],v=[];return j.forEach(function(a){u.push({label:a.qFallbackTitle,index:b.qHyperCube.qMeasureInfo.indexOf(a)})}),k.forEach(function(a){v.push({label:a.qFallbackTitle,index:b.qHyperCube.qMeasureInfo.indexOf(a)})}),this._data=b,c.push(m.setData(b)),c.push(n.setData(u)),c.push(o.setData(v)),c.push(this.components.dataArea.setData(b)),c.push(this.providers.colorMap.setData(b)),c.push(this.components.colorLegend.setData(b)),this.providers.colorMap.getLegendDataProvider().setMeasureLegendTypes(b.qHyperCube.qMeasureInfo.map(function(a){return a.series&&a.series.type?"line"===a.series.type?b.dataPoint.show?["line","circle"]:["line"]:"marker"===a.series.type?[(a.series.markerFill===!1?"!":"")+(a.series.marker||"circle")]:["rect"]:["rect"]})),this._super(b,l),this._readStoredData?(this.components.dimensionAxis.setInnerOffset(p.axisInnerOffset),this.components.scrollArea.setOffset(p.scrollOffset),this.components.scrollArea.setViewRange(p.viewRange)):this.options.viewState?(this.components.dimensionAxis.setInnerOffset(this.options.viewState.axisInnerOffset),this.components.scrollArea.setOffset(this.options.viewState.scrollOffset)):isNaN(b.scrollStartPos)?this.isDimensionContinuous||(this.components.dimensionAxis.setInnerOffset(0),this.components.scrollArea.setOffset(0)):this.components.scrollArea.setRelativeOffset(b.scrollStartPos),this.isDimensionContinuous||(this._checkPage=!0),d.all(c)},initSelections:function(){if(this._super(),!this.options._disableSelections){this.selections.types.range.addComponent("y",this.components.axis),this.selections.Select.bind(function(a,b){var c,d=this.selections.getActiveType().activeComponent;c=d.subComponents?this.components.dimensionAxis.getType().current:d.getSelectionIndices(),this.onSelection.Select.apply(this,[a,b,c])}.bind(this));var a=function(a){this.onSelection.scheduleInvalidation.call(this),this.components.timeAxis.setSelectedRanges(a),this.components.dataArea.updateRangeSelection(a),this.components.miniChart.components.dataArea.updateRangeSelection(a)};this.selections.UpdateRanges.bind(a.bind(this)),this.selections.Clear.bind(a.bind(this,[])),this.selections.Deactivated.bind(a.bind(this,[]))}},updateDataArea:function(a,b){this._super.apply(this,[].slice.call(arguments)),"byExpression"===a.color.mode?this.components.dataArea.lineArea.interpolateVaryingColors=!a.color.expressionIsColor&&["sg","dg"].indexOf(a.color.measureScheme)!==-1:this.components.dataArea.lineArea.interpolateVaryingColors=!1;var c="area"===a.lineType&&a.stackedArea?"stackedArea":a.lineType;this.components.dataArea.lineArea.setShowDataPoints(a.dataPoint.show),this.components.dataArea.lineArea.setLineType(c),this.components.dataArea.lineArea.setNullMode(a.nullMode);var d=this.isDimensionContinuous?"stacked":a.barGrouping.grouping;if(this.components.dataArea.barArea.setGroupingMode(d),this.components.miniChart){this.components.miniChart.components.dataArea.lineArea.setLineType(c),this.components.miniChart.components.dataArea.lineArea.setNullMode(a.nullMode),this.components.miniChart.components.dataArea.barArea.setGroupingMode(d);var e,f;for(e in b.axes){var g=b.axes[e];f=this.components.miniChart.components[e],f&&(f.setDataIndices(g.dataIndices||[g.dataIndex||0]),f.setCurrentDataIndices(g.currentDataIndices||g.dataIndices||[g.dataIndex||0]))}}this.components.dataArea.updateNow(["properties"])},getMinDiscreteUnitSize:function(){return this._minDiscreteUnitSize},updateAxis:function(b,c){var d,e,g,h=c.primary.indexOf(c.barSeries[0])>=0,i=this.getSnapshotStoredChartData(),j=t(b),k=a.extend(!0,{},b.measureAxes[0],{show:j.primaryMeasures.length?b.measureAxes[0].show:"none"}),l=a.extend(!0,{},b.measureAxes[1],{show:j.secondaryMeasures.length?b.measureAxes[1].show:"none",dock_:["near","far"].contains(b.measureAxes[0].dock)?"near"===b.measureAxes[0].dock?"far":"near":f.prototype.getOppositeDock.call({options:{dock:b.measureAxes[0].dock}})});this._super(b,c),this.components.timeAxis.setData(b),this._cutMode={positive:!1,negative:!1};var m=this.components.dataArea.barArea.getMinorAxisData();m&&c.primary.forEach(function(a){c.barSeries.indexOf(a)<0&&!isNaN(a.qMin)&&(m.min=Math.min(a.qMin,m.min),m.max=Math.max(a.qMax,m.max))}),this._readStoredData&&i.dataRanges&&(m.min=i.dataRanges[0].min,m.max=i.dataRanges[0].max),u.apply(this,[this.components.measureAxis,c.primary,c.axes.measureAxis,h,m,h?this.getPrimaryMeasureSettings(b,c):null]),u.apply(this,[this.components.axis,c.secondary,c.axes.secondaryMeasureAxis,"zero"===b.nullMode,null]),e=this.chartFormatter.getFormattersForMeasures(b.qHyperCube.qMeasureInfo,c.primary.map(function(a){return b.qHyperCube.qMeasureInfo.indexOf(a)})),g=this.chartFormatter.getFormattersForMeasures(b.qHyperCube.qMeasureInfo,c.secondary.map(function(a){return b.qHyperCube.qMeasureInfo.indexOf(a)})),this.components.measureAxis.combinedMeasuresFormatter=this.chartFormatter.getFormatterFromFormatters(e),this.components.axis.combinedMeasuresFormatter=this.chartFormatter.getFormatterFromFormatters(g),c.barSeries.length?d=this.components.dataArea.barArea.getMajorAxisData():c.markerSeries.length?(d=this.components.dataArea.markerArea.getMajorAxisData(),c.lineSeries.length||d.data.forEach(function(a){for(var b=[],d=0;d<c.markerSeries.length;d++)b.push(a.cacheIndex[0]*c.markerSeries.length+d);a.cacheIndex=b})):d=c.lineSeries.length?this.components.dataArea.lineArea.getMajorAxisData():{data:[],info:[],groupSize:null},this.components.dimensionAxis.setDataRange(d.data,d.info),this._updateMinDiscreteUnitSize(this.components.dimensionAxis);var o=this.components.dimensionAxisTitle,p=this.components.measureAxisTitle,q=this.components.secondaryMeasureAxisTitle;if(o.setDock("far"===b.dimensionAxis.dock?"top":"bottom"),p.setDock("far"===k.dock?"right":"left"),q.setDock("far"===l.dock?"right":"left"),o.setSelectionsEnabled(!!this.selections),p.setSelectionsEnabled(!!this.selections),q.setSelectionsEnabled(!!this.selections),c.primary.length&&c.secondary.length||b.measureAxes.every(function(a){return"none"===a.show}))this.components.dimensionAxis.setUnitAlignment("center");else{var r=c.primary.length?b.measureAxes[0]:b.measureAxes[1];this.components.dimensionAxis.setUnitAlignment(n.getAxisUnitAlignment(r.dock,this.components.dimensionAxis.isHorizontal()))}this.updateTimeAxis()},updateGrid:function(a,b){this._super(a,b),!b.primary.length&&b.secondary.length||["all","labels"].indexOf(b.axes.measureAxis.data.show)<0&&b.secondary.length&&["all","labels"].indexOf(b.axes.secondaryMeasureAxis.data.show)>=0?this.components.grid.setAxes(this._activeDimAxis,this.components.axis):this.components.grid.setAxes(this._activeDimAxis,this.components.measureAxis)},_updateMinDiscreteUnitSize:function(a){this._super(a)},getPrimaryMeasureSettings:function(a,c){var d,e,f,g,h=c.primary.filter(function(a){return!isNaN(a.qMin)}).map(function(b){return{min:b.qMin,max:b.qMax,index:a.qHyperCube.qMeasureInfo.indexOf(b),isBarSeries:c.barSeries.indexOf(b)>=0}}),i=c.primary.filter(function(a){return!isNaN(a.qMin)&&c.barSeries.indexOf(a)<0});return h.length&&(d=h.reduce(function(a,b){return a.min<b.min?a:b},h[0]),e=h.reduce(function(a,b){return a.max>b.max?a:b},h[0]),e&&(g=d.max),d&&(f=d.min),b.isNumeric(f)||(f=0),b.isNumeric(g)||(g=1)),{minMeasure:d,maxMeasure:e,nonBarSeriesMax:Math.max.apply(null,i.map(function(a){return a.qMax})),nonBarSeriesMin:Math.min.apply(null,i.map(function(a){return a.qMin})),min:f,max:g,data:a,options:c}},getSpikeSettings:function(a,b){var c,d,e=a.data,f=a.minMeasure,g=a.maxMeasure,h=a.min,i=a.max,j=0,k=0,l=0,m=0,n=!1,o=!1,p=g.index+e.qHyperCube.qDimensionInfo.length,q=f.index+e.qHyperCube.qDimensionInfo.length,r=e.qHyperCube.qDataPages[0]?e.qHyperCube.qDataPages[0].qMatrix:[];if(!isNaN(a.nonBarSeriesMax)&&a.nonBarSeriesMax>0&&(j=a.nonBarSeriesMax),!isNaN(a.nonBarSeriesMin)&&a.nonBarSeriesMin<0&&(k=a.nonBarSeriesMin),!this.components.measureAxis.isStacked){for(var s=0;s<r.length;s++)c=r[s],d=c[p].qNum,d>0&&!isNaN(d)&&(c[0].qIsOtherCell||c[1].qIsOtherCell?l=Math.max(d,l):j=Math.max(d,j)),(d=c[q].qNum)<0&&!isNaN(d)&&(c[0].qIsOtherCell||c[1].qIsOtherCell?m=Math.min(d,m):k=Math.min(d,k));null!==b.max&&b.max<g.max?n=b.max>0:j>0&&l/j>5&&(i=j,n=i>=0),null!==b.min&&b.min>f.min?o=b.min<0:k<0&&m/k>5&&(h=k,o=h<0)}return{max:i,min:h,positive:n,negative:o}},getPreferredSize:function(){return this._super()}}),{type:"ComboChart",BackendApi:o,template:r,View:w,definition:j,softDefinition:k,initialProperties:{qHyperCubeDef:{qDimensions:[],qMeasures:[],qInitialDataFetch:[{qWidth:17,qHeight:500}],qSuppressMissing:!0},measureAxes:[{autoMinMax:!0,dock:"near",max:10,min:0,minMax:"min",show:"all",spacing:1},{autoMinMax:!0,dock:"far",max:10,min:0,minMax:"min",show:"all",spacing:1}]},data:l,support:{cssScaling:!1,snapshot:!0,export:!0,exportData:!0,sharing:!0},options:{selections:{dataArea:{},range:{},colorLegend:{}},tooltips:{}},getDropMeasureOptions:function(a,b,c,d,e){"measure"===a.item.type?(v.call(a,c,b,e),b.getMeasures().length>=b.minMeasures()&&a.ReplaceMeasures(c,b,e),d()):p.getDropMeasureOptions(a,b,c,d,e)},importProperties:function(a,c,d){var e,f=q.axisChart.importProperties.apply(q,[a,c,d]),g="linechart"===a.properties.visualization,h=[];return f.qProperty.qHyperCubeDef.qMeasures.forEach(function(a){a.qDef.series||(a.qDef.series={type:g?"line":"bar",axis:0,marker:"circle",markerFill:!0}),h.indexOf(a.qDef.series.axis)<0&&h.push(a.qDef.series.axis)}),e=h.sort().shift(),f.qProperty.measureAxes[e]&&a.properties.measureAxis&&void 0!==a.properties.measureAxis.autoMinMax&&b.extend(!0,f.qProperty.measureAxes[e],a.properties.measureAxis,{logarithmic:!1}),f},exportProperties:q.axisChart.exportProperties.bind(q)}}),function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define("assets/external/picasso/picasso",[],b):"object"==typeof exports?exports.picasso=b():a.picasso=b()}(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.i=function(a){return a},b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s=278)}([function(a,b,c){var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},e=Object.prototype.hasOwnProperty,f=Object.prototype.toString,g=function(a){return"function"==typeof Array.isArray?Array.isArray(a):"[object Array]"===f.call(a)},h=function(a){if(!a||"[object Object]"!==f.call(a))return!1;var b=e.call(a,"constructor"),c=a.constructor&&a.constructor.prototype&&e.call(a.constructor.prototype,"isPrototypeOf");if(a.constructor&&!b&&!c)return!1;var d;for(d in a);return void 0===d||e.call(a,d)};a.exports=function a(){var b,c,e,f,i,j,k=arguments[0],l=1,m=arguments.length,n=!1;for("boolean"==typeof k?(n=k,k=arguments[1]||{},l=2):("object"!==(void 0===k?"undefined":d(k))&&"function"!=typeof k||null==k)&&(k={});l<m;++l)if(null!=(b=arguments[l]))for(c in b)e=k[c],f=b[c],k!==f&&(n&&f&&(h(f)||(i=g(f)))?(i?(i=!1,j=e&&g(e)?e:[]):j=e&&h(e)?e:{},k[c]=a(n,j,f)):void 0!==f&&(k[c]=f));return k}},function(a,b,c){function d(a,b,c,g){function h(b){return a(b=new Date(+b)),b}return h.floor=h,h.ceil=function(c){return a(c=new Date(c-1)),b(c,1),a(c),c},h.round=function(a){var b=h(a),c=h.ceil(a);return a-b<c-a?b:c},h.offset=function(a,c){return b(a=new Date(+a),null==c?1:Math.floor(c)),a},h.range=function(c,d,e){var f=[];if(c=h.ceil(c),e=null==e?1:Math.floor(e),!(c<d&&e>0))return f;do{f.push(new Date(+c))}while(b(c,e),a(c),c<d);return f},h.filter=function(c){return d(function(b){if(b>=b)for(;a(b),!c(b);)b.setTime(b-1)},function(a,d){if(a>=a)for(;--d>=0;)for(;b(a,1),!c(a););})},c&&(h.count=function(b,d){return e.setTime(+b),f.setTime(+d),a(e),a(f),Math.floor(c(e,f))},h.every=function(a){return a=Math.floor(a),isFinite(a)&&a>0?a>1?h.filter(g?function(b){return g(b)%a==0}:function(b){return h.count(0,b)%a==0}):h:null}),h}b.a=d;var e=new Date,f=new Date},function(a,b,c){function d(a,b,c,g){function h(b){return a(b=new Date(+b)),b}return h.floor=h,h.ceil=function(c){return a(c=new Date(c-1)),b(c,1),a(c),c},h.round=function(a){var b=h(a),c=h.ceil(a);return a-b<c-a?b:c},h.offset=function(a,c){return b(a=new Date(+a),null==c?1:Math.floor(c)),a},h.range=function(c,d,e){var f=[];if(c=h.ceil(c),e=null==e?1:Math.floor(e),!(c<d&&e>0))return f;do{f.push(new Date(+c))}while(b(c,e),a(c),c<d);return f},h.filter=function(c){return d(function(b){if(b>=b)for(;a(b),!c(b);)b.setTime(b-1)},function(a,d){if(a>=a)for(;--d>=0;)for(;b(a,1),!c(a););})},c&&(h.count=function(b,d){return e.setTime(+b),f.setTime(+d),a(e),a(f),Math.floor(c(e,f))},h.every=function(a){return a=Math.floor(a),isFinite(a)&&a>0?a>1?h.filter(g?function(b){return g(b)%a==0}:function(b){return h.count(0,b)%a==0}):h:null}),h}b.a=d;var e=new Date,f=new Date},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a){return new g(a)}b.a=e;var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=function(){function a(b){d(this,a),this.registry=b||{}}return f(a,[{key:"register",value:function(a,b){return this.add(a,b)}},{key:"add",value:function(a,b){if(!a||"string"!=typeof a)throw new Error("Invalid key");return!(a in this.registry)&&(this.registry[a]=b,!0)}},{key:"get",value:function(a){return this.registry[a]}},{key:"getKeys",value:function(){return Object.keys(this.registry)}},{key:"getValues",value:function(){var a=this;return Object.keys(this.registry).map(function(b){return a.registry[b]})}},{key:"has",value:function(a){return!!this.registry[a]}},{key:"remove",value:function(a){var b=this.registry[a];return delete this.registry[a],b}},{key:"build",value:function(a,b){var c={};for(var d in a)this.registry[d]&&(c[d]=this.registry[d](a[d],b));return c}}]),a}()},function(a,b,c){var d=c(58);c.d(b,"c",function(){return d.a});var e=c(12);c.d(b,"f",function(){return e.a});var f=c(59);c.d(b,"d",function(){return f.a});var g=(c(123),c(60),c(61),c(124),c(135),c(136),c(64),c(126),c(127),c(128),c(129),c(62),c(130),c(131),c(32));c.d(b,"e",function(){return g.a});var h=c(63);c.d(b,"g",function(){return h.a});var i=(c(132),c(133),c(134),c(65));c.d(b,"a",function(){return i.a}),c.d(b,"b",function(){return i.b});c(66),c(67),c(137)},function(a,b,c){c.d(b,"e",function(){return d}),c.d(b,"d",function(){return e}),c.d(b,"c",function(){return f}),c.d(b,"b",function(){return g}),c.d(b,"a",function(){return h});var d=1e3,e=6e4,f=36e5,g=864e5,h=6048e5},function(a,b,c){c.d(b,"e",function(){return d}),c.d(b,"d",function(){return e}),c.d(b,"c",function(){return f}),c.d(b,"b",function(){return g}),c.d(b,"a",function(){return h});var d=1e3,e=6e4,f=36e5,g=864e5,h=6048e5},function(a,b,c){function d(a,b,d){var e=c.i(o.b)(d,a),f=c.i(o.b)(b,a);return c.i(o.c)(c.i(o.d)(e,f),a)}function e(a,b,d){var e=c.i(o.e)(a,b,d);if(Math.abs(e)>p)return!1;var f=c.i(o.f)(a,b,d);return!(f<0)&&!(f>c.i(o.g)(a,b))}function f(a,b){return a[0].x!==a[2].x&&a[0].y!==a[2].y&&b.x>=a[0].x&&b.x<=a[2].x&&b.y>=a[0].y&&b.y<=a[2].y}function g(a,b){if(0===a.r)return!1;var d={x:a.cx,y:a.cy};return c.i(o.g)(b,d)<=Math.pow(a.r,2)}function h(a,b,d,e){var f=c.i(o.h)(b,a),g=c.i(o.i)(b,a),h=c.i(o.h)(e,d),i=c.i(o.i)(e,d),j=c.i(o.h)(a,d),k=c.i(o.i)(a,d),l=i*f-h*g,m=h*k-i*j,n=f*k-g*j,p=void 0,q=void 0;if(0===f&&0===g)return!1;if(0===h&&0===i)return!1;if(0===l){if(0===m&&0===n){if(0===f){if(0===g)return a.x===b.x&&a.y===b.y;p=c.i(o.i)(d,a)/g,q=c.i(o.i)(e,a)/g}else p=(d.x-a.x)/f,q=(e.x-a.x)/f;return!(p<0&&q<0||p>1&&q>1)}return!1}var r=m/l;return l=n/l,r>=0&&r<=1&&l>=0&&l<=1}function i(a,b,c,d,e,f,g){var h=f/2,i=g/2,j=Math.abs(a-d),k=Math.abs(b-e);return!(j>h+c||k>i+c)&&(j<=h||k<=i||Math.pow(j-h,2)+Math.pow(k-i,2)<=Math.pow(c,2))}function j(a,b){if(g(a,b[0])||g(a,b[1]))return!0;var f={x:a.cx,y:a.cy},h=d(b[0],b[1],f);return c.i(o.g)(h,f)<=Math.pow(a.r,2)&&e(b[0],b[1],h)&&a.r>0}function k(a,b){if(f(b,a[0])||f(b,a[1]))return!0;for(var c=b.length,d=0;d<c-1;d++){var e=b[d],g=b[d+1];if(h(a[0],a[1],e,g))return!0}return!1}function l(a){return[{x:a.x1||0,y:a.y1||0},{x:a.x2||0,y:a.y2||0}]}function m(a){return[{x:a.x,y:a.y},{x:a.x+a.width,y:a.y},{x:a.x+a.width,y:a.y+a.height},{x:a.x,y:a.y+a.height}]}function n(a){for(var b=a.length,c=NaN,d=NaN,e=NaN,f=NaN,g=0;g<b;g++)c=isNaN(c)?a[g].x:Math.min(c,a[g].x),d=isNaN(d)?a[g].x:Math.max(d,a[g].x),e=isNaN(e)?a[g].y:Math.min(e,a[g].y),f=isNaN(f)?a[g].y:Math.max(f,a[g].y);return[c,e,d,f]}var o=c(42);b.c=e,b.d=h,b.g=i,b.f=j,b.e=k,b.a=l,b.b=m,b.h=n;var p=1e-12},function(a,b,c){c.d(b,"a",function(){return e}),c.d(b,"b",function(){return f});var d=Array.prototype,e=d.map,f=d.slice},function(a,b,c){function d(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function e(a,b,c){var d=b.require,e=void 0===d?[]:d,f=c.settings,g=c.formatter,h=c.scale,i=c.data,j=c.renderer,k=c.composer,l=c.dockConfig;Object.defineProperty(a,"settings",{get:f}),Object.defineProperty(a,"data",{get:i}),Object.defineProperty(a,"formatter",{get:g}),Object.defineProperty(a,"scale",{get:h}),Object.keys(b).forEach(function(c){m(c)||("function"==typeof b[c]?a[c]=b[c].bind(a):a[c]=b[c])}),e.forEach(function(b){"renderer"===b?Object.defineProperty(a,"renderer",{get:j}):"composer"===b?(a.composer=k,Object.defineProperty(a,"composer",{get:k})):"dockConfig"===b&&Object.defineProperty(a,"dockConfig",{get:l})})}function f(a,b){return a.displayOrder=b.displayOrder,a.dock=b.dock,a.prioOrder=b.prioOrder,a.minimumLayoutMode=b.minimumLayoutMode,a}function g(a){var b=a.defaultSettings,g=void 0===b?{}:b;return function(){function b(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return function(){for(var d="function"==typeof a[b],e="function"==typeof h[b],f=arguments.length,g=Array(f),i=0;i<f;i++)g[i]=arguments[i];if(!d&&!e)return c.call.apply(c,[u].concat(g));var j=void 0;if(d){var k;j=(k=a[b]).call.apply(k,[u].concat(g))}if("function"==typeof h[b]){var l;j=(l=h[b]).call.apply(l,[v].concat(g))}return j}}var h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},m=arguments[1],n=arguments[2],o=i()(!0,{},g,h),p=[],q=[],r=void 0,s=void 0,t=[],u={},v={},w=b("preferredSize",function(){return 0}),x=b("resize",function(a){return a.inner}),y=b("created"),z=b("beforeMount"),A=b("mounted"),B=b("beforeUpdate"),C=b("updated"),D=b("beforeRender"),E=b("beforeDestroy"),F=b("destroyed"),G=a.render,H=void 0,I=void 0,J={nodes:[],composer:m,config:h.brush||{},renderer:null},K={tap:[],over:[]};Object.defineProperty(J,"data",{get:function(){return p}});var L=a.renderer?c.i(j.a)(a.renderer):m.renderer||c.i(j.a)();J.renderer=L;var M={requiredSize:function(a,b){return w({inner:a,outer:b,dock:M.dock})}};f(M,o);var N=function(){};N.dockConfig=M,N.set=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a.settings&&(o=i()(!0,{},g,a.settings),f(M,o)),"string"==typeof o.scale&&(r=m.scale(o.scale)),p=o.data?m.dataset().map(o.data.mapTo,o.data.groupBy):r?r.data():[],"string"==typeof o.formatter?s=m.formatter(o.formatter):"object"===l(o.formatter)?s=m.formatter(o.formatter):"string"==typeof o.scale&&(s=m.formatter({source:r.sources[0]}))},N.resize=function(a,b){var c=x({inner:a,outer:b});c?(L.size(c),I=c):(L.size(a),I=a)};var O=function(){var a=L.renderArgs?L.renderArgs.slice(0):[];return a.push({data:p}),a};return N.beforeMount=z,N.beforeRender=function(){D({size:I})},N.render=function(){var a=J.nodes=G.call.apply(G,[u].concat(d(O())));L.render(a)},N.hide=function(){N.unmount(),L.size({x:0,y:0,width:0,height:0}),L.clear()},N.beforeUpdate=function(){B({settings:o,data:p})},N.update=function(){var a=J.nodes=G.call.apply(G,[u].concat(d(O())));t.forEach(function(a){a.isActive()&&a.update()}),L.render(a)},N.updated=C,N.destroy=function(){N.unmount(),E(H),L.destroy(),F(),H=null},e(u,a,{settings:function(){return o},data:function(){return p},scale:function(){return r},formatter:function(){return s},renderer:function(){return L},composer:function(){return m},dockConfig:function(){return M}}),e(v,h,{settings:function(){return o},data:function(){return p},scale:function(){return r},formatter:function(){return s},renderer:function(){return L},composer:function(){return m},dockConfig:function(){return M}}),N.getBrushedShapes=function(a,b,c){var d=[];if(h.brush&&h.brush.trigger){var e=m.brush(a),f=L.findShapes("*");h.brush.trigger.forEach(function(a){f.forEach(function(f){var g=p[f.data];g&&e.containsMappedData(g,c||a.data,b)&&d.push(f)})})}return d},N.findShapes=function(a){return L.findShapes(a)},N.mount=function(){H=L.element&&L.element()?H:L.appendTo(n),h.brush&&((h.brush.consume||[]).forEach(function(a){a.context&&a.style&&t.push(c.i(k.a)(J,a))}),(h.brush.trigger||[]).forEach(function(a){"over"===a.on?K.over.push(a):K.tap.push(a)})),Object.keys(a.on||{}).forEach(function(b){var c=function(c){a.on[b].call(u,c)};H.addEventListener(b,c),q.push({key:b,listener:c})}),Object.keys(h.on||{}).forEach(function(a){var b=function(b){h.on[a].call(v,b)};H.addEventListener(a,b),q.push({key:a,listener:b})})},N.mounted=function(){return A(H)},N.unmount=function(){H&&(q.forEach(function(a){var b=a.key,c=a.listener;return H.removeEventListener(b,c)}),q=[]),K.tap=[],K.over=[],t.forEach(function(a){a.cleanUp()})},N.onBrushTap=function(a){K.tap.forEach(function(b){c.i(k.b)({e:a,t:b,config:J})&&"stop"===b.globalPropagation&&(m.stopBrushing=!0)})},N.onBrushOver=function(a){K.over.forEach(function(b){c.i(k.c)({e:a,t:b,config:J})&&"stop"===b.globalPropagation&&(m.stopBrushing=!0)})},N.set({settings:h}),y(),N}}var h=c(0),i=c.n(h),j=c(85),k=c(213);b.a=g;var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},m=function(a){return["on","preferredSize","created","beforeMount","mounted","resize","beforeUpdate","updated","beforeRender","render","beforeDestroy","destroyed","defaultSettings","data","settings","formatter","scale","composer","dockConfig"].some(function(b){return b===a})}},function(a,b,c){var d=c(31);c.d(b,"b",function(){return d.a});var e=(c(50),c(30),c(51),c(53),c(21));c.d(b,"a",function(){return e.a});var f=(c(54),c(117));c.d(b,"c",function(){return f.a});var g=(c(56),c(119),c(121),c(55));c.d(b,"e",function(){return g.a});var h=(c(114),c(115),c(113),c(112));c.d(b,"d",function(){return h.a});c(116)},function(a,b,c){var d=c(28);c.d(b,"f",function(){return d.h}),c.d(b,"e",function(){return d.g}),c.d(b,"d",function(){return d.f});var e=c(111);c.d(b,"c",function(){return e.b}),c.d(b,"b",function(){return e.a});var f=c(110);c.d(b,"a",function(){return f.a})},function(a,b,c){b.a=function(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var g=c(89),h=c(237),i=c(84),j=c(91),k=c(255),l=c(256),m=c(244),n=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),o=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)},p=function(a){function b(a){d(this,b);var c=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c._stage=null,c._collider=null,c._attrs={},c._node=null,c}return f(b,a),n(b,[{key:"set",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.node=a;var b=a.fill,c=a.stroke,d=a.strokeWidth,e=a.fontFamily,f=a.fontSize,g=a.baseline,h=a.anchor,i=a.maxWidth,j=a.opacity,k=a.transform,l=a.data,m=this.attrs;void 0!==b&&(m.fill=b),void 0!==c&&(m.stroke=c),void 0!==j&&(m.opacity=j),void 0!==d&&(m["stroke-width"]=d),void 0!==e&&(m["font-family"]=e),void 0!==f&&(m["font-size"]=f),void 0!==g&&(m["dominant-baseline"]=g),void 0!==h&&(m["text-anchor"]=h),void 0!==i&&(m.maxWidth=i),void 0!==k&&(m.transform=k),void 0!==l&&(this.data=l)}},{key:"collider",value:function(a){if(void 0===a)return this._collider;var b=a.type,d=void 0===b?null:b,e={type:d};if(d){if("frontChild"===d)this._collider=e;else if("bounds"===d){var f=a.x,g=a.y,i=a.width,j=a.height,k=a.minWidth,l=a.minHeight;e.fn=c.i(h.a)("rect",f,g,i,j,k,l),this._collider=e}else if("circle"===d){var m=a.cx,n=a.cy,o=a.r,p=a.minRadius;e.fn=c.i(h.a)(d,m,n,o,p),this._collider=e}else if("rect"===d){var q=a.x,r=a.y,s=a.width,t=a.height,u=a.minWidth,v=a.minHeight;e.fn=c.i(h.a)(d,q,r,s,t,u,v),this._collider=e}else if("line"===d){var w=a.x1,x=a.y1,y=a.x2,z=a.y2,A=a.tolerance;e.fn=c.i(h.a)(d,w,x,y,z,A),this._collider=e}}else this._collider=null;return this._collider}},{key:"findShapes",value:function(a){return k.a.find(a,this).map(function(a){return c.i(l.a)(a)})}},{key:"getItemsFrom",value:function(a){return c.i(m.a)(this,a)}},{key:"containsPoint",value:function(a){return c.i(m.b)(this,a)}},{key:"intersectsLine",value:function(a){return c.i(m.b)(this,a)}},{key:"intersectsRect",value:function(a){return c.i(m.b)(this,a)}},{key:"intersectsCircle",value:function(a){return c.i(m.b)(this,a)}},{key:"resolveLocalTransform",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new i.a;void 0!==this.attrs.transform&&c.i(j.a)(this.attrs.transform,a),this.modelViewMatrix=a.clone()}},{key:"resolveGlobalTransform",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new i.a,b=this.ancestors;if(b.length>0)for(var c=b.length-1;c>=0;c--)b[c].resolveLocalTransform(a),a=b[c].modelViewMatrix;this.resolveLocalTransform(a)}},{key:"attr",value:function(a){return this.attrs[a]}},{key:"equals",value:function(a){var c=this.attrs,d=Object.keys(c),e=a.attrs,f=Object.keys(e);if(d.length!==f.length)return!1;for(var g=0;g<d.length;g++){var h=d[g];if(!Object.hasOwnProperty.call(e,h))return!1;if(c[h]!==e[h])return!1}return o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"equals",this).call(this,a)}},{key:"toJSON",value:function(){var a=o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"toJSON",this).call(this);return a.attrs=this.attrs,a}},{key:"attrs",get:function(){return this._attrs}},{key:"stage",get:function(){return this._parent&&!this._stage?this._stage=this._parent.stage:this._parent||this._stage===this||(this._stage=null),this._stage}},{key:"modelViewMatrix",set:function(a){this._mvm=a,this._imvm=null},get:function(){return this._mvm}},{key:"inverseModelViewMatrix",get:function(){return this._imvm=this._imvm?this._imvm:this._mvm.clone().invert(),this._imvm}},{key:"node",set:function(a){this._node=a},get:function(){return this._node}}]),b}(g.a);b.a=p},function(a,b,c){function d(a,b){return function(c){return a+c*b}}function e(a,b,c){return a=Math.pow(a,c),b=Math.pow(b,c)-a,c=1/c,function(d){return Math.pow(a+d*b,c)}}function f(a,b){var e=b-a;return e?d(a,e>180||e<-180?e-360*Math.round(e/360):e):c.i(i.a)(isNaN(a)?b:a)}function g(a){return 1==(a=+a)?h:function(b,d){return d-b?e(b,d,a):c.i(i.a)(isNaN(b)?d:b)}}function h(a,b){var e=b-a;return e?d(a,e):c.i(i.a)(isNaN(a)?b:a)}var i=c(52);b.b=f,b.c=g,b.a=h},function(a,b,c){b.a=function(a){return null===a?NaN:+a}},function(a,b,c){b.a=function(a){return a.match(/.{6}/g).map(function(a){return"#"+a})}},function(a,b,c){function d(a){var b=a.domain;return a.ticks=function(a){var d=b()
;return c.i(f.a)(d[0],d[d.length-1],null==a?10:a)},a.tickFormat=function(a,d){return c.i(i.a)(b(),a,d)},a.nice=function(d){var e=b(),g=e.length-1,h=null==d?10:d,i=e[0],j=e[g],k=c.i(f.b)(i,j,h);return k&&(k=c.i(f.b)(Math.floor(i/k)*k,Math.ceil(j/k)*k,h),e[0]=Math.floor(i/k)*k,e[g]=Math.ceil(j/k)*k,b(e)),a},a}function e(){var a=c.i(h.a)(h.b,g.a);return a.copy=function(){return c.i(h.c)(a,e())},d(a)}var f=c(4),g=c(10),h=c(23),i=c(174);b.a=d,b.b=e},function(a,b,c){function d(a){return"number"!=typeof a||isNaN(a)}b.a=d},function(a,b,c){function d(a){var b=a.text,c=a.fontSize,d=a.fontFamily,e=h[b+c+d];if(void 0!==e)return e;i=i||document.createElement("canvas");var f=i.getContext("2d");f.font=c+" "+d;var g=f.measureText(b).width;return h[b+c+d]=g,g}function e(a){var b=a.fontSize,c=a.fontFamily,e=g[b+c];if(void 0!==e)return e;var f=1.2*d({text:"M",fontSize:b,fontFamily:c});return g[b+c]=f,f}function f(a){var b=a.text,c=a.fontSize,f=a.fontFamily;return{width:d({text:b,fontSize:c,fontFamily:f}),height:e({fontSize:c,fontFamily:f})}}b.a=f;var g={},h={},i=void 0},function(a,b,c){var d=c(27);b.a=function(a){return a=c.i(d.a)(Math.abs(a)),a?a[1]:NaN}},function(a,b,c){b.a=function(a,b){return a=+a,b-=a,function(c){return a+b*c}}},function(a,b,c){var d=c(160);c.d(b,"c",function(){return d.a});var e=(c(166),c(17));c.d(b,"d",function(){return e.b});var f=(c(167),c(73),c(168),c(169),c(170),c(173));c.d(b,"a",function(){return f.a});var g=(c(74),c(175),c(161),c(163),c(164),c(162),c(165),c(171),c(176));c.d(b,"b",function(){return g.a});c(172)},function(a,b,c){function d(a,b){return(b-=a=+a)?function(c){return(c-a)/b}:c.i(n.a)(b)}function e(a){return function(b,c){var d=a(b=+b,c=+c);return function(a){return a<=b?0:a>=c?1:d(a)}}}function f(a){return function(b,c){var d=a(b=+b,c=+c);return function(a){return a<=0?b:a>=1?c:d(a)}}}function g(a,b,c,d){var e=a[0],f=a[1],g=b[0],h=b[1];return f<e?(e=c(f,e),g=d(h,g)):(e=c(e,f),g=d(g,h)),function(a){return g(e(a))}}function h(a,b,d,e){var f=Math.min(a.length,b.length)-1,g=new Array(f),h=new Array(f),i=-1;for(a[f]<a[0]&&(a=a.slice().reverse(),b=b.slice().reverse());++i<f;)g[i]=d(a[i],a[i+1]),h[i]=e(b[i],b[i+1]);return function(b){var d=c.i(k.c)(a,b,1,f)-1;return h[d](g[d](b))}}function i(a,b){return b.domain(a.domain()).range(a.range()).interpolate(a.interpolate()).clamp(a.clamp())}function j(a,b){function c(){return j=Math.min(q.length,r.length)>2?h:g,k=n=null,i}function i(b){return(k||(k=j(q,r,t?e(a):a,s)))(+b)}var j,k,n,q=p,r=p,s=l.b,t=!1;return i.invert=function(a){return(n||(n=j(r,q,d,t?f(b):b)))(+a)},i.domain=function(a){return arguments.length?(q=m.a.call(a,o.a),c()):q.slice()},i.range=function(a){return arguments.length?(r=m.b.call(a),c()):r.slice()},i.rangeRound=function(a){return r=m.b.call(a),s=l.c,c()},i.clamp=function(a){return arguments.length?(t=!!a,c()):t},i.interpolate=function(a){return arguments.length?(s=a,c()):s},c()}var k=c(4),l=c(10),m=c(8),n=c(36),o=c(72);b.b=d,b.c=i,b.a=j;var p=[0,1]},function(a,b,c){function d(a,b){for(var c=a.replace(/^\//,"").split(/\//),e=void 0,f=b,g=0;g<c.length;g++){if(!c[g]&&Array.isArray(f)){var h=new Array(f.length);e=c.slice(g+1).join("/");for(var i=0;i<f.length;i++)h[i]=d(e,f[i]);return h}c[g]in f&&(f=f[c[g]])}return f}b.a=d},function(a,b,c){function d(a,b){for(var c=a,d=0;d<b.length;d++){if(!c[b[d]])return;c=c[b[d]]}return c}function e(a,b){return null===b&&a?a:b}function f(a,b,c,d){for(var f=arguments.length,g=Array(f>4?f-4:0),h=4;h<f;h++)g[h-4]=arguments[h];var i=c?c.call.apply(c,[d].concat(g)):null;return void 0!==i?e(a,i):b&&"function"==typeof b.fn?b.fn.apply(b,[d].concat(g)):b}function g(a,b,c,d){var h=a[d],i=m[b];if(!h)return c;var j=l(h[b]);if("undefined"===j)return d<a.length-1?g(a,b,c,d+1):c;if(l(h[b])===(void 0===c?"undefined":l(c))||null===h[b])return e(i,h[b]);if("function"===j){var k=g(a,b,c,d+1);return h[b].fn=function(){for(var a=arguments.length,c=Array(a),d=0;d<a;d++)c[d]=arguments[d];return f.apply(void 0,[i,k,h[b]].concat(c))},h[b]}return"object"===j?h[b]:c}function h(a,b,c,e){for(var f=b.length,h=[];f>=0;)h.push(d(a,b)),b.pop(),f--;return g(h,c,e,0)}function i(a,b,c){var d=c?c.split("."):[],e={};return Object.keys(a).forEach(function(c){var f=null===a[c]&&void 0!==m[c]?m[c]:a[c];e[c]=h(b,d.concat(),c,f)}),e}function j(a,b,c){var d={};return b?Object.keys(a).forEach(function(e){d[e]=a[e]&&"function"==typeof a[e].fn?a[e].fn(void 0,b[e][c],c,b[e]):a[e]}):Object.keys(a).forEach(function(b){d[b]=a[b]&&"function"==typeof a[b].fn?a[b].fn():a[b]}),d}function k(a,b,c){var d={};return Object.keys(a).forEach(function(e){var f=void 0!==a[e],g=f&&"function"==typeof a[e].scale,h=f&&!!a[e].ref,i=e in b,j=f&&a[e].ref?b[a[e].ref]:b[e];if("function"==typeof a[e]){var k={data:b};g&&(k.scale=a[e].scale),"function"==typeof a[e].fn?d[e]=a[e].fn(k,h?b[a[e].ref]:void 0,c):d[e]=a[e].call(k,h?b[a[e].ref]:void 0,c)}else g&&(i||h)?(d[e]=a[e].scale(j),a[e].scale.bandWidth&&(d[e]+=a[e].scale.bandWidth()/2)):d[e]=h?j.value:a[e]}),d}b.b=i,b.c=j,b.a=k;var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},m={fontFamily:"Arial",fontSize:"13px",color:"#595959",fill:"#333333",backgroundColor:"#ffffff",stroke:"#000000",strokeWidth:0}},function(a,b,c){var d=c(103);c.d(b,"g",function(){return d.a}),c.d(b,"d",function(){return d.b});var e=c(48);c.d(b,"a",function(){return e.a});var f=c(46);c.d(b,"b",function(){return f.a});var g=c(107);c.d(b,"f",function(){return g.a});var h=c(108);c.d(b,"c",function(){return h.a});var i=c(109);c.d(b,"e",function(){return i.a})},function(a,b,c){b.a=function(a,b){if((c=(a=b?a.toExponential(b-1):a.toExponential()).indexOf("e"))<0)return null;var c,d=a.slice(0,c);return[d.length>1?d[0]+d.slice(2):d,+a.slice(c+1)]}},function(a,b,c){function d(){}function e(a){var b;return a=(a+"").trim().toLowerCase(),(b=v.exec(a))?(b=parseInt(b[1],16),new j(b>>8&15|b>>4&240,b>>4&15|240&b,(15&b)<<4|15&b,1)):(b=w.exec(a))?f(parseInt(b[1],16)):(b=x.exec(a))?new j(b[1],b[2],b[3],1):(b=y.exec(a))?new j(255*b[1]/100,255*b[2]/100,255*b[3]/100,1):(b=z.exec(a))?g(b[1],b[2],b[3],b[4]):(b=A.exec(a))?g(255*b[1]/100,255*b[2]/100,255*b[3]/100,b[4]):(b=B.exec(a))?k(b[1],b[2]/100,b[3]/100,1):(b=C.exec(a))?k(b[1],b[2]/100,b[3]/100,b[4]):D.hasOwnProperty(a)?f(D[a]):"transparent"===a?new j(NaN,NaN,NaN,0):null}function f(a){return new j(a>>16&255,a>>8&255,255&a,1)}function g(a,b,c,d){return d<=0&&(a=b=c=NaN),new j(a,b,c,d)}function h(a){return a instanceof d||(a=e(a)),a?(a=a.rgb(),new j(a.r,a.g,a.b,a.opacity)):new j}function i(a,b,c,d){return 1===arguments.length?h(a):new j(a,b,c,null==d?1:d)}function j(a,b,c,d){this.r=+a,this.g=+b,this.b=+c,this.opacity=+d}function k(a,b,c,d){return d<=0?a=b=c=NaN:c<=0||c>=1?a=b=NaN:b<=0&&(a=NaN),new n(a,b,c,d)}function l(a){if(a instanceof n)return new n(a.h,a.s,a.l,a.opacity);if(a instanceof d||(a=e(a)),!a)return new n;if(a instanceof n)return a;a=a.rgb();var b=a.r/255,c=a.g/255,f=a.b/255,g=Math.min(b,c,f),h=Math.max(b,c,f),i=NaN,j=h-g,k=(h+g)/2;return j?(i=b===h?(c-f)/j+6*(c<f):c===h?(f-b)/j+2:(b-c)/j+4,j/=k<.5?h+g:2-h-g,i*=60):j=k>0&&k<1?0:i,new n(i,j,k,a.opacity)}function m(a,b,c,d){return 1===arguments.length?l(a):new n(a,b,c,null==d?1:d)}function n(a,b,c,d){this.h=+a,this.s=+b,this.l=+c,this.opacity=+d}function o(a,b,c){return 255*(a<60?b+(c-b)*a/60:a<180?c:a<240?b+(c-b)*(240-a)/60:b)}var p=c(29);b.c=d,c.d(b,"e",function(){return q}),c.d(b,"d",function(){return r}),b.h=e,b.b=h,b.g=i,b.a=j,b.f=m;var q=.7,r=1/q,s="\\s*([+-]?\\d+)\\s*",t="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",u="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",v=/^#([0-9a-f]{3})$/,w=/^#([0-9a-f]{6})$/,x=new RegExp("^rgb\\("+[s,s,s]+"\\)$"),y=new RegExp("^rgb\\("+[u,u,u]+"\\)$"),z=new RegExp("^rgba\\("+[s,s,s,t]+"\\)$"),A=new RegExp("^rgba\\("+[u,u,u,t]+"\\)$"),B=new RegExp("^hsl\\("+[t,u,u]+"\\)$"),C=new RegExp("^hsla\\("+[t,u,u,t]+"\\)$"),D={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};c.i(p.a)(d,e,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),c.i(p.a)(j,i,c.i(p.b)(d,{brighter:function(a){return a=null==a?r:Math.pow(r,a),new j(this.r*a,this.g*a,this.b*a,this.opacity)},darker:function(a){return a=null==a?q:Math.pow(q,a),new j(this.r*a,this.g*a,this.b*a,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var a=this.opacity;return a=isNaN(a)?1:Math.max(0,Math.min(1,a)),(1===a?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===a?")":", "+a+")")}})),c.i(p.a)(n,m,c.i(p.b)(d,{brighter:function(a){return a=null==a?r:Math.pow(r,a),new n(this.h,this.s,this.l*a,this.opacity)},darker:function(a){return a=null==a?q:Math.pow(q,a),new n(this.h,this.s,this.l*a,this.opacity)},rgb:function(){var a=this.h%360+360*(this.h<0),b=isNaN(a)||isNaN(this.s)?0:this.s,c=this.l,d=c+(c<.5?c:1-c)*b,e=2*c-d;return new j(o(a>=240?a-240:a+120,e,d),o(a,e,d),o(a<120?a+240:a-120,e,d),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}))},function(a,b,c){function d(a,b){var c=Object.create(a.prototype);for(var d in b)c[d]=b[d];return c}b.b=d,b.a=function(a,b,c){a.prototype=b.prototype=c,c.constructor=a}},function(a,b,c){function d(a,b,c,d,e){var f=a*a,g=f*a;return((1-3*a+3*f-g)*b+(4-6*f+3*g)*c+(1+3*a+3*f-3*g)*d+g*e)/6}b.b=d,b.a=function(a){var b=a.length-1;return function(c){var e=c<=0?c=0:c>=1?(c=1,b-1):Math.floor(c*b),f=a[e],g=a[e+1],h=e>0?a[e-1]:2*f-g,i=e<b-1?a[e+2]:2*g-f;return d((c-e/b)*b,h,f,g,i)}}},function(a,b,c){var d=c(11),e=c(55),f=c(50),g=c(53),h=c(21),i=c(54),j=c(56),k=c(52),l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};b.a=function(a,b){var m,n=void 0===b?"undefined":l(b);return null==b||"boolean"===n?c.i(k.a)(b):("number"===n?h.a:"string"===n?(m=c.i(d.f)(b))?(b=m,e.a):j.a:b instanceof d.f?e.a:b instanceof Date?g.a:Array.isArray(b)?f.a:isNaN(b)?i.a:h.a)(a,b)}},function(a,b,c){var d=c(15);b.a=function(a,b,c){if(null==c&&(c=d.a),e=a.length){if((b=+b)<=0||e<2)return+c(a[0],0,a);if(b>=1)return+c(a[e-1],e-1,a);var e,f=(e-1)*b,g=Math.floor(f),h=+c(a[g],g,a);return h+(+c(a[g+1],g+1,a)-h)*(f-g)}}},function(a,b,c){function d(){}function e(a,b){var c=new d;if(a instanceof d)a.each(function(a,b){c.set(b,a)});else if(Array.isArray(a)){var e,f=-1,g=a.length;if(null==b)for(;++f<g;)c.set(f,a[f]);else for(;++f<g;)c.set(b(e=a[f],f,a),e)}else if(a)for(var h in a)c.set(h,a[h]);return c}c.d(b,"b",function(){return f});var f="$";d.prototype=e.prototype={constructor:d,has:function(a){return f+a in this},get:function(a){return this[f+a]},set:function(a,b){return this[f+a]=b,this},remove:function(a){var b=f+a;return b in this&&delete this[b]},clear:function(){for(var a in this)a[0]===f&&delete this[a]},keys:function(){var a=[];for(var b in this)b[0]===f&&a.push(b.slice(1));return a},values:function(){var a=[];for(var b in this)b[0]===f&&a.push(this[b]);return a},entries:function(){var a=[];for(var b in this)b[0]===f&&a.push({key:b.slice(1),value:this[b]});return a},size:function(){var a=0;for(var b in this)b[0]===f&&++a;return a},empty:function(){for(var a in this)if(a[0]===f)return!1;return!0},each:function(a){for(var b in this)b[0]===f&&a(this[b],b.slice(1),this)}},b.a=e},function(a,b,c){function d(){}function e(a){var b;return a=(a+"").trim().toLowerCase(),(b=v.exec(a))?(b=parseInt(b[1],16),new j(b>>8&15|b>>4&240,b>>4&15|240&b,(15&b)<<4|15&b,1)):(b=w.exec(a))?f(parseInt(b[1],16)):(b=x.exec(a))?new j(b[1],b[2],b[3],1):(b=y.exec(a))?new j(255*b[1]/100,255*b[2]/100,255*b[3]/100,1):(b=z.exec(a))?g(b[1],b[2],b[3],b[4]):(b=A.exec(a))?g(255*b[1]/100,255*b[2]/100,255*b[3]/100,b[4]):(b=B.exec(a))?k(b[1],b[2]/100,b[3]/100,1):(b=C.exec(a))?k(b[1],b[2]/100,b[3]/100,b[4]):D.hasOwnProperty(a)?f(D[a]):"transparent"===a?new j(NaN,NaN,NaN,0):null}function f(a){return new j(a>>16&255,a>>8&255,255&a,1)}function g(a,b,c,d){return d<=0&&(a=b=c=NaN),new j(a,b,c,d)}function h(a){return a instanceof d||(a=e(a)),a?(a=a.rgb(),new j(a.r,a.g,a.b,a.opacity)):new j}function i(a,b,c,d){return 1===arguments.length?h(a):new j(a,b,c,null==d?1:d)}function j(a,b,c,d){this.r=+a,this.g=+b,this.b=+c,this.opacity=+d}function k(a,b,c,d){return d<=0?a=b=c=NaN:c<=0||c>=1?a=b=NaN:b<=0&&(a=NaN),new n(a,b,c,d)}function l(a){if(a instanceof n)return new n(a.h,a.s,a.l,a.opacity);if(a instanceof d||(a=e(a)),!a)return new n;if(a instanceof n)return a;a=a.rgb();var b=a.r/255,c=a.g/255,f=a.b/255,g=Math.min(b,c,f),h=Math.max(b,c,f),i=NaN,j=h-g,k=(h+g)/2;return j?(i=b===h?(c-f)/j+6*(c<f):c===h?(f-b)/j+2:(b-c)/j+4,j/=k<.5?h+g:2-h-g,i*=60):j=k>0&&k<1?0:i,new n(i,j,k,a.opacity)}function m(a,b,c,d){return 1===arguments.length?l(a):new n(a,b,c,null==d?1:d)}function n(a,b,c,d){this.h=+a,this.s=+b,this.l=+c,this.opacity=+d}function o(a,b,c){return 255*(a<60?b+(c-b)*a/60:a<180?c:a<240?b+(c-b)*(240-a)/60:b)}var p=c(35);b.c=d,c.d(b,"e",function(){return q}),c.d(b,"d",function(){return r}),b.b=h,b.a=j;var q=.7,r=1/q,s="\\s*([+-]?\\d+)\\s*",t="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",u="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",v=/^#([0-9a-f]{3})$/,w=/^#([0-9a-f]{6})$/,x=new RegExp("^rgb\\("+[s,s,s]+"\\)$"),y=new RegExp("^rgb\\("+[u,u,u]+"\\)$"),z=new RegExp("^rgba\\("+[s,s,s,t]+"\\)$"),A=new RegExp("^rgba\\("+[u,u,u,t]+"\\)$"),B=new RegExp("^hsl\\("+[t,u,u]+"\\)$"),C=new RegExp("^hsla\\("+[t,u,u,t]+"\\)$"),D={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};c.i(p.a)(d,e,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),c.i(p.a)(j,i,c.i(p.b)(d,{brighter:function(a){return a=null==a?r:Math.pow(r,a),new j(this.r*a,this.g*a,this.b*a,this.opacity)},darker:function(a){return a=null==a?q:Math.pow(q,a),new j(this.r*a,this.g*a,this.b*a,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var a=this.opacity;return a=isNaN(a)?1:Math.max(0,Math.min(1,a)),(1===a?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===a?")":", "+a+")")}})),c.i(p.a)(n,m,c.i(p.b)(d,{brighter:function(a){return a=null==a?r:Math.pow(r,a),new n(this.h,this.s,this.l*a,this.opacity)},darker:function(a){return a=null==a?q:Math.pow(q,a),new n(this.h,this.s,this.l*a,this.opacity)},rgb:function(){var a=this.h%360+360*(this.h<0),b=isNaN(a)||isNaN(this.s)?0:this.s,c=this.l,d=c+(c<.5?c:1-c)*b,e=2*c-d;return new j(o(a>=240?a-240:a+120,e,d),o(a,e,d),o(a<120?a+240:a-120,e,d),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}))},function(a,b,c){function d(a,b){var c=Object.create(a.prototype);for(var d in b)c[d]=b[d];return c}b.b=d,b.a=function(a,b,c){a.prototype=b.prototype=c,c.constructor=a}},function(a,b,c){b.a=function(a){return function(){return a}}},function(a,b,c){var d=c(38);c.d(b,"c",function(){return d.c}),c.d(b,"b",function(){return d.b});var e=c(76);c.d(b,"a",function(){return e.a});c(75),c(192)},function(a,b,c){var d=c(76);c.d(b,"c",function(){return f}),c.d(b,"b",function(){return h}),c.d(b,"a",function(){return i});var e,f,g,h,i;!function(a){e=c.i(d.a)(a),f=e.format,g=e.parse,h=e.utcFormat,i=e.utcParse,e}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]})},function(a,b,c){function d(a,b,d,e){var f=h()(!0,{},a),g=e?f[e]:f,j=e?b[e]:b;return g&&Object.keys(g).forEach(function(a){if(g[a])if(!g[a].source&&!g[a].scale||g[a].fn)g[a].fn&&(g[a]=g[a].fn);else{var b=d.scale(g[a]);b&&(g[a]=b)}}),c.i(i.b)(j,f,e)}function e(a){var b=void 0===a?"undefined":j(a);return"object"!==b&&"function"!==b&&"undefined"!==b}function f(a,b,d){var f=h()(!0,{},a),g=f,j=b;return g&&Object.keys(f).forEach(function(a){if(a in g&&!e(g[a])){var b=g[a];if(g[a]={},"function"==typeof b?g[a]=b:b.fn&&(g[a]=b.fn),b.scale){var c=d.scale(b.scale);c&&(g[a].scale=c)}b.ref&&(g[a].ref=b.ref)}}),c.i(i.b)(j,g)}var g=c(0),h=c.n(g),i=c(25);b.b=d,b.a=f;var j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}},function(a,b,c){function d(a){return a.type in h.registry?h.registry[a.type]()(a.data):a.data?c.i(g.a)()(a.data):null}function e(a,b){return h.add(a,b)}var f=c(3),g=c(81);b.b=d,b.a=e;var h=c.i(f.a)()},function(a,b,c){function d(a,b){h.add(a,b)}function e(a){if(!h.has(a))throw new Error("Formatter of type "+a+" does not exist");return h.get(a)()}var f=c(3),g=c(233);b.a=d,b.b=e;var h=c.i(f.a)();d("d3",g.a)},function(a,b,c){function d(a,b){return{x:a.x+b.x,y:a.y+b.y}}function e(a,b){return{x:a.x-b.x,y:a.y-b.y}}function f(a,b){return{x:a.x*b,y:a.y*b}}function g(a,b){return a.x-b.x}function h(a,b){return a.y-b.y}function i(a,b){return Math.pow(g(a,b),2)+Math.pow(h(a,b),2)}function j(a,b){return a.x*b.x+a.y*b.y}function k(a,b,c){return(c.x-a.x)*(b.x-a.x)+(c.y-a.y)*(b.y-a.y)}function l(a,b,c){return(c.y-a.y)*(b.x-a.x)-(c.x-a.x)*(b.y-a.y)}function m(a,b){var c=j(a,b)/j(b,b)||1;return{x:b.x*c,y:b.y*c}}b.c=d,b.b=e,b.a=f,b.h=g,b.i=h,b.g=i,b.f=k,b.e=l,b.d=m},function(a,b,c){function d(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function e(a,b,c){return"function"==typeof a[c]?a[c](b):a[c]}function f(a,b){var c={};return p.forEach(function(d){c[d]=e(a,b,d)}),c}function g(a,b){var c=+a.min,e=+a.max,f=0,g=1;if(b&&b[0]){var h=b.map(function(a){return a.min()}).filter(function(a){return!isNaN(a)}),i=b.map(function(a){return a.max()}).filter(function(a){return!isNaN(a)});if(f=h.length?Math.min.apply(Math,d(h)):Number.NaN,g=i.length?Math.max.apply(Math,d(i)):Number.NaN,isNaN(f)||isNaN(g))f=-1,g=1;else if(f===g&&0===f)f=-1,g=1;else if(f===g&&f)f-=Math.abs(.1*f),g+=Math.abs(.1*g);else if(!isNaN(a.expand)){var j=g-f;f-=j*a.expand,g+=j*a.expand}if(Array.isArray(a.include)){var k=a.include.filter(function(a){return!isNaN(a)});f=Math.min.apply(Math,d(k).concat([f])),g=Math.max.apply(Math,d(k).concat([g]))}}return{mini:isNaN(c)?f:c,maxi:isNaN(e)?g:e}}function h(a,b){function d(a){return c.i(l.a)(a.value)?NaN:e(a.value)}var e=c.i(i.d)(),j=void 0;if(d.data=function(){return[]},d.invert=function(a){return e.invert(a)},d.rangeRound=function(a){return e.rangeRound(a),d},d.clamp=function(){var a=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e.clamp(a),d},d.cachedTicks=function(){return j},d.clearTicksCache=function(){return j=void 0,this},d.ticks=function(b){return null!==b&&"object"===(void 0===b?"undefined":o(b))?(b.settings=b.settings||{},b.settings=k()(!0,c.i(n.a)(),a,b.settings),b.scale=d,j=c.i(m.b)(b)):j=e.ticks(b)},d.nice=function(a){return e.nice(a),d},d.tickFormat=function(a,b){return e.tickFormat(a,b)},d.interpolate=function(a){return e.interpolate(a),d},d.domain=function(a){return arguments.length?(e.domain(a),d):e.domain()},d.range=function(a){return arguments.length?(e.range(a),d):e.range()},d.get=function(a){return c.i(l.a)(a)?NaN:e(a)},d.start=function(){return d.domain()[0]},d.end=function(){return d.domain()[this.domain().length-1]},d.min=function(){return Math.min(this.start(),this.end())},d.max=function(){return Math.max(this.start(),this.end())},d.classify=function(a){for(var b=(d.start()-d.end())/a,c=[d.end()],e=[],f=b/2,g=0;g<a;g++){var h=c[c.length-1]||0,i=h+b,j=h+f,k=d.get(j);c.push.apply(c,[i,i]),e.push.apply(e,[k,k])}return c.pop(),d.domain(c),d.range(e),d},d.copy=function(){var c=h(a,b);return c.domain(d.domain()),c.range(d.range()),c.clamp(e.clamp()),c},a){var p=f(a,b),q=g(p,b),r=q.mini,s=q.maxi;d.domain([r,s]),d.range(p.invert?[1,0]:[0,1])}return d}var i=c(22),j=c(0),k=c.n(j),l=c(18),m=c(87),n=c(243);b.a=h;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},p=["min","max","expand","include","invert"]},function(a,b,c){var d=c(224),e=c(85),f=c(80),g=c(40);c.d(b,"a",function(){return d.a}),c.d(b,"b",function(){return e.a}),c.d(b,"c",function(){return g.b}),c.d(b,"d",function(){return f.a})},function(a,b,c){var d=c(27);c.d(b,"b",function(){return e});var e;b.a=function(a,b){var f=c.i(d.a)(a,b);if(!f)return a+"";var g=f[0],h=f[1],i=h-(e=3*Math.max(-8,Math.min(8,Math.floor(h/3))))+1,j=g.length;return i===j?g:i>j?g+new Array(i-j+1).join("0"):i>0?g.slice(0,i)+"."+g.slice(i):"0."+new Array(1-i).join("0")+c.i(d.a)(a,Math.max(0,b+i-1))[0]}},function(a,b,c){function d(a){if(!(b=f.exec(a)))throw new Error("invalid format: "+a);var b,c=b[1]||" ",d=b[2]||">",g=b[3]||"-",h=b[4]||"",i=!!b[5],j=b[6]&&+b[6],k=!!b[7],l=b[8]&&+b[8].slice(1),m=b[9]||"";"n"===m?(k=!0,m="g"):e.a[m]||(m=""),(i||"0"===c&&"="===d)&&(i=!0,c="0",d="="),this.fill=c,this.align=d,this.sign=g,this.symbol=h,this.zero=i,this.width=j,this.comma=k,this.precision=l,this.type=m}var e=c(47),f=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;b.a=function(a){return new d(a)},d.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type}},function(a,b,c){var d=c(104),e=c(45),f=c(106);b.a={"":d.a,"%":function(a,b){return(100*a).toFixed(b)},b:function(a){return Math.round(a).toString(2)},c:function(a){return a+""},d:function(a){return Math.round(a).toString(10)},e:function(a,b){return a.toExponential(b)},f:function(a,b){return a.toFixed(b)},g:function(a,b){return a.toPrecision(b)},o:function(a){return Math.round(a).toString(8)},p:function(a,b){return c.i(f.a)(100*a,b)},r:f.a,s:e.a,X:function(a){return Math.round(a).toString(16).toUpperCase()},x:function(a){return Math.round(a).toString(16)}}},function(a,b,c){function d(a){return a}var e=c(20),f=c(105),g=c(46),h=c(47),i=c(45),j=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];b.a=function(a){function b(a){function b(a){var b,c,g,h=t,k=u;if("c"===s)k=v(a)+k,a="";else{a=+a;var m=(a<0||1/a<0)&&(a*=-1,!0);if(a=v(a,r),m)for(b=-1,c=a.length,m=!1;++b<c;)if(48<(g=a.charCodeAt(b))&&g<58||"x"===s&&96<g&&g<103||"X"===s&&64<g&&g<71){m=!0;break}if(h=(m?"("===f?f:"-":"-"===f||"("===f?"":f)+h,k=k+("s"===s?j[8+i.b/3]:"")+(m&&"("===f?")":""),w)for(b=-1,c=a.length;++b<c;)if(48>(g=a.charCodeAt(b))||g>57){k=(46===g?n+a.slice(b+1):a.slice(b))+k,a=a.slice(0,b);break}}q&&!o&&(a=l(a,1/0));var x=h.length+a.length+k.length,y=x<p?new Array(p-x+1).join(d):"";switch(q&&o&&(a=l(y+a,y.length?p-k.length:1/0),y=""),e){case"<":return h+a+k+y;case"=":return h+y+a+k;case"^":return y.slice(0,x=y.length>>1)+h+a+k+y.slice(x)}return y+h+a+k}a=c.i(g.a)(a);var d=a.fill,e=a.align,f=a.sign,k=a.symbol,o=a.zero,p=a.width,q=a.comma,r=a.precision,s=a.type,t="$"===k?m[0]:"#"===k&&/[boxX]/.test(s)?"0"+s.toLowerCase():"",u="$"===k?m[1]:/[%p]/.test(s)?"%":"",v=h.a[s],w=!s||/[defgprs%]/.test(s);return r=null==r?s?6:12:/[gprs]/.test(s)?Math.max(1,Math.min(21,r)):Math.max(0,Math.min(20,r)),b.toString=function(){return a+""},b}function k(a,d){var f=b((a=c.i(g.a)(a),a.type="f",a)),h=3*Math.max(-8,Math.min(8,Math.floor(c.i(e.a)(d)/3))),i=Math.pow(10,-h),k=j[8+h/3];return function(a){return f(i*a)+k}}var l=a.grouping&&a.thousands?c.i(f.a)(a.grouping,a.thousands):d,m=a.currency,n=a.decimal;return{format:b,formatPrefix:k}}},function(a,b,c){c.d(b,"b",function(){return d}),c.d(b,"a",function(){return e});var d=Math.PI/180,e=180/Math.PI},function(a,b,c){var d=c(31);b.a=function(a,b){var e,f=b?b.length:0,g=a?Math.min(f,a.length):0,h=new Array(f),i=new Array(f);for(e=0;e<g;++e)h[e]=c.i(d.a)(a[e],b[e]);for(;e<f;++e)i[e]=b[e];return function(a){for(e=0;e<g;++e)i[e]=h[e](a);return i}}},function(a,b,c){var d=c(30);b.a=function(a){var b=a.length;return function(e){var f=Math.floor(((e%=1)<0?++e:e)*b),g=a[(f+b-1)%b],h=a[f%b],i=a[(f+1)%b],j=a[(f+2)%b];return c.i(d.b)((e-f/b)*b,g,h,i,j)}}},function(a,b,c){b.a=function(a){return function(){return a}}},function(a,b,c){b.a=function(a,b){var c=new Date;return a=+a,b-=a,function(d){return c.setTime(a+b*d),c}}},function(a,b,c){var d=c(31),e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};b.a=function(a,b){var f,g={},h={};null!==a&&"object"===(void 0===a?"undefined":e(a))||(a={}),null!==b&&"object"===(void 0===b?"undefined":e(b))||(b={});for(f in b)f in a?g[f]=c.i(d.a)(a[f],b[f]):h[f]=b[f];return function(a){for(f in g)h[f]=g[f](a);return h}}},function(a,b,c){function d(a){return function(b){var d,f,g=b.length,h=new Array(g),i=new Array(g),j=new Array(g);for(d=0;d<g;++d)f=c.i(e.e)(b[d]),h[d]=f.r||0,i[d]=f.g||0,j[d]=f.b||0;return h=a(h),i=a(i),j=a(j),f.opacity=1,function(a){return f.r=h(a),f.g=i(a),f.b=j(a),f+""}}}var e=c(11),f=c(30),g=c(51),h=c(14);b.a=function a(b){function d(a,b){var d=f((a=c.i(e.e)(a)).r,(b=c.i(e.e)(b)).r),g=f(a.g,b.g),i=f(a.b,b.b),j=c.i(h.a)(a.opacity,b.opacity);return function(b){return a.r=d(b),a.g=g(b),a.b=i(b),a.opacity=j(b),a+""}}var f=c.i(h.c)(b);return d.gamma=a,d}(1);d(f.a),d(g.a)},function(a,b,c){function d(a){return function(){return a}}function e(a){return function(b){return a(b)+""}}var f=c(21),g=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,h=new RegExp(g.source,"g");b.a=function(a,b){var i,j,k,l=g.lastIndex=h.lastIndex=0,m=-1,n=[],o=[];for(a+="",b+="";(i=g.exec(a))&&(j=h.exec(b));)(k=j.index)>l&&(k=b.slice(l,k),n[m]?n[m]+=k:n[++m]=k),(i=i[0])===(j=j[0])?n[m]?n[m]+=j:n[++m]=j:(n[++m]=null,o.push({i:m,x:c.i(f.a)(i,j)})),l=h.lastIndex;return l<b.length&&(k=b.slice(l),n[m]?n[m]+=k:n[++m]=k),
n.length<2?o[0]?e(o[0].x):d(b):(b=o.length,function(a){for(var c,d=0;d<b;++d)n[(c=o[d]).i]=c.x(a);return n.join("")})}},function(a,b,c){c.d(b,"b",function(){return e}),c.d(b,"a",function(){return f});var d=Array.prototype,e=d.slice,f=d.map},function(a,b,c){var d=c(12),e=c(59),f=c.i(e.a)(d.a),g=f.right;f.left;b.a=g},function(a,b,c){function d(a){return function(b,d){return c.i(e.a)(a(b),d)}}var e=c(12);b.a=function(a){return 1===a.length&&(a=d(a)),{left:function(b,c,d,e){for(null==d&&(d=0),null==e&&(e=b.length);d<e;){var f=d+e>>>1;a(b[f],c)<0?d=f+1:e=f}return d},right:function(b,c,d,e){for(null==d&&(d=0),null==e&&(e=b.length);d<e;){var f=d+e>>>1;a(b[f],c)>0?e=f:d=f+1}return d}}}},function(a,b,c){var d=c(67);b.a=function(a,b){var e=c.i(d.a)(a,b);return e?Math.sqrt(e):e}},function(a,b,c){b.a=function(a,b){var c,d,e,f=-1,g=a.length;if(null==b){for(;++f<g;)if(null!=(d=a[f])&&d>=d){c=e=d;break}for(;++f<g;)null!=(d=a[f])&&(c>d&&(c=d),e<d&&(e=d))}else{for(;++f<g;)if(null!=(d=b(a[f],f,a))&&d>=d){c=e=d;break}for(;++f<g;)null!=(d=b(a[f],f,a))&&(c>d&&(c=d),e<d&&(e=d))}return[c,e]}},function(a,b,c){b.a=function(a,b){var c,d,e=-1,f=a.length;if(null==b){for(;++e<f;)if(null!=(d=a[e])&&d>=d){c=d;break}for(;++e<f;)null!=(d=a[e])&&c>d&&(c=d)}else{for(;++e<f;)if(null!=(d=b(a[e],e,a))&&d>=d){c=d;break}for(;++e<f;)null!=(d=b(a[e],e,a))&&c>d&&(c=d)}return c}},function(a,b,c){b.a=function(a,b,c){a=+a,b=+b,c=(e=arguments.length)<2?(b=a,a=0,1):e<3?1:+c;for(var d=-1,e=0|Math.max(0,Math.ceil((b-a)/c)),f=new Array(e);++d<e;)f[d]=a+d*c;return f}},function(a,b,c){b.a=function(a){return Math.ceil(Math.log(a.length)/Math.LN2)+1}},function(a,b,c){function d(a,b,c){var d=Math.abs(b-a)/Math.max(0,c),e=Math.pow(10,Math.floor(Math.log(d)/Math.LN10)),i=d/e;return i>=f?e*=10:i>=g?e*=5:i>=h&&(e*=2),b<a?-e:e}var e=c(63);b.b=d;var f=Math.sqrt(50),g=Math.sqrt(10),h=Math.sqrt(2);b.a=function(a,b,f){var g=d(a,b,f);return c.i(e.a)(Math.ceil(a/g)*g,Math.floor(b/g)*g+g/2,g)}},function(a,b,c){function d(a){return a.length}var e=c(62);b.a=function(a){if(!(h=a.length))return[];for(var b=-1,f=c.i(e.a)(a,d),g=new Array(f);++b<f;)for(var h,i=-1,j=g[b]=new Array(h);++i<h;)j[i]=a[i][b];return g}},function(a,b,c){var d=c(15);b.a=function(a,b){var e,f,g=a.length,h=0,i=0,j=-1,k=0;if(null==b)for(;++j<g;)isNaN(e=c.i(d.a)(a[j]))||(f=e-h,h+=f/++k,i+=f*(e-h));else for(;++j<g;)isNaN(e=c.i(d.a)(b(a[j],j,a)))||(f=e-h,h+=f/++k,i+=f*(e-h));if(k>1)return i/(k-1)}},function(a,b,c){var d=(c(34),c(145),c(144));c.d(b,"a",function(){return d.a})},function(a,b,c){c.d(b,"b",function(){return d}),c.d(b,"a",function(){return e});var d=Math.PI/180,e=180/Math.PI},function(a,b,c){var d=(c(1),c(148));c.d(b,"p",function(){return d.a}),c.d(b,"h",function(){return d.a});var e=c(151);c.d(b,"o",function(){return e.a}),c.d(b,"g",function(){return e.a});var f=c(149);c.d(b,"n",function(){return f.a});var g=c(147);c.d(b,"m",function(){return g.a});var h=c(146);c.d(b,"l",function(){return h.a});var i=c(158);c.d(b,"k",function(){return i.a});var j=c(150);c.d(b,"j",function(){return j.a});var k=c(159);c.d(b,"i",function(){return k.a});var l=c(154);c.d(b,"f",function(){return l.a});var m=c(153);c.d(b,"e",function(){return m.a});var n=c(152);c.d(b,"d",function(){return n.a});var o=c(156);c.d(b,"c",function(){return o.a});var p=c(155);c.d(b,"b",function(){return p.a});var q=c(157);c.d(b,"a",function(){return q.a})},function(a,b,c){b.a=function(a,b){a=a.slice();var c,d=0,e=a.length-1,f=a[d],g=a[e];return g<f&&(c=d,d=e,e=c,c=f,f=g,g=c),a[d]=b.floor(f),a[e]=b.ceil(g),a}},function(a,b,c){b.a=function(a){return+a}},function(a,b,c){function d(a){function b(b){var c=b+"",d=h.get(c);if(!d){if(j!==g)return j;h.set(c,d=i.push(b))}return a[(d-1)%a.length]}var h=c.i(e.a)(),i=[],j=g;return a=null==a?[]:f.b.call(a),b.domain=function(a){if(!arguments.length)return i.slice();i=[],h=c.i(e.a)();for(var d,f,g=-1,j=a.length;++g<j;)h.has(f=(d=a[g])+"")||h.set(f,i.push(d));return b},b.range=function(c){return arguments.length?(a=f.b.call(c),b):a.slice()},b.unknown=function(a){return arguments.length?(j=a,b):j},b.copy=function(){return d().domain(i).range(a).unknown(j)},b}var e=c(138),f=c(8);b.a=d;var g={name:"implicit"}},function(a,b,c){function d(a){return new Date(a)}function e(a){return a instanceof Date?+a:+new Date(+a)}function f(a,b,s,t,u,v,w,x,y){function z(c){return(w(c)<c?E:v(c)<c?F:u(c)<c?G:t(c)<c?H:b(c)<c?s(c)<c?I:J:a(c)<c?K:L)(c)}function A(b,d,e,f){if(null==b&&(b=10),"number"==typeof b){var h=Math.abs(e-d)/b,i=c.i(g.d)(function(a){return a[2]}).right(M,h);i===M.length?(f=c.i(g.b)(d/r,e/r,b),b=a):i?(i=M[h/M[i-1][2]<M[i][2]/h?i-1:i],f=i[1],b=i[0]):(f=c.i(g.b)(d,e,b),b=x)}return null==f?b:b.every(f)}var B=c.i(j.a)(j.b,h.a),C=B.invert,D=B.domain,E=y(".%L"),F=y(":%S"),G=y("%I:%M"),H=y("%I %p"),I=y("%a %d"),J=y("%b %d"),K=y("%B"),L=y("%Y"),M=[[w,1,l],[w,5,5*l],[w,15,15*l],[w,30,30*l],[v,1,m],[v,5,5*m],[v,15,15*m],[v,30,30*m],[u,1,n],[u,3,3*n],[u,6,6*n],[u,12,12*n],[t,1,o],[t,2,2*o],[s,1,p],[b,1,q],[b,3,3*q],[a,1,r]];return B.invert=function(a){return new Date(C(a))},B.domain=function(a){return arguments.length?D(i.a.call(a,e)):D().map(d)},B.ticks=function(a,b){var c,d=D(),e=d[0],f=d[d.length-1],g=f<e;return g&&(c=e,e=f,f=c),c=A(a,e,f,b),c=c?c.range(e,f+1):[],g?c.reverse():c},B.tickFormat=function(a,b){return null==b?z:y(b)},B.nice=function(a,b){var d=D();return(a=A(a,d[0],d[d.length-1],b))?D(c.i(k.a)(d,a)):B},B.copy=function(){return c.i(j.c)(B,f(a,b,s,t,u,v,w,x,y))},B}var g=c(4),h=c(10),i=(c(70),c(37),c(8)),j=c(23),k=c(71);b.a=f;var l=1e3,m=60*l,n=60*m,o=24*n,p=7*o,q=30*o,r=365*o},function(a,b,c){function d(a){return a.toISOString()}var e=c(38);c.d(b,"a",function(){return f});var f="%Y-%m-%dT%H:%M:%S.%LZ";Date.prototype.toISOString||c.i(e.b)(f)},function(a,b,c){function d(a){if(0<=a.y&&a.y<100){var b=new Date(-1,a.m,a.d,a.H,a.M,a.S,a.L);return b.setFullYear(a.y),b}return new Date(a.y,a.m,a.d,a.H,a.M,a.S,a.L)}function e(a){if(0<=a.y&&a.y<100){var b=new Date(Date.UTC(-1,a.m,a.d,a.H,a.M,a.S,a.L));return b.setUTCFullYear(a.y),b}return new Date(Date.UTC(a.y,a.m,a.d,a.H,a.M,a.S,a.L))}function f(a){return{y:a,m:0,d:1,H:0,M:0,S:0,L:0}}function g(a){function b(a,b){return function(c){var d,e,f,g=[],h=-1,i=0,j=a.length;for(c instanceof Date||(c=new Date(+c));++h<j;)37===a.charCodeAt(h)&&(g.push(a.slice(i,h)),null!=(e=ba[d=a.charAt(++h)])?d=a.charAt(++h):e="e"===d?" ":"0",(f=b[d])&&(d=f(c,e)),g.push(d),i=h+1);return g.push(a.slice(i,h)),g.join("")}}function c(a,b){return function(c){var d=f(1900);if(g(d,a,c+="",0)!=c.length)return null;if("p"in d&&(d.H=d.H%12+12*d.p),"W"in d||"U"in d){"w"in d||(d.w="W"in d?1:0);var h="Z"in d?e(f(d.y)).getUTCDay():b(f(d.y)).getDay();d.m=0,d.d="W"in d?(d.w+6)%7+7*d.W-(h+5)%7:d.w+7*d.U-(h+6)%7}return"Z"in d?(d.H+=d.Z/100|0,d.M+=d.Z%100,e(d)):b(d)}}function g(a,b,c,d){for(var e,f,g=0,h=b.length,i=c.length;g<h;){if(d>=i)return-1;if(37===(e=b.charCodeAt(g++))){if(e=b.charAt(g++),!(f=La[e in ba?b.charAt(g++):e])||(d=f(a,c,d))<0)return-1}else if(e!=c.charCodeAt(d++))return-1}return d}function h(a,b,c){var d=za.exec(b.slice(c));return d?(a.p=Aa[d[0].toLowerCase()],c+d[0].length):-1}function i(a,b,c){var d=Da.exec(b.slice(c));return d?(a.w=Ea[d[0].toLowerCase()],c+d[0].length):-1}function aa(a,b,c){var d=Ba.exec(b.slice(c));return d?(a.w=Ca[d[0].toLowerCase()],c+d[0].length):-1}function ca(a,b,c){var d=Ha.exec(b.slice(c));return d?(a.m=Ia[d[0].toLowerCase()],c+d[0].length):-1}function da(a,b,c){var d=Fa.exec(b.slice(c));return d?(a.m=Ga[d[0].toLowerCase()],c+d[0].length):-1}function ea(a,b,c){return g(a,ra,b,c)}function fa(a,b,c){return g(a,sa,b,c)}function ga(a,b,c){return g(a,ta,b,c)}function ha(a){return wa[a.getDay()]}function ia(a){return va[a.getDay()]}function ja(a){return ya[a.getMonth()]}function ka(a){return xa[a.getMonth()]}function la(a){return ua[+(a.getHours()>=12)]}function ma(a){return wa[a.getUTCDay()]}function na(a){return va[a.getUTCDay()]}function oa(a){return ya[a.getUTCMonth()]}function pa(a){return xa[a.getUTCMonth()]}function qa(a){return ua[+(a.getUTCHours()>=12)]}var ra=a.dateTime,sa=a.date,ta=a.time,ua=a.periods,va=a.days,wa=a.shortDays,xa=a.months,ya=a.shortMonths,za=j(ua),Aa=k(ua),Ba=j(va),Ca=k(va),Da=j(wa),Ea=k(wa),Fa=j(xa),Ga=k(xa),Ha=j(ya),Ia=k(ya),Ja={a:ha,A:ia,b:ja,B:ka,c:null,d:z,e:z,H:A,I:B,j:C,L:D,m:E,M:F,p:la,S:G,U:H,w:I,W:J,x:null,X:null,y:K,Y:L,Z:M,"%":_},Ka={a:ma,A:na,b:oa,B:pa,c:null,d:N,e:N,H:O,I:P,j:Q,L:R,m:S,M:T,p:qa,S:U,U:V,w:W,W:X,x:null,X:null,y:Y,Y:Z,Z:$,"%":_},La={a:i,A:aa,b:ca,B:da,c:ea,d:s,e:s,H:u,I:u,j:t,L:x,m:r,M:v,p:h,S:w,U:m,w:l,W:n,x:fa,X:ga,y:p,Y:o,Z:q,"%":y};return Ja.x=b(sa,Ja),Ja.X=b(ta,Ja),Ja.c=b(ra,Ja),Ka.x=b(sa,Ka),Ka.X=b(ta,Ka),Ka.c=b(ra,Ka),{format:function(a){var c=b(a+="",Ja);return c.toString=function(){return a},c},parse:function(a){var b=c(a+="",d);return b.toString=function(){return a},b},utcFormat:function(a){var c=b(a+="",Ka);return c.toString=function(){return a},c},utcParse:function(a){var b=c(a,e);return b.toString=function(){return a},b}}}function h(a,b,c){var d=a<0?"-":"",e=(d?-a:a)+"",f=e.length;return d+(f<c?new Array(c-f+1).join(b)+e:e)}function i(a){return a.replace(ea,"\\$&")}function j(a){return new RegExp("^(?:"+a.map(i).join("|")+")","i")}function k(a){for(var b={},c=-1,d=a.length;++c<d;)b[a[c].toLowerCase()]=c;return b}function l(a,b,c){var d=ca.exec(b.slice(c,c+1));return d?(a.w=+d[0],c+d[0].length):-1}function m(a,b,c){var d=ca.exec(b.slice(c));return d?(a.U=+d[0],c+d[0].length):-1}function n(a,b,c){var d=ca.exec(b.slice(c));return d?(a.W=+d[0],c+d[0].length):-1}function o(a,b,c){var d=ca.exec(b.slice(c,c+4));return d?(a.y=+d[0],c+d[0].length):-1}function p(a,b,c){var d=ca.exec(b.slice(c,c+2));return d?(a.y=+d[0]+(+d[0]>68?1900:2e3),c+d[0].length):-1}function q(a,b,c){var d=/^(Z)|([+-]\d\d)(?:\:?(\d\d))?/.exec(b.slice(c,c+6));return d?(a.Z=d[1]?0:-(d[2]+(d[3]||"00")),c+d[0].length):-1}function r(a,b,c){var d=ca.exec(b.slice(c,c+2));return d?(a.m=d[0]-1,c+d[0].length):-1}function s(a,b,c){var d=ca.exec(b.slice(c,c+2));return d?(a.d=+d[0],c+d[0].length):-1}function t(a,b,c){var d=ca.exec(b.slice(c,c+3));return d?(a.m=0,a.d=+d[0],c+d[0].length):-1}function u(a,b,c){var d=ca.exec(b.slice(c,c+2));return d?(a.H=+d[0],c+d[0].length):-1}function v(a,b,c){var d=ca.exec(b.slice(c,c+2));return d?(a.M=+d[0],c+d[0].length):-1}function w(a,b,c){var d=ca.exec(b.slice(c,c+2));return d?(a.S=+d[0],c+d[0].length):-1}function x(a,b,c){var d=ca.exec(b.slice(c,c+3));return d?(a.L=+d[0],c+d[0].length):-1}function y(a,b,c){var d=da.exec(b.slice(c,c+1));return d?c+d[0].length:-1}function z(a,b){return h(a.getDate(),b,2)}function A(a,b){return h(a.getHours(),b,2)}function B(a,b){return h(a.getHours()%12||12,b,2)}function C(a,b){return h(1+aa.a.count(c.i(aa.b)(a),a),b,3)}function D(a,b){return h(a.getMilliseconds(),b,3)}function E(a,b){return h(a.getMonth()+1,b,2)}function F(a,b){return h(a.getMinutes(),b,2)}function G(a,b){return h(a.getSeconds(),b,2)}function H(a,b){return h(aa.c.count(c.i(aa.b)(a),a),b,2)}function I(a){return a.getDay()}function J(a,b){return h(aa.d.count(c.i(aa.b)(a),a),b,2)}function K(a,b){return h(a.getFullYear()%100,b,2)}function L(a,b){return h(a.getFullYear()%1e4,b,4)}function M(a){var b=a.getTimezoneOffset();return(b>0?"-":(b*=-1,"+"))+h(b/60|0,"0",2)+h(b%60,"0",2)}function N(a,b){return h(a.getUTCDate(),b,2)}function O(a,b){return h(a.getUTCHours(),b,2)}function P(a,b){return h(a.getUTCHours()%12||12,b,2)}function Q(a,b){return h(1+aa.e.count(c.i(aa.f)(a),a),b,3)}function R(a,b){return h(a.getUTCMilliseconds(),b,3)}function S(a,b){return h(a.getUTCMonth()+1,b,2)}function T(a,b){return h(a.getUTCMinutes(),b,2)}function U(a,b){return h(a.getUTCSeconds(),b,2)}function V(a,b){return h(aa.g.count(c.i(aa.f)(a),a),b,2)}function W(a){return a.getUTCDay()}function X(a,b){return h(aa.h.count(c.i(aa.f)(a),a),b,2)}function Y(a,b){return h(a.getUTCFullYear()%100,b,2)}function Z(a,b){return h(a.getUTCFullYear()%1e4,b,4)}function $(){return"+0000"}function _(){return"%"}var aa=c(177);b.a=g;var ba={"-":"",_:" ",0:"0"},ca=/^\s*\d+/,da=/^%/,ea=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g},function(a,b){a.exports={array:Array.isArray,primitive:function(a){return"string"==typeof a||"number"==typeof a}}},function(a,b){a.exports=function(a,b,c,d,e){return{sel:a,data:b,children:c,text:d,elm:e,key:void 0===b?void 0:b.key}}},function(a,b,c){function d(){return{labels:{show:!0,tilted:!1,tiltAngle:40,maxEdgeBleed:1/0,fontFamily:"Arial",fontSize:"12px",fill:"#595959",margin:6,layered:!1,maxSize:250},line:{show:!1,strokeWidth:1,stroke:"#cccccc"},ticks:{show:!1,margin:0,tickSize:4,stroke:"#cccccc",strokeWidth:1}}}function e(){return{labels:{show:!0,tilted:!1,tiltAngle:40,maxEdgeBleed:1/0,fontFamily:"Arial",fontSize:"12px",fill:"#595959",margin:4,layered:!1,maxSize:250},line:{show:!0,strokeWidth:1,stroke:"#cccccc"},ticks:{show:!0,margin:0,tickSize:8,stroke:"#cccccc",strokeWidth:1},minorTicks:{show:!1,margin:0,tickSize:3,stroke:"#E6E6E6",strokeWidth:1}}}b.b=d,b.a=e},function(a,b,c){function d(a,b){return b&&m.register(a,c.i(e.a)(b)),m.get(a)}var e=c(9),f=c(3),g=c(216),h=c(219),i=c(214),j=c(212),k=c(222),l=c(221);b.a=d;var m=c.i(f.a)();m.register("text",k.a),m.register("axis",j.a),m.register("box-marker",g.a),m.register("point-marker",h.a),m.register("grid-line",i.a),m.register("scrollbar",l.a)},function(a,b,c){function d(a){return a.map(function(a,b){return c.i(g.a)({id:"/"+b})(a)})}function e(a,b){var c=b.filter(function(b){return 0===a.indexOf(b.id())})[0],d=void 0;if(c){var e=a.replace(c.id(),"");d=c.findField(e)}return{table:c,field:d}}function f(){function a(b){return j=b,i={},a}var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},f=b.tables,g=void 0===f?d:f,i={},j=[];return a.tables=function(){return i.tables||(i.tables=g(j)),i.tables},a.table=function(b){return a.tables().filter(function(a){return a.id()===b})[0]},a.findField=function(b){return e(b,a.tables())},a.map=function(b,d){return c.i(h.a)(b,d,a)},a}var g=c(83),h=c(229);b.a=f},function(a,b,c){function d(){function a(b){return s=b,a}var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=b.id,d=b.min,e=void 0===d?f.min:d,g=b.max,h=void 0===g?f.max:g,i=b.type,j=void 0===i?f.type:i,k=b.tags,l=void 0===k?f.tags:k,m=b.title,n=void 0===m?f.title:m,o=b.values,p=void 0===o?f.values:o,q=b.formatter,r=void 0===q?f.formatter:q,s={};return a.id=function(){return c},a.data=function(){return s},a.tags=function(){return l(s)},a.type=function(){return j(s)},a.min=function(){return e(s)},a.max=function(){return h(s)},a.title=function(){return n(s)},a.values=function(){return p(s)},a.formatter=function(){return r(s)},a}var e=c(41);b.a=d;var f={tags:function(a){return a.tags},min:function(a){return a.min},max:function(a){return a.max},type:function(a){return a.type},title:function(a){return a.title},values:function(a){return a.values},formatter:function(){return c.i(e.b)("d3")("number")("")}}},function(a,b,c){function d(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function e(){function a(b){return h=b,i={},a}var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=b.id,d=b.fields,e=void 0===d?k.fields:d,f=b.find,g=void 0===f?k.find:f,h={},i={};return a.data=function(){return h},a.id=function(){return c},a.fields=function(){return i.fields||(i.fields=e(h)),i.fields},a.findField=function(b){return g(b,a.fields())},a}var f=c(82),g=c(24);b.a=e;var h={numeric:function(a){return a.filter(function(a){return"number"==typeof a&&!isNaN(a)})}},i=function(a){var b=a[0],e=a.slice(1);return b.map(function(a,i){var j=c.i(g.a)("//"+i,e),k=h.numeric(j),l=k.length>0,m=l?"measure":"dimension",n=l?Math.min.apply(Math,d(k)):NaN,o=l?Math.max.apply(Math,d(k)):NaN,p=j.map(function(a){return{value:a,label:String(a),id:String(a)}});return c.i(f.a)({id:"/"+i})({title:b[i],values:p,min:n,max:o,type:m})})},j=function(a,b){return b.filter(function(b){return b.id()===a||b.title()===a})[0]},k={find:j,fields:i}},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){d(this,a),this._elements=[[1,0,0],[0,1,0],[0,0,1]],this._stack=[]}return e(a,[{key:"clone",value:function(){return(new a).multiply(this)}},{key:"set",value:function(a){return this._elements=a,this}},{key:"save",value:function(){return this._stack.push(this.elements),this}},{key:"restore",value:function(){return this._stack.length&&(this._elements=this._stack.pop()),this}},{key:"add",value:function(a){var b=void 0,c=void 0;for(b=0;b<this._elements.length;b++)for(c=0;c<this._elements[b].length;c++)this._elements[b][c]+=a;return this}},{key:"translate",value:function(a,b){return this.multiply([[1,0,a],[0,1,b],[0,0,1]]),this}},{key:"rotate",value:function(a){var b=Math.cos(-a),c=Math.sin(-a);return this.multiply([[b,c,0],[-c,b,0],[0,0,1]]),this}},{key:"multiply",value:function(b){var c=void 0,d=void 0,e=void 0,f=void 0;if(b instanceof a&&(b=b._elements),Array.isArray(b)){for(e=[[0,0,0],[0,0,0],[0,0,0]],c=0;c<this._elements.length;c++)for(d=0;d<this._elements[c].length;d++)for(f=0;f<3;f++)e[c][d]+=this._elements[c][f]*b[f][d];this._elements=e}else for(c=0;c<this._elements.length;c++)for(d=0;d<this._elements[c].length;d++)this._elements[c][d]*=b;return this}},{key:"scale",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a;return this.multiply([[a,0,0],[0,b,0],[0,0,1]]),this}},{key:"transform",value:function(a,b,c,d,e,f){return this.multiply([[a,c,e],[b,d,f],[0,0,1]]),this}},{key:"determinant",value:function(){var a=this._elements[0][0],b=this._elements[0][1],c=this._elements[0][2],d=this._elements[1][0],e=this._elements[1][1],f=this._elements[1][2],g=this._elements[2][0],h=this._elements[2][1],i=this._elements[2][2];return a*e*i+b*f*g+c*d*h-c*e*g-b*d*i-a*f*h}},{key:"invert",value:function(){var a=this.determinant(),b=this._elements[0][0],c=this._elements[0][1],d=this._elements[0][2],e=this._elements[1][0],f=this._elements[1][1],g=this._elements[1][2],h=this._elements[2][0],i=this._elements[2][1],j=this._elements[2][2];return this._elements=[[f*j-g*i,d*i-c*j,c*g-d*f],[g*h-e*j,b*j-d*h,d*e-b*g],[e*i-f*h,h*c-b*i,b*f-c*e]],this.multiply(1/a),this}},{key:"transpose",value:function(){var a=Object.create(this._elements);return this._elements=[[a[0][0],a[1][0],a[2][0]],[a[0][1],a[1][1],a[2][1]],[a[0][2],a[1][2],a[2][2]]],this}},{key:"identity",value:function(){return this._elements=[[1,0,0],[0,1,0],[0,0,1]],this}},{key:"toString",value:function(){return""+this._elements.map(function(a){return a.join("\t")}).join("\n")}},{key:"isIdentity",value:function(){var a=this._elements;return 1===a[0][0]&&0===a[0][1]&&0===a[0][2]&&0===a[1][0]&&1===a[1][1]&&0===a[1][2]&&0===a[2][0]&&0===a[2][1]&&1===a[2][2]}},{key:"transformPoint",value:function(a){var b=[a.x,a.y,1],c=void 0,d=void 0,e=this._elements,f=[0,0,0];for(c=0;c<this._elements.length;c++)for(d=0;d<this._elements[c].length;d++)f[c]+=b[d]*e[c][d];return{x:f[0],y:f[1]}}},{key:"transformPoints",value:function(a){var b=void 0,c=void 0,d=void 0,e=void 0,f=void 0,g=this._elements,h=[];for(e=0;e<a.length;e++){for(b=[a[e].x,a[e].y,1],f=[0,0,0],c=0;c<this._elements.length;c++)for(d=0;d<this._elements[c].length;d++)f[c]+=b[d]*g[c][d];h.push({x:f[0],y:f[1]})}return h}},{key:"elements",get:function(){var a=this._elements;return[[a[0][0],a[0][1],a[0][2]],[a[1][0],a[1][1],a[1][2]],[a[2][0],a[2][1],a[2][2]]]}}]),a}();b.a=f},function(a,b,c){function d(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f[0];if(!g.has(a))throw new Error("Renderer of type '"+a+"' does not exist");return g.get(a)()}var e=c(3);b.a=d;var f=[],g=c.i(e.a)();d.register=function(a,b){return g.add(a,b)&&f.push(a),this},d.deregister=function(a){g.remove(a);var b=f.indexOf(a);return b!==-1&&f.splice(b,1),this},d.types=function(){return g.getKeys().slice()},d.prio=function(a){return a?(f=a.slice(),this):f.slice()}},function(a,b,c){function d(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function e(a,b){var e={min:a.min,max:a.max};return c.i(k.a)(a.min)&&(e.min=b&&b.length?Math.min.apply(Math,d(b.map(function(a){return a.min()}))):0),c.i(k.a)(a.max)&&(e.max=b&&b.length?Math.max.apply(Math,d(b.map(function(a){return a.max()}))):1),e}function f(a,b,c){var d=a.length;if(2===d)return[b,c];var e=[],f=(c-b)/(d-1);e.push(b);for(var g=1;g<d-1;g++)e.push(b+f*g);return e.push(c),e}function g(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=arguments[1],d=c.i(l.a)(b,a).interpolate(h.e),g=function(a){return d(a)};j()(!0,g,d);var i=e(a,b),k=i.min,m=i.max;return g.range(a.colors||a.range||["red","blue"]),g.domain(a.limits||a.domain||f(g.range(),k,m)),g}var h=c(10),i=c(0),j=c.n(i),k=c(18),l=c(43);b.a=g},function(a,b,c){function d(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function e(a){return void 0===a?function(a){return a}:function(b){return a(b)}}function f(a,b,c){for(var d=Math.abs(b-c),e=d/(a+1),f=[],g=1;g<=a;g++){var h=g*e;f.push(b<c?b+h:b-h)}return f}function g(a,b,c){if(1===a.length)return a;for(var e=a.concat([]),g=0;g<a.length;g++){var h=a[g],i=a[g+1];0===g&&h!==c.start()?(e.push.apply(e,d(f(b,h,i))),h-=i-h,i=a[g],e.push.apply(e,d(f(b,h,i)))):g===a.length-1&&i!==c.end()?(i=h+(h-a[g-1]),e.push.apply(e,d(f(b,h,i)))):e.push.apply(e,d(f(b,h,i)))}return e.filter(function(a){return a>=c.min()&&a<=c.max()})}function h(a){var b=a.distance,c=a.scale,d=a.minorCount,f=void 0===d?0:d,h=a.unitDivider,i=void 0===h?100:h,j=a.formatter,k=void 0===j?void 0:j,l=function(a){return"number"==typeof a&&!isNaN(a)}(i)?Math.max(Math.round(b/i),2):2,m=c.ticks(l);m.length<=1&&(m=c.ticks(l+1));var n=f>0?g(m,f,c):m;n.sort(function(a,b){return a-b});var o=n.map(e(k));return n.map(function(a,b){return{position:c.get(a),label:o[b],value:a,isMinor:m.indexOf(a)===-1}})}function i(a){var b=a.distance,c=a.scale,d=a.minorCount,f=void 0===d?0:d,h=a.unitDivider,i=void 0===h?100:h,j=a.formatter,k=void 0===j?void 0:j,l=function(a){return"number"==typeof a&&!isNaN(a)}(i)?Math.max(Math.round(b/i),2):2,m=l>10?10:l;c.nice(m);var n=c.ticks(l),o=f>0?g(n,f,c):n;o.sort(function(a,b){return a-b});var p=o.map(e(k));return o.map(function(a,b){return{position:c.get(a),label:p[b],value:a,isMinor:n.indexOf(a)===-1}})}function j(a){var b=a.count,c=a.minorCount,d=a.scale,e=a.formatter;return d.ticks((b-1)*c+b).map(function(a,b){return{position:d.get(a),label:e(a),isMinor:b%(c+1)!=0,value:a}})}function k(a){var b=a.values,c=a.scale,d=a.formatter;return b.sort(function(a,b){return a-b}).filter(function(a,b,d){return a<=c.max()&&a>=c.min()&&d.indexOf(a)===b}).map(function(a){return{position:c.get(a),label:d(a),isMinor:!1,value:a}})}function l(a,b,c){var d=a.map(function(a){return a.position}),e=b.range();d.indexOf(e[0])===-1&&a.splice(0,0,{position:e[0],label:c(b.start()),isMinor:!1}),d.indexOf(e[1])===-1&&a.push({position:e[1],label:c(b.end()),isMinor:!1})}function m(a){var b=a.settings,c=a.scale,d=a.distance,e=a.formatter,f=void 0,g=b.minorTicks?b.minorTicks.count:0;if(b.ticks.values)f=k({values:b.ticks.values,scale:c.copy(),formatter:e});else if(void 0!==b.ticks.count)f=j({count:b.ticks.count,minorCount:g,scale:c.copy(),formatter:e});else{var m=b.ticks.tight?i:h;f=m({distance:d,minorCount:g,unitDivider:b.ticks.distance,scale:c,formatter:e}),b.ticks.forceBounds&&l(f,c,e)}return f}function n(a){var b=a.scale;return(b.data().length>0?b.data().map(function(a){return a.self}):b.domain().map(function(a){return{value:a}})).map(function(a){return{position:b(a)+b.bandWidth()/2,label:""+("label"in a?a.label:a.value)}})}b.b=m,b.a=n},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function g(a,b){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0!==b.bounds){var d=b.bounds(c),e=o(d,3),f=e[0],g=e[2],h=f.x,i=f.y,j=g.x,k=g.y,l=isNaN(a._boundingRect.width)?j:Math.max(j,a._boundingRect.width+a._boundingRect.x),m=isNaN(a._boundingRect.height)?k:Math.max(k,a._boundingRect.height+a._boundingRect.y);a._boundingRect.x=isNaN(a._boundingRect.x)?h:Math.min(h,a._boundingRect.x),a._boundingRect.y=isNaN(a._boundingRect.y)?i:Math.min(i,a._boundingRect.y),a._boundingRect.width=l-a._boundingRect.x,a._boundingRect.height=m-a._boundingRect.y}}function h(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return new(Function.prototype.bind.apply(q,[null].concat(b)))}var i=c(0),j=c.n(i),k=c(13),l=c(254);b.a=h;var m=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),n=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)},o=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h.return&&h.return()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),p=l.a.prototype,q=function(a){function b(){d(this,b);for(var a=arguments.length,c=Array(a),f=0;f<a;f++)c[f]=arguments[f];var g=c.type,h=void 0===g?"container":g,i=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,h));return i.set.apply(i,c),i._boundingRect={},i}return f(b,a),m(b,[{key:"set",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"set",this).call(this,a);var c=a.collider,d=j()({type:null},c);n(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"collider",this).call(this,d)}},{key:"boundingRect",value:function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],b=this.children.length;this._boundingRect={};for(var c=0;c<b;c++)g(this,this.children[c],a);return j()({x:0,y:0,width:0,height:0},this._boundingRect)}},{key:"bounds",value:function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],b=this.boundingRect(a);return[{x:b.x,y:b.y},{x:b.x+b.width,y:b.y},{x:b.x+b.width,y:b.y+b.height},{x:b.x,y:b.y+b.height}]}},{key:"addChild",value:function(a){var c=p.addChild.call(this,a);if(this._collider&&"bounds"===this._collider.type){g(this,a,!0);var d=j()({x:0,y:0,width:0,height:0},this._boundingRect,this._collider);n(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"collider",this).call(this,d)}return c}},{key:"addChildren",value:function(a){var c=p.addChildren.call(this,a),d=a.length;if(this._collider&&"bounds"===this._collider.type&&d>0){for(var e=0;e<d;e++)g(this,a[e],!0);var f=j()({x:0,y:0,width:0,height:0},this._boundingRect,this._collider);n(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"collider",this).call(this,f)}return c}},{key:"removeChild",value:function(a){a._stage=null;var c=a.descendants,d=c?c.length:0,e=void 0;for(e=0;e<d;e++)c[e]._stage=null;if(p.removeChild.call(this,a),this._collider&&"bounds"===this._collider.type){var f=j()(this.boundingRect(!0),this._collider);n(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"collider",this).call(this,f)}return this}},{key:"removeChildren",value:function(a){if(p.removeChildren.call(this,a),this._collider&&"bounds"===this._collider.type){var c=j()(this.boundingRect(!0),this._collider);n(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"collider",this).call(this,c)}return this}}]),b}(k.a);b.b=q},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b){d(this,a),this._parent=null,this._children=[],this._ancestors=null,this.type=b,this.data=null}return e(a,[{key:"detach",value:function(){return this._parent&&this._parent.removeChild(this),this}},{key:"equals",value:function(a){var b=this.children,c=a.children;if(b.length!==c.length)return!1;for(var d=0;d<b.length;d++)if(!b[d].equals(c[d]))return!1;return!0}},{key:"toJSON",value:function(){return{type:this.type,children:this.children.map(function(a){return a.toJSON()})}}},{key:"parent",get:function(){return this._parent}},{key:"isBranch",get:function(){return this._children&&this._children.length}},{key:"children",get:function(){return this._children}},{key:"ancestors",get:function(){if(!this._ancestors){var a=this._parent;this._ancestors=a?[a].concat(a.ancestors):[]}return this._ancestors}},{key:"descendants",get:function(){var a=[],b=void 0,c=void 0,d=void 0;for(b=0,c=this._children.length;b<c;b++)d=this._children[b],a.push(d),d._children.length&&(a=a.concat(d.descendants));return a}}]),a}();b.a=f},function(a,b,c){function d(a,b,e){a.forEach(function(a){a=j.save(a);var g=c.i(f.a)(a.type,a);g&&(g.set(a),g.type=a.type,a.transform&&(e.save(),c.i(h.a)(a.transform,e)),e.isIdentity()||(g.modelViewMatrix=e.clone()),b.addChild(g),a.children&&d(a.children,g,e),a.transform&&e.restore()),j.restore()})}function e(a){var b=a.items,e=a.stage,h=a.dpi;return e||(e=c.i(f.a)("stage",h)),d(b,e,new g.a),e}var f=c(248),g=c(84),h=c(91),i=c(246);b.a=e;var j=c.i(i.a)(["stroke","fill","strokeWidth","opacity","fontFamily","fontSize","baseline"])},function(a,b,c){function d(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function e(a){for(var b=void 0,c=[];null!==(b=k.exec(a));){var d=b[2].trim(),e=d.indexOf(",")===-1?d.split(" "):d.split(",");c.push({cmd:b[1],args:e.filter(function(a){return a.trim().length>0}).map(function(a){return Number(a)})})}return c}function f(a,b){var c=b.args[0]*(Math.PI/180);if(b.args.length>2){var d=b.args[1],e=b.args[2];a.translate(d,e),a.rotate(c),a.translate(-d,-e)}else 1===b.args.length&&a.rotate(c)}function g(a,b){var c=b.args[0],d=isNaN(b.args[1])?b.args[0]:b.args[1];a.scale(c,d)}function h(a,b){var c=b.args[0],d=isNaN(b.args[1])?0:b.args[1];a.translate(c,d)}function i(a,b){b.args.length>=6&&a.transform.apply(a,d(b.args))}function j(a,b){e(a).forEach(function(a){"rotate"===a.cmd?f(b,a):"scale"===a.cmd?g(b,a):"matrix"===a.cmd?i(b,a):"translate"===a.cmd&&h(b,a)})}b.a=j;var k=/(translate|scale|rotate|matrix)\(([0-9,.eE+-\s]+)(?:,|\s?)+\)/g},function(a,b,c){var d=function(a){function b(b){if(a[b.type]&&a[b.type].condition(b)){var c=a[b.type],d=void 0===c.conditionAppend||c.conditionAppend(b);c.items.forEach(function(a){var c=Math.round(b[a.key]),e=b[a.key]-c;b[a.key]=c,d&&"append"===a.type&&(e>0?b[a.key]+=.5:b[a.key]-=.5)})}}return void 0===a&&(a={},a.line={append:["x1","x2","y1","y2"],round:[],condition:function(a){return a.x1===a.x2||a.y1===a.y2},conditionAppend:function(a){return a.strokeWidth%2!=0}},a.rect={append:["x","y"],
round:["width","height"],condition:function(){return!0},conditionAppend:function(a){return a.strokeWidth%2!=0}}),Object.keys(a).forEach(function(b){var c=a[b];c.items=[],c.append.forEach(function(a){c.items.push({key:a,type:"append"})}),c.round.forEach(function(a){c.items.push({key:a,type:"round"})})}),b.multiple=function(a){return a.forEach(function(a){return b(a)})},b}();b.a=d},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return new(Function.prototype.bind.apply(h,[null].concat(b)))}var f=c(92);b.a=e;var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=function(){function a(){d(this,a),this.reset(),this.push.apply(this,arguments)}return g(a,[{key:"transposeCoordinate",value:function(a,b,c){if("number"==typeof b&&isFinite(b)){var d=a.substring(0,1);if("x"===d||"cx"===a)return b*this.width;if("width"===a)return b*this.width;if("r"===a)return b*(c?this.height:this.width);if("y"===d||"cy"===a)return b*this.height;if("height"===a)return b*this.height}return b}},{key:"push",value:function(){var a;return(a=this.storage).push.apply(a,arguments),this}},{key:"output",value:function(){var b=this;return this.storage.map(function(d){var e={},g=void 0!==d.flipXY?d.flipXY:b.flipXY;return Object.keys(d).forEach(function(c){var f=a.evaluateKey(c,g),h=b.transposeCoordinate(f,d[c],g);e[f]=h}),b.crisp&&c.i(f.a)(e),e})}},{key:"reset",value:function(){this.storage=[],this.flipXY=!1,this.crisp=!1,this.flipX=!1,this.flipY=!1,this.width=0,this.height=0}}],[{key:"evaluateKey",value:function(a,b){if(b){var c=a.substring(0,1),d=a.substring(1);if("x"===c)return"y"+d;if("y"===c)return"x"+d;if("cx"===a)return"cy";if("cy"===a)return"cx";if("width"===a)return"height";if("height"===a)return"width"}return a}}]),a}()},function(a,b,c){var d=c(193),e=c.n(d);b.a={mixin:function(a){Object.keys(e.a.prototype).forEach(function(b){a[b]=e.a.prototype[b]}),e.a.init(a)}}},function(a,b,c){function d(a){return"ontouchstart"in a&&"ontouchend"in a}function e(a){return!!a.changedTouches}function f(a,b){var c=e(a),d=c?a.changedTouches[0]:a,f=Date.now()-b.time,g=isNaN(b.x)?0:Math.abs(d.clientX-b.x),h=isNaN(b.y)?0:Math.abs(d.clientY-b.y);return(0===a.button||c)&&!b.multiTouch&&g<=12&&h<=12&&f<=300}b.c=d,b.a=e,b.b=f},function(a,b,c){function d(a){return h.test(a)}function e(a){return i.test(a)||j.test(a)}function f(a){var b=a?a.length:0,c=void 0,f=void 0;for(c=0;c<b;c++){if(f=a[c],d(f))return"ltr";if(e(f))return"rtl"}return"ltr"}function g(a,b){return"rtl"===b?k[a]:a}b.a=f,b.b=g;var h=new RegExp("[A-Za-zªµºÀ-ÖØ-öø-ʸʻ-ˁː-ˑˠ-ˤˮͰ-ͳͶ-ͽΆΈ-ϵϷ-҂Ҋ-։ः-हऻऽ-ीॉ-ौॎ-ॐक़-ॡ।-ॿং-হঽ-ীে-ৌৎ-ৡ০-ৱ৴-৺ਃ-ਹਾ-ੀਖ਼-੯ੲ-ੴઃ-હઽ-ીૉ-ૌૐ-ૡ૦-૯ଂ-ହଽ-ାୀେ-ୌୗ-ୡ୦-୷ஃ-ிு-ௌௐ-௲ఁ-ఽు-ౄౘ-ౡ౦-౯౿-ಹಽ-ೋೕ-ೡ೦-ീെ-ൌൎ-ൡ൦-ෆා-ෑෘ-ะา-ำเ-ๆ๏-ະາ-ຳຽ-ໆ໐-༗༚-༴༶༸༾-ཬཿ྅ྈ-ྌ྾-࿅࿇-ာေးျ-ြဿ-ၗၚ-ၝၡ-ၰၵ-ႁႃ-ႄႇ-ႌႎ-ႜ႞-ፚ፠-ᎏᎠ-Ᏼᐁ-ᙿᚁ-ᚚᚠ-ᜑᜠ-ᜱ᜵-ᝑᝠ-ᝰក-ាើ-ៅះ-ៈ។-៚ៜ០-៩᠐-ᢨᢪ-ᤜᤣ-ᤦᤩ-ᤱᤳ-ᤸ᥆-᧚ᨀ-ᨖᨙ-ᩕᩗᩡᩣ-ᩤᩭ-ᩲ᪀-᪭ᬄ-ᬳᬵᬻᬽ-ᭁᭃ-᭪᭴-᭼ᮂ-ᮡᮦ-ᮧ᮪-ᯥᯧᯪ-ᯬᯮ᯲-ᰫᰴ-ᰵ᰻-᱿᳓᳡ᳩ-ᳬᳮ-ᶿḀ-ᾼιῂ-ῌῐ-Ίῠ-Ῥῲ-ῼ‎ⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎ-⅏Ⅰ-ↈ⌶-⍺⎕⒜-ⓩ⚬⠀-⣿Ⰰ-ⳤⳫ-ⳮⴀ-⵰ⶀ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ㆺㇰ-㈜㈠-㉏㉠-㉻㉿-㊰㋀-㋋㋐-㍶㍻-㏝㏠-㏾㐀-䶵一-ꒌꓐ-ꘌꘐ-ꙮꚀ-ꛯ꛲-꛷Ꜣ-ꞇ꞉-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠤꠧ꠰-꠷ꡀ-ꡳꢀ-ꣃ꣎-꣙ꣲ-ꤥ꤮-ꥆꥒ-ꥼꦃ-ꦲꦴ-ꦵꦺ-ꦻꦽ-ꨨꨯ-ꨰꨳ-ꨴꩀ-ꩂꩄ-ꩋꩍ-ꪯꪱꪵ-ꪶꪹ-ꪽꫀꫂ-ꯤꯦ-ꯧꯩ-꯬꯰-ﬗＡ-Ｚａ-ｚｦ-ￜ]"),i=new RegExp("[־׀׃׆א-״߀-ߪߴ-ߵߺ-ࠕࠚࠤࠨ࠰-ࡘ࡞‏יִײַ-ﬨשׁ-ﭏ]"),j=new RegExp("[؈؋؍؛-ي٭-ٯٱ-ەۥ-ۦۮ-ۯۺ-܍ܐܒ-ܯݍ-ޥޱﭐ-ﴽﵐ-﷼ﹰ-ﻼ]"),k={start:"end",end:"start",center:"center",middle:"middle"}},function(a,b,c){function d(){function a(a){return i.has(a)&&i.get(a)}return a.has=function(a){return i.has(a)},a}function e(a,b){if(a&&a.qNumFormat&&["D","T","TS","IV"].indexOf(a.qNumFormat.qType)!==-1)return d("q")("time")(a.qNumFormat.qFmt,a.qNumFormat.qType,b);var c="#",e=b?b.qThousandSep:",",f=b?b.qDecimalSep:".",g="U",h=a&&!!a.qIsAutoFormat;return a&&a.qNumFormat&&(c=a.qNumFormat.qFmt||c,e=a.qNumFormat.qThou||e,f=a.qNumFormat.qDec||f,g=a.qNumFormat.qType||g,h=h&&["M"].indexOf(a.qNumFormat.qType)===-1),h&&(c="#"+f+"##A"),d("q")("number")(c,e,f,g,b)}var f=c(3),g=c(262),h=c(98);b.a=d,b.b=e;var i=c.i(f.a)();i.add("number",g.a),i.add("time",h.a)},function(a,b,c){function d(a){return new Date(1899,11,30+Math.floor(a),0,0,0,864e5*(a-Math.floor(a)))}function e(a){function b(a){return h!==g.INTERVAL?d(a):a}function e(a){return a=b(a),j.format(a)}var h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"TS",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,j=c.i(f.a)(i,a,h);return e.format=function(a,c){return c=b(c),j.format(c,a)},e.locale=function(b){return j=c.i(f.a)(b,a,h),this},e.qtype=function(a){return void 0!==a&&(h=a),h},e}var f=c(263);c.d(b,"b",function(){return g}),b.a=e;var g={AUTO:"U",INTEGER:"I",NUMBER:"R",FIXED_TO:"F",MONEY:"M",DATE:"D",TIME:"T",DATE_TIME:"TS",INTERVAL:"IV"}},function(a,b,c){var d=c(19),e=c(100),f=c(96);c.d(b,"a",function(){return h}),c.d(b,"b",function(){return i}),c.d(b,"c",function(){return k}),c.d(b,"d",function(){return j});var g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},h="http://www.w3.org/2000/svg",i=function(a,b){if(!a||"string"!=typeof a)throw new Error("Invalid type: "+a);var c=b.ownerDocument.createElementNS(h,"container"===a?"g":a);return b.appendChild(c),c},j=function(a){a.parentNode&&a.parentNode.removeChild(a)},k=function(a,b){for(var h in b.attrs)if("text"===h){a.textContent=c.i(e.a)(b.attrs,d.a);var i=c.i(f.a)(b.attrs.text);"rtl"===i&&(a.setAttribute("direction","rtl"),a.setAttribute("dir","rtl"),a.setAttribute("text-anchor",c.i(f.b)(a.getAttribute("text-anchor"),i)))}else a.setAttribute(h,b.attrs[h]);if("string"==typeof b.data||"number"==typeof b.data||"boolean"==typeof b.data)a.setAttribute("data",b.data);else if("object"===g(b.data)&&null!==b.data)for(var j in b.data)"string"!=typeof b.data[j]&&"number"!=typeof b.data[j]&&"boolean"!=typeof b.data[j]||a.setAttribute("data-"+j,b.data[j])}},function(a,b,c){function d(a,b){var c=a.text,d=a["font-size"],e=a["font-family"],f=a.maxWidth;c="string"==typeof c?c:c.toString();for(var g=b({text:c,fontSize:d,fontFamily:e}).width,h=-1;g>f&&"…"!==c;)h=h===-1?c.length-1:h-1,c=c.substr(0,h),c+="…",g=b({text:c,fontSize:d,fontFamily:e}).width;return c}b.a=d},function(a,b,c){var d=c(40),e=c(259),f=c(41),g=c(97),h=c(258);c.i(d.a)("q",e.a),c.i(f.a)("q",g.a);var i={brush:h.a};b.a=i},function(a,b,c){var d=c(44),e=c(276),f=c(266),g=c(273);d.b.register("svg",e.a),d.b.register("canvas",f.a),d.b.register("dom",g.a)},function(a,b,c){var d=c(48);c.d(b,"a",function(){return f}),c.d(b,"b",function(){return g});var e,f,g;!function(a){e=c.i(d.a)(a),f=e.format,g=e.formatPrefix,e}({decimal:".",thousands:",",grouping:[3],currency:["$",""]})},function(a,b,c){b.a=function(a,b){a=a.toPrecision(b);a:for(var c,d=a.length,e=1,f=-1;e<d;++e)switch(a[e]){case".":f=c=e;break;case"0":0===f&&(f=e),c=e;break;case"e":break a;default:f>0&&(f=0)}return f>0?a.slice(0,f)+a.slice(c+1):a}},function(a,b,c){b.a=function(a,b){return function(c,d){for(var e=c.length,f=[],g=0,h=a[0],i=0;e>0&&h>0&&(i+h+1>d&&(h=Math.max(1,d-i)),f.push(c.substring(e-=h,e+h)),!((i+=h+1)>d));)h=a[g=(g+1)%a.length];return f.reverse().join(b)}}},function(a,b,c){var d=c(27);b.a=function(a,b){var e=c.i(d.a)(a,b);if(!e)return a+"";var f=e[0],g=e[1];return g<0?"0."+new Array(-g).join("0")+f:f.length>g+1?f.slice(0,g+1)+"."+f.slice(g+1):f+new Array(g-f.length+2).join("0")}},function(a,b,c){var d=c(20);b.a=function(a){return Math.max(0,-c.i(d.a)(Math.abs(a)))}},function(a,b,c){var d=c(20);b.a=function(a,b){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(c.i(d.a)(b)/3)))-c.i(d.a)(Math.abs(a)))}},function(a,b,c){var d=c(20);b.a=function(a,b){return a=Math.abs(a),b=Math.abs(b)-a,Math.max(0,c.i(d.a)(b)-c.i(d.a)(a))+1}},function(a,b,c){function d(a){if(a instanceof f)return new f(a.h,a.s,a.l,a.opacity);a instanceof h.a||(a=c.i(h.b)(a));var b=a.r/255,d=a.g/255,e=a.b/255,g=(q*e+o*b-p*d)/(q+o-p),j=e-g,k=(n*(d-g)-l*j)/m,r=Math.sqrt(k*k+j*j)/(n*g*(1-g)),s=r?Math.atan2(k,j)*i.a-120:NaN;return new f(s<0?s+360:s,r,g,a.opacity)}function e(a,b,c,e){return 1===arguments.length?d(a):new f(a,b,c,null==e?1:e)}function f(a,b,c,d){this.h=+a,this.s=+b,this.l=+c,this.opacity=+d}var g=c(29),h=c(28),i=c(49);b.a=e;var j=-.14861,k=1.78277,l=-.29227,m=-.90649,n=1.97294,o=n*m,p=n*k,q=k*l-m*j;c.i(g.a)(f,e,c.i(g.b)(h.c,{brighter:function(a){return a=null==a?h.d:Math.pow(h.d,a),new f(this.h,this.s,this.l*a,this.opacity)},darker:function(a){return a=null==a?h.e:Math.pow(h.e,a),new f(this.h,this.s,this.l*a,this.opacity)},rgb:function(){var a=isNaN(this.h)?0:(this.h+120)*i.b,b=+this.l,c=isNaN(this.s)?0:this.s*b*(1-b),d=Math.cos(a),e=Math.sin(a);return new h.a(255*(b+c*(j*d+k*e)),255*(b+c*(l*d+m*e)),255*(b+c*(n*d)),this.opacity)}}))},function(a,b,c){function d(a){if(a instanceof f)return new f(a.l,a.a,a.b,a.opacity);if(a instanceof m){var b=a.h*p.b;return new f(a.l,Math.cos(b)*a.c,Math.sin(b)*a.c,a.opacity)}a instanceof o.a||(a=c.i(o.b)(a));var d=j(a.r),e=j(a.g),h=j(a.b),i=g((.4124564*d+.3575761*e+.1804375*h)/q),k=g((.2126729*d+.7151522*e+.072175*h)/r);return new f(116*k-16,500*(i-k),200*(k-g((.0193339*d+.119192*e+.9503041*h)/s)),a.opacity)}function e(a,b,c,e){return 1===arguments.length?d(a):new f(a,b,c,null==e?1:e)}function f(a,b,c,d){this.l=+a,this.a=+b,this.b=+c,this.opacity=+d}function g(a){return a>w?Math.pow(a,1/3):a/v+t}function h(a){return a>u?a*a*a:v*(a-t)}function i(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function j(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function k(a){if(a instanceof m)return new m(a.h,a.c,a.l,a.opacity);a instanceof f||(a=d(a));var b=Math.atan2(a.b,a.a)*p.a;return new m(b<0?b+360:b,Math.sqrt(a.a*a.a+a.b*a.b),a.l,a.opacity)}function l(a,b,c,d){return 1===arguments.length?k(a):new m(a,b,c,null==d?1:d)}function m(a,b,c,d){this.h=+a,this.c=+b,this.l=+c,this.opacity=+d}var n=c(29),o=c(28),p=c(49);b.b=e,b.a=l;var q=.95047,r=1,s=1.08883,t=4/29,u=6/29,v=3*u*u,w=u*u*u;c.i(n.a)(f,e,c.i(n.b)(o.c,{brighter:function(a){return new f(this.l+18*(null==a?1:a),this.a,this.b,this.opacity)},darker:function(a){return new f(this.l-18*(null==a?1:a),this.a,this.b,this.opacity)},rgb:function(){var a=(this.l+16)/116,b=isNaN(this.a)?a:a+this.a/500,c=isNaN(this.b)?a:a-this.b/200;return a=r*h(a),b=q*h(b),c=s*h(c),new o.a(i(3.2404542*b-1.5371385*a-.4985314*c),i(-.969266*b+1.8760108*a+.041556*c),i(.0556434*b-.2040259*a+1.0572252*c),this.opacity)}})),c.i(n.a)(m,l,c.i(n.b)(o.c,{brighter:function(a){return new m(this.h,this.c,this.l+18*(null==a?1:a),this.opacity)},darker:function(a){return new m(this.h,this.c,this.l-18*(null==a?1:a),this.opacity)},rgb:function(){return d(this).rgb()}}))},function(a,b,c){function d(a){return function b(d){function g(b,g){var h=a((b=c.i(e.a)(b)).h,(g=c.i(e.a)(g)).h),i=c.i(f.a)(b.s,g.s),j=c.i(f.a)(b.l,g.l),k=c.i(f.a)(b.opacity,g.opacity);return function(a){return b.h=h(a),b.s=i(a),b.l=j(Math.pow(a,d)),b.opacity=k(a),b+""}}return d=+d,g.gamma=b,g}(1)}var e=c(11),f=c(14);c.d(b,"a",function(){return g});var g=(d(f.b),d(f.a))},function(a,b,c){function d(a){return function(b,d){var g=a((b=c.i(e.b)(b)).h,(d=c.i(e.b)(d)).h),h=c.i(f.a)(b.c,d.c),i=c.i(f.a)(b.l,d.l),j=c.i(f.a)(b.opacity,d.opacity);return function(a){return b.h=g(a),b.c=h(a),b.l=i(a),b.opacity=j(a),b+""}}}var e=c(11),f=c(14);d(f.b),d(f.a)},function(a,b,c){function d(a){return function(b,d){var g=a((b=c.i(e.d)(b)).h,(d=c.i(e.d)(d)).h),h=c.i(f.a)(b.s,d.s),i=c.i(f.a)(b.l,d.l),j=c.i(f.a)(b.opacity,d.opacity);return function(a){return b.h=g(a),b.s=h(a),b.l=i(a),b.opacity=j(a),b+""}}}var e=c(11),f=c(14);d(f.b),d(f.a)},function(a,b,c){c(11),c(14)},function(a,b,c){},function(a,b,c){b.a=function(a,b){return a=+a,b-=a,function(c){return Math.round(a+b*c)}}},function(a,b,c){c.d(b,"a",function(){return e});var d=180/Math.PI,e={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};b.b=function(a,b,c,e,f,g){var h,i,j;return(h=Math.sqrt(a*a+b*b))&&(a/=h,b/=h),(j=a*c+b*e)&&(c-=a*j,e-=b*j),(i=Math.sqrt(c*c+e*e))&&(c/=i,e/=i,j/=i),a*e<b*c&&(a=-a,b=-b,j=-j,h=-h),{translateX:f,translateY:g,rotate:Math.atan2(b,a)*d,skewX:Math.atan(j)*d,scaleX:h,scaleY:i}}},function(a,b,c){function d(a,b,d,f){function g(a){return a.length?a.pop()+" ":""}function h(a,f,g,h,i,j){if(a!==g||f!==h){var k=i.push("translate(",null,b,null,d);j.push({i:k-4,x:c.i(e.a)(a,g)},{i:k-2,x:c.i(e.a)(f,h)})}else(g||h)&&i.push("translate("+g+b+h+d)}function i(a,b,d,h){a!==b?(a-b>180?b+=360:b-a>180&&(a+=360),h.push({i:d.push(g(d)+"rotate(",null,f)-2,x:c.i(e.a)(a,b)})):b&&d.push(g(d)+"rotate("+b+f)}function j(a,b,d,h){a!==b?h.push({i:d.push(g(d)+"skewX(",null,f)-2,x:c.i(e.a)(a,b)}):b&&d.push(g(d)+"skewX("+b+f)}function k(a,b,d,f,h,i){if(a!==d||b!==f){var j=h.push(g(h)+"scale(",null,",",null,")");i.push({i:j-4,x:c.i(e.a)(a,d)},{i:j-2,x:c.i(e.a)(b,f)})}else 1===d&&1===f||h.push(g(h)+"scale("+d+","+f+")")}return function(b,c){var d=[],e=[];return b=a(b),c=a(c),h(b.translateX,b.translateY,c.translateX,c.translateY,d,e),i(b.rotate,c.rotate,d,e),j(b.skewX,c.skewX,d,e),k(b.scaleX,b.scaleY,c.scaleX,c.scaleY,d,e),b=c=null,function(a){for(var b,c=-1,f=e.length;++c<f;)d[(b=e[c]).i]=b.x(a);return d.join("")}}}var e=c(21),f=c(120);d(f.a,"px, ","px)","deg)"),d(f.b,", ",")",")")},function(a,b,c){function d(a){return"none"===a?f.a:(g||(g=document.createElement("DIV"),h=document.documentElement,i=document.defaultView),g.style.transform=a,a=i.getComputedStyle(h.appendChild(g),null).getPropertyValue("transform"),h.removeChild(g),a=a.slice(7,-1).split(","),c.i(f.b)(+a[0],+a[1],+a[2],+a[3],+a[4],+a[5]))}function e(a){return null==a?f.a:(j||(j=document.createElementNS("http://www.w3.org/2000/svg","g")),j.setAttribute("transform",a),(a=j.transform.baseVal.consolidate())?(a=a.matrix,c.i(f.b)(a.a,a.b,a.c,a.d,a.e,a.f)):f.a)}var f=c(118);b.a=d,b.b=e;var g,h,i,j},function(a,b,c){Math.SQRT2},function(a,b,c){b.a=function(a){return function(){return a}}},function(a,b,c){},function(a,b,c){c(57),c(58),c(122),c(61),c(125),c(65),c(64)},function(a,b,c){b.a=function(a){return a}},function(a,b,c){},function(a,b,c){c(15)},function(a,b,c){c(12),c(15),c(32)},function(a,b,c){},function(a,b,c){},function(a,b,c){},function(a,b,c){c(12)},function(a,b,c){},function(a,b,c){},function(a,b,c){c(57),c(12),c(15),c(32)},function(a,b,c){c(60)},function(a,b,c){c(66)},function(a,b,c){var d=(c(141),c(142),c(33));c.d(b,"a",function(){return d.a});c(140),c(143),c(139)},function(a,b,c){},function(a,b,c){},function(a,b,c){c(33)},function(a,b,c){function d(){}function e(a,b){var c=new d;if(a instanceof d)a.each(function(a){c.add(a)});else if(a){var e=-1,f=a.length;if(null==b)for(;++e<f;)c.add(a[e]);else for(;++e<f;)c.add(b(a[e],e,a))}return c}var f=c(33),g=f.a.prototype;d.prototype=e.prototype={constructor:d,has:g.has,add:function(a){return a+="",this[f.b+a]=a,this},remove:g.remove,clear:g.clear,values:g.keys,size:g.size,empty:g.empty,each:g.each}},function(a,b,c){},function(a,b,c){function d(a){if(a instanceof f)return new f(a.h,a.s,a.l,a.opacity);a instanceof h.a||(a=c.i(h.b)(a));var b=a.r/255,d=a.g/255,e=a.b/255,g=(q*e+o*b-p*d)/(q+o-p),j=e-g,k=(n*(d-g)-l*j)/m,r=Math.sqrt(k*k+j*j)/(n*g*(1-g)),s=r?Math.atan2(k,j)*i.a-120:NaN;return new f(s<0?s+360:s,r,g,a.opacity)}function e(a,b,c,e){return 1===arguments.length?d(a):new f(a,b,c,null==e?1:e)}function f(a,b,c,d){this.h=+a,this.s=+b,this.l=+c,this.opacity=+d}var g=c(35),h=c(34),i=c(69);b.a=e;var j=-.14861,k=1.78277,l=-.29227,m=-.90649,n=1.97294,o=n*m,p=n*k,q=k*l-m*j;c.i(g.a)(f,e,c.i(g.b)(h.c,{brighter:function(a){return a=null==a?h.d:Math.pow(h.d,a),new f(this.h,this.s,this.l*a,this.opacity)},darker:function(a){return a=null==a?h.e:Math.pow(h.e,a),new f(this.h,this.s,this.l*a,this.opacity)},rgb:function(){var a=isNaN(this.h)?0:(this.h+120)*i.b,b=+this.l,c=isNaN(this.s)?0:this.s*b*(1-b),d=Math.cos(a),e=Math.sin(a);return new h.a(255*(b+c*(j*d+k*e)),255*(b+c*(l*d+m*e)),255*(b+c*(n*d)),this.opacity)}}))},function(a,b,c){function d(a){if(a instanceof f)return new f(a.l,a.a,a.b,a.opacity);if(a instanceof m){var b=a.h*p.b;return new f(a.l,Math.cos(b)*a.c,Math.sin(b)*a.c,a.opacity)}a instanceof o.a||(a=c.i(o.b)(a));var d=j(a.r),e=j(a.g),h=j(a.b),i=g((.4124564*d+.3575761*e+.1804375*h)/q),k=g((.2126729*d+.7151522*e+.072175*h)/r);return new f(116*k-16,500*(i-k),200*(k-g((.0193339*d+.119192*e+.9503041*h)/s)),a.opacity)}function e(a,b,c,e){return 1===arguments.length?d(a):new f(a,b,c,null==e?1:e)}function f(a,b,c,d){this.l=+a,this.a=+b,this.b=+c,this.opacity=+d}function g(a){return a>w?Math.pow(a,1/3):a/v+t}function h(a){return a>u?a*a*a:v*(a-t)}function i(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function j(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function k(a){if(a instanceof m)return new m(a.h,a.c,a.l,a.opacity);a instanceof f||(a=d(a));var b=Math.atan2(a.b,a.a)*p.a;return new m(b<0?b+360:b,Math.sqrt(a.a*a.a+a.b*a.b),a.l,a.opacity)}function l(a,b,c,d){return 1===arguments.length?k(a):new m(a,b,c,null==d?1:d)}function m(a,b,c,d){this.h=+a,this.c=+b,this.l=+c,this.opacity=+d}var n=c(35),o=c(34),p=c(69),q=.95047,r=1,s=1.08883,t=4/29,u=6/29,v=3*u*u,w=u*u*u;c.i(n.a)(f,e,c.i(n.b)(o.c,{brighter:function(a){return new f(this.l+18*(null==a?1:a),this.a,this.b,this.opacity)},darker:function(a){return new f(this.l-18*(null==a?1:a),this.a,this.b,this.opacity)},rgb:function(){var a=(this.l+16)/116,b=isNaN(this.a)?a:a+this.a/500,c=isNaN(this.b)?a:a-this.b/200;return a=r*h(a),b=q*h(b),c=s*h(c),new o.a(i(3.2404542*b-1.5371385*a-.4985314*c),i(-.969266*b+1.8760108*a+.041556*c),i(.0556434*b-.2040259*a+1.0572252*c),this.opacity)}})),c.i(n.a)(m,l,c.i(n.b)(o.c,{brighter:function(a){return new m(this.h,this.c,this.l+18*(null==a?1:a),this.opacity)},darker:function(a){return new m(this.h,this.c,this.l-18*(null==a?1:a),this.opacity)},rgb:function(){return d(this).rgb()}}))},function(a,b,c){var d=c(1),e=c(5),f=c.i(d.a)(function(a){a.setHours(0,0,0,0)},function(a,b){a.setDate(a.getDate()+b)},function(a,b){return(b-a-(b.getTimezoneOffset()-a.getTimezoneOffset())*e.d)/e.b},function(a){return a.getDate()-1});b.a=f;f.range},function(a,b,c){var d=c(1),e=c(5),f=c.i(d.a)(function(a){var b=a.getTimezoneOffset()*e.d%e.c;b<0&&(b+=e.c),a.setTime(Math.floor((+a-b)/e.c)*e.c+b)},function(a,b){a.setTime(+a+b*e.c)},function(a,b){return(b-a)/e.c},function(a){return a.getHours()});b.a=f;f.range},function(a,b,c){var d=c(1),e=c.i(d.a)(function(){},function(a,b){a.setTime(+a+b)},function(a,b){return b-a});e.every=function(a){return a=Math.floor(a),isFinite(a)&&a>0?a>1?c.i(d.a)(function(b){b.setTime(Math.floor(b/a)*a)},function(b,c){b.setTime(+b+c*a)},function(b,c){return(c-b)/a}):e:null},b.a=e;e.range},function(a,b,c){var d=c(1),e=c(5),f=c.i(d.a)(function(a){a.setTime(Math.floor(a/e.d)*e.d)},function(a,b){a.setTime(+a+b*e.d)},function(a,b){return(b-a)/e.d},function(a){return a.getMinutes()});b.a=f;f.range},function(a,b,c){var d=c(1),e=c.i(d.a)(function(a){a.setDate(1),a.setHours(0,0,0,0)},function(a,b){a.setMonth(a.getMonth()+b)},function(a,b){return b.getMonth()-a.getMonth()+12*(b.getFullYear()-a.getFullYear())},function(a){return a.getMonth()});b.a=e;e.range},function(a,b,c){var d=c(1),e=c(5),f=c.i(d.a)(function(a){a.setTime(Math.floor(a/e.e)*e.e)},function(a,b){a.setTime(+a+b*e.e)},function(a,b){return(b-a)/e.e},function(a){return a.getUTCSeconds()});b.a=f;f.range},function(a,b,c){var d=c(1),e=c(5),f=c.i(d.a)(function(a){a.setUTCHours(0,0,0,0)},function(a,b){a.setUTCDate(a.getUTCDate()+b)},function(a,b){return(b-a)/e.b},function(a){return a.getUTCDate()-1});b.a=f;f.range},function(a,b,c){var d=c(1),e=c(5),f=c.i(d.a)(function(a){a.setUTCMinutes(0,0,0)},function(a,b){a.setTime(+a+b*e.c)},function(a,b){return(b-a)/e.c},function(a){return a.getUTCHours()});b.a=f;f.range},function(a,b,c){var d=c(1),e=c(5),f=c.i(d.a)(function(a){a.setUTCSeconds(0,0)},function(a,b){a.setTime(+a+b*e.d)},function(a,b){return(b-a)/e.d},function(a){return a.getUTCMinutes()});b.a=f;f.range},function(a,b,c){var d=c(1),e=c.i(d.a)(function(a){a.setUTCDate(1),a.setUTCHours(0,0,0,0)},function(a,b){a.setUTCMonth(a.getUTCMonth()+b)},function(a,b){return b.getUTCMonth()-a.getUTCMonth()+12*(b.getUTCFullYear()-a.getUTCFullYear())},function(a){return a.getUTCMonth()});b.a=e;e.range},function(a,b,c){function d(a){return c.i(e.a)(function(b){b.setUTCDate(b.getUTCDate()-(b.getUTCDay()+7-a)%7),b.setUTCHours(0,0,0,0)},function(a,b){a.setUTCDate(a.getUTCDate()+7*b)},function(a,b){return(b-a)/f.a})}var e=c(1),f=c(5);c.d(b,"a",function(){return g});var g=d(0),h=d(1),i=d(2),j=d(3),k=d(4),l=d(5),m=d(6);g.range,h.range,i.range,j.range,k.range,l.range,m.range},function(a,b,c){var d=c(1),e=c.i(d.a)(function(a){a.setUTCMonth(0,1),a.setUTCHours(0,0,0,0)},function(a,b){a.setUTCFullYear(a.getUTCFullYear()+b)},function(a,b){return b.getUTCFullYear()-a.getUTCFullYear()},function(a){return a.getUTCFullYear()});e.every=function(a){return isFinite(a=Math.floor(a))&&a>0?c.i(d.a)(function(b){b.setUTCFullYear(Math.floor(b.getUTCFullYear()/a)*a),b.setUTCMonth(0,1),b.setUTCHours(0,0,0,0)},function(b,c){b.setUTCFullYear(b.getUTCFullYear()+c*a)}):null},b.a=e;e.range},function(a,b,c){function d(a){return c.i(e.a)(function(b){b.setDate(b.getDate()-(b.getDay()+7-a)%7),b.setHours(0,0,0,0)},function(a,b){a.setDate(a.getDate()+7*b)},function(a,b){return(b-a-(b.getTimezoneOffset()-a.getTimezoneOffset())*f.d)/f.a})}var e=c(1),f=c(5);c.d(b,"a",function(){return g});var g=d(0),h=d(1),i=d(2),j=d(3),k=d(4),l=d(5),m=d(6);g.range,h.range,i.range,j.range,k.range,l.range,m.range},function(a,b,c){var d=c(1),e=c.i(d.a)(function(a){a.setMonth(0,1),a.setHours(0,0,0,0)},function(a,b){a.setFullYear(a.getFullYear()+b)},function(a,b){return b.getFullYear()-a.getFullYear()},function(a){return a.getFullYear()});e.every=function(a){return isFinite(a=Math.floor(a))&&a>0?c.i(d.a)(function(b){b.setFullYear(Math.floor(b.getFullYear()/a)*a),b.setMonth(0,1),b.setHours(0,0,0,0)},function(b,c){b.setFullYear(b.getFullYear()+c*a)}):null},b.a=e;e.range},function(a,b,c){function d(){function a(){var a=i().length,d=k[1]<k[0],f=k[d-0],h=k[1-d];b=(h-f)/Math.max(1,a-m+2*n),l&&(b=Math.floor(b)),f+=(h-f-b*(a-m))*o,g=b*(1-m),l&&(f=Math.round(f),g=Math.round(g));var p=c.i(e.g)(a).map(function(a){return f+b*a});return j(d?p.reverse():p)}var b,g,h=c.i(f.a)().unknown(void 0),i=h.domain,j=h.range,k=[0,1],l=!1,m=0,n=0,o=.5;return delete h.unknown,h.domain=function(b){return arguments.length?(i(b),a()):i()},h.range=function(b){return arguments.length?(k=[+b[0],+b[1]],a()):k.slice()},h.rangeRound=function(b){return k=[+b[0],+b[1]],l=!0,a()},h.bandwidth=function(){return g},h.step=function(){return b},h.round=function(b){return arguments.length?(l=!!b,a()):l},h.padding=function(b){return arguments.length?(m=n=Math.max(0,Math.min(1,b)),a()):m},h.paddingInner=function(b){return arguments.length?(m=Math.max(0,Math.min(1,b)),a()):m},h.paddingOuter=function(b){return arguments.length?(n=Math.max(0,Math.min(1,b)),a()):n},h.align=function(b){return arguments.length?(o=Math.max(0,Math.min(1,b)),a()):o},h.copy=function(){return d().domain(i()).range(k).round(l).paddingInner(m).paddingOuter(n).align(o)},a()}var e=c(4),f=c(73);b.a=d},function(a,b,c){var d=c(16);c.i(d.a)("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf")},function(a,b,c){var d=c(16);c.i(d.a)("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5")},function(a,b,c){var d=c(16);c.i(d.a)("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6")},function(a,b,c){var d=c(16);c.i(d.a)("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9")},function(a,b,c){var d=c(68),e=c(10);c.i(e.d)(c.i(d.a)(300,.5,0),c.i(d.a)(-240,.5,1))},function(a,b,c){c(8),c(17),c(72)},function(a,b,c){c(4),c(26),c(36),c(71),c(23)},function(a,b,c){c(36),c(17),c(23)},function(a,b,c){c(4),c(8)},function(a,b,c){c(4),c(8),c(17)},function(a,b,c){var d=c(68),e=c(10);c.i(e.d)(c.i(d.a)(-100,.75,.35),c.i(d.a)(80,1.5,.8)),c.i(e.d)(c.i(d.a)(260,.75,.35),c.i(d.a)(80,1.5,.8)),c.i(d.a)()},function(a,b,c){c(17)},function(a,b,c){function d(){function a(a){if(a<=a)return g[c.i(e.c)(b,a,0,h)]}var b=[.5],g=[0,1],h=1;return a.domain=function(c){return arguments.length?(b=f.b.call(c),h=Math.min(b.length,g.length-1),a):b.slice()},a.range=function(c){return arguments.length?(g=f.b.call(c),h=Math.min(b.length,g.length-1),a):g.slice()},a.invertExtent=function(a){var c=g.indexOf(a);return[b[c-1],b[c]]},a.copy=function(){return d().domain(b).range(g)},a}var e=c(4),f=c(8);b.a=d},function(a,b,c){var d=c(4),e=c(26);b.a=function(a,b,f){var g,h=a[0],i=a[a.length-1],j=c.i(d.b)(h,i,null==b?10:b);switch(f=c.i(e.b)(null==f?",f":f),f.type){case"s":var k=Math.max(Math.abs(h),Math.abs(i));return null!=f.precision||isNaN(g=c.i(e.c)(j,k))||(f.precision=g),c.i(e.d)(f,k);case"":case"e":case"g":case"p":case"r":null!=f.precision||isNaN(g=c.i(e.e)(j,Math.max(Math.abs(h),Math.abs(i))))||(f.precision=g-("e"===f.type));break;case"f":case"%":null!=f.precision||isNaN(g=c.i(e.f)(j))||(f.precision=g-2*("%"===f.type))}return c.i(e.g)(f)}},function(a,b,c){c(74),c(37),c(70)},function(a,b,c){function d(a){var b=a.length;return function(c){return a[Math.max(0,Math.min(b-1,Math.floor(c*b)))]}}var e=c(16);b.a=d(c.i(e.a)("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));d(c.i(e.a)("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),d(c.i(e.a)("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),d(c.i(e.a)("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"))},function(a,b,c){var d=(c(2),c(180),c(183),c(181),c(179),c(178));c.d(b,"a",function(){return d.a});var e=c(190);c.d(b,"c",function(){return e.a}),c.d(b,"d",function(){return e.b});var f=(c(182),c(191))
;c.d(b,"b",function(){return f.a});var g=(c(186),c(185),c(184));c.d(b,"e",function(){return g.a});var h=c(188);c.d(b,"g",function(){return h.a}),c.d(b,"h",function(){return h.b});var i=(c(187),c(189));c.d(b,"f",function(){return i.a})},function(a,b,c){var d=c(2),e=c(6),f=c.i(d.a)(function(a){a.setHours(0,0,0,0)},function(a,b){a.setDate(a.getDate()+b)},function(a,b){return(b-a-(b.getTimezoneOffset()-a.getTimezoneOffset())*e.d)/e.b},function(a){return a.getDate()-1});b.a=f;f.range},function(a,b,c){var d=c(2),e=c(6),f=c.i(d.a)(function(a){var b=a.getTimezoneOffset()*e.d%e.c;b<0&&(b+=e.c),a.setTime(Math.floor((+a-b)/e.c)*e.c+b)},function(a,b){a.setTime(+a+b*e.c)},function(a,b){return(b-a)/e.c},function(a){return a.getHours()});f.range},function(a,b,c){var d=c(2),e=c.i(d.a)(function(){},function(a,b){a.setTime(+a+b)},function(a,b){return b-a});e.every=function(a){return a=Math.floor(a),isFinite(a)&&a>0?a>1?c.i(d.a)(function(b){b.setTime(Math.floor(b/a)*a)},function(b,c){b.setTime(+b+c*a)},function(b,c){return(c-b)/a}):e:null};e.range},function(a,b,c){var d=c(2),e=c(6),f=c.i(d.a)(function(a){a.setTime(Math.floor(a/e.d)*e.d)},function(a,b){a.setTime(+a+b*e.d)},function(a,b){return(b-a)/e.d},function(a){return a.getMinutes()});f.range},function(a,b,c){var d=c(2),e=c.i(d.a)(function(a){a.setDate(1),a.setHours(0,0,0,0)},function(a,b){a.setMonth(a.getMonth()+b)},function(a,b){return b.getMonth()-a.getMonth()+12*(b.getFullYear()-a.getFullYear())},function(a){return a.getMonth()});e.range},function(a,b,c){var d=c(2),e=c(6),f=c.i(d.a)(function(a){a.setTime(Math.floor(a/e.e)*e.e)},function(a,b){a.setTime(+a+b*e.e)},function(a,b){return(b-a)/e.e},function(a){return a.getUTCSeconds()});f.range},function(a,b,c){var d=c(2),e=c(6),f=c.i(d.a)(function(a){a.setUTCHours(0,0,0,0)},function(a,b){a.setUTCDate(a.getUTCDate()+b)},function(a,b){return(b-a)/e.b},function(a){return a.getUTCDate()-1});b.a=f;f.range},function(a,b,c){var d=c(2),e=c(6),f=c.i(d.a)(function(a){a.setUTCMinutes(0,0,0)},function(a,b){a.setTime(+a+b*e.c)},function(a,b){return(b-a)/e.c},function(a){return a.getUTCHours()});f.range},function(a,b,c){var d=c(2),e=c(6),f=c.i(d.a)(function(a){a.setUTCSeconds(0,0)},function(a,b){a.setTime(+a+b*e.d)},function(a,b){return(b-a)/e.d},function(a){return a.getUTCMinutes()});f.range},function(a,b,c){var d=c(2),e=c.i(d.a)(function(a){a.setUTCDate(1),a.setUTCHours(0,0,0,0)},function(a,b){a.setUTCMonth(a.getUTCMonth()+b)},function(a,b){return b.getUTCMonth()-a.getUTCMonth()+12*(b.getUTCFullYear()-a.getUTCFullYear())},function(a){return a.getUTCMonth()});e.range},function(a,b,c){function d(a){return c.i(e.a)(function(b){b.setUTCDate(b.getUTCDate()-(b.getUTCDay()+7-a)%7),b.setUTCHours(0,0,0,0)},function(a,b){a.setUTCDate(a.getUTCDate()+7*b)},function(a,b){return(b-a)/f.a})}var e=c(2),f=c(6);c.d(b,"a",function(){return g}),c.d(b,"b",function(){return h});var g=d(0),h=d(1),i=d(2),j=d(3),k=d(4),l=d(5),m=d(6);g.range,h.range,i.range,j.range,k.range,l.range,m.range},function(a,b,c){var d=c(2),e=c.i(d.a)(function(a){a.setUTCMonth(0,1),a.setUTCHours(0,0,0,0)},function(a,b){a.setUTCFullYear(a.getUTCFullYear()+b)},function(a,b){return b.getUTCFullYear()-a.getUTCFullYear()},function(a){return a.getUTCFullYear()});e.every=function(a){return isFinite(a=Math.floor(a))&&a>0?c.i(d.a)(function(b){b.setUTCFullYear(Math.floor(b.getUTCFullYear()/a)*a),b.setUTCMonth(0,1),b.setUTCHours(0,0,0,0)},function(b,c){b.setUTCFullYear(b.getUTCFullYear()+c*a)}):null},b.a=e;e.range},function(a,b,c){function d(a){return c.i(e.a)(function(b){b.setDate(b.getDate()-(b.getDay()+7-a)%7),b.setHours(0,0,0,0)},function(a,b){a.setDate(a.getDate()+7*b)},function(a,b){return(b-a-(b.getTimezoneOffset()-a.getTimezoneOffset())*f.d)/f.a})}var e=c(2),f=c(6);c.d(b,"a",function(){return g}),c.d(b,"b",function(){return h});var g=d(0),h=d(1),i=d(2),j=d(3),k=d(4),l=d(5),m=d(6);g.range,h.range,i.range,j.range,k.range,l.range,m.range},function(a,b,c){var d=c(2),e=c.i(d.a)(function(a){a.setMonth(0,1),a.setHours(0,0,0,0)},function(a,b){a.setFullYear(a.getFullYear()+b)},function(a,b){return b.getFullYear()-a.getFullYear()},function(a){return a.getFullYear()});e.every=function(a){return isFinite(a=Math.floor(a))&&a>0?c.i(d.a)(function(b){b.setFullYear(Math.floor(b.getFullYear()/a)*a),b.setMonth(0,1),b.setHours(0,0,0,0)},function(b,c){b.setFullYear(b.getFullYear()+c*a)}):null},b.a=e;e.range},function(a,b,c){function d(a){var b=new Date(a);return isNaN(b)?null:b}var e=c(75),f=c(38);+new Date("2000-01-01T00:00:00.000Z")||c.i(f.a)(e.a)},function(a,b){function c(){c.init.call(this)}var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},e={};e.isObject=function(a){return"object"===(void 0===a?"undefined":d(a))&&null!==a},e.isNumber=function(a){return"number"==typeof a},e.isUndefined=function(a){return void 0===a},e.isFunction=function(a){return"function"==typeof a},a.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0,c.defaultMaxListeners=10,c.init=function(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(a){if(!e.isNumber(a)||a<0||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},c.prototype.emit=function(a){var b,c,d,f,g,h;if(this._events||(this._events={}),"error"===a&&!this._events.error)throw b=arguments[1],b instanceof Error?b:Error('Uncaught, unspecified "error" event.');if(c=this._events[a],e.isUndefined(c))return!1;if(e.isFunction(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(d=arguments.length,f=new Array(d-1),g=1;g<d;g++)f[g-1]=arguments[g];c.apply(this,f)}else if(e.isObject(c)){for(d=arguments.length,f=new Array(d-1),g=1;g<d;g++)f[g-1]=arguments[g];for(h=c.slice(),d=h.length,g=0;g<d;g++)h[g].apply(this,f)}return!0},c.prototype.addListener=function(a,b){var d;if(!e.isFunction(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e.isFunction(b.listener)?b.listener:b),this._events[a]?e.isObject(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,e.isObject(this._events[a])&&!this._events[a].warned){var d;d=e.isUndefined(this._maxListeners)?c.defaultMaxListeners:this._maxListeners,d&&d>0&&this._events[a].length>d&&(this._events[a].warned=!0,e.isFunction(console.error)&&console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),e.isFunction(console.trace)&&console.trace())}return this},c.prototype.on=c.prototype.addListener,c.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e.isFunction(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},c.prototype.removeListener=function(a,b){var c,d,f,g;if(!e.isFunction(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e.isFunction(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(e.isObject(c)){for(g=f;g-- >0;)if(c[g]===b||c[g].listener&&c[g].listener===b){d=g;break}if(d<0)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},c.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e.isFunction(c))this.removeListener(a,c);else if(Array.isArray(c))for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},c.prototype.listeners=function(a){return this._events&&this._events[a]?e.isFunction(this._events[a])?[this._events[a]]:this._events[a].slice():[]},c.listenerCount=function(a,b){return a._events&&a._events[b]?e.isFunction(a._events[b])?1:a._events[b].length:0}},function(a,b,c){var d,e,f;"function"==typeof Symbol&&Symbol.iterator;!function(c,g){e=[],d=g,void 0!==(f="function"==typeof d?d.apply(b,e):d)&&(a.exports=f)}(0,function(){return function(a,b){"use strict";if(!a||isNaN(+b))return b;var c,d,e,f,g,h,i,j,k,l,m=a.length,n=a.search(/[0-9\-\+#]/),o=n>0?a.substring(0,n):"",p=a.split("").reverse().join(""),q=p.search(/[0-9\-\+#]/),r=m-q,s=a.substring(r,r+1),t=r+("."===s||","===s?1:0),u=q>0?a.substring(t,m):"";if(a=a.substring(n,t),b="-"===a.charAt(0)?-b:+b,c=b<0?b=-b:0,d=a.match(/[^\d\-\+#]/g),e=d&&d[d.length-1]||".",f=d&&d[1]&&d[0]||",",a=a.split(e),b=b.toFixed(a[1]&&a[1].length),b=+b+"",h=a[1]&&a[1].lastIndexOf("0"),j=b.split("."),(!j[1]||j[1]&&j[1].length<=h)&&(b=(+b).toFixed(h+1)),k=a[0].split(f),a[0]=k.join(""),(g=a[0]&&a[0].indexOf("0"))>-1)for(;j[0].length<a[0].length-g;)j[0]="0"+j[0];else 0==+j[0]&&(j[0]="");if(b=b.split("."),b[0]=j[0],i=k[1]&&k[k.length-1].length){for(l=b[0],p="",r=l.length%i,m=l.length,t=0;t<m;t++)p+=l.charAt(t),!((t-r+1)%i)&&t<m-i&&(p+=f);b[0]=p}return b[1]=a[1]&&b[1]?e+b[1]:"",d=b.join(""),"0"!==d&&""!==d||(c=!1),o+(c?"-":"")+d+u}})},function(a,b,c){function d(a,b,c){if(a.ns="http://www.w3.org/2000/svg","foreignObject"!==c&&void 0!==b)for(var e=0;e<b.length;++e)d(b[e].data,b[e].children,b[e].sel)}var e=c(78),f=c(77);a.exports=function(a,b,c){var g,h,i,j={};if(void 0!==c?(j=b,f.array(c)?g=c:f.primitive(c)&&(h=c)):void 0!==b&&(f.array(b)?g=b:f.primitive(b)?h=b:j=b),f.array(g))for(i=0;i<g.length;++i)f.primitive(g[i])&&(g[i]=e(void 0,void 0,void 0,g[i]));return"s"===a[0]&&"v"===a[1]&&"g"===a[2]&&d(j,g,a),e(a,j,g,h,void 0)}},function(a,b){function c(a){return document.createElement(a)}function d(a,b){return document.createElementNS(a,b)}function e(a){return document.createTextNode(a)}function f(a,b,c){a.insertBefore(b,c)}function g(a,b){a.removeChild(b)}function h(a,b){a.appendChild(b)}function i(a){return a.parentElement}function j(a){return a.nextSibling}function k(a){return a.tagName}function l(a,b){a.textContent=b}a.exports={createElement:c,createElementNS:d,createTextNode:e,appendChild:h,removeChild:g,insertBefore:f,parentNode:i,nextSibling:j,tagName:k,setTextContent:l}},function(a,b){function c(a,b){var c,d,e=b.elm,f=a.data.class,g=b.data.class;if(f||g){f=f||{},g=g||{};for(d in f)g[d]||e.classList.remove(d);for(d in g)(c=g[d])!==f[d]&&e.classList[c?"add":"remove"](d)}}a.exports={create:c,update:c}},function(a,b){function c(a,b,d){if("function"==typeof a)a.call(b,d,b);else if("object"===(void 0===a?"undefined":g(a)))if("function"==typeof a[0])if(2===a.length)a[0].call(b,a[1],d,b);else{var e=a.slice(1);e.push(d),e.push(b),a[0].apply(b,e)}else for(var f=0;f<a.length;f++)c(a[f])}function d(a,b){var d=a.type,e=b.data.on;e&&e[d]&&c(e[d],b,a)}function e(){return function a(b){d(b,a.vnode)}}function f(a,b){var c,d=a.data.on,f=a.listener,g=a.elm,h=b&&b.data.on,i=b&&b.elm;if(d!==h){if(d&&f)if(h)for(c in d)h[c]||g.removeEventListener(c,f,!1);else for(c in d)g.removeEventListener(c,f,!1);if(h){var j=b.listener=a.listener||e();if(j.vnode=b,d)for(c in h)d[c]||i.addEventListener(c,j,!1);else for(c in h)i.addEventListener(c,j,!1)}}}var g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};a.exports={create:f,update:f,destroy:f}},function(a,b){function c(a,b){var c,d,e=b.elm,f=a.data.props,g=b.data.props;if(f||g){f=f||{},g=g||{};for(c in f)g[c]||delete e[c];for(c in g)d=g[c],f[c]===d||"value"===c&&e[c]===d||(e[c]=d)}}a.exports={create:c,update:c}},function(a,b){function c(a,b,c){h(function(){a[b]=c})}function d(a,b){var d,e,f=b.elm,g=a.data.style,h=b.data.style;if(g||h){g=g||{},h=h||{};var i="delayed"in g;for(e in g)h[e]||(f.style[e]="");for(e in h)if(d=h[e],"delayed"===e)for(e in h.delayed)d=h.delayed[e],i&&d===g.delayed[e]||c(f.style,e,d);else"remove"!==e&&d!==g[e]&&(f.style[e]=d)}}function e(a){var b,c,d=a.elm,e=a.data.style;if(e&&(b=e.destroy))for(c in b)d.style[c]=b[c]}function f(a,b){var c=a.data.style;if(!c||!c.remove)return void b();var d,e,f=a.elm,g=0,h=c.remove,i=0,j=[];for(d in h)j.push(d),f.style[d]=h[d];e=getComputedStyle(f);for(var k=e["transition-property"].split(", ");g<k.length;++g)j.indexOf(k[g])!==-1&&i++;f.addEventListener("transitionend",function(a){a.target===f&&--i,0===i&&b()})}var g="undefined"!=typeof window&&window.requestAnimationFrame||setTimeout,h=function(a){g(function(){g(a)})};a.exports={create:d,update:d,destroy:e,remove:f}},function(a,b,c){function d(a){return void 0===a}function e(a){return void 0!==a}function f(a,b){return a.key===b.key&&a.sel===b.sel}function g(a,b,c){var d,f,g={};for(d=b;d<=c;++d)f=a[d].key,e(f)&&(g[f]=d);return g}function h(a,b){function c(a){var c=a.id?"#"+a.id:"",d=a.className?"."+a.className.split(" ").join("."):"";return i(b.tagName(a).toLowerCase()+c+d,{},[],void 0,a)}function h(a,c){return function(){if(0==--c){var d=b.parentNode(a);b.removeChild(d,a)}}}function n(a,c){var d,f=a.data;e(f)&&e(d=f.hook)&&e(d=d.init)&&(d(a),f=a.data);var g,h=a.children,i=a.sel;if(e(i)){var k=i.indexOf("#"),m=i.indexOf(".",k),o=k>0?k:i.length,p=m>0?m:i.length,q=k!==-1||m!==-1?i.slice(0,Math.min(o,p)):i;if(g=a.elm=e(f)&&e(d=f.ns)?b.createElementNS(d,q):b.createElement(q),o<p&&(g.id=i.slice(o+1,p)),m>0&&(g.className=i.slice(p+1).replace(/\./g," ")),j.array(h))for(d=0;d<h.length;++d)b.appendChild(g,n(h[d],c));else j.primitive(a.text)&&b.appendChild(g,b.createTextNode(a.text));for(d=0;d<v.create.length;++d)v.create[d](l,a);d=a.data.hook,e(d)&&(d.create&&d.create(l,a),d.insert&&c.push(a))}else g=a.elm=b.createTextNode(a.text);return a.elm}function o(a,c,d,e,f,g){for(;e<=f;++e)b.insertBefore(a,n(d[e],g),c)}function p(a){var b,c,d=a.data;if(e(d)){for(e(b=d.hook)&&e(b=b.destroy)&&b(a),b=0;b<v.destroy.length;++b)v.destroy[b](a);if(e(b=a.children))for(c=0;c<a.children.length;++c)p(a.children[c])}}function q(a,c,d,f){for(;d<=f;++d){var g,i,j,k=c[d];if(e(k))if(e(k.sel)){for(p(k),i=v.remove.length+1,j=h(k.elm,i),g=0;g<v.remove.length;++g)v.remove[g](k,j);e(g=k.data)&&e(g=g.hook)&&e(g=g.remove)?g(k,j):j()}else b.removeChild(a,k.elm)}}function r(a,c,e,h){for(var i,j,k,l,m=0,p=0,r=c.length-1,t=c[0],u=c[r],v=e.length-1,w=e[0],x=e[v];m<=r&&p<=v;)d(t)?t=c[++m]:d(u)?u=c[--r]:f(t,w)?(s(t,w,h),t=c[++m],w=e[++p]):f(u,x)?(s(u,x,h),u=c[--r],x=e[--v]):f(t,x)?(s(t,x,h),b.insertBefore(a,t.elm,b.nextSibling(u.elm)),t=c[++m],x=e[--v]):f(u,w)?(s(u,w,h),b.insertBefore(a,u.elm,t.elm),u=c[--r],w=e[++p]):(d(i)&&(i=g(c,m,r)),j=i[w.key],d(j)?(b.insertBefore(a,n(w,h),t.elm),w=e[++p]):(k=c[j],s(k,w,h),c[j]=void 0,b.insertBefore(a,k.elm,t.elm),w=e[++p]));m>r?(l=d(e[v+1])?null:e[v+1].elm,o(a,l,e,p,v,h)):p>v&&q(a,c,m,r)}function s(a,c,g){var h,i;e(h=c.data)&&e(i=h.hook)&&e(h=i.prepatch)&&h(a,c);var j=c.elm=a.elm,k=a.children,l=c.children;if(a!==c){if(!f(a,c)){var m=b.parentNode(a.elm);return j=n(c,g),b.insertBefore(m,j,a.elm),void q(m,[a],0,0)}if(e(c.data)){for(h=0;h<v.update.length;++h)v.update[h](a,c);h=c.data.hook,e(h)&&e(h=h.update)&&h(a,c)}d(c.text)?e(k)&&e(l)?k!==l&&r(j,k,l,g):e(l)?(e(a.text)&&b.setTextContent(j,""),o(j,null,l,0,l.length-1,g)):e(k)?q(j,k,0,k.length-1):e(a.text)&&b.setTextContent(j,""):a.text!==c.text&&b.setTextContent(j,c.text),e(i)&&e(h=i.postpatch)&&h(a,c)}}var t,u,v={};for(d(b)&&(b=k),t=0;t<m.length;++t)for(v[m[t]]=[],u=0;u<a.length;++u)void 0!==a[u][m[t]]&&v[m[t]].push(a[u][m[t]]);return function(a,e){var g,h,i,j=[];for(g=0;g<v.pre.length;++g)v.pre[g]();for(d(a.sel)&&(a=c(a)),f(a,e)?s(a,e,j):(h=a.elm,i=b.parentNode(h),n(e,j),null!==i&&(b.insertBefore(i,e.elm,b.nextSibling(h)),q(i,[a],0,0))),g=0;g<j.length;++g)j[g].data.hook.insert(j[g]);for(g=0;g<v.post.length;++g)v.post[g]();return e}}var i=c(78),j=c(77),k=c(196),l=i("",{},[],void 0,void 0),m=["create","update","remove","destroy","pre","post"];a.exports={init:h}},function(a,b,c){function d(a){var b=a.items,c=a.values,d=a.vc,e={},f=[];return b.forEach(function(a){var b=a.key,f=a.value;c[b]||(c[b]=d()),c[b].add(f)&&(e[b]=e[b]||[],e[b].push(f))}),Object.keys(e).forEach(function(a){f.push({id:a,values:e[a]})}),f}function e(a){var b=a.items,c=a.values,d={},e=[];return b.forEach(function(a){var b=a.key,e=a.value;c[b]&&c[b].remove(e)&&(d[b]=d[b]||[],d[b].push(e))}),Object.keys(d).forEach(function(a){e.push({id:a,values:d[a]})}),e}function f(a){var b={};return a.forEach(function(a){var c=a.key,d=a.value;b[c]||(b[c]=[]);var e=b[c].indexOf(d);e===-1?b[c].push(d):b[c].splice(e,1)}),b}function g(a){var b=a.key,c=a.collection,d=a.obj,e=a.fn,f=a.value;c[b]||(c[b]=e()),d[b]=d[b]||[],d[b].push(f),c[b].add(f)}function h(a){var b=a.items,c=a.values,d=a.vc,e={},h={},i=[],j=[],k=f(b);return Object.keys(k).forEach(function(a){k[a].forEach(function(b){c[a]&&c[a].contains(b)?c[a]&&c[a].contains(b)&&(h[a]=h[a]||[],h[a].push(b),c[a].remove(b)):g({key:a,value:b,collection:c,obj:e,fn:d})})}),Object.keys(e).forEach(function(a){i.push({id:a,values:e[a]})}),Object.keys(h).forEach(function(a){j.push({id:a,values:h[a]})}),[i,j]}function i(a,b){var c=[];return Object.keys(a).forEach(function(d){if(b[d]){var e=a[d].filter(function(a){return b[d].indexOf(a)===-1});e.length&&c.push({id:d,values:e})}else c.push({id:d,values:a[d]})}),c}function j(a){var b=a.items,c=a.vCollection,d=a.vc,e={},h=[],j=[],k=f(b),l={};return Object.keys(c).forEach(function(a){l[a]=c[a].values().slice(),delete c[a]}),Object.keys(k).forEach(function(a){k[a].forEach(function(b){c[a]&&c[a].contains(b)||g({key:a,value:b,collection:c,obj:e,fn:d})})}),j=i(l,e),h=i(e,l),[h,j]}function k(a,b){return a&&a.length?a.reduce(function(a,b){return b(a)},b):b}function l(a){return a.replace(/(-[a-z])/g,function(a){return a.toUpperCase().replace("-","")})}function m(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}function n(){function a(){}var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=b.vc,f=void 0===c?q.a:c,g=b.rc,i=void 0===g?p.a:g,n=!1,r={},s={},t={addValues:[],removeValues:[],toggleValues:[],setValues:[]};return a.start=function(){n||(n=!0,a.emit("start"))},a.end=function(){n&&(n=!1,r={},s={},a.emit("end"))},a.isActive=function(){return n},a.clear=function(){var b=a.brushes().filter(function(a){return"value"===a.type&&a.brush.values().length}).map(function(a){return{id:a.id,values:a.brush.values()}}),c=Object.keys(r).length>0||b.length;r={},s={},c&&a.emit("update",[],b)},a.brushes=function(){var a=[];return a=a.concat(Object.keys(r).map(function(a){return{type:"range",id:a,brush:r[a]}})),a=a.concat(Object.keys(s).map(function(a){return{type:"value",id:a,brush:s[a]}}))},a.addValue=function(b,c){a.addValues([{key:b,value:c}])},a.addValues=function(b){var c=k(t.addValues,b),e=d({vc:f,values:s,items:c});a.emit("add-values",c),e.length&&(n||(n=!0,a.emit("start")),a.emit("update",e,[]))},a.setValues=function(b){var c=k(t.setValues,b),d=j({items:c,vCollection:s,vc:f});a.emit("set-values",c),(d[0].length>0||d[1].length>0)&&(n||(n=!0,a.emit("start")),a.emit("update",d[0],d[1]))},a.removeValue=function(b,c){a.removeValues([{key:b,value:c}])},a.removeValues=function(b){var c=k(t.removeValues,b),d=e({values:s,items:c});a.emit("remove-values",c),d.length&&a.emit("update",[],d)},a.toggleValue=function(b,c){a.toggleValues([{key:b,value:c}])},a.toggleValues=function(b){var c=k(t.toggleValues,b),d=h({items:c,values:s,vc:f});a.emit("toggle-values",c),(d[0].length>0||d[1].length>0)&&(n||(n=!0,a.emit("start")),a.emit("update",d[0],d[1]))},a.containsValue=function(a,b){return!!s[a]&&s[a].contains(b)},a.addRange=function(b,c){r[b]||(r[b]=i()),n||(n=!0,a.emit("start")),r[b].add(c),a.emit("update")},a.containsRangeValue=function(a,b){return!!r[a]&&r[a].containsValue(b)},a.containsMappedData=function(a,b,c){var d=[];return Object.keys(a).forEach(function(b,c){d[c]={key:b,i:c,bool:!1};var e=a[b].source&&a[b].source.field;if(e){var f="quant"===a[b].source.type?"range":"value",g=a[b].value;"range"===f&&r[e]&&r[e].containsValue(g)?d[c].bool=!0:"value"===f&&s[e]&&s[e].contains(g)&&(d[c].bool=!0)}}),b?(d=d.filter(function(a){return b.indexOf(a.key)!==-1}),"and"===c?!!d.length&&!d.some(function(a){return a.bool===!1}):"xor"===c?!!d.length&&d.some(function(a){return a.bool})&&d.some(function(a){return a.bool===!1}):d.some(function(a){return a.bool})):d.some(function(a){return a.bool})},a.intercept=function(a,b){var c=l(a);t[c]&&t[c].push(b)},a.removeInterceptor=function(a,b){var c=l(a);if(t[c]){var d=t[c].indexOf(b);d!==-1&&t[c].splice(d,1)}},a.removeAllInterceptors=function(b){var c=[];if(b){var d=l(b);t[d]&&t[d].length&&c.push({name:b,handlers:t[d]})}else Object.keys(t).forEach(function(a){t[a].length&&c.push({name:m(a),handlers:t[a]})});c.forEach(function(b){b.handlers.slice().forEach(function(c){return a.removeInterceptor(b.name,c)})})},o.a.mixin(a),a}var o=c(94),p=c(204),q=c(205);b.a=n},function(a,b,c){var d=c(202);b.a=d.a},function(a,b,c){function d(a,b,c){for(var d=0;d<a.length&&b>a[d];)++d;return a[d]===b&&c&&++d,d}function e(a,b){for(var c=a.length,d=1;d<c;d+=2)if(a[d-1]<=b&&b<=a[d])return!0;return!1}function f(){function a(){}var b=[];return a.add=function(a){var c,e=a.min,f=a.max,g=d(b,e),h=d(b,f,!0),i=[g,h-g];g%2==0&&i.push(e),h%2==0&&i.push(f),(c=b).splice.apply(c,i)},a.remove=function(a){var c,e=a.min,f=a.max,g=d(b,e),h=d(b,f,!0),i=[g,h-g];g%2==1&&i.push(e),h%2==1&&i.push(f),(c=b).splice.apply(c,i)},a.clear=function(){return b=[]},a.containsValue=function(a){return e(b,a)},a.ranges=function(){for(var a=[],c=1;c<b.length;c+=2)a.push({min:b[c-1],max:b[c]});return a},a}b.a=f},function(a,b,c){function d(){function a(){}var b=[];return a.add=function(a){return b.indexOf(a)===-1&&(b.push(a),!0)},a.remove=function(a){var c=b.indexOf(a);return c!==-1&&(b.splice(c,1),!0)},a.contains=function(a){return b.indexOf(a)!==-1},a.values=function(){return b.slice()},a.clear=function(){return b=[]},a}b.a=d},function(a,b,c){function d(a){return"string"==typeof a||"number"==typeof a?a:"-"}function e(a,b){m()(a,b.style)}function f(a,b){if(!b.tilted)if("top"===b.align||"bottom"===b.align){var c=b.outerRect.width,d=Math.min(.75*b.maxWidth/2,b.textRect.width/2),e=a.x-d,f=a.x+d;e<0?(a.anchor="start",a.x=b.innerRect.x-b.outerRect.x,a.maxWidth*=.75):f>c&&(a.anchor="end",a.x=b.innerRect.width+b.innerRect.x,a.maxWidth*=.75)}else{var g=b.outerRect.height,h=b.maxHeight/2,i=a.y-h,j=a.y+h;if(i<0)a.y=b.innerRect.y-b.outerRect.y,a.dy=b.textRect.height;else if(j>g)a.y=b.innerRect.height+(b.innerRect.y-b.outerRect.y),a.dy=0;else{a.dy=b.textRect.height/3}}}function g(a,b){"top"===b.align?a.y-=b.padding:"bottom"===b.align?a.y+=b.padding+b.maxHeight:"left"===b.align?a.x-=b.padding:"right"===b.align&&(a.x+=b.padding)}function h(a,b){if(b.tilted){var c=-b.angle,d=c*(Math.PI/180);"bottom"===b.align?(a.x-=b.maxHeight*Math.sin(d)/2,a.y-=b.maxHeight,a.y+=b.maxHeight*Math.cos(d)/2):a.x-=b.maxHeight*Math.sin(d)/3,a.transform="rotate("+c+", "+a.x+", "+a.y+")",a.anchor="bottom"===b.align==b.angle<0?"start":"end";var e=Math.cos(d)*b.maxWidth;if("bottom"===b.align==b.angle<0){var f=b.outerRect.width-b.paddingEnd;a.x+e>f&&(a.maxWidth=(f-a.x-10)/Math.cos(d))}else{var g=b.paddingEnd;a.x-e<g&&(a.maxWidth=(a.x-g-10)/Math.cos(d))}}}function i(a,b,c){if(c.stepSize&&!c.layered&&!c.tilted){if("bottom"===c.align||"top"===c.align){var d=a.position*c.innerRect.width,e=d+(c.innerRect.x-c.outerRect.x-c.stepSize/2);b.collider={type:"rect",x:e,y:0,width:e<0?c.stepSize+e:c.stepSize,height:c.innerRect.height}}else{var f=a.position*c.innerRect.height,g=f+(c.innerRect.y-c.outerRect.y-c.stepSize/2);b.collider={type:"rect",x:0,y:g,width:c.innerRect.width,height:g<0?c.stepSize+g:c.stepSize}}var h=b.collider;h.x=Math.max(h.x,0),h.y=Math.max(h.y,0);var i=h.x+h.width-(c.outerRect.x+c.outerRect.width);h.width=i>0?h.width-i:h.width;var j=h.y+h.height-(c.outerRect.y+c.outerRect.height);h.height=j>0?h.height-j:h.height}}function j(a,b){var c=Math.min(a.maxWidth,b.maxWidth,b.textRect.width),d=Math.min(a.maxHeight,b.maxHeight,b.textRect.height),e=a.dx||0,f=a.dy||0;a.boundingRect={x:0,y:a.y+f-d,width:c,height:d},"middle"===a.anchor?a.boundingRect.x=a.x+e-c/2:"end"===a.anchor?a.boundingRect.x=a.x+e-c:a.boundingRect.x=a.x+e}function k(a,b){var c={type:"text",text:d(a.label),x:0,y:0,maxWidth:b.maxWidth,maxHeight:b.maxHeight};return"top"===b.align||"bottom"===b.align?(c.x=a.position*b.innerRect.width+(b.innerRect.x-b.outerRect.x),c.y="top"===b.align?b.innerRect.height:0,c.anchor="middle"):(c.y=a.position*b.innerRect.height+(b.innerRect.y-b.outerRect.y),c.x="left"===b.align?b.innerRect.width:0,c.anchor="left"===b.align?"end":"start"),e(c,b),f(c,b),g(c,b),h(c,b),i(a,c,b),j(c,b),c}var l=c(0),m=c.n(l);b.a=k},function(a,b,c){function d(a,b){g()(a,b.style);var c=a.strokeWidth/2;"top"===b.align?(a.y1-=c,a.y2-=c):"bottom"===b.align?(a.y1+=c,a.y2+=c):"left"===b.align?(a.x1-=c,a.x2-=c):"right"===b.align&&(a.x1+=c,a.x2+=c)}function e(a){var b={type:"line",x1:0,x2:0,y1:0,y2:0,collider:{type:null}};return"top"===a.align||"bottom"===a.align?(b.x1=a.innerRect.x-a.outerRect.x,b.x2=a.innerRect.width+a.innerRect.x,b.y1=b.y2="top"===a.align?a.innerRect.height-a.padding:a.padding):(b.x1=b.x2="left"===a.align?a.innerRect.width-a.padding:a.padding,b.y1=a.innerRect.y-a.outerRect.y,b.y2=a.innerRect.height+a.innerRect.y),d(b,a),b}var f=c(0),g=c.n(f);b.a=e},function(a,b,c){function d(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function e(a){var b=0;return b+=a.paddingStart,b+=a.line.show?a.line.strokeWidth:0,b+=a.ticks.show?a.ticks.margin:0}function f(a){return a.line.strokeWidth+a.minorTicks.margin}function g(a){var b=0;return b+=a.ticks.show?a.ticks.tickSize:0,b+=e(a)+a.labels.margin}function h(a){var b=a.style;return(0,a.measureText)({text:a.tick.label,fontSize:b.fontSize,fontFamily:b.fontFamily})}function i(a){return a.filter(function(a){return!a.isMinor})}function j(a){return a.filter(function(a){return a.isMinor})}function k(a,b){return a.map(function(a){return c.i(t.a)(a,b)})}function l(a,b,d){return a.map(function(a,e){b.textRect=h({tick:a,measureText:d,style:b.style});var f=c.i(s.a)(a,b);return f.data=e,f})}function m(a,b,d,e){var f=b.padding,i=g(d)+b.maxHeight+d.labels.margin;return a.map(function(a,d){b.layer=d%2,b.padding=d%2==0?f:i,b.textRect=h({tick:a,measureText:e,style:b.style});var g=c.i(s.a)(a,b);return g.data=d,g})}function n(a,b){for(var c=0;c<=a.length-1;c++)for(var d=c+1;d<=Math.min(c+5,c+(a.length-1));d++)a[c]&&a[d]&&function(a,b){var c=a.boundingRect,d=b.boundingRect;return c.x<=d.x+d.width&&d.x<=c.x+c.width&&c.y<=d.y+d.height&&d.y<=c.y+c.height}(a[c],a[d])&&(d===a.length-1?(a.splice(c,1),b&&b.splice(c,1)):(a.splice(d,1),b&&b.splice(d,1)),d--,c--)}function o(a){var b=a.measureText,c=a.settings,d=a.innerRect,e=a.scale,f=b({text:"M",fontSize:c.labels.fontSize,fontFamily:c.labels.fontFamily}).height,h={width:0,height:f};if("left"===c.align||"right"===c.align)h.width=d.width-g(c)-c.paddingEnd;else if(c.labels.layered)h.width=e.bandWidth()*d.width*2;else if(!c.labels.layered&&c.labels.tilted){var i=Math.abs(c.labels.tiltAngle)*(Math.PI/180);h.width=(d.height-g(c)-c.paddingEnd-f*Math.cos(i))/Math.sin(i)}else h.width=e.bandWidth()*d.width;return h}function p(a){var b=a.measureText,c=a.settings,d=a.innerRect,e=a.ticks,f=b({text:"M",fontSize:c.labels.fontSize,fontFamily:c.labels.fontFamily}).height,h={width:0,height:f};if("left"===c.align||"right"===c.align)h.width=d.width-g(c)-c.paddingEnd;else if(c.labels.layered)h.width=d.width/i(e).length*.75*2;else if(!c.labels.layered&&c.labels.tilted){var j=Math.abs(c.labels.tiltAngle)*(Math.PI/180);h.width=(d.height-g(c)-c.paddingEnd-f*Math.cos(j))/Math.sin(j)}else h.width=d.width/i(e).length*.75;return h}function q(a){function b(){return s=p,t=function(){return null},u=!0,b}function h(){return s=o,t=function(a){var b=a.innerRect,c=a.scale,d=a.settings;return("top"===d.align||"bottom"===d.align?b.width:b.height)*c.bandWidth()},h}function q(a){var b=a.settings,h=a.scale,o=a.innerRect,p=a.outerRect,q=a.measureText,v=a.ticks,w=[],x=i(v),y=j(v),z={innerRect:o,align:b.align,outerRect:p},A=void 0;if(b.line.show&&(z.style=b.line,z.padding=b.paddingStart,w.push(c.i(r.a)(z))),b.ticks.show&&(z.style=b.ticks,z.tickSize=b.ticks.tickSize,z.padding=e(b),A=k(x,z)),b.labels.show){var B=s({measureText:q,settings:b,innerRect:o,ticks:v,scale:h}),C=g(b);z.stepSize=t({innerRect:o,scale:h,ticks:v,settings:b}),z.style=b.labels,z.padding=C,z.maxWidth=B.width,z.maxHeight=B.height,z.layered=b.labels.layered,z.tilted=!b.labels.layered&&b.labels.tilted&&("top"===b.align||"bottom"===b.align),z.angle=b.labels.tiltAngle,z.paddingEnd=b.paddingEnd;var D=[];D=!b.labels.layered||"top"!==b.align&&"bottom"!==b.align?l(x,z,q):m(x,z,b,q),u&&!z.tilted&&n(D,A),w.push.apply(w,d(D))}return b.minorTicks&&b.minorTicks.show&&y.length>0&&(z.style=b.minorTicks,z.tickSize=b.minorTicks.tickSize,z.padding=f(b),w.push.apply(w,d(k(y,z)))),A&&w.push.apply(w,d(A)),w}var s=void 0,t=void 0,u=!1;return b.build=q,h.build=q,"ordinal"===a?h():b()}var r=c(207),s=c(206),t=c(210);b.a=q},function(a,b,c){function d(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function e(a){return!a.isMinor}function f(a){for(var b=a.majorTicks,c=a.measureText,d=a.rect,e=d.height,f=c("M").height,g=1;g<b.length;++g){if(e*Math.abs(b[g-1].position-b[g].position)<f)return!0}return!1}function g(a){for(var b=a.majorTicks,c=a.measureText,d=a.rect,e=a.scale,f=a.settings,g=f.labels.layered?2:1,h=d.width,i=b.map(function(a){return a.label}).map(function(a){return a.slice(0,1)+"…"}).map(c).map(function(a){return a.width}),j=0;j<b.length;++j){if(g*h*e.bandWidth()<i[j])return!0}return!1}function h(a){for(var b=a.majorTicks,c=a.measureText,d=a.rect,e=d.width,f=c("M").height,g=1;g<b.length;++g){if(e*Math.abs(b[g-1].position-b[g].position)<f)return!0}return!1}function i(a){var b=a.rect,c=a.type,d=a.scale,e=a.settings,i=a.tilted,j=a.majorTicks,k=a.measure,l=a.horizontal,m=i&&h({majorTicks:j,measureText:k,rect:b}),n="ordinal"===c&&!i&&l&&g({majorTicks:j,measureText:k,rect:b,scale:d,settings:e}),o="ordinal"===c&&!l&&f({majorTicks:j,measureText:k,rect:b,settings:e});return m||n||o}function j(a){var b=a.rect,c=a.type,f=a.data,g=a.formatter,h=a.measureText,j=a.scale,k=a.settings,l=0,m={left:0,top:0,right:0,bottom:0};if(k.labels.show){var n=k.align,o="top"===n||"bottom"===n,p=o&&k.labels.layered,q=o?b.width:b.height,r=o&&k.labels.tilted&&!p,s=j.ticks({settings:k,distance:q,data:f,formatter:g}).filter(e),t=function(a){var b=h({text:a,fontSize:k.labels.fontSize,fontFamily:k.labels.fontFamily});return k.labels.maxWidth&&(b.width=Math.min(b.width,k.labels.maxWidth)),b},u=void 0;if(r){var v=Math.abs(k.labels.tiltAngle)*(Math.PI/180);u=function(a){return a.width*Math.sin(v)+a.height*Math.cos(v)}}else u=o?function(a){return a.height}:function(a){return a.width};if(i({rect:b,type:c,scale:j,settings:k,tilted:r,majorTicks:s,measure:t,horizontal:o})){return{size:Math.max(b.width,b.height)}}var w=void 0;w=o&&!r?["M"]:s.map(function(a){return a.label});var x=w.map(t),y=x.map(u),z=Math.min(k.labels.maxSize,Math.max.apply(Math,d(y)));if(l+=z,l+=k.labels.margin,p&&(l*=2),r){var A="bottom"===k.align==k.labels.tiltAngle>=0,B=Math.abs(k.labels.tiltAngle)*(Math.PI/180),C=h("M").height,D=(z-C*Math.cos(B))/Math.sin(B),E=function(a){return Math.min(D,a.width)*Math.cos(B)+a.height},F=function(a,c){return A?a-s[c].position*b.width:a-(1-s[c].position)*b.width
},G=Math.min(k.labels.maxEdgeBleed,Math.max.apply(Math,d(x.map(E).map(F))))+k.paddingEnd;m[A?"left":"right"]=G}}if(k.ticks.show&&(l+=k.ticks.margin,l+=k.ticks.tickSize),k.minorTicks&&k.minorTicks.show){var H=k.minorTicks.margin+k.minorTicks.tickSize;H>l&&(l=H)}return k.line.show&&(l+=k.line.strokeWidth),l+=k.paddingStart,l+=k.paddingEnd,{size:l,edgeBleed:m}}b.a=j},function(a,b,c){function d(a,b){i()(a,b.style)}function e(a,b){"top"===b.align?(a.y1-=b.padding,a.y2-=b.padding):"bottom"===b.align?(a.y1+=b.padding,a.y2+=b.padding):"left"===b.align?(a.x1-=b.padding,a.x2-=b.padding):"right"===b.align&&(a.x1+=b.padding,a.x2+=b.padding)}function f(a,b){var c=a.strokeWidth/2;a.x1===b.innerRect.width?(a.x1-=c,a.x2-=c):0===a.x1?(a.x1+=c,a.x2+=c):a.y1===b.innerRect.height?(a.y1-=c,a.y2-=c):0===a.y1&&(a.y1+=c,a.y2+=c)}function g(a,b){var c={type:"line",x1:0,x2:0,y1:0,y2:0,collider:{type:null}};return"top"===b.align||"bottom"===b.align?(c.x1=c.x2=a.position*b.innerRect.width+(b.innerRect.x-b.outerRect.x),c.y1="top"===b.align?b.innerRect.height:0,c.y2="top"===b.align?c.y1-b.tickSize:c.y1+b.tickSize):(c.y1=c.y2=a.position*b.innerRect.height+(b.innerRect.y-b.outerRect.y),c.x1="left"===b.align?b.innerRect.width:0,c.x2="left"===b.align?c.x1-b.tickSize:c.x1+b.tickSize),d(c,b),e(c,b),f(c,b),c}var h=c(0),i=c.n(h);b.a=g},function(a,b,c){function d(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function e(a){var b=a.align,c=a.inner;return"left"===b?{x:c.width+c.x}:"right"===b||"bottom"===b?c:{y:c.y+c.height}}function f(a,b,c){return a&&!b?a:a||b?b:"ordinal"===c?"bottom":"left"}function g(a,b,d){var e={};return Object.keys(b).forEach(function(f){e[f]=c.i(n.b)(a,b,d,f)}),e}var h=c(0),i=c.n(h),j=c(9),k=c(208),l=c(79),m=c(209),n=c(39),o=c(25),p=c(92),q={require:["composer","renderer","dockConfig"],defaultSettings:{displayOrder:0,prioOrder:0,paddingStart:0,paddingEnd:10},created:function(){this.innerRect={width:0,height:0,x:0,y:0},this.outerRect={width:0,height:0,x:0,y:0},"ordinal"===this.scale.type?(this.defaultStyleSettings=c.i(l.b)(),this.defaultDock="bottom"):(this.defaultStyleSettings=c.i(l.a)(),this.defaultDock="left"),this.init(this.settings)},init:function(a){var b=g(a.settings,this.defaultStyleSettings,this.composer),d=i()(!0,{},this.settings,a.settings,b),e=void 0!==d.dock?d.dock:this.defaultDock,h=f(e,d.align,this.scale.type);this.concreteNodeBuilder=c.i(k.a)(this.scale.type),d.dock=e,d.align=h,this.dockConfig.dock=e,this.align=h,Object.keys(b).forEach(function(a){d[a]=c.i(o.c)(d[a])}),this.axisSettings=d},preferredSize:function(a){var b=this,d=this.formatter,e=this.axisSettings;return c.i(m.a)({type:this.scale.type,rect:a.inner,formatter:d,measureText:this.renderer.measureText,scale:this.scale,settings:e,setEdgeBleed:function(a){b.dockConfig.edgeBleed=a}})},beforeUpdate:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=a.settings;this.init(b)},resize:function(a){var b=a.inner,c=a.outer,d={};i()(d,b,e({align:this.align,inner:b}));var f=c||d;return i()(this.innerRect,d),i()(this.outerRect,f),c},beforeRender:function(){var a=this.innerRect,b=this.scale,c=this.formatter,d="top"===this.align||"bottom"===this.align?a.width:a.height;this.ticks=b.ticks({distance:d,formatter:c})},render:function(){var a=this.axisSettings,b=this.innerRect,c=this.outerRect,e=this.ticks,f=[];return f.push.apply(f,d(this.concreteNodeBuilder.build({settings:a,scale:this.scale,innerRect:b,outerRect:c,measureText:this.renderer.measureText,ticks:e}))),p.a.multiple(f),f}};b.a=c.i(j.a)(q)},function(a,b,c){var d=c(211);b.a=d.a},function(a,b,c){function d(a,b){function c(a){return a.reduce(function(a,b){return Array.isArray(b.children)?a.concat(c(b.children)):a.concat(b)},[])}function d(){h.removeListener("start",n),h.removeListener("end",o),h.removeListener("update",p)}var e=b.context,f=b.data,g=b.style,h=a.composer.brush(e),i=f,j=g.active||{},k=g.inactive||{},l=[];Object.keys(j).forEach(function(a){l.push(a)}),Object.keys(k).forEach(function(a){l.indexOf(a)===-1&&l.push(a)});var m=function(){for(var b=c(a.nodes),d=b.length,e=a.data,f=0;f<d;f++)!function(a){b[a].__style||(b[a].__style={},l.forEach(function(c){b[a].__style[c]=b[a][c]}));var c=e[b[a].data],d=c&&h.containsMappedData(c,i);l.forEach(function(c){d&&c in j?b[a][c]=j[c]:!d&&c in k?b[a][c]=k[c]:(b[a].__style||(b[a].__style=b[a].__style||{},l.forEach(function(c){b[a].__style[c]=b[a][c]})),b[a][c]=b[a].__style[c])})}(f)},n=function(){for(var b=c(a.nodes),d=b.length,e=0;e<d;e++)!function(a){b[a].__style=b[a].__style||{},l.forEach(function(c){b[a].__style[c]=b[a][c]})}(e);a.renderer.render(b)},o=function(){for(var b=c(a.nodes),d=b.length,e=0;e<d;e++)!function(a){b[a].__style&&(Object.keys(b[a].__style).forEach(function(c){b[a][c]=b[a].__style[c]}),b[a].__style=void 0)}(e);a.renderer.render(b)},p=function(){m(),a.renderer.render(a.nodes)};return h.on("start",n),h.on("end",o),h.on("update",p),{isActive:function(){return h.isActive()},cleanUp:d,update:m}}function e(a){var b=a.dataPoint,c=a.action,d=a.composer,e=a.config;if(void 0!==b&&e){var f=e.data||["self"],g=[],h="toggleValues";"add"===c?h="addValues":"remove"===c?h="removeValues":"set"===c&&(h="setValues"),null!==b&&f.forEach(function(a){b[a]&&g.push({key:b[a].source.field,value:b[a].value})}),e.contexts.forEach(function(a){d.brush(a)[h](g)})}}function f(a){var b=a.node,c=a.action,d=a.composer,f=a.data,g=a.config,h=b.data;e({dataPoint:null!==h?f[+h]:null,action:c,composer:d,config:g})}function g(a,b,c){var d=c.data||["self"],e=[],f=[];return a.forEach(function(a){d.every(function(c){var d=b[a.node.data],e=d[c].value;return f.indexOf(e)===-1&&(f.push(e),!0)})&&e.push(a)}),e}function h(a){var b=a.collisions,c=a.t,d=a.config,e=a.action,h=[{node:{data:null}}],i=!1;return b.length>0&&(h=b,i=!0,"stop"===c.propagation?h=[b[b.length-1]]:"data"===c.propagation&&(h=g(b,d.data,c))),h.forEach(function(a){f({node:a.node,action:e,composer:d.composer,data:d.data,config:c})}),i}function i(a,b){return 1!==a.changedTouches.length?null:{x:a.changedTouches[0].clientX-b.left,y:a.changedTouches[0].clientY-b.top}}function j(a,b){return{x:a.clientX-b.left,y:a.clientY-b.top}}function k(a,b,d){var e=d.element().getBoundingClientRect(),f=c.i(o.a)(a)?i(a,e):j(a,e);return null===f||f.x<0||f.y<0||f.x>e.width||f.y>e.height?[]:(b.touchRadius>0&&c.i(o.a)(a)&&(f={cx:f.x,cy:f.y,r:b.touchRadius}),d.itemsAt(f))}function l(a,b,c){return a?"function"==typeof a?a(b):a:c}function m(a){var b=a.e,c=a.t,d=a.config;return h({collisions:k(b,c,d.renderer),t:c,config:d,action:l(c.action,b,"toggle")})}function n(a){var b=a.e,c=a.t,d=a.config;return h({collisions:k(b,c,d.renderer),t:c,config:d,action:l(c.action,b,"set")})}var o=c(95);b.a=d,b.b=m,b.c=n},function(a,b,c){var d=c(215);b.a=d.a},function(a,b,c){function d(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function e(a,b){return a&&b?a.cachedTicks&&a.cachedTicks()||a.ticks({distance:b}):[]}var f=c(0),g=c.n(f),h=c(9),i=c(93),j=c(79),k={created:function(){},require:["composer","renderer"],defaultSettings:{displayOrder:0,styles:{}},beforeRender:function(a){this.rect=a.size,this.blueprint=c.i(i.a)(),this.blueprint.width=this.rect.width,this.blueprint.height=this.rect.height,this.blueprint.x=this.rect.x,this.blueprint.y=this.rect.y,this.blueprint.crisp=!0},render:function(){var a=this;if(this.x=this.settings.x?this.composer.scale(this.settings.x):null,this.y=this.settings.y?this.composer.scale(this.settings.y):null,!this.x&&!this.y)return[];var b=c.i(j.a)();this.settings.ticks=g()({},b.ticks,this.settings.ticks||{}),this.settings.minorTicks=g()({},b.minorTicks,this.settings.minorTicks||{}),this.lines={x:[],y:[]},this.lines.x=e(this.x,this.rect.width),this.lines.y=e(this.y,this.rect.height),this.lines.y=this.lines.y.map(function(a){return g()(a,{flipXY:!0})});var f={};return[].concat(d(this.lines.x),d(this.lines.y)).forEach(function(b){f=b.isMinor?a.settings.minorTicks:a.settings.ticks,f.show&&a.blueprint.push({type:"line",x1:b.position,y1:0,x2:b.position,y2:1,stroke:f.stroke||"black",strokeWidth:f.strokeWidth||1,flipXY:b.flipXY||!1})}),this.blueprint.output()}};b.a=c.i(h.a)(k)},function(a,b,c){var d=c(9),e=c(217),f=c(18),g={line:{show:!0,stroke:"#000",strokeWidth:1},median:{show:!0,stroke:"#000",strokeWidth:1},whisker:{show:!0,stroke:"#000",strokeWidth:1,fill:"",type:"line",width:1},box:{show:!0,fill:"#fff",stroke:"#000",strokeWidth:1,width:1,maxWidth:100,minWidth:5}},h={require:["composer"],defaultSettings:{settings:{},data:{}},created:function(){this.rect={x:0,y:0,width:0,height:0},this.dispersion=c.i(e.a)(this.composer,g,this.settings.settings),this.updateSettings(this.settings)},updateSettings:function(a){this.dispersion.updateSettings(a),void 0===this.settings.settings.orientation&&(this.settings.settings.orientation="vertical"),void 0===this.settings.settings.whiskers&&(this.settings.settings.whiskers=!0)},beforeRender:function(a){this.rect=a.size},render:function(a){var b=a.data;return this.boxWidth=this.dispersion.bandwidth()*this.rect.width,this.dispersion.onData(b),this.dispersion.render(this.rect,this.buildShapes)},beforeUpdate:function(a){var b=a.settings;this.updateSettings(b)},buildShapes:function(a){function b(a,b,c,d){var e=d*g*c;return(e=Math.max(a,Math.min(b,e)))/g}if(c.i(f.a)(a.major))return[];var d=this.dispersion.doodle(),e=[],g=this.dispersion.blueprint().flipXY?this.rect.height:this.rect.width;if(a.style.box.width=b(a.style.box.minWidth,a.style.box.maxWidth,a.style.box.width,this.dispersion.bandwidth()),a.style.whisker.width=b(a.style.box.minWidth,a.style.box.maxWidth,a.style.whisker.width,this.dispersion.bandwidth()),a.style.box.show&&!c.i(f.a)(a.start)&&!c.i(f.a)(a.end)){var h=Math.max(a.start,a.end),i=Math.min(a.start,a.end);e.push(d.box(a.major,i,h-i,a.style,a.data))}return!a.style.line.show||c.i(f.a)(a.min)||c.i(f.a)(a.start)||e.push(d.verticalLine(a.major,a.start,a.min,"line",a.style,a.data)),!a.style.line.show||c.i(f.a)(a.max)||c.i(f.a)(a.end)||e.push(d.verticalLine(a.major,a.max,a.end,"line",a.style,a.data)),a.style.median.show&&!c.i(f.a)(a.med)&&e.push(d.median(a.major,a.med,a.style,a.data)),!a.style.whisker.show||c.i(f.a)(a.min)||c.i(f.a)(a.max)||(e.push(d.whisker(a.major,a.min,a.style,a.data)),e.push(d.whisker(a.major,a.max,a.style,a.data))),e}};b.a=c.i(d.a)(h)},function(a,b,c){function d(a,b,d){var e={};return Object.keys(b).forEach(function(f){e[f]=c.i(i.b)(a,b,d,f)}),e}function e(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=e,j=void 0,k=void 0,l=void 0,m=void 0,n=void 0,o=void 0,p=void 0,q=void 0,r=function a(){return a};return r.updateSettings=function(b){i=b.settings,j=i.major?a.scale(i.major):null,k=i.minor?a.scale(i.minor):null,l=0,m=null,n=c.i(g.a)(),o=c.i(f.a)(i)},r.onData=function(e){if(p=[],q=d(i,b,a),j&&!j.bandWidth){var f=e.map(function(a){return a.self.value});f.sort();for(var g=f[f.length-1],l=0;l<f.length;l++)f[l]&&f[l-1]&&(null===g||g>f[l]-f[l-1])&&(g=f[l]-f[l-1]);m=g}e.forEach(function(a,b){var d={};Object.keys(q).forEach(function(e){d[e]=c.i(h.a)(q[e],a,b)}),p.push({style:d,major:j&&a.self?j(a.self)+j.bandWidth()/2:.5,min:k&&"min"in a?k(a.min):null,max:k&&"max"in a?k(a.max):null,start:k&&"start"in a?k(a.start):null,end:k&&"end"in a?k(a.end):null,med:k&&"med"in a?k(a.med):null,data:b})})},r.items=function(){return p},r.bandwidth=function(){return l},r.doodle=function(){return o},r.blueprint=function(){return n},r.render=function(a,b){if(null!==m){0===m&&(m=1e-9);var c=j({value:j.domain()[0]})-j({value:j.domain()[0]+m});l=Math.abs(c)}else l=j&&j.bandWidth?j.bandWidth():1;n.reset(),n.width=a.width,n.height=a.height,n.x=a.x,n.y=a.y,n.flipXY="horizontal"===i.orientation,n.crisp=!0,p.forEach(function(a,c){b(a).forEach(function(a){a.data=c,a.collider={type:null},n.push(a)})});var d=n.output();return 0===d.length?d:p.map(function(a,b){for(var c={type:"container",data:b,collider:{type:"bounds"},children:[]},e=0;e<d.length;e++){var f=d[e];f.data===c.data&&(c.children.push(f),d.splice(e,1),e--)}return c})},r()}var f=c(218),g=c(93),h=c(25),i=c(39);b.a=e},function(a,b,c){function d(a){function b(){return b.settings=a||{style:{}},b}return b.style=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return f()(a,c[b]||{})},b.horizontalLine=function(a,c,d,e){var f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return b.style({type:"line",y1:c,x1:a-d/2,y2:c,x2:a+d/2},e,f)},b.verticalLine=function(a,c,d,e){var f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return b.style({type:"line",y1:c,x1:a,y2:d,x2:a},e,f)},b.whisker=function(a,c){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{whisker:{}},e=d.whisker.width||1;return b.style({type:"line",y1:c,x1:a-e/2,cx:a,cy:c,r:e/2,y2:c,x2:a+e/2},"whisker",d)},b.openwhisker=function(a,c){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{whisker:{}},e=d.whisker.width||1;return b.whisker(a-e/2,c,d)},b.closewhisker=function(a,c){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{whisker:{}},e=d.whisker.width||1;return b.whisker(a+e/2,c,d)},b.median=function(a,c){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{box:{}},e=d.box.width||1;return b.horizontalLine(a,c,e,"median",d)},b.box=function(a,c,d){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{box:{}},f=e.box.width||1;return b.style({type:"rect",x:a-f/2,y:c,height:d,width:f},"box",e)},b()}var e=c(0),f=c.n(e);b.a=d},function(a,b,c){function d(a,b){return a&&"function"==typeof a.bandWidth?Math.max(1,a.bandWidth()*b):Math.max(1,b/10)}function e(a,b,c,e){var f=d(a?a.scale:void 0,c),g=d(b?b.scale:void 0,e),h=Math.min(f,g),i=Math.max(1,Math.floor(h/10));return[i,Math.max(i,Math.min(Math.floor(h)))]}function f(a,b){var d=c.i(j.a)(a,m,b);return d.errorShape=c.i(j.a)(a.errorShape,n.errorShape,b),d}function g(a,b,d,e){var f=(b.x,b.y,b.width),g=b.height;return a.filter(function(a){return!isNaN(a.x+a.y)}).map(function(a){var b=c.i(l.a)(a.size)?a.errorShape:a,h=d[0]+b.size*(d[1]-d[0]),i=e(b.shape,{label:a.label,x:a.x*f,y:a.y*g,fill:a.fill,size:Math.min(a.maxSize,Math.max(a.minSize,h)),stroke:b.stroke,strokeWidth:b.strokeWidth,opacity:a.opacity});return i.data=a.dataIndex,i})}var h=c(9),i=c(220),j=c(39),k=c(25),l=c(18),m={shape:"circle",label:"",fill:"#999",stroke:"#ccc",strokeWidth:0,opacity:1,x:.5,y:.5,size:1,maxSize:100,minSize:5},n={errorShape:{opacity:1,shape:"saltire",size:.2,fill:void 0,stroke:void 0,strokeWidth:2}},o={require:["composer"],defaultSettings:{settings:{},data:{}},created:function(){this.rect={x:0,y:0,width:0,height:0},this.updateSettings(this.settings)},updateSettings:function(a){var b=this.composer;this.local=f(a.settings,b)},beforeUpdate:function(a){this.updateSettings(a.settings)},beforeRender:function(a){this.rect=a.size},render:function(a){var b=this,d=a.data,f=this.rect,h=f.width,j=f.height,l=d.map(function(a,d){var e=c.i(k.a)(b.local,a,d);return e.errorShape=c.i(k.a)(b.local.errorShape,a,d),e.dataIndex=d,e}),m=e(this.local.x,this.local.y,h,j);return g(l,this.rect,m,this.settings.shapeFn||i.a)}};b.a=c.i(h.a)(o)},function(a,b,c){function d(a,b){return e[a]?e[a](b):e.circle(b)}b.a=d;var e={circle:function(a){return{type:"circle",title:a.label,cx:a.x,cy:a.y,r:a.size/2,opacity:a.opacity,fill:a.fill,stroke:a.stroke,strokeWidth:a.strokeWidth}},rect:function(a){return{type:"rect",title:a.label,x:a.x-a.size/2,y:a.y-a.size/2,width:a.size,height:a.size,opacity:a.opacity,fill:a.fill,stroke:a.stroke,strokeWidth:a.strokeWidth}},saltire:function(a){var b=a.x-a.size/2,c=a.y-a.size/2;return{type:"path",title:a.label,d:"M "+b+" "+c+" l "+a.size+" "+a.size+" M "+b+" "+(c+a.size)+" l "+a.size+" -"+a.size,opacity:a.opacity,stroke:a.fill,strokeWidth:a.strokeWidth}}}},function(a,b,c){function d(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function e(a,b,c){var d=a.settings.dock,e=a.settings.settings.invert,f="top"===d||"bottom"===d,g=c.getBoundingClientRect(),h=g[f?"left":"top"],i=f?"width":"height",j=a.rect[i],k=a.composer.scroll(a.settings.scroll),l=void 0,m=b[f?"clientX":"clientY"]-h;e&&(m=j-m);var n=k.getState();l={startOffset:m,startScroll:n.start,swipe:!1};var o=m/j*(n.max-n.min)+n.min;return o<n.start?l.startScroll=o:o>n.start+n.viewSize&&(l.startScroll=o-n.viewSize),{update:function(a){var b=a[f?"clientX":"clientY"]-h;if(e&&(b=j-b),!l.swipe){if(Math.abs(l.startOffset-b)<=1)return;l.swipe=!0}var c=k.getState(),d=(b-l.startOffset)/j*(c.max-c.min),g=l.startScroll+d;k.moveTo(g)},end:function(a){var b=a[f?"clientX":"clientY"]-h;e&&(b=j-b);var c=k.getState();if(l.swipe){var d=(b-l.startOffset)/j*(c.max-c.min),g=l.startScroll+d;k.moveTo(g)}else{var i=b/j*(c.max-c.min)+c.min,m=i-c.viewSize/2;k.moveTo(m)}}}}var f=c(9),g={require:["composer"],on:{touchstart:function(a){if(a.preventDefault(),1!==a.touches.length)return void(this.currentMove=null);this.currentMove=e(this,a.touches[0],a.currentTarget)},touchmove:function(a){if(1!==a.touches.length)return void(this.currentMove=null);this.currentMove&&this.currentMove.update(a.touches[0])},touchend:function(a){this.currentMove&&(this.currentMove.end(a.changedTouches[0]),this.currentMove=null)},touchcancel:function(){this.currentMove=null},mousedown:function(a){a.preventDefault();var b=e(this,a,a.currentTarget),c=function(a){b.update(a)},d=function a(d){document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",a),b.end(d)};document.addEventListener("mousemove",c),document.addEventListener("mouseup",d)}},defaultSettings:{settings:{backgroundColor:"#eee",thumbColor:"#ccc",width:16}},created:function(){this.rect={x:0,y:0,width:0,height:0}},preferredSize:function(a){var b=this.composer.scroll(this.settings.scroll).getState();if(b.viewSize>=b.max-b.min){return Math.max(a.width,a.height)}return this.settings.settings.width},resize:function(a){var b=a.inner;return this.rect=b,b},render:function(a){var b,c=this.settings.dock,e=this.settings.settings.invert,f="top"===c||"bottom"===c,g=f?"width":"height",h=this.rect,i=h[g],j=this.composer.scroll(this.settings.scroll).getState(),k=i*(j.start-j.min)/(j.max-j.min),l=i*j.viewSize/(j.max-j.min);return e&&(k=i-k-l),a("div",{style:{position:"relative",width:"100%",height:"100%",background:this.settings.settings.backgroundColor}},[].concat(a("div",{class:{scroller:!0},style:(b={position:"absolute"},d(b,f?"left":"top",k+"px"),d(b,f?"top":"left","25%"),d(b,f?"height":"width","50%"),d(b,g,l+"px"),d(b,"background",this.settings.settings.thumbColor),b)})))},renderer:"dom"};b.a=c.i(f.a)(g)},function(a,b,c){var d=c(223);b.a=d.a},function(a,b,c){function d(a,b,c,d){var e=void 0;if("function"==typeof a)e=a(c);else if("string"==typeof a)e=a;else if(d&&d.sources)if(Array.isArray(d.sources)){var f=d.sources.map(function(a){return c.findField(a).title()});e=f.join(b||", ")}else e=c.findField(d.sources).title();else e="";return e}function e(a,b){var c="middle";return"left"===a?"top"===b?c="end":"bottom"===b&&(c="start"):"right"===a?"top"===b?c="start":"bottom"===b&&(c="end"):"left"===b?c="start":"right"===b&&(c="end"),c}function f(a){var b=a.title,c=a.settings,d=a.dock,f=a.rect,g=a.measureText,i={type:"text",text:b,x:0,y:0,dx:0,dy:0,anchor:e(d,c.anchor),baseline:"alphabetical"};h()(i,c.style);var j=g(i);if("top"===d||"bottom"===d){var k=f.width/2;"left"===c.anchor?k=c.paddingLeft||0:"right"===c.anchor&&(k=f.width-(c.paddingRight||0)),i.x=k,i.y="top"===d?f.height-c.paddingStart:c.paddingStart+j.height,i.dy="top"===d?-(j.height/6):-(j.height/3),i.maxWidth=.8*f.width,c.maxWidth&&(i.maxWidth=Math.min(i.maxWidth,c.maxWidth))}else{var l=f.height/2;"top"===c.anchor?l=c.paddingStart:"bottom"===c.anchor&&(l=f.height-c.paddingStart),i.y=l,i.x="left"===d?f.width-c.paddingStart:c.paddingStart,i.dx="left"===d?-(j.height/3):j.height/3;var m="left"===d?270:90;i.transform="rotate("+m+", "+(i.x+i.dx)+", "+(i.y+i.dy)+")",i.maxWidth=.8*f.height}return i}var g=c(0),h=c.n(g),i=c(9),j={require:["renderer","composer"],defaultSettings:{dock:"bottom",displayOrder:99,prioOrder:0,anchor:"center",paddingStart:5,paddingEnd:5,paddingLeft:0,paddingRight:0,style:{fontSize:"15px",fontFamily:"Arial",fill:"#999"},settings:{},join:", "},created:function(){this.rect={x:0,y:0,width:0,height:0},h()(this.settings,this.settings.settings||{}),this.dataset=this.composer.dataset();var a=this.dataset.tables()[0],b=this.settings.text,c=this.settings.settings&&this.settings.settings.join;this.title=d(b,c,a,this.scale)},preferredSize:function(){return this.renderer.measureText({text:this.title,fontSize:this.settings.style.fontSize,fontFamily:this.settings.style.fontFamily}).height+this.settings.paddingStart+this.settings.paddingEnd},beforeRender:function(a){h()(this.rect,a.size)},render:function(){var a=this.title,b=this.settings,c=this.rect,d=[];return d.push(f({title:a,dock:this.settings.dock,settings:b,rect:c,measureText:this.renderer.measureText})),d},beforeUpdate:function(a){a.settings&&h()(this.settings,a.settings.settings||{});var b=this.dataset.tables()[0],c=a.settings.text,e=a.settings.settings&&a.settings.settings.join;this.title=d(c,e,b,this.scale)}};b.a=c.i(i.a)(j)},function(a,b,c){function d(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function e(a){function b(){}var e=a.element,f=a.data,j=void 0===f?{}:f,k=a.settings,l=void 0===k?{}:k,m=a.on,n=void 0===m?{}:m,o=a.created,p=void 0===o?function(){}:o,q=a.updated,r=void 0===q?function(){}:q,s=a.mounted,t=void 0===s?function(){}:s,u=[],v=c.i(g.a)(),w=[],x=[],y=function(a){for(var b=0;b<w.length;b++)if(w[b].instance===a)return w[b];return null},z=function(a){for(var b=0;b<w.length;b++){var c=w[b];if(c.hasKey&&c.key===a)return b}return-1},A=function(a){var b=c.i(h.a)(l.dockLayout);a.forEach(function(a){b.addComponent(a.instance)});var d=b.layout(e),f=d.visible,g=d.hidden;return{visible:f.map(function(a){return y(a)}),hidden:g.map(function(a){return y(a)})}},B=function(){var a=l,b=a.components,c=void 0===b?[]:b;v.set(j,l),w=c.map(function(a){return v.createComponent(a,e)});var d=A(w),f=d.visible,g=d.hidden;x=f,g.forEach(function(a){a.instance.hide(),a.visible=!1}),f.forEach(function(a){return a.instance.beforeMount()}),f.forEach(function(a){return a.instance.mount()}),f.forEach(function(a){return a.instance.beforeRender()}),f.forEach(function(a){return a.instance.render()}),f.forEach(function(a){return a.instance.mounted()}),f.forEach(function(a){a.visible=!0})},C=function(){u.forEach(function(a){var b=a.key,c=a.listener;return e.removeEventListener(b,c)})};return b.update=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=a.partialData;a.data&&(j=a.data),a.settings&&(l=a.settings),v.set(j,l,{partialData:c});for(var d=l,f=d.formatters,g=d.scales,h=d.components,i=void 0===h?[]:h,k=w.length-1;k>=0;k--)!function(a){var b=w[a];i.some(function(a){return b.hasKey&&b.key===a.key})||(w.splice(a,1),b.instance.destroy())}(k);w=i.map(function(a){var b=z(a.key);return b===-1?v.createComponent(a,e):(w[b].updateWith={formatters:f,scales:g,data:j,settings:a},w[b])}),w.forEach(function(a){a.updateWith&&a.instance.set(a.updateWith)}),w.forEach(function(a){a.updateWith&&a.instance.beforeUpdate()});var m=[],n=[];if(c)w.forEach(function(a){a.updateWith&&a.visible?m.push(a):n.push(a)});else{var o=A(w),p=o.visible,q=o.hidden;x=p,p.forEach(function(a){a.updateWith&&a.visible?m.push(a):n.push(a)}),q.forEach(function(a){a.instance.hide(),a.visible=!1,delete a.updateWith})}n.forEach(function(a){return a.instance.beforeMount()}),n.forEach(function(a){return a.instance.mount()}),n.forEach(function(a){return a.instance.beforeRender()}),m.forEach(function(a){return a.instance.beforeRender()}),n.forEach(function(a){return a.instance.render()}),m.forEach(function(a){return a.instance.update()}),n.forEach(function(a){return a.instance.mounted()}),m.forEach(function(a){return a.instance.updated()}),x.forEach(function(a){delete a.updateWith,a.visible=!0}),"function"==typeof r&&r.call(b)},b.destroy=function(){w.forEach(function(a){return a.instance.destroy()}),w=[],C(),delete b.update,delete b.destroy},b.brush=function(){return v.brush.apply(v,arguments)},b.field=function(a){return v.dataset().findField(a)},b.data=function(){return v.dataset()},b.getAffectedShapes=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"and",c=arguments[2],e=arguments[3],f=[];return w.filter(function(a){return void 0===e||null===e||a.key===e}).forEach(function(e){f.push.apply(f,d(e.instance.getBrushedShapes(a,b,c)))}),f},b.findShapes=function(a){var b=[];return x.forEach(function(c){b.push.apply(b,d(c.instance.findShapes(a)))}),b},b.scroll=function(){return v.scroll.apply(v,arguments)},p.call(b),e&&(!function(){e.innerHTML="",B(),Object.keys(n).forEach(function(a){var c=n[a].bind(b);e.addEventListener(a,c),u.push({key:a,listener:c})});var a={},d=function(b){b.touches?(a.x=b.touches[0].clientX,a.y=b.touches[0].clientY,a.multiTouch=b.touches.length>1):(a.x=b.clientX,a.y=b.clientY,a.multiTouch=!1),a.time=Date.now()},f=function(b){if("touchend"===b.type&&b.preventDefault(),c.i(i.b)(b,a))for(var d=x.length-1;d>=0;d--){var e=x[d];if(e.instance.onBrushTap(b),v.stopBrushing){v.stopBrushing=!1;break}}},g=function(a){for(var b=x.length-1;b>=0;b--){if(x[b].instance.onBrushOver(a),v.stopBrushing){v.stopBrushing=!1;break}}},h=[];h.push({key:"mousedown",listener:d}),h.push({key:"mouseup",listener:f}),c.i(i.c)(e)&&(h.push({key:"touchstart",listener:d}),h.push({key:"touchend",listener:f})),h.push({key:"mousemove",listener:g}),h.forEach(function(a){e.addEventListener(a.key,a.listener),u.push(a)}),"function"==typeof t&&t.call(b,e)}(),b.element=e),b}function f(a){return e(a)}var g=c(226),h=c(231),i=c(95);b.a=f},function(a,b,c){function d(a,b){return b.title()===a}function e(a,b){if(a.source){var e=b.findField(a.source,d);if(e&&void 0!==e.field)return e.field.formatter()}return c.i(h.b)(a.formatter||"d3")(a.type||"number")(a.format||"")}function f(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(c[d]=e(a[d],b.dataset()));return c}function g(a,b,c){var d=void 0;return"string"==typeof a&&b[a]?d=b[a]:"object"===(void 0===a?"undefined":i(a))&&"formatter"in a&&b[a.formatter]&&(d=b[a.formatter]),d||e(a,c)}var h=c(41);b.a=f,b.b=g;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}},function(a,b,c){function d(){var a=null,b=null,d=null,e=[],m={},n=function(){};return n.set=function(f,j){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=l.partialData,p=j.formatters,q=void 0===p?{}:p,r=j.scales,s=void 0===r?{}:r,t=j.scroll,u=void 0===t?{}:t;e=c.i(g.b)(f),o||Object.keys(m).forEach(function(a){return m[a].clear()}),a=c.i(i.a)(s,n),b=c.i(h.a)(q,n),d=c.i(k.a)(u,n,d,o)},n.dataset=function(){return e},n.scales=function(){return a},n.formatters=function(){return b},n.brush=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return m[a]||(m[a]=c.i(j.a)()),m[a]},n.scroll=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return c.i(k.b)(a,d)},n.scale=function(b){return c.i(i.b)(b,a,e)},n.formatter=function(a){return c.i(h.b)(a,b,n.dataset())},n.createComponent=function(a,b){return{instance:c.i(l.a)(a.type)(a,n,b),settings:f()(!0,{},a),key:a.key,hasKey:void 0!==a.key}},n.stopBrushing=!1,n}var e=c(0),f=c.n(e),g=c(40),h=c(225),i=c(227),j=c(203),k=c(228),l=c(80);b.a=d},function(a,b,c){function d(a){return a.map(function(a){return"dimension"===a.type()?"ordinal":"linear"}).indexOf("linear")!==-1?"linear":"ordinal"}function e(a,b){return b.map(function(b){var c=a.findField(b);return c?c.field:void 0})}function f(a,b){return a.colors?"color":b[0]?d(b):"linear"}function g(a,b){var c=[],d=[];a.source&&(c=Array.isArray(a.source)?a.source:[a.source],d=e(b,c));var g=a.type||f(a,d),h=void 0;return q.has(g)&&(h=q.get(g),h=h(a,d,b),h.type=g,h.sources=c),h}function h(a,b,c){var d=void 0;return"string"==typeof a&&b[a]?d=b[a]:"object"===(void 0===a?"undefined":p(a))&&"scale"in a&&b[a.scale]&&(d=b[a.scale]),d||g(a,c)}function i(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(c[d]=g(a[d],b.dataset()));return c}var j=c(3),k=c(43),l=c(242),m=c(240),n=c(86),o=c(241);b.b=h,b.a=i;var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},q=c.i(j.a)();q.add("linear",k.a),q.add("ordinal",l.a),q.add("color",m.a),q.add("color-sequential",n.a),q.add("color-threshold",o.a)},function(a,b,c){function d(a,b){var d=a.min||0,e=a.max||0,f=a.viewSize||0,h=b||c.i(g.a)();return h.update({min:d,max:e,viewSize:f}),h}function e(a,b,c,e){var f={};for(var g in a)Object.prototype.hasOwnProperty.call(a,g)&&(f[g]=d(a[g],c?c[g]:null,e));return f}function f(a,b){return b[a]}var g=c(257);b.a=e,b.b=f},function(a,b,c){function d(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function e(a){var b=void 0===a?"undefined":m(a);return"object"!==b&&"function"!==b}function f(a,b){var c=[],d={},e=[],f=void 0,g=a?a.trackBy||"id":"id",h=a?b.findField(a.source):null;return h&&h.field?(e=h.field.values(),e.forEach(function(a,b){var e="$index"===g?b:a[g];d[e]||(d[e]={},c.push(d[e]))})):void 0===a&&(f={},c.push(f)),{others:f,collection:c,fieldValues:e,ids:d,trackBy:g}}function g(a){var b=a.key,c=a.pool,d=a.values,e=a.syncValues,f=a.type,g=a.trackBy,h=a.source,i=a.valueProperty,j=a.others,k=d.length,l=void 0,m=void 0,n=void 0;for(m=0;m<k;m++)l=d[m],(n=e[m]?c["$index"===g?m:e[m][g]]:j)&&(n[b]||(n[b]={values:[],source:{field:h,type:f,indices:[]}}),"$index"===i?n[b].values.push(void 0!==l.index?l.index:m):n[b].values.push(l[i]),n[b].source.indices.push(m))}function h(a,b,c,d){var e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:g,f=d.findField(b.source),h=[],i=c.fieldValues,j=b.type||"quant",k=void 0;f.field&&(h=f.field.values(),k=f.field.type(),b.type||(j="dimension"===k?"qual":"quant"));var l="qual"===j?"label":"value";if(b.property&&(l=b.property),b.linkFrom){var m=d.findField(b.linkFrom);m.field&&(i=m.field.values())}e({key:a,pool:c.ids,values:h,syncValues:i,type:j,trackBy:c.trackBy,source:b.source,valueProperty:l,others:c.others})}function i(a,b,c){for(var d=b.length,e=void 0,f=void 0,g=0;g<d;g++)e=b[g],e[a]&&(f="function"==typeof c?c:p[c||"sum"],e[a].value=f(e[a].values),delete e[a].values)}function j(a,b,c){var d=f(b,c),g=a;return void 0!==b&&(g=l()(!0,{},a,{self:{source:b.source,property:b.property||"label",trackBy:b.trackBy||b.property||"label",reducer:"first",type:"qual"}})),Object.keys(g).forEach(function(a){var b=g[a];e(b)?d.collection.forEach(function(c){c[a]={value:b}}):(h(a,b,d,c),i(a,d.collection,b.reducer))}),d.collection}var k=c(0),l=c.n(k);b.a=j;var m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},n={numeric:function(a){return a.filter(function(a){return"number"==typeof a&&!isNaN(a)})}},o={sum:function(a){return a.reduce(function(a,b){return a+b},0)}},p={first:function(a){return a[0]},last:function(a){return a[a.length-1]},min:function(a){var b=n.numeric(a);return b.length?Math.min.apply(Math,d(b)):NaN},max:function(a){var b=n.numeric(a);return b.length?Math.max.apply(Math,d(b)):NaN},sum:function(a){var b=n.numeric(a);return b.length?b.reduce(function(a,b){return a+b},0):NaN},avg:function(a){var b=n.numeric(a),c=b.length;return c?o.sum(b)/c:NaN}}},function(a,b,c){function d(){
var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=a.dock,c=void 0===b?"":b,d=a.displayOrder,e=void 0===d?0:d,f=a.prioOrder,g=void 0===f?0:f,h=a.requiredSize,i=void 0===h?function(){return 0}:h,j=a.minimumLayoutMode,k=function(){};return k.requiredSize=function(a){return"function"==typeof a?(i=a,this):i},k.dock=function(a){return void 0===a?c:(c=a,this)},k.displayOrder=function(a){return void 0===a?e:(e=a,this)},k.prioOrder=function(a){return void 0===a?g:(g=a,this)},k.minimumLayoutMode=function(a){return void 0===a?j:(j=a,this)},k}b.a=d},function(a,b,c){function d(a){["resize"].forEach(function(b){if("function"!=typeof a[b])throw new Error('Component is missing required function "'+b+'"')})}function e(a,b){if(void 0===a.cachedSize){var c=a.config.requiredSize()(b);"object"===(void 0===c?"undefined":u(c))?(a.cachedSize=Math.ceil(c.size),a.edgeBleed=c.edgeBleed):a.cachedSize=Math.ceil(c)}return a.cachedSize}function f(a,b){var c=.5*a.width,d=.5*a.height;return b.width>=c&&b.height>=d}function g(a,b){switch(b.config.dock()){case"top":a.y+=b.cachedSize,a.height-=b.cachedSize;break;case"bottom":a.height-=b.cachedSize;break;case"left":a.x+=b.cachedSize,a.width-=b.cachedSize;break;case"right":a.width-=b.cachedSize}}function h(a,b){var c=b.edgeBleed;c&&(a.left=Math.max(a.left,c.left||0),a.right=Math.max(a.right,c.right||0),a.top=Math.max(a.top,c.top||0),a.bottom=Math.max(a.bottom,c.bottom||0))}function i(a,b,c){b.x<c.left&&(b.width-=c.left-b.x,b.x=c.left);var d=a.width-(b.x+b.width);d<c.right&&(b.width-=c.right-d),b.y<c.top&&(b.height-=c.top-b.y,b.y=c.top);var e=a.height-(b.y+b.height);e<c.bottom&&(b.height-=c.bottom-e)}function j(a,b,c,d){var e=q()({},b),j=q()({},c);return g(e,d),h(j,d),i(a,e,j),!!f(a,e)&&(g(b,d),h(c,d),!0)}function k(a,b,c){var d={x:a.x,y:a.y,width:a.width,height:a.height},f={left:0,right:0,top:0,bottom:0};b.sort(function(a,b){return a.config.prioOrder()-b.config.prioOrder()});for(var g=0;g<b.length;++g){var h=b[g];e(h,a),j(a,d,f,h)||(b.splice(g,1),c.push(h.instance),--g)}return i(a,d,f),d}function l(a,b,c,d){var e=d.width/c.width,f=d.height/c.height,g={x:c.preserveAspectRatio?Math.min(e,f):e,y:c.preserveAspectRatio?Math.min(e,f):f};a.scaleRatio=g,b.scaleRatio=g,c.scaleRatio=g}function m(a,b,c,d){var e={x:c.x,y:c.y,width:c.width,height:c.height},f={x:c.x,y:c.y,width:c.width,height:c.height};a.sort(function(a,b){return a.config.displayOrder()-b.config.displayOrder()}).forEach(function(a){var g={},h={};switch(a.config.dock()){case"top":g.height=h.height=a.cachedSize,g.width=b.width,h.width=e.width,g.x=b.x,h.x=e.x,g.y=h.y=e.y-a.cachedSize,e.y-=a.cachedSize,e.height+=a.cachedSize;break;case"bottom":g.x=b.x,h.x=e.x,g.y=h.y=e.y+e.height,g.width=b.width,h.width=e.width,g.height=h.height=a.cachedSize,e.height+=a.cachedSize;break;case"left":g.x=h.x=f.x-a.cachedSize,g.y=b.y,h.y=f.y,g.width=h.width=a.cachedSize,g.height=b.height,h.height=f.height,f.x-=a.cachedSize,f.width+=a.cachedSize;break;case"right":g.x=h.x=f.x+f.width,g.y=b.y,h.y=f.y,g.width=h.width=a.cachedSize,g.height=b.height,h.height=f.height,f.width+=a.cachedSize;break;default:g.x=h.x=c.x,g.y=h.y=c.y,g.width=h.width=c.width,g.height=h.height=c.height}l(h,g,b,d),a.instance.resize(h,g,b),a.cachedSize=void 0})}function n(a,b,c,d){for(var e=c.layoutModes||{},f=0;f<a.length;++f){var g=a[f],h=g.config.minimumLayoutMode(),i=!0;"object"===(void 0===h?"undefined":u(h))?i=e[h.width]&&e[h.height]&&d.width>=e[h.width].width&&d.height>=e[h.height].height:void 0!==h&&(i=e[h]&&d.width>=e[h].width&&d.height>=e[h].height),i||(a.splice(f,1),b.push(g.instance),--f)}}function o(a){var b=[],e=[],f=a?c.i(s.a)(a):{},g=function(){};return g.addComponent=function(a){d(a),g.removeComponent(a),b.push({instance:a,config:"function"==typeof a.dockConfig?a.dockConfig:c.i(r.a)(a.dockConfig)})},g.removeComponent=function(a){var c=b.map(function(a){return a.instance}).indexOf(a);c>-1&&b.splice(c,1)},g.layout=function(a){var d=c.i(s.b)(a,f),g=t(d,2),h=g[0],i=g[1];n(b,e,f,h);var j=k(h,b,e);return m(b,h,j,i),{visible:b.map(function(a){return a.instance}),hidden:e}},g.settings=function(a){f=c.i(s.a)(a)},g}var p=c(0),q=c.n(p),r=c(230),s=c(232);b.a=o;var t=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h.return&&h.return()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}},function(a,b,c){function d(a){a.x=Math.ceil(a.x),a.y=Math.ceil(a.y),a.width=Math.ceil(a.width),a.height=Math.ceil(a.height)}function e(a,b){var c={x:0,y:0,width:0,height:0},e={x:0,y:0,width:0,height:0};if("function"==typeof a.getBoundingClientRect){var f=a.getBoundingClientRect();c.width=f.width,c.height=f.height}else c.width=a.width||0,c.height=a.height||0;return void 0!==b.size&&(c.width=isNaN(b.size.width)?c.width:b.size.width,c.height=isNaN(b.size.height)?c.height:b.size.height),void 0!==b.logicalSize?(e.width=isNaN(b.logicalSize.width)?c.width:b.logicalSize.width,e.height=isNaN(b.logicalSize.height)?c.height:b.logicalSize.height,e.preserveAspectRatio=b.logicalSize.preserveAspectRatio):(e.width=c.width,e.height=c.height,e.preserveAspectRatio=!1),d(e),d(c),[e,c]}function f(a,b){return e(a,b)}function g(a){var b={logicalSize:{preserveAspectRatio:!1}};return i()(!0,b,a),b}var h=c(0),i=c.n(h);b.b=f,b.a=g},function(a,b,c){var d=c(3),e=c(234),f=c(235),g=c.i(d.a)();g.add("number",e.a),g.add("time",f.a),b.a=function(){function a(a){return g.has(a)&&g.get(a)}return a.has=function(a){return g.has(a)},a}},function(a,b,c){function d(a,b,d){function f(a){return i(a)}function g(){f.locale({decimal:d||".",thousands:b||",",grouping:[3],currency:["$",""]})}var h=void 0,i=void 0;return f.locale=function(b){return h=c.i(e.a)(b),i=h.format(a),this},g(),f.format=function(a,c,e,f){return(e||f)&&(b=e,d=f,g()),h.format(a)(c)},f.pattern=function(b){return b&&(a=b,i=h.format(b)),a},f}var e=c(26);b.a=d},function(a,b,c){function d(a){function b(a){return f(a)}var d=c.i(e.a)({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),f=d.format(a);return b.format=function(a,b){return d.format(a)(b)},b.locale=function(){return d=e.a.apply(void 0,arguments),f=d.format(a),this},b.parse=function(a,b){return d.parse(a)(b)},b.parsePattern=function(a){return d.parse(a)},b}var e=c(37);b.a=d},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return new(Function.prototype.bind.apply(i,[null].concat(b)))}var f=c(42),g=c(7);b.a=e;var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;d(this,a),this.set(b,c,e,f)}return h(a,[{key:"set",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.cx=a,this.cy=b,this.r=Math.max(c,d),this.vector={x:this.cx,y:this.cy},this.zeroSize=c<=0}},{key:"containsPoint",value:function(a){return!this.zeroSize&&c.i(f.g)(this.vector,a)<=Math.pow(this.r,2)}},{key:"intersectsLine",value:function(a){return!this.zeroSize&&c.i(g.f)(this,a)}},{key:"intersectsRect",value:function(a){if(this.zeroSize)return!1;var b=a[2].x-a[0].x,d=a[2].y-a[0].y,e=a[0].x+b/2,f=a[0].y+d/2;return c.i(g.g)(this.cx,this.cy,this.r,e,f,b,d)}},{key:"intersectsCircle",value:function(a){if(this.zeroSize||a.r<=0)return!1;var b=this.cx-a.cx,c=this.cy-a.cy;return Math.pow(b,2)+Math.pow(c,2)<=Math.pow(this.r+a.r,2)}}]),a}()},function(a,b,c){function d(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return i.get(a).apply(void 0,c)}var e=c(239),f=c(236),g=c(238),h=c(3);b.a=d;var i=c.i(h.a)();i.add("rect",e.a),i.add("circle",f.a),i.add("line",g.a)},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return new(Function.prototype.bind.apply(h,[null].concat(b)))}var f=c(7);b.a=e;var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,g=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;d(this,a),this.set(b,c,e,f,g)}return g(a,[{key:"set",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this.x1=a,this.y1=b,this.x2=c,this.y2=d,this.tolerance=Math.max(0,Math.round(e)),this.vectors=this.points(),this.zeroSize=a===c&&b===d}},{key:"containsPoint",value:function(a){if(this.zeroSize)return!1;if(this.tolerance>0){var b={cx:a.x,cy:a.y,r:this.tolerance};return this.intersectsCircle(b)}return c.i(f.c)(this.vectors[0],this.vectors[1],a)}},{key:"intersectsLine",value:function(a){return!this.zeroSize&&c.i(f.d)(this.vectors[0],this.vectors[1],a[0],a[1])}},{key:"intersectsRect",value:function(a){return!this.zeroSize&&c.i(f.e)(this.vectors,a)}},{key:"intersectsCircle",value:function(a){return!this.zeroSize&&c.i(f.f)(a,this.vectors)}},{key:"points",value:function(){return[{x:this.x1,y:this.y1},{x:this.x2,y:this.y2}]}}]),a}()},function(a,b,c){function d(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return new(Function.prototype.bind.apply(i,[null].concat(b)))}var g=c(7);b.a=f;var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,g=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;e(this,a),this.set(b,c,d,f,g,h)}return h(a,[{key:"set",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;c>=0?(this.x=a,this.width=Math.max(c,e)):(this.x=a+Math.min(c,-e),this.width=-Math.min(c,-e)),d>=0?(this.y=b,this.height=Math.max(d,f)):(this.y=b+Math.min(d,-f),this.height=-Math.min(d,-f)),this.vectors=this.points(),this.zeroSize=this.width<=0||this.height<=0,this.center={x:this.x+this.width/2,y:this.y+this.height/2}}},{key:"containsPoint",value:function(a){return!this.zeroSize&&(a.x>=this.x&&a.x<=this.x+this.width&&a.y>=this.y&&a.y<=this.y+this.height)}},{key:"intersectsLine",value:function(a){if(this.zeroSize)return!1;if(this.containsPoint(a[0])||this.containsPoint(a[1]))return!0;for(var b=0;b<4;b++)if(g.d.apply(void 0,[this.vectors[b],this.vectors[3!==b?b+1:0]].concat(d(a))))return!0;return!1}},{key:"intersectsRect",value:function(a){return!this.zeroSize&&(this.x<=a[2].x&&a[0].x<=this.x+this.width&&this.y<=a[2].y&&a[0].y<=this.y+this.height)}},{key:"intersectsCircle",value:function(a){return!(this.zeroSize||a.r<=0)&&c.i(g.g)(a.cx,a.cy,a.r,this.center.x,this.center.y,this.width,this.height)}},{key:"points",value:function(){return[{x:this.x,y:this.y},{x:this.x+this.width,y:this.y},{x:this.x+this.width,y:this.y+this.height},{x:this.x,y:this.y+this.height}]}}]),a}()},function(a,b,c){function d(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function e(a){return{min:Math.min.apply(Math,d(a.map(function(a){return a.min()}))),max:Math.max.apply(Math,d(a.map(function(a){return a.max()})))}}function f(a,b){var d=c.i(j.a)(a,b),f=e(b),g=f.min,k=f.max,l=function a(b){return c.i(i.b)(a.get(b.value))};return h()(!0,l,d),l.range(a.invert?[1,0]:[0,1]),l.domain([g,k]),l}var g=c(0),h=c.n(g),i=c(22),j=c(43);b.a=f},function(a,b,c){function d(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function e(a,b){var e={min:a.min,max:a.max};return c.i(k.a)(a.min)&&(e.min=b&&b.length?Math.min.apply(Math,d(b.map(function(a){return a.min()}))):0),c.i(k.a)(a.max)&&(e.max=b&&b.length?Math.max.apply(Math,d(b.map(function(a){return a.max()}))):1),e}function f(a,b,c){var d=a.length;if(2===d)return[b+(c-b)/2];for(var e=[],f=(c-b)/d,g=1;g<d;g++)e.push(b+f*g);return e}function g(a){for(var b=[],c=0;c<a.length-1;c++)b.push((a[c]+a[c+1])/2);return b}function h(a,b,e,f){var h=c.i(l.a)().domain([e,f]).range(b);return[e].concat(d(g(a)),[f]).map(function(a){return h({value:a})})}function i(){function a(a){return c.i(k.a)(a.value)?NaN:g(a.value)}var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=arguments[1],g=c.i(j.a)();a.domain=function(b){return arguments.length?(g.domain(b),a):g.domain()},a.range=function(b){return arguments.length?(g.range(b),a):g.range()};var i=e(b,d),l=i.min,m=i.max,n=b.limits||b.domain||[l+(m-l)/2],o=b.colors||b.range||["red","blue"];return o.length>n.length+1?n=f(o,l,m):o.length<n.length+1&&(o=h(n,o,l,m)),a.range(o),a.domain(n),a}var j=c(22),k=c(18),l=c(86);b.a=i},function(a,b,c){function d(a){var b={};return a.filter(function(a){return!b[a.id]&&(b[a.id]=!0)})}function e(a,b,c){return"function"==typeof a[c]?a[c](b):a[c]}function f(a,b){var c={};return j.forEach(function(d){c[d]=e(a,b,d)}),c}function g(a,b,e){var g=c.i(h.c)(),j=function(a){return g("label"in a?a.label:a.value)};if(j.data=function(){return e?e.map({self:{source:a.source,type:"qual"}},{source:a.source}):[]},j.domain=function(a){return arguments.length?(g.domain(a),j):g.domain()},j.range=function(a){return arguments.length?(g.range(a),j):g.range()},j.paddingOuter=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return g.paddingOuter(a),j},j.paddingInner=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return g.paddingInner(a),j},j.padding=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return g.padding(a),j},j.align=function(a){return g.align(a),j},j.bandWidth=function(){return g.bandwidth()},j.step=function(){return g.step()},j.get=function(a){return g(a)},j.start=function(){return j.domain()[0]},j.end=function(){return j.domain()[j.domain().length-1]},j.ticks=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a.scale=j,c.i(i.a)(a)},b&&b[0]){var k=b[0].values(),l=f(a,b),m=d(k).map(function(a){return a.label});j.domain(m),j.range(l.invert?[1,0]:[0,1]),j.padding(isNaN(l.padding)?0:l.padding),isNaN(l.paddingInner)||j.paddingInner(l.paddingInner),isNaN(l.paddingOuter)||j.paddingOuter(l.paddingOuter),j.align(isNaN(l.align)?.5:l.align)}return j}var h=c(22),i=c(87);b.a=g;var j=["padding","paddingOuter","paddingInner","align","invert"]},function(a,b,c){function d(){return{ticks:{tight:!1,forceBounds:!1,distance:100},minorTicks:{count:3}}}b.a=d},function(a,b,c){function d(a){return c.i(p.a)({node:a.node,bounds:a.boundingRect?a.boundingRect(!0):{x:0,y:0,width:0,height:0}})}function e(a,b){var c=a.parent;if(c&&"stage"!==c.type){b.parent=d(c);var f=c.parent;f&&"stage"!==f.type&&e(f,b.parent)}}function f(a,b){b.forEach(function(b){b.input=a})}function g(a,b,c){for(var f=a.descendants.length,g=f-1;g>=0;g--){var h=a.descendants[g],i=h._collider;if(i&&i.fn[b](c)){var j=d(h);return e(h,j),j}}return null}function h(a,b,c){if(a._collider.fn[b](c)){var f=d(a);return e(a,f),f}return null}function i(a,b,c){var f=c;if(a.modelViewMatrix)if(Array.isArray(c))f=a.inverseModelViewMatrix.transformPoints(c);else if(isNaN(c.r))f=a.inverseModelViewMatrix.transformPoint(c);else{var g={x:c.cx,y:c.cy},h=a.inverseModelViewMatrix.transformPoint(g);f.cx=h.x,f.cy=h.y,f.r=c.r}if(a._collider.fn[b](f)){var i=d(a);return e(a,i),i}return null}function j(a,b,c){var d=a._collider;return null===d?null:"frontChild"===d.type?g(a,b,c):"bounds"===d.type?h(a,b,c):i(a,b,c)}function k(a,b,c,d){for(var e=a.length,f=0;f<e;f++){var g=a[f],h=j(g,b,d);h&&c.push(h),!g.children||h||g._collider||k(g.children,b,c,d)}}function l(a,b,c){for(var d=a.length,e=0;e<d;e++){var f=a[e];if(null!==j(f,b,c))return!0;if(f.children&&!f._collider)return l(f.children,b,c)}return!1}function m(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,d=a||{},e=d.x,f=d.y,g=d.width,h=d.height,i=d.x1,j=d.x2,k=d.y1,l=d.y2,m=d.cx,n=d.cy,o=d.r,p={},s=function(a){return"number"==typeof a&&!isNaN(a)};return s(m)&&s(n)&&s(o)?(p.cx=m*b,p.cy=n*b,p.r=o,["intersectsCircle",p]):s(i)&&s(j)&&s(k)&&s(l)?(p=c.i(r.a)(a).map(function(a){return c.i(q.a)(a,b)}),["intersectsLine",p]):s(e)&&s(f)&&s(g)&&s(h)?(p=c.i(r.b)(a).map(function(a){return c.i(q.a)(a,b)}),["intersectsRect",p]):s(e)&&s(f)?(p=c.i(q.a)(a,b),["containsPoint",p]):[]}function n(a,b){var c=m(b,a.dpi),d=s(c,2),e=d[0],g=d[1],h=[];return e&&(k([a],e,h,g),f(b,h)),h}function o(a,b){var c=m(b,a.dpi),d=s(c,2);return l([a],d[0],d[1])}var p=c(245),q=c(42),r=c(7);b.a=n,b.b=o;var s=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h.return&&h.return()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return new(Function.prototype.bind.apply(g,[null].concat(b)))}b.a=e;var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=function(){function a(b){var c=b.parent,e=void 0===c?null:c,f=b.node,g=void 0===f?null:f,h=b.input,i=void 0===h?null:h,j=b.bounds,k=void 0===j?null:j;d(this,a),this._parent=e,this._node=g,this._input=i,this._bounds=k}return f(a,[{key:"bounds",get:function(){return this._bounds}},{key:"parent",set:function(a){this._parent=a},get:function(){return this._parent}},{key:"node",get:function(){return this._node}},{key:"input",get:function(){return this._input},set:function(a){this._input=a}}]),a}()},function(a,b,c){function d(){function a(){return c[c.length-1]}var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],c=[{}];return a.save=function(){for(var d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=a(),g={},h="",i=0;i<b.length;i++)h=b[i],void 0!==e[h]&&(g[h]=e[h]);return f()(g,d),c.push(g),a()},a.restore=function(){c.splice(c.length-1,1)},a}var e=c(0),f=c.n(e);b.a=d},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function g(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return new(Function.prototype.bind.apply(o,[null].concat(b)))}var h=c(0),i=c.n(h),j=c(13),k=c(7);b.a=g;var l=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h.return&&h.return()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),m=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),n=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)},o=function(a){function b(){d(this,b);var a=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,"circle"));return a.set.apply(a,arguments),a}return f(b,a),m(b,[{key:"set",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=a.cx,d=void 0===c?0:c,e=a.cy,f=void 0===e?0:e,g=a.r,h=void 0===g?0:g,j=a.collider,k=i()({type:"circle",cx:d,cy:f,r:h},j);n(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"set",this).call(this,a),n(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"collider",this).call(this,k),this.attrs.cx=d,this.attrs.cy=f,this.attrs.r=h}},{key:"boundingRect",value:function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],b=this.bounds(a);return{x:b[0].x,y:b[0].y,width:b[2].x-b[0].x,height:b[2].y-b[0].y}}},{key:"bounds",value:function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],b=this.attrs,d=b.cx,e=b.cy,f=b.r,g=b.r,h=d-f,i=e-g,j=2*f,m=2*g,n=[{x:h,y:i},{x:h+j,y:i},{x:h+j,y:i+m},{x:h,y:i+m}];if(a&&this.modelViewMatrix){n=this.modelViewMatrix.transformPoints(n);var o=c.i(k.h)(n),p=l(o,4),q=p[0],r=p[1],s=p[2],t=p[3];return j=s-q,m=t-r,[{x:q,y:r},{x:q+j,y:r},{x:q+j,y:r+m},{x:q,y:r+m}]}return n}}]),b}(j.a)},function(a,b,c){function d(a,b){return m.get(a)(b)}var e=c(252),f=c(88),g=c(251),h=c(247),i=c(249),j=c(250),k=c(253),l=c(3);b.a=d;var m=c.i(l.a)();m.add("rect",g.a),m.add("circle",h.a),m.add("text",k.a),m.add("line",i.a),m.add("path",j.a),m.add("stage",e.a),m.add("container",f.a)},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function g(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return new(Function.prototype.bind.apply(o,[null].concat(b)))}var h=c(0),i=c.n(h),j=c(13),k=c(7);b.a=g;var l=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h.return&&h.return()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),m=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),n=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)},o=function(a){function b(){d(this,b);var a=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,"line"));return a.set.apply(a,arguments),a}return f(b,a),m(b,[{key:"set",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=a.x1,d=void 0===c?0:c,e=a.y1,f=void 0===e?0:e,g=a.x2,h=void 0===g?0:g,j=a.y2,k=void 0===j?0:j,l=a.collider;n(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"set",this).call(this,a),this.attrs.x1=d,this.attrs.y1=f,this.attrs.x2=h,this.attrs.y2=k;var m={type:"line",x1:d,y1:f,x2:h,y2:k};n(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"collider",this).call(this,i()(m,l))}},{key:"boundingRect",value:function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],b=c.i(k.a)(this.attrs);a&&this.modelViewMatrix&&(b=this.modelViewMatrix.transformPoints(b));var d=c.i(k.h)(b),e=l(d,4),f=e[0],g=e[1];return{x:f,y:g,width:e[2]-f,height:e[3]-g}}},{key:"bounds",value:function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],b=this.boundingRect(a);return[{x:b.x,y:b.y},{x:b.x+b.width,y:b.y},{x:b.x+b.width,y:b.y+b.height},{x:b.x,y:b.y+b.height}]}}]),b}(j.a)},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function g(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return new(Function.prototype.bind.apply(k,[null].concat(b)))}var h=c(13);b.a=g;var i=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),j=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)},k=function(a){function b(){d(this,b);var a=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,"path"));return a.set.apply(a,arguments),a}return f(b,a),i(b,[{key:"set",value:function(a){j(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"set",this).call(this,a),this.attrs.d=a.d}}]),b}(h.a)},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function g(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return new(Function.prototype.bind.apply(o,[null].concat(b)))}var h=c(0),i=c.n(h),j=c(13),k=c(7);b.a=g;var l=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h.return&&h.return()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),m=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),n=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)},o=function(a){function b(){d(this,b);var a=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,"rect"));return a.set.apply(a,arguments),a}return f(b,a),m(b,[{key:"set",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=a.x,d=void 0===c?0:c,e=a.y,f=void 0===e?0:e,g=a.width,h=void 0===g?0:g,j=a.height,k=void 0===j?0:j,l=a.collider,m=i()({type:"rect",x:d,y:f,width:h,height:k},l);n(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"set",this).call(this,a),n(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"collider",this).call(this,m),h>=0?(this.attrs.x=d,this.attrs.width=h):(this.attrs.x=d+h,this.attrs.width=-h),k>=0?(this.attrs.y=f,this.attrs.height=k):(this.attrs.y=f+k,this.attrs.height=-k)}},{key:"boundingRect",value:function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],b=c.i(k.b)(this.attrs),d=a&&this.modelViewMatrix?this.modelViewMatrix.transformPoints(b):b,e=c.i(k.h)(d),f=l(e,4),g=f[0],h=f[1];return{x:g,y:h,width:f[2]-g,height:f[3]-h}}},{key:"bounds",value:function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],b=this.boundingRect(a);return[{x:b.x,y:b.y},{x:b.x+b.width,y:b.y},{x:b.x+b.width,y:b.y+b.height},{x:b.x,y:b.y+b.height}]}}]),b}(j.a)},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b)
;a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function g(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return new(Function.prototype.bind.apply(j,[null].concat(b)))}var h=c(88);b.a=g;var i=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),j=function(a){function b(a){d(this,b);var c=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,"stage"));return c._stage=c,c._dpiRatio=a||1,c}return f(b,a),i(b,[{key:"dpi",get:function(){return this._dpiRatio}}]),b}(h.b)},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function g(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return new(Function.prototype.bind.apply(m,[null].concat(b)))}var h=c(13),i=c(7);b.a=g;var j=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h.return&&h.return()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),k=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),l=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)},m=function(a){function b(){d(this,b);var a=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,"text"));return a.set.apply(a,arguments),a}return f(b,a),k(b,[{key:"set",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=a.x,d=a.y,e=a.dx,f=a.dy,g=a.text,h=a.collider,i=a.boundingRect;l(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"set",this).call(this,a),l(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"collider",this).call(this,h),this.attrs.x=c,this.attrs.y=d,this.attrs.dx=e||0,this.attrs.dy=f||0,this.attrs.text=g,this._boundingRect=i}},{key:"boundingRect",value:function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this._boundingRect)return{x:0,y:0,width:0,height:0};var b=c.i(i.b)(this._boundingRect),d=a&&this.modelViewMatrix?this.modelViewMatrix.transformPoints(b):b,e=c.i(i.h)(d),f=j(e,4),g=f[0],h=f[1];return{x:g,y:h,width:f[2]-g,height:f[3]-h}}},{key:"bounds",value:function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],b=this.boundingRect(a);return[{x:b.x,y:b.y},{x:b.x+b.width,y:b.y},{x:b.x+b.width,y:b.y+b.height},{x:b.x,y:b.y+b.height}]}}]),b}(h.a)},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var g=c(89),h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=function(a){function b(){return d(this,b),e(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return f(b,a),h(b,[{key:"addChild",value:function(a){if(!(a&&a instanceof g.a))throw new TypeError("Expecting a Node as argument, but got "+a);if(a===this)throw new Error("Can not add itself as child!");if(a._children&&a._children.length&&this.ancestors.indexOf(a)>=0)throw new Error("Can not add an ancestor as child!");a._parent&&a._parent!==this&&a._parent.removeChild(a);var b=this._children.indexOf(a);return b>=0&&this._children.splice(b,1),this._children.push(a),a._parent=this,a._ancestors=null,this}},{key:"addChildren",value:function(a){var b=void 0,c=a?a.length:0;for(b=0;b<c;b++)this.addChild(a[b]);return this}},{key:"removeChild",value:function(a){var b=this._children.indexOf(a);return b>=0&&(this._children.splice(b,1),a._parent=null,a._ancestors=null),this}},{key:"removeChildren",value:function(a){var b=void 0,c=void 0;if(!this._children)return this;if(a)for(c=a.length,b=0;b<c;b++)this.removeChild(a[b]);else for(;this._children.length;)this.removeChild(this._children[0]);return this}}]),b}(g.a);b.a=i},function(a,b,c){function d(a,b){if(!b||!b.length||!a||"function"!=typeof h[a.type])return[];switch(a.type){case"type":return h[a.type](a.value,b);case"attr":return h[a.type](a.attribute,a.operator,a.attributeValue,b);case"universal":return h[a.type](b);default:return[]}}function e(a){var b=[],c=void 0,d=void 0,e=void 0,f=void 0;return a.split(/\s*,\s*/).forEach(function(a){a=a.trim(),c=[];for(var h=function(b){(e=a.match(g[b]))&&(f=!0,a=a.slice(e[0].length),d={type:b,value:e[0]},"attr"===b&&(e=e[0].match(/\[(\w[\w\._-]+)?(?:([!]?=)['\"]([\w\s#_-]*)['\"])?\]/),d.attribute=e[1],d.operator=e[2],d.attributeValue=e[3]),c.push(d))};a&&(f=!1,e=a.match(/^\s*([>+~]|\s)\s*/),e&&(f=!0,c.push({type:" ",value:e[0]}),a=a.slice(e[0].length)),Object.keys(g).forEach(h),c&&c.length&&b.indexOf(c)<0&&b.push(c),f););}),b}function f(a,b){var c=[],f=[],g=void 0,h=void 0;return b.isBranch&&(g=e(a),h=b.descendants,g.forEach(function(a){var b=[],c=h.slice(),e=!1;a.reverse().forEach(function(a){if(" "===a.type)return b.push(c),c=h.slice(),void(e=!1);c=d(a,c),e=!0}),e&&b.push(c);var g=b[0].filter(function(a){for(var c=a.parent,d=void 0,e=1;e<b.length;e++){for(d=b[e].indexOf(c);c&&d<0;)c=c.parent,d=b[e].indexOf(c);if(d<0)return!1}return!0});f.push(g)}),f.forEach(function(a){a.forEach(function(a){c.indexOf(a)<0&&c.push(a)})})),c||[]}var g={type:/^\w[\w-]+/,attr:/^\[\w(?:[\w\._-]+)?(?:[!]?=['\"][\w\s*#_-]*['\"])?\]/,universal:/^(\*)/},h={type:function(a,b){return b.filter(function(b){var c=b.constructor.name;return!!c&&c.toLowerCase()===a.toLowerCase()})},attr:function(a,b,c,d){return d.filter(function(d){var e=d.attrs[a];if(!b)return void 0!==e;if(void 0===e)return!1;switch(b){case"=":return c===String(e);case"!=":return c!==String(e);default:return!1}})},universal:function(a){return a}};b.a={find:f}},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return new(Function.prototype.bind.apply(g,[null].concat(b)))}b.a=e;var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=function(){function a(b){d(this,a),this._bounds=function(){return b.boundingRect(!0)},this._attrs=b.attrs,this._type=b.type,this._data=b.data}return f(a,[{key:"type",get:function(){return this._type}},{key:"data",get:function(){return this._data}},{key:"attrs",get:function(){return this._attrs}},{key:"element",get:function(){return this._element},set:function(a){this._element=a}},{key:"bounds",get:function(){return this._bounds()}}]),a}()},function(a,b,c){function d(){var a=0,b=0,c=0,d=0;c=c||a;var f={move:function(a){this.moveTo(c+a)},moveTo:function(e){var g=Math.max(a,Math.min(b-d,e));c!==g&&(c=g,f.emit("update"))},update:function(e){var g=!1,h=e.min;a=void 0===h?a:h;var i=e.max;b=void 0===i?b:i,void 0!==e.viewSize&&e.viewSize!==d&&(d=e.viewSize,g=!0);var j=Math.max(a,Math.min(b-d,c));c!==j&&(c=j,g=!0),g&&f.emit("update")},getState:function(){return{min:a,max:b,start:c,viewSize:d}}};return e.a.mixin(f),f}var e=c(94);b.a=d},function(a,b,c){function d(a){var b=/\/qDimensionInfo(?:\/(\d+))?/,c=/\/qMeasureInfo\/(\d+)/,d=b.test(a),e=d?b.exec(a):c.exec(a),f=a.substr(0,a.indexOf("/qHyperCube"))+"/qHyperCubeDef",g=0;return null!==e&&(g=+e[1]),{index:g,path:f,type:d?"dimension":"measure"}}function e(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=b.byCells,e=b.primarySource,f=[],g={},h=a.isActive(),i=!1;return a.brushes().forEach(function(a){var b=d(a.id);if("range"===a.type&&"measure"===b.type){var h=a.brush.ranges();h.length&&(i=!0,g.rangeSelectHyperCubeValues||(g.rangeSelectHyperCubeValues={path:b.path,ranges:[]}),g.rangeSelectHyperCubeValues.ranges.push({qMeasureIx:b.index,qRange:{qMin:h[0].min,qMax:h[0].max,qMinInclEq:!0,qMaxInclEq:!0}}))}if("value"===a.type&&"dimension"===b.type)if(c)g.selectHyperCubeCells||(g.selectHyperCubeCells={path:b.path,cols:[]}),g.selectHyperCubeCells.cols.push(b.index),a.id!==e&&(e||g.selectHyperCubeCells.values)||(g.selectHyperCubeCells.values=a.brush.values().map(function(a){return+a}).filter(function(a){return!isNaN(a)}),i=!!g.selectHyperCubeCells.values.length);else{var j=a.brush.values().map(function(a){return+a}).filter(function(a){return!isNaN(a)});i=!!j.length,f.push({params:[b.path,b.index,j,!1],method:"selectHyperCubeValues"})}}),!i&&h?[{method:"resetMadeSelections",params:[]}]:(g.rangeSelectHyperCubeValues&&f.push({method:"rangeSelectHyperCubeValues",params:[g.rangeSelectHyperCubeValues.path,g.rangeSelectHyperCubeValues.ranges]}),g.selectHyperCubeCells&&f.push({method:"selectHyperCubeCells",params:[g.selectHyperCubeCells.path,g.selectHyperCubeCells.values,g.selectHyperCubeCells.cols]}),f)}b.a=e},function(a,b,c){function d(a){function b(a,d){Array.isArray(a)?a.forEach(function(a,c){return b(a,d+"/"+c)}):a&&"object"===(void 0===a?"undefined":j(a))&&Object.keys(a).forEach(function(e){var f=j(a[e]);"qHyperCube"===e||"qListObject"===e?c.push(d+"/"+e):"object"===f&&/^[^q]/.test(e)&&b(a[e],d+"/"+e)})}var c=[];return b(a,""),c}function e(a){return d(a).map(function(b){return c.i(h.a)({id:b})({cube:c.i(i.a)(b,a),localeInfo:a.qLocaleInfo})})}function f(){return c.i(g.a)({tables:e})}var g=c(81),h=c(261),i=c(24);b.a=f;var j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}},function(a,b,c){function d(a,b,d,e){for(var f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,g=c.i(l.a)(a,b),h=new Array(g.length),i=void 0,j=0;j<g.length;j++)i=g[j],void 0!==e&&(i=g[j].qAttrExps.qValues[e]),h[j]={value:i.qNum,index:void 0!==i.qRow?i.qRow:f+j,label:i.qElemNumber in n?n[i.qElemNumber](d):i.qText,id:i.qElemNumber||0};return h}function e(a,b,c,e){var f=[],g=a-b.qArea.qLeft;return g>=0&&g<b.qArea.qLeft+b.qArea.qWidth&&b.qArea.qHeight>0&&(f=d("//"+g,b.qMatrix,c,e,b.qArea.qTop)),f}function f(a){var b=[],c=a.qSubNodes||[],d=[],e={qNum:a.qValue,qElemNumber:a.qElemNo,qText:a.qText,qRow:a.qRow,qAttrExps:a.qAttrExps};if(!c.length)return[[e]];if("P"===c[0].qType){for(var g=0;g<c.length;g++){var h=c[g].qSubNodes.map(f).map(function(a){return a[0]});d.push(h)}var i=d[0];d.slice(1).forEach(function(a){i.forEach(function(b,c){var d=a[c].slice(-1)[0];b.push(d)})}),b=b.concat(d[0])}else for(var j=0;j<c.length;j++)"T"!==c[j].qType&&(b=b.concat(f(c[j])));for(var k=0;k<b.length;k++)b[k].unshift(e);return b}function g(a){for(var b=a?a.qSubNodes:[],c=[],d=0;d<b.length;d++)c=c.concat(f(b[d]));return c}function h(a,b,c,e){return d("//"+a,g(b.qData[0]),c,e)}function i(a){var b=a.colIdx,c=a.pages,d=a.fieldMeta,f=a.attrIdx,g=[];return c.forEach(function(a){a.qMatrix?g=g.concat(e(b,a,d,f)):a.qData&&(g=g.concat(h(b,a,d,f)))}),g}function j(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=a.id;return c.i(k.a)({id:b,formatter:u,min:o,max:p,type:q,tags:r,title:s,values:t})}var k=c(82),l=c(24),m=c(97);b.a=j;var n={"-3":function(a){return"othersLabel"in a?a.othersLabel:""}},o=function(a){return a.meta.qMin},p=function(a){return a.meta.qMax},q=function(a){return"qStateCounts"in a.meta?"dimension":"measure"},r=function(a){return a.meta.qTags},s=function(a){return a.meta.qFallbackTitle},t=function(a){return i({colIdx:a.idx,attrIdx:a.attrIdx,pages:a.pages,fieldMeta:a.meta})},u=function(a){return c.i(m.b)(a.meta,a.localeInfo)}},function(a,b,c){function d(a,b){var d=a.qDimensionInfo.length;return a.qDimensionInfo.concat(a.qMeasureInfo).map(function(e,f){return c.i(l.a)({id:f<d?"/qDimensionInfo/"+f:"/qMeasureInfo/"+(f-d)})({meta:e,pages:a.qDataPages,idx:f,localeInfo:b})})}function e(a,b,d,e){var f=a.qDimensionInfo.length,g=b<f?"/qDimensionInfo/"+b+"/qAttrExprInfo/"+d:"/qMeasureInfo/"+(b-f)+"/qAttrExprInfo/"+d,h=c.i(m.a)(g,a),i=b;return"K"===a.qMode&&b<f&&(i=a.qEffectiveInterColumnSortOrder.indexOf(b)),c.i(l.a)({id:g})({meta:h,pages:"K"===a.qMode?a.qStackedDataPages:a.qDataPages,idx:i,attrIdx:d,localeInfo:e})}function f(a,b){var d=a.qDimensionInfo.length;return a.qDimensionInfo.concat(a.qMeasureInfo).map(function(e,f){var g=f,h=a.qEffectiveInterColumnSortOrder;return f<d&&(g=h.indexOf(f)),c.i(l.a)({id:f<d?"/qDimensionInfo/"+f:"/qMeasureInfo/"+(f-d)})({meta:e,pages:a.qStackedDataPages,idx:g,localeInfo:b})})}function g(a){return[c.i(l.a)({id:"/qDimensionInfo"})({meta:a.qDimensionInfo,pages:a.qDataPages,idx:0})]}function h(a){var b=a.cube;return Array.isArray(b.qDimensionInfo)?"K"===b.qMode?f(b,a.localeInfo):d(b,a.localeInfo):g(b,a.localeInfo)}function i(a,b,c){var d=a.attributeExpressionFields,f=a.idx,g=a.path,h=+p.exec(g)[1];return d[f]||(d[f]=[]),d[f][h]||(d[f][h]=e(b,f,h,c)),d[f][h]}function j(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=a.id,d=c.i(k.a)({id:b,fields:h}),e=[];return d.findField=function(a){var b=d.data(),c=b.cube,f=b.localeInfo,g=d.fields();if(n.test(a)){var h=+n.exec(a)[1],j=a.replace(n,"");return p.test(j)?i({attributeExpressionFields:e,idx:h,path:j},c,f):Array.isArray(c.qDimensionInfo)?g[h]:g[0]}if(o.test(a)){var k=+o.exec(a)[1]+c.qDimensionInfo.length,l=a.replace(o,"");return p.test(l)?i({attributeExpressionFields:e,idx:k,path:l},c,f):g[k]}for(var m=0;m<g.length;m++)if(g[m].title()===a)return g[m]},d}var k=c(83),l=c(260),m=c(24);b.a=j;var n=/^\/(?:qHyperCube\/)?qDimensionInfo(?:\/(\d+))?/,o=/^\/(?:qHyperCube\/)?qMeasureInfo\/(\d+)/,p=/\/qAttrExprInfo\/(\d+)/},function(a,b,c){function d(a,b,d,f,g){function h(a){return i.formatValue(a)}var i=c.i(e.a)(g,a,b,d,f);return h.format=function(a,b,c,d){return i.format(b,a,c,d)},h.pattern=function(a){return a&&(i.pattern=a,i.prepare()),i.pattern},h}var e=c(264);b.a=d},function(a,b,c){function d(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){for(var c=a.length;c<b;c++)a="0"+a;return a}function g(a,b){var c=a.getHours(),d=a.getDay()-1;return b&&((c%=12)||(c=12)),d<0&&(d=6),{year:a.getFullYear(),month:a.getMonth(),day:d,date:a.getDate(),h:c,m:a.getMinutes(),s:a.getSeconds(),f:a.getMilliseconds(),t:a.getHours()>=12?"pm":"am"}}function h(a){var b=a.toString().split(".");return b[1]?b=Number("0."+b[1]):0}function i(a){var b=a,c=24*h(b),d=60*h(c),e=60*h(d),f=1e3*h(e);return{d:Math.floor(b),h:Math.floor(c),m:Math.floor(d),s:Math.floor(e),f:Math.round(f)}}function j(a,b){var c=i(a),d=c.d,e=c.h,f=c.m,g=c.s,h=c.f,j=0,k=void 0;/w+|t+/gi.test(b)&&(k=new Date(1899,11,30+Math.floor(a),0,0,86400*(a-Math.floor(a))),isNaN(k.getTime())&&(k=null)),/D+/gi.test(b)||(e+=24*d),/h+/gi.test(b)||(f+=60*e),/m+/gi.test(b)||(g+=60*f),/w+/gi.test(b)&&(j=k?k.getDay()-1:0)<0&&(j=6);var l="";return k&&(l=k.getHours()>=12?"pm":"am"),{year:0,month:0,day:j,date:d,h:e,m:f,s:g,f:h,t:l}}function k(a,b){return{"Y+|y+":{Y:""+Number((""+b.year).slice(-2)),YY:f((""+b.year).slice(-2),2),YYY:f((""+b.year).slice(-3),3),def:function(a){return f(""+b.year,a.length)}},"M+":{M:b.month+1,MM:f(""+(b.month+1),2),MMM:a.locale_months_abbr[b.month],def:a.locale_months[b.month]},"W+|w+":{W:b.day,WW:f(""+b.day,2),WWW:a.locale_days_abbr[b.day],def:a.locale_days[b.day]},"D+|d+":{D:b.date,def:function(a){return f(""+b.date,a.length)}},"h+|H+":{h:b.h,def:function(a){return f(""+b.h,a.length)}},"m+":{m:b.m,def:function(a){return f(""+b.m,a.length)}},"s+|S+":{s:b.s,def:function(a){return f(""+b.s,a.length)}},"f+|F+":{def:function(a){var c=""+b.f,d=a.length-c.length;if(d>0)for(var e=0;e<d;e++)c+="0";else d<0&&(c=c.slice(0,a.length));return c}},"t{1,2}|T{1,2}":{def:function(a){var c=b.t;return a[0].toUpperCase()===a[0]&&(c=c.toUpperCase()),c=c.slice(0,a.length)}}}}function l(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return new(Function.prototype.bind.apply(s,[null].concat(b)))}var m=c(98);b.a=l;var n=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),o=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],p=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],q=["January","February","March","April","May","June","July","August","September","October","November","December"],r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s=function(){function a(b,c,f){e(this,a);var g=b||{};if(g.qCalendarStrings||(g.qCalendarStrings={qLongDayNames:o,qDayNames:p,qLongMonthNames:q,qMonthNames:r}),this.localeInfo=g,this.locale_days=g.qCalendarStrings.qLongDayNames.slice(),this.locale_days_abbr=g.qCalendarStrings.qDayNames.slice(),this.locale_months=g.qCalendarStrings.qLongMonthNames.slice(),this.locale_months_abbr=g.qCalendarStrings.qMonthNames.slice(),!c){var h;c=(h={},d(h,m.b.TIME,g.qTimeFmt||"hh:mm:ss"),d(h,m.b.DATE,g.qDateFmt||"YYYY-MM-DD"),d(h,m.b.DATE_TIME,g.qTimestampFmt||"YYYY-MM-DD hh:mm:ss"),h)[f]}this.pattern=c}return n(a,[{key:"clone",value:function(){var b=new a(this.localeInfo,this.pattern);return b.subtype=this.subtype,b}},{key:"format",value:function(a,b){b||(b=this.pattern?this.pattern:"YYYY-MM-DD hh:mm:ss"),b=b.replace(/\[.+]|\[|]/g,"");var c=/t+/gi.test(b),d=void 0;d=a instanceof Date?g(a,c):j(a,b);var e=k(this,d),f=[];for(var h in e)Object.prototype.hasOwnProperty.call(e,h)&&f.push(h);var i=new RegExp(f.join("|"),"g");return b.replace(i,function(a){var b=void 0,c=void 0;for(c in e)if(Object.prototype.hasOwnProperty.call(e,c)&&(b=new RegExp(c),b.test(a)))break;if(!b)return"";var d=void 0;for(var f in e[c])if(f===a||f.toLowerCase()===a){d=e[c][f],void 0===d&&(d=e[c][f.toLowerCase()]);break}return void 0===d&&(d=e[c].def),"function"==typeof d&&(d=d(a)),d})}}]),a}()},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a){return a.replace(/[-[\]\/{}()*+?.\\^$|]/g,"\\$&")}function f(a,b,c,d){return a=a.toString(b),c[1]===c[1].toUpperCase()&&(a=a.toUpperCase()),a.length-a.indexOf(".")>10&&(a=a.slice(0,a.indexOf(".")+11)),a.replace(".",d||".")}function g(a,b){for(var c=void 0,d="",e=Number(String(a).slice(-3)),f=(a-e)/1e3,g=[0,1,4,5,9,10,40,50,90,100,400,500,900].reverse(),h=["0","I","IV","V","IX","X","XL","L","XC","C","CD","D","CM"].reverse();e>0;)for(c=0;c<g.length;c++)if(g[c]<=e){d+=h[c],e-=g[c];break}for(c=0;c<f;c++)d="M"+d;return b[1]!==b[1].toUpperCase()&&(d=d.toLowerCase()),d}function h(a,b,c){var d=void 0;return r.test(b)?a=f(a,Number(/\d{2}/.exec(b)[0]),b,c):s.test(b)?a=f(a,8,b,c):t.test(b)?a=f(a,10,b,c):u.test(b)?a=f(a,16,b,c):v.test(b)?a=f(a,2,b,c):w.test(b)&&(d="",a<0&&(d="-",a=-a),a=Math.floor(a),0===a?a="0":a<=5e5?(a=g(a,b),a=d+a):a=b+d+a.toExponential(0)),a}function i(a,b,c){var d=e(a);return c?d:new RegExp(d||"",b)}function j(a,b){return b&&(b=e(b)),a&&(a=e(a)),new RegExp("(?:[#0]+"+a+")?[#0]+(?:"+b+"[#0]+)?")}function k(a,b,c){var d=void 0,e=void 0,f=a.pattern,g=void 0,h=void 0,k=void 0,l=void 0,m=void 0,n=void 0,o=void 0;f.indexOf("A")>=0&&(f=f.replace("A",""),a.abbreviate=!0),o=j(b,c),g=f.match(o),g=g?g[0]:"",h=g?f.substr(0,f.indexOf(g)):f,k=g?f.substring(f.indexOf(g)+g.length):"",g||(g=f?"#":"##########"),b&&b===c&&(d=g.split(c),e=d.pop(),g=d.join("")+c+e,b=""),l=b,b=/,/.test(c)?"¤":",",l&&(g=g.replace(i(l,"g"),b)),m=c,c=".",m&&(g=g.replace(i(m,"g"),c)),n=g.match(/#/g),n=n?n.length:0,a.prefix=h||"",a.postfix=k||"",a.pattern=f,a.percentage=q.test(f),a.numericPattern=g||"",a.numericRegex=new RegExp(i(b,null,!0)+"|"+i(c,null,!0),"g"),a.groupTemp=l,a.decTemp=m,a.t=b,a.d=c,a.temp=n}function l(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return new(Function.prototype.bind.apply(y,[null].concat(b)))}var m=c(194),n=c.n(m);b.a=l;var o=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),p={3:"k",6:"M",9:"G",12:"T",15:"P",18:"E",21:"Z",24:"Y","-3":"m","-6":"μ","-9":"n","-12":"p","-15":"f","-18":"a","-21":"z","-24":"y"},q=/%$/,r=/^\(r(0[2-9]|[12]\d|3[0-6])\)/i,s=/^\(oct\)/i,t=/^\(dec\)/i,u=/^\(hex\)/i,v=/^\(bin\)/i,w=/^\(rom\)/i,x=/^(\(rom\)|\(bin\)|\(hex\)|\(dec\)|\(oct\)|\(r(0[2-9]|[12]\d|3[0-6])\))/i,y=function(){function a(b,c,e,f,g){d(this,a),this.localeInfo=b,this.pattern=c,this.thousandDelimiter=e||",",this.decimalDelimiter=f||".",this.type=g||"numeric",this.prepare()}return o(a,[{key:"clone",value:function(){var b=new a(this.localeInfo,this.pattern,this.thousandDelimiter,this.decimalDelimiter,this.type);return b.subtype=this.subtype,b}},{key:"format",value:function(a,b,c,d){return this.prepare(b,c,d),this.formatValue(a)}},{key:"prepare",value:function(a,b,c){var d=void 0;if(void 0===a&&(a=this.pattern),void 0===b&&(b=this.thousandDelimiter),void 0===c&&(c=this.decimalDelimiter),!a)return void(this._prepared={pattern:!1});this._prepared={positive:{d:c,t:b,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""},negative:{d:c,t:b,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""},zero:{d:c,t:b,abbreviate:!1,isFunctional:!1,prefix:"",postfix:""}},d=this._prepared;var e=this.localeInfo?this.localeInfo.qListSep:";";a=a.split(e),d.positive.pattern=a[0],d.negative.pattern=a[1],d.zero.pattern=a[2],x.test(a[0])&&(d.positive.isFunctional=!0),a[1]?x.test(a[1])&&(d.negative.isFunctional=!0):d.negative=!1,a[2]?x.test(a[2])&&(d.zero.isFunctional=!0):d.zero=!1,d.positive.isFunctional||k(d.positive,b,c),d.negative&&!d.negative.isFunctional&&k(d.negative,b,c),d.zero&&!d.zero.isFunctional&&k(d.zero,b,c)}},{key:"formatValue",value:function(a){var b=this._prepared,c=void 0,d=void 0,e="",f=void 0,g=void 0,i="",j=void 0,k=void 0,l=void 0,m=void 0,o=void 0;if(isNaN(a))return a;if(b.pattern===!1)return a.toString();if(0===a&&b.zero)return b=b.zero,b.pattern;if(a<0&&b.negative?(b=b.negative,a=-a):b=b.positive,j=b.d,k=b.t,b.isFunctional)a=h(a,b.pattern,j);else{if(b.percentage&&(a*=100),b.abbreviate&&(d=Number(Number(a).toExponential().split("e")[1]),(d-=d%3)in p&&(e=p[d],a/=Math.pow(10,d))),f=Math.abs(a),c=b.temp,m=b.numericPattern,o=m.split(j)[1],"I"===this.type&&(a=Math.round(a)),g=a,o||"#"!==m.slice(-1)[0])if(f>=1e15||f>0&&f<=1e-14)a=f?f.toExponential(15).replace(/\.?0+(?=e)/,""):"0";else{var q=Number(a.toFixed(Math.min(20,o?o.length:0)).split(".")[0]),r=m.split(j)[0];if(r+=j,a=n()(r,q)||"0",o){var s=Math.max(0,Math.min(14,o.length)),t=o.replace(/#+$/,"").length,u=(f%1).toFixed(s).slice(2).replace(/0+$/,"");for(l=u.length;l<t;l++)u+="0";u&&(a+=j+u)}else 0===q&&(g=0)}else if(f>=Math.pow(10,c)||f<1||f<1e-4)0===a?a="0":f<1e-4||f>=1e20?(a=g.toExponential(Math.max(1,Math.min(14,c))-1),a=a.replace(/\.?0+(?=e)/,""),i=""):(a=a.toPrecision(Math.max(1,Math.min(14,c))),a.indexOf(".")>=0&&(a=a.replace(a.indexOf("e")<0?/0+$/:/\.?0+(?=e)/,""),a=a.replace(".",j)));else{for(m+=j,c=Math.max(0,Math.min(20,c-Math.ceil(Math.log(f)/Math.log(10)))),l=0;l<c;l++)m+="#";a=n()(m,a)}a=a.replace(b.numericRegex,function(a){return a===k?b.groupTemp:a===j?b.decTemp:""}),g<0&&!/^-/.test(a)&&(a="-"+a)}return b.prefix+a+i+e+b.postfix}}],[{key:"getStaticFormatter",value:function(){return{prepare:function(){},formatValue:function(a){return""+a}}}}]),a}()},function(a,b,c){function d(a){return("undefined"==typeof window?1:window.devicePixelRatio||1)/(a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1)}function e(a,b){b.setTransform(a[0][0],a[1][0],a[0][1],a[1][1],a[0][2],a[1][2])}function f(a,b,c){c.forEach(function(c){var d=c[0],e=c[1];d in b.attrs&&a[e]!==b.attrs[d]&&(a[e]=b.attrs[d])})}function g(a,b,c){a.forEach(function(a){b.save(),f(b,a,c),a.modelViewMatrix&&e(a.modelViewMatrix.elements,b),m.has(a.type)&&m.get(a.type)(a.attrs,{g:b,doFill:"fill"in a.attrs,doStroke:"stroke"in a.attrs&&0!==a.attrs["stroke-width"]}),a.children&&g(a.children,b,c),b.restore()})}function h(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j.a,b=void 0,e=void 0,f=!1,h=n(),i=[["fill","fillStyle"],["stroke","strokeStyle"],["opacity","globalAlpha"],["globalAlpha","globalAlpha"],["stroke-width","lineWidth"]],k=function(){};return k.element=function(){return b},k.root=function(){return b},k.appendTo=function(a){return b||(b=a.ownerDocument.createElement("canvas"),b.style.position="absolute",b.style["-webkit-font-smoothing"]="antialiased",b.style["-moz-osx-font-smoothing"]="antialiased"),a.appendChild(b),b},k.render=function(c){if(!b)return!1;var j=b.getContext("2d"),l=d(j),m=h.scaleRatio.x,n=h.scaleRatio.y;f&&(b.style.left=Math.round(h.x*m)+"px",b.style.top=Math.round(h.y*n)+"px",b.style.width=Math.round(h.width*m)+"px",b.style.height=Math.round(h.height*n)+"px",b.width=Math.round(h.width*l*m),b.height=Math.round(h.height*l*n));var o={type:"container",children:c};1===l&&1===m&&1===n||(o.transform="scale("+l*m+", "+l*n+")");var p=a({items:[o],dpi:l}),q=!e||!p.equals(e),r=f||q;return r&&(k.clear(),g(p.children,j,i)),f=!1,e=p,r},k.itemsAt=function(a){return e?e.getItemsFrom(a):[]},k.findShapes=function(a){return e?e.findShapes(a).map(function(a){return a.element=k.element(),a}):[]},k.clear=function(){b&&(b.width=b.width)},k.size=function(a){if(a){var b=n(a);JSON.stringify(h)!==JSON.stringify(b)&&(f=!0,h=b)}return h},k.destroy=function(){b&&(b.parentElement&&b.parentElement.removeChild(b),b=null),e=null},k.measureText=function(a){var b=a.text,d=a.fontSize,e=a.fontFamily;return c.i(l.a)({text:b,fontSize:d,fontFamily:e})},k}function i(a,b){m.add(a,b)}var j=c(90),k=c(3),l=c(19);b.b=h,b.a=i;var m=c.i(k.a)(),n=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=a.x,c=a.y,d=a.width,e=a.height,f=a.scaleRatio,g={x:0,y:0,width:0,height:0,scaleRatio:{x:1,y:1}};return g.x=isNaN(b)?g.x:b,g.y=isNaN(c)?g.y:c,g.width=isNaN(d)?g.width:d,g.height=isNaN(e)?g.height:e,void 0!==f&&(g.scaleRatio.x=isNaN(f.x)?g.scaleRatio.x:f.x,g.scaleRatio.y=isNaN(f.y)?g.scaleRatio.y:f.y),g}},function(a,b,c){var d=c(265),e=c(270),f=c(267),g=c(268),h=c(271),i=c(269);c.i(d.a)("rect",e.a),c.i(d.a)("circle",f.a),c.i(d.a)("line",g.a),c.i(d.a)("path",i.a),c.i(d.a)("text",h.a),b.a=d.b},function(a,b,c){function d(a,b){var c=b.g,d=b.doFill,e=b.doStroke;c.beginPath(),c.moveTo(a.cx+a.r,a.cy),c.arc(a.cx,a.cy,a.r,0,2*Math.PI,!1),d&&c.fill(),e&&c.stroke()}b.a=d},function(a,b,c){function d(a,b){var c=b.g,d=b.doStroke;c.beginPath(),c.moveTo(a.x1,a.y1),c.lineTo(a.x2,a.y2),d&&c.stroke()}b.a=d},function(a,b,c){function d(a,b){var c=b.g,d=b.doStroke,e=a.d.match(/[a-z][^a-z]*/gi),f=void 0,g=[];c.beginPath();for(var h=0;h<e.length;h++){var i=e[h].match(/([ml])\s?(\S+)(?:\s|,)(\S+)/i),j=i[1],k=+i[2],l=+i[3];switch(j){case"M":f={x:k,y:l},c.moveTo(f.x,f.y);break;case"L":f={x:k,y:l},c.lineTo(f.x,f.y);break;case"m":f={x:f.x+k,y:f.y+l},c.moveTo(f.x,f.y);break;case"l":f={x:f.x+k,y:f.y+l},c.lineTo(f.x,f.y)}g.push(f)}d&&c.stroke()}b.a=d},function(a,b,c){function d(a,b){var c=b.g,d=b.doFill,e=b.doStroke;c.beginPath(),c.rect(a.x,a.y,a.width,a.height),d&&c.fill(),e&&c.stroke()}b.a=d},function(a,b,c){function d(a){return"central"===a?"middle":"text-before-edge"===a?"top":"text-after-edge"===a?"bottom":a}function e(a,b){var e=b.g,i=c.i(g.a)(a,f.a);e.font=a["font-size"]+" "+a["font-family"],e.canvas.dir=c.i(h.a)(a.text);var j="middle"===a["text-anchor"]?"center":a["text-anchor"];e.textAlign=c.i(h.b)(j,e.canvas.dir),e.textBaseline=d(a["dominant-baseline"]),e.fillText(i,a.x+a.dx,a.y+a.dy)}var f=c(19),g=c(100),h=c(96);b.a=e},function(a,b,c){function d(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=a.createElement,d=void 0===b?document.createElement.bind(document):b,h=void 0,i=g(),j=void 0,k=function(){};return k.element=function(){return h},k.root=function(){return h},k.appendTo=function(a){return h||(h=d("div"),h.style.position="absolute",h.style["-webkit-font-smoothing"]="antialiased",h.style["-moz-osx-font-smoothing"]="antialiased"),a.appendChild(h),h},k.render=function(a){if(!h)return!1;var b=i.scaleRatio.x,d=i.scaleRatio.y;h.style.left=Math.round(i.x*b)+"px",h.style.top=Math.round(i.y*d)+"px",h.style.width=Math.round(i.width*b)+"px",h.style.height=Math.round(i.height*d)+"px";var f=c.i(e.a)("div",{},Array.isArray(a)?a:[a]);return j?c.i(e.b)(j,f):c.i(e.b)(h,f),j=f,!0},k.renderArgs=[e.a],k.clear=function(){if(h){for(var a=h.firstChild;a;)h.removeChild(a),a=h.firstChild;j=null}},k.destroy=function(){h&&h.parentElement&&h.parentElement.removeChild(h),h=null},k.size=function(a){return a&&(i=g(a)),i},k.measureText=function(a){var b=a.text,d=a.fontSize,e=a.fontFamily;return c.i(f.a)({text:b,fontSize:d,fontFamily:e})},k}var e=c(274),f=c(19);b.a=d;var g=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=a.x,c=a.y,d=a.width,e=a.height,f=a.scaleRatio,g={x:0,y:0,width:0,height:0,scaleRatio:{x:1,y:1}};return g.x=isNaN(b)?g.x:b,g.y=isNaN(c)?g.y:c,g.width=isNaN(d)?g.width:d,g.height=isNaN(e)?g.height:e,void 0!==f&&(g.scaleRatio.x=isNaN(f.x)?g.scaleRatio.x:f.x,g.scaleRatio.y=isNaN(f.y)?g.scaleRatio.y:f.y),g}},function(a,b,c){var d=c(272);b.a=d.a},function(a,b,c){var d=c(201),e=c.n(d),f=c(199),g=c.n(f),h=c(197),i=c.n(h),j=c(200),k=c.n(j),l=c(198),m=c.n(l),n=c(195),o=c.n(n);c.d(b,"a",function(){return o.a}),c.d(b,"b",function(){return p});var p=e.a.init([g.a,i.a,k.a,m.a])},function(a,b,c){function d(a,b){var c=[],e=void 0,f=[],g=[],h=[],j=void 0,k=void 0,l=function(a){return a.id},m=function(a,b){var c=void 0;return c="object"===(void 0===a?"undefined":i(a))?"id"in a?a.id:b:a,{content:a,id:c+"__"+(a.type||"")}};a.isTree||(a=a.map(m)),b=b.map(m),j=a.map(l),k=b.map(l);for(var n=0,o=b.length;n<o;n++){j.indexOf(b[n].id)===-1?c.push(b[n]):g.push(b[n])}for(var p=0,q=a.length;p<q;p++){k.indexOf(a[p].id)===-1?f.push(a[p]):h.push(a[p])}for(var r=0,s=c.length;r<s;r++)c[r].content.children&&(c[r].diff=d([],c[r].content.children),c[r].children=c[r].diff.updatedNew.concat(c[r].diff.added),c[r].children.isTree=!0);for(var t=0,u=g.length;t<u;t++)g[t].diff=d(h[t].children||[],g[t].content.children||[]),
g[t].object=h[t].object,g[t].children=g[t].diff.items;return e=g.concat(c),c.isTree=!0,f.isTree=!0,g.isTree=!0,h.isTree=!0,e.isTree=!0,{added:c,updatedNew:g,updatedOld:h,removed:f,items:e}}function e(a,b,c){for(var d=0,e=a.length;d<e;d++)a[d].object=c(a[d].content.type,b)}function f(a,b){for(var c=0,d=a.length;c<d;c++)null!==a[c].object&&void 0!==a[c].object&&(b(a[c].object),a[c].object=null)}function g(a,b,c,d){for(var h=void 0,i=0,j=a.length;i<j;i++)h=a[i],null!==h.object&&void 0!==h.object&&(c(h.object,h.content),h.diff&&(e(h.diff.added,h.object,b),f(h.diff.removed,d),g(h.diff.items,b,c,d)))}function h(a,b,c,h,i,j){var k=d(a,b);return e(k.added,c,h),f(k.removed,j),g(k.items,h,i,j),k.items}c.d(b,"a",function(){return h});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}},function(a,b,c){function d(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.a,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f.a,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g.a,j=a(),k=void 0,l=void 0,m=!1,n=i(),o=void 0,p=function(){};return p.element=function(){return k},p.root=function(){return l},p.appendTo=function(a){return k||(k=a.ownerDocument.createElementNS(b,"svg"),k.style.position="absolute",k.style["-webkit-font-smoothing"]="antialiased",k.style["-moz-osx-font-smoothing"]="antialiased",k.setAttribute("xmlns",b),l=a.ownerDocument.createElementNS(b,"g"),k.appendChild(l)),a.appendChild(k),k},p.render=function(a){if(!k)return!1;var b=n.scaleRatio.x,c=n.scaleRatio.y;m&&(k.style.left=Math.round(n.x*b)+"px",k.style.top=Math.round(n.y*c)+"px",k.setAttribute("width",Math.round(n.width*b)),k.setAttribute("height",Math.round(n.height*c)));var e={type:"container",children:a};1===b&&1===c||(e.transform="scale("+b+", "+c+")");var f=d({items:[e]}),g=!o||!f.equals(o),h=m||g;return h&&(p.clear(),j.render(f.children,l)),m=!1,o=f,h},p.itemsAt=function(a){return o?o.getItemsFrom(a):[]},p.findShapes=function(a){return o?o.findShapes(a).map(function(a){return a.element=p.element(),a}):[]},p.clear=function(){if(!l)return p;var a=l.cloneNode(!1);return k.replaceChild(a,l),l=a,p},p.destroy=function(){k&&k.parentElement&&k.parentElement.removeChild(k),k=null,l=null},p.size=function(a){if(a){var b=i(a);JSON.stringify(n)!==JSON.stringify(b)&&(m=!0,n=b)}return n},p.measureText=function(a){var b=a.text,d=a.fontSize,e=a.fontFamily;return c.i(h.a)({text:b,fontSize:d,fontFamily:e})},p}var e=c(277),f=c(99),g=c(90),h=c(19);b.a=d;var i=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=a.x,c=a.y,d=a.width,e=a.height,f=a.scaleRatio,g={x:0,y:0,width:0,height:0,scaleRatio:{x:1,y:1}};return g.x=isNaN(b)?g.x:b,g.y=isNaN(c)?g.y:c,g.width=isNaN(d)?g.width:d,g.height=isNaN(e)?g.height:e,void 0!==f&&(g.scaleRatio.x=isNaN(f.x)?g.scaleRatio.x:f.x,g.scaleRatio.y=isNaN(f.y)?g.scaleRatio.y:f.y),g}},function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(){return new i(f.a,g.b,g.c,g.d)}var f=c(275),g=c(99);b.a=e;var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=function(){function a(b,c,e,f){d(this,a),this.create=b,this.nodeCreator=c,this.nodeMaintainer=e,this.nodeDestroyer=f}return h(a,[{key:"render",value:function(a,b){return this.create([],a,b,this.nodeCreator,this.nodeMaintainer,this.nodeDestroyer)}}]),a}()},function(a,b,c){Object.defineProperty(b,"__esModule",{value:!0});var d=c(44),e=c(101);c(102);c.d(b,"chart",function(){return d.a}),c.d(b,"renderer",function(){return d.b}),c.d(b,"data",function(){return d.c}),c.d(b,"component",function(){return d.d}),c.d(b,"q",function(){return e.a})}])}),define("objects.utils/chart-style-utils",["general.utils/color","core.utils/feature-flags","client.utils/theme/modern/theme","client.utils/theme/theme-module","objects.views/charts/chart-style-service"],function(a,b,c,d,e){return{Theme:d.get(),TRANSPARENT_BLACK:"rgba( 0,0,0,0.2 )",TRANSPARENT_WHITE:"rgba( 255,255,255,0.2 )",LIGHT_GRAY:"#ccc",DARK_GREY:"#666",getContrastingGrey:function(b){var c=new a(b);return 0===c.getAlpha()?this.DARK_GREY:c.isDark()?this.LIGHT_GRAY:this.DARK_GREY},getContrastingTransparent:function(b){var c=new a(b);return 0===c.getAlpha()?this.TRANSPARENT_BLACK:c.isDark()?this.TRANSPARENT_WHITE:this.TRANSPARENT_BLACK},getStyle:function(a,d,f){return a=a||"",this[a+"StyleService"]||(this[a+"StyleService"]=b.THEMING?c.initializeService("object."+a):e.getInstance()),b.THEMING?this[a+"StyleService"].getStyle(d,f):this[a+"StyleService"].getValue(a,d,f)}}}),define("objects.extension/picasso-charts/selection-utils",[],function(){function a(a,b){var c=a.brushes().filter(function(a){return"value"===a.type}),d=[];return c.length&&c.forEach(function(a){d=d.concat(a.brush.values().map(function(b){return{key:a.id,value:b}}))}),d.concat(b)}function b(a,b){var c,d,e,f,g=this,h=[];return b.forEach(function(b){d=a.field(b.key).field,c=d.data().meta,e=c.qStateCounts,(f=e.qOption+e.qSelected)>1&&b.value!==g.DIM_VALUE_NULL&&!c.qLocked&&h.push({key:b.key,value:b.value})}),h}function c(a,b,c){var d=c.slice();return c.forEach(function(c){c.key.indexOf(a)>-1?d.push({key:c.key.replace(a,b),value:c.value}):c.key.indexOf(b)>-1&&d.push({key:c.key.replace(b,a),value:c.value})}),d}return{brushInterceptors:{DIM_VALUE_NULL:-2,brushOnlyOne:a,filterValues:b,linkBrushingSources:c}}}),define("objects.extension/picasso-charts/selection-handler",["objects.extension/default-selection-toolbar","assets/external/picasso/picasso","objects.views/selections/interaction-handler","./selection-utils","util"],function(a,b,c,d,e){function f(a,b,c,d){var e=this;this._chartInstance=a,this._backendApi=b,this._selectionsApi=c,this._hypercubeLocation=d?"/"+d:"",this._ctrlPressed=!1,this._selectionsApiRestorehelper={propertiesToRestore:{}},this._ctrlToggle=function(a){e._ctrlPressed=a},this._keyPressed=function(a){a===q?c.cancel():a===r&&c.confirm()},this._brushLink=null,this._on=!1,this._setupSelections()}function g(){var a=this,e=a._chartInstance.brush("select");e.on("update",function(c,d){if(!(c.length+d.length<1)){var f=b.q.brush(e);if(f.length){if("resetMadeSelections"===f[0].method)return void a._backendApi.model[f[0].method].apply(a._backendApi.model).catch(function(a){console.warn("err",a)});a._backendApi.setPath(a._hypercubeLocation+f[0].params[0]),a._selectionsApi.activate(),a._selectionsApi.selectionsMade=!0}f.forEach(function(b,c){b.params[0]=a._hypercubeLocation+b.params[0],c>0&&b.params[0]!==a._backendApi.path||a._backendApi.model[b.method].apply(a._backendApi.model,b.params).catch(function(a){console.warn("err",a)})})}}),e.intercept("toggle-values",function(b){return a._on&&b.length&&a._layoutHasProperty(a._hypercubeLocation+b[0].key)?(b=d.brushInterceptors.filterValues(a._chartInstance,b),a._brushLink&&(b=d.brushInterceptors.linkBrushingSources(a._brushLink.path1,a._brushLink.path2,b)),a._ctrlPressed&&(b=d.brushInterceptors.brushOnlyOne(e,b)),b.length||a._selectionsApi.activate(),b):[]}),this._bindSelectionsApi(a._chartInstance,a._selectionsApi),c.CtrlToggle.bind(a._ctrlToggle)}function h(a,b){this._brushLink={path1:a,path2:b}}function i(a,b){var d=this,e=d._selectionsApiRestorehelper.propertiesToRestore.clear=b.clear.bind(b);b.clear=function(){a.brush("select").clear(),e()},d._selectionsApiRestorehelper.unbindDeactivated=b.watchDeactivated(function(){a.brush("select").end(),c.KeyPressed.unbind(d._keyPressed)}),d._selectionsApiRestorehelper.unbindActivated=b.watchActivated(function(){c.KeyPressed.bind(d._keyPressed)})}function j(){var a=this;a._selectionsApiRestorehelper.unbindActivated(),a._selectionsApiRestorehelper.unbindDeactivated(),Object.keys(a._selectionsApiRestorehelper.propertiesToRestore).forEach(function(b){a._selectionsApi[b]=a._selectionsApiRestorehelper.propertiesToRestore[b]})}function k(){c.CtrlToggle.unbind(this._ctrlToggle),c.KeyPressed.unbind(this._keyPressed)}function l(a){return!!e.getValue(this._backendApi.model.layout,a.slice(1,a.length).replace(/\//g,"."))}function m(){return new a(this._backendApi,this._selectionsApi,!1,!1,[],[])}function n(){this._on=!1}function o(){this._on=!0}function p(){n(),this._unbindKeyListeners(),this._unbindSelectionsApi()}f.prototype.setupBrushingLink=h,f.prototype.getSelectionToolbar=m,f.prototype.on=o,f.prototype.off=n,f.prototype.destroy=p,f.prototype._setupSelections=g,f.prototype._bindSelectionsApi=i,f.prototype._unbindSelectionsApi=j,f.prototype._unbindKeyListeners=k,f.prototype._layoutHasProperty=l;var q=27,r=13;return f}),define("general.utils/arrow-positioner",[],function(){"use strict";function a(a){return{left:"right",right:"left",top:"bottom",bottom:"top"}[a]}function b(b,c,d,e){var f=a(d),g={left:{width:0,height:.5},right:{width:1,height:.5},top:{width:.5,height:0},bottom:{width:.5,height:1}},h=g[f],i=0,j=0,k=0,l=0,m=c[0].getBoundingClientRect(),n=e.outerWidth();"left"===f||"right"===f?(k=parseInt(c.offset().top+m.height*(1-h.height)-b.offset().top-n*(1-h.height),10),"left"===f?j="auto":i="auto",l="auto"):(i=parseInt(c.offset().left+m.width*(1-h.width)-b.offset().left-n*(1-h.width),10),"bottom"===f?k="auto":l="auto",j="auto"),e.css({left:i,right:j,top:k,bottom:l})}function c(b,c,d,f,g){var h,i,j=a(f),k={left:{width:0,height:.5,size:-1},right:{width:1,height:.5,size:1},top:{width:.5,height:0,size:-1},bottom:{width:.5,height:1,size:1}},l=k[j],m=b[0].getBoundingClientRect(),n=g[0].getBoundingClientRect();"left"===j||"right"===j?(h=l.width*(m.width-n.width)+n.width*l.size-parseInt(b.css("padding-left")),i=d-b.offset().top-n.width*(1-l.height)):(h=c-b.offset().left-n.width*(1-l.width),i=l.height*(m.height-n.height)+n.height*l.size),g.css({left:e(h),top:e(i)})}function d(b,c,d){var e,f,g=a(c),h={left:{width:0,height:.5},right:{width:1,height:.5},top:{width:.5,height:0},bottom:{width:.5,height:1}},i=h[g],j=b.outerWidth(),k=b.outerHeight(),l=d.outerWidth(),m=d.outerHeight();"left"===g||"right"===g?(e=i.width*(j-l),f=d.offset().top-m*(1-i.height)):(e=j*(1-i.width)-l*(1-i.width),f=i.height*(k-m)+m),d.css({left:e,top:f})}var e=Math.floor;return{align:b,alignToParent:d,alignToCoordinate:c}}),define("text!objects.views/charts/tooltip/chart-tooltip.ng.html",[],function(){return'<div ng-switch on="template">\n\t<div qva-direction x-dir-setting={{options.direction}}" ng-switch-when="generic" class="qv-tooltip qvt-generic-tooltip" ng-class="{\'above\':alwaysOnTop}">\n\t\t<div ng-repeat="item in content">\n\t\t\t<div qva-direction x-dir-text="{{item.header}}" x-dir-setting="{{options.direction}}" class="header">\n\t\t\t\t<strong>{{item.header}}</strong>\n\t\t\t</div>\n\t\t\t<table>\n\t\t\t\t<tr ng-repeat="row in item.rows" class="row">\n\t\t\t\t\t<td class=\'item\'>\n\t\t\t\t\t\t<div qva-direction x-dir-text="{{row.content}}" class="rowContent fade-out">{{row.content}}</div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</div>\n\t</div>\n\n\t<div qva-direction x-dir-setting="{{options.direction}}" ng-switch-default class="qv-tooltip qvt-chart-tooltip" qva-press="hideTooltip($event)" tid="qv-chart-tooltip" ng-class="{\'above\':alwaysOnTop}">\n\t\t<div class="immidiate-contextual-arrow"></div>\n\t\t<div class="qv-chart-tooltip-inner">\n\t\t\t<div ng-repeat="item in content" class="qv-chart-tooltip-item">\n\t\t\t\t<div class="qv-chart-tooltip-content">\n\t\t\t\t\t<div qva-direction x-dir-text="{{item.header}}" x-dir-setting="{{options.direction}}" class=\'header\' ng-if="item.header !== undefined">\n\t\t\t\t\t\t<strong>{{item.header}}</strong>\n\t\t\t\t\t</div>\n\t\t\t\t\t<table>\n\t\t\t\t\t\t<tr ng-repeat="row in item.rows" class="row">\n\t\t\t\t\t\t\t<td class=\'item\'>\n\t\t\t\t\t\t\t\t<span qva-direction x-dir-text="{{row.label}}" class="rowPart" ng-class="{\'single\' : (content.length + item.rows.length) <= 3}">{{row.label}}</span>\n\t\t\t\t\t\t\t\t<span>:&nbsp;</span>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td ng-if="!row.template" class=\'value\'>\n\t\t\t\t\t\t\t\t<div class="rowPart" dir="ltr">{{row.value}}</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td ng-if="row.template" class=\'template value\' ng-bind-html="row.template">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="qv-chart-tooltip-excess" ng-if="numberInExcess > 0" q-translation="Object.ChartTooltip.NMore,{{numberInExcess}}">More</div>\n\t</div>\n</div>'}),define("objects.views/charts/tooltip/chart-tooltip-directive",["jquery","touche","qvangular","general.utils/arrow-positioner","general.utils/window-positioner","core.utils/resize","text!./chart-tooltip.ng.html"],function(a,b,c,d,e,f,g){c.directive("qvaChartTooltip",function(){return{template:g,replace:!0,scope:{content:"=",position:"=",visible:"=",direction:"=",template:"=",numberInExcess:"=",target:"=",hideCallback:"=",alwaysOnTop:"=",options:"="},link:function(g,h){var i,j,k=!1;i=function(a){var b=a?"block":"none";h.css("display",b)},g.synchronAlign=function(){var b,c=h.find(".qv-tooltip"),f=h.find(".immidiate-contextual-arrow");i(g.visible);var j=g.direction instanceof Array?g.direction:[g.direction];b=e.alignToBestCoordinate(c,g.position,j,g.target,!1,5,5);var l=c.offset(),m=e.getScrolledRect(a(window));switch(b.position){case"right":l.left+=9,b.y=m.y+Math.min(m.height-25,Math.max(25,b.y-m.y));break;case"left":l.left-=9,b.y=m.y+Math.min(m.height-25,Math.max(25,b.y-m.y));break;case"bottom":l.top+=9,b.x=m.x+Math.min(m.width-25,Math.max(25,b.x-m.x));break;default:l.top-=9,b.x=m.x+Math.min(m.width+m.x-25,Math.max(25,b.x-m.x))}c.offset(l),f.length&&(f.removeClass().addClass("immidiate-contextual-arrow").addClass(b.position),d.alignToCoordinate(c,b.x,b.y,b.position,f)),k=!1},g.align=function(){j=c.getService("$timeout")(g.synchronAlign)},g.$watch("position",function(a){a&&(a instanceof Array||a.x&&a.y)&&(k=!0,g.align())}),g.$watch("visible",function(a){k||i(a)}),g.$watch("content",function(a){a||(g.visible=!1)}),g.hideTooltip=function(a){g.visible=!1,g.hideCallback&&g.hideCallback(),a&&a.stopPropagation&&(a.stopPropagation(),a.preventDefault(),b.preventGestures())},g.$on("$destroy",function(){c.getService("$timeout").cancel(j),f.off("end",g.hideTooltip)}),f.on("end",g.hideTooltip)}}})}),define("objects.views/charts/tooltip/chart-tooltip-component",["./chart-tooltip-directive"],function(){return{transclude:!0,template:'<div qva-chart-tooltip position="position" content="content" direction="direction" visible="visible" template="template" number-in-excess="numberInExcess" target="target" hide-callback="hideCallback" always-on-top="alwaysOnTop" options="options"></div>',controller:["$scope",function(a){a.visible=!1,this.hide=function(){a.visible=!1},this.show=function(b){a.content=b.content,a.position=b.position,a.direction=b.direction,a.template=b.template,a.numberInExcess=b.numberInExcess,a.alwaysOnTop=b.alwaysOnTop,a.visible=!0,a.hideCallback=b.hideCallback,a.target=b.target,a.options={direction:b.dir}}}]}}),define("objects.views/charts/tooltip/chart-tooltip-service",["qvangular","core.utils/notification","./chart-tooltip-component","angular"],function(a,b,c){"use strict";a.service("qvChartTooltipService",["$document","$timeout",function(a,d){function e(){d.cancel(i),i=null,d.cancel(h),h=null}var f,g,h,i,j=a.find("body"),k=angular.element('<div id="qs-chart-tooltip">').appendTo(j),l=!1;return f={open:function(a,b,j){if(l&&g&&g.hide(),e(),!g){var m=a.position;a.position=void 0,g=k.showComponent(c,a),a.position=m}k.attr("dir",a.dir),h=d(function(){b&&(i=d(function(){f.close()},b)),l=!0,g.show(a)},j)},close:function(){this.Closed.emit(),g&&d(function(){g.hide()}),e()},destroy:function(){l&&g&&g.hide(),g=null}},b.create(f,"Closed"),f}])}),define("objects.extension/picasso-charts/tooltip-handler",["qvangular","general.utils/support","util","objects.views/charts/tooltip/chart-tooltip-service"],function(a,b,c){function d(a,b){this._chartInstance=a,this._metaData={hasSecondDimension:!1,measureTitle:"",boxCubePath:"",pointCubePath:"",direction:b},this._on=!1,this._setupBoxTooltip(),this._setupPointTooltip()}function e(a,b){var c,d=a.attrs;return c="line"===a.type?{x:(d.x1+d.x2)/2,y:d.x1===d.x2?Math.min(d.y1,d.y2):(d.y1+d.y2)/2}:"circle"===a.type?{x:d.cx,y:d.cy-d.r-2}:{x:d.x+d.width/2,y:d.y-2},c.x+=b.left,c.y+=b.top,c}function f(a,c){var d=this;a.intercept("set-values",function(a){return d._on?a:[]}),a.on(b.treatAsDesktop()?"update":"set-values",c),a.on("end",h)}function g(c,d,e){var f=b.treatAsDesktop()?500:0;a.getService("qvChartTooltipService").open({position:c,content:d,direction:["top"],dir:e},6e4,f)}function h(){a.getService("qvChartTooltipService").close()}function i(a,b){var c=-1;return a.values().some(function(a,d){return a.label===b&&(c=d,!0)}),c}function j(a){c.extend(!0,this._metaData,a)}function k(a){this._metaData.direction=a}function l(){var a=this._chartInstance.brush(q),b=function(){var b,c,d,f=a.brushes(),j=this._chartInstance.data().table(this._metaData.boxCubePath).fields();if(1===f.length){b=[{header:(this._metaData.hasSecondDimension?f[0].brush.values()[0]+" - ":"")+this._metaData.measureTitle,rows:[]}];var k=i(j[0],f[0].brush.values()[0]);if(k!==-1){if(j[0].values()[k].id===s)return;b[0].rows=j.map(function(a){return{value:a.formatter()(a.values()[k].value),label:a.data().meta.qFallbackTitle}}),this._metaData.hasSecondDimension&&b[0].rows.shift()}c=this._chartInstance.getAffectedShapes(q,"or",["self"],"box-marker").filter(function(a){return"rect"===a.type})[0],c&&(d=e(c,c.element.getBoundingClientRect())),g(d,b,this._metaData.direction)}else h()};this._bindTooltip(a,b.bind(this))}function m(){var a=this._chartInstance.brush(r),b=function(){var b,c,d,f=a.brushes(),i=this._chartInstance.data().table(this._metaData.pointCubePath).fields();if(f.length>=2){var j=i.filter(function(a){return"measure"===a.type()})[0].formatter(),k=f.map(function(a){return a.brush.values()[0]});b={header:k[0],rows:[{label:this._metaData.measureTitle,value:j(k[1])}]},3===f.length?(b.header=k[0]+", "+k[2],c=this._chartInstance.getAffectedShapes(r,"and",["inner","y"],"point-marker")[0]):c=this._chartInstance.getAffectedShapes(r,"and",["inner"],"point-marker")[0],c&&(d=e(c,c.element.getBoundingClientRect())),g(d,[b],this._metaData.direction)}else h()};this._bindTooltip(a,b.bind(this))}function n(){this._on=!1}function o(){this._on=!0}function p(){n()}d.prototype.updateMetaData=j,d.prototype.setDirection=k,d.prototype.on=o,d.prototype.off=n,d.prototype.destroy=p,d.prototype.closeTooltip=h,d.prototype._setupBoxTooltip=l,d.prototype._setupPointTooltip=m,d.prototype._bindTooltip=f;var q="boxTip",r="pointTip",s=-2;return d}),define("objects.extension/picasso-charts/chart-view",["objects.extension/base-view","core.utils/deferred","assets/client/soft-property-panel/soft-property-handler","core.utils/feature-flags","general.utils/support","util","assets/external/picasso/picasso","objects.utils/chart-style-utils","objects.utils/interaction-states","objects.extension/picasso-charts/selection-handler","objects.extension/picasso-charts/tooltip-handler"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function l(a,b,c){c&&(b&&!c.autoMinMax&&(["min","minMax"].contains(c.minMax)&&(b.min=c.min),["max","minMax"].contains(c.minMax)&&(b.max=c.max)),a.settings.forceBounds=!c.autoMinMax&&c.showBounds)}function m(a,c,d){var e,f={qTop:0,qLeft:0,qWidth:c.qSize.qcx,qHeight:1e4/c.qSize.qcx};switch(f=d?{qTop:d.top||0,qLeft:d.left||0,qWidth:d.width||c.qSize.qcx,qHeight:d.height||1e4/c.qSize.qcx}:{qTop:0,qLeft:0,qWidth:c.qSize.qcx,qHeight:1e4/c.qSize.qcx},c.qMode){case"K":e="qStackedDataPages";break;case"S":default:e="qDataPages"}return a.getData([f],null,c).then(function(a){return c[e]=a,b.resolve()})}function n(a){return this.options[a]!==!1}return a.extend({init:function(a,b,d,e,f){this._super(a,b,d,e,f),this._softPropertyHandler=new c(e.model),g.renderer.prio(["canvas"]),this._chartInstance=g.chart({element:this._picassoElement}),this._selectionHandler=new j(this._chartInstance,e,f,this._dataPath),this._tooltipHandler=new k(this._chartInstance,d.direction),this._hasNewData=!1},setInteractionState:function(a){this._super(a);var b=a===i.ANALYSIS;b&&!this._on?this.on():!b&&this._on&&this.off()},hasOption:n,on:function(){this._on||(this._on=!0)},isOn:function(){return this._on},off:function(){this._on&&(this._on=!1)},_updateStyles:function(a){a=a||{};var b,c,e,f,g,i,j;return d.THEMING?(b=h.getStyle(this.chartID,"axis.line.major","color"),c=h.getStyle(this.chartID,"axis.title","fontSize"),f=h.getStyle(this.chartID,"axis.title","color"),g=h.getStyle(this.chartID,"axis.label.name","color"),i=h.getStyle(this.chartID,"axis.label.name","fontSize"),e="QlikView Sans",j="QlikView Sans"):(b=h.getStyle("","axis.line","color"),c=h.getStyle("","axis.title.fontSize","default"),e=h.getStyle("","axis.title","fontFamily"),f=h.getStyle("","axis.title.color","default"),g=h.getStyle("","","color"),i=h.getStyle("","axis.label.fontSize","default"),j=h.getStyle("","axis.label","fontFamily")),a.axis={title:{fontSize:c,fontFamily:e,fill:f},line:{show:!0,strokeWidth:1,stroke:b},labels:{fill:g,fontSize:i,fontFamily:j},ticks:{stroke:b},minorTicks:{stroke:b}},a.gridLines={ticks:{stroke:b},minorTicks:{stroke:b}},a},_createComponents:function(a,b,c){this._chartSettings={components:[]};var d={on:"tap",contexts:["select"],data:["elemNo"],globalPropagation:"stop",propagation:"stop"},g={context:"select",data:["elemNo"],style:{inactive:{opacity:.3}}};if(c.yAxis&&(this._chartSettings.components.push({key:"y-axis",type:"axis",dock:"left",scale:"y",settings:b.axis,brush:{trigger:[d,{on:e.treatAsDesktop()?"over":"tap",action:"set",contexts:["boxTip"],data:["self"],globalPropagation:"stop",propagation:"stop"}],consume:[g]}}),c.yAxis.preferredSize&&(this._chartSettings.components[this._chartSettings.components.length-1].preferredSize=function(){return c.yAxis.preferredSize})),c.xAxis&&this._chartSettings.components.push({key:"x-axis",type:"axis",scale:"x",dock:"bottom",settings:b.axis}),c.xAxisTitle&&this._chartSettings.components.push({key:"x-axis-title",type:"text",dock:"bottom",settings:{style:b.axis.title}}),c.yAxisTitle&&this._chartSettings.components.push({key:"y-axis-title",type:"text",dock:"left",settings:{style:b.axis.title}}),c.boxMarker){var h=f.extend(!0,{minor:{scale:"x"},orientation:"horizontal"},b.box);this._chartSettings.components.push({key:"box-marker",type:"box-marker",settings:h,brush:{trigger:[d,{on:e.treatAsDesktop()?"over":"tap",action:"set",contexts:["boxTip"],data:["self"],globalPropagation:"stop",propagation:"stop"}],consume:[g]}})}if(c.pointMarker){var i=f.extend(!0,{x:{scale:"x"}},b.point);this._chartSettings.components.push({key:"point-marker",type:"point-marker",brush:{trigger:[d,{on:e.treatAsDesktop()?"over":"tap",action:"set",contexts:["pointTip"],data:["inner","x"],globalPropagation:"stop",propagation:"stop"}],consume:[g]},settings:i})}c.gridLines&&this._chartSettings.components.push({displayOrder:-1,key:"grid-line",type:"grid-line",x:c.gridLines.x?{scale:"x"}:null,y:c.gridLines.y?{scale:"y"}:null,ticks:b.gridLines.ticks,minorTicks:b.gridLines.minorTicks}),c.scroll&&(this._chartSettings.scroll={y:{viewSize:c.scroll.viewSize,max:c.scroll.max}},this._chartSettings.components.push({key:"scrollbar",type:"scrollbar",dock:"right",scroll:"y",settings:b.scrollBar})),this.backendApi.isSnapshot&&this._addSnapshotSettings(a)},_getData:m,paint:function(a,b){return this._hasUnpaintedData?(this._style=this._updateStyles(b),this._createChartSettings(b)):this._chartInstance.update({settings:this._chartSettings}),this._tooltipHandler.setDirection(this.options.direction),this._hasUnpaintedData=!1,this._super(a,b)},prePaint:function(a){this._super(a)},updateData:function(){return this._hasUnpaintedData=!0,b.resolve()},destroy:function(){this._super(),this.off(),this._chartInstance.destroy()},getSelectionToolbar:function(){return this._selectionHandler.getSelectionToolbar()},initialize:function(){},refreshSelections:function(){},suppressOnPaint:function(a){return a.qSelectionInfo&&a.qSelectionInfo.qInSelections},_createChartSettings:function(a){this.addAxisSettings(this._chartSettings,a,this.options);var b=f.extend(!0,{},a);this._chartInstance.update({data:{type:"q",data:this._dataPath?b[this._dataPath]:b},settings:this._chartSettings})},_addSnapshotSettings:function(a){this.options.freeResize||(this._chartSettings.dockLayout={logicalSize:{width:a.snapshotData.content.size.w,height:a.snapshotData.content.size.h}})},setSnapshotData:function(a){a.snapshotData.content={size:{w:this.$element.width(),h:this.$element.height()}}},addAxisSettings:function(a,b,c){if(a&&a.scales&&a.components){var d="rtl"===c.direction,e=a.scales.x;e.invert=d;var f=b.measureAxis&&"far"===b.measureAxis.dock?"top":"bottom",g=b.dimensionAxis?b.dimensionAxis.dock:"near",h=d&&"near"===g||!d&&"far"===g?"right":"left";a.components.forEach(function(a){switch(a.key){case"x-axis":a.dock=f,l(a,e,b.measureAxis);break;case"x-axis-title":a.dock=f;break;case"y-axis":case"y-axis-title":a.dock=h;break;case"scrollbar":a.dock=d?"left":"right"}})}}})}),define("extensions.qliktech/boxplot/boxplot-utils",["translator"],function(a){function b(a){var b="Fractile";return 0===a?b="Min":1===a&&(b="Max"),b+"( "+d+", "+a+" )"}function c(a){return"(("+b(.75)+" - "+b(.25)+") * "+a+")"}var d="total {{<OuterDim>}} Aggr( {{InnerMeasure}}, {{OuterDim,}} {{InnerDim}} ) ",e="Median( "+d+" )",f=b(.25),g=b(.75),h="Stdev( "+d+" ) ",i="Avg( "+d+" )",j={BOXELEMENTS:{firstWhisker:{translationKey:"boxplot.firstWhisker"},boxStart:{translationKey:"boxplot.boxStart"},boxMiddle:{translationKey:"boxplot.centerLine"},boxEnd:{translationKey:"boxplot.boxEnd"},lastWhisker:{translationKey:"boxplot.lastWhisker"}},BOXMODES:{TUKEY:{value:"tukey",translation:"properties.boxplot.calculationMode.tukey",calcParameters:[{value:1,label:a.get("properties.boxplot.calculationMode.tukey.short")},{value:1.5,label:a.get("properties.boxplot.calculationMode.tukey.medium")},{value:2,label:a.get("properties.boxplot.calculationMode.tukey.long")}],defaultCalcParam:1.5,getBoxExpressions:function(a){a=a||this.defaultCalcParam;var b=c(a);return{firstWhisker:"("+f+" - "+b+")",boxStart:f,boxMiddle:e,boxEnd:g,lastWhisker:"("+g+" + "+b+")"}}},FRACTILES:{value:"fractiles",translation:"properties.boxplot.calculationMode.fractiles",calcParameters:[{value:0,label:a.get("properties.boxplot.calculationMode.fractiles.minmax")},{value:.01,label:a.get("properties.boxplot.calculationMode.fractiles.first")},{value:.05,label:a.get("properties.boxplot.calculationMode.fractiles.fifth")},{value:.1,label:a.get("properties.boxplot.calculationMode.fractiles.tenth")}],defaultCalcParam:.01,getBoxExpressions:function(a){return isNaN(a)&&(a=this.defaultCalcParam),{firstWhisker:b(a),boxStart:f,boxMiddle:e,boxEnd:g,lastWhisker:b(1-a)}}},STDDEV:{value:"stdDev",translation:"properties.boxplot.calculationMode.stdDev",calcParameters:[{value:2,label:a.get("properties.boxplot.calculationMode.stdDev.short")},{value:3,label:a.get("properties.boxplot.calculationMode.stdDev.medium")},{value:4,label:a.get("properties.boxplot.calculationMode.stdDev.long")}],defaultCalcParam:3,getBoxExpressions:function(a){return a=a||this.defaultCalcParam,{firstWhisker:"("+i+" - "+a+" *("+h+"))",boxStart:i+" - "+h,boxMiddle:i,boxEnd:i+" + "+h,lastWhisker:"("+i+" + "+a+" *("+h+"))"}}}}};return j.getDefaultName=function(b,c){var d=c.mode,e=c.calculationParameters[d];if(d===j.BOXMODES.FRACTILES.value&&"firstWhisker"===b||"lastWhisker"===b){var f="",g="firstWhisker"===b;switch(e){case 0:f=g?".min":".max";break;case.01:f=g?".first":".ninetynineth";break;case.05:f=g?".fifth":".ninetyfifth";break;case.1:f=g?".tenth":".ninetieth"}b+=f}return a.get("properties.boxplot.calculationMode."+d+".elements."+b,e)},j}),define("extensions.qliktech/boxplot/boxplot-sorting-settings",[],function(){var a={PROPERTIES:{AUTO_SORT_REF:"box.sorting.autoSort",SORT_CRITERIA_REF:"box.sorting.sortCriteria",BOX_ELEMENT_REF:"box.sorting.boxElement",EXPRESSION_REF:"box.sorting.expression"},SORTINGS:{DEFAULT:{BOX_ELEMENT:"boxMiddle",SORT_BY_EXPRESSION:1,SORT_BY_ASCII:void 0,SORT_BY_NUMERIC:void 0,SORT_BY_LOAD_ORDER:1}}};return Object.freeze(a.SORTINGS.DEFAULT),Object.freeze(a.SORTINGS),Object.freeze(a.PROPERTIES),Object.freeze(a),a}),define("extensions.qliktech/boxplot/boxplot-sorting-service",["util","translator","./boxplot-utils","./boxplot-sorting-settings"],function(a,b,c,d){function e(a){return a.qUndoExclude.box.qHyperCubeDef.qMeasures.map(f)}function f(a){return{id:a.boxElement,label:h(a.boxElement),exp:a.qDef.qDef,isDefault:g(a)}}function g(a){return a.boxElement===d.SORTINGS.DEFAULT.BOX_ELEMENT}function h(a){var d=c.BOXELEMENTS[a].translationKey;return b.get(d)}function i(b){var c=l(b),e=c.qDef.qSortCriterias[0];a.setValue(e,"qSortByExpression",d.SORTINGS.DEFAULT.SORT_BY_EXPRESSION),a.setValue(e,"qSortByAscii",d.SORTINGS.DEFAULT.SORT_BY_ASCII),a.setValue(e,"qSortByNumeric",d.SORTINGS.DEFAULT.SORT_BY_NUMERIC),a.setValue(e,"qSortByLoadOrder",d.SORTINGS.DEFAULT.SORT_BY_LOAD_ORDER),e.qExpression||(e.qExpression={});var f=m(b);e.qExpression.qv=f.qDef.qDef}function j(b){i(b);var c=m(b);b.box.sorting.boxElement=c.boxElement;var d=l(b),e=d.qDef.qSortCriterias[0];b.box.sorting.sortCriteria={},a.setValue(b.box.sorting.sortCriteria,"sortByExpression",e.qSortByExpression),a.setValue(b.box.sorting.sortCriteria,"sortByAscii",e.qSortByAscii),a.setValue(b.box.sorting.sortCriteria,"sortByNumeric",e.qSortByNumeric),a.setValue(b.box.sorting.sortCriteria,"sortByLoadOrder",e.qSortByLoadOrder)}function k(b){var c=l(b),d=c.qDef.qSortCriterias[0];if(a.setValue(d,"qSortByExpression",b.box.sorting.sortCriteria.sortByExpression),a.setValue(d,"qSortByAscii",b.box.sorting.sortCriteria.sortByAscii),a.setValue(d,"qSortByNumeric",b.box.sorting.sortCriteria.sortByNumeric),a.setValue(d,"qSortByLoadOrder",b.box.sorting.sortCriteria.sortByLoadOrder),b.box.sorting.boxElement){var e=n(b.box.sorting.boxElement,b);d.qExpression.qv=e.qDef.qDef}else d.qExpression.qv=b.box.sorting.expression}function l(a){return a.qUndoExclude.box.qHyperCubeDef.qDimensions[0]}function m(a){var b=a.qUndoExclude.box.qHyperCubeDef.qMeasures,c=b.filter(g);if(0===c.length)throw new Error("Could not find any measure element matching the specified default box element '"+d.SORTINGS.DEFAULT.BOX_ELEMENT+"'");return c[0]}function n(a,b){var c=b.qUndoExclude.box.qHyperCubeDef.qMeasures,d=c.filter(function(b){return b.boxElement===a});if(0===d.length)throw new Error("Could not find any measure element matching the specified box element '"+a+"'");return d[0]}return{getElements:e,applyAutoSorting:i,applyDefaultCustomSorting:j,applyCustomSorting:k}}),define("extensions.qliktech/boxplot/boxplot-properties",["client.utils/property-resolver","./boxplot-utils","objects.utils/chart-style-utils","./boxplot-sorting-settings","./boxplot-sorting-service"],function(a,b,c,d,e){function f(a){return a.box.qHyperCubeDef.qDimensions.length>1}function g(b){return a.getValue(b,d.PROPERTIES.AUTO_SORT_REF,0)}function h(b){return 0!==a.getValue(b,d.PROPERTIES.SORT_CRITERIA_REF+".sortByExpression",0)}function i(b){return 0!==a.getValue(b,d.PROPERTIES.SORT_CRITERIA_REF+".sortByNumeric",0)}function j(b){return 0!==a.getValue(b,d.PROPERTIES.SORT_CRITERIA_REF+".sortByAscii",0)}function k(b){return{get:function(a,c,d){if(d.layout.box&&!d.layout.box.elements[b]){var e=d.properties.qUndoExclude.box.qHyperCubeDef.qMeasures.filter(function(a){return a.boxElement===b})[0];return e?e.qDef.qDef:""}return a(c.type)},set:function(b,c,d){var e=a.getDefaultValue(d.type,d);c(d.type,b,e)}}}function l(c){return{get:function(a,d,e){return e.layout.box&&!e.layout.box.elements[c+"Name"]?b.getDefaultName(c,e.layout.box):a(d.type)},
set:function(b,c,d){var e=a.getDefaultValue(d.type,d);c(d.type,b,e)}}}function m(b,c){return a.getValue(c.properties,"box.qHyperCubeDef.qDimensions",[])[0]!==b}function n(a){return!(a.box&&a.box.autoCalculations)}var o={translation:"properties.colors",type:"items",items:{colors:{type:"items",items:{boxColor:{ref:"color.box.paletteColor",translation:"properties.boxplot.boxColor",type:"object",component:"color-picker",dualOutput:!0,defaultValue:function(){var a=c.getStyle("boxPlot","box.box","fill");return{index:c.Theme.currentPalette.indexOf(a),color:a}}},outlierColor:{ref:"color.point.paletteColor",translation:"properties.boxplot.outlierColor",type:"object",component:"color-picker",dualOutput:!0,defaultValue:function(){var a=c.Theme.dataColors.primaryColor;return{index:c.Theme.currentPalette.indexOf(a),color:a}}}}}}},p={type:"items",translation:"properties.presentation",items:{showWhiskers:{ref:"whiskers.show",translation:"properties.boxplot.showWhiskers",type:"boolean",defaultValue:!0},showGridlines:{ref:"gridlines.show",translation:"properties.gridLine.show",type:"boolean",defaultValue:!0}}},q={uses:"axis.picasso.measureAxis"},r={uses:"axis.picasso.dimensionAxis",show:function(a,b,c){return c.layout.box.qHyperCube.qDimensionInfo.length>1}},s={uses:"settings",items:{presentation:p,colors:o,measureAxis:q,dimensionAxis:r}},t={type:"items",translation:"properties.sorting",sortIndexRef:"box.qHyperCubeDef.qInterColumnSortOrder",allowMove:!0,schemaIgnore:!0,grouped:!1,items:{autoSort:{uses:"dimensions-sorting.items.autoSort",ref:d.PROPERTIES.AUTO_SORT_REF,show:f,change:function(a){var b=!!a.box.sorting.sortCriteria;g(a)||b||e.applyDefaultCustomSorting(a)}},sortingItems:{type:"items",grouped:!0,show:function(a){return f(a)&&!g(a)},items:{expression:{type:"items",items:{expressionToggled:{uses:"dimension-sorting-items.expression.items.expressionToggled",ref:d.PROPERTIES.SORT_CRITERIA_REF+".sortByExpression"},sortByElement:{component:"sort-by-element",expressionRef:d.PROPERTIES.EXPRESSION_REF,elementRef:d.PROPERTIES.BOX_ELEMENT_REF,show:h,elements:function(a){return e.getElements(a.properties)}},expressionOrder:{uses:"dimension-sorting-items.expression.items.expressionOrder",ref:d.PROPERTIES.SORT_CRITERIA_REF+".sortByExpression",show:h}}},numeric:{uses:"dimension-sorting-items.numeric",items:{numericToggled:{ref:d.PROPERTIES.SORT_CRITERIA_REF+".sortByNumeric"},numericOrder:{ref:d.PROPERTIES.SORT_CRITERIA_REF+".sortByNumeric",show:i}}},ascii:{uses:"dimension-sorting-items.ascii",items:{asciiToggled:{ref:d.PROPERTIES.SORT_CRITERIA_REF+".sortByAscii"},asciiOrder:{ref:d.PROPERTIES.SORT_CRITERIA_REF+".sortByAscii",show:j}}},defaultSortMessage:{uses:"dimension-sorting-items.defaultSortMessage",show:function(a){return!h(a)&&!i(a)&&!j(a)}}}},noData:{component:"no-data",show:function(a){return!f(a)}}}},u={type:"items",component:"expandable-items",translation:"properties.addons",items:{dataHandling:{uses:"dataHandling",items:{suppressZero:{ref:"box.qHyperCubeDef.qSuppressZero",show:!1},calcCond:{type:"items",items:{expr:{ref:"box.qHyperCubeDef.qCalcCond"},customErrorMessage:{ref:"box.qHyperCubeDef.customErrorMessage.calcCond",show:function(b){var c=a.getValue(b,"box.qHyperCubeDef.qCalcCond");return c.qv&&""!==c.qv}}}}}}}};return{type:"items",component:"accordion",items:{data:{translation:"Common.Data",type:"items",items:{innerData:{uses:"data",items:{dimensions:{ref:"box.qHyperCubeDef.qDimensions",disabledRef:"box.qHyperCubeDef.qLayoutExclude.qHyperCubeDef.qDimensions",items:{nullSuppression:{show:m},dimensionLimits:{show:m},others:{show:m}}},measures:{uses:"measures",ref:"box.qHyperCubeDef.qMeasures",disabledRef:"box.qHyperCubeDef.qLayoutExclude.qHyperCubeDef.qMeasures"}}}}},boxDataSettings:{type:"items",translation:"boxplot.boxElements",items:{boxPlotAutoCalculations:{ref:"box.autoCalculations",translation:"properties.boxplot.usePreset",component:"switch",type:"boolean",defaultValue:!0,undefinedValue:!1,options:[{value:!0,translation:"properties.on"},{value:!1,translation:"properties.off"}]},boxPlotMode:{ref:"box.mode",translation:"properties.boxplot.preset",type:"string",component:"dropdown",options:[{value:b.BOXMODES.TUKEY.value,translation:b.BOXMODES.TUKEY.translation},{value:b.BOXMODES.FRACTILES.value,translation:b.BOXMODES.FRACTILES.translation},{value:b.BOXMODES.STDDEV.value,translation:b.BOXMODES.STDDEV.translation}],defaultValue:b.BOXMODES.TUKEY.value,show:function(a){return!n(a)}},tukeyCalcParam:{ref:"box.calculationParameters.tukey",translation:"properties.boxplot.whiskerLength",type:"number",component:"dropdown",options:b.BOXMODES.TUKEY.calcParameters,defaultValue:b.BOXMODES.TUKEY.defaultCalcParam,show:function(a){return!n(a)&&a.box.mode===b.BOXMODES.TUKEY.value}},fractilesCalcParam:{ref:"box.calculationParameters.fractiles",translation:"properties.boxplot.whiskerPosition",type:"number",component:"dropdown",options:b.BOXMODES.FRACTILES.calcParameters,defaultValue:b.BOXMODES.FRACTILES.defaultCalcParam,show:function(a){return!n(a)&&a.box.mode===b.BOXMODES.FRACTILES.value}},stddevCalcParam:{ref:"box.calculationParameters.stdDev",translation:"properties.boxplot.whiskerLength",type:"number",component:"dropdown",options:b.BOXMODES.STDDEV.calcParameters,defaultValue:b.BOXMODES.STDDEV.defaultCalcParam,show:function(a){return!n(a)&&a.box.mode===b.BOXMODES.STDDEV.value}},customGroups:{component:"expandable-items",show:n,items:{centerLine:{type:"items",translation:"boxplot.centerLine",items:{name:{ref:"box.elements.boxMiddleName",type:"string",expression:"optional",translation:"Common.Name",resolveFunctions:l("boxMiddle")},expression:{ref:"box.elements.boxMiddle",component:"expression",translation:"Common.Expression",resolveFunctions:k("boxMiddle")}}},boxEdges:{type:"items",grouped:!0,translation:"boxplot.boxEdges",items:{boxStart:{type:"items",items:{name:{ref:"box.elements.boxStartName",type:"string",expression:"optional",translation:"properties.boxplot.boxStartName",resolveFunctions:l("boxStart")},expression:{ref:"box.elements.boxStart",component:"expression",translation:"properties.boxplot.boxStartExpression",resolveFunctions:k("boxStart")}}},boxEnd:{type:"items",items:{name:{ref:"box.elements.boxEndName",type:"string",expression:"optional",translation:"properties.boxplot.boxEndName",resolveFunctions:l("boxEnd")},expression:{ref:"box.elements.boxEnd",component:"expression",translation:"properties.boxplot.boxEndExpression",resolveFunctions:k("boxEnd")}}}}},whiskers:{type:"items",grouped:!0,translation:"boxplot.whiskers",items:{firstWhisker:{type:"items",items:{name:{ref:"box.elements.firstWhiskerName",type:"string",expression:"optional",translation:"properties.boxplot.firstWhiskerName",resolveFunctions:l("firstWhisker")},expression:{ref:"box.elements.firstWhisker",component:"expression",translation:"properties.boxplot.firstWhiskerExpression",resolveFunctions:k("firstWhisker")}}},lastWhisker:{type:"items",items:{name:{ref:"box.elements.lastWhiskerName",type:"string",expression:"optional",translation:"properties.boxplot.lastWhiskerName",resolveFunctions:l("lastWhisker")},expression:{ref:"box.elements.lastWhisker",component:"expression",translation:"properties.boxplot.lastWhiskerExpression",resolveFunctions:k("lastWhisker")}}}}}}},outliers:{ref:"box.includeOutliers",translation:"properties.boxplot.includeOutliers",type:"boolean",defaultValue:!0,show:function(a){var c=a.box.mode,d=a.box.calculationParameters[c];return!(!n(a)&&c===b.BOXMODES.FRACTILES.value&&0===d)}}}},sorting:t,addons:u,settings:s}}}),define("extensions.qliktech/boxplot/boxplot-data",[],function(){return{measures:{min:1,max:1,add:function(){},move:function(){},remove:function(){}},dimensions:{min:1,max:2,add:function(){},move:function(){},remove:function(){}}}}),define("extensions.qliktech/boxplot/boxplot-explore-properties",[],function(){function a(a){return{uses:"data",hyperCubePath:a,items:{dimensions:{ref:"box.qHyperCubeDef.qDimensions",alternativeRef:"box.qHyperCubeDef.qLayoutExclude.qHyperCubeDef.qDimensions",type:"items"},measures:{ref:"box.qHyperCubeDef.qMeasures",alternativeRef:"box.qHyperCubeDef.qLayoutExclude.qHyperCubeDef.qMeasures",type:"items"}}}}var b={type:"items",items:{header:{component:"header",translation:"properties.boxplot.calculations"},outliers:{ref:"box.includeOutliers",translation:"properties.boxplot.includeOutliers",type:"boolean"}}};return{get:function(c){return{type:"items",component:"accordion",items:{data:{translation:"Common.Data",icon:"database",type:"items",items:{innerData:a(c),boxDataSettings:b}}}}}}}),define("extensions.qliktech/boxplot/boxplot-scrolling",["core.utils/class","core.utils/deferred","objects.utils/event-utils","objects.views/charts/utils/pan-scroll-controller","objects.backend-api/cache-cube","objects.backend-api/stacked-cube-slicer"],function(a,b,c,d,e,f){"use strict";function g(a){var b=this,d=b.backendApi&&b.backendApi.model?b.backendApi.model.layout:void 0,e=!!d&&d.box.qHyperCube.qDimensionInfo.length>1;if(b._chartInstance&&e){a.preventDefault();var f=c.getMouseWheelData(a.originalEvent);if(f.delta){var g=f.delta<0?3:-3;b._chartInstance.scroll("y").move(g)}}}function h(a){this._boxplot.backendApi.cacheCube.setOptions(a),this._boxplot._outliersCacheCube&&this._boxplot._outliersCacheCube.setOptions(a)}function i(){var a=this._boxplot._chartInstance.scroll("y");if(a){var b=this.getNumberOfVisibleItems();a.update({viewSize:b}),this._boxplot._chartSettings&&this._boxplot._chartSettings.scroll&&(this._boxplot._chartSettings.scroll.y.viewSize=b)}}function j(){var a=this._boxplot._chartInstance.scroll("y");return a?Math.round(a.getState().start):0}function k(a){var b=j.call(this),c=this.getNumberOfVisibleItems();return Math.max(0,Math.min(b+c,a)-c)}function l(a,b){var c=this.getNumberOfVisibleItems();return Math.max(1,Math.min(c,b-a))}function m(){var a=this._boxplot.$element.height()||0,b=Math.floor(a/this.getItemSize());this.setNumberOfVisibleItems(b)}return a.extend({init:function(a,b){this._boxplot=a,this.registerScroll(b)},registerScroll:function(a){var b=this,c=this._boxplot,e=a[0],f=a.find(".box-layer"),g=f[0];this._scrollController=new d(g,e),this._scrollController.PanUpdate.bind(function(a){c._chartInstance&&c._chartInstance.scroll("y").move(-a.y/b.getItemSize())})},getSlicedData:function(a){var c=this._boxplot,d=a.qUndoExclude.box.qHyperCube.qSize.qcy,e=k.call(this,d),f=l.call(this,e,d),g={top:e,height:f,left:0,width:a.qUndoExclude.box.qHyperCube.qSize.qcx},h=c._getData(c.backendApi,a.qUndoExclude.box.qHyperCube,g);if(!a.box.includeOutliers)return h;var i={top:e,height:f,left:0,width:a.qUndoExclude.outliers.qHyperCube.qSize.qcx},j=c._getData(c._outliersCacheCube,a.qUndoExclude.outliers.qHyperCube,i);return b.all([h,j])},updateOutliersCache:function(a){var b=this._boxplot,c=a.box.qHyperCube.qDimensionInfo.length>1;b._outliersCacheCube||(b._outliersCacheCube=new e(b.backendApi.model,"qDataPages","/qUndoExclude/outliers/qHyperCubeDef",b.backendApi.cacheCube.options),b._outliersCacheCube.setMethodName("getHyperCubeStackData"),b._outliersCacheCube.cube=new f,this.getNumberOfVisibleItems()&&b._outliersCacheCube.setOptions({height:3*this.getNumberOfVisibleItems(),width:6})),b._outliersCacheCube.setCubeSize(c?a.qUndoExclude.box.qHyperCube.qSize:a.qUndoExclude.outliers.qHyperCube.qSize)},getPicassoScrollSettings:function(a){return{viewSize:this.getNumberOfVisibleItems(),max:a.qUndoExclude&&a.qUndoExclude.box&&a.qUndoExclude.box.qHyperCube?a.qUndoExclude.box.qHyperCube.qSize.qcy:0}},onResize:function(){m.call(this)},on:function(){var a=this._boxplot;a.$element.on("mousewheel.boxplotScrolling DOMMouseScroll.boxplotScrolling",g.bind(a)),this._scrollController.on()},off:function(){this._boxplot.$element.off(".boxplotScrolling"),this._scrollController.off()},shouldGetNewData:function(a){var b=a.qUndoExclude.box.qHyperCube.qDataPages[0],c=a.qUndoExclude.box.qHyperCube.qSize.qcy;return Math.min(this.getNumberOfVisibleItems(),c)!==b.qMatrix.length},getNumberOfVisibleItems:function(){return void 0===this._numberOfVisibleItems&&m.call(this),this._numberOfVisibleItems},setNumberOfVisibleItems:function(a){a=Math.max(a,1),this._numberOfVisibleItems!==a&&(this._numberOfVisibleItems=a,h.call(this,{height:3*this._numberOfVisibleItems,width:6}),i.call(this))},getItemSize:function(){return 30},resetScroll:function(){var a=this._boxplot,b=a._chartInstance.scroll("y");b&&b.moveTo(0)},destroy:function(){this._boxplot._outliersCacheCube&&this._boxplot._outliersCacheCube.destroy()}})}),define("extensions.qliktech/boxplot/boxplot-api",["objects.backend-api/stacked-api"],function(a){"use strict";return a.extend("BoxPlotApi",{setPaths:function(a){this._paths=a},beginSelections:function(){return this.model.app.switchModalSelection(this.model,this._paths)}})}),define("text!extensions.qliktech/boxplot/boxplot.ng.html",[],function(){return'<div class="box-layer" style="width:100%; height:100%; position:absolute;"></div>\n<span class="qv-viz-center-disclaimer" ng-if="dataAttributes.noDataExist  && dataAttributes.layoutMode > 2" q-translation="Object.Disclaimer.NoDataExist" q-title-translation="Object.Disclaimer.NoDataExist" dir="ltr"></span>\n<div qva-chart-disclaimer attributes="dataAttributes" visible="!dataAttributes.noDataExist" direction="options.direction"></div>'}),define("general.models/library/measure",["core.models/base-object","core.models/app"],function(a,b){"use strict";var c;return c=a.extend("Measure",{clone:function(){return this._super("CloneMeasure")},getLinkedObjects:function(){return this.rpc("GetLinkedObjects","qItems",[])}},{listProperties:{qMeasureListDef:{qType:"measure",qData:{title:"/qMetaDef/title",tags:"/qMetaDef/tags"}}}}),c.get=function(a,c){function d(){return c.enigmaModel.getMeasure(a)}return c=c||b.current,this.getModel(a,c.session,d)},c.create=function(b,d){return a.create.call(c,b,"CreateMeasure",d)},c.remove=function(b,c){return a.remove(b,"DestroyMeasure",c)},c}),define("extensions.qliktech/boxplot/boxplot-cubes-generator",["util","core.utils/deferred","general.models/library/dimension","general.models/library/measure","./boxplot-utils","./boxplot-sorting-service"],function(a,b,c,d,e,f){function g(a,b,c,d,f,g){if(g.calculationParameters){var h;switch(a){case e.BOXMODES.TUKEY.value:h=e.BOXMODES.TUKEY.getBoxExpressions(g.calculationParameters.tukey);break;case e.BOXMODES.STDDEV.value:h=e.BOXMODES.STDDEV.getBoxExpressions(g.calculationParameters.stdDev);break;case e.BOXMODES.FRACTILES.value:h=e.BOXMODES.FRACTILES.getBoxExpressions(g.calculationParameters.fractiles)}return h?j(h[b],c,d,f):""}}function h(a){return new RegExp(a,"g")}function i(a){var b=a.replace(/^(\"|\[)|(\"|\])$/g,"");return b?"["+b+"]":""}function j(a,b,c,d){return c=i(c),d=i(d),a.replace(h("{{<OuterDim>}}"),d?"<"+d+">":"").replace(h("{{InnerMeasure}}"),b).replace(h("{{OuterDim,}}"),d?d+",":"").replace(h("{{InnerDim}}"),c)}function k(a,b){for(var c in b)a=a.replace("{{"+c+"}}",b[c]);return a}function l(a){var c=[];return a.qDimensions.forEach(function(b,d){b.qLibraryId?c.push(m(a,"dimension",d)):c.push(b.qDef.qFieldDefs[0])}),a.qMeasures.forEach(function(b,d){b.qLibraryId?c.push(m(a,"measure",d)):c.push(b.qDef.qDef)}),b.all(c)}function m(a,b,e){var f="dimension"===b?"qDimensions":"qMeasures",g=a[f][e].qLibraryId;return("dimension"===b?c:d).get(g).then(function(a){return a.getProperties().then(function(a){return"dimension"===b?a.qDim.qFieldDefs[0]:a.qMeasure.qDef})})}function n(a,b,c){var d;return a=i(a),c?(c=i(c),d="=aggr( if( "+b+", "+c+"), "+a+", "+c+" )"):d="=aggr( if( "+b+", "+a+"), "+a+" )",d}function o(b){b.qUndoExclude=b.qUndoExclude||{},b.qUndoExclude.box=b.qUndoExclude.box||{qHyperCubeDef:{}};var c=b.qUndoExclude.box.qHyperCubeDef;c.qDimensions=[],c.qMeasures=[];var d,h,i,m,o=b.box,q=o.qHyperCubeDef,r=o.mode,s=a.extend(!0,{},q.qDimensions[0]),t=q.qMeasures[0],u=q.qDimensions.length,v=o.elements,w=b.box.sorting.autoSort,x=2===b.box.qHyperCubeDef.qDimensions.length;return q.qDimensions[1]&&(d=a.extend(!0,{},q.qDimensions[1]),c.qDimensions.push(d)),l(o.qHyperCubeDef).then(function(l){var y=d?l[1]:"";if(Object.keys(e.BOXELEMENTS).forEach(function(b){i=!o.autoCalculations&&v&&o.elements[b]?v[b]:g(r,b,l[u],l[0],y,o),m=a.extend(!0,{},t),m.qDef.qDef=i,m.qDef.cId=a.generateId(),m.boxElement=b,m.qDef.qLabel=v&&v[b+"Name"]?v[b+"Name"]:e.getDefaultName(b,o),delete m.qLibraryId,c.qMeasures.push(m)}),x){(w?f.applyAutoSorting:f.applyCustomSorting)(b)}if(o.includeOutliers){b.qUndoExclude.outliers=b.qUndoExclude.outliers||{qHyperCubeDef:{}};var z=b.qUndoExclude.outliers.qHyperCubeDef;z.qMode="K",z.qDimensions=[],z.qMeasures=[],i=k(j(p,l[u],l[0],y),{FirstWhisker:c.qMeasures[0].qDef.qDef.replace(/^=/,""),LastWhisker:c.qMeasures[4].qDef.qDef.replace(/^=/,"")}),m=a.extend(!0,{},t),z.qMeasures.push(m),z.qDimensions.push(s),h=a.extend(!0,{},d?q.qDimensions[1]:q.qDimensions[0]),h.qNullSuppression=!0,h.qDef.cId=a.generateId(),h.qDef.qFieldDefs=[n(l[0],i,y)],h.qDef.qFieldLabels=[""],delete h.qLibraryId,z.qDimensions.splice(0,0,h),z.qAlwaysFullyExpanded=!0,d?(z.qDimensions.splice(1,0,d),z.qInterColumnSortOrder=[1,3,2,0]):z.qInterColumnSortOrder=[1,2,0]}})}var p="If( {{InnerMeasure}} < {{FirstWhisker}} or {{InnerMeasure}} > {{LastWhisker}}, {{InnerMeasure}} )";return{generateHyperCubes:o}}),define("extensions.qliktech/boxplot/boxplot",["core.utils/deferred","objects.extension/picasso-charts/chart-view","extensions.qliktech/boxplot/boxplot-properties","extensions.qliktech/boxplot/boxplot-data","extensions.qliktech/boxplot/boxplot-explore-properties","objects.utils/data-properties/hypercube-handler","extensions.qliktech/boxplot/boxplot-scrolling","./boxplot-api","text!./boxplot.ng.html","client.utils/property-mapper","./boxplot-cubes-generator","util","objects.extension/object-conversion","objects.utils/chart-style-utils"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){"use strict";function o(a,b){l.extend(!0,a,{data:{mapTo:{min:{source:"/box/qHyperCube/qMeasureInfo/0"},start:{source:"/box/qHyperCube/qMeasureInfo/1"},med:{source:"/box/qHyperCube/qMeasureInfo/2"},end:{source:"/box/qHyperCube/qMeasureInfo/3"},max:{source:"/box/qHyperCube/qMeasureInfo/4"},elemNo:{source:"/box/qHyperCube/qDimensionInfo/0",reducer:"first",property:"id"}},groupBy:{source:"/box/qHyperCube/qDimensionInfo/0"}}}),b&&(a.settings.major={scale:"y"})}function p(a,b){l.extend(!0,a,{data:{mapTo:{x:{source:"/outliers/qHyperCube/qMeasureInfo/0"},elemNo:{source:"/outliers/qHyperCube/qDimensionInfo/1",reducer:"first",property:"id"},inner:{source:"/outliers/qHyperCube/qDimensionInfo/1",reducer:"first",type:"qual"}},groupBy:{source:"/outliers/qHyperCube/qDimensionInfo/0",trackBy:"$index"}}}),b&&(a.data.mapTo.y={source:"/outliers/qHyperCube/qDimensionInfo/0",reducer:"first",type:"qual"},a.settings.y={scale:"y"},a.data.mapTo.inner.source="/outliers/qHyperCube/qDimensionInfo/2",a.brush.trigger[1].data=["inner","x","y"])}function q(a,b){l.extend(!0,a,{text:b[z].qHyperCube.qMeasureInfo[0].qFallbackTitle})}function r(a,b){var c=b[z].qHyperCube.qDimensionInfo;l.extend(!0,a,{text:c[c.length-1].qFallbackTitle})}function s(a){l.extend(!0,a,{data:{mapTo:{elemNo:{source:"/box/qHyperCube/qDimensionInfo/0",reducer:"first",property:"id"}},groupBy:{source:"/box/qHyperCube/qDimensionInfo/0"}}})}function t(a,b,c){a.scales={x:{source:["/box/qHyperCube/qMeasureInfo/0","/box/qHyperCube/qMeasureInfo/1","/box/qHyperCube/qMeasureInfo/2","/box/qHyperCube/qMeasureInfo/3","/box/qHyperCube/qMeasureInfo/4"],expand:.1}},c&&(a.scales.y={source:"/box/qHyperCube/qDimensionInfo/0",type:"ordinal"}),a.components.forEach(function(d){switch(d.key){case"x-axis-title":q(d,b);break;case"y-axis-title":r(d,b);break;case"box-marker":o(d,c);break;case"point-marker":a.scales.x.source.push("/outliers/qHyperCube/qMeasureInfo/0"),p(d,c);break;case"y-axis":s(d)}})}function u(a,b){var c=a.box.qHyperCube.qDimensionInfo,d=b?c[1].qApprMaxGlyphCount:0,e=parseInt(this._style.axis.labels.fontSize);return A+e*Math.min(B,d)*.6}function v(a){var b=this;this._tooltipHandler.closeTooltip(),this._boxplotScrolling.getSlicedData(this.backendApi.model.layout).then(function(){var c=l.extend(!0,{},a);b._chartInstance.update({partialData:!0,data:{type:"q",data:c.qUndoExclude}})})}function w(a,b){var c=a._chartInstance.scroll("y");c.removeAllListeners(),c.on("update",v.bind(a,b))}function x(a,b){a._style=a._updateStyles(b),a._createChartSettings(b),a.isOn()&&a.hasOption("navigation")&&w(a,b)}var y,z="box",A=20,B=20;return y=b.extend("BoxPlot",{namespace:".boxplot",chartID:"boxPlot",_dataPath:"qUndoExclude",init:function(a,b){this._picassoElement=b.find(".box-layer")[0],this._super.apply(this,arguments),this._selectionHandler.setupBrushingLink("/outliers/qHyperCube/qDimensionInfo/1","/box/qHyperCube/qDimensionInfo/0"),this._boxplotScrolling=new g(this,b),this._tooltipHandler.updateMetaData({boxCubePath:"/box/qHyperCube",pointCubePath:"/outliers/qHyperCube"})},on:function(){this._super(),this.hasOption("navigation")&&(this._boxplotScrolling.on(),x(this,this.backendApi.model.layout)),this.hasOption("tooltips")&&this._tooltipHandler.on(),this.hasOption("selections")&&this._selectionHandler.on()},off:function(){this._super(),this.hasOption("navigation")&&(this._chartInstance.scroll("y").removeAllListeners(),this._boxplotScrolling.off()),this.hasOption("tooltips")&&this._tooltipHandler.off(),this.hasOption("selections")&&this._selectionHandler.off()},_updateStyles:function(a){var b=n.Theme.resolveColor(a.color.box.paletteColor),c=n.Theme.resolveColor(a.color.point.paletteColor),d=n.getContrastingGrey(b),e=n.getContrastingTransparent(c),f={box:{whisker:{width:.4,stroke:n.getStyle("boxPlot","box.whisker","stroke"),show:a.whiskers.show},line:{stroke:n.getStyle("boxPlot","box.line","stroke")},box:{width:.5,fill:b,stroke:n.getStyle("boxPlot","box.box","stroke")},median:{strokeWidth:1,stroke:d}},point:{fill:c,stroke:e,size:.2,strokeWidth:1},scrollBar:{backgroundColor:n.getStyle("boxPlot","","backgroundColor")}};return f=this._super(f)},_createChartSettings:function(a){var b=a.box.qHyperCube.qDimensionInfo.length>1,c={xAxis:!0,xAxisTitle:!0,yAxis:!!b&&{preferredSize:u.call(this,a,b)},yAxisTitle:b,boxMarker:!0,pointMarker:a.box.includeOutliers,scroll:!!this.hasOption("navigation")&&this._boxplotScrolling.getPicassoScrollSettings(a),gridLines:!(!a.gridlines||!a.gridlines.show)&&{x:!0}};this._createComponents(a,this._style,c),t(this._chartSettings,a,b),this._super(a)},resize:function(a,b){this._boxplotScrolling.onResize(),this._super(a,b)},paint:function(b,c){var d=this,e=c.qUndoExclude;if(!e)return a.resolve();var f=e.box&&e.box.qHyperCube.qDataPages.length,g=!c.box.includeOutliers||e.outliers&&e.outliers.qHyperCube.qStackedDataPages.length,h=c.box.qHyperCube.qDimensionInfo.length>1;if(this._hasUnpaintedData&&x(d,c),f&&g){var i;if(h&&d.hasOption("navigation")&&this._boxplotScrolling.shouldGetNewData(c)){var j=this._super;i=d._boxplotScrolling.getSlicedData(c).then(function(){return d._hasUnpaintedData=!0,j.call(d,b,c,b.find(".box-layer")[0],e)})}else i=this._super(b,c,b.find(".box-layer")[0],e);return i}return a.resolve()},destroy:function(){this._super(),this._boxplotScrolling.destroy()},updateData:function(b){var c=this;return c._super(b).then(function(){return c._tooltipHandler.updateMetaData({hasSecondDimension:b.box.qHyperCube.qDimensionInfo.length>1,measureTitle:b.box.qHyperCube.qMeasureInfo[0].qFallbackTitle}),c.backendApi.isSnapshot?a.resolve():c.backendApi.model.getEffectiveProperties().then(function(a){a.qUndoExclude||(a.qUndoExclude={});var d=l.hashFromString(JSON.stringify(a.box));if(!c._generationInProgress&&d!==a.qUndoExclude.hashCode){c._generationInProgress=!0;var e=l.extend(!0,{},a);return a.qUndoExclude.hashCode=d,k.generateHyperCubes(a).then(function(){return b.permissions.update&&!b.qHasSoftPatches?c.backendApi.model.setProperties(a).then(function(){c._generationInProgress=!1}):c._softPropertyHandler.saveSoftProperties(e,a).then(function(){c._generationInProgress=!1})})}var f=b.qUndoExclude,g=b.box.qHyperCube.qDimensionInfo.length>1;return c.backendApi.setPath("/qUndoExclude/box/qHyperCubeDef"),c.backendApi.setPaths(["/qUndoExclude/box/qHyperCubeDef","/qUndoExclude/outliers/qHyperCubeDef"]),c.backendApi.updateCache(f.box),c._boxplotScrolling.resetScroll(),c._boxplotScrolling.updateOutliersCache(b),c._getData(c.backendApi,f.box.qHyperCube,{height:g?c._boxplotScrolling.getNumberOfVisibleItems():1}).then(function(){if(b.box.includeOutliers)return c._getData(c._outliersCacheCube,f.outliers.qHyperCube,{height:g?c._boxplotScrolling.getNumberOfVisibleItems():f.outliers.qHyperCube.qSize.qcy})})})})}}),{type:"boxplot",BackendApi:h,template:i,View:y,definition:c,softDefinition:e.get(z),initialProperties:{box:{sorting:{autoSort:!0},qHyperCubeDef:{qDimensions:[],qMeasures:[],qMode:"S",qAlwaysFullyExpanded:!0,qSuppressZero:!1,qSuppressMissing:!0}}},support:{cssScaling:!1,snapshot:!0,export:!0,exportData:!0,sharing:!0},options:{hyperCubePath:z},data:d,importProperties:m.hypercube.importProperties,exportProperties:m.hypercube.exportProperties,getCreatePropertyHandler:function(a){var b,c,d=this.mappedDefinition,e=this.globalChangeListeners;return this.dimensionDefinition&&(b=j.mapProperties(d.items.data.items.innerData.items.dimensions)),this.measureDefinition&&(c=j.mapProperties(d.items.data.items.innerData.items.measures)),new f({app:a,dimensionDefinition:this.dimensionDefinition,measureDefinition:this.measureDefinition,dimensionProperties:b,measureProperties:c,globalChangeListeners:e,path:z})}}}),define("extensions.qliktech/distributionplot/distributionplot-properties",["objects.utils/chart-style-utils"],function(a){var b={translation:"properties.colors",type:"items",items:{colors:{type:"items",items:{boxColor:{ref:"color.box.paletteColor",translation:"properties.distributionPlot.boxColor",type:"object",component:"color-picker",dualOutput:!0,defaultValue:function(){var b=a.getStyle("distributionPlot","box","fill");return{index:a.Theme.currentPalette.indexOf(b),color:b}}},pointColor:{ref:"color.point.paletteColor",translation:"properties.distributionPlot.pointColor",type:"object",component:"color-picker",dualOutput:!0,defaultValue:function(){var b=a.Theme.dataColors.primaryColor;return{index:a.Theme.currentPalette.indexOf(b),color:b}}}}}}},c={type:"items",translation:"properties.presentation",items:{showDistBackground:{ref:"presentation.visibleComponents",translation:"properties.show",type:"string",component:"dropdown",defaultValue:"points_box",options:[{value:"points_box",translation:"properties.distributionPlot.pointsAndBox"},{value:"points",translation:"properties.distributionPlot.pointsOnly"},{value:"box",translation:"properties.distributionPlot.boxOnly"}]},showGridlines:{ref:"gridlines.show",translation:"properties.gridLine.show",type:"boolean",defaultValue:!0}}},d={uses:"axis.picasso.measureAxis"},e={uses:"axis.picasso.dimensionAxis"},f={uses:"settings",items:{presentation:c,colors:b,measureAxis:d,dimensionAxis:e}},g={type:"items",component:"expandable-items",translation:"properties.addons",items:{dataHandling:{uses:"dataHandling"}}},h={type:"items",translation:"properties.sorting",items:{defaultSorting:{uses:"sorting",items:{dimensions:{ref:"qHyperCubeDef.qDimensions",included:function(a){return 0!==a},showPriority:!1,allowMove:!1,expanded:!0},measures:{included:!1}}}}},i={uses:"dimensions"},j={uses:"measures"},k={uses:"data",grouped:!0,items:{dimensions:i,measures:j}},l={uses:l,translation:"Common.Data",type:"items",items:{innerData:k}};return{type:"items",component:"accordion",items:{data:l,sorting:h,addons:g,settings:f}}}),define("extensions.qliktech/distributionplot/distributionplot-data",[],function(){return{measures:{min:1,max:1,add:function(){},move:function(){},remove:function(){}},dimensions:{min:1,max:2,add:function(a,b){2===b.qHyperCubeDef.qInterColumnSortOrder.length?b.qHyperCubeDef.qInterColumnSortOrder=[1,0]:3===b.qHyperCubeDef.qInterColumnSortOrder.length&&(b.qHyperCubeDef.qInterColumnSortOrder=[1,2,0])},move:function(){},remove:function(){}}}}),define("extensions.qliktech/distributionplot/distributionplot-explore-properties",[],function(){return{type:"items",component:"accordion",items:{data:{uses:"data"},sort:{uses:"sort"},presentation:{uses:"presentation"}}}}),define("text!extensions.qliktech/distributionplot/distributionplot.ng.html",[],function(){return'<div class="dist-layer" style="width:100%; height:100%; position:absolute;"></div>\n<span class="qv-viz-center-disclaimer" ng-if="dataAttributes.noDataExist  && dataAttributes.layoutMode > 2" q-translation="Object.Disclaimer.NoDataExist" q-title-translation="Object.Disclaimer.NoDataExist" dir="ltr"></span>\n<div qva-chart-disclaimer attributes="dataAttributes" visible="!dataAttributes.noDataExist" direction="options.direction"></div>'}),define("extensions.qliktech/distributionplot/distributionplot",["core.utils/deferred","objects.extension/picasso-charts/chart-view","extensions.qliktech/distributionplot/distributionplot-properties","extensions.qliktech/distributionplot/distributionplot-data","extensions.qliktech/distributionplot/distributionplot-explore-properties","objects.utils/data-properties/hypercube-handler","objects.backend-api/hypercube-api","text!./distributionplot.ng.html","client.utils/property-mapper","util","objects.extension/object-conversion","objects.utils/chart-style-utils"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";function m(a,b){j.extend(!0,a,{data:{mapTo:{start:{source:"/qHyperCube/qMeasureInfo/0",reducer:"min"},end:{source:"/qHyperCube/qMeasureInfo/0",reducer:"max"},elemNo:{source:"/qHyperCube/qDimensionInfo/1",reducer:"first",property:"id"}}},settings:{y:{scale:"x"}}}),b&&(a.data.groupBy={source:"/qHyperCube/qDimensionInfo/1"},a.settings.major={scale:"y"})}function n(a,b){j.extend(!0,a,{data:{mapTo:{x:{source:"/qHyperCube/qMeasureInfo/0"},elemNo:{source:"/qHyperCube/qDimensionInfo/0",reducer:"first",property:"id"},inner:{source:"/qHyperCube/qDimensionInfo/0",reducer:"first",type:"qual"}},groupBy:{source:"/qHyperCube/qDimensionInfo/0",trackBy:"$index"}}}),b&&(a.data.mapTo.y={source:"/qHyperCube/qDimensionInfo/1",reducer:"first",type:"qual"},a.settings.y={scale:"y"},a.brush.trigger[1].data=["inner","x","y"],a.data.mapTo.elemNo.source="/qHyperCube/qDimensionInfo/1")}function o(a,b){j.extend(!0,a,{text:b.qHyperCube.qMeasureInfo[0].qFallbackTitle})}function p(a,b){var c=b.qHyperCube.qDimensionInfo;j.extend(!0,a,{text:c[c.length-1].qFallbackTitle})}function q(a){j.extend(!0,a,{data:{mapTo:{elemNo:{source:"/qHyperCube/qDimensionInfo/1",reducer:"first",property:"id"}},groupBy:{source:"/qHyperCube/qDimensionInfo/1"}}})}function r(a,b,c){a.scales={x:{source:"/qHyperCube/qMeasureInfo/0",expand:.1}},c&&(a.scales.y={source:"/qHyperCube/qDimensionInfo/1",type:"ordinal"}),a.components.forEach(function(a){switch(a.key){case"x-axis-title":o(a,b);break;case"y-axis-title":p(a,b);break;case"box-marker":m(a,c);break;case"point-marker":n(a,c);break;case"y-axis":q(a)}})}var s;return s=b.extend("DistributionPlot",{namespace:".distributionPlot",chartID:"distributionPlot",init:function(a,b){this._picassoElement=b.find(".dist-layer")[0],this._super.apply(this,arguments),this._tooltipHandler.updateMetaData({boxCubePath:"/qHyperCube",pointCubePath:"/qHyperCube"})},on:function(){this._super(),this._tooltipHandler.on(),this._selectionHandler.on()},off:function(){this._super(),this._tooltipHandler.off(),this._selectionHandler.off()},_updateStyles:function(a){var b=l.Theme.resolveColor(a.color.point.paletteColor),c=l.getContrastingTransparent(b),d={box:{box:{fill:l.Theme.resolveColor(a.color.box.paletteColor),stroke:l.getStyle(this.chartID,"box","stroke"),strokeWidth:1,width:.35}},point:{fill:b,stroke:c,size:.3,strokeWidth:1}};return d=this._super(d)},_createChartSettings:function(a){var b=a.presentation&&a.presentation.visibleComponents,c=a.qHyperCube.qDimensionInfo.length>1,d={xAxis:!0,xAxisTitle:!0,yAxis:c,yAxisTitle:c,
boxMarker:b&&a.presentation.visibleComponents.indexOf("box")!==-1,pointMarker:b&&a.presentation.visibleComponents.indexOf("point")!==-1,gridLines:!(!a.gridlines||!a.gridlines.show)&&{x:!0}};this._createComponents(a,this._style,d),r(this._chartSettings,a,c),this._super(a)},paint:function(a,b){return this._super(a,b,a.find(".dist-layer")[0],b)},updateData:function(b){var c=this;return c._super(b).then(function(){return c._tooltipHandler.updateMetaData({hasSecondDimension:b.qHyperCube.qDimensionInfo.length>1,measureTitle:b.qHyperCube.qMeasureInfo[0].qFallbackTitle}),c.backendApi.isSnapshot?a.resolve():c._getData(c.backendApi,b.qHyperCube)})}}),{type:"distributionPlot",BackendApi:g,template:h,View:s,definition:c,softDefinition:e,initialProperties:{qHyperCubeDef:{qDimensions:[],qMeasures:[],qMode:"S",qAlwaysFullyExpanded:!0,qSuppressZero:!1,qSuppressMissing:!0}},support:{cssScaling:!1,snapshot:!0,export:!0,exportData:!0,sharing:!0},data:d,importProperties:function(a,b,c){var d=k.hypercube.importProperties.apply(k,[a,b,c]),e=d.qProperty;return 3===e.qHyperCubeDef.qInterColumnSortOrder.length&&(e.qHyperCubeDef.qIntercolumnSortOrder=[1,2,0]),d},exportProperties:k.hypercube.exportProperties,getCreatePropertyHandler:function(a){var b,c,d=this.mappedDefinition,e=this.globalChangeListeners;return this.dimensionDefinition&&(b=i.mapProperties(d.items.data.items.dimensions)),this.measureDefinition&&(c=i.mapProperties(d.items.data.items.measures)),new f({app:a,dimensionDefinition:this.dimensionDefinition,measureDefinition:this.measureDefinition,dimensionProperties:b,measureProperties:c,globalChangeListeners:e})}}}),define("general.utils/touch-configuration-util",["jquery","general.utils/support"],function(a,b){"use strict";return{configureTouchSupport:function(){a(document.body.parentElement).addClass("touch-"+(b.treatAsDesktop()?"off":"on"))}}}),define("objects.extension/base-controller",["core.utils/class","core.utils/deferred","objects.extension/default-selection-toolbar"],function(a,b,c){"use strict";var d=a.extend({$scope:null,init:function(a){this.$scope=a},onPaint:function(){return b.resolve()},onResize:function(){return b.resolve()},setInteractionState:function(){},setFreeResize:function(){},setDirection:function(){},setSnapshotData:function(){},setBackendApi:function(){},getContextMenu:function(){},getObjectMenu:function(){},getSelectionToolbar:function(){return new c(this.$scope.backendApi,this.$scope.selectionsApi,!1,!1)},getPreferredSize:function(){},onInit:function(){return b.resolve()}});return d.$inject=["$scope"],d}),define("objects.views/charts/utils/cache-utils",[],function(){function a(b,c){return b.forEach(function(b){if(b.isCacheItem)c.push(b);else if(b.data.cacheItem)c.push(b.data.cacheItem);else if(b.cacheItem&&(c.push(b.cacheItem),b.cacheItem.isCacheItem))throw"Using new cache item before its time";b.children&&b.children.length>0&&a.apply(this,[b.children,c])}),c}return{getCacheItems:function(){return this.children&&this.children?a.apply(this,[this.children,[]]):[]}}}),define("objects.views/selections/shapes-from",["jquery","core.utils/class","objects.views/charts/utils/cache-utils","objects.views/charts/utils/tree-iterator"],function(a,b,c,d){"use strict";function e(a){return a?a.selectionIdentifier:null}function f(a,b){if(b){var c=!1;return b.contains(0)&&(c=a.parent?a.parent.id===-2:a.id===-2),a.parent&&b.contains(1)&&(c=c||a.id===-2),c}return a.id===-2||a.parent&&a.parent.id===-2}function g(a,b){return a&&a.length?b.filter(function(b){return a.some(function(a){return b.col===a.col&&b.id===a.id})}):[]}return b.extend({init:function(b,c){this.options=a.extend(!0,{},{allowNullSelect:!1,activeComponent:null},c),this.cache=b,this.allowNullSelect=this.options.allowNullSelect,this.activeComponent=this.options.activeComponent},shapeFromPoint:function(a){return this.shapesFromPoints([a])[0]},shapesFromPoints:function(a){var b,c,d,g,h,i,j,k,l,m,n=this.cache.data,o=this.cache.data.length,p=a.length,q=this.activeComponent||this.components&&this.components.dataArea?(this.activeComponent||this.components.dataArea[0]).chartScale||1:1,r=e(this.activeComponent),s=[];for(k=0;k<o;++k)if(j=n[k],!f(j)||this.allowNullSelect)for(l=0;l<p;++l)for(b=a[l],c={x:b.x/q,y:b.y/q},h=j.getShapes(e(this.activeComponent)),"dataArea"===r&&j.toggleShapes&&(h=h.concat(j.toggleShapes)),g=h.length,m=0;m<g;++m)if(i=h[m],d=i.clearModelView?b:c,i.pointInside(d.x,d.y)){s.push(j);break}return s},shapesFromLines:function(a){var b,c,d,g,h,i,j,k,l=this.cache.data,m=this.cache.data.length,n=a.length,o=[];for(i=0;i<m;++i)if(h=l[i],!f(h)||this.allowNullSelect)for(j=0;j<n;++j)for(b=a[j],d=h.getShapes(e(this.activeComponent)),c=d.length,k=0;k<c;++k)if(g=d[k],g.intersectsLine(b)){o.push(h);break}return o},shapesFromPolygon:function(a){var b,c,d,g,h,i,j,k,l,m,n=this.cache.data,o=this.cache.data.length,p=[];for(j=0;j<o;++j)if(i=n[j],!f(i)||this.allowNullSelect)for(m=!1,h=i.getShapes(e(this.activeComponent)),g=h.length,l=0;l<g&&!m;++l)for(b=h[l].getPoints(),d=b.length,k=0;k<d;++k)if(c=b[k],a.pointInside(c.x,c.y)){p.push(i),m=!0;break}return p},shapesFromRect:function(a,b){if(!a)return[];var c,d,g,h,i,j,k=this.cache.data,l=this.cache.data.length,m=[];for(i=0;i<l;++i)if(h=k[i],!f(h)||this.allowNullSelect)for(d=h.getShapes(b||e(this.activeComponent)),c=d.length,j=0;j<c;j++)if(g=d[j],g.intersectsRect){if(g.intersectsRect(a)){m.push(h);break}}else if(a.intersectsWith(g)){m.push(h);break}return m},shapesFromRectForDirection:function(a,b,c){var d,g,h,i,j,k,l,m=this.cache.data,n=this.cache.data.length,o=[],p=0,q=0,r="";switch(b){case"x":p=a.x,q=a.getRight(),r="getRight";break;case"y":p=a.y,q=a.getBottom(),r="getBottom"}for(k=0;k<n;++k)if(d=m[k],!f(d)||this.allowNullSelect)for(h=d.getShapes(c||e(this.activeComponent)),g=h.length,l=0;l<g;++l)if("cx"in(i=h[l])){if(i["c"+b]>=p&&i["c"+b]<=q){o.push(d);break}}else{if(j=i.getBoundingRect(),j[b]>=p&&j[b]<=q){o.push(d);break}if(j[r]()>=p&&j[r]()<=q){o.push(d);break}if(p>=j[b]&&q<=j[r]()){o.push(d);break}}return o},shapesFromRange:function(a,b,c,d){var e,g,h,i,j,k,l=Math.min(a,b),m=Math.max(a,b),n=this.cache.data,o=this.cache.data.length,p=this.activeComponent&&"function"==typeof this.activeComponent.getType?this.activeComponent.getType().indices:null,q=[];for(c=c!==!1,d=d!==!1,k=c&&d?function(a){return a>=l&&a<=m}:c?function(a){return a>=l&&a<m}:d?function(a){return a>l&&a<=m}:function(a){return a>l&&a<m},i=0;i<o;++i)if(e=n[i],!f(e)||this.allowNullSelect)for(g=e.values instanceof Array?e.values:e.value instanceof Array?e.value:[e.value],p&&p.length&&(g=g.filter(function(a,b){return p.indexOf(b)>=0})),j=0;j<g.length;j++)if(h=g[j],k(h)){q.push(e);break}return q},shapesFromDimensionValue:function(a){var b,c,d,e=this.cache.data,g=this.cache.data.length,h=[];for(c=0;c<g;++c)if(b=e[c],!f(b)||this.allowNullSelect)for(d=0;d<a.length;d++)if(b.id===a[d]){h.push(b);break}return h},groupedItemsFromShapes:function(a){var b,e,f,h,i=[];return b=void 0!==this.activeComponent.getSelectionIndices?this.activeComponent.getSelectionIndices():[0],e=b[b.length-1],a&&a[0]&&a[0].col===e?g(a,this.cache.data):(a.forEach(function(b){void 0!==(h=b.parent)&&(f=d.getLevel.call(h)-(b.isCacheItem?0:1))===e&&i.indexOf(h)===-1&&a&&i.push(h)}),i.length>0&&(a=[],i.forEach(function(b){a=a.concat(c.getCacheItems.call(b))})),a)},shapesFromIndex:function(a,b){var c,d,e=Math.min(a,b),f=Math.max(a,b),g=this.cache.data,h=this.cache.data.length,i=[];for(d=0;d<h;++d)c=g[d],void 0!==c.index&&c.index>=e&&c.index<=f&&i.push(c);return i},_isNull:f,release:function(){this.cache=null,this.allowNullSelect=null,this.activeComponent=null}})}),define("objects.views/selections/cache-consumer",["jquery","core.utils/class","general.utils/shapes/point","./shapes-from"],function(a,b,c,d){"use strict";function e(a){var b=this.indexOf(a);return b>=0?this.splice(b,1):null}function f(a,b){return Object.keys(b).filter(function(c){return b[c].filter(function(b){return b===a}).length})[0]}return b.extend({init:function(b,c){this.options=a.extend(!0,{},{components:{}},c),this._selectedShapes=[],this._cssTransform={scale:1},this.components=this.options.components,this.shapesFrom=new d(b,c)},setActiveComponent:function(a){this.activeComponent=a,this.shapesFrom.activeComponent=a},initComponent:function(){throw new Error("base.js: initComponent has to be implemented in subclass")},setComponent:function(a,b){var c=Array.isArray(b)?b.concat():[b];switch(c.forEach(function(a){var b=f(a,this.components);b&&this.removeComponent(b,a)},this),a){case"x":case"y":case"dataArea":case"colorLegend":this.components[a]&&this.components[a].forEach(function(a){c.indexOf(a)===-1&&this.deregister(this,a)},this),c.forEach(function(b){this.components[a]&&this.components[a].indexOf(b)!==-1||this.register(this,b)},this),this.components[a]=c;break;default:throw"Key "+a+" not implemented"}},addComponent:function(a,b){switch(a){case"x":case"y":case"dataArea":case"colorLegend":this.components[a]||(this.components[a]=[]);!e.call(this.components[a],b)&&this.register(this,b),this.components[a].push(b);break;default:throw"Key "+a+" not implemented"}},removeComponent:function(a,b){switch(a){case"x":case"y":case"dataArea":case"colorLegend":this.components[a]&&b&&e.call(this.components[a],b),b&&this.components[a]&&this.components[a].length||delete this.components[a],this.deregister(this,b);break;default:throw"Key "+a+" not implemented"}},register:function(){},deregister:function(){},getComponent:function(a,b,d){var e=new c(a-d.x,b-d.y);return Object.keys(this.components).map(function(a){return this.components[a]},this).reduce(function(a,b){return a.concat(b)}).filter(function(a){var b=(a.chartScale||1)*this._cssTransform.scale;return this.getRect(a).pointInside(e.x/b,e.y/b)},this)[0]},getRect:function(a){return a.rect},getComponentKey:function(a){return Object.keys(this.components).filter(function(b){return this.components[b].indexOf(a)>=0},this)[0]},getTransformedPoint:function(a,b,d){var e=this.getRect(this.activeComponent||this.components.dataArea[0]),f=(this.activeComponent||this.components.dataArea[0]).chartScale||1;return new c((a-e.x*f*this._cssTransform.scale-d.x)/this._cssTransform.scale,(b-e.y*f*this._cssTransform.scale-d.y)/this._cssTransform.scale)},getPagePoint:function(a,b,d,e){var f=this.getRect(d||this.activeComponent||this.components.dataArea[0]),g=(this.activeComponent||this.components.dataArea[0]).chartScale||1;return new c(a+f.x*g+e.x,b+f.y*g+e.y)},release:function(){this.activeComponent=null,this.shapesFrom&&this.shapesFrom.release(),this.components=null,this.options.components=null,this.shapesFrom=null}})}),define("objects.views/charts/tooltip/chart-tooltip",["jquery","qvangular","general.utils/support","general.utils/shapes/rect","general.utils/shapes/point","objects.views/selections/cache-consumer","objects.views/selections/interaction-type","objects.views/selections/interaction-handler","objects.views/charts/tooltip/chart-tooltip-service"],function(a,b,c,d,e,f,g,h){"use strict";function i(a){var b=a.getBoundingRect();return isNaN(b.x+b.y+b.width+b.height)}function j(a){return a.getDimensions().join(", ")}function k(a){return a.id+(a.parent?"-"+a.parent.id:"")}function l(){A&&(A=null,B=null),z=null}function m(a,b,c,e){if(c){var f=new d(0,0,c.rect.width,c.rect.height);a=a.intersection(f)}return{positions:[b(a.x+a.width/2,a.y,c,e),b(a.x+a.width,a.y+a.height/2,c,e),b(a.x,a.y+a.height/2,c,e),b(a.x+a.width/2,a.y+a.height,c,e)],directions:["top","right","left","bottom"]}}function n(a,b){var c,d,e,f,g,h,j,k=[],l={positions:null,directions:null,target:null,component:null};return this._positionAtMouse||1!==this._cssTransform.scale?(c=b||a[0].interactPosition)&&(d=this.getTransformedPoint(c.x,c.y,this.containerRect),f=a[0].getShapes(),k=f.filter(function(a){return a.pointInside(d.x,d.y)}),l.target=k.length?k[0]:f[0],l.directions=["top","right","left","bottom"],l.positions=[c]):(a.forEach(function(a){var c=null,h=null;f=a.getShapes(),a.calculateTooltipPosition&&a.tooltipShape?(h=this.components[a.tooltipShapeComponent]?this.components[a.tooltipShapeComponent][0]:void 0,(e=a.getShapeBounds(a.tooltipShapeComponent,h?h.chartScale||1:1))&&(l.target=k.length?k[0]:f[0],l.component=h)):(a.tooltipShape&&!i(a.tooltipShape)?(k=[a.tooltipShape],l.component=this.components[a.tooltipShapeComponent]?this.components[a.tooltipShapeComponent][0]:void 0):b&&(d=this.getTransformedPoint(b.x,b.y,this.containerRect),k=f.filter(function(a){return a.pointInside(d.x,d.y)})),l.target=k.length?k[0]:f[0],l.target&&(l.target.getRelevantPosition?c=l.target.getRelevantPosition():(e=l.target.getBoundingRect(),!l.target.clearModelView&&l.component&&(j=l.component.chartScale||1,e=e.clone(),e.set(e.x*j,e.y*j,e.width*j,e.height*j))))),c?(l.positions=[this.getPagePoint(c.pos.x,c.pos.y,l.component,this.containerRect)],l.directions=c.direction):g=g?e.combineWith(g):e},this),g&&(h=m(g,this.getPagePoint.bind(this),l.component,this.containerRect),l.positions=h.positions,l.directions=h.directions)),l}function o(a,b){var c,d,e,f,g,h,i=[],j=0,k=this.measureFormatters||[];if(a.isCacheItem)for(g=a.getMeasures(),h=a.getMeasuresIndecies(b),d=h.length,j;j<d;++j){var l=h[j];e=a.getValue(l),f=a.getPreformattedLabel(l),k[h[j]]?e="U"!==k[l].type&&f?f:k[l].format(e):"NaN"===e&&(e="-"),g[l]&&void 0!==e&&i.push({label:g[l],value:e+""})}else for(d=a.node.children.length,j;j<d;++j)e=a.node.children[j].children[0].data.qNum||a.node.children[j].children[0].data.qValue,f=a.node.children[j].children[0].data.qText,k[j]&&(e="U"!==k[j].type&&f?f:k[j].format(e)),i.push({label:a.node.children[j].data.qText,value:e+""});this.colorMap&&(c=this.colorMap.getTooltipContent(a,b.rowIndex))&&i.splice(0,0,c);var m=[];return i.forEach(function(a){m.some(function(b){return b.label===a.label&&b.value===a.value})||m.push(a)}),m}function p(a,b){for(var c=[],d=0,e=0;d<C&&e<a.length;)c.push({header:j(a[e]),rows:o.call(this,a[e],b)}),d+=c[e].rows.length+1,e++;return a.length>e&&(c.numberInExcess=a.length-e),c}function q(a,c,d,e){var f=n.call(this,a,c);if(f.positions&&f.directions){var g=this.getPagePoint(0,0,f.component,this.containerRect),h=p.call(this,a,f.target);b.getService("qvChartTooltipService").open({target:{shape:f.target,targetToPageTranslation:g},position:f.positions,content:h,direction:f.directions,numberInExcess:h.numberInExcess,hideCallback:l.bind(this),dir:this.yMirrorMode?"rtl":"ltr"},d,e),A=a[0],B=a.map(k).join("")}}function r(a){var b=this.getTransformedPoint(a.x,a.y,this.containerRect);return this.shapesFrom.shapesFromPoints([b])}function s(a){return r.call(this,a).map(k).join("")}function t(a){var c=this;this.setActiveComponent(this.getComponent(a.x,a.y,this.containerRect));var d=r.call(c,a);d&&d.length&&this.activeComponent&&(c._positionAtMouse="MapArea"===c.activeComponent.className||1!==c._cssTransform.scale,z=b.getService("$timeout")(function(){q.call(c,d,a,c._duration),z=null},D))}function u(a,b){var c=this;a&&a.length&&this.activeComponent&&(c._positionAtMouse="MapArea"===c.activeComponent.className||1!==c._cssTransform.scale,q.call(c,a,null,2e4,b))}function v(){b.getService("$timeout").cancel(z),z=null,this.prevPoint=null}function w(){A&&(A=null,B=null,b.getService("qvChartTooltipService").close()),z=null}function x(a,b){var c,d,e=b?b.length:0;for(c=0;c<e;c++)if((d=b[c])&&d.pointInside&&d.pointInside(a.x,a.y))return!0;return!1}function y(a){var b,c,d,e=a?a.length:0,f=[];for(b=0;b<e;b++)c=a[b]._shapes,d||(d=a[b]._interactPosition)&&(d=this.getTransformedPoint(d.x,d.y,this.containerRect)),d&&x(d,c)&&(f[f.length]=a[b]);return f.length||(f=a),f}var z,A,B,C=7,D=500,E=f.extend("ChartTooltip",{init:function(a,b,c){this._super(c,b),this.cache=c,A=null,z=null,this.container=a,this.containerRect=new d(0,0,0,0),this._positionAtMouse=!0,this._enabled=!0,this._allowNullSelect=!0,this.touchTimeout=isNaN(b.touchTimeout)?10:b.touchTimeout,this._duration=7e3},refreshContainerRect:function(){var a=this.offset=this.container.offset(),b=this.container.width(),c=this.container.height();this.containerRect.set(a.left,a.top,b,c)},on:function(){function a(a){c.treatAsDesktop()?h.addInteraction(b._interactionEvents,a.container,0,["mousemove","mouseleave","swipe","mousewheel"]):h.addInteraction(b._interactionEvents,a.container,0,["swipe","swipetwo","rotate","tap"])}if(!this._isListening){this._isListening=!0;var b=this;this._interactionEvents=g.extend({mousemove:function(a){var c=new e(a.pageX,a.pageY);b.refreshContainerRect(),b.move(a,c)},mouseleave:function(a){b.leave(a)},mousewheel:function(){b.cancel()},swipe:{start:function(){b.cancel()},cancel:function(){b.cancel()}},swipetwo:{start:function(){b.cancel()},cancel:function(){b.cancel()}},rotate:{start:function(){b.cancel()},cancel:function(){b.cancel()}},tap:{end:function(a,c){var d=c.pagePoints[0];b.refreshContainerRect(),b.setActiveComponent(b.getComponent(d.x,d.y,b.containerRect));var e=r.call(b,d);e.forEach(function(a){a.interactPosition=d}),b.updateHighlightedShape(e)}},active:function(){return b._enabled}}),c.treatAsDesktop()&&h.MouseLeave.bind(b._interactionEvents.mouseleave),this.registerAddedComponent=function(b){a(b)},this.deregisterAddedComponent=function(a){h.removeInteraction(b._interactionEvents,a.container)},Object.keys(this.components).map(function(a){return b.components[a]}).forEach(function(a){a.forEach(function(a){b.registerAddedComponent(a)})})}},register:function(a,b){this.registerAddedComponent&&this.registerAddedComponent(b)},deregister:function(a,b){this.deregisterAddedComponent&&this.deregisterAddedComponent(b)},off:function(){this._isListening=!1,h.MouseLeave.unbind(this._onMouseLeave),h.removeInteraction(this._interactionEvents),this.registerAddedComponent=null,this.deregisterAddedComponent=null},initComponent:function(a){this.setActiveComponent(this.getComponent(a.x,a.y,this.containerRect))},updateHighlightedShape:function(a,b){if(a.length>=1){var d,e=!0,f=!1;if(!(d=y.call(this,a))||!d.length)return;c.treatAsDesktop()||(d=d.filter(function(a){return!a.selected}),d.length&&(A||z?(d.length>1||d[0]!==A)&&(e=!1,f=!0):(e=!1,f=!0)),e&&(v.call(this),w.call(this)),f&&u.call(this,d,this.touchTimeout))}else!c.treatAsDesktop()&&b&&(v.call(this),w.call(this))},getRect:function(a){return a?a.hasOwnProperty("innerRect")?a.innerRect:a.rect:new d(0,0,0,0)},move:function(a,b){c.treatAsDesktop()&&this._enabled&&(null!==z?(!this.prevPoint||b.distanceTo(this.prevPoint)>5)&&(v.call(this),t.call(this,b)):(this.prevPoint=b,A?s.call(this,b)!==B&&(w.call(this),t.call(this,b)):t.call(this,b)))},setCssTransform:function(a){this._cssTransform=a||{scale:1}},leave:function(b){var c=b.toElement||b.relatedTarget;a(c).hasClass("qvt-chart-tooltip")||a(c).parents(".qvt-chart-tooltip").length||(v.call(this),w.call(this))},cancel:function(){v.call(this),w.call(this)},clearSelection:function(){v.call(this),w.call(this)},release:function(){this._super(),this.off()}});return Object.defineProperties(E.prototype,{enabled:{set:function(a){this._enabled=a},get:function(){return this._enabled}}}),E}),define("objects.views/selections/cache",["./cache-item","./cache-item-base"],function(a,b){"use strict";function c(){this.data=[]}return Object.defineProperties(c.prototype,{has:{value:function(a){return this.data.indexOf(a)!==-1}},add:{value:function(c){if(!(c instanceof a||c instanceof b))throw"Invalid cache item!";this.has(c)||this.data.push(c)}},remove:{value:function(a){var b=this.data.indexOf(a);b!==-1&&this.data.splice(b,1)}},clear:{value:function(){this.data.length=0}}}),c}),define("objects.utils/selection-util",[],function(){return{isModalSelectionModel:function(a){return a&&a.enigmaModel&&a.enigmaModel===a.enigmaModel.app.modalSelectionObject},isInSelection:function(a){return a&&a.qSelectionInfo&&a.qSelectionInfo.qInSelections}}}),define("objects.views/selections/types/base",["../cache-consumer"],function(a){"use strict";var b=a.extend({init:function(a,b){this._super(a.cache,b),this._selectedShapes=[],this.handler=a,this.options=b,this.components=b.components||{}},release:function(){this._super(),this.components={},this._selectedShapes=[],this.handler=null},resetSelectedShapes:function(){this._selectedShapes.length=0},getSelectedShapes:function(){return this._selectedShapes},toggleSelectedShape:function(a){var b=this._selectedShapes.indexOf(a);b!==-1?this._selectedShapes.splice(b,1):this._selectedShapes.push(a)},setActiveMode:function(a){this._activeMode=a},getActiveMode:function(){return this._activeMode},register:function(a,b){this.handler.register(a,b)},deregister:function(a,b){this.handler.deregister(a,b)},getActiveDimensions:function(){return this.activeComponent.getSelectionIndices()},toggle:function(){},toggleRect:function(){},start:function(){},update:function(){},end:function(){},cancel:function(){},move:function(){},leave:function(){},getTransformedPoint:function(a,b){return this._super(a,b,this.handler.containerRect)},getPagePoint:function(a,b,c){return this._super(a,b,c,this.handler.containerRect)},shapeFromPoint:function(a){return this.shapesFrom.shapeFromPoint(a)},shapesFromPoints:function(a){return this.shapesFrom.shapesFromPoints(a)},shapesFromLines:function(a){return this.shapesFrom.shapesFromLines(a)},shapesFromPolygon:function(a){return this.shapesFrom.shapesFromPolygon(a)},shapesFromRect:function(a,b){return this.shapesFrom.shapesFromRect(a,b)},shapesFromRectForDirection:function(a,b,c){return this.shapesFrom.shapesFromRectForDirection(a,b,c)},shapesFromRange:function(a,b,c,d){return this.shapesFrom.shapesFromRange(a,b,c,d)},shapesFromDimensionValue:function(a){return this.shapesFrom.shapesFromDimensionValue(a)},groupedItemsFromShapes:function(a){return this.shapesFrom.groupedItemsFromShapes(a)},shapesFromIndex:function(a,b){return this.shapesFrom.shapesFromIndex(a,b)},ToggleFlag:{select:1,deselect:2,auto:4,replace:8},toggleSelection:function(a,b){function c(c){var d=a.filter(c);d.forEach(function(a){e||(a.selected=!a.selected,i(a),g.emit(a,b))}),d.length>0&&h.emit(a,b)}var d,e=this.handler._disableSelections,f=this.ToggleFlag,g=this.handler.ToggleShape,h=this.handler.ToggleShapes,i=this.toggleSelectedShape.bind(this);b=b||f.auto,b&f.select?c(function(a){return!a.selected}):b&f.deselect?c(function(a){return a.selected}):b&f.auto?c(function(){return!0}):b&f.replace&&(d=a,a=this.handler.cache.data,c(function(a){return a.selected}),a=d,c(function(){return!0}))},clearSelection:function(){var a=this.handler.Clear,b=this.handler.cache.data,c=this.ToggleFlag.deselect;this.toggleSelection(b,c),a.emit()}});return b.defaultOptions={},b}),define("general.components/framer/framer",["qvangular","general.services/show-service/show-service"],function(a,b){var c={template:'<div class ="qv-framer" ng-style="style"></div>',controller:["$scope",function(a){a.style={},a.style.top=a.top,a.style.left=a.left,a.style.height=a.height,a.style.width=a.width,a.closeComponent()}],scope:{top:"=",left:"=",height:"=",width:"=",closeComponent:"="}};return{flash:function(d,e){var f=a.getService("$timeout"),g=b.show(c,{top:Math.min(d.y,e.y)+"px",left:Math.min(d.x,e.x)+"px",height:Math.max(d.y,e.y)-Math.min(d.y,e.y)+"px",width:Math.max(d.x,e.x)-Math.min(d.x,e.x)+"px",closeComponent:function(){f(function(){g.destroy(),g=null},300)}})}}}),define("objects.views/selections/types/data-area",["jquery","general.utils/shapes/point","general.utils/shapes/polygon","general.utils/shapes/rect","general.utils/shapes/line","./base","general.components/framer/framer"],function(a,b,c,d,e,f,g){"use strict";function h(){w.beginPath(),w.moveTo(n.x,n.y),w.fillStyle="rgba(77, 192, 78, 1)",w.arc(n.x,n.y,10,0,2*Math.PI,!0),w.fill()}function i(a,b,c){var d,e;!c||"x"!==c&&"y"!==c||(b[c]=n[c]),d=(a.x+b.x)/2,e=(a.y+b.y)/2,w.beginPath(),w.moveTo(a.x,a.y),w.quadraticCurveTo(d,e,b.x,b.y),w.stroke()}function j(a,b,c,d){d=d||[2,4];var e,f=d.length,g=c.x-b.x,h=c.y-b.y,i=Math.sqrt(g*g+h*h),j=i,k=0,l=!0,m=b.x,n=b.y;for(g/=i,h/=i,a.moveTo(m,n),k=0;j>=.1&&k<5e3;++k)e=d[k%f],0===e&&(e=.001),e>j&&(e=j),m+=e*g,n+=e*h,a[l?"lineTo":"moveTo"](m,n),j-=e,l=!l}function k(a,b){x.clearRect(0,0,t.width,t.height),x.beginPath(),j(x,a,b),x.stroke()}function l(){o.hide(),q.hide(),s.hide(),o.detach()}var m,n,o=a("<div />"),p=o[0],q=a("<canvas />"),r=q[0],s=a("<canvas />"),t=s[0],u=a("<canvas />"),v=u[0],w=r.getContext("2d"),x=t.getContext("2d"),y=v.getContext("2d"),z=[],A=!1,B=!1;return p.appendChild(r),p.appendChild(t),p.appendChild(v),p.className="selections-data-area-ui",o.hide(),m=f.extend("DataAreaSelection",{init:function(a,b){this._super(a,b),this.setActiveMode("item"),this._startIndex=-1,this._endIndex=-1},initComponent:function(){this.setActiveComponent(this.components.dataArea[0])},refreshCanvas:function(){this.rect=this.components.dataArea[0].rect;var a={position:"absolute",left:this.rect.x+"px",top:this.rect.y+"px",width:this.rect.width+"px",height:this.rect.height+"px","z-index":20};w.canvas.width=this.rect.width,w.canvas.height=this.rect.height,w.lineWidth=2,w.lineCap="round",w.lineJoin="round",w.strokeStyle="rgba(102,102,102,1)",w.fillStyle="rgba(102,102,102,1)",q.css(a),x.canvas.width=this.rect.width,x.canvas.height=this.rect.height,x.lineWidth=2,x.lineCap="round",x.lineJoin="round",x.strokeStyle="rgba(102,102,102,1)",s.css(a),y.canvas.width=this.rect.width,y.canvas.height=this.rect.height,u.css(a)},toggle:function(a,b,c){c=void 0!==c?c:this.handler.getKeyAsToggleSelected(a),c||this.clearSelection(),this.resetSelectedShapes(),this.setActiveComponent(this.components.dataArea[0]);var e,f=this.getTransformedPoint(b.x,b.y),g=this.options.toggle.callback||this.toggleSelection,h=this.options.indexSelection,i=this.ToggleFlag.auto|this.ToggleFlag.tooltip;return e=h?this.shapesFromRectForDirection(new d(f.x,f.y,0,0),"y"):this.shapesFromPoints([f]),e=this.groupedItemsFromShapes(e),e.forEach(function(a){a.selectionMode="dataArea"}),e.forEach(function(a){a.interactPosition=b}),g.call(this,e,i),e&&e.length>0},toggleRect:function(b,c,e){if(c&&e){var f,h,i,j,k,l,m,n,o,p,q,r=a(this.components.dataArea[0].container),s=r.offset(),t=function(a){return{x:Math.min(Math.max(a.x,s.left),s.left+r.width()),y:Math.min(Math.max(a.y,s.top),s.top+r.height())}};c=t(c),e=t(e),p=c,q=e,this.resetSelectedShapes(),c=this.getTransformedPoint(c.x,c.y),e=this.getTransformedPoint(e.x,e.y),f=Math.min(c.x,e.x),h=Math.min(c.y,e.y),i=Math.max(1,Math.abs(e.x-c.x)),j=Math.max(1,Math.abs(e.y-c.y)),k=new d(f,h,i,j),m=this.ToggleFlag.select,n=this.options.indexSelection,o=this.toggleSelection,this.setActiveComponent(this.components.dataArea[0]),l=n?this.shapesFromRectForDirection(k,"y"):this.shapesFromRect(k),l=this.groupedItemsFromShapes(l),l.forEach(function(a){a.selectionMode="dataArea"}),o.call(this,l,m),this.getSelectedShapes().length>0&&this.handler.Select.emit(this.getSelectedShapes(),!0),g.flash(p,q)}},start:function(a,c){this.handler.getKeyAsToggleSelected(a)||this.clearSelection(),this.resetSelectedShapes(),this.setActiveComponent(this.components.dataArea[0]);var e=this.getTransformedPoint(c.x,c.y),f=this.options.captureInput,g=this.options.indexSelection;if(f&&(q.show(),s.show(),o.appendTo(this.handler.container),o.show(),this.refreshCanvas()),z.length=0,z.push(e),n=new b(z[0].x,z[0].y),A=!1,B=!1,g){var i=this.shapesFromRectForDirection(new d(n.x,n.y,1,1),"y"),j=i.length&&i[0].index;void 0!==j&&j>=0&&(this._startIndex=j)}f&&h()},update:function(a,b){var c,f,g,h,j=this.getTransformedPoint(b.x,b.y),l=this.options,m=l.captureInput,o=l.lassoAutoCloseDistance,p=l.indexSelection,q=a.shiftKey&&l.shiftLockCapture?l.shiftLockAxis:"",r=this.ToggleFlag.select,s=-1,u=this.toggleSelection;c=z[z.length-1],z.push(j),m&&i(c,j,q),m&&(A||(A=z.length>2&&n.distanceTo(j)>=o),x.clearRect(0,0,t.width,t.height),A&&(n.distanceTo(j)<=o?(k(j,n),B=!0):B=!1)),p?(h=this.shapesFromRectForDirection(new d(j.x,j.y,1,1),"y"),s=h.length?h[0].index:-1,void 0!==s&&s>=0&&(this._endIndex=s),f=this.shapesFromIndex(this._startIndex,this._endIndex),g=this.getSelectedShapes().filter(function(a){return f.indexOf(a)===-1}),u.call(this,g,this.ToggleFlag.deselect),u.call(this,f,r)):(f=this.shapesFromLines([new e(c.x,c.y,j.x,j.y)]),f=this.groupedItemsFromShapes(f),f.forEach(function(a){a.selectionMode="dataArea"}),u.call(this,f,r))},end:function(a){var b,d,e=this.options.captureInput,f=this.options.indexSelection,g=this.ToggleFlag.select,h=this.toggleSelection;f&&(this._startIndex=-1,this._endIndex=-1),e&&l(),e&&B&&(d=new c(z),b=this.shapesFromPolygon(d),b=this.groupedItemsFromShapes(b),b.forEach(function(a){a.selectionMode="dataArea"}),h.call(this,b,g)),z.length=0,this.getSelectedShapes().length>0&&this.handler.Select.emit(this.getSelectedShapes(),this.handler.getKeyAsToggleSelected(a))},cancel:function(a){z.length&&l(),a&&this.clearSelection(),this.setActiveComponent(null)}}),m.defaultOptions={captureInput:!0,indexSelection:!1,shiftLockCapture:!1,shiftLockAxis:"x",lassoAutoCloseDistance:50,autoConfirm:!1,toggle:{callback:null},interpolation:{pixelPrecision:2}},m}),define("text!objects.views/selections/types/range/range-template.ng.html",[],function(){return'<div class="qvt-range-selection">\n\t<div class="range-vertical-clip" ng-style="{ top: vOptions.offset, height: vOptions.rect.height }" ng-class="{ clip: vOptions.shouldClip }">\n\t\t<div class="range-vertical"\n\t\t\t ng-repeat="range in vRanges track by $index"\n\t\t\t qva-range-selection-range="y"\n\t\t\t ng-class="{\'near\': vOptions.dock == \'left\', \'far\' : vOptions.dock == \'right\'}"\n\t\t\t ng-style="range.style">\n\t\t\t<div class="range">\n\t\t\t\t<div class="axis-cover" ng-style="vRelevantSize" tid="range-vertical-cover" ng-class="{\'active\' : range.cover}"></div>\n\t\t\t</div>\n\t\t\t<div class="far-edge" tid="range-vertical-far" ng-class="{\'active\' : range.near}">\n\t\t\t</div>\n\t\t\t<div class="near-edge" tid="range-vertical-near" ng-class="{\'active\' : range.far}">\n\t\t\t</div>\n\t\t\t<div class="outer-bubble-wrapper" ng-style="vWrappperSize">\n\t\t\t\t<qva-range-selection-bubble tid="range-vertical-near-bubble" visible="visible" active-component="vComponent" handle-points="range.points" range-index="$index" horizontal="false" far="false" data="range.values.start" active="range.far"> </qva-range-selection-bubble>\n\t\t\t\t<qva-range-selection-bubble tid="range-vertical-far-bubble" visible="visible" active-component="vComponent" handle-points="range.points" range-index="$index" horizontal="false" far="true" data="range.values.end" active="range.near"> </qva-range-selection-bubble>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class="range-horizontal-clip" ng-style="{ left: hOptions.offset, width: hOptions.rect.width }" ng-class="{ clip: hOptions.shouldClip }">\n\t\t<div class="range-horizontal"\n\t\t\t ng-repeat="range in hRanges track by $index"\n\t\t\t qva-range-selection-range="x"\n\t\t\t ng-class="{\'near\': hOptions.dock == \'bottom\', \'far\' : hOptions.dock == \'top\'}"\n\t\t\t ng-style="range.style">\n\t\t\t<div class="range">\n\t\t\t\t<div class="axis-cover" ng-style="hRelevantSize" tid="range-horizontal-cover" ng-class="{\'active\' : range.cover}"></div>\n\t\t\t</div>\n\n\t\t\t<div class="far-edge" tid="range-horizontal-far" ng-class="{\'active\' : range.far}">\n\t\t\t</div>\n\t\t\t<div class="near-edge" tid="range-horizontal-near" ng-class="{\'active\' : range.near}">\n\t\t\t</div>\n\t\t\t<div class="outer-bubble-wrapper" ng-style="hWrappperSize">\n\t\t\t\t<qva-range-selection-bubble tid="range-horizontal-near-bubble" visible="visible" active-component="hComponent" handle-points="range.points" range-index="$index" horizontal="true" far="false" data="range.values.start" active="range.near"> </qva-range-selection-bubble>\n\t\t\t\t<qva-range-selection-bubble tid="range-horizontal-far-bubble" visible="visible" active-component="hComponent" handle-points="range.points" range-index="$index" horizontal="true" far="true" data="range.values.end" active="range.far"> </qva-range-selection-bubble>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'}),
define("text!objects.views/selections/types/range/range-bubble.ng.html",[],function(){return'<div class="bubble-wrapper" ng-class="{\'far\' : far, \'near\' : !far}">\n\t<div ng-show="!editing" qva-direction x-dir-text="{{data.text}}" class="bubble range-bubble" ng-class="{\'active\' : active}">{{data.text}}</div>\n\t<input ng-show="editing" type="text" ng-class="{\'active\' : active, \'invalid\': invalid}" class="bubble range-input"/>\n</div>'}),define("objects.views/selections/types/range/range-bubble-directive",["jquery","touche","qvangular","text!./range-bubble.ng.html"],function(a,b,c,d){function e(a){a.$emit("rangeStart")}function f(a,b){a.editing=b,a.$emit("rangeEditChanged",b)}function g(a,b,c,d,e){a.$emit("rangeUpdate",b,c,d,!1,e)}function h(a,b){a.$emit("rangeEnd",b)}function i(){a(this).css("width",6*a(this).val().length+50+"px")}var j=".rangeselection";c.directive("qvaRangeSelectionBubble",["$timeout",function(c){return{template:d,replace:!0,restrict:"E",scope:{data:"=",active:"=",far:"=",horizontal:"=",activeComponent:"=",handlePoints:"=",visible:"=",rangeIndex:"="},link:function(d,k){function l(){p||(p=!0,b(m[0]).tap({id:j,options:{preventDefault:!1},start:function(){b.preventGestures(this.gestureHandler)}}),b(n[0]).tap({id:j,start:function(){b.preventGestures(this.gestureHandler)},end:function(){d.editable&&!d.editing&&(f(d,!0),d.onEditBubble())}}).swipe({id:j,start:function(){a.extend(!0,o,d.handlePoints),b.preventGestures(this.gestureHandler),e(d)},update:function(a,b){var c,e,f,h,i=d.far?1:0;d.horizontal?(c=b.swipe.deltaX,e="x"):(c=b.swipe.deltaY,e="y"),f=o[1^i][e],h=o[i][e]+c,0===i&&(d.horizontal&&h>f||!d.horizontal&&h<f)?(i=1,f=o[1][e]):1===i&&(d.horizontal&&h<f||!d.horizontal&&h>f)&&(i=0,f=o[0][e]),d.handlePoints[i][e]=h,d.handlePoints[1^i][e]=f,d.$digest(),g(d,d.handlePoints,e,d.rangeIndex)},end:function(){h(d,d.handlePoints)}}),m.keyup(i),d.onEditConfirmed=function(){if(d.editing){var a,b,c=m.val(),e={value:parseFloat(c),index:d.far?1:0,switch:!1},f=d.activeComponent.getPositionOfValue(e.value),i=d.handlePoints;isNaN(e.value)?d.invalid=!0:(b=d.horizontal?"x":"y",i[e.index][b]=f,(d.horizontal&&i[1][b]<i[0][b]||!d.horizontal&&i[1][b]>i[0][b])&&(a=i[1][b],i[1][b]=i[0][b],i[0][b]=a,e.index=e.index?0:1,e.switch=!0),d.endEditing(),g(d,d.handlePoints,b,d.rangeIndex,e),h(d,d.handlePoints)),d.$digest()}},d.$on("confirmEdit",d.onEditConfirmed))}var m=k.find(".range-input"),n=k.find(".range-bubble"),o={},p=!1;d.$watch("activeComponent",function(){d.editable=d.activeComponent&&!d.activeComponent.isDimension&&!d.activeComponent.isDiscrete()&&"function"==typeof d.activeComponent.getPositionOfValue,d.editable?(m.removeClass("non-editable"),n.removeClass("non-editable")):(m.addClass("non-editable"),n.addClass("non-editable"))}),d.endEditing=function(){d.invalid=!1,d.editing&&(f(d,!1),m.blur())},d.$watch("data.value",function(a){if(isNaN(a))return void(this.invalid=!0);d.editing&&d.endEditing(),m.val(a)}),d.$watch("visible",function(){d.visible||d.endEditing()}),d.$on("off",function(){d.endEditing(),b(m[0]).off("*",j),b(n[0]).off("*",j),k.off("keyup"+j,"*"),p=!1}),d.onEditBubble=function(){d.editing=!0,m.css("width",n.width()),d.$digest(),m.focus(),m[0].setSelectionRange(0,9999),d.$digest(),c(function(){i.call(m)})},d.$on("on",l),l()}}}])}),define("objects.views/selections/types/range/range-directive",["touche","qvangular","general.utils/shapes/point","text!./range-template.ng.html","./range-bubble-directive"],function(a,b,c,d){function e(a,b,d,e){var f=[];return f[b]="y"===d?new c(a[b].x,a[b].y+e):new c(a[b].x+e,a[b].y),f[1^b]=a[1^b],f}function f(a){a.$emit("rangeStart")}function g(a,b,c,d,e){a.$emit("rangeUpdate",b,c,d,e)}function h(a,b){a.$emit("rangeEnd",b)}function i(a,b,c){return b?a[0][c]>a[1][c]?0:1:a[0][c]<a[1][c]?0:1}function j(b,c,d,j){var k,l,n,o=d?"x":"y";a(c).tap({id:m,options:{preventDefault:!0},start:function(){a.preventGestures(this.gestureHandler)}}).swipe({id:m,options:{radiusThreshold:0},start:function(){l=i(b.range.points,j,o),k=b.range.points,a.preventGestures(this.gestureHandler),f(b)},update:function(a,c){b.range.points=e(k,l,o,d?c.swipe.deltaX:c.swipe.deltaY),b.$digest(),b.range.near=b.range.far=!1,n=i(b.range.points,j,o)^!d?"far":"near",b.range[n]=!0,g(b,b.range.points,o,b.$index,!1)},end:function(){h(b,b.range.points),b.range.near=b.range.far=!1}})}function k(b,c){if(!b.isOn){b.isOn=!0;var d="hey";if(a(b.axisCover).tap({id:m,options:{preventDefault:!0},start:function(){a.preventGestures(this.gestureHandler)},end:function(a,b){c.$emit("rangeToggle",a,b.pagePoints[0])}}).swipe({id:m,options:{preventDefault:!0},start:function(){d=c.range.points,a.preventGestures(this.gestureHandler),f(c),c.range.cover=!0},update:function(a,e){"y"===b.dir?c.range.points=[{x:d[0].x,y:d[0].y+e.swipe.deltaY},{x:d[1].x,y:d[1].y+e.swipe.deltaY}]:c.range.points=[{x:d[0].x+e.swipe.deltaX,y:d[0].y},{x:d[1].x+e.swipe.deltaX,y:d[1].y}],c.$digest(),g(c,c.range.points,b.dir,c.$index,!0)},end:function(){h(c,c.range.points),c.range.cover=!1}}),!a.utils.touch){var e="x"===b.dir;j(c,b.farEdge,e,e),j(c,b.nearEdge,e,!e)}}}function l(b){a(b.axisCover).off("*",m),a(b.farEdge).off("*",m),a(b.nearEdge).off("*",m),b.isOn=!1}var m=".rangeselection";b.directive("qvaRangeSelectionRange",function(){return{scope:!1,link:function(a,b,c){var d={isOn:!1,dir:c.qvaRangeSelectionRange,axisCover:b.find(".axis-cover")[0],farEdge:b.find(".far-edge")[0],nearEdge:b.find(".near-edge")[0]};k(d,a),a.$on("on",function(){k(d,a)}),a.$on("off",function(){l(d)}),a.$on("$destroy",function(){l(d)})}}}),b.directive("qvaRangeSelection",function(){return{template:d,replace:!0,scope:{vOptions:"=",hOptions:"=",vRanges:"=",hRanges:"=",activeComponent:"=",hComponent:"=",vComponent:"=",visible:"="},link:function(a){a.vRelevantSize=0,a.hRelevantSize=0,a.activeOptions={y:{far:!1,near:!1,cover:!1},x:{far:!1,near:!1,cover:!1}},a.setRangeStyle=function(a,b,c){b&&c&&b.forEach(function(b){var c=b.points[0],d=b.points[1];b.style="y"===a?{height:Math.abs(c[a]-d[a]),top:Math.min(c[a],d[a])}:{width:Math.abs(c[a]-d[a]),left:Math.min(c[a],d[a])}})},a.$watchCollection("[vRanges, vOptions]",function(b){a.setRangeStyle("y",b[0],b[1])}),a.$watchCollection("[hRanges, hOptions]",function(b){a.setRangeStyle("x",b[0],b[1])}),a.$watch("hOptions",function(b){b&&a.setRelevantSize("x",b.rect.height)}),a.$watch("vOptions",function(b){b&&a.setRelevantSize("y",b.rect.width)}),a.setRelevantSize=function(b,c){"x"===b?(a.hRelevantSize={height:c+"px"},a.hWrappperSize={height:"calc(100% - "+c+"px)"}):(a.vRelevantSize={width:c+"px"},a.vWrappperSize={width:"calc(100% - "+c+"px)"})}}}})}),define("objects.views/selections/types/range/range-angular",["jquery","qvangular","./../base","general.utils/shapes/point","general.utils/shapes/rect","./range-directive"],function(a,b,c,d,e){"use strict";function f(a){if(a.isCacheItem){var b=a.getDimensions();return b[b.length-1]}return a.parent&&a.parent.data&&a.parent.data.qText?a.parent.data.qText:a.label}function g(a,b){for(var c=a.indicators||a.getLevels()[0],d=a.getPlotMax(),e=a.getPlotMin(),f=Number.MAX_VALUE,g=-1,h=0;h<c.values.length;h++){var i=c.values[h],j=Math.abs(b-i);if(!(i<e||i>d)){if(!(j<f))break;f=j,g=h}}if(h!==-1){var k=g;return{value:c.values[g],label:(c.qualifiedLabels||c.labels)[k]}}return null}function h(a,b,c){for(var d=a.getLevels(),e=d.length-1;e>=0;--e){for(var f=d[e],g=null,h=null,i=0;i<f.values.length;++i)f.values[i]===b&&(g=(f.qualifiedLabels||f.labels)[i]),f.values[i]===c&&(h=(f.qualifiedLabels||f.labels)[i]);if(g&&h)return{l1:g,l2:h}}return{l1:null,l2:null}}function i(a,b){var c=a.isDiscrete&&a.isDiscrete();if(!a.isDimension||c)return null;var d=a.getValueOfPosition(b),e=g(a,d);return e?(e.newPoint=a.getPositionOfValue(e.value),Math.abs(e.newPoint-b)>F?null:e):null}function j(a,b){var c=this.getComponentKey(this.activeComponent),d="x"===c?"width":"height",e=a.rect[c],f=a.rect[c]+a.rect[d],g=this.activeComponent.rect,h=this.getRect(this.activeComponent),i=h[c]-g[c],j=i+h[d];e===f&&0===e&&(e=f=b[c]);var k=null,l=null;if(E[c].length>1)for(var m=0;m<E[c].length;++m){var n=E[c][m];if(a!==n){var o=n.rect[c],p=n.rect[c]+n.rect[d];p<=e&&(null===k||p>k)&&(k=p),o>=f&&(null===l||o<l)&&(l=o)}}return i<=e&&(null===k||i>k)&&(k=i),j>=f&&(null===l||j<l)&&(l=j),{min:k,max:l}}function k(a,b,c,d,e){var g,h,k,l,m,n=this.activeComponent,o=this.components.dataArea[0].rect,p=function(a,b,d){if(e){if(e.switch){var f=c.startVal;c.startVal=c.updateVal,c.updateVal=f}var g=Math.max(Math.min(e.value,n.getPlotMax()),n.getPlotMin());0===e.index&&"horizontal"===d||1===e.index&&"vertical"===d?c.startVal=g:c.updateVal=g}else c.startVal=n.getValueOfPosition(a),c.updateVal=n.getValueOfPosition(b),c.maxIncluded=!n.isDimension||n.getDataMax()<=c.updateVal},q=0,r=0,s=0,t=0,v=n.isDiscrete&&n.isDiscrete(),w=j.call(this,c,a);switch(n.dock){case"top":case"bottom":q=z(a.x,b.x),s=A(a.x,b.x),r=0,t=o.height,null!==w.min&&w.min>q?(d&&(s+=w.min-q),q=w.min):(g=i(n,q),g?(c.startLabel=g.label,q=null===w.min?g.newPoint:Math.max(w.min,g.newPoint)):c.startLabel=u(n.getValueOfPosition(q),n)),null!==w.max&&w.max<s?(d&&(q+=w.max-s),s=w.max):(h=i(n,s),h?(c.updateLabel=h.label,s=null===w.max?h.newPoint:Math.min(w.max,h.newPoint)):c.updateLabel=u(n.getValueOfPosition(s),n)),c.rect.set(q,r,s-q,t-r),v?(k=this.shapesFromRectForDirection(c.rect,"x","dataArea"),k.length?(l=this.options&&this.options.rtl?k[k.length-1]:k[0],m=this.options&&this.options.rtl?k[0]:k[k.length-1],c.startVal=f(l),c.updateVal=f(m)):(c.startVal="-",c.updateVal="-"),c.maxIncluded=!0):p.call(this,q,s,"horizontal");break;case"left":case"right":r=z(a.y,b.y),t=A(a.y,b.y),q=0,s=o.width,null!==w.min&&w.min>r&&(d&&(t+=w.min-r),r=w.min),null!==w.max&&w.max<t&&(d&&(r+=w.max-t),t=w.max),g=i(n,r),g?(c.startLabel=g.label,r=g.newPoint):c.startLabel=u(n.getValueOfPosition(r),n),h=i(n,t),h?(c.updateLabel=h.label,t=h.newPoint):c.updateLabel=u(n.getValueOfPosition(t),n),c.rect.set(q,r,s-q,t-r),v?(k=this.shapesFromRectForDirection(c.rect,"y","dataArea"),k.length?(l=k[0],m=k[k.length-1],c.startVal=f(l),c.updateVal=f(m)):(c.startVal="-",c.updateVal="-"),c.maxIncluded=!0):p.call(this,r,t,"vertical")}}function l(){return this.components.x&&this.components.y&&1===this.components.x.length&&1===this.components.y.length&&!this.components.x[0].isDiscrete()&&!this.components.y[0].isDiscrete()}function m(){w.y=!1,w.x=!1,this._rangeEventWatchers&&(this._rangeEventWatchers.forEach(function(a){a()}),this._rangeEventWatchers=null),B.hide(),B.detach(),w.rangeSelectIsVisible=!1,E={x:[],y:[]}}function n(a,b,c){var d={rect:new e(0,0,0,0),startVal:0,updateVal:0,component:b};return c?E[a].push(d):E[a][0]=d,d}function o(a,b,c){for(var d=E[a],f="x"===a&&c.yMirrorMode,g=f?b.end:b.start,i=f?b.start:b.end,j=h(c,g,i),k=j.l1||(f?null:b.label),l=j.l2||(f?b.label:null),m=-1,n=0;n<d.length;n++){if(f?d[n].updateVal<=i&&g<=d[n].startVal:d[n].startVal<=g&&i<=d[n].updateVal){m=n;break}}if(m===-1)d.push({startVal:g,startLabel:k,updateVal:i,updateLabel:l,component:c,rect:new e(0,0,0,0),maxIncluded:!1});else{var o=d[m];d[m]={startVal:o.startVal,startLabel:o.startLabel,updateVal:g,updateLabel:k,component:c,rect:new e(0,0,0,0),maxIncluded:!1},d.push({startVal:i,startLabel:l,updateVal:o.updateVal,updateLabel:o.updateLabel,component:c,rect:new e(0,0,0,0),maxIncluded:!1})}p(a,c.yMirrorMode)}function p(a,b){var c="x"===a&&b,d=c?"updateVal":"startVal",e=c?"startVal":"updateVal",f=E[a];f.sort(function(a,b){return a[d]<b[d]?-1:a[d]>b[d]?1:0});for(var g=f.length-1;g>=0;--g)if(f[g].startVal!==f[g].updateVal){if(g<f.length-1){var h=f[g][e],i=f[g+1][d];h>=i&&(f[g+1][e]>f[g][e]&&(f[g][e]=f[g+1][e],c?f[g].startLabel=f[g+1].startLabel:f[g].updateLabel=f[g+1].updateLabel),f.splice(g+1,1),g<f.length-1&&++g)}}else f.splice(g,1)}function q(a,b,c){a||(a="x"),b||(b=0);var d=E[a][b];return d||(d={rect:new e(0,0,0,0),startVal:0,endVal:0},E[a][b]=d),d.component=c,d}function r(a,b,c,d){var e,f=[],g=this._previousShapes?this._previousShapes.slice():[],h=this.getActiveMode(),i=E["y"===b?"x":"y"];if("range.discrete"===h)f=this.shapesFromRectForDirection(a.rect,b,"dataArea"),f=this.groupedItemsFromShapes(f),f.forEach(function(a){var b=g.indexOf(a);b>=0&&g.splice(b,1),a.selectionMode=h}),c.call(this,f,d),this._clearPrev&&c.call(this,g,this.ToggleFlag.deselect),this._shapes=f;else if("range.dimension"===h){if(this.components.dataArea&&this.components.dataArea[0].updateRangeSelection){var j=E[b].map(function(a){return t(a.startVal,a.updateVal,a.maxIncluded)});this.handler.UpdateRanges.emit(j)}}else l.call(this)?(e=i.length?a.rect.intersection(i[0].rect):a.rect,this.components.dataArea&&this.components.dataArea[0].updateRangeSelection&&this.components.dataArea[0].getIsReduced()||(f=this.shapesFromRect(e,"dataArea")),this.components.dataArea&&this.components.dataArea[0].updateRangeSelection&&this.components.dataArea[0].updateRangeSelection(e)):f=this.shapesFromRange(a.startVal,a.updateVal),f.forEach(function(a){a.selectionMode=h}),c.call(this,f,d),this._shapes=f}function s(a,b,c,d){var e=this.getComponentKey(this.activeComponent),f=b,g=this.ToggleFlag.select,h=this.toggleSelection;k.call(this,x,f,a,c,d),"range.measure"===this.getActiveMode()?this.clearSelection(!0):this._shapes&&h.call(this,this._shapes,this.ToggleFlag.deselect),r.call(this,a,e,h,g),this.updateRangeDisplay()}function t(a,b,c){return{min:Math.min(a,b),max:Math.max(a,b),maxIncluded:!!c}}function u(a,b){return b.isDiscrete&&b.isDiscrete()||!b.isDimension?b.getFormatter().format(a):b.formatValue(a)}var v,w,x,y=!1,z=Math.min,A=Math.max,B=a("<div />"),C=B[0],D=a('<div qva-range-selection visible="rangeSelectIsVisible" active-component="activeComponent" v-component="vComponent" h-component="hComponent" v-ranges="vRanges" h-ranges="hRanges" h-options="hOptions" v-options="vOptions"/>'),E={x:[],y:[]},F=15;return v=c.extend("RangeSelection",{init:function(a,b){this._super(a,b),this._shapes=null,this._nrEditing=0,this.setActiveMode("item")},initComponent:function(a){this.previousComponent=this.activeComponent,this.setActiveComponent(this.getComponent(a.x,a.y)),w.activeComponent=this.activeComponent,this.components.x.indexOf(w.activeComponent)!==-1?w.hComponent=w.activeComponent:this.components.y.indexOf(w.activeComponent)!==-1&&(w.vComponent=w.activeComponent)},setDirection:function(a){this.options.rtl="rtl"===a},refreshContainer:function(){var b,c=this.components.dataArea[0].rect,d=a(this.components.dataArea[0].container).position(),f=new e(d.left,d.top,c.width,c.height),g=[];["x","y"].forEach(function(a){this.components[a]&&!this.components[a].contains(this.activeComponent)&&(g=g.concat(this.components[a]))}.bind(this)),this.activeComponent&&g.push(this.activeComponent),g.forEach(function(c){c.isVisible()&&(b=a(c.container).position(),f=f.combineWith(new e(b.left,b.top,c.rect.width,c.rect.height)))},this),this._offset={left:d.left-f.x,top:d.top-f.y},B.css({left:f.x,top:f.y,width:f.width,height:f.height})},resetSelectedShapes:function(){this._previousSelectedShapes=this._selectedShapes.concat(),this._super()},getIsEditing:function(){return this._editing},confirmEdit:function(){w.$broadcast("confirmEdit")},getRect:function(a,b){return a?(b=b||!1,a.hasOwnProperty("innerRect")&&!b?a.innerRect:a.rect):new e(0,0,0,0)},getExtendedRect:function(a){return a?a.hasOwnProperty("extendedRect")?a.extendedRect:this.getRect(a):new e(0,0,0,0)},getTransformedPoint:function(a,b){var c=this.getRect(this.activeComponent||this.components.dataArea[0],!0);return new d(a-c.x-this.handler.containerRect.x,b-c.y-this.handler.containerRect.y)},getComponent:function(a,b){var c=new d(a-this.handler.containerRect.x,b-this.handler.containerRect.y);return Object.keys(this.components).map(function(a){return this.components[a]},this).reduce(function(a,b){return a.concat(b)}).filter(function(a){return this.getExtendedRect(a).pointInside(c.x,c.y)},this)[0]},checkActiveMode:function(a,b){a.contains(this.handler.getActiveMode())||this.clearSelection(b),this.setActiveMode(a[0])},toggleRect:function(a,b,c){this.start(a,b),this.update(a,c),this.end(a)},toggle:function(a,b,c){c=void 0!==c?c:this.handler.getKeyAsToggleSelected(a);var d;if(c||this.clearSelection(),this.resetSelectedShapes(),this._editing&&this.confirmEdit(),this.activeComponent&&"function"==typeof this.activeComponent.isDiscrete&&this.activeComponent.isDiscrete()){this.cancel(),d=this.getTransformedPoint(b.x,b.y);var e=this.shapesFromPoints([d]),f=this.options.toggle.callback||this.toggleSelection,g=this.ToggleFlag.auto|this.ToggleFlag.tooltip;e=this.groupedItemsFromShapes(e),e.forEach(function(a){a.selectionMode="dataArea"}),this.checkActiveMode(["item"]),f.call(this,e,g)}else if(this.activeComponent&&this.activeComponent.isDimension){d=this.getTransformedPoint(b.x,b.y);var h=this.activeComponent.getLabelFromPoint(d);if(h){this.checkActiveMode(["range.dimension"]),this.resetSelectedShapes();var i=this.getComponentKey(this.activeComponent);o(i,h,this.activeComponent),r.call(this,null,i,null,null),this.selectRange(),this.refreshContainer(),this.initWatchers(),this.updateRangeProjection(),this.updateRangeDisplay()}}},updateRangeDisplay:function(){w.hRanges=[],w.vRanges=[],w.vRanges=E.y.map(function(a){var b=new d(a.rect.x,a.rect.y),c=new d(a.rect.x+a.rect.width,a.rect.y+a.rect.height),e=a.startLabel||(isNaN(a.startVal)?a.startVal:u(a.startVal,a.component)),f=a.updateLabel||(isNaN(a.updateVal)?a.updateVal:u(a.updateVal,a.component));return a.maxIncluded||(f="<"+f),{points:[c,b],values:{start:{text:f,value:a.updateVal},end:{text:e,value:a.startVal}}}}),w.hRanges=E.x.map(function(a){var b=new d(a.rect.x,a.rect.y),c=new d(a.rect.x+a.rect.width,a.rect.y+a.rect.height),e=a.startLabel||(isNaN(a.startVal)?a.startVal:u(a.startVal,a.component)),f=a.updateLabel||(isNaN(a.updateVal)?a.updateVal:u(a.updateVal,a.component));return a.maxIncluded||(a.component.yMirrorMode?e="<"+e:f="<"+f),{points:[b,c],values:{start:{text:e,value:a.startVal},end:{text:f,value:a.updateVal}}}}),E.y.length>0&&(w.vOptions={rect:this.getRect(E.y[0].component,!0).clone(),offset:this._offset.top,padding:E.y[0].component.getPadding(),dock:E.y[0].component.dock,shouldClip:"range.dimension"===this.getActiveMode()}),E.x.length>0&&(w.hOptions={rect:this.getRect(E.x[0].component,!0).clone(),offset:this._offset.left,padding:E.x[0].component.getPadding(),dock:E.x[0].component.dock,shouldClip:"range.dimension"===this.getActiveMode()}),w.rangeSelectIsVisible||(this.handler.container.append(B),B.show(),w.rangeSelectIsVisible=!0),w.$digest()},initWatchers:function(){if(!this._rangeEventWatchers){var a=this;this._rangeEventWatchers=[],this._rangeEventWatchers.push(w.$on("rangeStart",function(){a.resetSelectedShapes(),a._shapes=a._previousShapes,a._clearPrev=!0})),this._rangeEventWatchers.push(w.$on("rangeUpdate",function(b,c,d,e,f,g){x=c[0],a.components[d].indexOf(a.activeComponent)<0&&a.setActiveComponent(a.components[d][0]);var h=E[d][e];s.call(a,h,c[1],f,g),a._clearPrev=!1})),this._rangeEventWatchers.push(w.$on("rangeEditChanged",function(b,c){a._nrEditing=c?a._nrEditing+1:a._nrEditing-1,a._nrEditing>1&&(a.confirmEdit(),a._nrEditing=1,b.targetScope.onEditBubble()),a._editing=a._nrEditing>0})),this._rangeEventWatchers.push(w.$on("rangeEnd",function(){a.end(),a._clearPrev=!1})),this._rangeEventWatchers.push(w.$on("rangeToggle",function(b,c,d){a.toggle(c,d)}))}},start:function(a,b){if(this.handler._disableSelections)return!0;this.resetSelectedShapes(),this.refreshContainer(),this.activeComponent.isDiscrete&&this.activeComponent.isDiscrete()?this.checkActiveMode(["range.discrete","item"]):this.activeComponent.isDimension?this.checkActiveMode(["range.dimension"]):this.checkActiveMode(["range.measure"]);var c=this.getComponentKey(this.activeComponent);"x"!==c&&"y"!==c||(this.currentRange=n(c,this.activeComponent,"range.dimension"===this.getActiveMode()),this.initWatchers(),x=this.getTransformedPoint(b.x,b.y))},update:function(a,b){if(this.handler._disableSelections)return!0;s.call(this,this.currentRange,this.getTransformedPoint(b.x,b.y),!1)},updateShapesState:function(){var a=this.getComponentKey(this.activeComponent),b=q(a,0,this.activeComponent),c=this.getActiveMode(),d=this.ToggleFlag.select,e=[],f=this.toggleSelection;this.clearSelection(!0),this.activeComponent.isDiscrete&&!this.activeComponent.isDiscrete()&&(e=this.shapesFromRange(b.startVal,b.updateVal),e.forEach(function(a){a.selectionMode=c}),f.call(this,e,d)),this._shapes=e},updateRangeProjection:function(){var a=this.components.dataArea[0].rect;E.x.forEach(function(b){var c=b.component.getPositionOfValue(b.startVal),d=b.component.getPositionOfValue(b.updateVal),e=Math.min(c,d),f=Math.max(c,d),g=a.height;b.rect.set(e,0,f-e,g-0)}),E.y.forEach(function(b){var c=b.component.getPositionOfValue(b.startVal),d=b.component.getPositionOfValue(b.updateVal),e=a.width,f=Math.max(c,d),g=Math.min(c,d);b.rect.set(0,g,e-0,f-g)})},end:function(){if(this.handler._disableSelections)return!0;if(this.currentRange=null,"range.dimension"===this.getActiveMode()){p(this.getComponentKey(this.activeComponent),this.activeComponent.yMirrorMode),this.updateRangeProjection()}this.updateRangeDisplay(),this.selectRange(),this._previousShapes=this._shapes,this._shapes=null},cancel:function(){if(this.handler._disableSelections)return!0;this._nrEditing=0,this._editing=!1,"range.discrete"===this.getActiveMode()&&this.setActiveMode("item"),this._shapes=null,m.call(this)},clearSelection:function(a){a=a||!1,this._shapes=null,a?this._super():(this._super(),m.call(this))},selectRange:function(){var a=this.handler.SelectRange,b=[],c=!1;if(this.activeComponent){if("range.discrete"===this.getActiveMode()){var d=this._previousSelectedShapes,e=this.getSelectedShapes().concat();return d.forEach(function(a){e.indexOf(a)===-1&&e.push(a)}),void(e.length>0&&this.handler.Select.emit(e))}E.x.concat(E.y).forEach(function(a){a.component.getType().current.forEach(function(c){b.push({idx:c,type:a.component.getType().type,range:t(a.startVal,a.updateVal,a.maxIncluded)})})}),c=!l.call(this),this._editing||a.emit(b,c)}},on:function(){if(!y){var a=b.getService("$compile"),c=b.getService("$rootScope");w=c.$new(),C.className="selections-range-ui",B.append(D),B.hide(),a(C)(w),y=!0,w.rangeSelectIsVisible=!1}w.$broadcast("on")},off:function(){this.activeComponent&&(w.$broadcast("off"),this.setActiveComponent(null),m.call(this))}}),v.defaultOptions={toggle:{callback:null}},v}),define("objects.views/selections/types/dom-base",["./base","general.utils/shapes/rect"],function(a,b){"use strict";function c(a,b){var c,d,e=b[0],f=!1;for(c=0;c<a.length;c++)d=a[c],d.startVal===e.startVal&&d.updateVal===e.updateVal&&(a.splice(c,1),c--,f=!0);return f||(a=a.concat(b)),a}var d;return d=a.extend({init:function(a,b){this._super(a,b),this.internal=!0},release:function(){},initComponent:function(a,b){document.activeElement&&document.activeElement.blur(),b?this.setActiveComponent(b):(this.handler.refreshContainerRect(),this.setActiveComponent(this.getComponent(a.x,a.y,this.handler.containerRect)))},getRect:function(a){return a?a.hasOwnProperty("innerRect")?a.innerRect:a.rect:new b(0,0,0,0)},setComponent:function(a,b){this._super(a,b),(Array.isArray(b)?b.concat():[b]).forEach(function(a){a.selections=this,this.handler._isListening&&b.on()},this)},addComponent:function(a,b){this._super(a,b),b.selections=this,this.handler._isListening&&b.on()},removeComponent:function(a,b){this._super(a,b),b.selections=null,b.off()},updateFromItems:function(a,b,c,d){var e=this.handler,f=this;if(!e.canTypeBeActivated(this))return void e.SelectWhileLocked.emit(c?this.activeComponent.getAttributeDimensionInfo():void 0);if(this.resetSelectedShapes(),this.setActiveMode(c?"item"+this.activeComponent.getColorMap().getColorDataInfo().legendPath.replace(/\//g,"."):"item"),e.activate(this),c&&e.SelectAttributeDim.emit(d,e.getKeyAsToggleSelected(a)),b=b.filter(function(a){return f._allowNullSelect||!f.shapesFrom._isNull(a,f.activeComponent.getSelectionIndices())}),b.length){(this.options.toggle.callback||this.toggleSelection).call(this,b),c||e.Select.emit(this.getSelectedShapes(),e.getKeyAsToggleSelected(a))}},rangeStart:function(a){var b=this.handler;if(!b.canTypeBeActivated(this))return void b.SelectWhileLocked.emit();this.setActiveMode("range.measure"),b.activate(this),a&&this.resetSelectedShapes()},rangeUpdate:function(a,b){var d=this.handler;if(!d.canTypeBeActivated(this))return void d.SelectWhileLocked.emit();var e,f=this.options.toggle.callback||this.toggleSelection,g=[],h=this.ToggleFlag.select;for(this.clearSelection(!0),this._rangeObjects&&b&&(a=c(this._rangeObjects,a)),e=0;e<a.length;e++){var i=a[e];g=g.concat(this.shapesFromRange(i.startVal,i.updateVal,!0,i.isMax))}g.forEach(function(a){a.selectionMode="range.measure"}),f.call(this,g,h),this._rangeObjects=a,this._shapes=g},rangeEnd:function(){this.selectRange(),this._shapes=null},toggle:function(){},cancel:function(){this._rangeObjects=null,this.activeComponent.cancelSelection()},clearSelection:function(a){this._super(),a||(this._rangeObjects=null,this.activeComponent.clearSelection())},selectRange:function(){var a,b,c=this.handler.SelectRange,d=[];if(this._rangeObjects){for(a=0;a<this._rangeObjects.length;a++)b=this._rangeObjects[a],d.push({idx:b.idx||0,range:{min:Math.min(b.startVal,b.updateVal),max:Math.max(b.startVal,b.updateVal)}});c.emit(d,!0)}}}),d.defaultOptions={},d}),define("objects.views/selections/types/color-legend",["./dom-base"],function(a){"use strict";var b;return b=a.extend({setIsEditing:function(a,b){this._editing=a,this._scope=b},getIsEditing:function(){return this._editing},confirmEdit:function(){this._scope.$broadcast("confirmEdit")},selectWhileLocked:function(a){this.handler.SelectWhileLocked.emit(a)}}),b.defaultOptions={captureInput:!0,toggle:{callback:null}},b}),define("objects.views/selections/handler",["jquery","core.utils/class","core.utils/notification","client.utils/state","./types/data-area","./types/range/range-angular","./types/color-legend","general.utils/shapes/rect","./interaction-type","./interaction-handler"],function(a,b,c,d,e,f,g,h,i,j){function k(b){Object.keys(b).forEach(function(c){c in o&&(this.types[c]=new o[c](this,a.extend(!0,{},o[c].defaultOptions,b[c])))},this)}function l(a,b){var c;for(c=0;c<b.length;c++)if(a.contains(b[c]))return!0;for(c=0;c<a.length;c++)if(b.contains(a[c]))return!0;return!1}var m,n,o={dataArea:e,range:f,colorLegend:g};return m=b.extend({init:function(b,d,e){c.mixin(this),this.notification("Activated"),this.notification("Deactivated"),this.notification("ToggleShape"),this.notification("ToggleShapes"),this.notification("SelectWhileLocked"),this.notification("Lasso"),this.notification("Confirm"),this.notification("Cancel"),this.notification("Select"),this.notification("SelectRange"),this.notification("SelectAttributeDim"),this.notification("Clear"),this.notification("ResetSelections"),this.notification("UpdateRanges"),this._active=!1,this._autoActivated=!1,this._isListening=!1,this._isScrolling=!1,this._isLocked=!1,this._shiftPressed=!1,this._lassoEnabled=!1,this._allowLasso=!0,this._enabled=!0,this.container=b,this.options=a.extend(!0,{},{toggle:!0,toggleRect:!0,swipe:!0,ctrlKeyAsToggleSelected:!1},d),this.cache=e,this.containerRect=new h(0,0,0,0),this.types={},this._keyboard=!0,k.call(this,this.options)},setContainer:function(a){this.off(),this.container=a,this.on()},refreshContainerRect:function(){var a=this.offset=this.container.offset(),b=this.container.width(),c=this.container.height();this.containerRect.set(a.left,a.top,b,c)},canTypeBeActivated:function(a){return!(a&&a.activeComponent&&"function"==typeof a.activeComponent.isSelectionLocked?a.activeComponent.isSelectionLocked():this._isLocked)},on:function(){function a(){if(o._activeType&&o._activeType!==m){var a=o._activeType.getActiveDimensions();o._activeType.getActiveMode()===m.getActiveMode()&&l(a,m.getActiveDimensions())||(o._activeType.clearSelection(),o.ResetSelections.emit()),o._activeType.cancel()}o._activeType=m}function b(){a(),p._disableSelectionActivation||o.activate()}function c(){return o._active&&!d.isInEditMode()}function g(){return m&&p.swipe}function h(a,b){n=b,m=a,o.refreshContainerRect(),m&&m.initComponent(b)}function k(a,b){j.addInteraction(o._eventHandlers,a.container,1,["tap","swipe","taptwo"],p.swipe,b)}if(!this._isListening){this._isListening=!0;var m,o=this,p=this.options;this._reset=function(){m=null},this.getActiveType=function(){return o._activeType},this.getActiveMode=function(){return o._activeType?o._activeType.getActiveMode():null},this._setTypeOnAutoActivate=function(){m=o.types.dataArea},this._activateType=function(b){m=b,a()},this._mouseUp=function(a){1===a.which&&(!o._shiftPressed&&o._drawingWithShift||o._shiftPressed&&o._drawingWithoutShift)&&o.Lasso.emit(!o.lassoEnabled)},this._shiftToggle=function(a){o._shiftPressed=a,o._allowLasso&&o._keyboard&&!o._drawingWithShift&&!o._drawingWithoutShift&&o._active&&o.Lasso.emit(!o.lassoEnabled)},this._keyPressed=function(a){o._keyboard&&c()&&(27===a?o.cancel():13===a&&(m&&m.getIsEditing&&m.getIsEditing()?m.confirmEdit():o.confirm()))},j.ShiftToggle.bind(this._shiftToggle),j.KeyPressed.bind(this._keyPressed),j.MouseUp.bind(this._mouseUp),this.types.range&&this.types.range.on&&this.types.range.on();var q,r=!1;this._eventHandlers=i.extend({tap:{start:function(a,b,c){h(c,b.pagePoints[0]),document.activeElement&&document.activeElement.blur()},end:function(a,c){if(m&&!m.internal&&p.toggle){if(!o.canTypeBeActivated(m))return void o.SelectWhileLocked.emit();b(),j.preventGestures(this),m.toggle.call(m,a,c.pagePoints[0]),m.getSelectedShapes().length>0&&o.Select.emit(m.getSelectedShapes(),o.getKeyAsToggleSelected(a))}}},taptwo:{start:function(){},end:function(a,c,d){if(p.toggleRect&&(h(d,c.pagePoints[0]),m&&p.toggle)){if(!o.canTypeBeActivated(m))return void o.SelectWhileLocked.emit();b(),m.toggleRect.call(m,a,c.pagePoints[0],c.pagePoints[1])}}},swipe:{start:function(a){if((g()||p._enablePanning)&&(o._shiftPressed&&!o._active&&o.allowLasso&&o.Lasso.emit(!o.lassoEnabled),m&&!m.internal)){if(o._drawingWithShift=o._shiftPressed,o._drawingWithoutShift=!o._shiftPressed,!o.lassoEnabled&&m.activeComponent&&m instanceof e)return void(this._isPanning=!0);if(m.activeComponent){if(this._isPanning=!1,r=!0,q=this.options.useMomentum,this.options.useMomentum=!1,!o.canTypeBeActivated(m))return void o.SelectWhileLocked.emit();b(),m.start.call(m,a,n)}}},update:function(a,b){if((g()||p._enablePanning)&&!this._isPanning&&r&&m){if(!o.canTypeBeActivated(m))return void o.SelectWhileLocked.emit();m.update.call(m,a,b.pagePoints[0])}},end:function(a,b){if(g()||p._enablePanning)if(o._drawingWithShift=!1,o._drawingWithoutShift=!1,this._isPanning)this._isPanning=!1;else if(r&&m){if(r=!1,this.options.useMomentum=q,!o.canTypeBeActivated(m))return void o.SelectWhileLocked.emit();m.end.call(m,a,b)}},cancel:function(){m&&r&&(this.options.useMomentum=q,m.cancel.call(m,!0))}},exclusive:function(){return o.lassoEnabled},active:function(){return o._enabled}}),this.registerAddedComponent=function(a,b){a.internal||a instanceof f&&"dataArea"===b.selectionIdentifier||k(b,a)},this.deregisterAddedComponent=function(a,b){a.internal||a instanceof f&&"dataArea"===b.selectionIdentifier||j.removeInteraction(o._eventHandlers,b.container)},Object.keys(this.types).map(function(a){return this.types[a]},this).forEach(function(a){return Object.keys(a.components).map(function(b){return a.components[b]}).forEach(function(b){b.forEach(function(b){o.registerAddedComponent(a,b)})})})}},register:function(a,b){this.registerAddedComponent&&this.registerAddedComponent(a,b)},deregister:function(a,b){this.deregisterAddedComponent&&this.deregisterAddedComponent(a,b)},off:function(){j.ShiftToggle.unbind(this._shiftToggle),j.KeyPressed.unbind(this._keyPressed),j.MouseUp.unbind(this._mouseUp),j.removeInteraction(this._eventHandlers),this.types.range&&this.types.range.off&&this.types.range.off(),this._isListening=!1,
this.registerAddedComponent=null,this.deregisterAddedComponent=null},autoActivate:function(){!this._autoActivated&&this._isListening&&(this._autoActivated=!0,this._setTypeOnAutoActivate(),this._activeType=this.types.dataArea,this._activeType.initComponent(),this.activate())},activate:function(a){this._active||(this.Activated.emit(),this._active=!0,this._shiftPressed&&!this.lassoEnabled&&this.Lasso.emit(!0)),a&&this._activateType(a)},deactivate:function(a){this._active&&(this._active=!1,this._autoActivated=!1,a||this.clearSelection(),this._activeType&&(this._activeType.cancel(),this._activeType=void 0),this.Deactivated.emit(),this._reset())},confirm:function(){this._activeType&&this.deactivate(!0),this.Confirm.emit()},cancel:function(){this.deactivate(),this.Cancel.emit()},clearSelection:function(){this._activeType&&this._activeType.clearSelection()},toggleKeyboardAccelerators:function(a){this._keyboard=a},getKeyAsToggleSelected:function(a){return!(a.metaKey||a.ctrlKey)},release:function(){this.off(),c.release(this),Object.keys(this.types).forEach(function(a){this.types[a].release()},this)},setLocked:function(a){this._isLocked=a}}),Object.defineProperties(m.prototype,{allowLasso:{set:function(a){this._allowLasso=a},get:function(){return this._allowLasso}},lassoEnabled:{set:function(a){this._lassoEnabled=a&&this.allowLasso},get:function(){return this._lassoEnabled}},enabled:{set:function(a){this._enabled=a},get:function(){return this._enabled}}}),m}),define("objects.extension/default-view-selection-service",["qvangular","objects.views/selections/handler"],function(a,b){"use strict";a.service("qvDefaultViewSelectionService",[function(){return{createSelections:function(a,c,d,e){var f,g;if(d&&d.dataArea)return d.range&&(d.range.rtl="rtl"===a.options.direction),d.isPopover=a.options.isPopover,d.selectionsDisabled=a.options.selectionsDisabled||!1,f=new b(c,d,e),f.Activated.bind(function(){a.selectionsApi.activated()}),f.Deactivated.bind(function(){a.selectionsApi.deactivateSearch&&a.selectionsApi.deactivateSearch()}),f.Cancel.bind(function(){a.selectionsApi.cancel()}),f.Select.bind(function(){a.selectionsApi.selectionsMade=!0}),f.SelectRange.bind(function(){a.selectionsApi.selectionsMade=!0}),f.SelectAttributeDim.bind(function(){a.selectionsApi.selectionsMade=!0}),f.Confirm.bind(function(){a.backendApi.endSelections(!0),a.selectionsApi.deactivated()}),f.ResetSelections.bind(function(){a.backendApi.clearSelections()}),a.selectionsApi.confirm=function(){f&&f.confirm()},g=a.selectionsApi.deactivated.bind(a.selectionsApi),a.selectionsApi.deactivated=function(){f&&f.deactivate(),g()},a.selectionsApi.deactivate=function(){f&&(f.deactivate(),this.deactivated())},a.selectionsApi.clear=function(){f.clearSelection(),a.backendApi.clearSelections(),a.tooltipApi.cancel(),a.selectionsApi.selectionsMade=!1},a.selectionsApi.toggleKeyboardAccelerators=function(a){f.toggleKeyboardAccelerators(a)},a.selectionsApi.getKeyAsToggleSelected=function(a){return f.getKeyAsToggleSelected(a)},a.selectionsApi.toggleSearch=function(){a.options.search.toggle()},a.selectionsApi.activate=function(){f.autoActivate()},a.selectionsApi.on=function(){f.on()},a.selectionsApi.off=function(){f.off()},a.$on("$destroy",function(){f&&(f.release(),f=null)}),f}}}])}),define("objects.extension/default-controller",["objects.extension/base-controller","util","core.utils/deferred","objects.views/charts/tooltip/chart-tooltip","objects.views/selections/cache","objects.utils/selection-util","objects.extension/default-view-selection-service"],function(a,b,c,d,e,f){"use strict";var g;return g=a.extend({$scope:null,$element:null,api:null,view:null,_create:function(a,c,d,f,g,h,i){f.navigation=f.navigation!==!1;var j=this._createView(a,c,d,f,h,i),k=new e;if(g.selections){var l=b.extend(!0,{},g.selections,f.selections||{});f.selections!==!1&&f._disableSelections!==!0&&this._createSelections(j,a,c,l,k)}return g.tooltips&&f.tooltips!==!1&&this._createTooltip(j,a,c,b.extend(!0,{},g.tooltips,f.tooltips||{}),k,f.cssTransform),j},_createView:function(a,b,c,d,e,f){return new c(a,b,d,e,f)},_createSelections:function(a,b,c,d,e){var f=this.selectionService.createSelections(b,c,d,e);return a.setSelections(f),f},_createTooltip:function(a,b,c,e,f,g){var h=new d(c,e,f);h.setCssTransform(g),b.tooltipApi.cancel=function(){h.cancel()},a.setTooltips(h)},init:function(a,b,c){this.$scope=a,this.$element=b,this.selectionService=c;var d=this,e=this.view=this._create(a,b,a.ext.View,a.options,a.ext.options,a.backendApi,a.selectionsApi);e.initialize(),this._handleSpecialCaseForSyntaxSugarInExtension(e),a.$on("$destroy",function(){e&&(e.destroy(e),a.options=null,d.view=null,e=null)})},_handleSpecialCaseForSyntaxSugarInExtension:function(a){var b,c=this.$scope.object.ext;for(b in c)"View"!==b&&"constructor"!==b&&"options"!==b&&"init"!==b&&"destroy"!==b&&a[b]&&(a[b]=c[b])},onPaint:function(a,b){var d=this.view,e=this.$scope;return c.resolve().then(function(){if(d&&!d.suppressOnPaint(e.layout))return f.isModalSelectionModel(e.object.model)&&d.selectionsApi.confirm(),d.refreshSelections(),d.prePaint(e.layout),d.updateData(e.layout).then(function(){if(b.visible){var a=d.$element;return e.ext.hasDefaultTemplate()&&(a=a.children().first()),d.paint(a,e.layout)}})})},onResize:function(a,b){var d=this.view,e=this.$scope;return d.refreshSelections(),c.resolve().then(function(){var c=d.$element;return e.ext.hasDefaultTemplate()&&(c=c.children().first()),d.resize(c,a,b)})},setInteractionState:function(a){this.view&&this.view.setInteractionState(a)},setFreeResize:function(a){this.view&&this.view.setFreeResize(a)},setDirection:function(a){this.view&&this.view.setDirection(a)},setBackendApi:function(a){this.view.setBackendApi(a)},setSnapshotData:function(a,b){return this.view.setSnapshotData(a,b)},getContextMenu:function(a,b){return this.view.getContextMenu(a,b)},getSelectionToolbar:function(){return this.view.getSelectionToolbar()},getViewState:function(){return this.view.getViewState()},getPreferredSize:function(){return this.view.getPreferredSize()}}),g.$inject=["$scope","$element","qvDefaultViewSelectionService"],g}),define("text!objects/inline-title-edit.ng.html",[],function(){return'<div ng-show="!editing && displayValue == \'\'" class="qv-inline-edit-button">\n\t<div qva-direction x-dir-setting="{{dirSetting}}" class="add-content" q-title-translation="{{emptyTranslation}}">\n\t\t<span class="lui-icon lui-icon--plus"></span>\n\t\t<span class="add-text" qva-direction x-dir-text="{{addTranslation}}" title="{{addTranslation}}">{{addTranslation}}</span>\n\t</div>\n</div>\n<div qva-direction x-dir-setting="{{dirSetting}}" x-dir-text="{{displayValue}}" ng-show="!editing && displayValue != \'\'" class="qv-inline-edit-value">{{displayValue}}</div>\n<input qva-direction x-dir-setting="{{dirSetting}}" x-dir-text="{{displayValue}}" ng-show="editing" class="qv-inline-edit-input" type="text" ng-model="titleValue" qv-inline-title-input maxlength="255"/>\n'}),define("objects/inline-title-edit",["qvangular","angular","translator","core.models/rpc-base","client.utils/property-resolver","text!./inline-title-edit.ng.html"],function(a,b,c,d,e,f){"use strict";function g(a){return"object"==typeof a&&(a=a.qStringExpression.qExpr,"="!==a[0]&&(a="="+a)),a}function h(a){return a&&0===a.indexOf("=")?{qStringExpression:{qExpr:a}}:a}a.directive("qvInlineTitleInput",[function(){return{priority:1,require:"ngModel",link:function(b,c,d,e){c.unbind("input keydown change compositionend"),c.bind("blur",function(){a.$apply(b,function(){e.$setViewValue(c.val()),b.doEdit()})}),b.$on("$destroy",function(){c.trigger("blur")}),c.bind("keydown",function(a){a.stopPropagation(),27===a.which?(c.val(e.$viewValue),c.trigger("blur")):13===a.which&&"textarea"!==c[0].nodeName.toLowerCase()&&c.trigger("blur")})}}}]),a.directive("qvInlineTitleEdit",["$timeout",function(a){return{template:f,restrict:"A",scope:{model:"=",propertyPath:"@",layoutPath:"@",emptyTranslation:"@",dirSetting:"@"},priority:1,link:function(f,i){var j=i.children().first(),k=i.children().eq(1),l=i.children().eq(2);f.editing=!1,f.titleProperty="",f.titleValue="",f.addTranslation=c.get(f.emptyTranslation),d.bindLayout(f,"model",function(a){f.displayValue=e.getValue(a,f.layoutPath),f.editing=!1}),f.doEdit=function(){var a=h(f.titleValue);f.editing&&(b.equals(m,a)?f.editing=!1:f.model.getProperties().then(function(b){e.setValue(b,f.propertyPath,a),f.model.setProperties(b),m=a}))};var m;j.add(k).on("qv-activate",function(){f.editing||f.model.getProperties().then(function(b){var c,d=l.get(0);f.editing=!0,f.titleProperty=e.getValue(b,f.propertyPath),f.titleValue=g(f.titleProperty),m=f.titleProperty,d.scrollLeft=d.scrollWidth,c=g(f.titleProperty).length,d.selectionStart=c,d.selectionEnd=c,a(function(){d.focus(),d.setSelectionRange(c,c)})})})}}}])}),define("objects.extension/extension-type",["core.utils/class","client.utils/property-mapper","objects.extension/default-extension","util","qvangular","core.utils/deferred","objects.extension/default-view","objects.extension/default-controller","require","objects/inline-title-edit"],function(a,b,c,d,e,f,g,h,i){function j(a,b){var e=d.extend(!0,{},c,b);return e.libraryInfo=a.getLibraryInfo(),e}function k(a){var b,c=a.path;return q[c]||(b=f(),i([c],function(c){e.$rootScope.$apply(function(){b.resolve(j(a,c))})},function(a){b.reject(a)}),q[c]=b.promise),q[c]}function l(a){var b="";switch(a.toLowerCase()){case"listbox":b="Object.Listbox";break;case"barchart":b="Object.BarChart";break;case"boxplot":b="Object.BoxPlot";break;case"combochart":b="Object.ComboChart";break;case"distributionplot":b="Object.DistributionPlot";break;case"filterpane":b="Object.FilterPane";break;case"gauge":b="Object.Gauge";break;case"kpi":b="Object.Kpi";break;case"linechart":b="Object.LineChart";break;case"piechart":b="Object.PieChart";break;case"pivot-table":b="Object.PivotTable";break;case"scatterplot":b="Object.ScatterPlot";break;case"table":b="Object.Table";break;case"treemap":b="Object.Treemap";break;case"text-image":b="Object.TextImage";break;case"sheet":b="Common.Sheet";break;case"objectlibrary":b="Object.ObjectLibrary";break;case"libraryobject":b="Object.LibraryObject";break;case"map":b="Object.Map";break;default:b=""}return b}function m(a){switch(a.toLowerCase()){case"barchart":return"bar-chart-vertical";case"linechart":return"line-chart";case"table":return"table";case"pivot-table":return"pivot-table";case"components":return"components";case"piechart":return"pie-chart";case"filterpane":return"filterpane";case"listbox":return"list";case"gauge":return"gauge-chart";case"kpi":return"kpi";case"scatterplot":return"scatter-chart";case"text-image":return"text-image";case"treemap":return"treemap";case"map":return"map";case"combochart":return"combo-chart";case"boxplot":return"boxplot";case"distributionplot":return"distributionplot";default:return"extension"}}function n(a){return"icon-"+m(a)}function o(a){if(!a)return"icon-puzzle";switch(a.toLowerCase()){case"bar-chart-vertical":return"icon-bar-chart-vertical";case"line-chart":return"icon-line-chart";case"table":return"icon-table";case"pivot-table":return"icon-pivot-table";case"components":return"icon-components";case"pie-chart":return"icon-pie-chart";case"filterpane":return"icon-filterpane";case"list":return"icon-list";case"gauge-chart":return"icon-gauge-chart";case"kpi":return"icon-kpi";case"scatter-chart":return"icon-scatter-chart";case"text-image":return"icon-text-image";case"text":return"icon-titletext";case"map":return"icon-map";case"combo-chart":return"icon-combo-chart";case"boxplot":return"icon-boxplot";case"distributionplot":return"icon-distributionplot";case"widget":return"icon-widget";default:return"icon-puzzle"}}function p(a){var b=0!==a.indexOf("listbox");return{name:a,descriptionKey:"Template.preview.description."+a,translationKey:l(a),template:a,templateIconClassName:n(a),icon:m(a),author:"Qlik",isThirdParty:!1,isLibraryItem:b}}var q={};e.componentDirective("qvaIncludeObject",{model:"=",ext:"=",options:"="});var r={"bar-chart-vertical":"!","line-chart":"%","pie-chart":"&",list:"-",table:"'","pivot-table":"(",filterpane:".","scatter-chart":"+","text-image":"/","gauge-chart":")",kpi:"1",treemap:"»",map:",","combo-chart":"‚",boxplot:"★",distributionplot:"★","":"E"};return a.extend("ExtensionType",{init:function(a){this.type=a.type,this.path=a.path,this.libraryInfo=a.libraryInfo||p(a.type),this.components=a.components||[],this.libraryInfo.templateIconClassName||(this.libraryInfo.templateIconClassName=o(this.libraryInfo.icon))},getLibraryInfo:function(){return this.libraryInfo},getTemplateIconClassName:function(){return this.libraryInfo.templateIconClassName},getIconChar:function(){return r[this.libraryInfo.icon]?r[this.libraryInfo.icon]:"g"},getModelCtor:function(){return k(this).then(function(a){return a.Model})},getInitialProperties:function(a){var c=this;return k(c).then(function(e){var f=d.extend(!0,{qInfo:{qType:c.type},visualization:c.type},e.initialProperties,a);return e.libraryInfo.isThirdParty&&(e.libraryInfo.version&&!f.version&&(f.version=e.libraryInfo.version),f.extensionMeta=d.extend(!0,{},e.libraryInfo)),b.mapProperties(e.definition,f,c.type)}).catch(function(){return{qInfo:{qType:c.type},visualization:c.type}})},load:function(){return k(this).then(function(a){if(a=d.extend(!0,{},a),a.View)for(var b in g)if(g.hasOwnProperty(b)&&(a.View[b],g[b],!1))throw"extension.View property is missing DefaultView "+b;return void 0===a.View&&(a.View=g),void 0===a.controller&&(a.controller=h),a})},getExtensionType:function(){return k(this)}})}),define("general.models/library/extension-list",["core.utils/deferred","qvangular","general.services/content-api/content-api"],function(a,b){"use strict";var c={list:[]},d=null;return c.getList=function(c){function e(a){return b.getService("$contentApi").getExtensions().then(function(b){f.list=[];for(var c in b)b.hasOwnProperty(c)&&f.list.push({id:c,data:b[c]});a.resolve(f.list)},function(){f.list=[],a.resolve(f.list)}),a.promise}var f=this;return null===d?(d=new a,e(d)):c?e(new a):d.promise},c}),define("objects.utils/type-loader",["core.utils/deferred","general.utils/visualizations","objects.extension/extension-type","general.models/library/extension-list","core.utils/feature-flags"],function(a,b,c,d,e){function f(a,b){return b=b||{},b.previewIconURL||"string"==typeof b.preview&&b.preview.match(/\.(?:png|gif|jpe?g|svg)$/)&&(b.previewIconURL="../extensions/"+a+"/"+b.preview),b.icon=b.icon||"extension",b.description=b.description||b.name,b.template=b.template||a,b.isLibraryItem=b.isLibraryItem!==!1,b.isThirdParty=!0,b.name=b.name||b.template||a,b}function g(a){a.data&&"visualization"===a.data.type&&b.registerType(a.id,new c({type:a.id,path:"extensions/"+a.id+"/"+a.id,libraryInfo:f(a.id,a.data)}))}function h(h){return null===i&&(i=new a,b.registerType("listbox",new c({type:"listbox",path:"extensions.qliktech/listbox/listbox"})),b.registerType("filterpane",new c({type:"filterpane",path:"extensions.qliktech/filterpane/filterpane",components:["extensions.qliktech/filterpane/properties/filterpane-data/filterpane-data","extensions.qliktech/filterpane/properties/filterpane-sorting/filterpane-sorting"]})),e.BOXPLOT&&b.registerType("boxplot",new c({type:"boxplot",path:"extensions.qliktech/boxplot/boxplot"})),e.DISTPLOT&&b.registerType("distributionplot",new c({type:"distributionplot",path:"extensions.qliktech/distributionplot/distributionplot"})),b.registerType("gauge",new c({type:"gauge",path:"extensions.qliktech/gauge/gauge"})),b.registerType("kpi",new c({type:"kpi",path:"extensions.qliktech/kpi/kpi"})),b.registerType("table",new c({type:"table",path:"extensions.qliktech/straight-table/straight-table",components:["extensions.qliktech/straight-table/properties/columns/columns"]})),b.registerType("pivot-table",new c({type:"pivot-table",path:"extensions.qliktech/pivot-table/pivot-table",components:["extensions.qliktech/pivot-table/properties/pivot-data/pivot-data"]})),b.registerType("barchart",new c({type:"barchart",path:"extensions.qliktech/barchart/barchart"})),b.registerType("piechart",new c({type:"piechart",path:"extensions.qliktech/piechart/piechart"})),b.registerType("scatterplot",new c({type:"scatterplot",path:"extensions.qliktech/scatterplot/scatterplot"})),b.registerType("linechart",new c({type:"linechart",path:"extensions.qliktech/linechart/linechart"})),b.registerType("combochart",new c({type:"combochart",path:"extensions.qliktech/combochart/combochart"})),b.registerType("treemap",new c({type:"treemap",path:"extensions.qliktech/treemap/treemap"})),b.registerType("map",new c({type:"map",path:"extensions.qliktech/map/map",components:["extensions.qliktech/map/properties/layers"]})),b.registerType("text-image",new c({type:"text-image",path:"extensions.qliktech/text-image/text-image"})),b.registerType("widget",new c({type:"widget",path:"extensions.qliktech/widget/widget",libraryInfo:f("widget",{name:"Widget",icon:"widget",description:"Qlik Sense Widget",isLibraryItem:!1})})),h?i.resolve():d.getList().then(function(a){a.forEach(function(a){g(a)}),i.resolve()})),i.promise}var i=null;return{load:h,isLoaded:function(a){return!!b.getType(a)},registerExtension:g}}),define("client.utils/rtl/direction-directive",["qvangular","client.utils/rtl/rtl-util","client.utils/rtl/direction-service"],function(a,b,c){a.directive("qvaDirection",function(){return{restrict:"A",link:function(a,d,e){function f(){var a,f=e.dirSetting?e.dirSetting:c.direction,g=e.dirText;a=g?b.detectTextDirection(g):f,d.attr("dir",a),"rtl"===a?d.addClass("qv-rtl-text"):d.removeClass("qv-rtl-text"),"rtl"===f?d.addClass("qv-rtl-layout"):d.removeClass("qv-rtl-layout")}f(),e.$observe("dirText",f),e.$observe("dirSetting",f)}}})}),define("apis/qutil",["angular","qvangular","core.utils/deferred","util","translator","core.utils/environment","general.utils/touch-configuration-util","client.utils/property-mapper","objects.utils/type-loader","general.utils/visualizations","general.models/library/extension-list","objects.utils/interaction-states","client.utils/rtl/direction-service","client.utils/rtl/direction-directive","general.services/content-api/content-api"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";function n(){K||(K=!0,f.inClient()||(g.configureTouchSupport(),L||""!==e.localeDetected||e.setup({context:"devhub"})))}function o(a){L=!0,e.setup({context:"devhub",language:a})}function p(a){a?pubsub.publish("/ui/object/resize."+a):pubsub.publish("/resize/end")}function q(a){return k.getList().then(function(b){a&&a(b)})}function r(a,c,d){return b.getService("$contentApi").request({method:c||"GET",url:a,data:d})}function s(a){return a=a||{},{host:a.host||d.hostname,port:a.port?a.port.toString():d.port,isSecure:a.isSecure||d.isSecure,reloadURI:a.reloadURI?a.reloadURI:d.reloadURI,transientApp:!!a.transientApp,prefix:a.prefix||d.basePath.replace("/extensions/","/"),openWithoutData:a.openWithoutData,identity:a.identity,subpath:a.subpath}}function t(a,b,c){var d="extensions/"+a+"/"+a;return define(d,b),i.registerExtension({id:a,data:c||{type:"visualization"}}),d}function u(a){var b="",c="";return a&&a.currentSelections?((a.noInteraction||a.noSelections)&&(c=" style='pointer-events:none;'"),b+='<qv-stage-current-selections class="qvt-selections" app="app"'+c+'></qv-stage-current-selections><div class="qv-global-search-container"'+c+"></div>"):b+='<qv-object model="model" options="options"></qv-object>',b}function v(c,d,e,f){if("string"==typeof c&&(c=document.getElementById(c)),c){var g=c[0]?c[0]:c;g.innerHTML=u(e);var h=a.element(g).scope();if(!h)return;var i=h.$new(!0);i.model=d,i.app=f,i.options=a.copy(e)||{},e&&e.noSelections&&(i.options.selections=!1),e&&e.noInteraction&&(i.options.interactionState=l.STATIC);return b.getService("$compile")(a.element(g).children("qv-object, qv-stage-current-selections"))(i),m.isInit?i.options.direction=m.direction:m.init().then(function(){i.options.direction=m.direction,b.$apply(i)}),b.$apply(i),i}}function w(a){"string"==typeof a?a=document.getElementById(a):a[0]&&(a=a[0]),a.innerHTML=""}function x(a,d,e){var f=new c;return a.waitForOpen.promise.then(function(){var c=a.enigmaModel||a;b.$apply(b.$rootScope,function(){f.resolve(c[d].apply(c,e))})}),f.promise}function y(a,b){a.qInfo=a.qInfo||{},a.qInfo.qType=a.qInfo.qType||b||"mashup",a.qInfo.qId=a.qInfo.qId||"MU"+d.generateId()}function z(a,b){var c={};return y(c,a),"BookmarkList"===a?c.qBookmarkListDef={qType:"bookmark",qData:{title:"/qMetaDef/title",description:"/qMetaDef/description"}}:"SnapshotList"===a?c.qBookmarkListDef={qType:"snapshot",qData:{title:"/title",libraryTitle:"/qMetaDef/title",description:"/qMetaDef/description",sourceObjectId:"/sourceObjectId",visualizationType:"/visualizationType",timestamp:"/timestamp",snapshotData:"/snapshotData",isClone:"/isClone"}}:"CurrentSelections"===a?c.qSelectionObjectDef=b||{}:"DimensionList"===a?c.qDimensionListDef={qType:"dimension",qData:{title:"/qMetaDef/title",tags:"/qMetaDef/tags",grouping:"/qDim/qGrouping",info:"/qDimInfos"}}:"MeasureList"===a?c.qMeasureListDef={qType:"measure",qData:{title:"/qMetaDef/title",tags:"/qMetaDef/tags"}}:"sheet"===a?c.qAppObjectListDef={qType:"sheet",qData:{title:"/qMetaDef/title",description:"/qMetaDef/description",thumbnail:"/thumbnail",cells:"/cells",rank:"/rank",columns:"/columns",rows:"/rows"}}:"masterobject"===a?c.qAppObjectListDef={qType:"masterobject",qData:{name:"/metadata/name",visualization:"/visualization",tags:"/metadata/tags"}}:"VariableList"===a?c.qVariableListDef={qType:"variable",qData:{tags:"/tags"}}:"story"===a?c.qAppObjectListDef={qType:"story",qData:{title:"/qMetaDef/title",description:"/qMetaDef/description",thumbnail:"/thumbnail",rank:"/rank"}}:c["q"+a+"Def"]={},c}function A(a,b,c){if(Array.isArray(a)&&!Array.isArray(b)){var d=b||{},e=[],f=[],g=[];a.forEach(function(a){C(a)?(g.push(-1),f.push(a)):(g.push(e.length),e.push(a))});var h=e.length;return g.forEach(function(a,b){a<0&&(g[b]=h,h++)}),d.columnOrder=g,d.qInterColumnSortOrder=g,A(e,f,d)}var i=c||{};if(a){var j=[];a.forEach(function(a){"string"==typeof a?j.push({qDef:{qFieldDefs:[a]}}):j.push(a)}),i.qDimensions=j}var k=[];return b.forEach(function(a){"string"==typeof a?k.push({qDef:{qDef:a}}):k.push(a)}),i.qMeasures=k,i.qInitialDataFetch=[{qTop:0,qLeft:0,qHeight:20,qWidth:(i.qDimensions?i.qDimensions.length:0)+i.qMeasures.length}],c&&c.rows&&(i.qInitialDataFetch[0].qHeight=c.rows),i}function B(a,b,c){for(var d in b)b.hasOwnProperty(d)&&(b[d]instanceof Object&&!Array.isArray(b[d])?B(a+d+"/",b[d],c):c.push({qPath:a+d,qOp:"add",qValue:"string"==typeof b[d]?'"'+b[d]+'"':JSON.stringify(b[d])}))}function C(a){return"string"==typeof a?0===a.indexOf("="):a.qType?"measure"===a.qType:!!(a.qDef&&a.qDef.qDef||a.qSortBy||a.qAttributeExpressions)}function D(a){a.qDef=a.qDef||{},a.qDef.cId=d.generateId()}function E(a,b){var c=d.extend(!0,{},b);return"string"==typeof a?(c.qDef=c.qDef||{},c.qDef.qDef=a):c=d.extend(!0,c,a),c.qSortBy=c.qSortBy||{qSortByLoadOrder:1,qSortByNumeric:-1},D(c),c}function F(a,b){var c=d.extend(!0,{},b);return"string"==typeof a?(c.qDef=c.qDef||{},c.qDef.qFieldDefs=[a]):c=d.extend(!0,c,a),c.qSortCriterias=c.qSortCriterias||[{qSortByAscii:1,qSortByLoadOrder:1}],D(c),c}function G(a,b,c){return(a=a?a+", ":"")+e.get(b,JSON.stringify(c))}function H(a){if(!Array.isArray(a))return e.get("Devhub.Cols.Array");var b;return a.forEach(function(a){"object"==typeof a?a.qType?"measure"!==a.qType&&"dimension"!==a.qType?b=G(b,"Devhub.Cols.InvalidQtype",a):a.qLibraryId||(b=G(b,"Devhub.Cols.QlibraryIdMissing",a)):a.qDef?a.qDef.qDef?"string"!=typeof a.qDef.qDef&&(b=G(b,"Devhub.Cols.QdefString",a)):a.qDef.qFieldDefs?Array.isArray(a.qDef.qFieldDefs)||(b=G(b,"Devhub.Cols.QfielddefArray",a)):b=G(b,"Devhub.Cols.QdefOrQfielddefs",a):b=G(b,"Devhub.Cols.QdefOrQlibraryid",a):"string"!=typeof a&&(b=G(b,"Devhub.Cols.InvalidType",a))}),b}function I(a,b,c,d){if(a.qHyperCubeDef){var e=[];b.forEach(function(b){C(b)?(e.push(-1),a.qHyperCubeDef.qMeasures.push(E(b,d))):(e.push(a.qHyperCubeDef.qDimensions.length),a.qHyperCubeDef.qDimensions.push(F(b,c)))});var f=a.qHyperCubeDef.qDimensions.length;e.forEach(function(a,b){a<0&&(e[b]=f,f++)}),a.qHyperCubeDef.columnOrder=e,a.qHyperCubeDef.qInterColumnSortOrder=e}else a.qListObjectDef&&b.forEach(function(b,c){0===c?(a.qListObjectDef.qDef||(a.qListObjectDef.qDef={}),a.qListObjectDef.qDef.qFieldDefs=[b]):(a.qListObjectDef.qExpressions||(a.qListObjectDef.qExpressions=[]),a.qListObjectDef.qExpressions.push(E(b,d)))})}function J(a,b,f){var g=j.getType(a);return g?g.getInitialProperties({}).then(function(a){if(f&&d.extend(!0,a,f),b){var e=H(b);return e?c.reject(e):g.getExtensionType().then(function(c){var d,e;return c.mapProperties(),a.qHyperCubeDef?(d=h.mapProperties(h.findDefinition(c.mappedDefinition,"qHyperCubeDef.qMeasures",!0)),e=h.mapProperties(h.findDefinition(c.mappedDefinition,"qHyperCubeDef.qDimensions",!0))):a.qListObjectDef&&(e=h.mapProperties(h.findDefinition(c.mappedDefinition,"qListObjectDef",!0))),I(a,b,e,d),a})}return a}):c.reject(e.get("Devhub.Visualization.InvalidType",a))}var K=!1,L=!1,M={createVisualizationHtml:u,showVisualization:v,clearElement:w,appDoIt:x,setDefaultId:y,getDefaultListParam:z,createHypercubeDef:A,makeConfig:s,inClient:f.inClient,initClient:n,registerExtension:t,addPatches:B,isMeasure:C,makeMeasure:E,makeDimension:F,addColumns:I,validateColumns:H,createDefinition:J,setLanguage:o,resize:p,getExtensionList:q,callRepository:r};return Object.defineProperty(M,"Promise",{get:function(){return c.Promise}}),M}),define("client.controllers/warning-handler-controller",["jquery","qvangular","autogenerated/qix/engine-enums","core.utils/external-urls","text!general.controllers/expire-dialog.ng.html","general.services/delayed-modal/delayed-modal"],function(a,b,c,d,e){"use strict";function f(){b.getService("$delayedModal").scope.$on("delayed-modal-closed",function(){n.length&&b.getService("$timeout")(function(){i(n.shift())})})}function g(a,b){for(var c=-1,d=0;d<a.length;d++)if(a[d].code===b){c=d;break}return c}function h(a,b){if(b.shown){var c=g(a,b.code);c!==-1&&a.splice(c,1)}else g(a,b.code)!==-1&&(b.shown=!0,b.interval?localStorage.setItem(b.label,Date.now()+b.interval):sessionStorage.setItem(b.label,!0))}function i(c){var g={};k.ready.then(function(){if(g=a.extend(!0,{},c,{title:"WarningDialog.Title",content:void 0!==c.code?"WarningCode."+c.code:c.message,buttons:m,showDefaultButton:!1}),void 0!==c.code&&c.code===l.LOCWARN_PERSONAL_VERSION_EXPIRES_SOON){var h=k.get("Info.QlikSenseDesktop.Upgrade.Expiring",["<a href='"+d.personalUpgradeUrl+"' target='_blank'>"+d.personalUpgradeBase+"</a>"]);g.html=e.replace("<upgrade-msg/>",h),g.title="Info.QlikSenseDesktop.Upgrade.Expiring.Title"}b.getService("$delayedModal").open(g),f()}),document.activeElement&&a(document.activeElement).blur()}function j(c,d){var e=a.extend(!0,[],c);k||(k=d),h(e,o),h(e,p),e.length>0&&(n.push.apply(n,e),b.getService("$delayedModal").isOpened?f():i(n.shift()))}var k,l=c.NxLocalizedWarningCode,m=[{name:"Common.Close",defaultEscButton:!0,defaultButton:!0}],n=[],o={code:l.LOCWARN_PERSONAL_VERSION_EXPIRES_SOON,label:"ExpireWarningShown",shown:Date.now()<parseInt(localStorage.ExpireWarningShown,10),interval:864e5},p={code:l.LOCWARN_PERSONAL_RELOAD_REQUIRED,label:"HiddenScriptWarningShown",shown:sessionStorage.HiddenScriptWarningShown};return{showDialog:j}}),define("client.models/rpc-session",["core.models/rpc-session","core.utils/websocket","core.utils/authentication","core.utils/debug-flags","translator","general.controllers/error-handler-controller","client.controllers/warning-handler-controller","qvangular"],function(a,b,c,d,e,f,g,h){function i(a){var b=["OnLicenseAccessDenied","OnLicenseAccessDeniedPendingUserSync","OnSessionClosed","OnNoAppFound","OnEngineWebsocketFailed","OnNoEngineAvailable","OnSessionTimedOut","OnSessionClosed","OnNoDataPrepServiceAvailable","OnDataPrepServiceWebsocketFailed"];"OnSessionLoggedOut"===a.method?f.showDialog(a.method):"OnEngineWebsocketFailed"===a.method?f.showDialog({method:a.method,message:"ProxyError."+a.method}):b.indexOf(a.method)>-1?f.showDialog({message:"ProxyError."+a.method,refreshButton:!0}):"OnAuthenticationInformation"===a.method&&c.parse(a.params)}function j(a){var b="method"in a?"SENT":"RECV";window.console.info("[DBGFLG:SOCKET]",b,":",a)}function k(a){var b=[];if(!this.reqCache[a.id]||"ExportData"!==this.reqCache[a.id].method){for(var c=0;c<a.warnings.length;c++)b.push({code:a.warnings[c]});g.showDialog(b,e)}}var l,m=[];return a.createSocket=function(a){var c;try{c=new b(a)}catch(a){f.showDialog({message:"ErrorDialog.NoConnectionCreated"})}return c},a.debounceApply=function(a){clearTimeout(l),m.push(a),l=setTimeout(function(){h.$apply(h.$rootScope,function(){for(var a=0;a<m.length;a++)try{m[a]()}catch(a){}m.length=0})})},a.NewSessionCreated.bind(function(a){a.Notification.bind(i),a.Warning.bind(k),d.SOCKET&&(a.Data.bind(j),a.Error.bind(j),a.Send.bind(j))}),a}),define("apis/qglobal",["qvangular","core.models/app","autogenerated/qix/engine-enums","client.models/rpc-session","apis/qutil"],function(a,b,c,d,e){"use strict";function f(a,b,c,d){return a.session.rpc({method:b,handle:-1,params:c||[]}).then(function(a){return d&&d(a.result),a.result})}function g(c,d,e){a.$apply(a.$rootScope,function(){b.getList(c).then(function(a){e&&c.close(),d(a)},function(){i&&i({code:j.LOCERR_GENERIC_CONNECTION_LOST,message:"ErrorCode."+j.LOCERR_GENERIC_CONNECTION_LOST})})})}function h(a){a.rpc?this.session=a:(this.session=d.get("?transient=",a),this.session.open())}var i,j=c.NxLocalizedErrorCode;return h.setErrorCallback=function(a){i=a},h.get=function(a){return new h(e.makeConfig(a))},h.getAppList=function(a,b){var c=d.get("?transient=",e.makeConfig(b));c.open(),g(c,a,!0)},h.prototype.getAppList=function(a){g(this.session,a,!1)},h.prototype.getAuthenticatedUser=function(a){return f(this,"GetAuthenticatedUser",[],a)},h.prototype.isPersonalMode=function(a){return f(this,"IsPersonalMode",[],a)},h.prototype.getQTProduct=function(a){return f(this,"QTProduct",[],a)},h.prototype.getProductVersion=function(a){return f(this,"ProductVersion",[],a)},h.prototype.getQvVersion=function(a){return this.getProductVersion(a)},h.prototype.cancelReload=function(){return f(this,"CancelReload")},h.prototype.getProgress=function(a,b){return f(this,"GetProgress",[a],b)},h.prototype.GetProgress=function(a,b){return this.getProgress(a,b)},h}),define("client.models/current-selections",["core.models/session-object","core.models/app"],function(a,b){"use strict";function c(a,b,c){a.enigmaModel.getField(b).then(function(a){a[c]()})}var d;return d=a.extend("CurrentSelections",{clearField:function(a){c(this.app,a,"clear")},lockField:function(a){c(this.app,a,"lock")},unlockField:function(a){c(this.app,a,"unlock")},clearAll:function(){return this.app.rpc("ClearAll",null)},back:function(){return this.app.rpc("Back",null)},forward:function(){return this.app.rpc("Forward",null)}}),d.get=function(c){return c=c||b.current,a.get.call(this,{qInfo:{qType:"CurrentSelection"},qSelectionObjectDef:{}},c).then(function(a){return a.app=c,a})},d}),define("client.models/snapshot",["client.models/bookmark","core.utils/deferred"],function(a,b){"use strict";var c;return c=a.extend("Snapshot",{applyEmbeddedSnapshot:function(){return this.rpc("Apply")}},{listProperties:{qBookmarkListDef:{qType:"snapshot",qData:{title:"/title",libraryTitle:"/qMetaDef/title",description:"/qMetaDef/description",sourceObjectId:"/sourceObjectId",visualizationType:"/visualizationType",timestamp:"/timestamp",snapshotData:"/snapshotData",isClone:"/isClone"}}}}),c.getLibraryContent=function(a,c){var d,e=new b;return this.getList().then(function(b){b.getLayout().then(function(b){d=b.filter(function(b){var c=!0;return a&&(c=a===b.qData.sourceObjectId),!b.qData.isClone&&c}),e.resolve(d)}),b.Invalidated&&b.Invalidated.unbind(),b.Invalidated.bind(c)}),e.promise},c.unbindList=function(){this.getList().then(function(a){
a.Invalidated.unbind()})},c.getSnapshotCount=function(a){var c,d=new b,e=0;return this.getListLayout().then(function(b){for(c=0;c<b.length;c++)b[c].qData.isClone||b[c].qData.sourceObjectId!==a||e++;d.resolve(e)}),d.promise},c.create=function(d,e){var f,g,h=new b,i=0;return this.getListLayout().then(function(b){for(f=0;f<b.length;f++)b[f].qData.isClone||i++;g=i<500,g?a.create.call(c,d,e).then(function(a){h.resolve({limit:g,id:a.id})}):h.resolve(g)}),h.promise},c.getEmbedded=function(a){var c=this;return a.enigmaModel.getSnapshotObject().then(function(d){return c.getModel(d.id,a.session,function(){return b.resolve(d)})})},{Snapshot:c}}),define("objects.backend-api/snapshot-api",["./backend-api","core.utils/deferred","objects.backend-api/cube-slicer","objects.backend-api/pivot-cube-slicer"],function(a,b,c,d){"use strict";function e(a,b,c,d){if(a){b.snapshotData.object.origDataPages||(b.snapshotData.object.origDataPages=b.qHyperCube[d]);for(var e=0;e<c.length;e++)c[e].qHeight=Math.min(b.qHyperCube.qSize.qcy,c[e].qHeight),c[e].qTop=b.snapshotData.object.origDataPages[e].qArea.qTop;b.qHyperCube[d]=a.get(c)}}function f(a){if("pivot-table"===a.visualization)this.responseProperty="qPivotDataPages",this.slicer=new d;else{if("table"!==a.visualization)return;this.slicer=new c}a.snapshotData.object.origDataPages?this.slicer.store(a.snapshotData.object.origDataPages):this.slicer.store(a.qHyperCube[this.responseProperty])}return a.extend("SnapshotAPI",{init:function(a){this.responseProperty="qDataPages",f.call(this,a.layout),this._super(a,a.layout.qListObject?"/qListObjectDef":"/qHyperCubeDef")},getData:function(a){var c=b();if("map"===this.model.layout.visualization){var d=this.dataPath.split("/")[1],f=this.dataPath.split("/"),g=f[f.length-1];"polygon"===this.model.layout.layers[d].type&&"3"===this.model.layout.layers[d].version?c.resolve(this.model.layout.layers[d].geodata.qHyperCube[this.responseProperty]):c.resolve(this.model.layout.layers[d][g][this.responseProperty])}else e(this.slicer,this.model.layout,a,this.responseProperty),c.resolve(this.model.layout[this.dataPath][this.responseProperty]);return c.promise},getHyperCubeBinnedData:function(){return b.resolve(this.model.layout.dataPages)},getHyperCubeContinousData:function(){return b.resolve({qDataPages:this.model.layout.qHyperCube.qDataPages,qAxisData:this.model.layout.qHyperCube.qAxisData})},getSize:function(){return this.model.layout[this.dataPath].qSize},beginSelections:function(){},endSelections:function(){},clearSelections:function(){},isSnapshot:!0})}),define("apis/qfieldvalue",[],function(){"use strict";function a(a,b){Object.defineProperties(this,{qText:{value:a.qText},qElemNumber:{value:a.qElemNumber},qState:{value:a.qState},field:{value:b}}),isNaN(a.qNum)||Object.defineProperties(this,{qNum:{value:a.qNum}}),a.qFrequency&&Object.defineProperties(this,{qFrequency:{value:a.qFrequency}})}return a.prototype.select=function(a,b){return this.field.select([this.qElemNumber],a||!1,b||!1)},a}),define("apis/qfield",["core.utils/deferred","core.utils/notification","apis/qfieldvalue"],function(a,b,c){"use strict";function d(b,c,d,e,f,g,h){return b.waitFor?b.waitFor.then(function(){return b.field[c].apply(b.field,[d,e,f,g,h].filter(function(a){return void 0!==a}))}):a.resolve()}function e(c,d,e){var f=this;if(f.qapp=c,f.fldname=d,f.rows=[],f.qapp.model.session){b.create(f,"OnData");var g=new a;f.waitFor=g.promise,f.qapp.model.waitForOpen.promise.then(function(){(c.model.enigmaModel||c.model).getField(d,e||"$").then(function(a){f.field=a,g.resolve()})})}}return e.prototype.clear=function(){return d(this,"clear")},e.prototype.lock=function(){return d(this,"lock")},e.prototype.unlock=function(){return d(this,"unlock")},e.prototype.clearOther=function(a){return d(this,"clearAllButThis",a||!1)},e.prototype.selectAll=function(a){return d(this,"selectAll",a||!1)},e.prototype.selectExcluded=function(a){return d(this,"selectExcluded",a||!1)},e.prototype.selectAlternative=function(a){return d(this,"selectAlternative",a||!1)},e.prototype.selectPossible=function(a){return d(this,"selectPossible",a||!1)},e.prototype.toggleSelect=function(a,b){return d(this,"toggleSelect",a,b||!1)},e.prototype.selectMatch=function(a,b){return d(this,"select",a,b||!1)},e.prototype.select=function(a,b,c){return d(this,"lowLevelSelect",a,b||!1,c||!1)},e.prototype.selectValues=function(a,b,c){var e=[];return a.forEach(function(a){"number"==typeof a?e.push({qIsNumeric:!0,qNumber:a}):"string"==typeof a?e.push({qText:a}):e.push(a)}),d(this,"selectValues",e,b||!1,c||!1)},e.prototype.getData=function(a){if(this.requestActive)return this;this.requestActive=!0,this.genericObject&&(this.genericObject.close(),delete this.genericObject);var b=this;return this.qapp.createGenericObject({qListObjectDef:{qDef:{qFieldDefs:[this.fldname]},qFrequencyMode:a&&a.freq||"V",qInitialDataFetch:[{qTop:0,qLeft:0,qHeight:a&&a.rows||200,qWidth:1}]}},function(a){b.rows.length=0,a.qListObject.qDataPages.forEach(function(a){a.qMatrix.forEach(function(a){b.rows.push(new c(a[0],b))})}),b.rowCount=a.qListObject.qDimensionInfo.qCardinal,b.stateCounts=a.qListObject.qDimensionInfo.qStateCounts,b.requestActive=!1,b.OnData.emit()}).then(function(a){b.genericObject=a}),this},e.prototype.getMoreData=function(){if(this.requestActive)return this;if(this.rowCount<=this.rows.length)return this;this.requestActive=!0;var a=this,b={qTop:this.rows.length,qLeft:0,qWidth:1,qHeight:50};return a.genericObject.getListObjectData("/qListObjectDef",[b]).then(function(b){b.qDataPages[0].qMatrix.forEach(function(b){a.rows.push(new c(b[0],a))}),a.requestActive=!1,a.OnData.emit()}),this},e}),define("apis/qbookmark",["client.models/bookmark","client.models/current-selections"],function(a,b){"use strict";function c(a){this.app=a}return c.prototype.create=function(c,d,e){var f=this;return f.app.waitForOpen.promise.then(function(){return b.get(f.app).then(function(b){return b.getLayout().then(function(){var g,h=b.layout.qSelectionObject?b.layout.qSelectionObject.qSelections:null,i={currentSelectFields:[],currentSelectCount:0};if(h&&h.length>0)for(i.currentSelectCount=h.length,g=0;g<h.length;g++)i.currentSelectFields.push(h[g].qField);var j="";for(g=0;g<i.currentSelectCount;g++)g>0&&(j+=", "),j+=i.currentSelectFields[g];var k={qMetaDef:{title:c,description:d},selectionFields:j};return e&&(k.sheetId=e),a.create(k,f.app)})})})},c.prototype.apply=function(b){return a.apply(b,this.app)},c.prototype.remove=function(b){return a.remove(b,this.app)},c}),define("apis/qvariable",[],function(){"use strict";function a(a){return a.waitForOpen.promise.then(function(){return a.enigmaModel})}function b(a,b){this.app=a,this.qapp=b}function c(a){var b="string"==typeof a?{qName:a}:a;return b.qInfo=b.qInfo||{},b.qInfo.qType=b.qInfo.qType||"variable",b}return b.prototype.create=function(b){var d=c(b);return a(this.app).then(function(a){return a.createVariableEx(d)})},b.prototype.createSessionVariable=function(b){var d=c(b);return a(this.app).then(function(a){return a.createSessionVariable(d)})},b.prototype.get=function(b){return a(this.app).then(function(a){return a.getVariableById(b)})},b.prototype.getByName=function(b){return a(this.app).then(function(a){return a.getVariableByName(b)})},b.prototype.setStringValue=function(b,c){return a(this.app).then(function(a){return a.getVariableByName(b)}).then(function(a){return a.setStringValue(c).then(function(){return a.getLayout()})})},b.prototype.setNumValue=function(b,c){return a(this.app).then(function(a){return a.getVariableByName(b)}).then(function(a){return a.setNumValue(c).then(function(){return a.getLayout()})})},b.prototype.setContent=function(a,b){return this.setStringValue(a,b+"")},b.prototype.getContent=function(a,b){var c=this.qapp,d=b?function(a){b(a,c)}:function(){};return this.getByName(a).then(function(a){return a?a.getLayout().then(function(a){var b={qContent:{qString:a.qText,qIsNum:!isNaN(a.qNum)}};return d(b,c),b}):a})},b}),define("objects.error-handling/error-translation",["autogenerated/qix/engine-enums","translator"],function(a,b){"use strict";function c(a){return"ErrorCode."+a}var d=a.NxLocalizedErrorCode;return{getDimensionError:function(a){var e;return e=a===d.LOCERR_CALC_INVALID_DEF?"Object.ErrorMessage.InvalidDimension":a===d.LOCERR_CALC_NOT_IN_LIB?"Object.ErrorMessage.MissingDimension":c(a),b.get(e)},getMeasureError:function(a){var e;return e=a===d.LOCERR_CALC_INVALID_DEF?"Object.ErrorMessage.InvalidMeasure":a===d.LOCERR_CALC_NOT_IN_LIB?"Object.ErrorMessage.MissingMeasure":c(a),b.get(e)},getHyperCubeError:function(a){var d=c(a);return b.get(d)},getListObjectError:function(a){var d=c(a);return b.get(d)}}}),define("apis/qtable",["core.utils/notification","objects.error-handling/error-translation","apis/qutil"],function(a,b,c){"use strict";function d(a,c,d){Object.defineProperties(this,{qFallbackTitle:{value:a.qFallbackTitle},qSortIndicator:{value:a.qSortIndicator},qReverseSort:{value:a.qReverseSort||!1},col:{value:c},isOrderedBy:{value:c===d.qHyperCube.qEffectiveInterColumnSortOrder[0]},isDimension:{value:c<d.qHyperCube.qDimensionInfo.length},selections:{value:[]},parent:{value:d}}),this.isDimension?Object.defineProperties(this,{qCardinal:{value:a.qCardinal},qStateCounts:{value:a.qStateCounts},qDimensionInfo:{value:a}}):Object.defineProperties(this,{qMax:{value:a.qMax},qMin:{value:a.qMin},qMeasureInfo:{value:a}}),a.qGroupFieldDefs&&a.qGroupFieldDefs.length>0&&Object.defineProperties(this,{field:{value:d.app.field(a.qGroupFieldDefs[a.qGroupPos])}}),a.qError&&Object.defineProperties(this,{errorCode:{value:a.qError.qErrorCode},errorMessage:{value:this.isDimension?b.getDimensionError(a.qError.qErrorCode):b.getMeasureError(a.qError.qErrorCode)}})}function e(a,b,c,d){Object.defineProperties(this,{qDimensionInfo:{value:b},qText:{value:a.qIsOtherCell?b.othersLabel:a.qText},qElemNumber:{value:a.qElemNumber},qState:{value:a.qState},col:{value:c},selected:{get:function(){return this.header.isSelected(this.qElemNumber)}},header:{get:function(){return this.parent.headers[this.col]}},parent:{value:d}}),isNaN(a.qNum)||Object.defineProperties(this,{qNum:{value:a.qNum}})}function f(a,b,c){Object.defineProperties(this,{qMeasureInfo:{value:b},qGrandTotal:{value:c},qText:{value:a.qText}}),isNaN(a.qNum)||Object.defineProperties(this,{qNum:{value:a.qNum}})}function g(a,b,c){var d=[],g=[],h=[],i=b.qDimensionInfo.length,j=b.columnOrder;a.forEach(function(a,h){h<i?d.push(new e(a,b.qDimensionInfo[h],h,c)):g.push(new f(a,b.qMeasureInfo[h-i],b.qGrandTotalRow[h-i]))}),j?j.forEach(function(a){h.push(a<i?d[a]:g[a-i])}):h=d.concat(g),Object.defineProperties(this,{dimensions:{value:d},measures:{value:g},cells:{value:h}})}function h(b,c,d){if(a.create(this,"OnData"),Object.defineProperties(this,{app:{value:b},path:{value:d||"qHyperCube"},defPath:{get:function(){return this.path+"Def"}},rows:{value:[]},headers:{value:[]},totals:{value:[]},rowCount:{get:function(){if(this.qHyperCube&&this.qHyperCube.qSize)return this.qHyperCube.qSize.qcy}},colCount:{get:function(){if(this.qHyperCube&&this.qHyperCube.qSize)return this.qHyperCube.qSize.qcx}}}),"function"==typeof c.then){var e=this;c.then(function(a){i(e,a)})}else{i(this,c.backendApi?c.backendApi.model:c,c.backendApi?c:void 0)}}function i(a,b,c){Object.defineProperties(a,{model:{value:b},view:{value:c}}),j(a),a.model&&a.model.Validated&&(a._OnModelValid=function(){j(a)},a.model.Validated.bind(a._OnModelValid))}function j(a){if(!a.qHyperCube&&a.model.layout&&(a.qHyperCube=a.model.layout[a.path]),!(a.model&&a.model.layout&&a.model.layout.qSelectionInfo&&a.model.layout.qSelectionInfo.qInSelections)){if(a.headers.length=0,a.totals.length=0,a.rows.length=0,a.qHyperCube){var b=a.qHyperCube.qDimensionInfo?a.qHyperCube.qDimensionInfo.length:0,c=a.qHyperCube.columnOrder;a.qHyperCube.qDimensionInfo&&a.qHyperCube.qDimensionInfo.forEach(function(b,e){if(c){var f=c.indexOf(e);a.headers[f]=new d(b,e,a)}else a.headers.push(new d(b,e,a))}),a.qHyperCube.qMeasureInfo&&a.qHyperCube.qMeasureInfo.forEach(function(e,f){if(c){var g=c.indexOf(f+b);a.headers[g]=new d(e,f+b,a)}else a.headers.push(new d(e,f+b,a))}),a.qHyperCube.qGrandTotalRow&&a.qHyperCube.qGrandTotalRow.forEach(function(b,c){a.totals.push(new f(b,a.qHyperCube.qMeasureInfo[c]))}),k(a,a.qHyperCube.qDataPages)}a.OnData.emit()}}function k(a,b){b&&b.forEach(function(b){b.qMatrix.forEach(function(b){a.rows.push(new g(b,a.qHyperCube,a))})})}return d.prototype.orderBy=function(){var a=[this.col];this.parent.qHyperCube.qEffectiveInterColumnSortOrder.forEach(function(b){b!==a[0]&&a.push(b)});var b=[{qPath:"/"+this.parent.defPath+"/qInterColumnSortOrder",qOp:"replace",qValue:"["+a.join(",")+"]"}];return this.parent.model.applyPatches(b,!0)},d.prototype.reverseOrder=function(){var a=this.col<this.parent.qHyperCube.qDimensionInfo.length,b=[{qPath:"/"+this.parent.defPath+(a?"/qDimensions/"+this.col:"/qMeasures/"+(this.col-this.parent.qHyperCube.qDimensionInfo.length))+"/qDef/qReverseSort",qOp:"replace",qValue:(!this.qReverseSort).toString()}];return this.parent.model.applyPatches(b,!0)},d.prototype.isSelected=function(a){return this.selections.indexOf(a)>-1},d.prototype.toggleSelect=function(a){var b=this.selections.indexOf(a);b<0?this.selections.push(a):this.selections.splice(b,1)},d.prototype.selectRange=function(a,b,c,d){var e={qMeasureIx:this.col-this.parent.qHyperCube.qDimensionInfo.length,qRange:{qMin:a,qMax:b,qMinInclEq:c,qMaxInclEq:d}};return this.parent.model.rangeSelectHyperCubeValues("/"+this.parent.defPath,[e],[],!1)},e.prototype.select=function(){return this.header.toggleSelect(this.qElemNumber),this.parent.view&&this.parent.view.selectValues?this.parent.view.selectValues(this.col,[this.qElemNumber],!0):this.parent.model.selectHyperCubeValues("/"+this.parent.defPath,this.col,[this.qElemNumber],!0)},f.prototype.getPercentOfMax=function(){return Math.round(100*this.qNum/this.qMeasureInfo.qMax*100)/100},f.prototype.getPercent=function(){return Math.round(100*this.qNum/this.qGrandTotal.qNum*100)/100},h.prototype.getMoreData=function(){if(!(this.requestActive||this.rowCount<=this.rows.length)){this.requestActive=!0;var a=this,b={qTop:this.rows.length,qLeft:0,qWidth:this.colCount,qHeight:50};return a.view?a.view.backendApi.getData([b]).then(function(b){k(a,b),a.requestActive=!1,a.OnData.emit()}):a.model.getData([b]).then(function(b){k(a,b),a.requestActive=!1,a.OnData.emit()})}},h.prototype.getColByName=function(a){if(a){var b,c=a.toUpperCase();return this.headers.forEach(function(a,d){a.qFallbackTitle.toUpperCase()===c&&(b=d)}),b}},h.prototype.exportData=function(a,b){return a=a||{},this.model.exportData(a.format||"OOXML","/"+this.defPath,a.filename,a.state||"P").then(function(d){var e=this.app.global,f=e&&e.session.options;f=c.makeConfig(f);var g=f.prefix+d.result.qUrl.substring(1);a.download&&window.open(g),b&&b(g)}.bind(this))},h.prototype.destroy=function(){this.model&&this.model.Validated&&this._OnModelValid&&(this.model.Validated.unbind(this._OnModelValid),delete this._OnModelValid)},h}),define("apis/qvisualization",["objects.utils/type-loader","apis/qtable","apis/qutil"],function(a,b,c){"use strict";function d(a){this.qapp=a}function e(a,c){Object.defineProperties(this,{id:{value:c.id},qapp:{value:a},model:{value:c}}),c.layout.qHyperCube&&Object.defineProperties(this,{table:{value:new b(this.qapp,c),configurable:!0}})}return d.prototype.get=function(a){var b=this;return b.qapp.getObject(a).then(function(a){return new e(b.qapp,a)})},d.prototype.create=function(b,d,f){var g=this;return a.load().then(function(){return c.createDefinition(b,d,f).then(function(a){return g.qapp.createGenericObject(a).then(function(a){return new e(g.qapp,a)})})})},e.prototype.setOptions=function(a){var b=[];return c.addPatches("/",a,b),this.model.applyPatches(b,!0)},e.prototype.show=function(a,b){var d=c.showVisualization(a,this.model.enigmaModel,b);return this._scopes=this._scopes||[],this._scopes.push(d),this._elements=this._elements||[],this._elements.push(a),d},e.prototype.close=function(){return this._scopes&&(this._scopes.forEach(function(a){a.$destroy()}),delete this._scopes),this._elements&&(this._elements.forEach(function(a){c.clearElement(a)}),delete this._elements),this.table&&(this.table.destroy(),delete this.table),this.model.close()},e.prototype.resize=function(){c.resize(this.id)},d}),define("apis/qselection-state",["core.utils/notification"],function(a){"use strict";function b(a,b){Object.defineProperties(this,{fieldName:{value:a.qField},field:{get:function(){return d(this.parent,this.fieldName)}},qSortIndex:{value:a.qSortIndex},locked:{value:a.qLocked||!1},isNumeric:{value:a.qIsNum||!1},totalCount:{value:a.qTotal},selectedCount:{value:a.qSelectedCount},qStateCounts:{value:a.qStateCounts},qSelected:{value:a.qSelected},selectedValues:{value:a.qSelectedFieldSelectionInfo},notSelectedValues:{value:a.qNotSelectedFieldSelectionInfo},qSelectionThreshold:{value:a.qSelectionThreshold},qTextSearch:{value:a.qTextSearch},qRangeInfo:{value:a.qRangeInfo},parent:{value:b}})}function c(b,c,d){a.create(this,"OnData"),Object.defineProperties(this,{qapp:{value:b},selections:{value:[]},stateName:{value:d||"$"}});var f=this;c.then(function(a){e(f,a),a.Validated.bind(function(){e(f,a)})})}function d(a,b){return a.qapp.field(b,a.stateName)}function e(a,c){a.selections.length=0,c.layout.qSelectionObject&&(void 0===a.backCount&&Object.defineProperties(a,{backCount:{get:function(){return c.layout.qSelectionObject.qBackCount||0}},forwardCount:{get:function(){return c.layout.qSelectionObject.qForwardCount||0}}}),c.layout.qSelectionObject.qSelections.forEach(function(c){a.selections.push(new b(c,a))}),a.OnData.emit())}return c.prototype.clearAll=function(a){return this.qapp.clearAll(a,this.stateName)},c.prototype.lockAll=function(){return this.qapp.lockAll(this.stateName)},c.prototype.unlockAll=function(){return this.qapp.unlockAll(this.stateName)},c}),define("apis/qapp",["core.utils/deferred","core.models/app","autogenerated/qix/engine-enums","core.models/session-object","core.models/generic-object","client.models/current-selections","client.models/snapshot","objects.backend-api/snapshot-api","apis/qfield","apis/qbookmark","apis/qvariable","apis/qglobal","apis/qtable","apis/qutil","apis/qvisualization","apis/qselection-state"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){"use strict";function q(a){this.fieldCache={},this.stateCache={},Object.defineProperties(this,{id:{value:a.id},model:{value:a}}),a.session&&Object.defineProperties(this,{global:{value:new l(a.session)},bookmark:{value:new j(a)},variable:{value:new k(a,this)},visualization:{value:new o(this)}}),this.getAppLayout()}function r(b,c){var d=c||new a;return b.getLayout().then(function(){d.resolve(b)},function(a){d.reject(a)}),d.promise}var s,t,u=c.NxLocalizedErrorCode,v={};return q.prototype.clearAll=function(a,b){return n.appDoIt(this.model,"clearAll",[a||!1,b||"$"])},q.prototype.back=function(){return n.appDoIt(this.model,"back")},q.prototype.forward=function(){return n.appDoIt(this.model,"forward")},q.prototype.lockAll=function(a){return n.appDoIt(this.model,"lockAll",[a||"$"])},q.prototype.unlockAll=function(a){return n.appDoIt(this.model,"unlockAll",[a||"$"])},q.prototype.getObject=function(b,c,d){var e,g,h=this.model;return c||(c=b,b=void 0),e=new a,h.waitForOpen.promise.then(function(){if("CurrentSelections"===c){if(b){var a=d||{};a.currentSelections=!0,g=n.showVisualization(b,null,a,h)}f.get(h).then(function(a){a.close=g?g.$destroy.bind(g):function(){},e.resolve(a)})}else h.enigmaModel.getObject(c).then(function(a){if(b&&(g=n.showVisualization(b,a,d),a.Closed.bind(function(){g.$destroy(),n.clearElement(b)}),a.Aborted)){var c=0;a.Aborted.bind(function(){c<3&&(r(a,e),c++)})}r(a,e)},function(a){s&&(s(a),a.isHandled=!0),e.reject(a)})},function(){e.reject()}),e.promise},q.prototype.getSnapshot=function(a,b){b||(b=a,a=void 0);var c=this.model;return c.waitForOpen.promise.then(function(){return g.Snapshot.get(b,c).then(function(b){return a&&n.showVisualization(a,b.enigmaModel,{APIType:h,noInteraction:!0}),b.getLayout().then(function(){return b})})})},q.prototype.getObjectProperties=function(a){var b=this.model;return b.waitForOpen.promise.then(function(){return e.getProperties(a,b)})},q.prototype.getFullPropertyTree=function(a){var b=this.model;return b.waitForOpen.promise.then(function(){return e.get(a,b).then(function(a){return a.getFullPropertyTree().then(function(){return a})})})},q.prototype.createGenericObject=function(b,c){var e=this;return e.model.waitForOpen.promise.then(function(){var a=c?function(a){c(a,e)}:function(){};return n.setDefaultId(b),d.get(b,e.model).then(function(b){return b.Invalidated.bind(function(){b.getLayout().then(a)}),b.Aborted.bind(function(){b.getLayout().then(a)}),b.getLayout().then(function(c){return a(c),b})},function(a){s&&(s(a.error,e),a.error.isHandled=!0)})},function(){return a.reject()})},q.prototype.destroySessionObject=function(a){return n.appDoIt(this.model,"destroySessionObject",[a])},q.prototype.createCube=function(a,b){return this.createGenericObject({qHyperCubeDef:a},b)},q.prototype.createList=function(a,b){return this.createGenericObject({qListObjectDef:a},b)},q.prototype.getList=function(a,b){return this.createGenericObject(n.getDefaultListParam(a),b)},q.prototype.getAppObjectList=function(a,b){return b||(b=a,a="sheet"),this.getList(a,b)},q.prototype.searchSuggest=function(a,b,c){var d=n.appDoIt(this.model,"searchSuggest",[b,a]).then(function(a){return{qResult:a}});return c&&d.then(function(a){c(a)}),d},q.prototype.searchAssociations=function(a,b,c,d){var e=n.appDoIt(this.model,"searchAssociations",[c||{},a,b]).then(function(a){return{qResults:a}});return d&&e.then(function(a){d(a)}),e},q.prototype.searchResults=function(a,b,c,d){var e=n.appDoIt(this.model,"searchResults",[c||{},a,b]).then(function(a){return{qResult:a}});return d&&e.then(function(a){d(a)}),e},q.prototype.selectAssociations=function(a,b,c){return n.appDoIt(this.model,"selectAssociations",[c||{},b,a])},q.prototype.getAppLayout=function(b){var c=this,d=new a,e=b?function(a){b(a.layout,c)}:function(){};return c.model.waitForOpen?c.model.waitForOpen.promise.then(function(){c.model.Invalidated&&c.model.Invalidated.bind(function(){r(c.model).then(e)}),c.model.Aborted&&c.model.Aborted.bind(function(){r(c.model).then(e)}),r(c.model).then(function(a){e(a),d.resolve(a)})}):r(c.model).then(function(a){e(a),d.resolve(a)}),d.promise},q.prototype.addAlternateState=function(a){return n.appDoIt(this.model,"addAlternateState",[a])},q.prototype.removeAlternateState=function(a){return n.appDoIt(this.model,"removeAlternateState",[a])},q.prototype.doReload=function(a,b,c){return this.fieldCache={},n.appDoIt(this.model,"doReload",[a||0,b||!1,c||!1])},q.prototype.doSave=function(a){return n.appDoIt(this.model,"doSave",[a])},q.prototype.field=function(a,b){var c=b?a+"/"+b:a;return this.fieldCache[c]||(this.fieldCache[c]=new i(this,a,b)),this.fieldCache[c]},q.prototype.table=function(a,b){return new m(this,a,b)},q.setErrorCallback=function(a){s=a},q.prototype.createTable=function(a,b,c){var d=n.createHypercubeDef(a,b,c);return new m(this,this.createGenericObject({qHyperCubeDef:d}))},q.prototype.selectionState=function(a){var b=a||"$";if(!this.stateCache[b]){var c=n.getDefaultListParam("CurrentSelections",{qStateName:b});this.stateCache[b]=new p(this,this.createGenericObject(c),b)}return this.stateCache[b]},q.prototype.getScript=function(){return this.model.rpc("GetScript")},q.prototype.setScript=function(a){var b=this.model;return b.rpc("SetScript",null,[a]).then(function(a){return b.rpc("CheckScriptSyntax").then(function(b){return b.qErrors&&b.qErrors.length>0?b:a})})},q.currApp=function(a){var c;return(c=a&&a.backendApi&&a.backendApi.model.app?a.backendApi.model.app:a&&a.backendApi&&a.backendApi.model.session?a.backendApi.model.session.currentApp:b.current)?(t||(t=new q(c)),t.model===c?t:new q(c)):null},q.openApp=function(a,c){n.initClient(),a=a||"";var d,e=n.makeConfig(c),f=b.makeCacheId(a,e);if(v[f])return v[f];s&&(d=function(){s({code:u.LOCERR_GENERIC_CONNECTION_LOST,message:"ErrorCode."+u.LOCERR_GENERIC_CONNECTION_LOST})});var g=b.getSync(a,e,!0,d);if(g){var h=new q(g);h.close=function(){return delete v[f],g.close()},v[f]=h}return v[f]},q.sessionApp=function(a){return this.sessionAppFromApp("?transient=",a)},q.sessionAppFromApp=function(a,c){n.initClient();var d,e=n.makeConfig(c),f=b.makeCacheId(a,e);e.identity=e.identity||"sessionapp",e.sessionApp={value:!0,appId:a},s&&(d=function(){s({code:u.LOCERR_GENERIC_CONNECTION_LOST,message:"Connection lost"})});var g=b.getSync(a,e,!0,d);if(g){g.session&&g.session.Error.bind(function(a){1002===a.error.code&&(a.error.isHandled=!0)});var h=new q(g);h.close=function(){return delete v[f],g.close()}}return h},q.table=function(a,b){return q.currApp(a).table(a,b)},q}),define("apis/qnavigation",["qvangular","client.utils/state","client.utils/routing"],function(a,b,c){"use strict";function d(){return m||(m=a.getService("$navigationService")),m}function e(){return d().Sheets.all.mashed}function f(){return d().Stories.all.mashed}function g(a){var c=b.model.id,d=-1;return a.forEach(function(a,b){a.qInfo.qId===c&&(d=b)}),d}function h(a,b){var c;return b.forEach(function(b){b.qInfo.qId===a&&(c=b)}),c}function i(a,b){var c;return b.forEach(function(b){b.qInfo.qId===a&&(c=b)}),c}function j(a){return c.goToSheet(a,Object.keys(b.States)[b.state]),{success:!0,sheetId:a}}function k(a){return c.goToStory(a,Object.keys(b.States)[b.States.play]),{success:!0,storyId:a}}function l(a,b,c){this.inClient=a,Object.defineProperties(this,{ANALYSIS:{get:function(){return"analysis"}},EDIT:{get:function(){return"edit"}},SNAPSHOT:{get:function(){return"snapshot"}},sheets:{get:function(){return a?e(this):b||[]}},stories:{get:function(){return a?f(this):c||[]}}})}var m;return l.prototype.gotoSheet=function(a){return h(a,this.sheets)?j(a):{success:!1,error:"NOSUCHSHEET",errorMsg:"No such sheet"}},l.prototype.nextSheet=function(){if((b.view===b.Views.sheet||b.view===b.Views.object)&&b.model){var a=g(this.sheets)+1;return j(this.sheets[a===this.sheets.length?0:a].qInfo.qId)}return{success:!1,error:"NOCURRENTSHEET",errorMsg:"No current sheet"}},l.prototype.prevSheet=function(){if((b.view===b.Views.sheet||b.view===b.Views.object)&&b.model){var a=g(this.sheets)-1;return j(this.sheets[a<0?this.sheets.length-1:a].qInfo.qId)}return{success:!1,error:"NOCURRENTSHEET",errorMsg:"No current sheet"}},l.prototype.getCurrentSheetId=function(){return b.view===b.Views.sheet&&b.model?{success:!0,sheetId:b.model.id}:{success:!1,error:"NOCURRENTSHEET",errorMsg:"No current sheet"}},l.prototype.getMode=function(){return Object.keys(b.States)[b.state]},l.prototype.setMode=function(a){return this.isModeAllowed(a)?(b.setState(b.States[a]),{success:!0,mode:a}):{success:!1,error:"MODENOTALLOWED",errorMsg:"Mode not allowed"}},l.prototype.isModeAllowed=function(a){switch(a){case this.ANALYSIS:return!0;case this.EDIT:return this.inClient&&b.model.layout&&b.model.layout.permissions&&b.model.layout.permissions.update;case this.SNAPSHOT:return this.inClient}return!1},l.prototype.gotoStory=function(a){return i(a,this.stories)?k(a):{success:!1,error:"NOSUCHSTORY",errorMsg:"No such story"}},l}),define("apis/qsession",["qvangular","core.utils/deferred","client.models/rpc-session","autogenerated/qix/engine-enums","core.utils/authentication"],function(a,b,c,d,e){"use strict";function f(a,b){a&&(a.isHandled||a.error.isHandled||!a.error||a.error.code===h.LOCERR_GENERIC_ABORTED||a.error.code===h.LOCERR_APP_NOT_FOUND||b(a.error))}function g(d,g){c.useTimeoutOnClose=!0,c.createSocket=function(a){var b;try{b=new WebSocket(a)}catch(a){d(a)}return b},c.hookIntoDeferred=function(c){c.promise.then(null,function(c){return a.getService("$timeout")(function(){f(c,d)},1e3),b.reject(c)})},c.NewSessionCreated.observers.forEach(function(a){c.NewSessionCreated.unbind(a)}),c.NewSessionCreated.bind(function(a){a.Notification.bind(function(a){"OnAuthenticationInformation"===a.method&&e.parse(a.params),a.error?d(a.error):a.params&&"fatal"===a.params.severity?d({message:a.params.message,method:a.method}):g&&g(a)}),g&&a.Warning.bind(g)})}var h=d.NxLocalizedErrorCode;return{setupSocketErrorHandling:g,handleError:f}}),define("apis/qlik-visual",["apis/qapp"],function(a){"use strict";function b(b){var c=b.getAttribute("appid");if(c){var d=JSON.parse(b.getAttribute("config"));b.app=a.openApp(c,d)}else b.app=a.currApp()}function c(a){var c=a.getAttribute("visid"),d=JSON.parse(a.getAttribute("options"));if(a.app||b(a),a.app&&c)a.app.visualization.get(c).then(function(b){a.vis=b,d&&b.setOptions(d),b.show(a)});else if(a.app){var e=JSON.parse(a.getAttribute("cols")),f=a.getAttribute("type")||"barchart";a.app.visualization.create(f,e,d).then(function(b){a.vis=b,b.show(a)})}}function d(a){a.vis&&(a.vis.close(),delete a.vis)}var e=Object.create(HTMLElement.prototype);return e.createdCallback=function(){b(this)},e.attachedCallback=function(){c(this)},e.attributeChangedCallback=function(a,e,f){if("options"===a&&this.vis){var g=JSON.parse(f);this.vis.setOptions(g)}else d(this),"appid"!==a&&"config"!==a||b(this),c(this)},e.detachedCallback=function(){d(this)},e.init=function(){if(document.registerElement)try{document.registerElement("qlik-visual",{prototype:e})}catch(a){}},e}),define("text!assets/qlikui/custom-components/qui-button-icon/qui-button-icon.html",[],function(){return'<button class="{{className}}" ng-class="classes" ng-transclude></button>'}),define("assets/qlikui/custom-components/qui-button-icon/qui-button-icon",["qvangular","text!./qui-button-icon.html"],function(a,b){function c(a,b,c){a.className="qui-btn-icn"+(b?"-tgl":""),c&&(a.className+=" qui-active")}a.component("quiButtonIcon",{template:b,scope:{icon:"@",active:"="},controller:["$scope","$element","$attrs",function(a,b,d){function e(){c(a,d.hasOwnProperty("toggle"),a.active)}function f(a){13===a.keyCode&&b.trigger("qv-activate")}a.$watch("active",e),b.on("keypress",f)}]})}),define("text!assets/qlikui/custom-components/qui-button-outline-round/qui-button-outline-round.html",[],function(){return'<button class="{{className}}" ng-class="{\'qv-btn-outline-round-no-text\': !qvaButtonText && !qvaButtonPreIconText, \'qv-btn-outline-round-with-text\':  qvaButtonText || qvaButtonPreIconText}">\n\t<div class="qv-btn-outline-round-flex">\n\t\t<div ng-if="qvaButtonPreIconText" ng-class="{\'qv-btn-outline-round-icon-right\': classIcon}" class="qv-btn-outline-round-text">{{qvaButtonPreIconText}}</div>\n\t\t<i class="outline-icon {{ classIcon }}"></i>\n\t\t<div ng-if="qvaButtonText" ng-class="{\'qv-btn-outline-round-icon-left\': classIcon}" class="qv-btn-outline-round-text" q-translation="{{qvaButtonText}}"></div>\n\t</div>\n</button>\n'}),define("assets/qlikui/custom-components/qui-button-outline-round/qui-button-outline-round",["qvangular","text!./qui-button-outline-round.html"],function(a,b){a.component("quiButtonOutlineRound",{template:b,scope:{classIcon:"@",qvaButtonText:"@",qvaButtonPreIconText:"="},controller:["$scope","$attrs",function(a,b){a.className="qv-btn-outline-round",b.hasOwnProperty("light")&&(a.className+=" qv-btn-outline-round-light"),a.$watch("classIcon",function(b){a.classIcon=b})}]})}),define("text!assets/qlikui/custom-components/qui-dialog-default/qui-dialog-default.html",[],function(){return'<div class="qui-delayedModal delayedModal qui-delayedmodal" ng-transclude>\n\t<!-- This will be replaced by ng-transclude -->\n</div>\n'}),define("assets/qlikui/custom-components/qui-dialog-default/qui-dialog-default",["qvangular","text!./qui-dialog-default.html"],function(a,b){a.component("quiDialogDefault",{template:b})}),define("text!assets/qlikui/custom-components/qui-dialog-pleasewait/qui-dialog-pleasewait.html",[],function(){
return'<div>\n\t<qui-dialog-default>\n\t\t<header class="dm-header" q-translation="Common.PleaseWait">#Working#</header>\n\t\t<main class="dm-main">\n\t\t\t<p class="qui-pleasewaitdialog-loader-container"><img src="../resources/img/core/loader.svg"/></p>\n\n\t\t\t<p class="qui-pleasewaitdialog-pleasewait" q-translation="Common.PleaseWait"></p>\n\t\t</main>\n\t\t<footer class="dm-footer">\n\t\t</footer>\n\t</qui-dialog-default>\n</div>\n'}),define("assets/qlikui/custom-components/qui-dialog-pleasewait/qui-dialog-pleasewait",["qvangular","text!./qui-dialog-pleasewait.html"],function(a,b){a.component("quiDialogPleasewait",{template:b})}),define("text!assets/qlikui/custom-components/qui-filter/qui-filter.ng.html",[],function(){return'<div class="button-div qui-filter lui-buttongroup">\n\t<lui-button qva-activate="toggleAscDesc()"\n\t\t\t\tclass="asc-desc"\n\t\t\t\ttitle="{{sortTitle | translate}}">\n\t\t<span class="lui-icon  lui-button__icon" ng-class="isAscending ? \'lui-icon--ascending\' : \'lui-icon--descending\'"></span>\n\t</lui-button>\n\n\t<lui-button disabled="disabled"\n\t\t\t\tng-if="sections.length <= 1"\n\t\t\t\tclass="sort-filter"\n\t\t\t\ttitle="{{ sortOptTitle | translate }}">\n\t\t<span class="lui-button__text">\n\t\t\t{{ $parent.sections[0].text || "Common.SortByAlphabetical" | translate }}\n\t\t</span>\n\t\t<span class="lui-caret  lui-button__caret"></span>\n\t</lui-button>\n\n\t<lui-select ng-if="sections.length > 1"\n\t\t\t\tclass="sort-filter"\n\t\t\t\tx-model="$parent.selectedFltr"\n\t\t\t\tx-options="option.value as option.text | translate for option in sections"\n\t\t\t\ttitle="{{sortOptTitle | translate}}"></lui-select>\n</div>\n'}),define("assets/qlikui/custom-components/qui-filter/qui-filter",["qvangular","text!./qui-filter.ng.html"],function(a,b){a.component("quiFilter",{template:b,scope:{isAscending:"=",sections:"=",selectedFltr:"=",toggleAscDesc:"&",sortTitle:"@",sortOptTitle:"@"}})}),define("text!assets/qlikui/custom-components/qui-float/qui-float.html",[],function(){return'<div class="qui-float" ng-style="{top:top, left:left}" ng-show="visible" qva-reported-window-size="reportedWindowSize">\n\t<div ng-transclude></div>\n</div>\n'}),define("assets/qlikui/custom-components/qui-float/qui-float",["qvangular","text!./qui-float.html"],function(a,b){a.component("quiFloat",{transclude:!0,template:b,scope:{quiOffset:"=",quiResizeOnChange:"="},controller:["$scope","$element","$timeout",function(a,b,c){function d(){a.quiOffset&&a.reportedSize&&a.reportedWindowSize?(a.quiOffset.left+a.reportedSize.width<a.reportedWindowSize.width?a.left=a.quiOffset.left:a.left=a.reportedWindowSize.width-a.reportedSize.width,a.quiOffset.top+a.reportedSize.height<a.reportedWindowSize.height?a.top=a.quiOffset.top:a.top=a.reportedWindowSize.height-a.reportedSize.height,a.visible=!0):a.visible=!1}function e(){c(function(){a.reportedSize={width:b.outerWidth(),height:b.outerHeight()}})}a.$watch("quiResizeOnChange",e,!0),a.$watch("[quiOffset, reportedSize, reportedWindowSize]",d,!0)}]})}),define("assets/qlikui/custom-components/qui-input-number/numerical-interval-transformer",[],function(){function a(a){return Number(String(a).replace(/[^-\d]/g,""))}return{getNumerical:function(b,c,d){return b=a(b),c=Number(c),d=Number(d),b<c?c:0!==d&&b>d?d:b}}}),define("text!assets/qlikui/custom-components/qui-input-number/qui-input-number.ng.html",[],function(){return'<span class="qui-input-number lui-input-group">\n\t<button class="lui-input-group__item  lui-input-group__button  lui-button" qva-activate="onChange(-1)" ng-disabled="quiDisabled" ng-if="quiWithButtons">\n\t\t<span class="lui-button__icon">-</span>\n\t</button>\n\t<input type="tel" class="lui-input-group__item  lui-input-group__input  lui-input {{quiClass}}" tid="{{quiTid}}" title="{{quiTitle}}" ng-model="quiModel" ng-change="onChange()" ng-disabled="quiDisabled"/>\n\t<button class="lui-input-group__item  lui-input-group__button  lui-button" qva-activate="onChange(1)" ng-disabled="quiDisabled" ng-if="quiWithButtons">\n\t\t<span class="lui-button__icon">+</span>\n\t</button>\n</span>\n'}),define("assets/qlikui/custom-components/qui-input-number/qui-input-number",["qvangular","./numerical-interval-transformer","text!./qui-input-number.ng.html"],function(a,b,c){a.component("quiInputNumber",{template:c,scope:{quiModel:"=",quiDisabled:"=",quiTitle:"@",quiMin:"@",quiMax:"@",quiClass:"@",quiSelectTextOnFocus:"@",quiWithButtons:"@",quiTid:"@"},controller:["$scope","$element",function(a,c){a.quiSelectTextOnFocus&&(a.selected=!1,c.click(function(){a.selected===!1&&(c.select(),a.selected=!0)}),c.blur(function(){a.selected=!1})),a.onChange=function(d){var e=parseInt(d)||0;a.quiModel=b.getNumerical(parseInt(c.find(".lui-input").val())+e,a.quiMin,a.quiMax)}}]})}),define("text!assets/qlikui/custom-components/qui-popover-button/qui-popover-button.ng.html",[],function(){return'<button\n\t\tclass="qui-popover-button qui-dropdown"\n\t\ttid="{{quiModel.tid}}"\n\t\tdata-ng-disabled="quiModel.isDisabled()"\n\t\tdata-ng-class="buttonClasses"\n\t\tdata-icon="{{quiModel.icon}}"\n\t\tq-title-translation="{{currentTitle}}"\n\t\tdata-qva-activate="onClick()">\n\t{{quiModel.buttonText}}\n\t<ng-transclude></ng-transclude>\n</button>\n'}),define("text!assets/qlikui/custom-components/qui-popover-button/qui-popover-button-menu.ng.html",[],function(){return'<immidiate-contextual align-to="alignTo"\n\t\t\t\t\t  smallview="quiModel.menuOptions.smallview"\n\t\t\t\t\t  position="quiModel.menuOptions.position"\n\t\t\t\t\t  width="quiModel.menuOptions.width"\n\t\t\t\t\t  top="quiModel.menuOptions.top"\n\t\t\t\t\t  hidepointer="quiModel.menuOptions.hidepointer"\n\t\t\t\t\t  on-close-view="onClose(event)">\n\t<ul ng-class="menuClasses" tid="{{quiModel.menuOptions.content.tid}}">\n\t\t<li class="toolbar-menu-li" ng-repeat="menuItem in menuItems" data-icon="{{menuItem.icon}}" ng-disabled="menuItem.disable" qui-click=\'menuItem.fn()\'\n\t\t\tng-class="{\'open-in-new-tab-always\': menuItem.openInNewTab == \'always\'}" ng-hide="menuItem.hide">\n\t\t\t<span class="qui-textlist-text"\n\t\t\t\t  tid="{{menuItem.tid}}"\n\t\t\t\t  q-title-translation="{{ menuItem.title || menuItem.text}}"\n\t\t\t\t  ng-class="{\'open-in-new-tab-text-optional\': menuItem.openInNewTab == \'optional\', \'open-in-new-tab-always\': menuItem.openInNewTab == \'always\'}"\n\t\t\t\t  qva-activate="selectMenuItem(menuItem, $event)" q-translation="{{menuItem.text}}" ng-disabled="menuItem.disable">\n\t\t\t</span>\n\t\t\t<span ng-if="menuItem.openInNewTab" class="open-in-new-tab" ng-class="{\'open-in-new-tab-always\': menuItem.openInNewTab == \'always\'}" data-icon="stacked-windows" q-title-translation="{{ menuItem.title || \'Tooltip.OpenInNewTab\'}}" qva-activate="selectMenuItem(menuItem, $event, \'true\')" ng-disabled="menuItem.disable"></span>\n\t\t</li>\n\t</ul>\n</immidiate-contextual>\n'}),define("text!general.components/immidiate-contextual/immidiate-contextual.ng.html",[],function(){return"<div qva-outside='onOutsidePopover($event)' ng-class=\"{'lui-immidiateContextual': popupStyle === 'lui', 'qui-immidiateContextual' : popupStyle !== 'lui' }\">\n\t<div class='immidiate-contextual-arrow' ng-hide='hidepointer'></div>\n\t<div class='content' ng-transclude></div>\n</div>\n"}),define("text!general.components/immidiate-contextual/immidiate-contextual-small.ng.html",[],function(){return"<div class='qui-immidiateContextual-small' qva-activate='onOutsidePopover($event)' qva-outside='onOutsidePopover($event)'>\n    <div class='immidiate-contextual-arrow' ng-hide='hidepointer'></div>\n    <div class='content' ng-transclude></div>\n</div>\n"}),define("general.components/immidiate-contextual/immidiate-contextual",["jquery","general.utils/window-positioner","general.utils/arrow-positioner","text!general.components/immidiate-contextual/immidiate-contextual.ng.html","text!general.components/immidiate-contextual/immidiate-contextual-small.ng.html","assets/qvangular/qvangular-core","core.utils/resize","general.utils/dom-util","general.utils/responsive-state"],function(a,b,c,d,e,f,g,h,i){f.directive("immidiateContextual",function(){return{replace:!0,template:function(a,b){var c=d;return i.isSmallDevice&&b.smallview&&(c=e),c},transclude:!0,scope:{onCloseView:"&",hidepointer:"=",luiStyle:"="},restrict:"E",link:function(d,e,i){d.popupStyle="qui",d.luiStyle&&(d.popupStyle="lui");var j,k,l=a(d.$parent.$eval(i.alignTo)),m=a(d.$parent.$eval(i.offset))[0],n=d.$parent.$eval(i.width),o=d.$parent.$eval(i.top),p=d.$parent.$eval(i.height),q=d.$parent.$eval(i.position),r=d.$parent.$eval(i.limits)||null,s=d.$parent.$eval(i.collision)||"none";void 0!==p&&e.css("height",p||"100"),void 0!==n&&e.css("width",n||"100"),d.onOutsidePopover=function(a){a.stopPropagation(),a.preventDefault(),d.onCloseView({event:a})},a(document).on("keydown.immediateContextual",function(b){var c=h.isInput(document.activeElement);!a(".qui-immidiateContextual").length||c||9!==b.which&&32!==b.which||(b.preventDefault(),d.onCloseView({event:b}),d.$apply(),l.hasClass("lui-button")&&l.hasClass("lui-active")&&l.removeClass("lui-active"))}),d.positionMap=function(a){return{topRight:"right",top:"top",topLeft:"left",centerRight:"right",center:"right",centerLeft:"left",bottom:"bottom",bottomLeft:"left",bottomRight:"right"}[a]},d.synchronAlign=function(){d.hidepointer?d.$parent.event&&(j=b.alignToCoordinate(e,d.$parent.event.pageX,d.$parent.event.pageY,i.position)):(m?(j=b.alignToCoordinate(e,m.x,m.y,q),j=d.positionMap(j)):j=b.align(e,l,{position:q,collision:s,limits:r}),e.find("div.immidiate-contextual-arrow").addClass(j),c.align(e,l,j,e.children("div.immidiate-contextual-arrow")))},d.align=function(){void 0!==o&&e.css({top:parseInt(o,10)}),k=f.getService("$timeout")(d.synchronAlign)},d.$on("recalculatePointer",function(){d.hidepointer||c.align(e,l,j,e.children("div.immidiate-contextual-arrow"))}),d.$on("$destroy",function(){f.getService("$timeout").cancel(k),g.off("end",d.align),a(document).off("keydown.immediateContextual")}),g.on("end",d.align),d.align()}}})}),define("assets/qlikui/custom-components/qui-popover-button/qui-popover-button",["assets/qvangular/qvangular-core","jquery","text!./qui-popover-button.ng.html","text!./qui-popover-button-menu.ng.html","general.services/show-service/show-service","core.utils/resize","general.components/immidiate-contextual/immidiate-contextual"],function(a,b,c,d,e,f){var g={template:d,scope:{quiModel:"=",alignTo:"=",shared:"="},controller:["$scope",function(a){a.shared.destroyComponent=a.destroyComponent,a.menuClasses=a.quiModel.menuOptions.content.menuClasses?a.quiModel.menuOptions.content.menuClasses:"qui-textlist",a.quiModel.menuOptions.content.createMenuItems().then(function(b){a.menuItems=b}),a.selectMenuItem=function(b,c,d){c&&c.preventDefault&&c.preventDefault(),b.disable||(a.onClose&&a.onClose(c),b.selected(c,d))},a.onClose=function(c){b(c.target).hasClass("qui-popover-button")&&a.quiModel.tid===b(c.target).attr("tid")||(a.destroyComponent(),a.shared.pressed=!1)},a.closeFromContent=function(){a.destroyComponent(),a.shared.pressed=!1},a.$on("$destroy",function(){f.off("start",a.onClose)}),f.on("start",a.onClose)}]};a.directive("quiPopoverButton",function(){return{template:c,transclude:!0,replace:!0,restrict:"E",scope:{quiModel:"=",quiPopoverContainer:"=?"},controller:["$scope","$element",function(a,b){a.shared={},a.shared.pressed=!1,a.buttonClasses={"lui-active":a.shared.pressed},a.$watch("quiModel.buttonType",function(b){b&&(a.buttonClasses[b]=!0),b&&0===b.indexOf("lui-button")?a.buttonClasses["lui-button"]=!0:a.buttonClasses["lui-button"]=!1}),a.$watch("shared.pressed",function(b){a.buttonClasses["lui-active"]=b,a.currentTitle=b&&a.quiModel.tooltipActive?a.quiModel.tooltipActive:a.quiModel.tooltipInactive}),b.on("keypress",function(b){13===b.keyCode&&a.onClick()}),a.onClick=function(){a.shared.pressed?(a.shared.destroyComponent(),a.shared.pressed=!1):(a.shared.pressed=!0,e.show(a.quiPopoverContainer||g,{quiModel:a.quiModel,alignTo:b,shared:a.shared}))},a.quiModel&&(a.quiModel.forceClick=a.onClick)}]}})}),define("text!assets/qlikui/custom-components/qui-search-field-old/qui-search-field-old.ng.html",[],function(){return'<div class="qui-searchfield-old" ng-disabled="disabled">\n\t<span class="magnifying-glass"></span>\n\t<span q-title-translation="Common.Clear" class="clear-button" ng-show="query.length" qva-activate="clearSearch($event)"></span>\n\t<input maxlength="{{maxlength || 255}}" q-placeholder="{{placeholder}}" ng-model="query" ng-disabled="disabled" autocomplete="{{autocomplete}}" spellcheck="false" ng-trim="false" type="text" qva-blur="blurred()"\n\t\t\tqva-focus="autoFocus" qv-escape="escape($event)" qv-enter="enter($event)"/>\n</div>\n'}),define("assets/qlikui/custom-components/qui-search-field-old/qui-search-field-old",["qvangular","text!./qui-search-field-old.ng.html"],function(a,b){a.component("quiSearchFieldOld",{scope:{query:"=",disabled:"=",autocomplete:"=",placeholder:"@",autoFocus:"=?",isFocused:"=?",focuscallback:"&",maxlength:"=",onEscape:"&",onEnter:"&",onClear:"&"},template:b,link:function(a,b){var c=b.find("span.clear-button"),d=b.find("input");d.on("focus.quiSearchField",function(){a.$root.$$phase?a.focused():a.$apply(function(){a.focused()})}),a.focused=function(){a.focuscallback(),a.isFocused=!0},a.blurred=function(){a.isFocused=!1},a.escape=function(b){a.onEscape&&a.onEscape({$event:b})},a.enter=function(b){a.onEnter&&a.onEnter({$event:b})},a.clearSearch=function(b){b.preventDefault(),a.query="",a.onClear&&a.onClear({$event:b})},a.$on("$destroy",function(){d.off(".quiSearchField"),c.off(".quiSearchField")})}})}),define("text!assets/qlikui/custom-components/qui-toolbar/qui-app-info.ng.html",[],function(){return'<section class="qv-app-info-holder">\n\t<div class="app-info-click-area"\n\t\t qva-activate="quiModel.onButton()"\n\t\t q-title-translation="{{quiModel.tooltip()}}"\n\t\t ng-class="{\'has-app-details\': quiModel.hasAppDetails()}">\n\t\t<span class="app-read-only" ng-if="quiModel.readOnly"><i data-icon="padlock" q-title-translation="Hub.App.ReadOnly"></i>&nbsp;</span>\n\n\t\t<h1 class="app-title">{{quiModel.appTitle}}</h1>\n\n\t\t<span class="app-info-icon lui-icon  lui-icon--more-rounded" ng-if="quiModel.hasAppDetails()"></span>\n\t</div>\n</section>\n'}),define("text!assets/qlikui/custom-components/qui-toolbar/qui-toolbar-button.ng.html",[],function(){return'<button\n\t\ttid="{{quiModel.tid}}"\n\t\tqva-activate="onButton($event)"\n\t\tqva-outside-ignore-for="{{quiModel.name}}"\n\t\tq-title-translation="{{(quiModel.pressed && quiModel.tooltipActive ? quiModel.tooltipActive : quiModel.tooltipInactive)}}"\n\t\tng-disabled="quiModel.isDisabled()"\n\t\tng-hide="quiModel.isHidden()"\n\t\tclass="{{quiModel.hasStrongActiveColor}}"\n\t\tng-class="{\n\t\t\t\'lui-button\': !quiModel.qlikuiSmallIconButton,\n\t\t\t\'lui-button--toolbar\': !quiModel.qlikuiSmallIconButton,\n\t\t\t\'qui-smalliconbutton\': quiModel.qlikuiSmallIconButton,\n\t\t\t\'lui-active\': quiModel.pressed,\n\t\t\t\'noIcon\': !quiModel.icon,\n\t\t\t\'iconToTheRight\': quiModel.iconToTheRight,\n\t\t\t\'dyn-text\': quiModel.dynamicText\n\t\t}">\n\t<span qva-outside-ignore-for="{{quiModel.name}}" ng-if="!quiModel.dynamicText && !quiModel.textOnly && !quiModel.iconToTheRight && quiModel.showLoading" class="qv-loader lui-button-loading"></span>\n\t<span qva-outside-ignore-for="{{quiModel.name}}" ng-if="!quiModel.dynamicText && !quiModel.textOnly && !quiModel.iconToTheRight && !quiModel.showLoading" data-icon="{{quiModel.icon}}" ng-class="{\'qui-dropdown\': quiModel.isDropdownButton}"></span>\n\t<span qva-outside-ignore-for="{{quiModel.name}}" ng-if="!quiModel.dynamicText && quiModel.showText()" class="item-title" qva-direction x-dir-text="{{(quiModel.pressed && quiModel.textActive ? quiModel.textActive : quiModel.textInactive) | translate}}">{{(quiModel.pressed && quiModel.textActive ? quiModel.textActive : quiModel.textInactive) | translate}}</span>\n\t<span qva-outside-ignore-for="{{quiModel.name}}" ng-if="!quiModel.dynamicText && !quiModel.textOnly && quiModel.iconToTheRight && !quiModel.showLoading" data-icon="{{quiModel.icon}}" ng-class="{\'qui-dropdown\': quiModel.isDropdownButton}"></span>\n\t<span qva-outside-ignore-for="{{quiModel.name}}" ng-if="!quiModel.dynamicText && !quiModel.textOnly && quiModel.iconToTheRight && quiModel.showLoading" class="qv-loader lui-button-loading"></span>\n\t<span qva-outside-ignore-for="{{quiModel.name}}" ng-if="quiModel.dynamicText">{{ quiModel.dynamicText() }}</span>\n</button>\n'}),define("assets/qlikui/custom-components/qui-toolbar/qui-toolbar",["jquery","qvangular","text!./qui-app-info.ng.html","text!./qui-toolbar-button.ng.html"],function(a,b,c,d){b.component("quiToolbar",{template:"<div class='qui-toolbar' ng-transclude />"}),b.component("quiToolbarLeft",{template:"<div class='qui-buttonset-left' ng-transclude />"}),b.component("quiToolbarRight",{template:"<div class='qui-buttonset-right' ng-transclude />"}),b.component("quiToolbarButtonGroup",{template:"<div class='lui-buttongroup' ng-transclude />"}),b.component("quiToolbarAppInfo",{template:c,scope:{quiModel:"="}}),b.component("quiToolbarButton",{template:d,scope:{quiModel:"="},controller:["$scope","$element",function(b,c){c.on("keypress",function(a){13===a.keyCode&&c.trigger("qv-activate")}),b.onButton=function(c){a.support.touch&&c.target.focus(),b.quiModel.isToggleButton&&(b.quiModel.pressed=!b.quiModel.pressed),b.quiModel.onButtonClicked(b.quiModel,c)}}]})}),define("assets/qlikui/custom-components",["assets/qlikui/custom-components/qui-button-icon/qui-button-icon","assets/qlikui/custom-components/qui-button-outline-round/qui-button-outline-round","assets/qlikui/custom-components/qui-dialog-default/qui-dialog-default","assets/qlikui/custom-components/qui-dialog-pleasewait/qui-dialog-pleasewait","assets/qlikui/custom-components/qui-filter/qui-filter","assets/qlikui/custom-components/qui-float/qui-float","assets/qlikui/custom-components/qui-input-number/qui-input-number","assets/qlikui/custom-components/qui-popover-button/qui-popover-button","assets/qlikui/custom-components/qui-search-field-old/qui-search-field-old","assets/qlikui/custom-components/qui-toolbar/qui-toolbar"],function(){}),define("general.utils/qv-activate",["jquery","jqueryoutside","touche"],function(a){function b(b,c,d){return a.Event(b,{pageX:d.pagePoints[0].x,pageY:d.pagePoints[0].y,ctrlKey:c.ctrlKey,metaKey:c.metaKey,shiftKey:c.shiftKey,originalEvent:c,gestureData:d})}var c;Touche(document.body).tap({options:{preventDefault:!1},start:function(b){c=a(b.target)},end:function(a,d){var e=b("qv-activate",a,d);0===c.closest(":disabled").length&&c.trigger(e),c=null}});var d=Touche.Gesture.augment(function(a){function b(){a.apply(this,arguments)}return this.defaults={precedence:6},this.start=function(a,b){this.binder.start.call(this,a,b)},b});Touche.gestures.add("press",d),Touche(document.body).press({start:function(c,d){var e=b("qv-press",c,d);a(c.target).trigger(e)}}),a.addOutsideEvent("qv-press","qv-outside","touchstart","touchend")}),define("general.utils/qv-swipe",["jquery","touche"],function(a){function b(b,c,d){return a.Event(b,{pageX:d.pagePoints[0].x,pageY:d.pagePoints[0].y,ctrlKey:c.ctrlKey,shiftKey:c.shiftKey,originalEvent:c,gestureData:d})}function c(){function a(){document.removeEventListener("mousedown",b,!0),document.removeEventListener("mousemove",c,!0),document.removeEventListener("mouseup",d,!0)}function b(a){a.preventDefault(),a.stopPropagation()}function c(a){a.preventDefault(),a.stopPropagation()}function d(b){b.preventDefault(),b.stopPropagation(),a(),clearTimeout(e)}var e;document.addEventListener("mousedown",b,!0),document.addEventListener("mousemove",c,!0),document.addEventListener("mouseup",d,!0),e=setTimeout(a,350)}var d;Touche(document.body).tap({options:{preventDefault:!1},start:function(b){d=a(b.target)}}),Touche(document.body).swipe({options:{preventDefault:!1,radiusThreshold:8},start:function(a,c){var e=b("qv-swipestart",a,c);d.trigger(e)},update:function(a,c){var e=b("qv-swipeupdate",a,c);d.trigger(e)},cancel:function(){var b=a.Event("qv-swipecancel");d.trigger(b)},end:function(a,e){Touche.utils.isMouse(a)||c();var f=b("qv-swipe",a,e);d.trigger(f)}})}),define("general.utils/qv-longtapswipe",["jquery","touche"],function(a,b){"use strict";var c=b.Gesture.augment(function(c){function d(){c.apply(this,arguments)}function e(){function a(){document.removeEventListener("mousedown",b,!0),document.removeEventListener("mousemove",c,!0),document.removeEventListener("mouseup",d,!0)}function b(a){a.preventDefault(),a.stopPropagation()}function c(a){a.preventDefault(),a.stopPropagation()}function d(b){b.preventDefault(),b.stopPropagation(),a(),clearTimeout(e)}var e;document.addEventListener("mousedown",b,!0),document.addEventListener("mousemove",c,!0),document.addEventListener("mouseup",d,!0),e=setTimeout(a,350)}var f=!1;return this.defaults={radiusThreshold:10,timeThreshold:510,touches:1,precedence:4,preventDefault:!1,which:1,interval:10},this.on=function(a){this.count=0,b(a).longtap({id:this.id,options:{precedence:this.options.precedence,preventDefault:this.options.preventDefault,touches:this.options.touches,which:this.options.which,areaThreshold:this.options.areaThreshold,timeThreshold:this.options.timeThreshold,interval:this.options.interval},start:this.longtapStart.bind(this),update:this.longtapUpdate.bind(this),cancel:this.longtapCancel.bind(this),end:this.longtapEnd.bind(this)}).swipe({id:this.id,options:{precedence:this.options.precedence+1,preventDefault:this.options.preventDefault,radiusThreshold:this.options.radiusThreshold,touches:this.options.touches},start:this.swipeStart.bind(this),update:this.swipeUpdate.bind(this),end:this.swipeEnd.bind(this),cancel:this.swipeCancel.bind(this)})},this.off=function(a){b(a).off("longtap",this.id),b(a).off("swipe",this.id)},this.longtapStart=function(){f=!1},this.longtapUpdate=function(a,b){100===b.percentage&&(f=!0)},this.longtapEnd=function(){this.binder.cancel()},this.longtapCancel=function(){f||this.binder.cancel()},this.swipeStart=function(b,c){var d=a(b.target).is("input, textarea");f&&!d?this.binder.start(b,c):f&&d&&(f=!1)},this.swipeUpdate=function(a,b){f&&this.binder.update(a,b)},this.swipeEnd=function(a,b){f&&(e(),this.binder.end(a,b),f=!1)},this.swipeCancel=function(){f=!1,this.binder.cancel()},d});b.gestures.add("longtapswipe",c)}),define("text!objects/object.ng.html",[],function(){return'<div class="qv-object-wrapper" ng-class="wrapperClassList">\n\n\t<article class="qv-object qvt-visualization" ng-class="classList" tid="{{objectClass}}">\n\t\t<div class="qv-inner-object" ng-style="styles.backgroundColor">\n\t\t\t<qv-rain ng-if="object.throbberApi.isVisible" show="object.throbberApi.isVisible" resize="object.throbberApi.watchResize"></qv-rain>\n\t\t\t<div class="retry-overlay" ng-if="object.throbberApi.isQueryCanceled">\n\t\t\t\t<ul class="cancelled-list">\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="retry-text" q-translation="Object.Cancelled"></div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<button class="retry-button lui-button" qva-activate="retry()" q-translation="Dialog.Button.Retry" tid="retry-calculations"></button>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t\t<div class="cancel-overlay" ng-if="object.throbberApi.isLongRunningQuery">\n\t\t\t\t<button class="cancel-button lui-button" ng-if="!object.throbberApi.isQueryCanceled" qva-activate="cancel()"\n\t\t\t\t\t\tq-translation="Common.Cancel" tid="cancel-calculations"></button>\n\t\t\t</div>\n\n\t\t<header qva-direction x-dir-setting="{{options.direction}}" ng-show="object.hasFrame" class="qv-object-header" ng-class="{\'thin\' : !object.showTitles || ( layout.title === \'\' && layout.subtitle === \'\' && !object._inEditState )}">\n\t\t\t<h1 ng-show="object.showTitles" qva-direction x-dir-setting="{{options.direction}}" ng-attr-title="{{layout.title}}" class="qv-object-title qvt-visualization-title" qva-activate="titleClicked();" ng-style="styles.title">\n\t\t\t\t\t<a ng-if="options.showSearch && object.isInteractive && !object.backendApi.isLocked() && !object._inEditState" q-title-translation="Common.Search" class="qv-object-search lui-icon lui-icon--search"\n\t\t\t\t\t   qva-activate="options.showSearch && options.search.toggle()"></a>\n\t\t\t\t<a ng-if="options.showSearch && object.isInteractive && object.backendApi.isLocked()" class="qv-object-locked lui-icon lui-icon--lock"\n\t\t\t\t   qva-activate="titleClicked()"></a>\n\t\t\t\t<span ng-if="options.showSearch && object.backendApi.isDrillDown()" class="lui-icon lui-icon--select-alternative" q-title-translation="Tooltip.dimensions.drilldown"></span>\n\t\t\t\t<div ng-if="options.highlightTitle && (!object._inEditState || object._inEditState && object.isReadonly)" qve-highlight text="{{layout.title}}" query="options.highlightQuery" class="qv-object-title-text" qva-direction x-dir-setting="{{options.direction}}" x-dir-text="{{layout.title}}"></div>\n\t\t\t\t<div ng-if="!options.highlightTitle && (!object._inEditState || object._inEditState && object.isReadonly)" class="qv-object-title-text" qva-direction x-dir-setting="{{options.direction}}" x-dir-text="{{layout.title}}">{{layout.title}}</div>\n\t\t\t\t<div ng-if="options.showDisclaimerStar && !!layout.title && !object._inEditState" class="disclaimer qv-object-title-text">*</div>\n\t\t\t\t<div ng-if="object._inEditState && !object.isReadonly" qv-inline-title-edit x-dir-setting="{{options.direction}}" x-model="model" x-property-path="title" x-layout-path="title"\n\t\t\t\t\t x-empty-translation="Object.AddTitle" class="qv-object-title-edit" qva-direction x-dir-setting="{{options.direction}}"></div>\n\t\t\t\t</h1>\n\n\t\t\t<h2 ng-if="!!layout.subtitle && object.showTitles" ng-style="styles.subTitle" qva-direction x-dir-setting="{{options.direction}}" x-dir-text="{{layout.subtitle}}" ng-attr-title="{{layout.subtitle}}" ng-show="!!layout.subtitle" class="qv-object-subtitle qvt-visualization-subtitle">{{layout.subtitle}}</h2>\n\t\t\t</header>\n\n\t\t\t<div class="qv-object-content-container">\n\t\t\t\t<div class="qv-object-content" qv-object-content component="object.content" options="options" object="object" backend-api="object.backendApi" layout="layout"\n\t\t\t\t ext="object.ext" selections-api="object.selectionsApi" tooltip-api="object.tooltipApi" throbber-api="object.throbberApi" on-init="onInit">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="qv-footer-wrapper" ng-show="object.hasFrame && object.showTitles && !!layout.footnote" ng-style="styles.footer">\n\t\t\t<footer qva-direction x-dir-setting="{{options.direction}}" x-dir-text="{{layout.footnote}}" ng-attr-title="{{layout.footnote}}" ng-if="object.hasFrame && object.showTitles && !!layout.footnote" class="qv-object-footnote qvt-visualization-footnote">{{layout.footnote}}</footer>\n\t\t</div>\n\n\n\t<div qva-direction x-dir-setting="{{options.direction}}" class="qv-object-nav" ng-class="{\'zero-top\' : options.isZoomed, \'visible\' : navMenu.visible, \'active\': options.isActive, \'inline\' : thinHeader}">\n\t\t\t<a ng-repeat="menuItem in navMenu.items"\n\t\t\t   ng-if="menuItem.isVisible()"\n\t\t\t   ng-class="[menuItem.cssClasses, menuItem.dynamicCssClasses()]"\n\t\t\t   qva-activate="menuItem.action()"\n\t\t\t   q-title-translation="{{menuItem.translation}}"\n\t\t\t   tid="{{menuItem.tid}}"></a>\n\t\t</div>\n\n\t</article>\n\n\t<qv-soft-property-panel object="object" ng-if="options.isZoomed && object.hasSoftProperties" can-save-soft-properties="options.canSaveSoftProperties" ng-hide="!object.showExploreMenu"></qv-soft-property-panel>\n</div>\n'}),define("text!objects.requirements/requirements.ng.html",[],function(){return'<div qv-requirements class="requirements-wrapper" ng-show="show" ng-class="{\'incomplete\': !showAdd}">\n\t<div class="requirements">\n\t\t<h2 class="header">\n\t\t\t<i class="object-icon" ng-class="iconClass"></i>\n\t\t</h2>\n\t<p class="incomplete-text" ng-if="!showAdd" q-translation="Visualization.Requirements.IncompleteVisualization"></p>\n\t\t<!-- finished dimensions -->\n\t<ul ng-if="showAdd && finishedDimensions.length">\n\t\t<li ng-repeat="dimension in finishedDimensions" class="item" ng-class="{ finished: !dimension.invalid, invalid: dimension.invalid }"\n\t\t\ttid="{{ dimension.invalid ? \'invalid-dimension\' : \'added-dimension\'}}">\n\t\t\t<span class="text" ng-class="{ \'no-icon\': !canRemoveDim }" title="{{dimension.title}}">{{dimension.title}}</span>\n\t\t\t<i ng-if="canRemoveDim" class="lui-icon lui-icon--remove" qva-activate="removeDimension($index)" q-title-translation="Common.Delete"></i>\n\t\t\t</li>\n\t\t</ul>\n\t\t<!-- unfinished dimensions -->\n\t<ul ng-if="showAdd && unfinishedDimensions.length">\n\t\t<li ng-repeat="d in unfinishedDimensions" class="item missing" tid="missing-dimension">\n\t\t\t<button class="add-button lui-button"  ng-class="{ \'lui-active\': d.active }" ng-click="showAddDimension($event,d)"\n\t\t\t\t\tq-translation="Visualization.Requirements.AddDimension" tid="add-dimension"></button>\n\t\t\t</li>\n\t\t</ul>\n\t\t<!-- finished measures -->\n\t<ul ng-if="showAdd && finishedMeasures.length">\n\t\t<li ng-repeat="measure in finishedMeasures" class="item" ng-class="{ finished: !measure.invalid, invalid: measure.invalid }"\n\t\t\ttid="{{ measure.invalid ? \'invalid-measure\' : \'added-measure\'}}">\n\t\t\t<span class="text" title="{{measure.title}}">{{measure.title}}</span>\n\t\t\t<i class="lui-icon lui-icon--remove" qva-activate="removeMeasure($index)" q-title-translation="Common.Delete"></i>\n\t\t\t</li>\n\t\t</ul>\n\t\t<!-- unfinished measures -->\n\t<ul ng-if="showAdd && unfinishedMeasures.length">\n\t\t<li ng-repeat="m in unfinishedMeasures" class="item missing" tid="missing-measure">\n\t\t\t<button class="add-button lui-button"  ng-class="{ \'lui-active\': m.active }" ng-click="showAddMeasure($event,m)"\n\t\t\t\t\tq-translation="Visualization.Requirements.AddMeasure" tid="add-measure"></button>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n</div>\n'}),define("text!objects.add-popovers/add-dimension-popover.ng.html",[],function(){
return'<lui-popover style="min-width: 200px;width: 230px;" align-to="alignTo" position="position" collision="\'flipfit\'" on-close-view="closeAddPopover(event)" qva-outside-ignore-for="{{qvaOutsideIgnoreFor}}">\n\t<object-add-typeahead>\n\t\t<lui-popover-header>\n\t\t\t<div class="lui-input-group">\n\t\t\t\t<input class="lui-input  lui-input-group__item  lui-input-group__input" type="text" name="new-dimension" autocomplete="off" ng-model="search.term" tid="add-dimension-input" qva-focus="autoFocus"\n\t\t\t\t\t   object-add-typeahead-input on-escape="onEscape($event)" on-enter="onEnter($event)" maxlength="255"/>\n\t\t\t\t<button ng-if="allowExpressionEditor !== false" class="lui-button  lui-input-group__item  lui-input-group__button" qva-activate="close()"\n\t\t\t\t\t\tpp-expression-editor="search.term" pp-expression-editor-on-apply="addFieldDimension({value:value})" expression-type="dimension"\n\t\t\t\t\t\tq-title-translation="Tooltip.OpenExpressionEditor">\n\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--expression  edit-expression"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</lui-popover-header>\n\t\t<div class="object-add-popover-content" object-add-typeahead-menu>\n\t\t\t<div class="object-add-popover-list-header" ng-if="dimensions.length" q-translation="Common.Dimensions"></div>\n\t\t\t<ul class="lui-list">\n\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="dimension in dimensions" tid="dimension-item"\n\t\t\t\t\tobject-add-typeahead-item="dimension" on-select="addLibraryDimension(dimension)">\n\t\t\t\t\t<span ng-if="dimension.isDrillDown" class="lui-icon lui-icon--select-alternative lui-list__aside" q-title-translation="Tooltip.dimensions.drilldown"></span>\n\t\t\t\t\t<span qve-highlight text="{{dimension.label}}" title="{{dimension.label}}" query="search.term" class="lui-list__text lui-list__text--ellipsis"></span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t<div class="object-add-popover-list-header" ng-if="fields.length" q-translation="Common.Fields"></div>\n\t\t\t<ul class="lui-list">\n\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="field in fields" tid="field-item"\n\t\t\t\t\tobject-add-typeahead-item="field" on-select="addFieldDimension(field)"\n\t\t\t\t\tng-class="{\'derived-field\': (field.isDerived && search.term === \'\')}">\n\t\t\t\t\t<i ng-if="isDirectDiscoveryField( field )" class="icon-directdiscovery lui-list__aside" q-title-translation="{{ getDirectDiscoveryTypeTranslationKey( field.qTags ) }}"></i>\n\t\t\t\t\t<span ng-if="field.isDateField" class="lui-icon lui-list__aside  lui-icon--calendar"></span>\n\t\t\t\t\t<span ng-if="field.isGeoField" class="lui-icon lui-list__aside  lui-icon--map"></span>\n\t\t\t\t\t<span qve-highlight text="{{getFieldDisplayName(field)}}" title="{{field.toolTip}}" query="search.term" class="lui-list__text lui-list__text--ellipsis"></span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t<div class="object-add-popover-nohits" ng-if="!dimensions.length && !fields.length" q-translation="Toolbox.Search.Nohits"></div>\n\t\t</div>\n\t</object-add-typeahead>\n</lui-popover>\n'}),define("objects.add-popovers/add-dimension-popover",["core.utils/deferred","general.utils/string-normalization","general.utils/array-util","general.utils/support","objects.utils/data-properties/library-utils","text!objects.add-popovers/add-dimension-popover.ng.html","client.assets/tab-contents/fields/assets-directdiscovery-service","client.assets/tab-contents/fields/derived-field-formatter-service","objects.add-popovers/object-add-typeahead"],function(a,b,c,d,e,f,g,h){"use strict";function i(a,c){return""===c?a:a.filter(function(a){return void 0!==a.value&&b.string(a.value.toLowerCase()).indexOf(b.string(c.toLowerCase()))>-1})}var j=100;return{template:f,controller:["$scope",function(b){b.search={term:""},b.isDirectDiscoveryField=g.isDirectDiscoveryField,b.getDirectDiscoveryTypeTranslationKey=g.getTypeTranslationKey,b.autoFocus=d.treatAsDesktop(),b.position||(b.position="right"),b.onEscape=function(a){""!==b.search.term?(a.stopPropagation(),b.search.term=""):b.close()},b.onEnter=function(a){""!==b.search.term?(a.stopPropagation(),b.addFieldDimension({value:b.search.term})):b.close()},b.getFieldDisplayName=function(a){return""===b.search.term?a.label:h.trimAutoCalendarName(a.value)};var f=null;b.$watch("search.term",function(d){function g(){var a=i(f.fields,d),e=i(f.dimensions,d);e.length>j?(e=c.limit(e,j),a=[]):a.length+e.length>j&&(a=c.limit(a,j-e.length)),b.fields=a,b.dimensions=e}f?g():a.all({fields:e.getSortedFields(b.app),dimensions:e.getSortedDimensions(b.app)}).then(function(a){var b=a.fields.map(function(a){var b=a.isDerived&&""===d?a.qName.substring(a.qName.lastIndexOf(".")+1,a.qName.length):a.qName;return{toolTip:a.qName,label:b,value:a.qName,trimmedValue:a.displayName,qTags:a.qTags,isDerived:a.isDerived,isDateField:a.isDateField,isGeoField:a.isGeoField}}),c=a.dimensions.map(function(a){return{label:a.qData.title,value:a.qData.title,libraryId:a.qInfo.qId,isDrillDown:"H"===a.qData.grouping}});f={fields:b,dimensions:c},g()})})}],scope:{alignTo:"=",app:"=",addFieldDimension:"=",addLibraryDimension:"=",qvaOutsideIgnoreFor:"=",close:"=",position:"=",allowExpressionEditor:"@"}}}),define("text!objects.add-popovers/add-measure-popover.ng.html",[],function(){return'<lui-popover class="add-popover-wrapper" style="min-width: 200px;width: 230px;" align-to="alignTo" position="position" collision="\'flipfit\'" on-close-view="closeAddPopover(event)" qva-outside-ignore-for="{{qvaOutsideIgnoreFor}}">\n\t<div ng-show="!step2">\n\t\t<object-add-typeahead>\n\t\t\t<lui-popover-header>\n\t\t\t\t\t<div class="lui-input-group">\n\t\t\t\t\t\t<input class="lui-input  lui-input-group__item  lui-input-group__input" type="text" name="new-measure" autocomplete="off" ng-model="search.term" tid="add-measure-input" qva-focus="autoFocus"\n\t\t\t\t\t\t\t   maxlength="255" object-add-typeahead-input on-escape="onEscape($event)" on-enter="onEnter($event)"/>\n\n\t\t\t\t\t\t<button ng-if="allowExpressionEditor !== false" class="lui-button  lui-input-group__item  lui-input-group__button" qva-activate="close()"\n\t\t\t\t\t\t\t\tpp-expression-editor="search.term" pp-expression-editor-on-apply="addExpressionMeasure({value:value})" expression-type="measure"\n\t\t\t\t\t\t\t\tq-title-translation="Tooltip.OpenExpressionEditor">\n\t\t\t\t\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--expression  edit-expression"></span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t</lui-popover-header>\n\t\t\t<div class="object-add-popover-content" object-add-typeahead-menu>\n\t\t\t\t<div class="object-add-popover-list-header" ng-if="measures.length" q-translation="Common.Measures"></div>\n\t\t\t\t<ul class="lui-list">\n\t\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="measure in measures" tid="measure-item"\n\t\t\t\t\t\tobject-add-typeahead-item="measure" on-select="addLibraryMeasure(measure)">\n\t\t\t\t\t\t<span qve-highlight text="{{measure.value}}" title="{{measure.value}}" query="search.term" class="lui-list__text lui-list__text--ellipsis"></span>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t\t<div class="object-add-popover-list-header" ng-if="fields.length" q-translation="Visualization.Requirements.FromField"></div>\n\t\t\t\t<ul class="lui-list">\n\t\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="field in fields" tid="field-item"\n\t\t\t\t\t\tobject-add-typeahead-item="field" on-select="showFromField(field)"\n\t\t\t\t\t\tng-class="{\'derived-field\': (field.isDerived && search.term === \'\')}"\t>\n\t\t\t\t\t\t<i ng-if="isDirectDiscoveryField( field )" class="icon-directdiscovery lui-list__aside" q-title-translation="{{ getDirectDiscoveryTypeTranslationKey( field.qTags ) }}"></i>\n\t\t\t\t\t\t<span ng-if="field.isGeoField" class="lui-icon lui-icon--map lui-list__aside"></span>\n\t\t\t\t\t\t<span ng-if="field.isDateField" class="lui-icon lui-icon--calendar lui-list__aside"></span>\n\t\t\t\t\t\t<span qve-highlight text="{{getFieldDisplayName(field)}}" title="{{field.toolTip}}" query="search.term" class="lui-list__text lui-list__text--ellipsis"></span>\n\t\t\t\t\t\t<i class="object-add-popover-toogle-step2-icon  lui-list__aside lui-icon  lui-icon--triangle-right"></i>\n\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t\t<div class="object-add-popover-nohits" ng-if="!measures.length && !fields.length" q-translation="Toolbox.Search.Nohits"></div>\n\t\t\t</div>\n\t\t</object-add-typeahead>\n\t</div>\n\t<div class="object-add-popover back" ng-show="step2">\n\t\t<div class="object-add-popover-header">\n\t\t\t<div qva-activate="goBack($event);">\n\t\t\t\t<i class="object-add-popover-back-icon  lui-icon  lui-icon--triangle-left"></i>\n\t\t\t\t<span q-translation="Visualization.Requirements.Back"></span>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="object-add-popover-content">\n\t\t\t<div class="object-add-popover-list-header" q-translation="Visualization.Requirements.Aggregation"></div>\n\t\t\t<ul class="lui-list">\n\t\t\t\t<li class="lui-list__item lui-list__action" ng-repeat="suggestion in fieldSuggestions" qva-activate="addFromField(suggestion)" tid="from-field-item">\n\t\t\t\t\t<span class="lui-list__text lui-list__text--ellipsis" title="{{suggestion.aggregation}}({{suggestion.field}})">{{suggestion.aggregation}}({{suggestion.field}})</span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n</lui-popover>\n'}),define("objects.add-popovers/add-measure-popover",["core.utils/deferred","general.utils/string-normalization","util","general.utils/array-util","general.utils/support","objects.utils/data-properties/library-utils","text!objects.add-popovers/add-measure-popover.ng.html","client.assets/tab-contents/fields/assets-directdiscovery-service","client.assets/tab-contents/fields/derived-field-formatter-service","objects.add-popovers/object-add-typeahead"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(a,c){return""===c?a:a.filter(function(a){return void 0!==a.value&&b.string(a.value.toLowerCase()).indexOf(b.string(c.toLowerCase()))>-1})}var k=100;return{template:g,controller:["$scope",function(b){b.search={term:""},b.isDirectDiscoveryField=h.isDirectDiscoveryField,b.getDirectDiscoveryTypeTranslationKey=h.getTypeTranslationKey,b.autoFocus=e.treatAsDesktop(),b.position||(b.position="right"),b.onEscape=function(a){""!==b.search.term?(a.stopPropagation(),b.search.term=""):b.close()},b.onEnter=function(a){""!==b.search.term?(a.stopPropagation(),b.addExpressionMeasure({value:b.search.term})):b.close()},b.showFromField=function(a){b.currentField=a,b.step2=!0},b.goBack=function(a){a.preventDefault(),b.currentField=null,b.step2=!1},b.$watch("currentField",function(a){b.fieldSuggestions=a?["Sum","Count","Avg","Min","Max"].map(function(a){return{aggregation:a,field:c.escapeField(b.currentField.value)}}):[]}),b.addFromField=function(a){var c=a.aggregation+"("+a.field+")";b.addExpressionMeasure({value:c})},b.getFieldDisplayName=function(a){return""===b.search.term?a.label:i.trimAutoCalendarName(a.value)};var g=null;b.$watch("search.term",function(c){function e(){var a=j(g.measures,c),e=j(g.fields,c);a.length>k?(a=d.limit(a,k),e=[]):a.length+e.length>k&&(e=d.limit(e,k-a.length)),b.fields=e,b.measures=a}g?e():a.all({fields:f.getSortedFields(b.app),measures:f.getSortedMeasures(b.app)}).then(function(a){var b=a.fields.map(function(a){var b=a.isDerived&&""===c?a.qName.substring(a.qName.lastIndexOf(".")+1,a.qName.length):a.qName;return{toolTip:a.qName,value:a.qName,trimmedValue:a.displayName,label:b,field:a.qName,qTags:a.qTags,isDerived:a.isDerived,isDateField:a.isDateField,isGeoField:a.isGeoField}}),d=a.measures.map(function(a){return{value:a.qData.title,label:a.qData.title,libraryId:a.qInfo.qId}});g={fields:b,measures:d},e()})})}],scope:{alignTo:"=",app:"=",addExpressionMeasure:"=",addLibraryMeasure:"=",close:"=",qvaOutsideIgnoreFor:"=",position:"=",allowExpressionEditor:"@"}}}),define("objects.requirements/requirements",["jquery","objects.utils/hypercube-util","text!./requirements.ng.html","client.utils/state","core.utils/environment","core.utils/deferred","objects.extension/base-controller","objects.error-handling/error-translation","core.utils/resize","objects.add-popovers/add-dimension-popover","objects.add-popovers/add-measure-popover"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function l(a){var b,c=new Array(a);for(b=0;b<a;++b)c[b]={index:b};return c}function m(a,c){if(a.layers&&a.layers[0]){var d=a.layers[0],e=d.qHyperCube.qDimensionInfo;return"point"===d.type?e[1].qError&&e[1].qError.qErrorCode?[e[1]]:[e[0]]:a.layers[0].qHyperCube.qDimensionInfo||[]}var f=b.getHyperCube(a,c);if(f)return f.qDimensionInfo||[];if(a.qChildList){return(a.qChildList.qItems||[]).map(function(){return{}})}return a.qListObject&&a.qListObject.qDimensionInfo?[a.qListObject.qDimensionInfo]:[]}function n(a,c){var d=b.getHyperCube(a,c);return d?d.qMeasureInfo||[]:[]}function o(a){var b=a&&a.substring(5),c="lui-icon lui-icon--";switch(b){case"bar-chart-vertical":return c.concat("bar-chart");case"components":return c.concat("scatter-chart");case"text-image":return c.concat("text");default:return c.concat(b)}}function p(a){a.showAdd=e.inClient()?d.isInEditMode()&&!a.object.isReadonly:!a.object.isReadonly}var q=null,r=g.extend({$scope:null,init:function(b,c){function e(){p(b)}function f(a){return b.object.ext.addFieldDimension(a,b.object).then(function(){m()})}function g(a){return b.object.ext.addLibraryDimension(a,b.object).then(function(){m()})}function h(a){return b.object.ext.addLibraryMeasure(a,b.object).then(function(){m()})}function l(a){return b.object.ext.addExpressionMeasure(a,b.object).then(function(){m()})}function m(b){n&&(n.close(),n=null),q&&(q.active=!1),b&&!a(b.target).hasClass("add-button")&&(q=null)}this.$scope=b,this.$scope.hyperCubePath=b.object.ext.options.hyperCubePath,d.StateChanged.bind(e),b.$on("$destroy",function(){d.StateChanged.unbind(e)}),e(),b.removeDimension=function(a){b.object.model.getProperties().then(function(c){var d=b.object.getCreatePropertyHandler();d.setProperties(c),d.removeDimension(a).then(function(){b.object.model.setProperties(c)})})},b.removeMeasure=function(a){b.object.model.getProperties().then(function(c){var d=b.object.getCreatePropertyHandler();d.setProperties(c),d.removeMeasure(a).then(function(){b.object.model.setProperties(c)})})};var n;b.showAddDimension=function(d,e){if(q&&q===e)return n&&n.close(),n=null,void(q=null);var h,i=b.ext.addDimensionPopoverComponent||j;n=c.show({template:i.template,controller:i.controller,input:{app:b.object.model.app,closeAddPopover:m,addFieldDimension:f,addLibraryDimension:g},alignTo:d.target,closeOnEscape:!0,outsideIgnore:".add-button",dock:"right"}),n.closing.then(function(b){h=b,b&&!a(b.target).hasClass("add-button")&&(q=null)}),n.closed.then(function(){n=null,e.active=!1,h||(q=null)}),e.active=!0,q=e},b.showAddMeasure=function(d,e){if(q&&q===e)return n&&n.close(),n=null,void(q=null);var f,g=b.ext.addMeasurePopoverComponent||k;n=c.show({template:g.template,controller:g.controller,input:{app:b.object.model.app,closeAddPopover:m,addLibraryMeasure:h,addExpressionMeasure:l},alignTo:d.target,closeOnEscape:!0,dock:"right",outsideIgnore:'[tid="add-measure"]'}),n.closing.then(function(b){f=b,b&&!a(b.target).hasClass("add-button")&&(q=null)}),n.closed.then(function(){n=null,e.active=!1,f||(q=null)}),e.active=!0,q=e},i.on("start",m),b.$on("$destroy",function(){i.off("start",m),m()})},onPaint:function(){var a,b,c,d=this.$scope,e=d.layout,g=d.ext.dimensionDefinition?d.ext.dimensionDefinition.min:0,i=d.ext.dimensionDefinition?d.ext.dimensionDefinition.max:0,j=d.ext.measureDefinition?d.ext.measureDefinition.min:0,k=d.ext.measureDefinition?d.ext.measureDefinition.max:0;return p(d),d.iconClass=o(d.object.ext.libraryInfo.templateIconClassName),d.minDimensions=g,d.minMeasures=j,d.maxDimensions=i,d.maxMeasures=k,d.type!==d.object.type.type&&(c=d.object.getCreatePropertyHandler(),d.canRemoveDim=!!c.removeDimension,d.type=d.object.type.type),d.headerStr=g!==i||j!==k?"Visualization.Requirements.AddAtLeast":"Visualization.Requirements.Add",a=m(e,d.hyperCubePath).map(function(a){var b,c=a.qError&&a.qError.qErrorCode;return b=c?h.getDimensionError(c):a.title||a.qFallbackTitle,{invalid:!!c,title:b}}),b=n(e,d.hyperCubePath).map(function(a){var b,c=a.qError&&a.qError.qErrorCode;return b=c?h.getMeasureError(c):a.qFallbackTitle,{invalid:!!c,title:b}}),d.finishedDimensions=a,d.finishedMeasures=b,d.unfinishedDimensions=l(Math.max(0,d.minDimensions-d.finishedDimensions.length)),d.unfinishedMeasures=l(Math.max(0,d.minMeasures-d.finishedMeasures.length)),d.show=!0,f.resolve()}});return r.$inject=["$scope","luiPopover"],{template:c,controller:r}}),define("text!objects.error-handling/error-info-popup.ng.html",[],function(){return'<immidiate-contextual align-to="alignTo" width="200" position="\'top\'" collision="\'flipfit\'" class="qui-immidiateContextual" on-close-view="onClose(event)">\n\t<div class="object-error-popup">\n\t\t<!--<div class="object-error-title" q-translation="{{error.title}}"></div>-->\n\t\t<div class="object-error-message">{{error.message}}</div>\n\t</div>\n</immidiate-contextual>'}),define("objects.error-handling/error-info-popup",["text!objects.error-handling/error-info-popup.ng.html","core.utils/resize"],function(a,b){"use strict";return{template:a,controller:["$scope",function(a){function c(){a.onClose()}a.$on("$destroy",function(){b.off("start",c)}),b.on("start",c)}]}}),define("text!objects.error-handling/error.ng.html",[],function(){return'<div qv-errorhandler class="object-error" ng-class="error.class" tid="object.Error">\n\t<div class="object-error-content">\n\t\t<div class="object-error-title">\n\t\t\t<span>{{error.title}}</span>\n\t\t\t<i class="object-error-more icon-info" qva-activate="showMore($event)"></i>\n\t\t</div>\n\t\t<div ng-if="error.message" class="object-error-message">{{error.message}}</div>\n\t</div>\n</div>\n'}),define("objects.error-handling/error-handler",["angular","touche","translator","core.utils/deferred","./error-info-popup","text!./error.ng.html","objects.extension/base-controller","objects.error-handling/error-translation","autogenerated/qix/engine-enums"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(a){return a.qErrorCode===i.NxLocalizedErrorCode.LOCERR_CALC_EVAL_CONDITION_FAILED}function k(a,b){var c={holder:null,type:""},d=b&&a[b]?a[b].qHyperCube:a.qHyperCube;return d&&d.qError?(c.holder=d,c.errorTranslationFunc=h.getHyperCubeError):a.layers&&a.layers.length&&a.layers[0].qHyperCube?(a.layers[0].qHyperCube.qError?c.holder=a.layers[0].qHyperCube:a.layers[0].geodata.qHyperCube.qError&&(c.holder=a.layers[0].geodata.qHyperCube),c.errorTranslationFunc=h.getHyperCubeError):a.qListObject&&a.qListObject.qError?(c.holder=a.qListObject,c.errorTranslationFunc=h.getListObjectError):a.qListObject.qDimensionInfo&&a.qListObject.qDimensionInfo.qError.qErrorCode&&(c.holder=a.qListObject.qDimensionInfo,c.errorTranslationFunc=h.getDimensionError),c}function l(a){switch(a.qError.qErrorCode){case i.NxLocalizedErrorCode.LOCERR_CALC_EVAL_CONDITION_FAILED:return a.customErrorMessage?a.customErrorMessage.calcCond:""}}var m=g.extend({$scope:null,init:function(c){this.$scope=c,c.hasSoftError=!1,c.hasHardError=!1,c.showMore=function(d){var f=a.element("<div>").appendTo("body");f.showComponent(e,{alignTo:a.element(d.target),error:c.error,onClose:function(){f.remove(),b.preventGestures()}})}},onPaint:function(){var a,b=this.$scope,e=b.object.error;if(!e){var f=b.layout,g=b.object.ext&&b.object.ext.options?b.object.ext.options.hyperCubePath:"",h=k(f,g);h.holder&&(a=l(h.holder)||h.errorTranslationFunc(h.holder.qError.qErrorCode),e=j(h.holder.qError)?{class:"soft-error",message:a}:{class:"hard-error",title:c.get("Object.Error"),message:a})}return b.error=e,d.resolve()}});return m.$inject=["$scope"],{template:f,controller:m}}),define("objects.utils/data-properties/empty-handler",["./data-property-handler","util"],function(a){"use strict";return a.extend({getDimensions:function(){return[]},getMeasures:function(){return[]}})}),define("text!objects.error-handling/invalid-type.ng.html",[],function(){return'<div class="object-error hard-error" tid="object.Error">\n\t<div class="object-error-content">\n\t\t<div class="object-error-title">\n\t\t\t<span>{{error.title}}</span>\n\t\t\t<i class="object-error-more icon-info" qva-activate="showMore($event)"></i>\n\t\t</div>\n\t\t<div ng-if="error.message" class="object-error-message">{{error.message}}</div>\n\t\t<button ng-if="showButton" class="lui-button object-error-remove" qva-activate="remove($event)" q-translation="Common.Delete"></button>\n\t</div>\n</div>\n'}),define("objects.error-handling/invalid-type",["angular","touche","translator","objects.utils/data-properties/empty-handler","./error-info-popup","text!objects.error-handling/invalid-type.ng.html"],function(a,b,c,d,e,f){"use strict";return{type:"invalid",template:f,definition:{type:"items",items:{}},support:{exportData:!1},getContextMenu:function(){},hasError:function(){return!1},showRequirements:function(){return!1},getCreatePropertyHandler:function(a){return new d({app:a})},getDropFieldOptions:function(){},getDropDimensionOptions:function(){},getDropMeasureOptions:function(){},controller:["$scope",function(d){var f,g=d.object.error,h=c.get(g.title);f=Array.isArray(g.message)?c.get(g.message[0],g.message.slice(1)):c.get(g.message),d.error={title:h,message:f},d.showButton=d.options&&"function"==typeof d.options.removeIt,d.remove=function(a){d.options.removeIt(),a.stopPropagation()},d.showMore=function(c){var f=a.element("<div>").appendTo("body");f.showComponent(e,{alignTo:a.element(c.target),error:d.error,onClose:function(){f.remove(),b.preventGestures()}})}}]}}),define("objects.utils/resize",["pubsub"],function(a){function b(b){b=b||{},a.publish("/ui/object/resize",b)}["/resize/end","/ui/panel/toggle","/ui/grid/cellswap","/ui/grid/cellresize","/ui/grid/cellsplitting","/ui/grid/zoom/activated","/ui/grid/zoom/deactivated"].forEach(function(c){a.subscribe(c,b)})}),define("text!client.views/selection-toolbar/selection-toolbar.ng.html",[],function(){return'<div qva-direction class="qv-selection-toolbar qvt-selection-toolbar"\n\t ng-style="toolbar.style"\n\t ng-class="{ \'sel-toolbar-card\': !options.isPopover, \'sel-toolbar-popover\': options.isPopover, \'sel-toolbar-click-to-unlock-bg\': locked, \'sel-toolbar-menu-item\': locked }"\n\t qva-activate="locked && toggleLock($event);">\n    <div class="sel-toolbar-list-wrapper">\n\t\t<table class="sel-toolbar-list">\n            <tr>\n                <td class="sel-toolbar-list-item" ng-class="{ \'sel-toolbar-list-item-hide-more\': filteredMenuButtons.length === 0 }">\n                    <button tid="selection-toolbar.toggleShowMenu"\n                            class="sel-toolbar-btn sel-toolbar-icon sel-toolbar-icon-toggle"\n                            ng-class="{ \'menu-active\': toolbar.showMenu }"\n                            q-title-translation="{{toolbar.showMenu ? \'Tooltip.CloseSelectionMenu\' : \'Tooltip.SelectionMenu\'}}"\n                            qva-activate="toggleShowMenu($event)">\n                        <span class="lui-icon  lui-icon--more"></span>\n                    </button>\n                </td>\n                <td ng-if="toolbar.showLock || locked" class="sel-toolbar-list-item sel-toolbar-list-item-lockunlock">\n                    <button tid="selection-toolbar.lock"\n                            class="sel-toolbar-btn sel-toolbar-icon"\n                            q-title-translation="{{locked ? \'SelectionToolbar.ClickToUnlock\' : \'SelectionToolbar.ClickToLock\'}}"\n                            ng-disabled="locked ? false : !toolbar.backendApi.hasSelections()"\n                            qva-activate="!locked && toggleLock($event);">\n                        <span class="lui-icon sel-toolbar-span-icon" ng-class="!locked ? \'lui-icon--unlock\':\'lui-icon--lock sel-toolbar-menu-span-icon\'"></span>\n                    </button>\n                </td>\n                <td ng-show="locked" class="sel-toolbar-list-item-locked">\n                    <p class="sel-toolbar-menu-text" q-translation="SelectionToolbar.ClickToUnlock"></p>\n                </td>\n                <td ng-show="locked && options.smallDevice" qva-activate="toolbar.selectionsApi.confirm()" class="sel-toolbar-list-item-close">\n                    <qui-toolbarbutton>\n                        <span class="sel-toolbar-menu-text sel-toolbar-btn-close-text" q-translation="Common.Close"></span>\n                    </qui-toolbarbutton>\n                </td>\n                <td ng-show="!locked" ng-repeat="button in filteredButtons" class="sel-toolbar-list-item" ng-class="button.clazz">\n                    <button tid="{{button.tid}}"\n                            qva-activate="buttonAction($event, button)"\n                            q-title-translation="{{button.name}}"\n                            ng-disabled="buttonIsDisabled(button)"\n                            class="sel-toolbar-btn"\n                            ng-class="[button.buttonClass, button.isIcon ? \'sel-toolbar-icon\' : \'\', button.isActive(this) ? \'menu-active\' : \'\']">\n                        <span class="sel-toolbar-span-icon lui-icon" ng-class="button.iconClass"></span>\n                    </button>\n                </td>\n            </tr>\n        </table>\n\n    </div>\n\t<div ng-if="toolbar.showMenu" class="sel-toolbar-menu" ng-style="toolbar.menuStyle"\n\t\t qva-delegated-activate="div:not(.disabled)#menuAction($event);">\n\t\t<div ng-repeat="button in filteredMenuButtons" class="sel-toolbar-menu-item"\n\t\t\t tid="{{button.tid}}"\n\t\t\t q-title-translation="{{button.name}}"\n\t\t\t ng-class="{\'disabled\': buttonIsDisabled(button) }">\n\t\t\t<table class="sel-toolbar-menu-table" ng-class="{ \'selection-toolbar-menu-table-align-center\': filteredButtons.length === 0 }">\n\t\t\t\t<tr>\n\t\t\t\t\t<td><span class="sel-toolbar-menu-span-icon" ng-class="button.iconClass"></span></td>\n\t\t\t\t\t<td ng-if="filteredButtons.length !== 0"><p class="sel-toolbar-menu-text" q-translation="{{button.name}}"></p></td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</div>\n\t</div>\n</div>\n'}),define("client.views/selection-toolbar/selection-toolbar",["jquery","qvangular","text!./selection-toolbar.ng.html","core.utils/deferred"],function(a,b,c,d){"use strict";var e,f=44,g=1,h=8,i=2;return b.componentDirective("qvaIncludeSelectionToolbar",{toolbar:"=",options:"="}),e={width:0,buttons:[],haveButtons:function(){return this.buttons.length>0},reset:function(a){this.width=a,this.buttons.length=0},freeWidth:function(){var a,b=0;for(a=0;a<this.buttons.length;a++)b+=this.buttons[a];return this.width-b}},{template:c,controller:["$scope",function(b){function c(a,c,d){var j,k,l=0;for(e.reset(a-(h+2*i)),k=c.length-1;k>=0&&(j="sel-toolbar-icon-separator"!==c[k].buttonClass?f+h:g+h)<=e.freeWidth();k--)e.buttons.push(j);for((b.toolbar.showLock||b.locked)&&(l+=f+h),(d.length>0||c.length>e.buttons.length)&&(l+=f+h);e.haveButtons()&&e.freeWidth()<l;)e.buttons.pop();return e.buttons.length}function j(){var a,d,e=[].concat(b.toolbar.buttons),f=[].concat(b.toolbar.menuButtons),g=c(b.toolbar.style.width,e,f);for(b.filteredButtons=[],b.filteredMenuButtons=[],a=0;a<g&&e.length;++a)b.filteredButtons.push(e.pop());for(b.filteredButtons.reverse();e.length;)d=e.pop(),"sel-toolbar-icon-separator"!==d.buttonClass&&b.filteredMenuButtons.push(d);for(;f.length;)b.filteredMenuButtons.push(f.shift())}function k(a){b.locked=a,b.toolbar.showMenu=!1,m.then(function(){j()})}var l=d(),m=l.promise;b.filteredButtons=[],b.filteredMenuButtons=[],b.selectionInfo={show:!1,selected:0,total:0},b.lassoEnabled=!1,this.confirm=function(){b.selectionsApi.confirm()},this.close=function(){b.destroyComponent()},b.buttonAction=function(a,c){a.originalEvent.preventDefault(),c.action.call(b.toolbar)},b.buttonIsDisabled=function(a){return"function"==typeof a.isDisabled&&a.isDisabled.call(b.toolbar)},b.menuAction=function(c){var d=a(c.target).scope();c.originalEvent.preventDefault(),d.button.action.call(b.toolbar),b.toolbar.showMenu=!b.toolbar.showMenu},b.toggleShowMenu=function(a){a.originalEvent.preventDefault(),b.toolbar.showMenu=!b.toolbar.showMenu},b.toggleLasso=function(){b.lassoEnabled=!b.lassoEnabled,b.toolbar.toggleLasso(b.lassoEnabled)},b.toggleLock=function(c){a(c.target).closest(".sel-toolbar-list-item-close").length>0||(c.originalEvent.preventDefault(),c.stopPropagation(),b.toolbar.backendApi.isLocked()?(b.toolbar.selectionsApi.selectionsMade=!0,b.toolbar.backendApi.unlock()):b.toolbar.backendApi.lock())},b.$watch("toolbar.backendApi.isLocked()",function(a){void 0!==a&&k(!!a)}),b.$watch("toolbar.position",function(a){a&&(b.toolbar.style=a,l.resolve(),k(!!b.toolbar.backendApi.isLocked&&b.toolbar.backendApi.isLocked()))}),b.$watch("toolbar.menuMaxHeight",function(a){a&&(b.toolbar.menuStyle={maxHeight:a})}),b.$watch("options.lassoEnabled",function(a){b.lassoEnabled=a})}]}}),define("client.views/selection-toolbar/selection-toolbar-service",["qvangular","client.views/selection-toolbar/selection-toolbar","util","core.utils/notification","angular"],function(a,b,c,d){"use strict";a.service("qvSelectionToolbarService",function(){function a(a,b){var c,d,e,f,g=a[0].getBoundingClientRect(),h=b[0].getBoundingClientRect();return b.is("th, td")&&(d=b.closest("table")[0].getBoundingClientRect(),c=b.prevAll(),e=c.length?c.last():b,f=e[0].getBoundingClientRect(),f.left-d.left==1)?{top:h.top-g.top,left:h.left-1-g.left,width:h.width}:{top:h.top-g.top,left:h.left-g.left,width:h.width}}var e,f,g;return e={open:function(d,e,h){var i=a(d,e),j={top:-44+i.top,width:i.width+(h.offsetWidth||0),left:i.left};h.toolbar=c.extend(!0,h.toolbar,{position:j,menuMaxHeight:h.menuMaxHeight}),f=angular.element("<div>"),g=f.showComponent(b,h),f.appendTo(d),this.Opened.emit()},close:function(){g&&(g.close(),this.Closed.emit(),g=void 0),f&&f.remove()},confirm:function(){g&&(g.confirm(),g=void 0),this.close()}},d.create(e,"Closed"),d.create(e,"Opened"),e})}),define("text!objects/throbber/throbber.ng.html",[],function(){return'<div ng-show="progress" class="qv-animate progress ng-hide">\n\t<div class="progress-loader" style="width:20%;height:20%;position:absolute;top:40%;left:40%"></div>\n</div>\n'});define("objects/throbber/throbber",["qvangular","text!./throbber.ng.html"],function(a,b){"use strict";a.directive("qvThrobber",["$timeout",function(a){return{replace:!0,template:b,restrict:"E",scope:{model:"=",progress:"=",delay:"=",disabled:"="},link:function(b){var c;b.$watch("model.isValidating",function(d){if(b.disabled===!0)return void(b.progress=!1);b.model&&void 0===b.model.state?b.progress=!0:d?(c&&a.cancel(c),c=a(function(){b.model&&b.model.isValidating&&(b.progress=!0)},b.delay||1e3)):b.progress=!1})}}}])}),define("text!general.services/loader/rain/rain.ng.html",[],function(){return'<div class="rain progress" ng-class="{\'qv-fade-out\': fadeOut}">\n\t<div class="rain-progress" ng-style="rainStyle">\n\t\t<div class="progress-div rotating" ng-class="ngClasses">\n\t\t</div>\n\t</div>\n\t<div class="qv-loader-text" ng-if="messageObj" ng-class="ngClasses">\n\t\t<div ng-show="messageObj.task" q-translation="{{messageObj.task}}"></div>\n\t\t<div ng-show="messageObj.message" q-translation="{{messageObj.message}}"></div>\n\t</div>\n</div>\n'}),define("general.services/loader/rain/rain",["qvangular","text!../rain/rain.ng.html"],function(a,b){"use strict";a.directive("qvRain",[function(){return{replace:!0,template:b,restrict:"E",scope:{show:"=",resize:"=?",messageObj:"=?"},link:function(a,b){function c(){var c=b[0].getBoundingClientRect(),d=Math.min(c.width,c.height);d*=.3,a.rainStyle.height=d+"px",a.rainStyle.width=d+"px",a.rainStyle.top=(c.height-d)/2,a.rainStyle.left=(c.width-d)/2}a.rainStyle={},a.$watch("show",function(a){void 0!==a&&a&&c()}),a.resize&&a.resize(c),c()}}}])}),
define("objects/object",["jquery","qvangular","core.utils/deferred","general.utils/visualizations","objects.utils/layout","objects.utils/type-loader","text!./object.ng.html","pubsub","general.utils/responsive-state","objects.extension/extension-type","util","translator","objects.requirements/requirements","objects.error-handling/error-handler","core.utils/resize","objects.extension/base-controller","objects.extension/default-controller","objects.utils/interaction-states","client.utils/theme/theme-module","core.utils/feature-flags","objects.error-handling/invalid-type","objects.utils/resize","client.views/selection-toolbar/selection-toolbar-service","objects/throbber/throbber","general.services/loader/rain/rain"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){"use strict";function u(a){a.selectionsApi&&a.selectionsApi.active&&a.selectionsApi.confirm()}function v(a,c){function d(){return!a.options||a.options.isVisible!==!1}function e(){u(c)}function f(){d()&&(b.$apply(a,function(){c.resize()}),c.throbberApi.resize(),c.explore.resize())}function g(){i||(i=setTimeout(function(){f(),clearTimeout(i),i=null},100))}var i;a.$on("resizeCell",function(){g()}),h.subscribe("/ui/object/resize."+a.$id,function(){g()}),o.on("start."+a.$id,e),a.$on("$destroy",function(){clearTimeout(i),h.unsubscribe("."+a.$id),o.off("start."+a.$id,e)})}function w(a,b){function c(c){a.model.isCancelled||(a.layout=c,b.setLayout(c,a.options))}function d(a){a&&(b.model&&g(b.model),f(a),b.setModel(a))}function e(){b.setRenderState(E.INVALID)}function f(d){d.Invalidated&&!d.isCancelled&&d.Invalidated.bind(e),b.subscription=a.model.layoutSubscribe(c)}function g(a){a&&a.Invalidated&&a.Invalidated.unbind(e),b.subscription&&b.subscription.dispose()}a.object._forcePaint=!0,a.$watch("model",d),a.$on("$destroy",function(){g(a.model)})}function x(a,b){if(t.THEMING){var c=F.initializeService("object."+F.getMatch(b.visualization||b.qInfo.qType));a.styles={backgroundColor:{"background-color":c.getStyle("","backgroundColor")},title:{"font-size":c.getStyle("title.main","fontSize"),color:c.getStyle("title.main","color")},subTitle:{"font-size":c.getStyle("title.subTitle","fontSize"),color:c.getStyle("title.subTitle","color")},footer:{"font-size":c.getStyle("title.footer","fontSize"),color:c.getStyle("title.footer","color"),"background-color":c.getStyle("title.footer","backgroundColor")}}}}function y(a,c,d,f){function g(){return!a.options||a.options.isVisible!==!1}var h,i,j,k,m,o;c.setObjectClass=function(b){k||(k=d.find(".qv-object")),(b||void 0===m)&&(m=k[0].clientWidth),(b||void 0===o)&&(o=k[0].clientHeight);var f=e.getLayoutMode(m,o),g=c.type&&c.type.type,h=[];c.supportSnapshot()&&h.push("qv-can-take-snapshot"),c.selectionsApi&&c.selectionsApi.active&&h.push("qv-selections-active"),c.objectSize={w:m,h:o},a.options.layoutMode=f;var i="qv-layout-"+e.getLayoutModeKey(f);h.push(i),a.objectClass="qv-object-"+g,h.push(a.objectClass),c.selectionClass&&h.push(c.selectionClass),a.classList=h,a.wrapperClassList=[],a.object&&a.object.hasFrame&&a.object.showTitles&&a.layout.footnote&&a.wrapperClassList.push("has-footnote"),a.thinHeader=!c.showTitles||""===a.layout.title&&""===a.layout.subtitle&&!c._inEditState},c.update=function(){if(this.valid){x(a,a.layout);var d=this;h=b.getService("$timeout")(function(){c.backendApi&&c.backendApi.updateCache(a.layout),c.setObjectClass(),a.$digest(),d.loadContent(),f.contentLoaded().then(function(b){try{return b.onPaint(a.layout,{visible:g()}).then(function(){c.setRenderState(E.RENDERED),"function"==typeof a.options.onRendered&&a.options.onRendered.call(null)}).catch(function(){c.setRenderState(E.INVALID),"function"==typeof a.options.onRendered&&a.options.onRendered.call(null)})}catch(b){throw c.setRenderState(E.INVALID),c.error={class:"hard-error",title:l.get("Object.Error"),message:l.get("Object.ErrorMessage.RenderingFailed",c.ext&&c.ext.type)},f.updateContent(n).then(function(d){d.onPaint(a.layout,{visible:!1}).then(function(){c.setRenderState(E.RENDERED),"function"==typeof a.options.onRendered&&a.options.onRendered.call(null,b)})}),b}})})}},c.resize=function(){g()&&(c.setRenderState(E.INVALID),i=b.getService("$timeout")(function(){c.setObjectClass(!0),f.contentLoaded().then(function(b){b.onResize(a.layout).then(function(){c.setRenderState(E.RENDERED)})})}))},c.onResize=function(){f.contentLoaded().then(function(b){b.onResize(a.layout).then(function(){c.setRenderState(E.RENDERED)})})},a.$on("$destroy",function(){var a=b.getService("$timeout");a.cancel(h),a.cancel(i),j&&j.reject()})}function z(a,e,f,g){var h,i=c();f.loaded=i.promise,f.valid=!1,f.showExploreMenu=!1,f.loadContent=function(){var b,c={options:a.options,object:f,layout:a.layout,ext:f.ext};b=f.ext.hasError(c)?n:f.ext.showRequirements(c)?m:f.ext,g.updateContent(b)},f.reset=function(){this.valid&&(a.options=k.extend({},a.resetOptions,{isZoomed:a.options.isZoomed,interactionState:a.options.interactionState,direction:a.options.direction}),i=c(),this.loaded=i.promise,this.valid=!1)},f.validate=function(){this.valid||this.layout&&this.type&&this.ext&&(this.valid=!0,i.resolve())},f.setExtension=function(b){this.ext=b,a.ext=b,"invalid"!==b.type&&(b.mapProperties(this.model),b.mapSoftProperties(),this.setBackendApi()),this.validate(),this.update(),this.ext.model=this.model},f.setBackendApi=function(){var b=a.options.APIType||this.ext.BackendApi,c=this.backendApi=new b(this.model);g.contentLoaded().then(function(a){a.setBackendApi(c)})},f.setType=function(c,d){this.backendApi&&this.backendApi.destroy(),this.ext=null,this.backendApi=null,this.hasContent=!1,this.type=c,c.load().then(function(h){function i(){f.setExtension(h),A(a,e,f),d&&(b.$rootScope.$broadcast("refreshPropertyPanel"),b.$rootScope.$broadcast("reloadExploreContent"))}if(f.type===c)if(c!==D&&(f.error=null),"function"==typeof h.init){var j=h.init.call(null,e,f.layout);j&&"function"==typeof j.then?j.then(function(){i()},function(b){f.setRenderState(E.INVALID),f.error={class:"hard-error",title:l.get("Object.Invalid.Title"),message:b||l.get("Object.ErrorMessage.RenderingFailed",h.type)},g.updateContent(n).then(function(c){c.onPaint(a.layout,{visible:!1}).then(function(){f.setRenderState(E.RENDERED),"function"==typeof a.options.onRendered&&a.options.onRendered.call(null,b)})}),i()}):i()}else i()},function(){f.setType(D),f.error={class:"hard-error",title:l.get("Object.Invalid.Title"),message:l.get("Object.ErrorMessage.NotFound",c.type)},f.isInvalid=!0,f.setObjectClass()})},f.setModel=function(a){this.model=a,this.ext&&(this.ext.model=a,this.setBackendApi())},f.on=function(){g.contentLoaded().then(function(a){a.view&&a.view.on()})},f.off=function(){g.contentLoaded().then(function(a){a.view&&a.view.off()})},f.isOn=function(){return g.contentLoaded().then(function(a){return a.view?a.view.isOn():null})},f.setInteractionState=function(c){f._interactionState=c,f._inEditState=c===r.EDIT,f._inAnalysisState=c===r.ANALYSIS,a.options.interactionState=c,g.contentLoaded().then(function(a){c!==r.ANALYSIS&&u(f),a.setInteractionState(c),b.getService("$timeout").cancel(h),h=b.getService("$timeout")(function(){f.setObjectClass()})})},f.getInteractionState=function(){return f._interactionState},f.inAnalysisState=function(){return f._inAnalysisState},f.inEditState=function(){return f._inEditState},f.setFreeResize=function(b){a.options.freeResize=b,g.contentLoaded().then(function(a){a.setFreeResize(b)})},f.setDirection=function(b){b&&a.options.direction!==b&&(a.options.direction=b,g.contentLoaded().then(function(a){a.setDirection(b),f.update()}))},f.setLayout=function(a){this.layout=a;var b=a.visualization||a.qInfo.qType,c=d.getType(b);a.qError&&(c=D,this.error={title:"Object.Error",message:"Object.Invalid.Info"}),c||(c=D,this.error={title:"Object.Invalid.Title",message:["Object.ErrorMessage.NotFound",b]}),(this.ext&&this.ext.hasNewType&&this.ext.hasNewType(this,c,a)||this.type!==c)&&(this.reset(),this.setType(c,!!this.type)),this.isInvalid=c===D,this.isLink=!this.isInvalid&&!!a.qExtendsId,this.showTitles=a.showTitles!==!1,this.validate(),this.update()}}function A(c,d,e){function f(b){var c=a(b.target);e.selectionsApi.ignoreOnOutside(c)||(e.selectionsApi.getDockToElement().off(".object"),e.selectionsApi.confirm())}function g(){return e.backendApi&&e.backendApi.endSelections(!0),null}e.activateSelections=function(){void 0!==e.ext.options.selections&&e.inAnalysisState()&&e.selectionsApi.activate()},e.selectionsApi&&"function"==typeof e.selectionsApi.destroy&&e.selectionsApi.destroy(),e.tooltipApi={cancel:function(){},destroy:function(){}},e.selectionsApi={destroy:function(){this._activatedCallbacks=[],this._deactivatedCallbacks=[],a(window).off("onbeforeunload",g)},active:!1,selectionsMade:!1,_activatedCallbacks:[],_deactivatedCallbacks:[],on:function(){},off:function(){},ignoreOnOutside:function(a){return!(!a.closest(".qv-selection-toolbar").length&&!a.closest(".selections-data-area-ui").length)},getDockToElement:function(){return i.isSmallDevice?d:d.children(".qv-object")},getMenuMaxHeight:function(){return e.selectionsApi.getDockToElement().outerHeight()},getSelectionToolbarWidthOffset:function(){return 0},watchActivated:function(a){return this._activatedCallbacks.push(a),function(){var b=this._activatedCallbacks.indexOf(a);this._activatedCallbacks.splice(b,1)}.bind(this)},activated:function(h){this.active=!0,h||e.backendApi.beginSelections(),a(window).on("onbeforeunload",g),c.options.isPopover||(this.getDockToElement().on("qv-outside.object",f),b.$apply(c,function(){e.setObjectClass(),e.getSelectionToolbar().then(function(a){var f={toolbar:a,selectionsApi:e.selectionsApi,options:c.options,menuMaxHeight:e.selectionsApi.getMenuMaxHeight(),offsetWidth:e.selectionsApi.getSelectionToolbarWidthOffset()};b.getService("qvSelectionToolbarService").open(d,e.selectionsApi.getDockToElement(),f)})})),this._activatedCallbacks.forEach(function(a){a.call(this)},this)},watchDeactivated:function(a){return this._deactivatedCallbacks.push(a),function(){var b=this._deactivatedCallbacks.indexOf(a);this._deactivatedCallbacks.splice(b,1)}.bind(this)},deactivated:function(){a(window).off("onbeforeunload",g),this.active=!1,this.selectionsMade=!1,e.tooltipApi.cancel(),c.options.isPopover||(e.selectionsApi.getDockToElement().off(".object"),b.$apply(c,function(){e.setObjectClass(),b.getService("qvSelectionToolbarService").close()})),this._deactivatedCallbacks.forEach(function(a){a.call(this)},this)},confirm:function(){e.selectionsApi.deactivateSearch&&e.selectionsApi.deactivateSearch(),e.backendApi.endSelections(!0),e.tooltipApi.cancel(),this.deactivated()},cancel:function(){e.selectionsApi.deactivateSearch&&e.selectionsApi.deactivateSearch(),e.backendApi.endSelections(!1),e.tooltipApi.cancel(),this.deactivated()},clear:function(){e.backendApi.clearSelections(),e.tooltipApi.cancel(),this.selectionsMade=!1},toggleKeyboardAccelerators:function(){},getKeyAsToggleSelected:function(a){return!(a.metaKey||a.ctrlKey)},search:function(){},confirmSearch:function(){},cancelSearch:function(){},activate:function(){this.active||this.activated()}}}function B(a,c){function d(d,e){b.getService("$timeout").cancel(f),b.getService("$timeout").cancel(g),c.selectionsApi&&c.selectionsApi.active?c.throbberApi.hide():a.model&&void 0===a.model.state?c.throbberApi.show():a.model&&a.model.isCancelled?c.throbberApi.isQueryCanceled=!0:d?(f=b.getService("$timeout")(function(){a.model&&a.model.isValidating&&c.throbberApi.show()},e),g=b.getService("$timeout")(function(){c.throbberApi.isVisible===!0&&(c.throbberApi.isLongRunningQuery=!0,c.throbberApi.isQueryCanceled=!1)},8e3)):(c.throbberApi.hide(),c.throbberApi.isLongRunningQuery=!1)}var e,f,g;c.throbberApi&&"function"==typeof c.throbberApi.destroy&&c.throbberApi.destroy(),c.throbberApi={resizeCallbacks:[],isVisible:!1,isLongRunningQuery:!1,isQueryCanceled:!1,initialize:function(){e=a.$watch("model.isValidating",function(a){d(a,1e3)})},reset:function(a){d(a,0)},show:function(){c.throbberApi.isVisible=!0,c.throbberApi.isQueryCanceled=!1,c.throbberApi.isLongRunningQuery=!1},hide:function(){c.throbberApi.isVisible=!1,c.throbberApi.isLongRunningQuery=!1,b.getService("$timeout").cancel(f),b.getService("$timeout").cancel(g)},off:function(){e(),b.getService("$timeout").cancel(f),b.getService("$timeout").cancel(g)},destroy:function(){c.throbberApi.off(),c.throbberApi.resizeCallbacks.length=0},resize:function(){c.throbberApi.resizeCallbacks.forEach(function(a){a()})},watchResize:function(a){c.throbberApi.resizeCallbacks.push(a)}},c.throbberApi.initialize()}function C(a,b){b.explore={resizeCallbacks:[],resize:function(){b.explore.resizeCallbacks.forEach(function(a){a()})},watchResize:function(a){b.explore.resizeCallbacks.push(a)},unwatchResize:function(a){var c=b.explore.resizeCallbacks.indexOf(a);c!==-1&&b.explore.resizeCallbacks.splice(c,1)},destroy:function(){b.explore.resizeCallbacks=[]}}}var D=new j({type:"invalid",path:"objects.error-handling/invalid-type"}),E={INVALID:0,RENDERED:1},F=s.get();b.componentDirective("qvObjectContent",{object:"=",backendApi:"=",ext:"=",options:"=",layout:"=",selectionsApi:"=",tooltipApi:"=",throbberApi:"=",onInit:"="},null,function(a,b,c){b.onInit(a,b,c)}),b.directive("qvObject",function(){return{restrict:"E",replace:!0,template:g,scope:{options:"=",model:"=",object:"=?",navMenu:"=",snapshot:"=?"},controller:["$scope","qvDefaultViewSelectionService",function(a,b){var d=c();this.updateContent=function(b){var e=a.object;return e&&e.content!==b&&(void 0!==e.content&&(d=c()),e.content=b),d.promise},this.contentLoaded=function(){return d.promise},a.onInit=function(a,c,e){a instanceof p||(a=new(q.extend(a))(c,e,b)),d.resolve(a)}}],link:function(c,d,e,g){function h(a,b,d){var e=l&&c.ext&&!(c.model&&!c.model.isValid&&!c.model.isValidating);return b||(e=e&&a!==m),d||(e=e&&a!==n),e}function i(a){var b=c.ext&&c.ext.support[a];if("function"==typeof b)return b.call(null,c.layout);if("boolean"==typeof b)return b;throw"Unknown 'support' property name/type"+a}function j(){l.update()}var l=c.object={};c.options||(c.options={}),c.options.zoomEnabled=!!e.zoomObject,c.resetOptions=k.extend({},c.options),Object.defineProperties(l,{hasFrame:{get:function(){return!c.options.isPopover&&!l.isInvalid}},isReadonly:{get:function(){return!l||l.isLink||l.isInvalid||c.options.isReadonly}},isInteractive:{get:function(){return!!l&&c.options.interactionState!==r.STATIC}},hasSoftProperties:{get:function(){return!!this.ext&&!!this.ext.mappedSoftDefinition}}}),l.getCreatePropertyHandler=function(){var a=l.model.app;return l.ext.getCreatePropertyHandler(a)},l.getPropertyPanelContent=function(){return l.loaded.then(function(){var a=l.getCreatePropertyHandler();return{definition:l.ext.mappedDefinition||l.ext.definition,globalChangeListeners:l.ext.globalChangeListeners,type:l.type,app:l.model.app,backendApi:l.backendApi,handler:a,iconClass:l.ext.libraryInfo.templateIconClassName,titleRef:"title",ext:l.ext}})},l.getSoftPropertyContent=function(){return l.loaded.then(function(){return{definition:l.ext.mappedSoftDefinition||l.ext.softDefinition,type:l.type,backendApi:l.backendApi}})},l.toggleExploreMenu=function(a){l.showExploreMenu=void 0!==a?a:!l.showExploreMenu},l.setSnapshotData=function(a,b){return g.contentLoaded().then(function(c){return c.setSnapshotData(a,b)})},l.getViewState=function(){return g.contentLoaded().then(function(a){return a.getViewState?a.getViewState():void 0})},l.getPreferredSize=function(){return g.contentLoaded().then(function(a){var b=a.getPreferredSize();return b?b.then(function(a){var b=d.find("footer"),c=d.find("header");return{w:a.w,h:a.h+(b.height()||0)+(c.height()||0)+35+d[0].offsetTop}}):void 0})},l.getDropOptions=function(a,b){return l.loaded.then(function(){return g.contentLoaded().then(function(){return l.ext.getDropOptions(l,a,b)})})},l.getContextMenu=function(a){return g.contentLoaded().then(function(b){return b.getContextMenu(l,a)})},l.getObjectMenu=function(a){return g.contentLoaded().then(function(b){return b.getObjectMenu(l,a)})},l.getSelectionToolbar=function(){return l.loaded.then(function(){return g.contentLoaded().then(function(a){return a.getSelectionToolbar()})})},l.reloadContent=function(){c.ext=l.ext=a.extend({},l.ext),l.loadContent(),l.update()},l.canShowExploreMenu=function(){var a=this.content===m||this.content===n;return!this.isInvalid&&this.hasSoftProperties&&!a},l.supportCssScaling=function(){return h(this.content)&&i("cssScaling")},l.supportSnapshot=function(){if(!h(this.content))return!1;var a=c.ext&&c.ext.snapshot&&c.ext.snapshot.canTakeSnapshot;return void 0===a?i("snapshot"):"function"==typeof a?a.call(null,c.layout):"boolean"==typeof a&&a},l.supportObjectInfo=function(){return!!h(this.content)&&(!l.isInvalid&&this.layout.showDetails)},l.supportExportData=function(){return h(this.content,!1,!0)&&i("exportData")},l.supportExport=function(){return h(this.content)&&i("export")},l.supportSharing=function(){return h(this.content)&&i("sharing")},l.setRenderState=function(a){l&&l.renderState!==a&&(l.renderState=a,c.$emit("objectRenderStateChange",a))},z(c,d,l,g),v(c,l),y(c,l,d,g),C(c,l),l.setRenderState(E.INVALID),l._themeChangeWatcher=j,F.ThemeChanged.bind(l._themeChangeWatcher),f.load(c.options._skipRegisterExtensions).then(function(){w(c,l)}),l.loaded.then(function(){c.cancelled=c.model.isCancelled}),c.$watch("options.interactionState",function(a){var b=isNaN(a)?1:a;l.setInteractionState(b)}),c.$watch("options.direction",function(a){l.setDirection(a)}),c.$watch("options",function(a){a&&a.setController&&g.contentLoaded().then(function(){a.setController(l)})}),c.$on("childSelectionActive",function(a,b){l.childInSelection=b,a.preventDefault()}),c.titleClicked=function(){this.options._disableSelections||l._inEditState||g.contentLoaded().then(function(a){(a.view&&a.view.selections||a.$scope.interactive)&&l.activateSelections()})},c.cancel=function(){l.subscription.cancel(),l.throbberApi.hide(),l.throbberApi.isQueryCanceled=!0},c.retry=function(){l.throbberApi.hide(),l.throbberApi.reset(!0),l.throbberApi.isQueryCanceled=!1,c.model.markAsInvalid(),c.model.getLayout().then(function(a){c.layout=a,l.setLayout(a)})},B(c,l);var o=!1;c.$on("$destroy",function(){if(!o&&(o=!0,b.getService("$timeout").cancel(void 0),F.ThemeChanged.unbind(l._themeChangeWatcher),l)){u(l),l.selectionsApi&&"function"==typeof l.selectionsApi.destroy&&l.selectionsApi.destroy(),l.tooltipApi&&(l.tooltipApi.destroy&&l.tooltipApi.destroy(),l.tooltipApi=null),l.backendApi&&(l.backendApi.destroy(),l.backendApi=null),l.throbberApi&&l.throbberApi.destroy(),l.explore&&l.explore.destroy();var a=l.ext,e=l.layout;l=null,c.object=null,a&&"function"==typeof a.destroy&&a.destroy.call(null,d,e)}})}}})}),define("text!client.views/current-selections/current-selections.ng.html",[],function(){return'<div class="qv-panel-subtoolbar qv-panel-current-selections" ng-class="{smallDevice: isSmallDevice}">\n\t<div ng-if="!isSmallDevice">\n\t\t<div class="qv-selections-pager">\n\n\t\t\t<div class="buttons borderbox">\n\n\t\t\t\t<button class="qv-subtoolbar-button borderbox" qva-activate="back()" ng-disabled="disable.back" q-title-translation="Tooltip.NavigateBack">\n\t\t\t\t\t<i class="lui-icon lui-icon--selections-back"></i>\n\t\t\t\t</button>\n\n\t\t\t\t<button class="qv-subtoolbar-button borderbox" qva-activate="forward()" ng-disabled="disable.forward" q-title-translation="Tooltip.NavigateForward">\n\t\t\t\t\t<i class="lui-icon lui-icon--selections-forward"></i>\n\t\t\t\t</button>\n\n\t\t\t\t<button id="clearselections" class="qv-subtoolbar-button borderbox" ng-disabled="disable.clear" qva-activate="clearAllFields()" q-title-translation="Tooltip.ClearSelections">\n\t\t\t\t\t<i class="lui-icon lui-icon--clear-selections"></i>\n\t\t\t\t</button>\n\n\t\t\t</div>\n\t\t\t<div class="selections-shadow" ng-if="showShadow"></div>\n\t\t\t<div class="wrap borderbox" style="height: 100%;" qv-pager qv-selection-pager>\n\t\t\t\t<ul class="list" ng-show="items.length > 0 && !isGlobalSelectionsActive" qva-delegated-activate=".item#showPopover($event)" qva-outside-ignore-for="currentSelectionsItems">\n\t\t\t\t\t<li ng-repeat="item in items track by item.qField" data-csid="{{item.qField}}">\n\t\t\t\t\t\t<div class="item current-selection-elem" ng-mousemove="openTooltip($event, item)" ng-mouseleave="closeTooltip()" ng-class="{\n\t\t\t\t\'active\' : item.qField === activeFieldName,\n\t\t\t\t\'dim\' : $parent.itemSelected && !item.active,\n\t\t\t\t\'item-locked\' : item.qLocked,\n\t\t\t\t\'locked-feedback item-animate-in\' : item.feedbackActive && item.qLocked,\n\t\t\t\t\'item-animate-out\' : !item.feedbackActive && item.qLocked }">\n\t\t\t\t\t\t\t<div ng-class="{locked:item.qLocked}" class="text">\n\t\t\t\t\t\t\t\t<div class="text-wrap">\n\t\t\t\t\t\t\t\t\t<span ng-class="{ \'icon-toolbar-locked\': item.qLocked }"></span><span class="name">{{item.name}}</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<span class="values">{{item.translation}}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<span ng-class="{\n\t\t\t\t\t\t\'icon-toolbar-locked\': item.qLocked,\n\t\t\t\t\t\t\'item-animate-in\' : item.feedbackActive,\n\t\t\t\t\t\t\'item-animate-out\' : !item.feedbackActive,\n\t\t\t\t\t\t\'icon-locked-feedback\' : item.feedbackActive && item.qLocked }">\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<div class="options">\n\t\t\t\t\t\t\t\t<a ng-if="!item.qLocked && !item.isPlaceHolder" qva-activate="clear(item.qField)" class="remove" q-title-translation="CurrentSelections.Remove">\n\t\t\t\t\t\t\t\t\t<span class="lui-clear-all lui-icon lui-icon--remove"></span>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<qv-state-count-bar ng-if="!item.isPlaceHolder" state-counts="item.qStateCounts"></qv-state-count-bar>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\n\t\t\t\t<div ng-if="!items.length && !haveHiddenSelections" class="empty-text no-selection" q-translation="CurrentSelections.NoSelections"></div>\n\t\t\t\t<div ng-if="!items.length && haveHiddenSelections" class="empty-text no-selection" q-translation="CurrentSelections.OnlyHiddenSelections"></div>\n\t\t\t\t<a class="qv-pager-nav qv-pager-previous" qva-activate="prevPage()" q-title-translation="Tooltip.Previous"><i class="lui-icon lui-icon--arrow-left"></i></a>\n\t\t\t\t<a class="qv-pager-nav qv-pager-next" qva-activate="nextPage()" q-title-translation="Tooltip.Next"><i class="lui-icon lui-icon--arrow-right"></i></a>\n\t\t\t</div>\n\t\t\t<div class="buttons-end borderbox">\n\t\t\t\t<div tid="toggleGlobalSearchButton" class="qv-subtoolbar-button global-search-button borderbox" ng-class="{active: isGlobalSearchActive, indexing: isGlobalSearchIndexing}" qva-activate="toggleGlobalSearch()" q-title-translation="{{isGlobalSearchActive ? \'Tooltip.CloseGlobalSearch\' : \'Tooltip.GlobalSearch\'}}">\n\t\t\t\t\t<i class="lui-icon lui-icon--search icon"></i>\n\t\t\t\t\t<div class="label" q-translation="GlobalSearch.Preparing" q-title-translation="GlobalSearch.Preparing.Tooltip"></div>\n\t\t\t\t\t<qv-progress-bar ng-if="isGlobalSearchIndexing" percent-done="indexPercentDone" on-completed="setSearchIndexingDone()" options="progressBarOptions"></qv-progress-bar>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="qv-subtoolbar-button borderbox" ng-class="{active: isGlobalSelectionsActive}" qva-activate="toggleGlobalSelection($event)"\n\t\t\t\t\tq-title-translation="{{isGlobalSelectionsActive ? \'Tooltip.CloseGlobalSelector\' : \'Tooltip.GlobalSelector\'}}" tid="currentSelections.toggleGlobalSelections">\n\t\t\t\t\t<i class="lui-icon lui-icon--selections-tool"></i>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t</div>\n\t</div>\n\t<div ng-if="isSmallDevice && mobileIndicatorShow && !inSelection " qva-activate="toggleGlobalSelection($event)" class="qv-current-selections-mobile-wrapper" tid="currentSelections.toggleMobileSelections" q-title-translation="GlobalSelections.CurrentSelections">\n\t\t<div class="qv-current-selections-mobile-background">\n\t\t\t<p class="qv-current-selections-mobile-nbr" ng-class="{selections: nbrSelections > 0}">{{nbrSelections}}</p>\n\t\t</div>\n\t</div>\n</div>\n'}),define("objects.models/listbox",["core.models/generic-object","general.utils/visualizations","objects.utils/data-properties/listobject-util","util","objects.utils/type-loader"],function(a,b,c,d,e){"use strict";var f,g=[];return f=a.extend("Listbox",{}),f.createTransient=function(a,c,d){var f,h,i,j=-1,k=g.length;for(f={that:a,app:c,props:d},h=0;h<k;h++)if(angular.equals(g[h].askFor,f)){j=h;break}return j>=0?g[j].result:(i=e.load().then(function(){return b.getType("listbox").getInitialProperties(d).then(function(a){return c.createSessionObject(a)})}),g.push({askFor:f,result:i}),i)},f.createTransientField=function(a,b,e){var f={};return f.qListObjectDef=c.createFieldDimension(b),d.extend(!0,f,e||{}),this.createTransient(this,a,f)},f.createTransientDimension=function(a,b,e){var f={};return f.qListObjectDef=c.createLibraryDimension(b),d.extend(!0,f,e||{}),this.createTransient(this,a,f)},f}),define("objects/listbox-popover/listbox-popover",["core.utils/deferred","core.utils/resize"],function(a,b){return{template:null,controller:["$scope","$element","$timeout",function(c,d,e){function f(){e(function(){c.destroyComponent(),d.remove()}),b.off("start.listbox-popover-error",f)}var g=this;c.input.selectionsActivated=function(){},c.input.selectionsDeactivated=function(){},g.close=function(){f()};var h=c.input.onPopoverClose,i=null;c.closingDeferred.promise.then(function(a){i&&i(),h(a),f()}),a.all({object:c.input.getVisualization(),width:function(){return e(function(){return d.find(".toolbar-wrapper").outerWidth()})}()}).then(function(a){var d=a.object,e=a.width;d.getSelectionToolbar().then(function(a){c.toolbar=a,c.toolbar.showLock=c.input.options.showLock,c.toolbar.position={width:e},d.activateSelections()}),d.loaded.then(function(){d.ext.hasError(d)&&b.on("start.listbox-popover-error",f)}),d.selectionsApi.watchActivated(function(){c.input.selectionsActivated()}),d.selectionsApi.watchDeactivated(function(){c.input.selectionsDeactivated(),f()}),i=function(){d.selectionsApi.confirm()}})}]}}),define("text!objects/listbox-popover/listbox-popover.ng.html",[],function(){return'<lui-popover\n\t\tclass="qv-listbox-popover"\n\t\tstyle="min-width: 200px;width: 234px;height: 332px"\n\t\ton-close-view="closeView(event)"\n\t\tqva-outside-ignore-for="{{input.qvaOutsideIgnoreFor}}">\n\t<lui-popover-body style="height: 332px" class="lui-popover__body--nopad">\n\t\t<div class="toolbar-wrapper"\n\t\t\t qva-include-selection-toolbar\n\t\t\t component="input.selectionToolbarComponent"\n\t\t\t toolbar="toolbar"\n\t\t\t options="input.options"></div>\n\t\t<div class="listbox-wrapper">\n\t\t\t<qv-object object="object" model="input.model" options="input.options"></qv-object>\n\t\t</div>\n\t</lui-popover-body>\n</lui-popover>\n'}),define("objects/listbox-popover/listbox-popover-service",["qvangular","util","core.utils/deferred","objects.models/listbox","client.views/selection-toolbar/selection-toolbar","objects/listbox-popover/listbox-popover","general.utils/responsive-state","text!./listbox-popover.ng.html","objects/object","general.components/immidiate-contextual/immidiate-contextual"],function(a,b,c,d,e,f,g,h){a.service("qvListboxPopoverService",["$document","luiPopover",function(a,i){var j,k;return{show:function(a,d,l,m){var n=c();return j&&(k.selectionsActivated=function(){},k.selectionsDeactivated=function(){},j.close()),k={getVisualization:function(){return n.promise},model:a,onPopoverClose:this.onPopoverClose,options:{setController:n.resolve,isPopover:!0,showLock:d.showLock,search:d.search||{},smallDevice:g.isSmallDevice,direction:d.direction},selectionToolbarComponent:e,onClose:f},j=i.show({template:h,controller:f.controller,alignTo:d.$alignToElement[0],input:k,closeOnResize:!1,dock:"top"}),k.selectionsActivated=function(){b.isFunction(m)&&m()},k.selectionsDeactivated=function(){b.isFunction(l)&&l(),l=null,m=null},j},showField:function(a,b,e,f,g,h){return d.createTransientField(b,a,f).then(function(a){return c.resolve(this.show(a,e,g,h))}.bind(this))},showDimension:function(a,b,c,e,f,g){d.createTransientDimension(b,a,e).then(function(a){this.show(a,c,f,g)}.bind(this))},close:function(){j&&j.close(),j=null},onPopoverClose:function(){},getPopover:function(){return j},onClosing:function(){}}}])}),define("widget.pager",["jquery","jqueryui"],function(a){return a.widget("qv.pager",{options:{itemSelector:">li",orientation:"horizontal",pageSize:"auto",startPage:1,animationDuration:300},_create:function(){var b=this.options;a.extend(this,{positionProperty:"horizontal"===b.orientation?"left":"top",sizeProperty:"horizontal"===b.orientation?"outerWidth":"outerHeight"}),this.refresh(),this.goToPage(b.startPage)},isItemInsidePage:function(b){var c=a(b),d=c.position()[this.positionProperty]+c[this.sizeProperty](),e=Math.abs(parseFloat(c.parent().css("margin-"+this.positionProperty))),f=e+this.containerSize;return d>e&&d<f},calculatePageSize:function(){return Math.floor(this.containerSize/this.calculateItemSize())},calculateItemSize:function(){return this.element.find(this.options.itemSelector).eq(0)[this.sizeProperty]()},refresh:function(){var a=this.currentPage||1;this.containerSize=this.element.parent()[this.sizeProperty](),this.pageSize="auto"===this.options.pageSize?this.calculatePageSize():this.options.pageSize,this.itemSize=this.calculateItemSize(),this.maxPages=Math.ceil(this.element.find(this.options.itemSelector).length/this.pageSize||1),this.currentPage=Math.min(a,this.maxPages),this.goToPage(this.currentPage)},goToPage:function(a){this.currentPage=Math.min(Math.max(1,a),this.maxPages);var b=(this.currentPage-1)*this.itemSize*this.pageSize,c={};c[this.positionProperty]=-b+"px",this.element.stop(!0).animate(c,this.options.animationDuration)},goToPreviousPage:function(){this.goToPage(this.currentPage-1)},goToNextPage:function(){this.goToPage(this.currentPage+1)},goToPageContaining:function(a){var b=Math.ceil(this.element.find(a).index()+1/this.pageSize);this.goToPage(b)},_destroy:function(){this.element.off(this.eventNamespace)}}),a}),define("general.components/pager/pager",["qvangular","core.utils/resize","general.utils/support","widget.pager"],function(a,b,c){a.directive("qvPager",["$timeout",function(a){return{restrict:"A",priority:0,link:function(d,e){function f(){d.refreshPager()}c.treatAsDesktop()||e.css("overflow-x","auto"),d.pagerData=e.find("ul").pager().data("qv-pager"),e.addClass("qv-pager"),d.nextPage=function(){a(function(){d.pagerData.goToNextPage(),d.refreshPager(!0)})},d.prevPage=function(){a(function(){d.pagerData.goToPreviousPage(),d.refreshPager(!0)})},d.goToPage=function(a){d.pagerData.goToPage(a),d.refreshPager(!0)},d.refreshPager=function(a){var b="";a||d.pagerData.refresh(),e.removeClass("qv-pager-back qv-pager-forward"),1!==d.pagerData.currentPage?(d.showShadow=!0,b+="qv-pager-back "):d.showShadow=!1,d.pagerData.currentPage!==d.pagerData.maxPages&&(b+="qv-pager-forward "),e.addClass(b)},d.$on("refreshPager",f),d.$on("$destroy",function(){b.off("end",f)})}}}])}),define("text!client.views/global-selections/global-selections.ng.html",[],function(){
return'<div class="qv-global-selections" ng-class="{\'toolbar\': toolbar, \'selection-toolbar-open\': selectionToolbarOpen}">\n\n\t<section class="qv-gs-section qv-gs-top" tid="globalSelections.topSection">\n\t\t<header class="qv-gs-header">\n\t\t\t<h2 q-translation="GlobalSelections.CurrentSelections"></h2>\n\t\t</header>\n\t\t<div qv-global-select-section="{ itemSize: 220, itemSpacing: 20, type: \'fields\' }" all-items="selectedFields" app="app"></div>\n\t</section>\n\n\t<section class="qv-gs-section" tid="globalSelections.bottomSection">\n\t\t<header class="qv-gs-header">\n\t\t\t<h2 q-translation="GlobalSelections.AppDimensions"></h2>\n\t\t\t<lui-checkbox x-variant="inverse" x-model="showFields" title="{{\'GlobalSelections.ShowFields\'|translate}}" tid="globalSelections.showFields">{{\'GlobalSelections.ShowFields\'|translate}}</lui-checkbox>\n\t\t\t<lui-search x-variant="inverse" class="qv-gs-searchfield" placeholder="{{showFields ? \'GlobalSelections.FilterDimensionsAndFields\' : \'GlobalSelections.FilterDimensions\'}}" query="filter" maxlength="255"\n\t\t\t\t\t\t\t tid="globalSelections.searchField" on-escape="filter = \'\';" auto-focus="autoFocus" on-enter="onEnter($event)"></lui-search>\n\t\t</header>\n\n\t\t<div class="qv-gs-info" ng-if="!dimAvailable && !showFields">\n\t\t\t<h2 q-translation="GlobalSelections.DimensionsWarning"></h2>\n\t\t</div>\n\t\t<div class="qv-gs-info" ng-if="showNoMatches">\n\t\t\t<h2 q-translation="GlobalSelections.NoMatchesForSearch"></h2>\n\t\t</div>\n\t\t<div qv-global-select-section="{ itemSize: 220, itemSpacing: 20, type: \'dimensions\'}" all-items="dimensionsFields" filter="filter" app="app"></div>\n\n\t</section>\n</div>\n'}),define("text!assets/client/dialogs/confirm-dialog/confirm-dialog.ng.html",[],function(){return'<qv-modal-dialog qv-id="confirm-dialog" qv-cancel="cancel()" qv-confirm="confirm()">\n\t<header ng-if="header" class="dm-header" q-translation="{{header}}"></header>\n\t<main class="dm-main">\n\t\t<div class="qv-mvc-dialog-content">\n\t\t\t<div class="qv-mvc-dialog-icon icon-{{icon}}" ng-show="icon"></div>\n\t\t\t<p><span q-translation="{{text}}"></span></p>\n\t\t</div>\n\t</main>\n\t<qv-confirm-cancel-footer qv-confirm="confirm()" qv-cancel="cancel()" qv-confirm-label="{{confirmLabel}}"></qv-confirm-cancel-footer>\n</qv-modal-dialog>\n'}),define("general.utils/tabbable-elements",["jquery","jqueryui"],function(a){"use strict";var b=[];return{preventTabbing:function(c){var d={id:b.length,elements:c.find(":tabbable")};b.push(d),d.elements.each(function(){var b=a(this);b.data("tabbable-elements-tabindex",b.attr("tabindex"))}),d.elements.attr("tabindex","-1")},restoreTabbing:function(){b.pop().elements.each(function(){var b=a(this),c=b.data("tabbable-elements-tabindex");c?b.attr("tabindex",c):b.removeAttr("tabindex")})}}}),define("assets/client/dialogs/directives/tabbable-container",["qvangular","general.utils/tabbable-elements","jquery"],function(a,b,c){a.directive("qvTabbableContainer",function(){return{restrict:"A",controller:["$scope","$element",function(a,d){var e=d[0].nextSibling,f=d[0].parentNode;f.removeChild(d[0]),b.preventTabbing(c(document.body)),document.activeElement&&document.activeElement.blur&&document.activeElement.blur(),f.insertBefore(d[0],e),a.$on("$destroy",function(){b.restoreTabbing()})}]}})}),define("general.utils/keyboard-event-dispatcher",["jquery"],function(a){function b(a){Object.keys(f).forEach(function(b){f[b]=f[b].filter(function(b){return b.jackId!==a})})}function c(a){var b=Array.prototype.slice.call(arguments,1);f[a].forEach(function(a){a.jackId===g[g.length-1]&&a.handler.apply(null,b)})}function d(a,b,d){f[b]||(e.on(b,c.bind(null,b)),f[b]=[]),f[b].push({jackId:a.id,handler:d})}var e,f={},g=[],h={on:function(a,b){d(this,a,b)},release:function(){var a=this.id;b(a),g.splice(g.indexOf(a),1)}};return{hijack:function(){e||(e=a(document));var b=Object.create(h,{id:{value:g.length}});return g.push(b.id),b}}}),define("assets/client/dialogs/directives/escape",["qvangular","general.utils/keyboard-event-dispatcher"],function(a,b){a.directive("qvDialogEscape",["$parse",function(a){return{restrict:"A",controller:["$scope",function(a){var c=this.hijack=b.hijack();a.$on("$destroy",function(){c.release()})}],link:function(b,c,d,e){var f=a(d.qvDialogEscape);e.hijack.on("keydown",function(a){27===a.keyCode&&(a.preventDefault(),setTimeout(function(){b.$apply(function(){f(b,{$event:a})})}))})}}}])}),define("text!general.components/modal-dialog/modal-dialog.ng.html",[],function(){return'<div class="modal-container qui-modalbackground-centered" qv-tabbable-container>\n\t<div id="{{id}}"\n\t\t class="modal-frame qui-delayedModal"\n\t\t ng-transclude></div>\n</div>\n'}),define("general.components/modal-dialog/modal-dialog",["qvangular","text!general.components/modal-dialog/modal-dialog.ng.html","general.utils/keyboard-event-dispatcher"],function(a,b,c){a.directive("qvModalDialog",function(){return{scope:{id:"@qvId",confirm:"&qvConfirm",cancel:"&qvCancel"},restrict:"E",transclude:!0,replace:!0,template:b,link:function(a){var b=c.hijack();a.$on("$destroy",function(){b.release()}),b.on("keydown",function(b){if(27===b.keyCode&&(b.preventDefault(),setTimeout(function(){a.$apply(function(){a.cancel()})})),13===b.keyCode){if("TEXTAREA"===b.target.tagName)return;if("BUTTON"===b.target.tagName)return;setTimeout(function(){a.$apply(function(){a.confirm()})})}})}}})}),define("text!assets/client/dialogs/directives/confirm-cancel-footer.ng.html",[],function(){return'<footer class="dm-footer">\n    <lui-button x-variant="inverse" qva-activate="$event.preventDefault(); cancel()" name="cancel" q-translation="Common.Cancel" tid="2f2a4f" ng-disabled="cancelDisabled"></lui-button>\n    <lui-button x-variant="inverse" qva-activate="$event.preventDefault(); confirm()" name="confirm" autofocus q-translation="{{confirmLabel}}" tid="2f2a56" ng-disabled="confirmDisabled" qva-focus="true"></lui-button>\n</footer>\n'}),define("text!assets/client/dialogs/directives/confirm-cancel-footer-light.ng.html",[],function(){return'<footer class="dm-footer">\n    <lui-button qva-activate="$event.preventDefault(); cancel()" name="cancel" q-translation="Common.Cancel" tid="2f2a4f" ng-disabled="cancelDisabled"></lui-button>\n    <lui-button qva-activate="$event.preventDefault(); confirm()" name="confirm" autofocus q-translation="{{confirmLabel}}" tid="2f2a56" ng-disabled="confirmDisabled" qva-focus="true"></lui-button>\n</footer>\n'}),define("assets/client/dialogs/directives/confirm-cancel-footer",["qvangular","text!assets/client/dialogs/directives/confirm-cancel-footer.ng.html","text!assets/client/dialogs/directives/confirm-cancel-footer-light.ng.html"],function(a,b,c){a.directive("qvConfirmCancelFooter",function(){return{scope:{confirmLabel:"@qvConfirmLabel",confirm:"&qvConfirm",confirmDisabled:"=qvConfirmDisabled",cancel:"&qvCancel",cancelDisabled:"=qvCancelDisabled"},restrict:"E",replace:!0,template:function(a,d){return d.hasOwnProperty("light")?c:b}}})}),define("assets/client/dialogs/directives/dialog-directives",["assets/client/dialogs/directives/tabbable-container","assets/client/dialogs/directives/escape","general.components/modal-dialog/modal-dialog","assets/client/dialogs/directives/confirm-cancel-footer"],function(){}),define("assets/client/dialogs/confirm-dialog/confirm-dialog",["general.services/show-service/show-service","text!assets/client/dialogs/confirm-dialog/confirm-dialog.ng.html","assets/client/dialogs/directives/dialog-directives"],function(a,b){function c(b){var c=b.text,e=void 0!==b.icon?b.icon:"cogwheel",f=b.confirm||"Common.OK",g={text:c,header:b.header,icon:e,confirmLabel:f};return a.show(d,g).resultPromise}var d={template:b,scope:{text:"=",header:"=",icon:"=",confirmLabel:"="},controller:["$scope",function(a){a.confirm=function(){a.destroyComponent(),a.deferredResult.resolve()},a.cancel=function(){a.destroyComponent(),a.deferredResult.reject()}}]};return{show:c}}),define("client.services/stage-state",["core.utils/deferred","jquery"],function(a,b){var c={};return c.reset=function(){c.selectedObject=null,c.assetsOpen=!0,c.propertiesOpen=void 0},c.setSelectedObject=function(d){var e={id:"",type:"",customObject:null,canCopy:function(){return!0},copy:null,canCut:function(){return!0},cut:null,paste:null,canRemove:function(){return!0},remove:null,getAllPropertyPanelContent:function(){var b={objectType:"",iconClass:"",titleRef:"",components:[],definition:{},properties:{},layout:{},localeInfo:null,app:null,cache:null,ext:null,globalChangeListeners:null,handler:null,model:null};return a.resolve(b)}};d?(b.extend(e,d),c.selectedObject=e):c.selectedObject=null},c.reset(),c}),define("client.assets/assets-utils",["jquery","util","assets/client/dialogs/confirm-dialog/confirm-dialog","pubsub","client.utils/state","client.services/stage-state"],function(a,b,c,d,e,f){function g(a,b){c.show({text:a}).then(b)}function h(a){if(!i)throw new TypeError("Permissions are not available yet. Make sure you have initialized this module with init().");switch(a){case"measure":return i.createMeasure;case"dimension":return i.createDimension;case"visualization":return i.createMasterobject;case"odagLink":return i.createOdagLink;default:throw new TypeError("'"+a+"' is an unknown type.")}}var i;return{init:function(b,c){b&&(i=a.extend({},b,c))},getContextMenuAddToText:function(a){var b=f.selectedObject;return a&&"odaglinks"===a?"library.addtoAppNavigation":b&&"sheetCell"===b.type?"contextMenu.addToSheet":"contextMenu.addToVisualization"},getAddToOptions:function(){var a=f.selectedObject,b=null;return a&&e.isInEditMode()&&(b={},"gridCell"===a.type?b.object=!0:"sheetCell"===a.type&&(b.sheet=!0)),b},getAddToText:function(a){var b=f.selectedObject;return b&&e.isInEditMode()?a&&"odaglinks"===a?"library.addtoAppNavigation":"gridCell"===b.type?"library.addtoVisualization":"sheetCell"===b.type?"library.addtosheet":"":null},addItemToSheetOrVisualization:function(a){if(this.isAddToMode()){var b=f.selectedObject,c={item:a};b&&"gridCell"===b.type&&(c.cell=b.customObject),d.publish("/ui/library/addToSheet",c)}},librarySearchFn:function(a,c,d){return!c||""===c||(d=d||function(a,c){return b.match([a.name],c)})(a,c.toLowerCase())},libraryMultiSearch:function(a,c,d){if(a.match={},!c||""===c)return!0;c=c.toLowerCase();for(var e=!1,f=0;f<d.length;++f){var g=d[f];b.match(a[g],c)&&(e=!0,a.match[g]=!0)}return e},itemDblClickHandler:function(a){this.isAddToSheetMode()&&d.publish("/ui/library/addToSheet",{item:a})},removeDialog:g,editDialog:g,hasLinks:function(a,b){return b.get(a).then(function(a){return a.getLinkedObjects().then(function(a){return 0!==a.length})})},toggleSelection:function(b,c){var d=a(c.currentTarget);return b.selected=!b.selected,b.selected?(d.on("qv-outside",function(c){var e=a(c.target);1!==e.closest("#library-preview").length&&1!==e.closest(".qv-contextmenu").length&&(b.selected=!1,d.off("qv-outside"))}),!0):(d.off("qv-outside"),!1)},removeSelection:function(b){a.each(b,function(a,b){b.selected=!1})},localeOrderBy:function(a,b){if(a){var c=function(a,b){return a.localeCompare(b)};b&&b instanceof Function&&(c=function(a,c){return b(a).localeCompare(b(c))}),a.sort(c)}return a},isAddToSheetMode:function(){return e.isInEditMode()&&e.view===e.Views.sheet&&e.model.layout.permissions.update},isAddToVisualizationMode:function(){return e.isInEditMode()&&(e.view===e.Views.object&&e.model.layout.permissions.update||e.view===e.Views.masterObject)},isAddToMode:function(){return this.isAddToSheetMode()||this.isAddToVisualizationMode()},hasAppUpdatePermssion:function(){return i.update},permissionToCreate:h}}),define("text!client.views/global-selections/directives/scroll/scroll.ng.html",[],function(){return'<div class="qv-gs-scroll-container">\n\t<qv-scroll-area class="qv-gs-scroll-area">\n\t\t<div ng-if="scrollApi.loadPrevious" class="qv-gs-scroll-btn qv-gs-scroll-btn-previous" tid="globalSelections.loadPrevious">\n\t\t\t<qv-scroll-load-button tag="div" class="qv-listbox-load-buttons" on-load="scrollApi.gotoPreviousBlock()" text="Object.Listbox.LoadPrevious" previous="true"></qv-scroll-load-button>\n\t\t</div>\n\t\t<div ng-repeat="item in items" class="qv-gs-listbox">\n\t\t\t<qv-object ng-if="item.visible" model="item.model" options="item.options" object="item.object" class="qv-object-listbox" id="{{item.id}}"></qv-object>\n\t\t\t<div ng-if="!item.visible" class="qv-object qv-object-listbox qv-gs-placeholder" id="{{item.id}}">\n\t\t\t\t<h1 class="qv-object-title" qva-direction x-dir-text="{{item.title}}">\n\t\t\t\t\t<span class="qv-object-title-text" qva-direction x-dir-text="{{item.title}}">{{item.title}}</span>\n\t\t\t\t</h1>\n\t\t\t\t<div class="progress">\n\t\t\t\t\t<qv-rain></qv-rain>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<p ng-if="item.qField" q-title-translation="Common.Field" tid="globalSelections.fieldIndicator" class="qv-gs-field-indicator" qva-direction>\n\t\t\t\t<span class="lui-icon  lui-icon--field"></span>\n\t\t\t</p>\n\t\t\t<qv-gs-badge></qv-gs-badge>\n\t\t</div>\n\t\t<div ng-if="scrollApi.loadNext" class="qv-gs-scroll-btn" tid="globalSelections.loadNext">\n\t\t\t<qv-scroll-load-button tag="div" class="qv-listbox-load-buttons" on-load="scrollApi.gotoNextBlock()" text="Object.Listbox.LoadMore"></qv-scroll-load-button>\n\t\t</div>\n\t</qv-scroll-area>\n\t<qv-scroll-loader tag="li" class="qv-scroll-row-loader"></qv-scroll-loader>\n</div>\n'}),define("general.scroll/api/dom-api",["core.utils/class","touche"],function(a,b){"use strict";function c(){return".grid-object-dom-api-"+ ++d}var d=0;return a.extend({init:function(a,b,d,e,f,g){g=g||".scroll-content",this.$element=a,this.$scrollArea=b,this.$scrollContent=b.find(g),this.rowSelector=d,this.firstRowSelector=e,this.lastRowSelector=f,this.namespace=c()},destroy:function(){this.unbindNativeScroll()},bindNativeScroll:function(a){this.$scrollArea.on("scroll"+this.namespace,a)},unbindNativeScroll:function(){this.$scrollArea.off(this.namespace)},resetNativeScroll:function(){this.$scrollArea.scrollTop(0)},preventNativeScroll:function(){var a="mousewheel"+this.namespace+" DOMMouseScroll"+this.namespace+" mousemove"+this.namespace;return this.$scrollArea.on(a,function(a){a.preventDefault()}),b(this.$scrollArea[0]).tap({id:this.namespace}),function(){this.$scrollArea.off(a),b(this.$scrollArea[0]).off("tap",this.namespace)}.bind(this)},getBoundingBox:function(){return this.$element[0].getBoundingClientRect()},getClientWidth:function(){return this.$element[0].clientWidth},getClientHeight:function(){return this.$element[0].clientHeight},getScrollAreaBoundingBox:function(){return this.$scrollArea[0].getBoundingClientRect()},getScrollAreaClientWidth:function(){return this.$scrollArea[0].clientWidth},getScrollAreaClientHeight:function(){return this.$scrollArea[0].clientHeight},getScrollAreaOffsetTop:function(){return this.$scrollArea[0].offsetTop},getScrollContentBoundingBox:function(){return this.$scrollContent[0].getBoundingClientRect()},getFirstRow:function(){return this.$scrollArea.find(this.firstRowSelector)},getLastRow:function(){return this.$scrollArea.find(this.lastRowSelector)},getVisibleRowCount:function(a){function b(a,b){var c=a.getBoundingClientRect();return Math.round(c.bottom-b.bottom)<1}function c(a,b){var c=b-a;return 1===c?b:Math.floor(a+c/2)}function d(a,e,f,g){var h=f-e,i=c(e,f),j=b(a[i],g);return 0===h?j?i:-1:1===h?j?i:d(a,e,e,g):j?d(a,i,f,g):d(a,e,i,g)}var e=this.$element[0].querySelectorAll(this.rowSelector);if(0===e.length)return 0;if(e=Array.prototype.slice.call(e),e=e.filter(function(a){return a.nodeType===Node.ELEMENT_NODE}),0===e.length)return 0;var f=this.getScrollAreaBoundingBox(),g=d(e,0,e.length-1,f)+1;if(g===e.length){var h=e[e.length-1],i=h.getBoundingClientRect(),j=Math.round(f.bottom-i.bottom);g+=Math.floor(j/a)}return g},alignToFirstRow:function(){var a=this.getFirstRow();return function(){var b=a.position().top-48;this.$scrollArea.scrollTop(b)}.bind(this)},alignToLastRow:function(){var a=this.getLastRow();return function(){this.$scrollArea.scrollTop(0);var b=a.position().top-this.getScrollAreaBoundingBox().height+a[0].getBoundingClientRect().height+48;this.$scrollArea.scrollTop(b)}.bind(this)}})}),define("general.scroll/api/data-api",["core.utils/deferred","core.utils/class"],function(a,b){"use strict";return b.extend({getRowCount:function(){return 0},getFirstElementIndex:function(){return-1},getLastElementIndex:function(){return-1},getIndexOf:function(a){return a.getIndex()},onVirtualScroll:function(){return a.resolve()},onGotoNextBlock:function(){return a.resolve()},onGotoPreviousBlock:function(){return a.resolve()},onInitialNativeScroll:function(){return a.resolve()}})}),define("general.scroll/scroll-area-service",["qvangular"],function(a){"use strict";a.service("qvScrollAreaService",function(){function a(a){if("rtl"===a.textDirection&&"horizontal"===a.direction){var b=a.showMinAffordance;a.showMinAffordance=a.showMaxAffordance,a.showMaxAffordance=b}}return{createScrollbar:function(){return{vLength:0,vViewportLength:0,vPos:0,vPage:0,thumb:{},style:{},classList:[],enabled:!1,getScrollDelta:function(a){var b=0,c=0;if(!this.enabled)return[0,0];switch(this.direction){case"vertical":c=a.swipe.curDeltaY*(1/this.scaleFactor);break;case"horizontal":b=("rtl"===this.textDirection?-1:1)*a.swipe.curDeltaX*(1/this.scaleFactor);break;default:throw"not implemented"}return[b,c]},active:!1}},setScrollbarData:function(b,c,d,e,f,g,h){var i;switch(c){case"vertical":i=g.height;break;case"horizontal":i=g.width;break;default:throw"not implemented"}if(b.enabled=f<e&&i>0,b.enabled){switch(i-=6,b.uiOffset=3,b.direction=c,b.vLength=e,b.vViewportLength=f,b.vPos=0,b.vPage=i,b.length=i,b.trackSize=d,b.scaleFactor=i/e,b.thumb.pos=0,b.thumb.size=0,b.thumb.vPos=0,b.showMinAffordance=!1,b.showMaxAffordance=!0,b.textDirection=h,b.direction){case"vertical":b.style.top=g.top+b.uiOffset+"px",b.style.width=d+"px",b.style.left="rtl"===h?b.uiOffset+"px":g.left+g.width-d-b.uiOffset+"px",b.style.height=g.height-2*b.uiOffset+"px";break;case"horizontal":b.style.height=d+"px",b.style.top=g.top+g.height-d-b.uiOffset+"px",b.style.left=g.left+b.uiOffset+"px",b.style.width=g.width-2*b.uiOffset+"px";break;default:throw"not implemented"}a(b)}},setVirtualScrollPos:function(b,c,d){var e=c.vLength-c.vViewportLength,f=0,g=c.thumb.vPos;return c.enabled?(c.vPos+=b,c.showMinAffordance=!1,c.showMaxAffordance=!1,c.vPos<0?(g=0,c.vPos=d?c.vPos:0,c.showMaxAffordance=!0):c.vPos>e?(g=e,c.vPos=d?c.vPos:e,c.showMinAffordance=!0):(0!==c.vPos&&(c.showMinAffordance=!0),c.vPos!==e&&(c.showMaxAffordance=!0),g=c.vPos),f=g-c.thumb.vPos,c.thumb.vPos=g,a(c),f):0},setThumbStyle:function(a,b){var c=b.thumb,d=b.scaleFactor,e=Math.floor(c.vPos*d),f=Math.floor(b.vViewportLength*d);switch(f<12&&(e-=Math.floor((12-f)/2),f=12),e=Math.max(e,0),e+f>b.length&&(e=b.length-f),c.size=f,c.pos=e,b.direction){case"vertical":a.top=e+"px",a.height=f+"px";break;case"horizontal":"rtl"===b.textDirection?(delete a.left,a.right=e+"px"):(delete a.right,a.left=e+"px"),a.width=f+"px";break;default:throw"not implemented"}},setTrackHitAreaStyle:function(a,b,c){"vertical"===b.direction?(a.right=-b.uiOffset+"px",a.width=c+b.uiOffset+"px"):(a.bottom=-b.uiOffset+"px",a.height=c+b.uiOffset+"px")}}})}),define("general.scroll/scroll-area-controller",["general.utils/support","general.scroll/scroll-area-service"],function(a){"use strict";return["$scope","$element","$timeout","qvScrollAreaService",function(b,c,d,e){var f,g,h,i,j=[],k=[],l=[];b.interactive=!1,b.virtualSize={width:0,height:0},b.virtualViewport={width:0,height:0},b.scrollbarX=e.createScrollbar(),b.scrollbarY=e.createScrollbar(),b.viewportRect={top:0,left:0,width:0,height:0},b.hover=!1,b.isMouse=!0,b.$on("$destroy",function(){clearTimeout(h),clearTimeout(i)}),this.setMouse=function(a){b.isMouse=a},this.getScrollAreaRect=function(){var a=c[0].getBoundingClientRect();return{top:0,left:0,width:Math.ceil(a.width),height:Math.ceil(a.height)}},this.addScrollbarXCtrl=function(a){f=a},this.addScrollbarYCtrl=function(a){g=a},this.allowFade=function(){return(void 0===f||f.allowFade())&&(void 0===g||g.allowFade())},this.fadeScrollbarsWithoutDelay=function(){f&&f.fadeOut(),g&&g.fadeOut()},this.toggleFadeScrollbars=function(a){clearTimeout(i),clearTimeout(h),(a||this.allowFade())&&(h=setTimeout(function(){var b=a?"fadeIn":"fadeOut";f&&f[b](),g&&g[b]()},a?0:800))},this.fadeInScrollbars=function(){this.toggleFadeScrollbars(!0)},this.fadeOutScrollbars=function(){a.treatAsDesktop()&&b.hover||this.toggleFadeScrollbars(!1)},this.fadeOutScrollbarsDelayed=function(){clearTimeout(i),i=setTimeout(function(){this.toggleFadeScrollbars(!1)}.bind(this),1e3)},this.setNonMouseTrackSize=function(){"object"==typeof b.nonMouseViewportScrolling&&(c.addClass(b.nonMouseViewportScrolling.className),this.setTrackSize(b.nonMouseViewportScrolling.scrollbarSize))},this.setMouseTrackSize=function(){"object"==typeof b.nonMouseViewportScrolling&&c.removeClass(b.nonMouseViewportScrolling.className),this.setTrackSize(b.scrollbarSize)},this.setTrackSize=function(a){var c=this.getVirtualPosition();this.setVirtualSize(b.virtualSize,b.virtualViewport,b.viewportRect,a),this.setVirtualScrollPos(c.vPosX,c.vPosY)},this.setupScrollbars=function(a){a=a||8,e.setScrollbarData(b.scrollbarY,"vertical",a,b.virtualSize.height,b.virtualViewport.height,b.viewportRect,b.direction),e.setScrollbarData(b.scrollbarX,"horizontal",a,b.virtualSize.width,b.virtualViewport.width,b.viewportRect,b.direction),b.scrollbarX.enabled&&b.scrollbarY.enabled&&(b.scrollbarX.length-=a,b.scrollbarX.scaleFactor=b.scrollbarX.length/b.virtualSize.width,b.scrollbarX.style.width=b.viewportRect.width-a-2*b.scrollbarX.uiOffset+"px","rtl"===b.direction&&(b.scrollbarX.style.left=b.viewportRect.left+b.scrollbarX.uiOffset+a+"px"),b.scrollbarY.length-=a,b.scrollbarY.scaleFactor=b.scrollbarY.length/b.virtualSize.height,b.scrollbarY.style.height=b.viewportRect.height-a-2*b.scrollbarY.uiOffset+"px")},this.setVirtualSize=function(a,c,d,e){b.viewportRect=d,b.virtualSize.width=a.width,b.virtualSize.height=a.height,b.virtualViewport.width=c.width,b.virtualViewport.height=c.height,this.setupScrollbars(e)},this.setViewport=function(a){b.viewportRect=a},this.setVirtualViewport=function(a){var c=this.getVirtualPosition();b.virtualViewport.width=a.width,b.virtualViewport.height=a.height,b.scrollbarX.vViewportLength=a.width,b.scrollbarY.vViewportLength=a.height,this.setupScrollbars(b.isMouse?b.scrollbarSize:b.nonMouseViewportScrolling.scrollbarSize),this.setVirtualScrollPos(c.vPosX,c.vPosY)},this.getVirtualSize=function(){return{width:b.virtualSize.width,height:b.virtualSize.height}},this.getVirtualPosition=function(){var a=this.getMaxPosition();return{vPosX:Math.max(0,Math.min(a.vPosX,b.scrollbarX.vPos)),vPosY:Math.max(0,Math.min(a.vPosY,b.scrollbarY.vPos))}},this.getMaxPosition=function(){return{vPosX:Math.max(0,b.scrollbarX.vLength-b.scrollbarX.vViewportLength),vPosY:Math.max(0,b.scrollbarY.vLength-b.scrollbarY.vViewportLength)}},this.isMouseOver=function(){return b.hover},this.resetScroll=function(){void 0!==b.scrollbarX.vPos&&void 0!==b.scrollbarY.vPos&&(0===b.scrollbarX.vPos&&0===b.scrollbarY.vPos||this.scroll(-b.scrollbarX.vPos,-b.scrollbarY.vPos,!0,!1))},this.setVirtualScrollPos=function(a,c,d){e.setVirtualScrollPos(a,b.scrollbarX,d),e.setVirtualScrollPos(c,b.scrollbarY,d)},this.scroll=function(a,c,d,f){var g,h;g=e.setVirtualScrollPos(a,b.scrollbarX,f),h=e.setVirtualScrollPos(c,b.scrollbarY,f),(0!==g||0!==h||d)&&j.forEach(function(a){a(g,h)})},this.getScrollAmount=function(a,b,c){return{deltaX:a,deltaY:b}},this.scrollStart=function(){k.forEach(function(a){a()})},this.scrollEnd=function(){l.forEach(function(a){a()})},this.onScroll=function(a){j.push(a)},this.onScrollStart=function(a){k.push(a)},this.onScrollEnd=function(a){l.push(a)},this.on=function(){b.interactive||(b.off=b.on(),b.interactive=!0)},this.off=function(){b.off&&(b.off(),b.interactive=!1)},this.isVerticalScrollEnabled=function(){return b.scrollbarY.enabled},this.digest=function(){b.$parent.$digest()}}]}),define("general.scroll/loader/loader",["qvangular","core.utils/deferred"],function(a,b){"use strict";a.directive("qvScrollLoader",["$animateCss","$timeout",function(a,c){return{restrict:"E",replace:!0,template:function(a,b){var c=b.tag||"div";return"<"+c+' ng-style="loaderStyle" class="qv-scroll-loader qv-animate"><qv-rain ng-if="showRain" show="showRain"></qv-rain></'+c+">"},scope:{},controller:function(){},link:function(d,e,f,g){function h(a,b){d.loaderStyle.top=a,d.loaderStyle.width=b.width,d.loaderStyle.height=b.height}var i,j,k,l=!!f.noRain;d.loaderStyle={width:0,height:0},d.showRain=!1,g.fadeIn=function(f,g){var k=b();return h(f,g),l||(i=c(function(){d.showRain=!0})),j=a(e,{addClass:"fade"}),j.start().done(function(){k.resolve()}),k.promise},g.fadeOut=function(){var c=b();return d.showRain=!1,k=a(e,{removeClass:"fade"}),k.start().done(function(){d.loaderStyle.width=0,d.loaderStyle.height=0,d.$apply(),c.resolve()}),c.promise},d.$on("$destroy",function(){c.cancel(i)})}}}])}),define("text!general.scroll/loader/load-button.ng.html",[],function(){return'<div class="qv-scroll-data-load-buttons" ng-class="{ previous: previous }">\n\t<div ng-transclude></div>\n\t<button class="lui-button" qva-activate="load()" ng-disabled="disabled">\n\t\t<p q-translation="{{text}}"></p>\n\t</button>\n</div>\n'}),define("general.scroll/loader/load-button",["qvangular","text!./load-button.ng.html"],function(a,b){"use strict";a.directive("qvScrollLoadButton",[function(){return{restrict:"E",transclude:!0,replace:!0,template:function(a,c){var d=c.tag||"div";return b.replace(/^\s*<div/,"<"+d).replace(/<\/div>\s*$/,"</"+d+">")},scope:{onLoad:"&",text:"@",previous:"=",disabled:"="},link:function(a){a.load=function(){a.onLoad()}}}}])}),define("text!general.scroll/scroll-area.ng.html",[],function(){return'<div dir={{direction}}>\n\t<div class="scroll-content" ng-transclude></div>\n\t<qv-scroll-area-affordance x-show="scrollbarY.showMinAffordance" x-direction="\'vertical\'" x-dock="\'min\'" ng-if="scrollbarY.enabled" x-viewport-rect="viewportRect"></qv-scroll-area-affordance>\n\t<qv-scroll-area-affordance x-show="scrollbarX.showMinAffordance" x-direction="\'horizontal\'" x-dock="\'min\'" ng-if="scrollbarX.enabled" x-viewport-rect="viewportRect"></qv-scroll-area-affordance>\n\t<qv-scrollbar x-data="scrollbarY" x-interactive="interactive" x-viewport-rect="viewportRect" ng-if="scrollbarY.enabled"></qv-scrollbar>\n\t<qv-scrollbar x-data="scrollbarX" x-interactive="interactive" x-viewport-rect="viewportRect" ng-if="scrollbarX.enabled"></qv-scrollbar>\n\t<qv-scroll-area-affordance x-show="scrollbarY.showMaxAffordance" x-direction="\'vertical\'" x-dock="\'max\'" ng-if="scrollbarY.enabled" x-viewport-rect="viewportRect"></qv-scroll-area-affordance>\n\t<qv-scroll-area-affordance x-show="scrollbarX.showMaxAffordance" x-direction="\'horizontal\'" x-dock="\'max\'" ng-if="scrollbarX.enabled" x-viewport-rect="viewportRect"></qv-scroll-area-affordance>\n</div>\n'}),define("text!general.scroll/scrollbar.ng.html",[],function(){return'<div class="scrollbar-animation scrollbar-track"\n\tng-class="data.classList"\n\tng-style="data.style">\n\t<qv-scrollbar-track-hit-area ng-style="trackHitAreaStyle" class="scrollbar-hitarea"></qv-scrollbar-track-hit-area>\n\t<qv-scrollbar-thumb ng-class="{ active: data.active }" class="scrollbar-thumb" ng-style="thumbStyle"></qv-scrollbar-thumb>\n</div>\n'}),define("general.scroll/mouse-wheel-service",["qvangular","general.utils/support"],function(a,b){"use strict";var c=b.getMouseWheelEventName();a.service("qvMouseWheelService",function(){return{getEventName:function(){return c},getMouseWheelData:function(a){var b=1,d=0,e=0,f=0;return"wheel"===c?a:("MozMousePixelScroll"===a.type&&(b=0),a.wheelDelta&&(d=-a.wheelDelta/40),a.detail&&(d=-a.detail/3),f=d,void 0!==a.axis&&a.axis===a.HORIZONTAL_AXIS&&(f=0,e=-1*d),void 0!==a.wheelDeltaY&&(f=-1*a.wheelDeltaY/40),void 0!==a.wheelDeltaX&&(e=-1*a.wheelDeltaX/40),{deltaMode:b,delta:d,deltaX:e,deltaY:f,x:a.pageX,y:a.pageY})}}})}),define("general.scroll/scroll-area-affordance",["qvangular"],function(a){"use strict";a.directive("qvScrollAreaAffordance",function(){return{restrict:"E",template:'<div ng-show="show" class="scroll-affordance" ng-class="[dock,direction]" ng-style="style"></div>',replace:!0,require:"^qvScrollArea",scope:{viewportRect:"=",direction:"=",dock:"=",size:"=?",show:"="},link:function(a){a.size=a.size||18,a.style={},a.updateAffordance=function(){switch(a.direction){case"vertical":switch(a.style.width=a.viewportRect.width+"px",a.style.height=a.size+"px",a.dock){case"min":a.style.left=a.viewportRect.left+"px",a.style.top=a.viewportRect.top+"px";break;case"max":a.style.left=a.viewportRect.left+"px",a.style.top=a.viewportRect.top+a.viewportRect.height-a.size+"px";break;default:throw"Dock "+a.dock+" not supported"}break;case"horizontal":switch(a.style.width=a.size+"px",a.style.height=a.viewportRect.height+"px",a.dock){case"min":a.style.left=a.viewportRect.left+"px",a.style.top=a.viewportRect.top+"px";break;case"max":a.style.left=a.viewportRect.left+a.viewportRect.width-a.size+"px",a.style.top=a.viewportRect.top+"px";break;default:throw"Dock "+a.dock+" not supported"}break;default:throw"Direction "+a.direction+" not supported"}},a.$watch("viewportRect",a.updateAffordance,!0)}}})}),define("general.scroll/scroll-area",["jquery","qvangular","general.scroll/scroll-area-controller","text!./scroll-area.ng.html","text!./scrollbar.ng.html","touche","general.utils/support","general.scroll/scroll-area-service","general.scroll/mouse-wheel-service","general.scroll/scroll-area-affordance"],function(a,b,c,d,e,f,g){"use strict";b.directive("qvScrollArea",["$document","$timeout","qvScrollAreaService","qvMouseWheelService",function(b,e,h,i){return{restrict:"E",transclude:!0,template:d,replace:!0,scope:{scrollbarSize:"=?",nonMouseViewportScrolling:"=?",direction:"=?"},require:"qvScrollArea",controller:c,link:function(c,d,e,h){function j(a,b){var d=c.viewportRect.left,e=c.viewportRect.top,f=c.viewportRect.left+c.viewportRect.width,g=c.viewportRect.top+c.viewportRect.height;return a>=d&&a<=f&&b>=e&&b<=g}function k(){d.off(c.namespace),b.off(c.namespace),f(d[0]).off("*",c.namespace)}"number"!=typeof c.scrollbarSize&&(c.scrollbarSize=8),c.direction||(c.direction="ltr"),c.$watch("scrollbarX.enabled",function(a){a===!0&&d.css("overflow-x","hidden")}),c.$watch("scrollbarY.enabled",function(a){a===!0&&d.css("overflow-y","hidden")}),c.namespace=".scroll-area-"+c.$id,c.on=function(){return d.on(i.getEventName()+c.namespace,function(a){var b,c=i.getMouseWheelData(a.originalEvent);b=h.getScrollAmount(c.deltaX,c.deltaY,c.deltaMode),h.scroll(b.deltaX,b.deltaY,!1,!1),g.treatAsDesktop()||(h.setMouseTrackSize(),h.fadeInScrollbars(),h.fadeOutScrollbarsDelayed()),h.digest()}),b.on("keydown"+c.namespace,function(b){var d,e,f=0,g=0,i=a(b.target),j=i.is("input")||i.is("textarea");if(c.hover&&!j){switch(b.keyCode){case 33:g=1,d=2;break;case 34:g=-1,d=2;break;case 36:g=1,d=10;break;case 35:g=-1,d=10;break;case 38:g=1,d=1;break;case 40:g=-1,d=1;break;case 39:f=-1,d=1;break;case 37:f=1,d=1;break;default:return}e=h.getScrollAmount(f,g,d),h.scroll(-e.deltaX,-e.deltaY,!1,!1),h.digest()}}),d.on("mouseenter"+c.namespace+"pointerenter"+c.namespace,function(a){c.isMouse=g.isMouse(a.originalEvent),c.isMouse?(c.hover=!0,g.treatAsDesktop()&&(h.setMouseTrackSize(),h.fadeInScrollbars()),h.digest()):a.preventDefault()}),d.on("mouseleave"+c.namespace+"pointerleave"+c.namespace,function(a){c.isMouse=g.isMouse(a.originalEvent),c.isMouse&&(c.hover=!1,g.treatAsDesktop()&&h.fadeOutScrollbars())}),"object"==typeof c.nonMouseViewportScrolling&&("number"!=typeof c.nonMouseViewportScrolling.scrollbarSize&&(c.nonMouseViewportScrolling.scrollbarSize=36),"string"!=typeof c.nonMouseViewportScrolling.className&&(c.nonMouseViewportScrolling.className="show-non-mouse-scrollbars"),f(d[0]).swipe({id:c.namespace,options:{
radiusThreshold:0,useMomentum:!0,inertia:.7,preventDefault:!1},start:function(a,b){return g.isMouse(a)?void this.cancel():j(b.pagePoints[0].x-this.rect.x,b.pagePoints[0].y-this.rect.y)?(h.setMouse(!1),h.setNonMouseTrackSize(),h.scrollStart(),h.fadeInScrollbars(),void h.digest()):void this.cancel()},update:function(a,b){var d=c.scrollbarX.getScrollDelta(b)[0],e=c.scrollbarY.getScrollDelta(b)[1];h.scroll(-1*d,-1*e,!1,!0),h.digest()},end:function(){h.scrollEnd(),h.fadeOutScrollbars(),h.digest()}})),k},c.$on("$destroy",function(){k()})}}}]),b.directive("qvScrollbar",["qvScrollAreaService",function(a){return{restrict:"E",require:["^qvScrollArea","qvScrollbar"],scope:{data:"=",interactive:"=",viewportRect:"="},template:e,replace:!0,controller:function(){},link:function(b,c,d,e){function f(a){c[a?"addClass":"removeClass"]("fade")}var h=e[0],i=e[1];"vertical"===b.data.direction?(b.data.classList.push("vertical"),h.addScrollbarYCtrl(i)):(b.data.classList.push("horizontal"),h.addScrollbarXCtrl(i)),i.allowFade=function(){return!b.data.active},i.fadeIn=function(){return f(!0)},i.fadeOut=function(){return f(!1)},b.thumbStyle={},b.$watch("data.thumb",function(){a.setThumbStyle(b.thumbStyle,b.data)},!0),b.$watch("data.vPage",function(){a.setThumbStyle(b.thumbStyle,b.data)}),b.$watch("data.vLength",function(){a.setThumbStyle(b.thumbStyle,b.data)}),b.$watch("data.enabled",function(a){h.isMouseOver()&&a&&i.fadeIn()}),b.setThumbStyle=a.setThumbStyle.bind(null,b.thumbStyle,b.data),b.trackHitAreaStyle={},b.$watch("data.trackSize",function(c){void 0!==c&&a.setTrackHitAreaStyle(b.trackHitAreaStyle,b.data,c)}),b.start=function(a){h.setMouse(a),b.data.active||g.treatAsDesktop()||(a?h.setMouseTrackSize():h.setNonMouseTrackSize(),h.fadeInScrollbars()),b.data.active=!0,h.scrollStart()},b.update=function(a,b){h.scroll(a,b,!1,!0)},b.end=function(a){var c=b.data,d=c.vLength-c.vViewportLength;c.vPos<0?c.vPos=0:c.vPos>d&&(c.vPos=d),b.data.active=!1,h.scrollEnd(),a?h.fadeOutScrollbarsDelayed():h.fadeOutScrollbars()},b.on=function(){return b.hitAreaOff=b.hitAreaOn(),b.thumbOff=b.thumbOn(),function(){b.hitAreaOff(),b.thumbOff()}},b.$watch("interactive",function(a){a?b.off=b.on():b.off&&b.off()})}}}]),b.directive("qvScrollbarThumb",[function(){return{restrict:"E",template:"<div></div>",replace:!0,require:"^qvScrollArea",link:function(a,b,c,d){a.thumbOn=function(){return f(b[0]).tap({start:function(b){f.preventGestures(this.gestureHandler),a.start(g.isMouse(b)),d.digest()}}).swipe({options:{radiusThreshold:0},update:function(b,c){a.update.apply(a,a.data.getScrollDelta(c)),d.digest()},end:function(){a.end(),d.digest()}}),function(){f(b[0]).off()}},a.$on("$destroy",function(){f(b[0]).off()})}}}]),b.directive("qvScrollbarTrackHitArea",[function(){return{restrict:"E",replace:!0,template:"<div></div>",require:"^qvScrollArea",link:function(a,b,c,d){function e(b,c){var e,f,g,h,i,j=a.data.thumb.size,k=a.data.thumb.pos,l=0,m=0;switch(a.data.direction){case"vertical":f=b.pagePoints[0].y-c.y<k,g=b.pagePoints[0].y-c.y>k+j,g?(e=d.getScrollAmount(-1,-1,2),l=0,m=-e.deltaY):f&&(e=d.getScrollAmount(1,1,2),l=0,m=-e.deltaY);break;case"horizontal":h=b.pagePoints[0].x-c.x<k,i=b.pagePoints[0].x-c.x>k+j,h?(e=d.getScrollAmount(1,1,2),l=-e.deltaX,m=0):i&&(e=d.getScrollAmount(-1,-1,2),l=-e.deltaX,m=0)}d.scroll(l,m)}function h(b,c){switch(a.data.direction){case"vertical":a.update(0,(b.pagePoints[0].y-c.y-(a.data.thumb.pos+a.data.thumb.size/2))*(1/a.data.scaleFactor));break;case"horizontal":a.update((b.pagePoints[0].x-c.x-(a.data.thumb.pos+a.data.thumb.size/2))*(1/a.data.scaleFactor),0);break;default:throw"not implemented"}}a.hitAreaOn=function(){return f(b[0]).tap({start:function(b,c){f.preventGestures(this.gestureHandler),a.start(g.isMouse(b)),a.setThumbStyle(),g.isMouse(b)?e(c,this.rect):h(c,this.rect),d.digest()},end:function(){a.end(!0),d.digest()}}).swipe({options:{radiusThreshold:0},start:function(b,c){if(g.isMouse(b))return void this.cancel();a.update.apply(a,a.data.getScrollDelta(c)),d.digest()},update:function(b,c){a.update.apply(a,a.data.getScrollDelta(c)),d.digest()},end:function(){a.end(!0),d.digest()}}),function(){f(b[0]).off()}},a.$on("$destroy",function(){f(b[0]).off()})}}}])}),define("general.scroll/api/vertical-scroll-api",["core.utils/class","core.utils/notification","util","general.utils/support","general.scroll/api/dom-api","general.scroll/api/data-api","general.scroll/scroll-area-controller","general.scroll/loader/loader","general.scroll/loader/load-button","general.scroll/scroll-area"],function(a,b,c,d,e,f,g){"use strict";return a.extend({destroy:function(){this.$timeout.cancel(this.initPromise),this.$timeout.cancel(this.setVirtualSizePromise),this.unpreventNativeScroll&&this.unpreventNativeScroll(),this.domApi.destroy()},init:function(a,e){b.create(this,"Scroll"),this.$timeout=a,this.initPromise=null,this.setVirtualSizePromise=null,void 0!==e.virtualScrollEnabled?this.virtualScrollEnabled=e.virtualScrollEnabled:this.virtualScrollEnabled=d.treatAsDesktop(),this.loaderStyle={width:0,height:0},this.totalRows=0,this.totalColumns=0,this.alignBottomAbsolute=!1,this.axisDelta={xAxis:0,yAxis:0},this.alignToBottomReduce={active:!1,activeFromStart:!1},this.ignoreScroll=!1,this.loadNext=!1,this.loadPrevious=!1,this.settings=c.extend(!0,{alignToBottom:"absolute",minRowHeight:21,maxRowHeight:21,minColumnWidth:30,viewportRowCount:0,viewportColumnCount:0,width:0,height:0,blockSize:100,keepItemsCount:10},e)},initialize:function(a,b,c,d){if(!(a instanceof e))throw"Must provide an instance of domApi";if(!(b instanceof f))throw"Must provide an instance of dataApi";if(!(c instanceof g[4]))throw"Must provide an instance of ScrollAreaController";if(!d||"function"!=typeof d.fadeIn||"function"!=typeof d.fadeOut)throw"Must provide valid loader api";return this.initPromise?this.initPromise:(this.domApi=a,this.dataApi=b,this.virtualScrollApi=c,this.loaderApi=d,this.initPromise=this.$timeout(function(){this.onInit(),this.onInitVirtualScroll(),this.bindNativeScroll()}.bind(this)),this.initPromise)},onInit:function(){this.updateViewport()},onInitVirtualScroll:function(){this.virtualScrollApi.onScroll(this.onVirtualScroll.bind(this)),this.virtualScrollApi.getScrollAmount=this.getVirtualScrollAmount.bind(this)},bindNativeScroll:function(){this.domApi.bindNativeScroll(this.onNativeScroll.bind(this))},activate:function(){this.virtualScrollEnabled&&this.virtualScrollApi.on(),this.unpreventNativeScroll&&(this.unpreventNativeScroll(),this.unpreventNativeScroll=null)},deactivate:function(){this.unpreventNativeScroll=this.domApi.preventNativeScroll(),this.virtualScrollApi.off()},updateViewport:function(){var a=this.domApi.getBoundingBox();this.settings.width=a.width,this.settings.height=a.height,this.settings.viewportRowCount=Math.ceil(this.settings.height/this.settings.minRowHeight),this.settings.viewportColumnCount=Math.ceil(this.settings.width/this.settings.minColumnWidth)},setTotalRows:function(a){this.totalRows=a},setTotalColumns:function(a){this.totalColumns=a},getSpliceArgs:function(){return[0,this.dataApi.getRowCount()-this.settings.viewportRowCount-this.settings.keepItemsCount]},onSetVirtualSize:function(a){var b,c,d,e,f=this.domApi.getScrollAreaBoundingBox(),g=this.domApi.getScrollContentBoundingBox(),h=this.virtualScrollApi.getVirtualPosition(),i=this.settings.minRowHeight*this.totalRows;"reduce"===this.settings.alignToBottom?(this.alignToBottomReduce.active=!1,this.alignToBottomReduce.activeFromStart=!1,g.height>=f.height&&this.settings.viewportRowCount>=this.totalRows&&(b=this.domApi.getVisibleRowCount(this.settings.maxRowHeight))<this.settings.viewportRowCount&&(this.alignToBottomReduce.active=!0,this.alignToBottomReduce.activeFromStart=!0,this.settings.viewportRowCount=b),d={width:f.width,height:this.settings.viewportRowCount*this.settings.minRowHeight}):d={width:f.width,height:f.height},c={width:this.settings.minColumnWidth*this.totalColumns,height:i},e={top:0,left:0,width:f.width,height:f.height},this.virtualScrollApi.setVirtualSize(c,d,e),a&&this.virtualScrollApi.scroll(h.vPosX,h.vPosY,!0)},setVirtualSize:function(a){if(this.virtualScrollEnabled){return this.setVirtualSizePromise=this.$timeout(function(){this.updateViewport(),this.onSetVirtualSize(a),this.updateAlignToBottom()}.bind(this))}},getVirtualScrollAmount:function(a,b,c){var d=this.virtualScrollApi.getVirtualPosition(),e=this.virtualScrollApi.getMaxPosition();if(this.alignBottomAbsolute&&b<0)return{deltaX:a,deltaY:b};switch(c){case 1:return{deltaX:0,deltaY:this.settings.minRowHeight*b};case 2:return{deltaX:0,deltaY:this.settings.viewportRowCount*this.settings.minRowHeight*b};case 10:return{deltaX:0,deltaY:b>0?d.vPosY*b:d.vPosY-e.vPosY};default:return{deltaX:a,deltaY:b}}},getPage:function(a){return{left:Math.floor(a.vPosX/this.settings.minColumnWidth),top:Math.floor(a.vPosY/this.settings.minRowHeight),width:this.settings.viewportColumnCount,height:this.settings.viewportRowCount}},adjustPageToBounds:function(a){a.top>0&&a.top+a.height>this.totalRows&&(a.top=Math.max(0,this.totalRows-a.height),a.height=Math.min(this.totalRows,a.height)),a.left>0&&a.left+a.width>this.totalColumns&&(a.left=Math.max(0,this.totalColumns-a.width),a.width=Math.min(this.totalColumns,a.width))},onVirtualScroll:function(a,b){this.Scroll.emit();var c=this.virtualScrollApi.getVirtualPosition(),d=this.virtualScrollApi.getMaxPosition(),e=this.getPage(c);return this.alignToBottomReduce.active&&b<0&&(this.graduallyLeaveAlignToBottomReduce(e),d=this.virtualScrollApi.getMaxPosition()),"reduce"===this.settings.alignToBottom&&d.vPosY>0&&c.vPosY===d.vPosY&&(this.alignToBottomReduce.active=!0),this.adjustPageToBounds(e),this.axisDelta.xAxis=a,this.axisDelta.yAxis=b,this.dataApi.onVirtualScroll(e.top,e.height,e.left,e.width,a,b).then(function(){this.updateAlignToBottom()}.bind(this))},updateAlignToBottom:function(){"reduce"===this.settings.alignToBottom?this.updateAlignToBottomReduce():this.updateAlignToBottomAbsolute()},updateAlignToBottomAbsolute:function(){var a=this.virtualScrollApi.getVirtualPosition(),b=this.virtualScrollApi.getMaxPosition();this.virtualScrollApi.isVerticalScrollEnabled()&&a.vPosY===b.vPosY?this.alignBottomAbsolute=!0:this.alignBottomAbsolute=!1},updateAlignToBottomReduce:function(){var a=!1;if(this.alignToBottomReduce.active){if(this.axisDelta.yAxis>0){var b=this.domApi.getVisibleRowCount(this.settings.maxRowHeight);this.settings.viewportRowCount=Math.max(1,b)}else{var c=Math.ceil(this.domApi.getScrollAreaClientHeight()/this.settings.minRowHeight);this.settings.viewportRowCount>=c&&(this.alignToBottomReduce.active=!1),a=!0}var d=this.domApi.getScrollAreaBoundingBox();this.virtualScrollApi.setViewport({top:0,left:0,width:d.width,height:d.height}),this.virtualScrollApi.setVirtualViewport({width:d.width,height:this.settings.viewportRowCount*this.settings.minRowHeight}),a&&this.virtualScrollApi.setVirtualScrollPos(0,-1)}},graduallyLeaveAlignToBottomReduce:function(a){var b=Math.ceil(this.domApi.getScrollAreaClientHeight()/this.settings.minRowHeight);this.alignToBottomReduce.activeFromStart||(a.height=Math.min(this.totalRows-a.top,b),this.settings.viewportRowCount=a.height)},updateLoadingButtons:function(){var a=this.dataApi.getFirstElementIndex();a+this.dataApi.getRowCount()>=this.totalRows||0===this.totalRows||a<0?this.loadNext=!1:this.loadNext=!0,this.loadPrevious=a>0},resetNativeScroll:function(){return this.ignoreScroll=!0,this.loadNext=!1,this.loadPrevious=!1,this.domApi.resetNativeScroll(),function(){this.ignoreScroll=!1}.bind(this)},onNativeScroll:function(){if(this.Scroll.emit(),!this.ignoreScroll){var a=this.dataApi.getLastElementIndex()+1,b=this.settings.blockSize-a;this.ignoreScroll=!0,this.dataApi.onInitialNativeScroll(a,b).then(function(){this.updateLoadingButtons()}.bind(this))}},gotoNextBlock:function(){this.loaderApi.fadeIn(this.domApi.getScrollAreaOffsetTop(),this.domApi.getScrollAreaBoundingBox()).then(function(){var a=this.domApi.alignToLastRow(),b=this.dataApi.getLastElementIndex()+1,c=this.settings.blockSize-this.settings.keepItemsCount;this.dataApi.onGotoNextBlock(b,c).then(function(){this.updateLoadingButtons(),this.$timeout(function(){a(),this.$timeout(function(){this.loaderApi.fadeOut()}.bind(this))}.bind(this))}.bind(this))}.bind(this))},gotoPreviousBlock:function(){this.loaderApi.fadeIn(this.domApi.getScrollAreaOffsetTop(),this.domApi.getScrollAreaBoundingBox()).then(function(){var a=this.domApi.alignToFirstRow(),b=this.settings.blockSize-this.settings.keepItemsCount,c=this.dataApi.getFirstElementIndex()-b;c<0&&(b+=c,c=0),this.dataApi.onGotoPreviousBlock(c,b).then(function(){this.updateLoadingButtons(),this.$timeout(function(){a(),this.$timeout(function(){this.loaderApi.fadeOut()}.bind(this))}.bind(this))}.bind(this))}.bind(this))}})}),define("general.scroll/api/simple-list-data-api",["core.utils/deferred","general.scroll/api/data-api"],function(a,b){"use strict";return b.extend({init:function(a){this.list=[],this.scrollApi=a},getRowCount:function(){return this.scrollApi.items?this.scrollApi.items.length:0},getFirstElementIndex:function(){return this.list.indexOf(this.scrollApi.items[0])},getLastElementIndex:function(){return this.list.indexOf(this.scrollApi.items[this.scrollApi.items.length-1])},getItems:function(a,b){return this.list.slice(Math.max(0,a),a+b)},setItems:function(a,b){this.scrollApi.items=this.getItems(a,b)},setList:function(a,b){this.list=a,this.scrollApi.setTotalRows(this.list.length);var c=this.getRowCount(),d=b&&c>0?this.getFirstElementIndex():0;this.scrollApi.virtualScrollEnabled?(this.setItems(d,this.scrollApi.settings.viewportRowCount),this.scrollApi.setVirtualSize(b)):b?(c=Math.min(a.length-d,Math.max(this.getRowCount(),this.scrollApi.settings.blockSize)),this.setItems(d,c),this.scrollApi.updateLoadingButtons()):(this.setItems(d,this.scrollApi.settings.viewportRowCount+1),this.scrollApi.resetNativeScroll()())},resize:function(){this.scrollApi.updateViewport();var b=this.getRowCount(),c=b>0?this.getFirstElementIndex():0;return 0!==c&&c+this.scrollApi.settings.viewportRowCount>b&&(c=Math.max(0,b-this.scrollApi.settings.viewportRowCount)),this.scrollApi.virtualScrollEnabled?(this.setItems(c,this.scrollApi.settings.viewportRowCount),this.scrollApi.setVirtualSize(!0)):0===c&&b<this.scrollApi.settings.blockSize?(this.setItems(c,this.scrollApi.settings.viewportRowCount+1),this.scrollApi.resetNativeScroll()(),a.resolve()):a.resolve()},onVirtualScroll:function(b,c){return this.setItems(b,c),a.resolve()},onInitialNativeScroll:function(b,c){return this.setItems(0,b+c),a.resolve()},onGotoNextBlock:function(b,c){var d=this.scrollApi.settings.keepItemsCount+this.scrollApi.settings.viewportRowCount;return this.setItems(b-d,c+d),a.resolve()},onGotoPreviousBlock:function(b,c){var d=this.scrollApi.settings.keepItemsCount+this.scrollApi.settings.viewportRowCount;return this.setItems(b,c+d),a.resolve()}})}),function(a,b){"use strict";var c=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],d={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15},e=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],f=function(a){return h(a,!0)},g=function(a){return h(a,!1)},h=function(a,b){void 0===b&&(b=!0);var c=k(a)?m(a):l(a);if(b)var d=1779033703,f=3144134277,g=1013904242,h=2773480762,n=1359893119,o=2600822924,p=528734635,q=1541459225;else var d=3238371032,f=914150663,g=812702999,h=4144912697,n=4290775857,o=1750603025,p=1694076839,q=3204075428;for(var r=0,s=c.length;r<s;r+=16){for(var t,u,v=[],w=0;w<16;++w)v[w]=c[r+w];for(var w=16;w<64;++w)t=i(v[w-15],7)^i(v[w-15],18)^v[w-15]>>>3,u=i(v[w-2],17)^i(v[w-2],19)^v[w-2]>>>10,v[w]=v[w-16]+t+v[w-7]+u;for(var x,y,z,A,B=d,C=f,D=g,E=h,F=n,G=o,H=p,I=q,w=0;w<64;++w)t=i(B,2)^i(B,13)^i(B,22),x=B&C^B&D^C&D,z=t+x,u=i(F,6)^i(F,11)^i(F,25),A=F&G^~F&H,y=I+u+A+e[w]+v[w]&4294967295,I=H,H=G,G=F,F=E+y,E=D,D=C,C=B,B=y+z;d+=B,f+=C,g+=D,h+=E,n+=F,o+=G,p+=H,q+=I}var J=j(d)+j(f)+j(g)+j(h)+j(n)+j(o)+j(p);return b&&(J+=j(q)),J},i=function(a,b){return a>>>b|a<<32-b},j=function(a){for(var b="",d=0;d<4;d++){var e=3-d<<3;b+=c[a>>e+4&15]+c[a>>e&15]}return b},k=function(a){for(var b=a.length;b--;)if(a.charCodeAt(b)>255)return!0;return!1},l=function(a){var b,c=a.length,d=1+(c+8>>6),e=d<<4,f=[];for(b=0;b<e;++b)f[b]=0;for(b=0;b<c;++b)f[b>>2]|=a.charCodeAt(b)<<(3-b%4<<3);return f[b>>2]|=128<<(3-b%4<<3),f[e-1]=c<<3,f},m=function(a){for(var b=encodeURIComponent(a),c=[],e=0,f=0,g=b.length;e<g;++e){var h=b.charCodeAt(e);c[f>>2]|=37==h?(d[b.charAt(++e)]<<4|d[b.charAt(++e)])<<(3-f%4<<3):h<<(3-f%4<<3),++f}var i=1+(f+8>>6),j=i<<4,k=f>>2;c[k]|=128<<(3-f%4<<3);for(var e=k+1;e<j;++e)c[e]=0;return c[j-1]=f<<3,c};window.sha256=f,window.sha224=g}(),define("sha256",function(){}),define("assets/datamodelviewer/utils/dmv-crypto-util",["sha256"],function(){function a(a){if(void 0===a)throw new Error("String is undefined.");if(0===a.length)throw new Error("String is empty.");return sha256(a)}return{sha256:a}}),define("client.views/global-selections/directives/scroll/scroll",["qvangular","text!./scroll.ng.html","core.utils/class","objects.models/listbox","objects.utils/data-properties/listobject-util","core.utils/resize","core.utils/deferred","general.scroll/api/vertical-scroll-api","general.scroll/api/dom-api","general.scroll/api/simple-list-data-api","jquery","util","general.utils/shapes/rect","assets/datamodelviewer/utils/dmv-crypto-util","client.utils/rtl/direction-service","client.views/selection-toolbar/selection-toolbar-service","general.scroll/scroll-area"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){"use strict";function p(a,b){for(;a.length>b;)a.pop()}var q=j.extend({init:function(){this.resetColumnIndex(),this._super.apply(this,arguments)},resetColumnIndex:function(){this.columnIndex=0},setList:function(a){this.list=a,this.scrollApi.setTotalRows(this.list.length),this.setItems(this.columnIndex,this.scrollApi.settings.blockSize),this.scrollApi.updateLoadingButtons()},onInitialNativeScroll:function(){return g.resolve()},onGotoNextBlock:function(){return this._super.apply(this,arguments).then(function(){this.columnIndex=this.getFirstElementIndex()}.bind(this))},onGotoPreviousBlock:function(){return this._super.apply(this,arguments).then(function(){this.columnIndex=this.getFirstElementIndex()}.bind(this))}}),r=i.extend({resetNativeScroll:function(){this.$scrollArea.scrollLeft(0)},alignToFirstRow:function(){var a=this.getFirstRow(),b=a.children(".qv-object-wrapper").attr("id");return function(){var a,c=k(this.$scrollArea.find("#"+b));c.length>0&&(a=c.offset().left-260,this.$scrollArea.scrollLeft(a))}.bind(this)},alignToLastRow:function(){var a=this.getLastRow(),b=a.children(".qv-object-wrapper").attr("id");return function(){var a,c=k(this.$scrollArea.find("#"+b));c.length>0&&(this.$scrollArea.scrollLeft(0),a=c.parent().position().left-this.getScrollAreaBoundingBox().width+c[0].getBoundingClientRect().width+250,this.$scrollArea.scrollLeft(a))}.bind(this)},getBoundingBox:function(){var a=this._super.apply(this,arguments);return new m(a.top,a.left,a.height,a.width)}}),s=c.extend({size:{width:0,height:0},itemSize:0,itemSpacing:0,$element:void 0,init:function(a,b,c){this.$scope=a,this.$timeout=b,this.selectionToolbarService=c,this.$scope.items=[],this.$scope.options={direction:o.direction}},initialize:function(a,b,c){this.setSize(b),this.setItemSize(c.itemSize),this.setItemSpacing(c.itemSpacing),this.setElement(a.find(".qv-gs-scroll-area")),this.setItems(),this.initialized=!0},updateVisible:function(){var a=this.offsetX-(this.$scope.scrollApi.loadPrevious?1:0),b=this.visibleItemsCount;this.$scope.items.forEach(function(c,d){var e=d>=a&&d<a+b;!c.visible&&e&&(c.options={isPopOver:!1,highlightTitle:!0,direction:o.direction}),e&&!c.model&&this.getModel(c).then(function(a,b){a.model=b}.bind(null,c)),c.visible=e},this)},getModel:function(a){var b,c=this.getInitProps(a.title);return a.qField?b=d.createTransientField(this.$scope.app,a.qField,c):a.qId&&(b=d.createTransientDimension(this.$scope.app,a.qId,c)),b},onScroll:function(){this.qvGlobalSelectionsCtrl.setIgnoreUpdates(!1),this.selectionToolbarService.confirm(),this.updateHighlights(),this.$timeout.cancel(this.scrollTimeout),this.scrollTimeout=this.$timeout(function(){this.updateVisible(),this.updateHighlights()}.bind(this),100)},onResize:function(a){this.setSize(a),this.updateVisible()},updateHighlights:function(){this.$scope.items.forEach(function(a){a.options.highlightQuery=this.$scope.filter},this)},setItems:function(){var a,b,c,d=this.$scope,e=this.totalItemsCount;for(d.items.length!==e&&p(d.items,e),a=0;a<e;a++)b=d.items[a]||{},c=d.scrollApi.items[a],c.enableBadge&&(b.enableBadge=c.enableBadge),b.model||(b.options={isPopOver:!1,highlightTitle:!0,direction:o.direction}),c.qField?(delete b.qId,b.model&&b.qField===c.qField||(b.visible&&(d.items[a]=l.extend(!0,{},b),b=d.items[a],delete b.$$hashKey,delete b.options.search),b.title=c.title,b.qField=c.qField,b.id=n.sha256(b.qField),delete b.model)):c.qId&&(delete b.qField,b.model&&b.qId===c.qId||(b.visible&&(d.items[a]=l.extend(!0,{},b),b=d.items[a],delete b.$$hashKey,delete b.options.search),b.title=c.title,b.qId=c.qId,b.id=n.sha256(b.qId),delete b.model)),d.items[a]||(d.items[a]=b);this.updateVisible()},getInitProps:function(a){var b={title:a,qListObjectDef:{qDef:{}}};return e.autoSortDimension(b.qListObjectDef),b},getWidthOf:function(a){return this.totalItemSize*a-this.itemSpacing},setItemSize:function(a){this.itemSize=a||220},setItemSpacing:function(a){this.itemSpacing=a||20},setSize:function(a){this.size=a},setElement:function(a){this.$element=a,this.$element.on("scroll",this.onScroll.bind(this))}});Object.defineProperties(s.prototype,{vPosX:{get:function(){return this.$element.scrollLeft()}},totalItemSize:{get:function(){return this.itemSize+this.itemSpacing}},visibleItemsCount:{get:function(){var a=Math.ceil(((this.vPosX+(this.previousBtnVisible?240:0))%this.totalItemSize+this.size.width)/this.totalItemSize);return Math.min(a,this.totalItemsCount+(this.previousBtnVisible?1:0))}},totalItemsCount:{get:function(){return(this.$scope.scrollApi.items||[]).length}},offsetX:{get:function(){return Math.floor(this.vPosX/this.totalItemSize)}},previousBtnVisible:{get:function(){return!!this.$scope.scrollApi.loadPrevious}}}),s.$inject=["$scope","$timeout","qvSelectionToolbarService"],a.directive("qvGlobalSelectSection",["$parse","$timeout",function(a,c){return{controller:s,require:["qvGlobalSelectSection","^qvGlobalSelections"],template:b,replace:!0,scope:{allItems:"=",filter:"=",app:"="},link:function(b,d,e,g){var i=g[0],j=g[1],k=a(e.qvGlobalSelectSection)(),l={},m=d.find(".qv-gs-scroll-area"),n=m.controller("qvScrollArea"),o=d.find(".qv-scroll-loader").controller("qvScrollLoader"),p={blockSize:24,minRowHeight:240,maxRowHeight:240,keepItemsCount:4,virtualScrollEnabled:!1},s=b.scrollApi=new h(c,p),t=new q(s),u=new r(d,m,".qv-gs-listbox",".qv-gs-listbox:first",".qv-gs-listbox:last"),v=null,w=function(){l.width=d.innerWidth(),l.height=d.innerHeight(),i.onResize(l)};i.qvGlobalSelectionsCtrl=j,s.initialize(u,t,n,o).then(function(){s.activate(),s.updateViewport(),b.$watch("filter",function(){t.resetColumnIndex(),s.resetNativeScroll()}),b.$watch("allItems",function(a){a&&(t.setList(a),v&&v(),v=b.$watch("scrollApi.items",function(){j.ignoreUpdates||(0===s.items.length&&b.allItems.length>0&&(s.resetNativeScroll(),t.resetColumnIndex(),t.setList(a)),i.initialized&&i.setItems())}))})}),c(function(){l.width=d.innerWidth(),l.height=d.innerHeight(),i.initialize(d,l,k)}),f.on("end",w),b.$on("$destroy",function(){f.off("end",w),s.destroy()}),j.addCallback(k.type,function(){i.$timeout(function(){i.setItems(),i.$timeout(function(){i.updateHighlights()})})})}}}])}),define("text!client.views/global-selections/directives/badge/badge.ng.html",[],function(){return'<div class="qv-gs-badge" ng-if="item.showBadge" q-title-translation="Tooltip.clearSelection" tid="globalSelections.badge" qva-activate="badgeClick(item)">\n\t<span class="lui-icon lui-icon--remove"></span>\n</div>\n'}),define("objects.backend-api/listbox-api",["./backend-api"],function(a){"use strict";return a.extend("Listbox",{init:function(a){this._super(a,"/qListObjectDef",{width:1}),this.cacheCube.setMethodName("getListObjectData")},select:function(a,b,c){return this.model.selectListObjectValues(this.path,b,c)},selectAll:function(){return this.model.selectListObjectAll(this.path)},selectPossible:function(){return this.model.selectListObjectPossible(this.path)},selectAlternative:function(){return this.model.selectListObjectAlternative(this.path)},selectExcluded:function(){return this.model.selectListObjectExcluded(this.path)},search:function(a){return this.model.searchListObjectFor(this.path,a)},abortSearch:function(){return this.model.abortListObjectSearch(this.path)},confirmSearch:function(a){return this.model.acceptListObjectSearch(this.path,a)},updateCache:function(a){this.cacheCube.set(a.qListObject.qDataPages),this.cacheCube.setCubeSize(a.qListObject.qSize)},setInitialData:function(a){this.cacheCube.set(a.qListObject.qDataPages)},getData:function(a){return this.cacheCube.getData(a)},getDataPage:function(a){return this.getData([a]).then(function(a){return a[0]})},getSize:function(){return this.model.layout.qListObject.qSize},lock:function(){return this.model.lock(this.path)},unlock:function(){return this.model.unlock(this.path)},isLocked:function(){return!(!this.model.layout||!this.model.layout.qListObject)&&!!this.model.layout.qListObject.qDimensionInfo.qLocked},isDrillDown:function(){return!(!this.model.layout||!this.model.layout.qListObject)&&"H"===this.model.layout.qListObject.qDimensionInfo.qGrouping},getDimensionInfos:function(){return this.model.layout&&this.model.layout.qListObject?[this.model.layout.qListObject.qDimensionInfo]:[]}})}),define("client.views/global-selections/directives/badge/badge",["qvangular","text!./badge.ng.html","objects.backend-api/listbox-api"],function(a,b,c){a.directive("qvGsBadge",function(){return{restrict:"E",template:b,replace:!0,link:function(b){b.item.enableBadge&&(b.item.object||(b.item.object={}),b.$watchCollection("[item.model.layout.qListObject.qDimensionInfo.qLocked, item.object.selectionsApi.active]",function(c){a.$apply(function(){b.item.showBadge=(void 0===c[0]||c[0]===!1)&&c[1]===!1})}),b.badgeClick=function(a){var b=new c(a.model);b.beginSelections(),b.clearSelections(),b.endSelections(!0)})}}})}),define("client.views/global-selections/global-selections",["jquery","qvangular","text!./global-selections.ng.html","general.utils/support","client.assets/assets-utils","core.utils/class","client.assets/tab-contents/fields/assets-field-list-model","core.utils/deferred","core.utils/resize","client.assets/tab-contents/fields/assets-directdiscovery-service","objects.utils/type-loader","touche","client.views/selection-toolbar/selection-toolbar-service","client.views/global-selections/directives/scroll/scroll","client.views/global-selections/directives/badge/badge","client.views/global-selections/global-selections-service"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=".globalSelections",n=f.extend({init:function(b,c){var e=this;this.$scope=b,this.callbacks=[],this.ignoreUpdates=!1,this.hasLoaded=!1,b.dimensions=[],b.dimensionsFields=[],b.selectedFields=[],b.fields=[],b.dimAvailable=!1,b.showFields=c.getShowFields(b.app),b.showFieldsCheckbox=!0,b.filter="",b.autoFocus=d.treatAsDesktop(),b.selectionToolbarOpen=!1,b.showNoMatches=!1,h.all({fields:this.getFields(),select:this.bindCurrentSelections(),dim:this.getLibraryDimensions(),reg:this.registerExtensions()}).then(function(){e.hasLoaded=!0,b.showFieldsCheckbox=b.fields.length>0,b.dimAvailable=b.dimensions.length>0,!b.dimAvailable&&b.showFieldsCheckbox&&(b.showFields=!0,c.setShowFields(b.showFields,b.app)),b.$watch("filter",function(){e.filterShown(e,e.$scope)}),b.$watch("showFields",function(){c.setShowFields(b.showFields,b.app),e.filterShown(e,e.$scope)}),a(".qv-gs-section .qv-gs-header")[1].style.display="none",a(".qv-gs-section .qv-gs-header")[1].offsetHeight,a(".qv-gs-section .qv-gs-header")[1].style.display="block"})},registerExtensions:function(){var a=new h;return k.load().then(function(){a.resolve()}),a.promise},getFields:function(){var a=this.$scope;return a.app.getFieldList().then(function(b){a.fields=g.expand(b).map(function(a){return{title:a.qName,qField:a.qName,qTags:a.qTags}})})},_updateCurrentSelectionFields:function(a){var b=this,c=this.$scope;c.selectedFields=a.qSelectionObject.qSelections.filter(function(a){return!a.qIsHidden}).sort(function(a,b){return a.qSortIndex-b.qSortIndex}).map(function(a){return{title:a.qReadableName||a.qField,qField:a.qField,enableBadge:!0}}),b.hasLoaded&&b.filterShown(b,c)},handleCurrentSelectionFields:function(){var a=this;this.$scope.currentSelectionsModel.getLayout().then(function(b){a._updateCurrentSelectionFields(b)})},bindCurrentSelections:function(){var a=this.$scope,b=this;return b.$scope.app.getCurrentSelectionObject().then(function(c){a.currentSelectionsModel=c,b.subscription=c.layoutSubscribe(function(c){a.app.isInModalSelection()||b._updateCurrentSelectionFields(c)})})},getLibraryDimensions:function(){var a=this.isCalculatedField,b=this.$scope;return b.app.getDimensionList().then(function(c){b.dimensions=c.filter(function(b){return b.qData.info.length>0&&!b.qData.info.some(a)&&"H"!==b.qData.grouping}).map(function(a){return{title:a.qData.title,fieldName:a.qData.info[0].qName,qId:a.qInfo.qId}})})},isCalculatedField:function(a){return"="===a.qName[0]},filterShown:function(a,c){var d="",f=[];c.dimensionsFields=c.dimensions.filter(function(a){return!c.selectedFields.some(function(b){return a.fieldName===b.qField})}),c.showFields&&(f=c.fields.filter(function(a){return!c.selectedFields.some(function(b){return b.qField===a.qField})}),f=j.removeMeasureAndDetailsFields(f),c.dimensionsFields=c.dimensionsFields.concat(f.filter(function(a){return!c.dimensions.some(function(b){return a.qField===b.fieldName})}))),c.filter.length>0&&(d=c.filter.toLowerCase(),f=c.dimensionsFields.filter(function(a){return a.title.toLowerCase().indexOf(d)!==-1}),c.dimensionsFields=f),e.localeOrderBy(c.dimensionsFields,function(a){return a.title}),c.showNoMatches=0===c.dimensionsFields.length&&!this.ignoreUpdates&&c.filter.length>0,b.$apply(c,function(){a.notifyCallbacks(a)})},addCallback:function(a,b){this.callbacks.push({type:a,fn:b})},notifyCallbacks:function(a){a.hasLoaded&&(a.ignoreUpdates||a.callbacks.forEach(function(a){"fields"!==a.type&&"dimensions"!==a.type||a.fn()}))},setIgnoreUpdates:function(a){this.ignoreUpdates=a}});return n.$inject=["$scope","qvGlobalSelectionsService"],b.directive("qvGlobalSelections",["$document","qvSelectionToolbarService","$timeout",function(b,d,e){return{restrict:"E",template:c,controller:n,require:["qvGlobalSelections"],scope:{app:"="},replace:!0,link:function(c,f,g,h){c.toolbar=!!b.find(".qui-toolbar")[0];var j=h[0],k=function(){j.ignoreUpdates=!1},n=function(){c.selectionToolbarOpen=!1,e(function(){j.handleCurrentSelectionFields()})},o=function(){c.selectionToolbarOpen=!0};d.Closed.bind(n),d.Opened.bind(o),b.on("keyup"+m,function(a){27===a.which?j.ignoreUpdates=!1:13===a.which&&(j.ignoreUpdates=!1)}),l(b[0].body).tap({id:m,options:{preventDefault:!1},start:function(b){
var c=a(b.target).closest(".qv-gs-badge").length>0,d=a(b.target).closest(".qv-gs-listbox").length>0,e=a(b.target).closest(".qv-selection-toolbar").length>0;j.ignoreUpdates=d&&!c&&!e}}),i.on("start",k),c.$on("$destroy",function(){j.callbacks=[],d.Closed.unbind(n),d.Opened.unbind(o),l(b[0].body).off("*",m),b.off(m),i.off("start",k),j.subscription&&j.subscription.dispose()}),c.onEnter=function(a){a.stopPropagation(),a.target.blur()}}}}]),'<qv-global-selections app="app"></qv-global-selections>'}),define("text!client.views/mobile-selections/mobile-selections.ng.html",[],function(){return'<div class="qv-mobile-selections" tid="{{\'mobileSelections.showFields.\' + filter.showFields}}">\n\t<div class="qv-ms-toolbar">\n\t\t<p qva-activate="selectionsBack()" ng-class="{\'qv-ms-button-disabled\' : disable.back, \'qv-ms-button-enabled\': !disable.back}" class="qv-ms-toolbar-buttons" tid="mobileSelections.back" q-title-translation="Tooltip.NavigateBack"><</p>\n\t\t<p qva-activate="selectionsForward()" ng-class="{\'qv-ms-button-disabled\' : disable.forward, \'qv-ms-button-enabled\': !disable.forward}" class="qv-ms-toolbar-buttons" tid="mobileSelections.forward" q-title-translation="Tooltip.NavigateForward">=</p>\n\t\t<p qva-activate="selectionsClear()" ng-class="{\'qv-ms-button-disabled\' : disable.clear, \'qv-ms-button-enabled\': !disable.clear}" class="qv-ms-toolbar-buttons" tid="mobileSelections.clear" q-title-translation="Tooltip.ClearSelections">:</p>\n\t\t<p qva-activate="toggleMenu()" ng-class="{\'qv-ms-button-disabled\' : !enableMenu, \'qv-ms-button-enabled\': enableMenu, \'qv-ms-button-menu-active\': menuActive }" class="qv-ms-toolbar-buttons" id="mobileSelectionsMenu" tid="mobileSelections.showMenu" qva-outside-ignore-for="allOutside" q-title-translation="Toolbar.Menu">¨</p>\n\n\t\t<qui-toolbarbutton qva-activate="close($event)" name="close" class="qv-ms-toolbar-close" tid="mobileSelections.close">\n\t\t\t<span q-translation="Common.Close" class="qv-ms-toolbar-close-text"></span>\n\t\t</qui-toolbarbutton>\n\t</div>\n\t<header class="qv-ms-header">\n\t\t<h2 q-translation="GlobalSelections.CurrentSelections"></h2>\n\t</header>\n\t<lui-search x-variant="inverse" class="qv-ms-searchbox" placeholder="{{filter.showFields ? \'GlobalSelections.FilterDimensionsAndFields\' : \'GlobalSelections.FilterDimensions\'}}" query="filter.filter" maxlength="255"\n\t\ton-enter="filter.onEnter($event)" tid="mobileSelections.searchfield">\n\t</lui-search>\n\t<div class="qv-ms-scroll-area">\n\t\t<qv-ms-selected ng-repeat="item in selectedFields"></qv-ms-selected>\n\t\t<div class="qv-ms-selectable" ng-if="filter.filter.length && (!selectables || selectables.length === 0)">\n\t\t\t<span q-translation="GlobalSelections.NoMatchesForSearch"></span>\n\t\t</div>\n\t\t<qv-ms-selectable ng-repeat="item in selectables"></qv-ms-selectable>\n\t</div>\n</div>\n'}),define("text!client.views/mobile-selections/menu/mobile-selections-menu.ng.html",[],function(){return'<immidiate-contextual align-to=" \'#mobileSelectionsMenu\' " position="\'bottom\'" on-close-view="closeView()" qva-outside-ignore-for="mobileSelectionsMenu" smallview="true">\n\t<ul class="qui-icontextlist toolbar-menu">\n\t\t<li qva-activate="toggleFields($event)" data-icon="{{fieldsIcon}}">\n\t\t\t<span class="qui-textlist-text" q-translation="{{fieldsLabel}}"></span>\n\t\t</li>\n\t</ul>\n</immidiate-contextual>\n'}),define("client.views/mobile-selections/menu/mobile-selections-menu",["text!./mobile-selections-menu.ng.html","core.models/app","client.views/global-selections/global-selections-service"],function(a,b){"use strict";return{scope:{menuItem:"=",closeMenu:"="},template:a,controller:["$scope","qvGlobalSelectionsService",function(a,c){a.fieldsLabel=a.menuItem.model.showFields?"GlobalSelections.HideFields":"GlobalSelections.ShowFields",a.fieldsIcon=a.menuItem.model.showFields?"remove":"add",a.toggleFields=function(d){d.preventDefault(),a.menuItem.model.showFields=!a.menuItem.model.showFields,c.setShowFields(a.menuItem.model.showFields,b.current),a.closeMenu()},a.closeView=function(){a.closeMenu()}}]}}),define("general.utils/qv-keyboard-shortcuts",["jquery","general.utils/dom-util"],function(a,b){"use strict";function c(){this.groups=[],this.shortcuts=[],this.timer={id:null},this.isReleased=!0,this.currentEvent=void 0}var d={a:65,alt:18,b:66,backspace:8,c:67,ctrl:17,d:68,del:46,down:40,e:69,f:70,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,enter:13,esc:27,g:71,h:72,home:36,i:73,insert:45,j:74,k:75,l:76,left:37,m:77,n:78,o:79,p:80,pagedown:34,pageup:33,q:81,r:82,right:39,s:83,shift:16,space:32,t:84,tab:9,u:85,up:38,v:86,w:87,win:224,x:88,y:89,z:90,cmd:91,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,0:48,"*":106},e=!1;return c.prototype.createGroup=function(a,b){var c,d,e=this;for(d=0;d<this.groups.length;d++)if(this.groups[d].name===a){c=this.groups[d];break}if(c)throw"Keyboard shortcut group already exist: "+a;return c={name:a,priority:b,active:!1,shortcuts:[]},this.groups.push(c),this.groups.sort(function(a,b){return a.priority-b.priority}),{registerKeys:function(a,b,d){e.registerKeys(c,a,b,d)},unregisterKeys:function(a,b){for(var d=c.shortcuts,e=0;e<d.length;e++)if(d[e].keyCombo===a&&d[e].callback===b){d.splice(e,1);break}},on:function(){e.activateGroup(c)},off:function(){e.deactivateGroup(c)},delete:function(){e.deactivateGroup(c),e.deleteGroup(c)}}},c.prototype.activateGroup=function(b){var c=this;b.active=!0,e||(e=!0,a(document).on("keydown.qvKeyboardShortcuts",function(a){c.handleEvent(a)}))},c.prototype.deactivateGroup=function(b){var c;b.active=!1,0===(c=this.groups.reduce(function(a,b){return b.active&&a++,a},0))&&e&&(e=!1,a(document).off("keydown.qvKeyboardShortcuts"))},c.prototype.deleteGroup=function(a){this.groups=this.groups.filter(function(b){return b!==a})},c.prototype.registerKeys=function(a,b,c,e){var f=b.toLowerCase().split("+"),g={keyCombo:b,ctrlKey:!1,shiftKey:!1,altKey:!1,keyCode:null,name:"",callback:null,allowInAllContexts:!!(e&&"allowInInput"in e)&&e.allowInInput,preventDefault:!(e&&"preventDefault"in e)||e.preventDefault,delay:e&&"delay"in e?e.delay:250};for(var h in d)for(var i=0;i<f.length;i++)g.name=b.toLowerCase(),g.callback=c,"ctrl"!==f[i]&&"cmd"!==f[i]||(g.ctrlKey=!0),"alt"===f[i]&&(g.altKey=!0),"shift"===f[i]&&(g.shiftKey=!0),f[i]===h&&17!==d[h]&&16!==d[h]&&91!==d[h]&&18!==d[h]&&(g.keyCode=d[h]);a.shortcuts.push(g)},c.prototype.preventDefault=function(){this.currentEvent&&this.currentEvent.preventDefault()},c.prototype.handleEvent=function(a){function c(b,c,f,g){for(var i,j,k=0;k<h.groups.length;k++)if(i=h.groups[k],i.active)for(var l=i.shortcuts.length-1;l>=0&&(j=i.shortcuts[l],j.keyCode!==d["*"]&&(j.keyCode!==g||j.ctrlKey!==b||j.shiftKey!==c||j.altKey!==f)||e(a,j));l--);}function e(a,c){return!(b.isInput(document.activeElement)&&!c.allowInAllContexts)&&f(a,c)}function f(a,b){if(b.preventDefault&&a.preventDefault(),"number"!=typeof h.timer.id&&(b.delay>0&&(h.timer.id=setTimeout(function(){g()},b.delay)),b.callback(b,a)===!0))return g(),!0}function g(){clearTimeout(h.timer.id),delete h.timer.id}var h=this;this.currentEvent=a,a.shiftKey?!a.ctrlKey&&!a.metaKey||a.altKey?a.ctrlKey||a.metaKey||!a.altKey||c(!0,!1,!0,a.which):c(!0,!0,!1,a.which):!a.ctrlKey&&!a.metaKey||a.altKey?a.ctrlKey||a.metaKey||!a.altKey?c(!1,!1,!1,a.which):c(!1,!1,!0,a.which):c(!0,!1,!1,a.which)},new c}),define("text!client.views/mobile-selections/directives/selectable/selectable.ng.html",[],function(){return'<div qva-activate="showSelectable()" ng-class="{\'qv-ms-touch-flash\' : item.flash}" class="qv-ms-selectable" tid="mobileSelections.selectable">\n\t<span ng-if="item.isField" class="lui-icon  lui-icon--field"></span>\n\t<div class="qv-ms-highlight">\n\t\t<span qve-highlight text="{{item.title}}" query="filter.filter"></span>\n\t</div>\n</div>\n'}),define("client.views/mobile-selections/directives/selectable/selectable",["qvangular","text!./selectable.ng.html"],function(a,b){a.directive("qvMsSelectable",["$timeout",function(a){return{restrict:"E",replace:!0,template:b,link:function(b){b.showSelectable=function(){b.item.flash=!0,a(function(){b.$emit("showListbox",b.item),b.item.flash=!1},20)}}}}])}),define("text!client.views/mobile-selections/directives/selected/selected.ng.html",[],function(){return'<div class="qv-ms-selected" tid="mobileSelections.selected">\n\t<div class="qv-ms-selected-icon">\n\t\t<a ng-show="!item.qLocked" qva-activate="clear(item.qField)">\n\t\t\t<i class="lui-icon  lui-icon--remove"></i>\n\t\t</a>\n\t\t<a ng-show="item.qLocked" qva-activate="showSelected(item.qField)">\n\t\t\t<i class="lui-icon lui-icon--lock"></i>\n\t\t</a>\n\t</div>\n\t<div qva-activate="showSelected(item.qField)" class="qv-ms-selected-info">\n\t\t<h1 class="qv-object-title">{{item.qReadableName || item.qField}}</h1>\n\t\t<span>{{item.translation}}</span>\n\t\t<qv-state-count-bar state-counts="item.qStateCounts"></qv-state-count-bar>\n\t</div>\n</div>\n'}),define("client.views/mobile-selections/directives/selected/selected",["qvangular","text!./selected.ng.html"],function(a,b){a.directive("qvMsSelected",function(){return{restrict:"E",replace:!0,template:b,link:function(a){a.showSelected=function(){a.$emit("showListbox",a.item)},a.clear=function(b){a.currentSelectionsModel.clearField(b)}}}})}),define("client.views/current-selections/current-selections-service",["qvangular","translator"],function(a,b){a.service("qvCurrentSelectionsService",[function(){return{translate:function(a){var c=a.qStateCounts.qSelected+a.qStateCounts.qSelectedExcluded+a.qStateCounts.qLocked+a.qStateCounts.qLockedExcluded,d=a.qTotal;return d===c&&d>1?b.get("CurrentSelections.All"):c>1&&d>1?b.get("CurrentSelections.Of",[c,d]):a.qSelectedFieldSelectionInfo.map(function(a){return a.qName}).join(", ").toString()}}}])}),define("objects/listbox-popover/listbox-popover-mobile",["core.utils/deferred","core.utils/resize"],function(a,b){return{template:null,controller:["$scope","$element","$timeout",function(c,d,e){function f(){e(function(){c.destroyComponent(),d.remove()}),b.off("start.listbox-popover-error",f)}var g=this;g.selectionsActivated=function(){},g.selectionsDeactivated=function(){},g.close=function(){f()},c.closeView=function(a){c.onPopoverClose(a),f()},a.all({object:c.getVisualization(),width:function(){return e(function(){return d.find(".toolbar-wrapper").outerWidth()})}()}).then(function(a){var d=a.object,e=a.width;d.getSelectionToolbar().then(function(a){c.toolbar=a,c.toolbar.showLock=c.options.showLock,c.toolbar.position={width:e},d.activateSelections()}),d.loaded.then(function(){d.ext.hasError(d)&&b.on("start.listbox-popover-error",f)}),d.selectionsApi.watchActivated(function(){g.selectionsActivated()}),d.selectionsApi.watchDeactivated(function(){g.selectionsDeactivated(),f()}),c.closeView=function(a){d.selectionsApi.confirm(),c.onPopoverClose(a),f()}})}]}}),define("text!objects/listbox-popover/listbox-popover-small-device.ng.html",[],function(){return'<div\n\tclass="qv-listbox-popover-small-device">\n\t<div class="toolbar-wrapper"\n\t\tqva-include-selection-toolbar\n\t\tcomponent="selectionToolbarComponent"\n\t\ttoolbar="toolbar"\n\t\toptions="options">\n\t</div>\n\t<h1 qva-direction x-dir-setting="{{options.direction}}" x-dir-text="{{model.layout.title || model.layout.qListObject.qDimensionInfo.qFallbackTitle}}" class="qvt-visualization-title">{{model.layout.title || model.layout.qListObject.qDimensionInfo.qFallbackTitle}}</h1>\n\t<div class="listbox-wrapper">\n\t\t<qv-object object="object" model="model" options="options"></qv-object>\n\t</div>\n</div>\n'}),define("objects/listbox-popover/listbox-popover-service-mobile",["qvangular","util","core.utils/deferred","objects.models/listbox","client.views/selection-toolbar/selection-toolbar","objects/listbox-popover/listbox-popover-mobile","general.utils/responsive-state","text!./listbox-popover-small-device.ng.html","objects/object","general.components/immidiate-contextual/immidiate-contextual"],function(a,b,c,d,e,f,g,h){a.service("qvListboxPopoverServiceMobile",["$document",function(a){var i,j,k=a.find("body");return{show:function(a,d,l,m){var n=c(),o={$alignToElement:d.$alignToElement,popupPosition:d.position||"bottom",collision:d.collision||"none",qvaOutsideIgnoreFor:d.qvaOutsideIgnoreFor,getVisualization:function(){return n.promise},model:a,onPopoverClose:this.onPopoverClose,options:{setController:n.resolve,isPopover:!0,showLock:d.showLock,search:d.search||{},smallDevice:g.isSmallDevice,direction:d.direction},selectionToolbarComponent:e};return j&&(j.selectionsActivated=function(){},j.selectionsDeactivated=function(){},j.close()),i=angular.element("<div>"),k.append(i),f.template=h,j=i.showComponent(f,o),j.selectionsActivated=function(){b.isFunction(m)&&m()},j.selectionsDeactivated=function(){b.isFunction(l)&&l(),l=null,m=null},j},showField:function(a,b,e,f,g,h){return d.createTransientField(b,a,f).then(function(a){return c.resolve(this.show(a,e,g,h))}.bind(this))},showDimension:function(a,b,c,e,f,g){d.createTransientDimension(b,a,e).then(function(a){this.show(a,c,f,g)}.bind(this))},close:function(){j&&j.close()},onPopoverClose:function(){}}}])}),define("client.views/mobile-selections/mobile-selections",["qvangular","text!./mobile-selections.ng.html","client.models/current-selections","general.models/library/dimension","general.models/field","client.assets/assets-utils","core.utils/deferred","core.models/app","objects.models/listbox","general.services/show-service/show-service","client.views/mobile-selections/menu/mobile-selections-menu","client.assets/tab-contents/fields/assets-directdiscovery-service","general.utils/qv-keyboard-shortcuts","client.views/global-selections/global-selections-service","client.views/mobile-selections/directives/selectable/selectable","client.views/mobile-selections/directives/selected/selected","client.views/current-selections/current-selections-service","objects.views/charts/tooltip/chart-tooltip-service","objects/listbox-popover/listbox-popover-service-mobile"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(b,c){var d="",e=[];b.selectables=c.dimensions.filter(function(a){return!b.selectedFields.some(function(b){return a.qField===b.qField})}),b.filter.showFields===!0&&(e=c.fields.filter(function(a){return!b.selectedFields.some(function(b){return b.qField===a.qField})}),e=l.removeMeasureAndDetailsFields(e),b.selectables=b.selectables.concat(e.filter(function(a){return!c.dimensions.some(function(b){return a.qField===b.qField})}))),b.filter.filter.length>0&&(d=b.filter.filter.toLowerCase(),e=b.selectables.filter(function(a){return a.title.toLowerCase().indexOf(d)!==-1}),b.selectables=e),f.localeOrderBy(b.selectables,function(a){return a.title}),a.$apply(b)}function o(a){return a.every(function(a){return a.qLocked})}function p(b,d){var e=new g,f=a.getService("qvCurrentSelectionsService");return c.get().then(function(a){b.currentSelectionsModel=a,c.bindLayout(b,"currentSelectionsModel",function(a){b.disable={clear:0===a.qSelectionObject.qSelections.length||o(a.qSelectionObject.qSelections),back:0===a.qSelectionObject.qBackCount,forward:0===a.qSelectionObject.qForwardCount},b.selectedFields=a.qSelectionObject.qSelections.filter(function(a){return!a.qIsHidden}).sort(function(a,b){return a.qSortIndex-b.qSortIndex}),b.selectedFields.forEach(function(a){a.translation=f.translate(a)}),d.hasLoaded&&n(b,d)}),e.resolve()}),e.promise}function q(a){var b=function(a){return"="===a.qName[0]},c=new g;return d.getList().then(function(d){d.getLayout().then(function(d){a.dimensions=d.filter(function(a){return a.qData.info.length>0&&!a.qData.info.some(b)&&"H"!==a.qData.grouping}).map(function(a){return{title:a.qData.title,qField:a.qData.info[0].qName,qId:a.qInfo.qId}}),c.resolve()})}),c.promise}function r(a){var b=new g;return e.getListLayout().then(function(c){a.fields=c.map(function(a){return{title:a.qName,qField:a.qName,qTags:a.qTags,isField:!0}}),b.resolve()}),b.promise}var s=["$scope","qvGlobalSelectionsService",function(b,c){var d={hasLoaded:!1,dimensions:[],fields:[]};b.selectedFields=[],b.filter={filter:"",showFields:c.getShowFields(h.current),onEnter:function(a){a.stopPropagation(),a.target.blur()}},b.selectables=[],b.enableMenu=!0,b.disable={clear:!1,back:!1,forward:!1},a.getService("qvChartTooltipService").close(),g.all({selectionsDfd:p(b,d),dimensionsDfd:q(d),fieldsDfd:r(d)}).then(function(){d.hasLoaded=!0,b.enableMenu=d.fields.length>0,d.dimensions.length<=0&&b.enableMenu&&(b.filter.showFields=!0,c.setShowFields(b.filter.showFields,h.current)),b.$watch("filter",function(){n(b,d)},!0)})}];return a.directive("qvMobileSelections",["qvGlobalSelectionsService","qvListboxPopoverServiceMobile",function(a,d){return{restrict:"E",template:b,controller:s,replace:!0,require:["qvMobileSelections"],scope:{},link:function(b,e){var f,l=null,n=function(){l.destroy(),l=null,b.menuActive=!1},o=function(){e.find(".qv-ms-scroll-area").animate({scrollTop:0})},p=m.createGroup("mobile-selections",0);p.registerKeys("enter",function(){}),p.on(),document.activeElement&&document.activeElement.blur(),b.close=function(b){b.preventDefault(),a.off()},b.selectionsBack=function(){b.disable.back||b.currentSelectionsModel.back()},b.selectionsForward=function(){b.disable.forward||b.currentSelectionsModel.forward()},b.selectionsClear=function(){b.disable.clear||b.currentSelectionsModel.clearAll()},b.toggleMenu=function(){l?n():b.enableMenu&&(b.menuActive=!0,l=j.show(k,{menuItem:{model:b.filter},closeMenu:n}))},b.$on("showListbox",function(a,j){var k={title:j.qReadableName||j.title,qListObjectDef:{qDef:{}}},l=b.selectedFields.indexOf(j)!==-1,m=function(){c.getLayout().then(function(a){if(!l&&a.qSelectionObject.qSelections.some(function(a){return j.qField===a.qField}))return void f.resolve();f.reject()})},n=function(a){f&&f.reject(),f=new g,f.promise.then(o),e.children(".qv-ms-searchbox").find("input").blur(),d.show(a,{showLock:!0},m)};j.qField?i.createTransientField(h.current.enigmaModel,j.qField,k).then(n):i.createTransientDimension(h.current.enigmaModel,j.qId,k).then(n)}),b.$on("$destroy",function(){l&&(l.destroy(),l=null),f&&f.reject(),p.delete()})}}}]),"<qv-mobile-selections></qv-mobile-selections>"}),define("client.views/global-selections/global-selections-service",["jquery","qvangular","client.views/global-selections/global-selections","client.views/mobile-selections/mobile-selections","client.utils/state","general.utils/responsive-state","core.models/app"],function(a,b,c,d,e,f,g){b.service("qvGlobalSelectionsService",["$document",function(b){function h(a){return r[j(a)]}function i(a,b){r[j(a)]=b}function j(a){return a.id.toUpperCase()}function k(a){return{$container:void 0,$app:a,$selectionCount:!1,$showFields:!1,getComponent:function(){return f.isSmallDevice?d:c},setup:function(){f.ViewChanged.bind(l)},destroy:function(){f.ViewChanged.unbind(l)}}}function l(){var a=h(g.current);n(a),m(a)}function m(a){a.$container=angular.element("<div>"),b.find("body").append(a.$container),a.$container.showComponent(a.getComponent(),["$scope",function(b){b.app=a.$app}]),a.setup()}function n(a){a.$container&&(a.$container.remove(),a.$container=void 0),a.destroy()}function o(a){var b=h(a);return b||(b=new k(a.enigmaModel),i(a,b)),b}function p(a){return a&&void 0!==a.$container}function q(b){p(b)?(n(b),a("body").removeClass("qv-global-selections-enabled")):(e.setState(e.States.analysis),a("body").addClass("qv-global-selections-enabled"),m(b))}var r={},s=null;return{toggleGlobalSelection:function(a){a=a||g.current,q(o(a))},off:function(){Object.keys(r).forEach(function(a){n(r[a])})},isSelectActive:function(a){a=a||g.current;var b=h(a);return!(void 0===a||!p(b))},setCsShowCallback:function(a){s=a},setCsShow:function(a){s&&s(a)},setSelectionCount:function(a,b){o(b).$selectionCount=a},getSelectionCount:function(a){return a=a||g.current,(h(a)||{}).$selectionCount},setShowFields:function(a,b){o(b).$showFields=a},getShowFields:function(a){return a=a||g.current,!!(h(a)||{}).$showFields}}}])}),define("text!client.views/global-search/global-search.ng.html",[],function(){return'<div>\n\t<div class="qv-global-search" ng-class="{ \'overlay\': displaySuggestions || displayResult.data || displayResult.visuals }" ng-style="{paddingTop: toolbarHeight}" tid="globalSearch">\n\t\t<qv-global-search-input class="qv-global-search-input"></qv-global-search-input>\n\t\t<div class="qv-global-search-line" ng-if="!showMobileIndexProgressBar"></div>\n\t\t<qv-mobile-index-progress ng-if="isSmallDevice && query.length === 0 && isIndexClosedFeature"></qv-mobile-index-progress>\n\t\t<qv-global-search-history ng-if="isSearchHistoryFeature && searchInputFocused && query.length === 0"></qv-global-search-history>\n\t\t<div class="qv-global-search-dimmer" ng-if="query.length > 0 || forceShowDimmer" ng-style="dimmerStyles">\n\t\t\t<qv-global-search-result tid="globalSearch.ResultList"></qv-global-search-result>\n\t\t\t<div ng-show="scrollShow && !activity.show" class="scroll-affordance scroll-vertical"></div>\n\t\t</div>\n\t</div>\n\t<div class="qv-global-search-glass" ng-if="query.length > 0" qva-activate="close();"></div>\n</div>\n'}),define("client.views/global-search/constants/focus-state",[],function(){"use strict";var a={};return Object.defineProperties(a,{input:{value:"input"},suggestions:{value:"suggestions"},history:{value:"history"},partials:{value:"partials"},objects:{value:"objects"},results:{value:"results"},startNewSearch:{value:"start-new-search"}}),a}),define("client.views/global-search/global-search-keyboard-shortcuts",["qvangular","general.utils/qv-keyboard-shortcuts","client.views/global-search/constants/focus-state"],function(a,b,c){function d(d,e,f){function g(){var a=e.focusState;a===c.input?a=e.displaySuggestions?c.suggestions:e.searchInputFocused&&0===e.query.length?c.history:e.isPartials()?c.partials:e.displayResult.data?c.results:c.startNewSearch:a===c.suggestions?a=e.isPartials()?c.partials:e.displayResult.data?c.results:c.startNewSearch:a===c.partials&&e.forcePartials&&(a=c.results),e.focusState=a}function h(){var a=e.focusState;a===c.results&&0===e.activeSelectIx?a=e.isPartials()?c.partials:e.displaySuggestions?c.suggestions:c.input:a===c.partials||a===c.startNewSearch?a=e.displaySuggestions?c.suggestions:c.input:(a===c.suggestions||a===c.history&&0===e.activeHistoryIx)&&(a=c.input),e.focusState=a}function i(){return"INPUT"===w[0].activeElement.tagName}function j(){b.preventDefault(),a.$rootScope.$apply()}function k(a){var b,c,d;return document.selection&&document.selection.createRange?(b=document.selection.createRange(),c=b.getBookmark(),d=c.charCodeAt(2)-2):a.setSelectionRange&&(d=a.selectionStart),d===a.value.length}function l(){i()?e.focusState===c.suggestions?f.hideSuggestions():e.query?e.query="":e.close():e.close(),j()}function m(){e.focusState===c.suggestions&&(e.activeSuggestionIx=e.activeSuggestionIx>0?e.activeSuggestionIx-1:e.suggestions.length-1,j())}function n(){e.focusState===c.suggestions&&(e.activeSuggestionIx=(e.activeSuggestionIx+1)%e.suggestions.length,j())}function o(){switch(h(),e.focusState){case c.history:e.activeHistoryIx=Math.max(-1,e.activeHistoryIx-1);break;case c.results:f.moveActiveResult(-1)}j()}function p(){switch(g(),e.focusState){case c.history:e.activeHistoryIx=Math.min(e.activeHistoryIx+1,e.searchHistory.length-1);break;case c.results:f.moveActiveResult(1)}j()}function q(a){switch(e.focusState){case c.history:f.setQueryFromHistory(e.activeHistoryIx);break;case c.input:e.isPartials()?f.setShowPartialMatches():e.displaySuggestions?r(a,!0):e.displayResult.data?f.select(e.searchTerms,0):f.showNoResultsMessage()&&e.haveUnlockedSelections()&&f.searchOutsideSelections();break;case c.suggestions:r(a,!0);break;case c.partials:f.setShowPartialMatches();break;case c.results:e.showMeMoreFocus?f.loadNextPage():f.select(e.searchTerms,e.activeSelectIx);break;case c.startNewSearch:f.searchOutsideSelections()}j()}function r(a,b){e.displaySuggestions&&(b||k(v))&&(e.activeSuggestionIx=e.activeSuggestionIx===-1?0:e.activeSuggestionIx,e.onSuggestSelect()),j()}function s(){f.closeSearch(),j()}var t,u,v=d.find("input")[0],w=a.getService("$document");e.focusState=c.input,e.$watch("focusState",function(a){e.activeSelectIx=a===c.results?0:-1,e.activeHistoryIx=a===c.history?0:-1,e.activeSuggestionIx=a===c.suggestions?0:-1}),t={preventDefault:!1,allowInInput:!0,delay:0},u={preventDefault:!1,allowInInput:!0,delay:75},this.keyboardShortcutsGroup=b.createGroup("global-search-"+e.app.id,1),this.keyboardShortcutsGroup.registerKeys("esc",l,t),this.keyboardShortcutsGroup.registerKeys("left",m,u),this.keyboardShortcutsGroup.registerKeys("right",n,u),this.keyboardShortcutsGroup.registerKeys("up",o,u),this.keyboardShortcutsGroup.registerKeys("down",p,u),this.keyboardShortcutsGroup.registerKeys("enter",q,t),this.keyboardShortcutsGroup.registerKeys("tab",r,t),this.keyboardShortcutsGroup.registerKeys("ctrl+f",s,t),this.keyboardShortcutsGroup.on()}return d.prototype.on=function(){this.keyboardShortcutsGroup.on()},d.prototype.off=function(){this.keyboardShortcutsGroup.off()},d.prototype.delete=function(){this.keyboardShortcutsGroup.delete()},d}),define("text!client.dialogs/object-info-dialog/content/object-info-content.ng.html",[],function(){return'<div class="q-card-content" qva-direction x-dir-setting="{{direction}}">\n\n\t<header ng-if="object.title || object.description">\n\t\t<div class="object-title" ng-if="object.title" qva-direction x-dir-text="{{object.title}}">{{object.title}}</div>\n\t\t<div ng-if="object.description" qva-direction x-dir-text="{{object.description}}" ng-bind-html="getTrustedHtml(object.description)"></div>\n\t</header>\n\n\t<section ng-if="object.dimensions.length">\n\t\t<div class="item-header" qva-direction x-dir-setting="{{direction}}">\n\t\t\t<span q-translation="Common.Dimensions"></span>\n\t\t\t<span class="item-count" dir="ltr">({{ object.dimensions.length }})</span>\n\t\t</div>\n\t\t<div class="item" ng-repeat="dimension in object.dimensions">\n\t\t\t<div class="item-title" qva-direction x-dir-text="{{dimension.title}}"><span class="icon-dimension-drilldown" q-title-translation="Tooltip.dimensions.drilldown" ng-if="dimension.isDrilldown"></span>{{ dimension.title }}</div>\n\t\t\t<div class="item-description" ng-if="dimension.description" qva-direction x-dir-text="{{dimension.description}}" ng-bind-html="getTrustedHtml(dimension.description)"></div>\n\t\t</div>\n\t</section>\n\n\t<section ng-if="object.measures.length">\n\t\t<div class="item-header" qva-direction x-dir-setting="{{direction}}">\n\t\t\t<span q-translation="Common.Measures"></span>\n\t\t\t<span class="item-count" dir="ltr">({{ object.measures.length }})</span>\n\t\t</div>\n\t\t<div class="item" ng-repeat="measure in object.measures">\n\t\t\t<div class="item-title" qva-direction x-dir-text="{{measure.title}}">{{ measure.title }}</div>\n\t\t\t<div class="item-description" ng-if="measure.description" qva-direction x-dir-text="{{measure.description}}" ng-bind-html="getTrustedHtml(measure.description)"></div>\n\t\t</div>\n\t</section>\n\n</div>'}),define("client.dialogs/object-info-dialog/content/object-info-util",["core.utils/deferred","core.models/generic-object","objects.models/listbox","util"],function(a,b,c,d){function e(b,c,d){var e="dimension"===c?"getDimension":"getMeasure";return b?b.app[e](d).then(function(b){return b?b.getProperties().then(function(a){return a.qMetaDef.description}):a.resolve()}):a.resolve()}function f(a,b,c){return e(a,"dimension",b).then(function(a){return{title:c.title?c.title:c.qFallbackTitle,description:a,isDrilldown:"H"===c.qGrouping}})}function g(a,b,c){var e=b.layout,f=d.getValue(e,b.ext.options.hyperCubePath||"",e),g=d.getValue(c,b.ext.options.hyperCubePath||"",c);return"map"===e.visualization?i(a,e,c):"filterpane"===e.visualization?j(a,e):"table"===e.visualization?k(a,e,c):"pivot-table"===e.visualization?l(a,e,c):h(a,f,g)}function h(b,c,d){var e,g=[];for(e=0;e<c.qHyperCube.qDimensionInfo.length;e++)g.push(f(b,d.qHyperCubeDef.qDimensions[e].qLibraryId,c.qHyperCube.qDimensionInfo[e]));return a.all(g)}function i(b,c,d){var e,g=[];for(e=0;e<c.layers.length;e++)g.push(f(b,d.layers[e].qHyperCubeDef.qDimensions[0].qLibraryId,c.layers[e].qHyperCube.qDimensionInfo[0]));return a.all(g)}function j(b,d){var e=[];return d.qChildList.qItems.forEach(function(a){e.push(c.get(a.qInfo.qId).then(function(a){return a.getProperties().then(function(a){return f(b,a.qListObjectDef.qLibraryId,a)})}))}),a.all(e)}function k(b,c,d){var e,g,h=[];for(e=0;e<c.qHyperCube.columnOrder.length;e++)(g=c.qHyperCube.columnOrder[e])<c.qHyperCube.qDimensionInfo.length&&h.push(f(b,d.qHyperCubeDef.qDimensions[g].qLibraryId,c.qHyperCube.qDimensionInfo[g]));return a.all(h)}function l(b,c,d){var e,g,h=[];for(e=0;e<c.qHyperCube.qEffectiveInterColumnSortOrder.length;e++)(g=c.qHyperCube.qEffectiveInterColumnSortOrder[e])>-1&&h.push(f(b,d.qHyperCubeDef.qDimensions[g].qLibraryId,c.qHyperCube.qDimensionInfo[g]));return a.all(h)}function m(a,b,c){return e(a,"measure",b).then(function(a){return{title:c,description:a}})}function n(b,c,e){var f=c.layout,g=d.getValue(f,c.ext.options.hyperCubePath||"",f),h=d.getValue(e,c.ext.options.hyperCubePath||"",e);return"map"===f.visualization?p(b,f,e):"filterpane"===f.visualization?a.resolve():"table"===f.visualization?q(b,f,e):o(b,g,h)}function o(b,c,d){var e,f=[];for(e=0;e<c.qHyperCube.qMeasureInfo.length;e++)f.push(m(b,d.qHyperCubeDef.qMeasures[e].qLibraryId,c.qHyperCube.qMeasureInfo[e].qFallbackTitle));return a.all(f)}function p(b,c,d){var e,f,g=[];for(f=0;f<c.layers.length;f++)for(e=0;e<c.layers[f].qHyperCube.qMeasureInfo.length;e++)g.push(m(b,d.layers[e].qHyperCubeDef.qMeasures[0].qLibraryId,c.layers[e].qHyperCube.qMeasureInfo[e].qFallbackTitle));return a.all(g)}function q(b,c,d){var e,f,g=[];for(e=0;e<c.qHyperCube.columnOrder.length;e++)(f=c.qHyperCube.columnOrder[e])>=c.qHyperCube.qDimensionInfo.length&&(f-=c.qHyperCube.qDimensionInfo.length,g.push(m(b,d.qHyperCubeDef.qMeasures[f].qLibraryId,c.qHyperCube.qMeasureInfo[f].qFallbackTitle)));return a.all(g)}function r(b,c,d){return a.all({title:b.layout.showTitles?b.layout.title:null,description:d.qMetaDef.description,dimensions:g(c,b,d),measures:n(c,b,d)})}function s(a){return a.layout.qExtendsId?b.get(a.layout.qExtendsId).then(function(b){return b.getProperties().then(function(c){return r(a,b.enigmaModel,c)})}):a.model.getEffectiveProperties().then(function(b){return r(a,a.model,b)})}return{createObjectInfo:s}}),define("client.dialogs/object-info-dialog/content/object-info-content",["qvangular","sirtrevor","client.utils/rtl/direction-service","text!./object-info-content.ng.html","./object-info-util"],function(a,b,c,d,e){"use strict";function f(a){return a.indexOf("javascript:")>-1?a:a.replace(/(https?:\/\/[^\s<]+)/g,'<a href="$1" target="_blank">$1</a>')}return{template:d,scope:{close:"&"},controller:["$scope",function(d){var g=a.getService("$sce");d.direction=c.direction,d.getTrustedHtml=function(a){return a?g.getTrustedHtml(f(b.toHTML(a))):null},e.createObjectInfo(d.input.object).then(function(a){d.object=a})}]}}),define("text!client.dialogs/object-info-dialog/card/object-info-card.ng.html",[],function(){return'<div class="q-card-header-container" qva-direction x-dir-setting="{{direction}}">\n\t<div class="q-card-header">\n\t\t<span q-translation="ObjectInfo.Dialog.Header"></span>\n\t</div>\n\t<div>\n\t\t<button class="lui-fade-button close-button" q-title-translation="Common.Close" qva-activate="close()">\n\t\t\t<span class="lui-button__icon  lui-icon  lui-icon--close"></span>\n\t\t</button>\n\t</div>\n</div>\n<div class="content"></div>'}),define("client.dialogs/object-info-dialog/card/object-info-card",["client.utils/rtl/direction-service","client.dialogs/object-info-dialog/content/object-info-content","text!./object-info-card.ng.html"],function(a,b,c){"use strict";return{template:c,scope:{close:"&"},controller:["$scope","$element",function(c,d){
c.direction=a.direction,d.find(".content").showComponent(b,{input:c.input})}]}}),define("client.dialogs/object-info-dialog/card/object-info-card-service",["qvangular","./object-info-card","general.utils/responsive-state"],function(a,b,c){function d(){f=null,c.ViewChanged.unbind(e)}function e(){a.getService("cardService").close()}var f=null,g={show:function(g){c.ViewChanged.bind(e);var h={component:b,input:{object:g}},i=[h],j={cardSteps:i,onClose:d};f=g.id,a.getService("cardService").show(j)},isShowing:function(){return f}};return a.service("objectInfoCard",[function(){return g}]),g}),define("client.property-panel/components/components",[],function(){function a(a){var b=a.component;if("string"==typeof b)return e[b]?e[b]:(window.console.log('Error! No component found with name "'+b+'"'),e.missing);if("object"==typeof b)return b;switch(a.type){case"items":return e.items;case"string":return e.string;case"integer":return e.integer;case"number":return e.number;case"boolean":return e.checkbox;case"array":return a.items?e.list:e.slider;default:return a.type?(window.console.log('Error! No component found for type "'+a.type+'"'),e.missing):(window.console.log('Warning! Missing component/type in definition. Using "items" component.'),e.items)}}function b(a){return e[a]}function c(a){return!!b(a)}function d(a,b){if(e[a])throw"Property panel component already loaded: "+a;e[a]=b}var e={missing:{template:"<div></div>",controller:[function(){}]}};return{getComponent:b,hasComponent:c,findComponent:a,addComponent:d}}),define("text!client.property-panel/sheet-properties/sheet-thumbnail/sheet-thumbnail.ng.html",[],function(){return'<div class="pp-component pp-media-component pp-sheet-thumbnail-component" tcl="media">\n\t<div class="label" ng-if="label">{{label}}</div>\n\t<div class="value">\n\t\t<div class="placeholder">\n\t\t\t<div qv-ao-thumb item="item" issheet="true" thumbprop="data.thumbnail" thumblayout="thumbLayout.thumbnail" editmode="!readOnly" thumb-width="221" thumb-height="128" emitchanges="true"></div>\n\t\t</div>\n\t</div>\n</div>\n'}),define("client.property-panel/sheet-properties/sheet-thumbnail/sheet-thumbnail",["client.property-panel/components/components","client.property-panel/component-utils","text!./sheet-thumbnail.ng.html"],function(a,b,c){var d={template:c,controller:["$scope",function(a){var c=function(){return a.data};b.defineLabel(a,a.definition,c,a.args.handler),b.defineReadOnly(a,a.args.handler),a.item={qData:a.data,qMeta:{published:a.args.model.layout.qMeta.published}},a.save=function(){a.$emit("saveProperties")},a.$on("thumbnailchanged",function(){a.save()}),a.$on("layoutchanged",function(b,c){a.thumbLayout={thumbnail:c.thumbnail}}),a.thumbLayout={thumbnail:a.args.model.layout.thumbnail}}]};return a.addComponent("sheet-thumbnail",d),d}),define("client.property-panel/sheet-properties/sheet-properties",["client.property-panel/sheet-properties/sheet-thumbnail/sheet-thumbnail"],function(){return{type:"items",component:"accordion",items:{sheetProps:{type:"items",translation:"properties.sheetProperties",items:{title:{type:"string",ref:"qMetaDef.title",translation:"Common.Title",minlength:1,readOnly:function(a,b,c){var d=c.layout;return d&&(d.permissions&&!d.permissions.update||d.qMeta&&d.qMeta.sourceObject&&d.qMeta.sourceObject.length>0)},rollbackInvalid:!0},description:{type:"string",component:"textarea",readOnly:function(a,b,c){var d=c.layout;return d&&d.permissions&&!d.permissions.update},ref:"qMetaDef.description",translation:"Common.Description"},thumbnail:{translation:"properties.sheetProperties.thumbnail",type:"string",readOnly:function(a,b,c){var d=c.layout;return d&&d.permissions&&!d.permissions.update},component:"sheet-thumbnail",defaultValue:""}}}}}}),define("client.views/sheet/sheet-service",["qvangular","pubsub","client.utils/state","client.services/stage-state","client.property-panel/sheet-properties/sheet-properties"],function(a,b,c,d,e){a.service("qvSheetService",function(){var f,g=a.getService("$cacheFactory"),h=g("pp-sheet");return{set:function(a){f=a},get:function(){return f},destroy:function(){f=null},setSheetAsSelectedObj:function(){var a=c.model,f=a.id,g={id:a.id,type:"sheetCell",canCopy:function(){return!1},canCut:function(){return!1},canRemove:function(){return!1},remove:function(){},paste:function(){b.publish("/activeSheet/pasteObject",null)},getAllPropertyPanelContent:function(){return a.getProperties().then(function(b){return a.getLayout().then(function(c){if(f===b.qInfo.qId){return{properties:b,layout:c,definition:e,id:"sheet",model:a,iconClass:"lui-icon lui-icon--sheet",titleRef:"qMeta.title",cache:h}}})})}};return d.setSelectedObject(g)}}})}),define("client.controllers/grid-controller",["jquery","angular","qvangular","core.utils/deferred","client.utils/state","general.utils/responsive-state","general.utils/support","client.services/stage-state","pubsub","objects.utils/interaction-states","client.utils/rtl/direction-service","client.dialogs/object-info-dialog/card/object-info-card-service","client.views/sheet/sheet-service"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function l(a,b){for(var c=[],d=0;d<b;d++){c[d]=[];for(var e=0;e<a;e++)c[d][e]=1}return c}function m(a,b){var c,d,e=b.row+b.rowspan,f=b.col+b.colspan;for(c=b.row;c<e;c++)for(d=b.col;d<f;d++)a[c][d]=0}function n(a,b){function c(a){var b=a.iconClass&&a.iconClass.substring(5),c="lui-icon lui-icon--";switch(b){case"bar-chart-vertical":return c.concat("bar-chart");case"components":return c.concat("scatter-chart");case"text-image":return c.concat("text");default:return c.concat(b)}}return{id:b.id,type:"gridCell",customObject:b,canCopy:function(){return!b.object.isInvalid},copy:function(){i.publish("/activeSheet/copyObject",b)},canCut:function(){return!b.object.isInvalid},cut:function(){i.publish("/activeSheet/cutObject",b)},paste:function(){i.publish("/activeSheet/pasteObject",b)},canRemove:function(){return!0},remove:function(){a.gridService.removeCell(b)},getAllPropertyPanelContent:function(){var a=null;return b.getVisualization().then(function(b){return a=b.model.id,b.getPropertyPanelContent().then(function(e){var f=e.type,g=e.app;return d.all({appLayout:g.getLayout(),properties:b.model.getProperties(),layout:b.model.getLayout()}).then(function(h){return a!==h.properties.qInfo.qId?d.resolve(null):{definition:e.definition,globalChangeListeners:e.globalChangeListeners,type:f.type,components:f.components||[],ext:e.ext,handler:e.handler,iconClass:c(e),titleRef:e.titleRef,properties:h.properties,layout:h.layout,localeInfo:h.appLayout.qLocaleInfo,app:g,model:b.model,cache:y}})})})}}}function o(a,b){var c=a.rectFor(b);return{width:"calc( "+c.width+"% - "+2*c.margin+"px )",height:"calc( "+c.height+"% - "+2*c.margin+"px )",left:"calc( "+c.left+"% + "+c.margin+"px )",top:"calc( "+c.top+"% + "+c.margin+"px )"}}function p(a){a.getVisualization().then(function(b){b.getPreferredSize().then(function(b){b&&f.isSmallDevice&&(a.style={width:b.w+"px",height:b.h+"px"})})})}function q(a,b,c){var d=100/b,e=100/c;a.rectFor=function(a){var b=a.colspan*d,c=a.rowspan*e;return{left:a.col*d,top:a.row*e,width:b,height:c,margin:2}};var f,g=[],h=[];for(f=0;f<b-1;++f){var i=(f+1)*d;h.push({left:i+"%"})}for(f=0;f<c-1;++f){var j=(f+1)*e;g.push({top:j+"%"})}a.cols=b,a.rows=c,a.horizontalLines=g,a.verticalLines=h}function r(a,b){var c=b.qInfo.qId!==a.lastSheetId,d=!c&&e.isInEditMode()&&!a.zoomCell&&b.permissions.update;a.lastSheetId=b.qInfo.qId,a.hasUpdatePermission=b.permissions.update,a.isSheet=!0,a.isMaster=!1,a.sheetTitle=b.qMeta&&b.qMeta.title||"",a.isDraft=b.qMeta&&b.qMeta.sourceObject&&b.qMeta.sourceObject.length,a.isDraftOwner=b.qMeta&&b.qMeta.draftObject&&b.qMeta.draftObject.length,!c&&a.hasUpdatePermission||a.clearActiveCell(),c&&(a.cells=[]),u(a,b.cells.slice(),d)}function s(b,d,f){return{active:!1,visible:!1,items:[{translation:"contextMenu.showDetails",tid:"nav-menu-info",cssClasses:"lui-icon lui-icon--info",dynamicCssClasses:function(){var a=[];return d.zoomCell?a.push("big"):a.push("border","white"),a.join(" ")},isVisible:function(){return(g.treatAsDesktop()||d.zoomCell)&&!e.isInEditMode()&&!f.object.isInvalid&&f.object.supportObjectInfo()},action:function(){c.getService("objectInfoCard").show(f.object)}},{translation:"Visualization.Unlink",tid:"nav-menu-link",cssClasses:"lui-icon lui-icon--link",dynamicCssClasses:function(){var a=[];return d.zoomCell?a.push("big"):a.push("border","white"),a.join(" ")},isVisible:function(){return(g.treatAsDesktop()||d.zoomCell)&&f.object.isLink&&e.isInEditMode()},action:function(){f.getVisualization().then(function(a){require("client.services/link-object-service").showBreakLinkDialog(a.model)})}},{translation:"contextMenu.takeSnapshot",tid:"nav-menu-snapshot",cssClasses:"lui-icon lui-icon--camera",dynamicCssClasses:function(){var a=[];return d.zoomCell?a.push("big"):a.push("border","white"),f.snapshot.dialogOpen&&a.push("blue"),a.join(" ")},isVisible:function(){return(g.treatAsDesktop()||d.zoomCell)&&!f.object.isInvalid&&!d.zooming&&!e.isInEditMode()&&f.object.supportSnapshot()&&b.permissions.createBookmark||f.snapshot.isAnnotating},action:function(){if(!f.snapshot.snapshotTimer){f.snapshot.snapshotTimer=setTimeout(function(){f.snapshot.snapshotTimer=null},1e3);f.snapshot.isAnnotating||(d.zoomCell&&f.object.showExploreMenu?(f.object.toggleExploreMenu(),f.object.resize(),f.snapshot.take(!0)):d.zoomCell?f.snapshot.take(!0,!0):f.snapshot.take(!0))}}},{translation:"Tooltip.ExplorationMenu",tid:"nav-menu-explore",cssClasses:"lui-icon lui-icon--control",dynamicCssClasses:function(){var a=[];return f.object.showExploreMenu&&a.push("active"),d.zoomCell?a.push("big"):a.push("border","white"),a.join(" ")},isVisible:function(){return(g.treatAsDesktop()||d.zoomCell)&&f.object.canShowExploreMenu()&&!e.isInEditMode()&&!d.zooming},action:function(){d.zoomCell?(f.object.toggleExploreMenu(),f.object.resize()):(d.zoom(f),f.object.toggleExploreMenu(!0))}},{translation:"Tooltip.ZoomOut",tid:"nav-menu-zoom-out",cssClasses:"lui-icon lui-icon--remove big",isVisible:function(){return d.isSheet&&d.zoomCell===f&&!d.zooming},action:function(){f.navMenu.visible=!1,f.object.showExploreMenu&&f.object.toggleExploreMenu(!1),a(".embedded-sheet-toolbar").length>0&&a(".embedded-sheet-toolbar").css("display","block"),d.zoom(null)}},{translation:"Tooltip.ZoomIn",tid:"nav-menu-zoom-in",cssClasses:"lui-icon lui-icon--expand white border",isVisible:function(){return g.treatAsDesktop()&&!d.zoomCell&&!f.object.isInvalid&&!d.zooming},action:function(){d.zoom(f)}}]}}function t(a,b){var c;if(!b)return null;for(c=0;c<b.length;++c)if(b[c].id===a)return b[c];return null}function u(a,b,c){function g(b){m(q,b);var c={},d={col:b.col,row:b.row,colspan:b.colspan,rowspan:b.rowspan};a.setCellSize(c,d),c.isEmpty=!0,c.navMenu={},p.push(c)}function h(b){m(q,b);var g=t(b.name,a.cells);if(g)g.options.canSaveSoftProperties=a.hasUpdatePermission&&!f.isSmallDevice;else{g={},g.id=b.name;var h,i=d();h=e.state===e.States.edit?j.EDIT:j.ANALYSIS,g.options={setController:i.resolve,id:b.name,isVisible:!0,isZoomed:!1,isActive:!1,canSaveSoftProperties:a.hasUpdatePermission&&!f.isSmallDevice,interactionState:h,direction:k.direction,removeIt:function(){a.gridService.removeCell(g)}},a.app.getLayout().then(function(b){g.navMenu=s(b,a,g)}),a.app.getObject(b.name).then(function(b){g.model=b,c&&a.toggleActive(g)}),g.getVisualization=function(){return i.promise}}var l={col:b.col,row:b.row,colspan:b.colspan,rowspan:b.rowspan};a.setCellSize(g,l),g.isEmpty=!1,p.push(g)}function i(){function a(a,b,c){for(var g=a;d.length>0;){var h=d[d.length-1];if(h.rowSpan===c)return;if(h.rowSpan<c)break;d.pop(),g=h.col;var i=a-h.col,j=h.rowSpan*i;j>e&&(e=j,f={col:h.col,row:b,colspan:i,rowspan:h.rowSpan})}c>0&&d.push({col:g,rowSpan:c})}for(var b,c,d,e,f,g=n,h=[];g--;)for(c=0,b=o,h[g]=[];b--;)q[b][g]?h[g][b]=++c:(c=0,h[g][b]=null);for(f=null,e=0,d=[],b=0;b<o;++b){for(g=0;g<n;++g)null!==h[g][b]?a(g,b,h[g][b]):a(g,b,0);a(g,b,0)}return f}var n=a.cols,o=a.rows,p=[],q=l(n,o);b.forEach(h),!a.hasUpdatePermission&&a.zoomCell&&e.state===e.States.edit&&a.zoom(null),function(a){a.sort(function(a,b){return a=a.pos,b=b.pos,a.row-b.row}).sort(function(a,b){return a=a.pos,b=b.pos,a.row===b.row?a.col-b.col:a.row-b.row})}(p),function(){for(var a,c=1;a=i();)a.priority=c++,b.push(a),g(a)}(),a.cells=p}function v(a,b){this.gridService=a,this.blocked=!1,this.app=b}var w=b.injector(["ng"]),x=w.get("$cacheFactory"),y=x("pp-object");return v.prototype.updateCellsSize=function(a){var b=this;for(var c in a.cells)b.setCellSize(a.cells[c],a.cells[c].pos)},v.prototype.setCellSize=function(a,b){f.isSmallDevice&&a.getVisualization?a.style=p(a):a.style=o(this,b),a.pos=b},v.prototype.block=function(){this.blocked=!0,this.removeResizeHandles()},v.prototype.unblock=function(){this.blocked=!1,this.updateActiveCell()},v.prototype.isBlocked=function(){return this.blocked},v.prototype.updateActiveCell=function(){function a(a,b){b>=0&&j[a]>b&&(j[a]=b)}function b(a){var b={top:!0,bottom:!0}[a]||!1,c={left:!0,right:!0}[a]||!1,e={X:0,Y:0},f=!1;if(c)e.X=j[a],f=d.colspan<=1;else if(b)e.Y=j[a],f=d.rowspan<=1;else{var g=a.split("-");e.Y=j[g[0]],e.X=j[g[1]],f=d.rowspan<=1&&d.colspan<=1}0===e.Y&&0===e.X&&f||p.push({dir:a,expand:e,contract:{X:d.colspan-1,Y:d.rowspan-1}})}var c=this;if(c.activeCell&&e.isInEditMode()&&!this.blocked){for(var d=c.activeCell.pos,f=d.col,g=f+d.colspan,h=d.row,i=h+d.rowspan,j={left:f,right:c.cols-g,top:h,bottom:c.rows-i},k=0;k<c.cells.length;++k)if(c.cells[k]!==c.activeCell&&!c.cells[k].isEmpty){var l=c.cells[k].pos.col,m=l+c.cells[k].pos.colspan,n=c.cells[k].pos.row,o=n+c.cells[k].pos.rowspan;n<i&&o>h&&(a("left",f-m),a("right",l-g)),l<g&&m>f&&(a("top",h-o),a("bottom",n-i))}var p=[];b("left"),b("right"),b("top"),b("bottom"),b("top-left"),b("bottom-right"),b("top-right"),b("bottom-left"),c.activeCell.resize=p,c.activeCell.updating=!1}},v.prototype.removeResizeHandles=function(){var a=this;a.activeCell&&delete a.activeCell.resize},v.prototype.clearActiveCell=function(){var a=this;a.removeResizeHandles(),a.activeCell=null},v.prototype.setCellSelected=function(a){if(a&&!a.isEmpty)"gridCell"===h.selectedObject.type&&h.selectedObject.id===a.id||h.setSelectedObject(n(this,a));else{c.getService("qvSheetService").setSheetAsSelectedObj()}},v.prototype.toggleActive=function(a){var b=this;e.isInEditMode()&&(!a||b.zoomCell||a.isEmpty?b.clearActiveCell():(b.clearActiveCell(),b.hasUpdatePermission&&(b.activeCell=a),b.updateActiveCell()),b.setCellSelected(a))},v.prototype.setEditMaster=function(a,b){var c=this,d=[{name:a,type:b,col:0,row:0,colspan:1,rowspan:1}];c.lastSheetId=null,c.isSheet=!1,c.isMaster=!0,q(c,1,1),c.clearActiveCell(),u(c,d,!1),c.setCellSelected(c.cells[0]),c.zoom(c.cells[0])},v.prototype.update=function(a){if(a){var b=this;b.layout=a,q(b,a.columns||12,a.rows||7),r(b,a),b.activeCell&&b.cells.indexOf(b.activeCell)===-1&&b.setCellSelected(null),b.zoomCell&&b.cells.indexOf(b.zoomCell)===-1&&(b.zoomCell=null,b.setCellSelected(null)),b.updateActiveCell()}},v.prototype.zoom=function(a){var b=this;b.cells&&(b.cells.forEach(function(b){b.options&&(b.options.isVisible=b===a||!a,b.options.isZoomed=b===a&&!!a)}),a?(b.clearActiveCell(),b.zoomCell=a,b.gridService.saveScrollState(),a.object&&(a.object.expanded=!!a)):b.zoomCell&&(b.zoomCell.object&&(b.zoomCell.object.expanded=!1),b.clearActiveCell(),b.hasUpdatePermission&&(b.activeCell=b.zoomCell),b.zoomCell=null,b.updateActiveCell(),b.gridService.restoreScrollState()))},v.prototype.highlight=function(a){var b=this;b.cells&&b.cells.forEach(function(b){b.isHighlighted=b===a||!a})},v.prototype.exploreMenu=function(a,b){a&&a.object&&a.object.hasSoftProperties&&a.object.toggleExploreMenu(b)},v.prototype.getOptimalCell=function(){var a=this,b=a.cells.slice();b.sort(function(a,b){if(a.isEmpty&&!b.isEmpty)return-1;if(b.isEmpty&&!a.isEmpty)return 1;var c=a.pos.colspan*a.pos.rowspan,d=b.pos.colspan*b.pos.rowspan;return c>d?-1:c<d?1:0});var c=b[0]||null;if(c&&!c.isEmpty)if(c.pos.colspan>1||c.pos.rowspan>1){var d=c.pos.colspan>c.pos.rowspan?"right":"bottom";c={isEmpty:!0,pos:{pos:c.pos,split:d}}}else c=null;return c},v}),define("client.services/grid-service",["qvangular","core.utils/deferred","core.models/rpc-base","general.utils/responsive-state","client.services/stage-state","client.controllers/grid-controller","client.utils/state","jquery","general.services/delayed-modal/delayed-modal"],function(a,b,c,d,e,f,g,h){"use strict";function i(){var b=a.getService("$delayedModal"),c=h.extend(!0,{},{},{title:"Ui.Warning.GridFull.Title",content:"Ui.Warning.GridFull"});b.open(c)}function j(a,b){g.setView(a);var c=h(document.body);c.toggleClass("qv-view-sheet",!b),c.toggleClass("qv-view-object",b),c.toggleClass("qv-gridzoom",b)}function k(){y.grid.updateCellsSize(y.grid)}function l(b){var h;y||(y=a.$rootScope.$new(!0),y.grid=new f(this,b.enigmaModel.app),y.model=b,y.stageState=e,c.bindLayout(y,"model",function(a){y.grid.update(a)}),d.ViewChanged.bind(k),y.$watch(g.isInEditMode,function(a){h=a,y.grid.update(y.grid.layout),h?y.grid.updateActiveCell():(y.grid.removeResizeHandles(),w())}),y.$watch("grid.zoomCell",function(a){if(!(v()||g.view===g.Views.story&&g.state!==g.States.analysis)){j(a?g.Views.object:g.Views.sheet,!!a)}}),y.$watch("grid.changedZoom",function(a){a!==!1||y.grid.zoomCell||k(y.grid)}),y.$watch("stageState.selectedObject",function(a){y&&a&&"gridCell"!==a.type&&y.grid.clearActiveCell()}),g.SheetChanged.bind(m))}function m(a){y&&(y.model=a,y.grid.unblock())}function n(){z||(z=a.getService("$interval")),y&&(y.$destroy(),y=null,d.ViewChanged.unbind(k),g.SheetChanged.unbind(m),z.cancel(A.intervalPromise),A.gridElement=null)}function o(){var a=y&&y.grid.getOptimalCell();return a||i(),a}function p(a){y&&u(a.pos)}function q(){return y&&y.grid.isBlocked()}function r(a){return q()?b.reject():(y.grid.block(),y.model.addObject(a).finally(function(){y.grid.unblock()}))}function s(a,c){return q()?b.reject():y.model.swapObjects(a,c)}function t(a,c){return q()?b.reject():y.model.moveObject(a,c)}function u(a){return q()?b.reject():(y.grid.block(),y.model.removeObject(a).finally(function(){y.grid.unblock()}))}function v(){return y&&y.grid&&!y.model}function w(){v()&&(m(g.model),j(g.Views.sheet,!1))}function x(a,b){y&&(y.model=null,y.grid.setEditMaster(a,b),j(g.Views.masterObject,!0))}var y=null,z=null,A={gridElement:null,scrollTop:0,scrollLeft:0,lastZoomedCell:null,intervalPromise:null,hightlightedCellId:null};return{start:l,stop:n,goToEditMode:function(){g.setState(g.States.edit)},getOptimalCell:o,removeCell:p,isActive:function(){return!!y},getGrid:function(){return y&&y.grid},getModel:function(){return y&&y.model},activateCell:function(a){y&&y.grid.toggleActive(a)},deactivateCell:function(){y&&y.grid.toggleActive(null)},getZoomCell:function(){return y&&y.grid.zoomCell},getZoomedCellId:function(){return y.grid.zoomCell.id},zoomInOnCell:function(a){var b;y&&(b=y.grid.cells.filter(function(b){return b.id===a}),b.length&&y.grid.zoom(b[0]))},zoomOut:function(){y&&y.grid.zoom(null)},saveZoom:function(){!A.lastZoomedCell&&y.grid.zoomCell&&y.grid.zoomCell.id&&(A.lastZoomedCell=y.grid.zoomCell.id)},restoreZoom:function(){if(A.lastZoomedCell){a.getService("$timeout")(function(){y.grid.blockZoomAnimation=!0,this.zoomInOnCell(A.lastZoomedCell),A.lastZoomedCell=null}.bind(this))}},setGridElement:function(a){A.gridElement=a},saveScrollState:function(){!A.lastZoomedCell&&A.gridElement&&(A.scrollTop=A.gridElement.scrollTop,A.scrollLeft=A.gridElement.scrollLeft)},restoreScrollState:function(){z||(z=a.getService("$interval")),A.lastZoomedCell||(A.scrollTop>0&&(A.intervalPromise=z(function(){A.gridElement.children.length>0&&(A.gridElement.scrollTop=A.scrollTop,A.scrollTop=0,z.cancel(A.intervalPromise))},50)),A.scrollLeft>0&&(A.intervalPromise=z(function(){A.gridElement.children.length>0&&(A.gridElement.scrollLeft=A.scrollLeft,A.scrollLeft=0,z.cancel(A.intervalPromise))},50)))},getCellWithId:function(a){if(y){var b=y.grid.cells.filter(function(b){return b.id===a});return b.length?b[0]:null}return null},highlightedCell:function(a){a&&(A.hightlightedCellId=a);var b;y&&A.hightlightedCellId&&(b=y.grid.cells.filter(function(a){return a.id===A.hightlightedCellId}),b.length&&(y.grid.highlight(b[0]),A.hightlightedCellId=null))},isBlocked:q,addObject:r,swapObjects:s,moveObject:t,isEditMaster:v,closeEditMaster:w,editMaster:x}}),define("client.views/global-search/constants/request-state",[],function(){"use strict";var a={};return Object.defineProperties(a,{idle:{value:0},pending:{value:1}}),a}),define("client.views/global-search/constants/search-method",[],function(){"use strict";var a={};return Object.defineProperties(a,{data:{value:"searchResults"},visuals:{value:"searchObjects"},indexProgress:{value:"GetProgress"}}),a}),define("text!client.views/global-search/directives/input/input.ng.html",[],function(){return'<div class="qv-search-input" ng-class="{\'focus\': isInputFocused}">\n\t<div class="search-field-area">\n\t\t<lui-search class="search-field" query="query" auto-focus="autoFocus" autocomplete="\'off\'" is-focused="isInputFocused" tid="globalSearch.searchField" placeholder="{{placeholder}}" />\n\t</div>\n\t<div class="search-underlines">\n\t\t<span ng-repeat="underline in underlines" class="underline" ng-class="underline.isWhitespace ? \'term-space\' : \'term\' + underline.colorIx">{{underline.string}}</span><qv-global-search-input-hint></qv-global-search-input-hint>\n\t</div>\n</div>\n'}),define("text!client.views/global-search/directives/input/input-hint.ng.html",[],function(){return'<span ng-show="displaySuggestions" class="search-suggest" tid="globalSearch.suggestionString">{{hintString}}</span>\n'}),define("client.views/global-search/global-search-data-service",["qvangular"],function(a){function b(a,b,d,h){var i;0!==b.length&&(a[d]||(a[d]={}),i=a[d],i.string=b,i.isWhitespace=h||b.length<g&&!c(b)||'"'===b,i.colorIx=i.isWhitespace?-1:e,e=i.isWhitespace?e:(e+1)%f)}function c(a){return a.match(/[\u3040-\u9FBF]/)||a.match(/[\uFF65-\uFF9F]/)}function d(a,b,d,e){b.length<g&&!c(b)||a.push({string:b,startQuote:d,endQuote:e})}var e=0,f=6,g=1;a.service("qvGlobalSearchDataService",function(){this.transformResult=function(a,b){var c=b;a.matches=a.matches||[],a.searchTermGroups=a.searchTermGroups||[],a.searchVisualsGroups=a.searchVisualsGroups||[];for(var d=0;d<c.qSearchGroupArray.length;++d)if("DatasetType"===c.qSearchGroupArray[d].qGroupType){a.searchTermGroups.push(c.qSearchGroupArray[d]);var e=c.qSearchGroupArray[d];a.matches.indexOf(e.qSearchTermsMatched.length)===-1&&a.matches.push(e.qSearchTermsMatched.length)}else a.searchVisualsGroups.push(c.qSearchGroupArray[d]);a.displayResult.data=a.searchTermGroups.length>0,a.displayResult.visuals=a.searchVisualsGroups.length>0},this.showMore=function(a,b){if(b&&a&&1===a.qSearchGroupArray.length){for(var c,d=a.qSearchGroupArray[0],e=0;e<d.qItems.length;e++)if(d.qItems[e].qIdentifier===b.qIdentifier){c=d.qItems[e].qItemMatches;break}c&&(b.qItemMatches=c)}},this.setHeaders=function(a){var b,c=0;for(b=0;b<a.searchTermGroups.length;b++)a.searchTermGroups[b].qTotalNumberOfItems>c&&(c=a.searchTermGroups[b].qTotalNumberOfItems);for(a.columnCount=c,a.columnWidth=Math.floor(100/c)+"%",a.shadowHeaders=a.shadowHeaders||[],a.shadowHeaders.splice(0,a.shadowHeaders.length-c),b=a.shadowHeaders.length;b<c;b++)a.shadowHeaders[b]={}},this.transformSuggest=function(a,b,c){var d,e,f=0,g=[];for(this.getUnderlinersAndSearchTerms(a.query,g,[]),c=void 0!==c?c:25,c=Math.min(c,b.qSuggestions.length),d=0;d<c;++d)e={value:b.qSuggestions[d].qValue,term:b.qSuggestions[d].qTerm},a.query!==this.getResultingQueryFromSuggestion(g,e)&&(a.suggestions[f]=e,f++);a.suggestions.splice(f,a.suggestions.length-f)},this._whitespaces=[" ","\t","\n","\r","\r\n","　"],this.isWhiteSpaceAt=function(a,b){var c,d=this._whitespaces,e=a.charAt(b);for(c=0;c<d.length;++c)if(e===d[c])return!0;return!1},this.getUnderlinersAndSearchTerms=function(a,c,f){function g(){for(;j<k&&n.isWhiteSpaceAt(a,j);)j++;j>i&&b(c,a.substring(i,j),l++,!0),i=j}var h,i=0,j=0,k=a.length,l=0,m=this._whitespaces,n=this;for(f.length=0,e=0,g();i<k;)if('"'!==a.charAt(i)){if(j=function(a,b){var c,d,e;for(d=0;d<m.length;++d)(c=a.indexOf(m[d],b))>=0&&(!e||c<e)&&(e=c);return e||-1}(a,i),h=j>=0?a.substring(i,j):a.substring(i),b(c,h,l++),d(f,h,!1,!1),j<0)break;i=j,g()}else{if(b(c,a.substring(i,i+1),l++),j=function(a,b){var c;do{c=a.indexOf('"',b),b=c+1}while(c>=0&&b<k&&!n.isWhiteSpaceAt(a,b));return c}(a,++i),h=j>=0?a.substring(i,j):a.substring(i),b(c,h,l++),d(f,h,!0,j>0),j<0)break;b(c,a.substring(j,j+1),l++),i=j+=1,g()}c.splice(l,c.length-l)},this.getSuggestTerms=function(a,b){var c,d,e=this;return d=function(a){var b,c,d;if(a=a.trim(),0===a.length)return null;for(b=a.length,c=b-1,d=-1;c>-1;){if(e.isWhiteSpaceAt(a,c)){d=c+1;break}c--}return d=Math.max(d,0),a.substring(d,b)}(a),c=b.map(function(a){return a.string}),d&&2===d.length&&'"'===d.charAt(0)&&c.push(d.charAt(1)),c},this.getUnderlineLengthFromTermIx=function(a,b){for(var c,d=0,e=0;d<a.length&&(c=a[d],e<b||c.isWhitespace)&&(d!==a.length-1||1!==c.string.length||this.isWhiteSpaceAt(c.string,0)||'"'===c.string);)c.isWhitespace||e++,d++;return d>0?d:0},this.getResultingQueryFromSuggestion=function(a,b){var c,d,e,f,g=this.getUnderlineLengthFromTermIx(a,b.term);return c=a.slice(0,g).reduce(function(a,b){return a+b.string},""),d='"'===c.charAt(c.length-1),e=!d&&b.value.indexOf(" ")>=0,f=e||d,c+(e?'"':"")+b.value+(f?'"':"")},this.getMinQueryLength=function(){return g},this.getMaxColorsNum=function(){return f}})}),define("client.views/global-search/directives/input/input",["jquery","qvangular","translator","util","text!./input.ng.html","text!./input-hint.ng.html","general.utils/string-normalization","touche","general.utils/support","client.views/global-search/global-search-data-service"],function(a,b,c,d,e,f,g,h,i){function j(a,b){var c;if(a.length!==b.length)return!1;for(c=0;c<a.length;++c)if(a[c]!==b[c])return!1;return!0}var k=null;b.directive("qvGlobalSearchInput",["$timeout","qvGlobalSearchDataService",function(f,g){return{restrict:"E",replace:!0,template:e,require:"^qvGlobalSearch",link:function(e,l,m,n){function o(b){if(e.isInputFocused){if(1===a(b.target).closest(".qv-global-search-suggest").length||1===a(b.target).closest(".qv-search-last-history").length)return;b.preventDefault(),b.stopPropagation(),h.preventGestures(this.gestureHandler),e.$apply(function(){n.hideSuggestions(),n.hideSoftKeyboard()})}}var p=l.find("input"),q=[],r=b.getService("$document");p.on("keydown",function(){e.ignoreQueryChange=!1}),e.$watch("isSelectActiveInSmallDevice",function(a){e.autoFocus=!d.isIos()&&!d.isAndroid()&&!a}),e.placeholder=c.get("GlobalSearch.SearchData"),e.isObjectsFeature&&!i.treatAsDesktop()&&l.on("qv-outside",o),e.$watch("query",function(a){var b,c,d=[];return f.cancel(k),n.showHistory(e.isSearchHistoryFeature&&e.isInputFocused&&0===e.query.length),e.ignoreQueryChange||n.resetSuggestions(),a&&0!==a.length?(g.getUnderlinersAndSearchTerms(a,e.underlines,d),e.ignoreQueryChange?void(e.ignoreQueryChange=!1):void(k=f(function(){g.isWhiteSpaceAt(a,a.length-1)||'"'===a.charAt(a.length-1)?n.hideSuggestions():(c=g.getSuggestTerms(a,d),n.suggest(c)),b=d.map(function(a){return a.string}),d.length>0&&!j(b,q)?(n.searchVisuals(b),n.search(b)):a.length<g.getMinQueryLength()&&n.emptyResult(),q=b,k=null},200))):(n.emptyResult(),e.underlines.length=0,void(q=[]))}),e.$watch("isInputFocused",function(a){e.isSmallDevice&&(a?r.find("body").animate({scrollTop:l.offset().top},100):e.isObjectsFeature&&h.utils.touch&&n.hideSuggestions()),e.isSearchHistoryFeature&&a&&0===e.query.length&&n.showHistory(!0)}),e.$on("focusInput",function(){p.focus()}),e.$on("blurInput",function(){p.blur()}),e.$on("$destroy",function(){p.off()})}}}]),b.directive("qvGlobalSearchInputHint",["qvGlobalSearchDataService",function(a){return{restrict:"E",replace:!0,template:f,require:"^qvGlobalSearch",link:function(b){function c(){var c,d,e,f,h,i=b.suggestions[b.activeSuggestionIx===-1?0:b.activeSuggestionIx],j=[],k=[];a.getUnderlinersAndSearchTerms(b.query,j,k),c=a.getSuggestTerms(b.query,k),!b.displaySuggestions||b.suggestions.length<=0||0===c.length||(d=a.getUnderlineLengthFromTermIx(j,i.term),f=j.slice(d).reduce(function(a,b){return a+(b.isWhitespace?" ":b.string)},""),e=g.string(f).length,f=g.string(i.value).slice(0,e),h=g.string(i.value).slice(e),b.ignoreQueryChange=!0,b.hintString=h)}b.$watch("activeSuggestionIx",function(){c()}),b.$watchCollection("suggestions",function(){c()}),b.$watch("displaySuggestions",function(){c()})}}}])}),define("text!client.views/global-search/directives/result/result.ng.html",[],function(){
return'<div class="qv-global-search-result" ng-class="classes" qv-smartsearch-swipe-results >\n\t<qv-global-search-suggest ng-if="displaySuggestions" class="qv-global-search-suggest" qv-scroll-to-active="{{activeSelectIx === -1 && focusState === FocusState.suggestions}}" ></qv-global-search-suggest>\n\n\t<h3 class="title-section title-navigation" ng-if="displayResult.visuals && !isSmallDeviceLandscape">\n\t\t<span q-translation="GlobalSearch.Navigations"></span>\n\t\t<i qva-activate="resetDockState();" class="lui-icon lui-icon--arrow-down"></i>\n\t</h3>\n\n\t<h3 class="title-section title-landscape" ng-if="displayResult.visuals && isSmallDeviceLandscape">\n\t\t<span class="lui-icon lui-icon--object"></span>\n\t\t<span q-translation="GlobalSearch.RotateForVisuals"></span>\n\t</h3>\n\n\t<qv-smartsearch-visuals-group items="searchVisualsGroups" app="app" search-terms="searchTerms" options="{\'preload\': false}" ng-if="displayResult.visuals" ng-hide="isSmallDeviceLandscape" ng-class="visualClasses"></qv-smartsearch-visuals-group>\n\n\t<h3 ng-if="isObjectsFeature && ( displayResult.data || showNoResultsMessage() )" class="title-section title-selections" >\n\t\t<span q-translation="GlobalSearch.Selections"></span>\n\t\t<i qva-activate="resetDockState();" class="lui-icon lui-icon--arrow-up"></i>\n\t</h3>\n\n\t<div ng-show="displayResult.data" class="qv-global-search-result-groups data-container">\n\t\t\n\t\t<div ng-if="isPartials()" qv-scroll-to-active="{{ focusState === FocusState.partials }}" class="qv-global-search-result-message search-partials-message">\n\t\t\t<qv-global-search-result-msg></qv-global-search-result-msg>\n\t\t\t<div><button class="lui-button" qva-activate="setShowPartialMatches($event)" tid="globalSearch.showPartialMatches" q-translation="{{ !forcePartials?\'GlobalSearch.ShowPartialMatches\' : \'GlobalSearch.HidePartialMatches\' }}" ng-class="{ \'lui-active\': focusState === FocusState.partials }"></button></div>\n\t\t</div>\n\n\t\t<div ng-if="(outsideSelection || currentSelections) && (!isPartials() || forcePartials)" class="qv-global-search-result-title strong" >\n\t\t\t<span ng-if="outsideSelection && !currentSelections" tid="globalSearch.matchesWholeDataset" q-translation="GlobalSearch.MatchesWholeDataset"></span>\n\t\t\t<span ng-if="currentSelections" tid="globalSearch.addToYourSelections" q-translation="GlobalSearch.AddToYourSelections"></span>\n\t\t</div>\n\n\t\t<div ng-repeat="m in matches" class="data-matches-group" ng-if="(!isPartials() || forcePartials)">\n\n\t\t\t<div ng-if="m !== searchTerms.length" class="caption-flex" q-translation="GlobalSearch.MatchedSearchTerms,{{m}}"></div>\n\n\t\t\t<div class="content-flex" ng-init="parentIndex = $index" ng-class="{ \'touch-off\':!isSmallDevice }" ng-repeat="row in getSearchTermGroup(m)" qv-scroll-to-active="{{( row.qId === activeSelectIx) && focusState === FocusState.results }}" tid="globalSearch.resultGroup" >\n\t\t\t\t\n\t\t\t\t<div class="cell" ng-repeat="item in row.qItems" tid="globalSearch.resultField" ng-class="{ \'maxcell\': !$last && !$first, \'maxcellfirst\': ($first && row.qTotalNumberOfItems > 1) }" >\n\n\t\t\t\t\t<div class="group-hits" qva-activate="select( row, $parentIndex )" ng-class="{ \'shown\': (item.qTotalNumberOfMatches-item.qItemMatches.length) > 0  }">\n\t\t\t\t\t\t<span class="field-name" tid="globalSearch.resultField.Name">{{item.qIdentifier}}</span>\n\t\t\t\t\t\t<span ng-repeat="hit in item.qItemMatches" tid="globalSearch.resultField.Hit">\n\t\t\t\t\t\t\t<qv-global-search-highlights q-text="hit.qText" q-ranges="hit.qRanges"></qv-global-search-highlights >\n\t\t\t\t\t\t\t<span>{{$last ? \'\' : \', \'}}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<div tid="globalSearch.resultField.MoreHits" ng-if="item.qTotalNumberOfMatches-item.qItemMatches.length > 0" qva-activate="onShowMoreHits($event, item, row.qId)" class="more-hits"><span class="more-text" q-translation="GlobalSearch.MoreResults,{{(item.qTotalNumberOfMatches-item.qItemMatches.length)}}"></span></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="more-hits-area-mobile" ng-if="item.qTotalNumberOfMatches-item.qItemMatches.length > 0" tid="globalSearch.resultField.MoreHitsMobile" qva-activate="onShowMoreHits($event, item, row.qId)">\n\t\t\t\t\t\t<button class="lui-button lui-button--rounded">\n\t\t\t\t\t\t\t<span class="lui-button__icon lui-icon lui-icon--more"></span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div qv-scroll-to-active="{{showMeMoreFocus}}" class="show-me-more"><button ng-if="paging.totalRows > paging.lastRowIx && (!isPartials() || forcePartials)" tid="globalSearch.showmemore" qva-activate="loadNextPage($event)" class="lui-button" q-translation="GlobalSearch.ShowMeMore" ng-class="{\'lui-active\': showMeMoreFocus }"></button></div>\n\n\t</div>\n\n\t<div class="fixed-bar" ng-show="fixedbar">\n\t\t<span qva-activate="resetDockState();" class="lui-fade-button">\n\t\t\t<span class="lui-fade-button__icon lui-icon lui-icon--arrow-down"></span>\n\t\t</span>\n\t</div>\n\n\t<qv-global-search-no-results class="search-no-results-message" ng-show="showNoResultsMessage()" ></qv-global-search-no-results>\n\n\t<qv-global-search-throbber></qv-global-search-throbber>\n</div>\n'}),define("text!client.views/global-search/directives/result/result-message.ng.html",[],function(){return'<div class="qv-global-search-result-message-inline">\n    <span ng-if="currentSelections" q-translation="GlobalSearch.NoMatchesWithinCurrentSelection"></span>\n    <span ng-if="!currentSelections" q-translation="GlobalSearch.NoMatchesForYourTerms"></span>\n</div>'}),define("text!client.views/global-search/directives/result/no-results.ng.html",[],function(){return'<div>\n    <div class="qv-global-search-result-groups" ng-if="!error.show">\n\n        <div class="qv-global-search-result-message" >            \n            <qv-global-search-result-msg></qv-global-search-result-msg>\n\n            <div ng-if="haveUnlockedSelections()">\n                <button class="lui-button qv-gs-new-search-button" qva-activate="searchOutsideSelections($event)" tid="globalSearch.newSearchJustFor"\n\t\t\t\t\t\tq-translation="GlobalSearch.ClearSelectionAndSearchAgain" q-title-translation="GlobalSearch.ClearSelectionAndSearchAgain"\n\t\t\t\t\t\tng-class="{ \'lui-active\': focusState === FocusState.startNewSearch }"></button>\n            </div>\n        </div>\n    </div>      \n\n    <div class="qv-global-search-result-error" ng-if="error.show">\n        <span q-translation="{{error.translation}}"></span>\n    </div>\n</div>'}),define("text!client.views/global-search/directives/result/highlights.ng.html",[],function(){return"<span ng-repeat=\"slice in slices track by $index\" ng-class=\"slice.highlight ? 'highlighted' + slice.qTerm : ''\">{{slice.qSliceText}}</span>"}),define("client.views/global-search/directives/result/highlights",["qvangular","text!./highlights.ng.html","client.views/global-search/global-search-data-service"],function(a,b){a.directive("qvGlobalSearchHighlights",function(){return{restrict:"E",template:b,replace:!0,scope:{qText:"=",qRanges:"="},link:function(b){function c(a,b){for(var c=null,d=0;d<a.length;d++)if(a[d].iStart===b.iStart){c=a.splice(d,1,b);break}c||a.push(b)}var d=a.getService("qvGlobalSearchDataService").getMaxColorsNum();b.slices=null,b.$watch("qRanges",function(a){if(a){for(var e=0,f=[],g=a.sort(function(a,b){return a.qCharPos-b.qCharPos}),h=0;h<g.length;h++){var i=g[h];i.qCharPos>e&&f.push({qTerm:-1,qSliceText:b.qText.slice(e,i.qCharPos),highlight:!1,iStart:e,iEnd:i.qCharPos}),e=i.qCharPos+i.qCharCount;c(f,{qTerm:i.qTerm%d,highlight:!0,qSliceText:b.qText.slice(i.qCharPos,e),iStart:i.qCharPos,iEnd:e}),h===a.length-1&&e<b.qText.length&&f.push({qTerm:-1,qSliceText:b.qText.slice(e,b.qText.length),highlight:!1,iStart:e,iEnd:b.qText.length})}b.slices=f}})}}})}),define("text!client.views/global-search/directives/result/objects/visuals-group.ng.html",[],function(){return'<div class="qv-smartsearch-visuals-group" qva-smart-search-swipe-horizontal="onSwipePage(delta)" >\n\t<div class="nav-visual-arrow left" qva-activate="goToPage( pageIndex - 1 );" ng-show="pageIndex > 0">\n\t\t<span class="lui-fade-button">\n\t\t\t<span class="lui-fade-button__icon  lui-icon lui-icon--arrow-left"></span>\n\t\t</span>\n\t</div>\n\t<div class="visuals-wrapper" >\n\t\t<div class="page" ng-repeat="p in pages" ng-class="{ \'first\': $first, \'last\': $last }">\n\t\t\t<div class="content" >\n\t\t\t\t<qv-smartsearch-visual-preview ng-repeat="visualItem in p" app="app" visual-object="visualItem" search-terms="searchTerms" ng-class="{ \'first\': $first && !$last, \'last\': $last }"></qv-smartsearch-visual-preview>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="nav-visual-arrow right" qva-activate="goToPage( pageIndex + 1 );" ng-show="pageIndex < (pages.length - 1)">\n\t\t<span class="lui-fade-button">\n\t\t\t<span class="lui-fade-button__icon  lui-icon lui-icon--arrow-right"></span>\n\t\t</span>\n\t</div>\n\n\t<qv-global-search-more-indicator pages="pages" active-page-ix="pageIndex" on-page-change="goToPage(index);"></qv-global-search-more-indicator>\n</div>'}),define("text!client.views/global-search/directives/result/objects/visual-item.ng.html",[],function(){return'<div class="visual-item" >\n\t<div class="object" qva-activate="navigateToSheet($event)" >\n\t\t<qv-object ng-if="viz && visualObject.load" model="viz.model" options="viz.options"></qv-object>\n\t\t<div class="transparent-overlay"></div>\n\t\t<div ng-hide="visualObject.load" class="qv-animate progress">\n\t\t\t<div class="progress-loader"></div>\n\t\t</div>\n\t</div>\n\t<div class="visual-data" qva-activate="showExtraInfo($event);">\n\t\t<div ng-if="visualObject.load" class="keywords">\n\t\t\t<div class="terms">\n\t\t\t\t<span ng-repeat="t in termsMatched"><span ng-if="!$first">&nbsp;</span><span class="highlighted{{t.pos}}">{{t.string}}</span></span>\n\t\t\t</div>\n\t\t\t<div class="lui-fade-button" ng-if="matches.length">\n\t\t\t\t<span class="lui-fade-button__icon lui-icon lui-icon--info"></span>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="extra-info" ng-if="visualObject.load" ng-class="{ \'show\': extra }">\n\t\t\t<div ng-if="matches.length" ng-repeat="hits in matches" class="hits">\n\t\t\t\t<div ng-repeat="hit in hits" class="match-hit">\n\t\t\t\t\t<span ng-if="$first"><b q-translation="{{hit.trans}}"></b>: </span><qv-global-search-highlights q-text="hit.qText" q-ranges="hit.qRanges" class="highlights"></qv-global-search-highlights><span ng-if="!$last">,&nbsp;</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="more-hits" qva-activate="showMoreHits($event)" ng-if="$last && (visualObject.qTotalNumberOfMatches-hitsDisplayed) > 0" q-translation="GlobalSearch.MoreResults,{{(visualObject.qTotalNumberOfMatches-hitsDisplayed)}}"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>'}),define("client.views/global-search/directives/result/objects/visual-item",["qvangular","underscore","text!./visual-item.ng.html","core.utils/deferred","client.utils/rtl/direction-service","client.views/global-search/directives/result/highlights","client.views/global-search/global-search-data-service"],function(a,b,c,d,e){a.directive("qvSmartsearchVisualPreview",[function(){function f(a,b){return b.getObject(a.qIdentifier).then(function(a){return{model:a,options:{isReadonly:!0,isPopover:!1,selectionsDisabled:!0,components:{miniChart:{show:!1},scrollArea:{showFlag:0}},direction:e.direction}}})}function g(a){var b=a.split("/");return b=b.map(function(a){return parseInt(a)}).filter(function(a){return!isNaN(a)}),b.length?b[0]:-1}function h(a,b){a.id=-1,b.indexOf("qDimensions")!==-1||b.indexOf("qListObjectDef/qDef")!==-1?(a.id=g(b),a.type=b.indexOf("qLayoutExclude")===-1?j.DIMENSION:j.ALTERNATIVE_DIMENSION,a.isLabel=b.indexOf("qFieldLabels")!==-1):b.indexOf("qMeasures")!==-1?(a.id=g(b),a.type=b.indexOf("qLayoutExclude")===-1?j.MEASURE:j.ALTERNATIVE_MEASURE,a.isLabel=b.indexOf("qLabel")!==-1):(b.indexOf("subtitle")!==-1?a.type=j.SUBTITLE:b.indexOf("title")!==-1?a.type=j.TITLE:b.indexOf("footnote")!==-1?a.type=j.FOOTNOTE:b.indexOf("type")!==-1?a.type=j.TYPE:a.type=j.VALUE,a.isLabel=b.indexOf("qExpr")===-1),a.trans=i(a.type)}function i(a){var b="---";switch(a){case j.TITLE:b="Common.Title";break;case j.DIMENSION:b="Common.Dimensions";break;case j.MEASURE:b="Common.Measures";break;case j.ALTERNATIVE_DIMENSION:b="properties.alternative.dimensions";break;case j.ALTERNATIVE_MEASURE:b="properties.alternative.measures";break;case j.SUBTITLE:b="properties.subtitle";break;case j.FOOTNOTE:b="properties.footnote";break;case j.TYPE:b="properties.type";break;case j.VALUE:b="properties.dataPoints.labelmode.value"}return b}var j={TITLE:0,SUBTITLE:1,FOOTNOTE:2,DIMENSION:3,MEASURE:4,ALTERNATIVE_DIMENSION:5,ALTERNATIVE_MEASURE:6,TYPE:7,VALUE:8};return{restrict:"E",template:c,replace:!0,require:["^qvGlobalSearch"],scope:{visualObject:"=",searchTerms:"=",app:"="},link:function(c,e,g,i){function j(){c.termsMatched=c.visualObject.qSearchTermsMatched.map(function(a){return{string:c.searchTerms[a],pos:a%p}})}function k(a){c.hitsDisplayed=a.length;var d,e,f;a.forEach(function(a){a.qAttributes&&a.qAttributes.length&&h(a,a.qAttributes[0][1])}),d=c.visualObject.qItemMatches.filter(function(b){if(b.isLabel)return!0;var c=a.filter(function(a){return a.isLabel&&b.type===a.type&&b.id===a.id&&b!==a});return!b.qRanges.every(function(a){return c.some(function(b){return b.qRanges.some(function(b){return a.qTerm===b.qTerm})})})}),e=b.groupBy(d,function(a){return a.type}),f=Object.keys(e).map(function(a){return e[a]}),c.matches?f.forEach(function(a,b){if(a.length>c.matches[b].length)for(var d=c.matches[b].length,e=d;e<a.length;e++)c.matches[b].push(a[e])}):c.matches=f}function l(a,b,e){var f={sheet:a,cell:b};return b.name===c.visualObject.qIdentifier?d.resolve(f):"filterpane"===b.type?e.getObject(b.name).then(function(a){return a.getLayout().then(function(a){if(a.qChildList&&a.qChildList.qItems.length){return a.qChildList.qItems.filter(function(a){return a.qInfo.qId===c.visualObject.qIdentifier}).length?f:null}return null})}):d.resolve(null)}function m(){for(var a,b=[],e=0;e<o.all.mashed.length;e++){a=o.all.mashed[e];for(var f=0;f<a.qData.cells.length;f++)b.push(l(a,a.qData.cells[f],c.app))}return d.all(b)}var n,o=a.getService("$navigationService").Sheets,p=a.getService("qvGlobalSearchDataService").getMaxColorsNum(),q=i[0];c.viz=null,c.termsMatched=null,c.extra=!1,c.matches=null,c.$watch("visualObject.load",function(a){a===!0?(j(),n?c.viz=n:(f(c.visualObject,c.app).then(function(a){n=a,c.viz=a}),k(c.visualObject.qItemMatches))):c.viz=null}),c.$watch("searchTerms",function(a){a&&c.visualObject&&j()}),c.$on("$destroy",function(){n=null}),c.showMoreHits=function(a){a.stopPropagation(),q.showMoreHitsForVisual(c.visualObject).then(function(a){k(a.qItemMatches)})},c.showExtraInfo=function(a){c.extra=!c.extra&&c.matches.length,a.stopPropagation()},c.navigateToSheet=function(a){a.stopPropagation(),m().then(function(a){a=a.filter(function(a){return a}),a.length&&(o.navigateToSheet(a[0].sheet),q.onNavigateToSheet(a[0].cell.name))})}}}}])}),define("text!client.views/global-search/directives/more-indicator/more-indicator.ng.html",[],function(){return'<div class="qv-gs-more-indicator" ng-class="{ \'touch-on\': touchOn }">\n\t<div class="hit-area" qva-activate="onPageClick($index);" ng-repeat="p in pages">\n\t\t<span class="dot" ng-class="{ \'active\': $index === activePageIx, \'pressed\': $index === pressedPageIx }"></span>\n\t</div>\n</div>'}),define("client.views/global-search/directives/more-indicator/more-indicator",["qvangular","general.utils/support","text!./more-indicator.ng.html"],function(a,b,c){"use strict";a.directive("qvGlobalSearchMoreIndicator",function(){return{replace:!0,template:c,restrict:"E",scope:{pages:"=",activePageIx:"=",onPageChange:"&"},link:function(a){a.touchOn=!b.treatAsDesktop(),a.pressedPageIx=void 0,a.onPageClick=function(b){a.pressedPageIx=b,a.onPageChange({index:b})},a.$watch("activePageIx",function(){a.pressedPageIx=void 0})}}})}),define("client.views/global-search/directives/swipe-horizontal",["qvangular","general.utils/support","touche"],function(a,b,c){"use strict";a.directive("qvaSmartSearchSwipeHorizontal",["$parse",function(a){var d={up:!1,down:!1,right:!0,left:!0};return{restrict:"A",link:function(e,f,g){function h(a,b){if(d[b.swipe.direction]){var f=b.swipe.curDeltaX>0?-1:0===b.swipe.curDeltaX?0:1;i(e,{delta:f}),c.preventGestures(this.gestureHandler)}}var i=a(g.qvaSmartSearchSwipeHorizontal);b.treatAsDesktop()||c(f[0]).swipe({options:{radiusThreshold:50,preventDefault:!0,useMomentum:!0},start:h}),e.$on("$destroy",function(){c(f[0]).off()})}}}])}),define("client.views/global-search/directives/result/objects/visuals-group",["qvangular","text!./visuals-group.ng.html","general.utils/responsive-state","core.utils/resize","client.views/global-search/directives/result/objects/visual-item","client.views/global-search/directives/more-indicator/more-indicator","client.views/global-search/directives/swipe-horizontal"],function(a,b,c,d){var e={MAX_MOBILE_VISUALS:10,PAGE_VISUALS:3,PAGE_VISUALS_PORTRAIT:2,PADDING_PAGES:15};a.directive("qvSmartsearchVisualsGroup",["$timeout",function(a){return{restrict:"E",template:b,replace:!0,scope:{items:"=",searchTerms:"=",options:"=",app:"="},controller:function(){this.loadPage=function(){},this.preparePages=function(){}},link:function(b,f,g,h){function i(){b.pages=[],j.scrollLeft(0),b.pageIndex=0}b.pageIndex=0,b.pages=[],b.objects=null;var j=f.find(".visuals-wrapper"),k=!1,l=c.isSmallDevice?400:600,m=function(){l=c.isSmallDevice?400:600,j[0].scrollLeft=b.pageIndex*(j[0].offsetWidth+e.PADDING_PAGES)},n=function(){h.preparePages(b.items[0].qItems)};c.OrientationChanged.bind(n),b.setPageIndex=function(a){b.pageIndex=a;for(var c=0;c<b.pages.length;c++)b.pages[c].forEach(function(d){b.options.preload?d.load=c===a||c===a+1||c===a-1:d.load=c===a})},d.on("update",m),b.goToPage=function(a){h.loadPage(a)},b.onSwipePage=function(a){h.loadPage(b.pageIndex+a)},b.$watch("items",function(a){a&&a.length&&h.preparePages(a[0].qItems)}),b.$on("$destroy",function(){d.off("update",m),c.OrientationChanged.unbind(n)}),h.loadPage=function(c){!k&&c>=0&&c<b.pages.length&&(k=!0,j.animate({scrollLeft:c*(j[0].offsetWidth+e.PADDING_PAGES)},l,"swing",function(){k=!1,a(function(){b.setPageIndex(c)})}))},h.preparePages=function(a){if(a){i();var d,f=0,g=[];c.orientation===c.Orientation.landscape?d=c.isSmallDevice?1:e.PAGE_VISUALS:c.orientation===c.Orientation.portrait&&(d=c.isSmallDevice?1:e.PAGE_VISUALS_PORTRAIT);for(var h=0;h<a.length&&!(c.isSmallDevice&&g.length>=e.MAX_MOBILE_VISUALS&&g[f].length>=d);h++)g[f]?g[f].length>=d&&(f++,g.push([])):g.push([]),a[h].itemIndex=h,a[h].load=b.options.preload?0===f||1===f:0===f,g[f].push(a[h]);b.pages=g}}}}}])}),define("client.views/global-search/directives/result/result",["qvangular","text!./result.ng.html","text!./result-message.ng.html","text!./no-results.ng.html","touche","general.utils/support","client.views/global-search/directives/result/highlights","client.views/global-search/directives/result/objects/visuals-group"],function(a,b,c,d,e,f){var g={INITIAL:0,VISUALS_DOCKED:1,DATA_DOCKED:2};a.directive("qvGlobalSearchResult",["$timeout",function(a){return{restrict:"E",template:b,replace:!0,require:["^qvGlobalSearch","qvGlobalSearchResult"],controller:function(){this.getElement=function(){},this.setDockState=function(){}},link:function(b,c,d,h){var i,j,k=h[0],l=h[1],m=function(){var d=this,e=0;f.treatAsDesktop()&&!j&&(j=c.find(".qv-smartsearch-visuals-group")),a(function(){j&&j.length&&(e=j[0].offsetTop+j[0].offsetHeight-33,b.fixedbar=d.scrollTop>e),b.scrollShow=d.scrollHeight-d.scrollTop>d.clientHeight})},n=!f.treatAsDesktop()&&b.isObjectsFeature?c.find(".data-container"):c;b.dockState=g.INITIAL,b.activity={show:!1},b.throbber={show:!1},b.indexProgress={enabled:!1,show:!1,visible:!1},b.indexDone={show:!1,visible:!1},b.emptyMessageEnabled=!1,b.fixedbar=!1,b.classes={"qv-global-search-result-throbber-open":b.activity.show,"with-objects":b.isObjectsFeature&&!b.isSmallDeviceLandscape},b.$watch("isObjectsFeature && !isSmallDeviceLandscape",function(a){b.classes["with-objects"]=a}),b.$watch("activity.show",function(a){b.classes["qv-global-search-result-throbber-open"]=a}),b.$watch(function(){return b.showNoResultsMessage()},function(a){b.classes.noresults=a}),b.select=function(c,d){e.utils.touch?(b.activeResultIx=d,a(function(){k.select(b.searchTerms,c.qId)},100)):k.select(b.searchTerms,c.qId)},b.loadNextPage=function(){k.loadNextPage()},l.getElement=function(){return c},l.setDockState=function(c){a(function(){b.dockState=c,b.classes["visuals-docked"]=c===g.VISUALS_DOCKED,b.classes["data-docked"]=c===g.DATA_DOCKED})},b.setShowPartialMatches=function(){k.setShowPartialMatches()},b.showNoResultsMessage=function(){return b.emptyMessageEnabled&&b.searchTerms.length>0&&!b.displayResult.data&&!b.error.show&&!b.activity.show||b.error.show},k.showNoResultsMessage=function(){return b.showNoResultsMessage()},b.resetDockState=function(){b.dockState=g.INITIAL,f.treatAsDesktop()&&n.animate({scrollTop:0},300,"swing")},i=b.$watch(function(){return n[0].scrollHeight},function(a){b.scrollShow=a>n[0].clientHeight}),n.on("scroll",m),b.$on("resultScrollToTop",function(){c[0].scrollTop=0}),b.$on("$destroy",function(){i(),n.off("scroll",m)})}}}]),a.directive("qvScrollToActive",function(){return{restrict:"A",require:"^qvGlobalSearchResult",link:function(a,b,c,d){c.$observe("qvScrollToActive",function(a){if(a=a+""=="true",b.toggleClass("active",a),a){var c=d.getElement(),e=b.position();e.top<0?c[0].scrollTop=b[0].offsetTop:e.top+b.height()>c.height()&&b[0].scrollIntoView(!1)}})}}}),a.directive("qvGlobalSearchResultMsg",function(){return{restrict:"E",template:c,replace:!0,require:["^qvGlobalSearch","^qvGlobalSearchResult"],link:function(a){a.capUnderlineMaxNumber=6}}}),a.directive("qvGlobalSearchNoResults",function(){return{restrict:"E",template:d,replace:!0,require:["^qvGlobalSearch","^qvGlobalSearchResult"],link:function(){}}}),a.directive("qvSmartsearchSwipeResults",["$timeout",function(a){return{restrict:"A",require:["^qvGlobalSearchResult"],link:function(b,c,d,h){function i(){e(c[0]).off(),r&&r.off("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",p),q[0].removeEventListener("touchstart",n,!1),document.removeEventListener("touchmove",o,!1)}function j(a,c){if(!r||0===r.length)return void e.preventGestures(this.gestureHandler);if(s===g.INITIAL&&!b.isSmallDevice&&"up"===c.swipe.direction)return void e.preventGestures(this.gestureHandler);if(A[c.swipe.direction]&&!u){if(s===g.VISUALS_DOCKED&&q[0].scrollTop>1)return;var d=w+c.swipe.curDeltaY;if(d<0)return void q.removeAttr("style");a.preventDefault(),v=!0,w=d<y?d:y,q.css("overflow","hidden"),r.css("min-height",w+"px"),r.css("max-height",w+"px")}}function k(a,b){if(u||!A[b.swipe.direction])return void e.preventGestures(this.gestureHandler);w=r?r[0].clientHeight:0,y=c.height()-75,j(a,b)}function l(c){s=c,t.setDockState(s),u||s!==g.INITIAL&&s!==g.DATA_DOCKED?u&&r.addClass("transitionAnim"):b.$broadcast("resizeCell"),q.scrollTop(0),a(function(){r.removeAttr("style"),q.removeAttr("style")},50)}function m(){!u&&v&&(w>0&&w<y?(u=!0,l(w<x-z?g.VISUALS_DOCKED:w>x-z&&w<x+z?g.INITIAL:g.DATA_DOCKED)):0===w?l(g.VISUALS_DOCKED):w===y&&l(g.DATA_DOCKED),v=!1)}if(b.isObjectsFeature){var n,o,p,q=c.find(".data-container"),r=null,s=g.INITIAL,t=h[0],u=!1,v=!1,w=null,x=0,y=0,z=b.isSmallDevice?80:200,A={up:!0,down:!0,left:!1,right:!1};n=function(){0===this.scrollTop?this.scrollTop+=1:this.scrollTop+this.offsetHeight>=this.scrollHeight&&(this.scrollTop-=1)},o=function(a){q[0].scrollHeight>q[0].offsetHeight?s!==g.INITIAL&&s!==g.DATA_DOCKED||a.preventDefault():a.preventDefault()},p=function(){this.classList.remove("transitionAnim"),(u&&s===g.INITIAL||s===g.DATA_DOCKED)&&b.$broadcast("resizeCell"),u=!1},b.$watchGroup(["displayResult.visuals","isSmallDeviceLandscape"],function(a){a[0]&&!a[1]?(r=c.find(".qv-smartsearch-visuals-group"),r.on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",p),x=x||r.height(),f.treatAsDesktop()||(e(c[0]).swipe({options:{radiusThreshold:20,preventDefault:!1,useMomentum:!1},start:k,update:j,end:m}),document.addEventListener("touchmove",o,!1),q[0].addEventListener("touchstart",n,!1))):i()}),b.$watch("dockState",function(a){a===g.INITIAL&&s!==g.INITIAL&&(u=!0,l(g.INITIAL))}),b.$on("$destroy",function(){i()})}}}}])}),define("text!client.views/global-search/directives/suggest/suggest.ng.html",[],function(){return'<div class="qv-search-suggest-wrapper" tid="globalSearch.suggestions">\n\t<span class="hidden">{{query}}</span>\n    <div ng-show="isSmallDevice" ng-if="!isObjectsFeature" class="dym" q-translation="GlobalSearch.DidYouMean"></div>\n\t<ul class="suggest-popup">\n\t\t<li ng-repeat="suggest in suggestions track by $index" qv-scroll-to-active-suggestion="{{$index === activeSuggestionIx && focusState === FocusState.suggestions}}" ng-class="{active: $index === activeSuggestionIx && focusState === FocusState.suggestions }" qva-activate="onSuggestSelect($index)" tid="globalSearch.suggestion" bold-suggest=\'{{suggest.value}}\'>\n\t\t\t{{suggest.value}}\n\t\t</li>\n\t</ul>\n</div>\n'}),define("client.views/global-search/directives/suggest/suggest",["qvangular","text!./suggest.ng.html"],function(a,b){a.directive("qvGlobalSearchSuggest",[function(){return{restrict:"E",template:b,replace:!0,require:["^qvGlobalSearch"],link:function(){}}}]),a.directive("qvScrollToActiveSuggestion",function(){return{restrict:"A",link:function(a,b,c){c.$observe("qvScrollToActiveSuggestion",function(a){if(a=a+""=="true"){var c=b.position(),d=b.parent(),e=b[0].clientWidth>d[0].clientWidth,f=c.left+b[0].clientWidth-d[0].clientWidth;b[0].scrollIntoView(e),c.left<=d[0].offsetLeft?d.scrollLeft(b[0].offsetLeft-d[0].offsetLeft):f>0&&!e&&(d[0].scrollLeft=d[0].scrollLeft+f)}})}}})}),define("text!client.views/global-search/directives/history/history.ng.html",[],function(){return'<div class="qv-search-last-history" tid="globalSearch.searchHistory">\n\t<div class="title" ng-show="searchHistory.length" q-translation="GlobalSearch.SearchHistory"></div>\n\t<ul class="history-popup" ng-show="searchHistory.length">\n\t\t<li ng-repeat="items in searchHistory" qva-activate="onSearchHistorySelect($index)" tid="globalSearch.searchHistoryItem" ng-class="{active: $index === activeHistoryIx && focusState === FocusState.history}" qv-scroll-to-active-history="{{$index === activeHistoryIx && focusState === FocusState.history}}">\n\t\t\t<span ng-repeat="term in items.qData.searchTerms track by $index">\n\t\t\t\t<span class="underline term{{$index%colorsLimit}}">{{term}}</span><span class="term-space" ng-if="!$last">&nbsp;</span>\n\t\t\t</span>\n\t\t</li>\n\t</ul>\n</div>'}),define("client.views/global-search/directives/history/history",["qvangular","text!./history.ng.html","client.views/global-search/global-search-data-service"],function(a,b){a.directive("qvGlobalSearchHistory",["$timeout",function(c){return{restrict:"E",template:b,replace:!0,require:["^qvGlobalSearch"],link:function(b,d,e,f){var g=f[0],h=d.find(".history-popup")[0];b.colorsLimit=a.getService("qvGlobalSearchDataService").getMaxColorsNum(),b.$watch("searchInputFocused",function(a){a&&c(function(){h.scrollTop=0})}),b.onSearchHistorySelect=function(a){g.setQueryFromHistory(a)}}}}]),a.directive("qvScrollToActiveHistory",function(){return{restrict:"A",link:function(a,b,c){c.$observe("qvScrollToActiveHistory",function(a){a=a+""=="true",b.toggleClass("active",a),a&&b[0].scrollIntoView(!1)})}}})}),define("text!client.views/global-search/directives/throbber/throbber.ng.html",[],function(){return'<div ng-show="activity.show" class="qv-qs-throbber-container qv-animate ng-hide">\n\n\t<div class="qv-gs-throbber-dimmer"></div>\n\n\t<div ng-show="throbber.show" class="qv-animate qv-gs-throbber ng-hide"></div>\n\n\t<div ng-show="indexProgress.show" class="qv-gs-index qv-gs-index-progress qv-animate ng-hide">\n\n\t\t<div class="qv-gs-index-group" qva-smart-search-swipe-horizontal="onSwipePage(delta)">\n\t\t\t<div class="qv-gs-index-section">\n\t\t\t\t<div class="qv-gs-index-content qv-gs-index-content-shrink">\n\t\t\t\t\t<span class="qv-gs-index-header" q-translation="GlobalSearch.PreparingSmartSearch"></span>\n\n\t\t\t\t\t<qv-progress-bar percent-done="percentDone" on-completed="showIndexDone()"></qv-progress-bar>\n\n\t\t\t\t\t<span class="qv-gs-index-text" q-translation="GlobalSearch.NextTimeFaster"></span>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="qv-gs-index-section">\n\t\t\t\t<div class="qv-gs-index-content qv-gs-index-content-shrink">\n\t\t\t\t\t<div class="qv-gs-index-help" qva-activate="openHelp()">\n\t\t\t\t\t\t<span class="qv-gs-index-header" q-translation="GlobalSearch.LearnHowToUse"></span>\n\t\t\t\t\t\t<img ng-src="{{imgSrc}}" class="qv-gs-index-image" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<qv-global-search-more-indicator pages="pages" active-page-ix="activePageIx" on-page-change="goToPage(index);"></qv-global-search-more-indicator>\n\n\t</div>\n\n\t<div ng-show="indexDone.show" class="qv-gs-index qv-gs-index-done qv-animate ng-hide">\n\t\t<div class="qv-gs-index-section qv-gs-index-section-single">\n\t\t\t<div class="qv-gs-index-content qv-gs-index-shrink">\n\t\t\t\t<span class="qv-gs-index-icon lui-icon lui-icon--tick" aria-hidden="true"></span>\n\t\t\t\t<span class="qv-gs-index-text-big" q-translation="GlobalSearch.Done"></span>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n</div>'}),define("text!client.views/progress-bar/progress-bar.ng.html",[],function(){return'<div class="qv-progress-bar">\n\t<div class="progress-bar-bg">\n\t\t<div class="progress-bar-fg" ng-style="{ width: display }"></div>\n\t</div>\n\n\t<div class="progress-text" ng-bind="display" ng-hide="options.hideText"></div>\n</div>'}),define("client.views/progress-bar/progress-bar",["qvangular","text!./progress-bar.ng.html"],function(a,b){"use strict";a.directive("qvProgressBar",["$interval",function(a){return{replace:!0,template:b,restrict:"E",scope:{percentDone:"=",onCompleted:"&",options:"="},link:function(b){function c(){return b.showPercent>=100?(a.cancel(e),void b.onCompleted()):b.showPercent>=b.percentDone?void a.cancel(e):void d(b.showPercent+1)}function d(a){b.showPercent=a,b.display=a+"%"}var e,f=!0;b.display="0%",b.showPercent=0,b.$watch("percentDone",function(b){void 0!==b&&(f?(d(b),f=!1):(a.cancel(e),e=a(c,10)))}),b.$on("$destroy",function(){a.cancel(e)})}}}])}),define("client.views/global-search/directives/throbber/throbber",["qvangular","text!./throbber.ng.html","require","core.utils/help-url","core.utils/deferred","general.utils/responsive-state","core.utils/resize","client.views/progress-bar/progress-bar","client.views/global-search/global-search-service","client.views/global-search/directives/swipe-horizontal"],function(a,b,c,d,e,f,g){"use strict";var h={};Object.defineProperties(h,{THROBBER:{value:1e3},INDEX_PROGRESS:{value:5e3},NEXT_INDEX_PROGRESS:{value:500},HIDE_INDEX_DONE:{value:1e3}}),a.directive("qvGlobalSearchThrobber",["$timeout","$window","$animate",function(i,j,k){return{replace:!0,template:b,restrict:"E",link:function(b,l){function m(a){var b=e(),c=l.find(a)[0];return k.on("removeClass",c,function(a,d){"close"===d&&(k.off(c),b.resolve())}),b.promise}function n(){b.throbber.show=!1,b.indexProgress.enabled=!1,b.indexProgress.show=!1,b.indexProgress.visible=!1,b.indexDone.show=!1,b.indexDone.visible=!1}function o(){return void 0!==b.percentDone&&b.percentDone<100||F.couldEngineBeIndexing(b.app)}function p(a){E||(F.IndexProgressUpdate.bind(x),E=!0),i.cancel(C),C=i(function(){F.requestIndexProgressUpdate(b.app)},a||0)}function q(){b.indexDone.visible=!1,b.indexDone.show=!1,i.cancel(z),b.$emit("updateForceShowDimmer",!1),b.asyncHideActivity?v():z=i(u,h.THROBBER)}function r(a){
m(".qv-gs-index-progress").then(function(){b.indexProgress.visible=!0}),b.percentDone=a,b.indexProgress.show=!0,b.activity.show=!0,b.throbber.show=!1,a<100?p(h.NEXT_INDEX_PROGRESS):t()}function s(a){b.percentDone=a,a<100?p(h.NEXT_INDEX_PROGRESS):t()}function t(){i.cancel(C),E&&(F.IndexProgressUpdate.unbind(x),E=!1)}function u(){b.activity.show=!0,b.throbber.show=!0,b.emptyMessageEnabled=!1}function v(){i.cancel(z),i.cancel(A),i.cancel(B),i.cancel(C),t(),b.activity.show=!1,b.throbber.show=!1,b.indexProgress.enabled=!1,b.indexProgress.show=!1,b.indexProgress.visible=!1,b.emptyMessageEnabled=b.searchTerms.length>0}function w(){b.indexProgress.enabled=!0,p()}function x(a,c){if(a===b.app.id){var d=new Number(c);if(isNaN(d)||!c)return b.indexProgress.enabled=!0,void p(h.INDEX_PROGRESS);!b.indexProgress.show&&d<100?r(d):b.indexProgress.show?s(d):(i.cancel(z),z=i(u,h.THROBBER))}}function y(a,c){if(c){if(b.asyncHideActivity=!1,b.activity.show)return;n(),i.cancel(z),i.cancel(A),o()?w():(z=i(u,h.THROBBER),A=i(w,h.INDEX_PROGRESS))}else b.percentDone&&b.percentDone<100?(F.setLastKnownIndexProgress(b.app,100),t(),b.percentDone=100,b.asyncHideActivity=!0):100==b.percentDone?(F.setLastKnownIndexProgress(b.app,100),t(),b.asyncHideActivity=!0):v()}var z,A,B,C,D,E,F=a.getService("qvGlobalSearchService"),G=l.find(".qv-gs-index-progress .qv-gs-index-group");b.asyncHideActivity=!1,b.percentDone=void 0,b.imgSrc=c.toUrl("img/core/static/smart-search.png"),b.pages=[{},{}],b.activePageIx=0,D=function(){i(function(){G[0].scrollLeft=b.activePageIx*G[0].offsetWidth})},f.OrientationChanged.bind(D),g.on("update",D),b.goToPage=function(a){G.animate({scrollLeft:a*G[0].offsetWidth},400,"swing",function(){i(function(){b.activePageIx=a})})},b.onSwipePage=function(a){if(b.isSmallDevice){var c=a>0?1:0;c!==b.activePageIx&&b.goToPage(c)}},b.openHelp=function(){j.open(d.path+"SmartSearch_Intro")},b.$on("$destroy",function(){i.cancel(z),i.cancel(A),i.cancel(B),i.cancel(C),g.off("update",D),f.OrientationChanged.unbind(D),F.IndexProgressUpdate.unbind(x),k.off("removeClass",l[0])}),b.showIndexDone=function(){m(".qv-gs-index-done").then(function(){b.indexProgress.show=!1,b.indexProgress.visible=!1,b.indexDone.visible=!0,b.percentDone=void 0,i.cancel(B),B=i(q,h.HIDE_INDEX_DONE)}),b.indexDone.show=!0},b.$on("toggleActivityIndicator",y)}}}])}),define("client.views/global-search/directives/mobile-index-progress/mobile-index-progress",["qvangular","client.views/progress-bar/progress-bar","client.views/global-search/global-search-service"],function(a){"use strict";a.directive("qvMobileIndexProgress",["$timeout",function(b){return{replace:!0,template:'<div class="qv-mobile-index-progress"><qv-progress-bar ng-if="showMobileIndexProgressBar" percent-done="indexPercentDone" on-completed="hideMobileIndexProgressWhenDone()" options="progressBarOptions"></qv-progress-bar></div>',restrict:"E",link:function(c){function d(a,b){a===c.app.id&&(!c.showMobileIndexProgressBar&&b<100?(c.indexPercentDone=b,c.showMobileIndexProgressBar=!0,f(500)):c.showMobileIndexProgressBar?(c.indexPercentDone=b,b<100&&f(500)):e())}function e(){b.cancel(h),g&&(i.IndexProgressUpdate.unbind(d),g=!1)}function f(a){g||(i.IndexProgressUpdate.bind(d),g=!0),b.cancel(h),h=b(function(){i.requestIndexProgressUpdate(c.app)},a||0)}var g,h,i=a.getService("qvGlobalSearchService");c.progressBarOptions={hideText:!0},i.couldEngineBeIndexing(c.app)&&f(0),c.$on("$destroy",function(){b.cancel(h),i.IndexProgressUpdate.unbind(d)}),c.hideMobileIndexProgressWhenDone=function(){c.showMobileIndexProgressBar=!1}}}}])}),define("client.views/global-search/global-search-controller",["jquery","qvangular","core.utils/feature-flags","core.utils/environment","core.utils/resize","./global-search-keyboard-shortcuts","autogenerated/qix/engine-enums","general.controllers/error-handler-controller","general.utils/responsive-state","client.services/grid-service","general.utils/support","client.views/global-search/constants/request-state","client.views/global-search/constants/search-method","client.views/global-search/constants/focus-state","client.models/current-selections","client.views/global-search/directives/input/input","client.views/global-search/directives/result/result","client.views/global-search/directives/suggest/suggest","client.views/global-search/directives/history/history","client.views/global-search/directives/throbber/throbber","client.views/global-search/directives/mobile-index-progress/mobile-index-progress","client.views/global-search/global-search-data-service","client.views/global-selections/global-selections-service"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(a,b,c,d){var e={qOffset:b,qCount:c,qGroupOptions:[],qGroupItemOptions:[]};return a===m.data?(e.qGroupOptions.push({qGroupType:"DatasetType",qOffset:0,qCount:-1}),e.qGroupItemOptions.push({qGroupItemType:"Field",qOffset:0,qCount:d})):a===m.visuals&&(e.qGroupOptions.push({qGroupType:"GenericObjectsType",qOffset:0,qCount:30}),e.qGroupItemOptions.push({qGroupItemType:"GenericObject",qOffset:0,qCount:d})),e}function q(){return{qContext:"CurrentSelections"}}function r(a,b){a.dimmerStyles["max-height"]=b,a.dimmerStyles.height=b}function s(a){a.isSmallDeviceLandscape=i.orientation===i.Orientation.landscape&&i.isSmallDevice}function t(t,u,v){function w(b){1!==a(b.target).closest(".qv-selections-pager").length&&J.closeSearch()}var x=b.getService("qvGlobalSearchDataService"),y=b.getService("$timeout"),z=b.getService("qvGlobalSelectionsService"),A=b.getService("qvGlobalSearchService"),B=new f(v,t,this),C={search:{idCounter:0,requestState:l.idle,searchTerms:""},searchVisuals:{idCounter:0,requestState:l.idle,searchTerms:""},result:{requestState:l.idle},suggest:{idCounter:0,requestState:l.idle,suggestTerms:""}},D=function(){y(function(){t.isSmallDevice=i.isSmallDevice,t.isSmallDevice&&(t.forceShowDimmer=!1),s(t),H=G(),F()})},E=function(){t.isSmallDeviceLandscape=i.orientation===i.Orientation.landscape&&i.isSmallDevice,s(t),H=G(),F()},F=function(){r(t,u.find("body").height()-H)},G=function(){return v.offset().top+v[0].offsetTop+v.find(".qv-global-search-input").outerHeight()},H=G(),I=v.parent().parent(),J=this;t.inClient=d.inClient(),t.FocusState=n,t.forceShowDimmer=!1,t.isObjectsFeature=c.SMARTSEARCH_OBJECTS&&t.inClient,t.isSearchHistoryFeature=c.SEARCH_HISTORY,t.isIndexClosedFeature=c.SMARTSEARCH_INDEX_CLOSE,t.isSmallDevice=i.isSmallDevice,t.isSmallDeviceLandscape=i.orientation===i.Orientation.landscape&&i.isSmallDevice,t.showMobileIndexProgressBar=!1,i.ViewChanged.bind(D),i.OrientationChanged.bind(E),e.on("end",F),t.input="input goes here",t.result="result goes here",t.isSelectActiveInSmallDevice=!1,t.$on("$destroy",function(){v.off("qv-outside"),B.delete(),i.ViewChanged.unbind(D),i.OrientationChanged.unbind(E),e.off("end",F)}),t.$on("updateForceShowDimmer",function(a,b){t.forceShowDimmer=b}),t.app.getCurrentSelectionObject().then(function(a){t.modelSelections=a}),o.bindLayout(t,"modelSelections",function(a){var b,c=a.qSelectionObject.qSelections;b=c.reduce(function(a,b){return a+(b.qLocked===!0)?1:0},0),t.currentSelections=c.length>0,t.allSelectionsLocked=c.length===b,t.isObjectsFeature&&J.searchVisuals(t.searchTerms),J.search(t.searchTerms)}),t.$watch("app.isModal()",function(a){a&&y(function(){A.toggleGlobalSearch(t.app)})}),t.$watch(z.isSelectActive.bind(null,t.app),function(a){t.isSelectActiveInSmallDevice=a&&t.isSmallDevice}),t.$watch("query",function(a){A.setHaveQuery(t.app,!!a)}),t.isIndexClosedFeature&&!t.isSmallDevice&&A.couldEngineBeIndexing(t.app)&&(t.forceShowDimmer=!0,y(function(){t.$broadcast("toggleActivityIndicator",!0)})),t.underlines=[],t.query="",t.searchTerms=[],t.searchTermGroups=[],t.matches=[],t.displayResult={data:!1,visuals:!1},t.activeSelectIx=-1,t.showMeMoreFocus=!1,t.forcePartials=!1,t.allSelectionsLocked=!1,t.dimmerStyles={},t.error={show:!1,message:"",description:""},t.paging={lastRowIx:0,totalRows:0},t.searchOutsideSelections=function(){J.searchOutsideSelections()},t.onShowMoreHits=function(a,b,c){if(a.stopPropagation(),!b.disableShowMore){r(t,v.find(".qv-global-search-dimmer").height()),b.disableShowMore=!0,b.mobileExpand=!0;var d=p(m.data,c,1,b.qItemMatches.length+15);J.callSearch(t.searchTerms,d).then(function(a){x.showMore(a,b)}).finally(function(){b.disableShowMore=!1})}},t.getSearchTermGroup=function(a){return t.searchTermGroups.filter(function(b){return b.qSearchTermsMatched.length===a})},t.close=function(){J.closeSearch()},v.on("qv-outside",w),t.isSearchHistoryFeature&&(t.searchInputFocused=!1,t.activeHistoryIx=-1,A.initHistory(t,t.app)),t.suggestions=[],t.displaySuggestions=!1,t.activeSuggestionIx=-1,t.ignoreQueryChange=!1,t.onSuggestSelect=function(a){var b,c,d,e=[];a=void 0!==a?a:t.activeSuggestionIx,d=t.suggestions[a],x.getUnderlinersAndSearchTerms(t.query,e,[]),b=x.getResultingQueryFromSuggestion(e,d),b.length>255?(B.off(),h.showDialog({message:"ErrorDialog.SearchStringTooLong"}),c=t.$on("errorHandlerClosed",function(){B.on(),c()})):(t.query=b+" ",t.ignoreQueryChange=!1),J.hideSuggestions(),t.$broadcast("focusInput")},t.haveUnlockedSelections=function(){return t.currentSelections&&!t.allSelectionsLocked},this.hideSuggestions=function(){t.displaySuggestions&&(t.displaySuggestions=!1,this.resetSuggestions())},this.hideSoftKeyboard=function(){t.$broadcast("blurInput")},this.showNoResultsMessage=function(){return!1},this.searchOutsideSelections=function(){t.outsideSelection=!0,t.modelSelections.clearAll(),t.$broadcast("focusInput")},this.setShowPartialMatches=function(){t.forcePartials=!t.forcePartials,k.treatAsDesktop()&&t.$broadcast("focusInput")},t.isPartials=function(){return t.searchTermGroups.length&&t.searchTerms.length>t.searchTermGroups[0].qSearchTermsMatched.length},this.resetSuggestions=function(){t.activeSuggestionIx=-1,t.activeSelectIx=-1},this.showSuggestions=function(){t.displaySuggestions=!0,t.activeSuggestionIx=-1,t.activeSelectIx=-1},this.showError=function(a){t.displayResult={data:!1,visuals:!1},t.error.show=!0,t.error.translation="ErrorCode."+a.code,a.isHandled=!0},this.toogleSuggestions=function(a){a?this.showSuggestions():this.hideSuggestions()},this.emptyResult=function(){t.displayResult={data:!1,visuals:!1},t.activeSelectIx=-1,t.error.show=!1,C.search.requestState=l.idle,C.searchVisuals.requestState=l.idle,C.suggest.requestState=l.idle,t.searchTerms=[],t.searchTermGroups=[],t.searchVisualsGroups=[],t.matches=[],t.outsideSelection=!1,t.forcePartials=!1,t.focusState=n.input,this.hideSuggestions(),I.removeClass("queryon")},this.moveActiveResult=function(a){t.showMeMoreFocus=!1,0!==a&&(a>0?(t.activeSelectIx=Math.min(t.activeSelectIx+1,t.searchTermGroups.length),t.activeSelectIx=Math.min(t.activeSelectIx,t.paging.totalRows-1),t.activeSelectIx===t.searchTermGroups.length&&(t.showMeMoreFocus=!0)):a<0&&(t.activeSelectIx=Math.max(t.activeSelectIx-1,0)))},this.searchVisuals=function(a){function b(a){t.searchVisualsGroups=[],d===C.searchVisuals.idCounter&&C.searchVisuals.requestState===l.pending&&(C.searchVisuals.requestState=l.idle,C.searchVisuals.searchTerms="",x.transformResult(t,a))}function c(a){a.code===g.NxLocalizedErrorCode.LOCERR_SEARCH_TIMEOUT&&(e.emptyResult(),e.showError(a)),a.code!==g.NxLocalizedErrorCode.LOCERR_GENERIC_ABORTED&&(C.searchVisuals.requestState=l.idle,C.searchVisuals.searchTerms="",t.displayResult.visuals=!1)}if(t.isObjectsFeature&&(r(t,u.find("body").height()-H),0!==a.length)){C.searchVisuals.idCounter=C.searchVisuals.idCounter+1;var d=C.searchVisuals.idCounter,e=this,f=p(m.visuals,0,-1,20);C.searchVisuals.requestState=l.pending,C.searchVisuals.searchTerms=a,t.app[m.visuals]({qAttributes:["qProperty"]},a,f).then(b,c)}},this.search=function(a){function b(b){t.searchTermGroups=[],t.matches=[],d===C.search.idCounter&&C.search.requestState===l.pending&&(C.search.requestState=l.idle,C.search.searchTerms="",t.searchTerms=a,t.$broadcast("toggleActivityIndicator",!1),t.$broadcast("resultScrollToTop"),x.transformResult(t,b),t.activeSelectIx=-1,t.paging.lastRowIx=t.searchTermGroups.length,t.paging.totalRows=b.qTotalNumberOfGroups)}function c(a){a.code===g.NxLocalizedErrorCode.LOCERR_SEARCH_TIMEOUT&&(e.emptyResult(),e.showError(a)),a.code!==g.NxLocalizedErrorCode.LOCERR_GENERIC_ABORTED&&(C.search.requestState=l.idle,C.search.searchTerms="",t.displayResult.data=!1)}if(r(t,u.find("body").height()-H),t.focusState=n.input,0!==a.length){I.addClass("queryon"),C.search.idCounter=C.search.idCounter+1;var d=C.search.idCounter,e=this,f=p(m.data,0,5,5);C.search.requestState=l.pending,C.search.searchTerms=a,t.$broadcast("toggleActivityIndicator",!0),t.$broadcast("resultScrollToTop"),t.error.show=!1,this.callSearch(a,f).then(b,c)}},this.loadNextPage=function(){r(t,v.find(".qv-global-search-dimmer").height());var a=p(m.data,t.paging.lastRowIx,5,5);C.result.requestState===l.idle&&(C.result.requestState=l.pending,t.showMeMoreFocus=!1,t.$broadcast("toggleActivityIndicator",!0),this.callSearch(t.searchTerms,a).then(function(a){x.transformResult(t,a),t.paging.lastRowIx=t.searchTermGroups.length}).finally(function(){C.result.requestState=l.idle,t.$broadcast("toggleActivityIndicator",!1)}))},this.callSearch=function(a,b){return t.app[m.data](q(),a,b)},this.closeSearch=function(){t.isSmallDevice?(J.emptyResult(),t.query="",t.$broadcast("blurInput")):A.toggleGlobalSearch(t.app)},this.suggest=function(a){function b(a){C.suggest.suggestTerms="",x.isWhiteSpaceAt(t.query,t.query.length-1)||'"'===t.query.charAt(t.query.length-1)||(e===C.suggest.idCounter&&C.suggest.requestState===l.pending&&(x.transformSuggest(t,a,10),d.toogleSuggestions(t.suggestions.length>0),t.$broadcast("suggestShow",!0,!0)),C.suggest.requestState=l.idle)}function c(a){a.code===g.NxLocalizedErrorCode.LOCERR_SEARCH_TIMEOUT&&(a.isHandled=!0),a.code!==g.NxLocalizedErrorCode.LOCERR_GENERIC_ABORTED&&(C.suggest.requestState=l.idle,C.suggest.suggestTerms="")}if(0!==a.length){var d=this;C.suggest.idCounter=C.suggest.idCounter+1;var e=C.suggest.idCounter;C.suggest.requestState=l.pending,C.suggest.suggestTerms=a,t.app.searchSuggest({},a).then(b,c)}},this.select=function(a,b){if(t.$broadcast("blurInput"),0!==a.length&&0!==t.searchTermGroups.length){b<0&&(b=t.activeSelectIx=0);var c=t.query;t.app.selectAssociations(q(),a,b).then(function(){t.isSearchHistoryFeature&&A.createEntryInHistory(t.app,c,a)}),this.emptyResult(),t.query="",k.treatAsDesktop()&&!t.isSearchHistoryFeature&&t.$broadcast("focusInput")}},this.setTestSearchTermGroups=function(a){t.searchTermGroups=a},this.onNavigateToSheet=function(a){t.isSearchHistoryFeature&&A.createEntryInHistory(t.app,t.query,t.searchTerms),k.treatAsDesktop()?(J.emptyResult(),t.query="",t.isSearchHistoryFeature||t.$broadcast("focusInput")):y(function(){J.emptyResult(),t.query=""},200),j.highlightedCell(a)},this.showMoreHitsForVisual=function(a){var b={qOffset:0,qCount:1,qGroupOptions:[{qGroupType:"GenericObjectsType",qOffset:a.itemIndex,qCount:1}],qGroupItemOptions:[{qGroupItemType:"GenericObject",qOffset:0,qCount:a.qItemMatches.length+15}]};return t.app[m.visuals]({qAttributes:["qProperty"]},t.searchTerms,b).then(function(b){return x.showMore(b,a),a})},this.showHistory=function(a){t.searchInputFocused=a},this.setQueryFromHistory=function(a){t.ignoreQueryChange=!1,t.query=t.searchHistory[a].qData.query.trim()+" ",this.showHistory(!1),t.$broadcast("focusInput")}}return t}),define("client.views/global-search/global-search",["qvangular","text!./global-search.ng.html","client.views/global-search/global-search-controller"],function(a,b,c){return a.directive("qvGlobalSearch",function(){return{restrict:"E",template:b,controller:["$scope","$document","$element",c],require:["qvGlobalSearch"],scope:!0,replace:!0,link:function(){}}}),"<qv-global-search></qv-global-search>"}),define("client.views/global-search/global-search-service",["qvangular","client.views/global-search/global-search","client.utils/state","core.utils/notification","client.views/global-search/global-search-data-service","client.views/selection-toolbar/selection-toolbar-service"],function(a,b,c,d){a.service("qvGlobalSearchService",["$document","$timeout","qvGlobalSearchDataService","qvSelectionToolbarService",function(a,e,f,g){function h(a){return s[j(a)]}function i(a,b){s[j(a)]=b}function j(a){return a.id?a.id.toUpperCase():a.id}function k(a){return{$container:void 0,$containerId:".qv-global-search-container",$app:a,$lastKnownIndexProgress:void 0,$haveQuery:!1,getComponent:function(){return b},setup:function(){c.StateChanged.bind(l.bind(null,a)),a.isInModalSelection()&&g.confirm()},destroy:function(){c.StateChanged.unbind(l)}}}function l(a){(c.isInEditMode()||!c.isInAnalysisMode||c.inObjectView())&&o(h(a))}function m(b,c){b.$container=angular.element("<div>"),c=c||a,c.find(b.$containerId).append(b.$container),b.$container.showComponent(b.getComponent(),["$scope",function(a){a.app=b.$app}]),b.setup()}function n(a){return!(!a||void 0===a.$container)}function o(a){a.$container&&(a.$container.remove(),a.$container=void 0),a.destroy()}function p(a){var b=h(a);return b||(b=new k(a),i(a,b)),b}function q(a,b){try{var c=b.qTransientProgressMessage.qMessageParameters[0],d=new Number(c),e=p(a);!isNaN(d)&&c&&(e.$lastKnownIndexProgress=d),r.IndexProgressUpdate.emit(j(a),d)}catch(a){return}}var r,s={};return r={toggleGlobalSearch:function(a,b){var d=p(a);n(d)?o(d):(c.setState(c.States.analysis),m(d,b))},openGlobalSearch:function(a,b){var c=p(a);n(c)||(o(c),m(c,b))},closeGlobalSearchIfNoQuery:function(a){var b=h(a);b&&b.$haveQuery||this.off()},off:function(){Object.keys(s).forEach(function(a){o(s[a])})},isSearchOpen:function(a){return n(h(a))},initHistory:function(a,b){b.enigmaModel.getSearchHistoryListObject().then(function(b){var c=b.layoutSubscribe(function(b){a.searchHistory=[].concat(b).sort(function(a,b){return Date.parse(b.qData.lastUsedDate)-Date.parse(a.qData.lastUsedDate)})});a.$on("$destroy",function(){c.dispose()})})},createEntryInHistory:function(a,b,c){return a.enigmaModel.getSearchHistoryList().then(function(d){var e=d.filter(function(a){return a.qData.query.trim().toLowerCase()===b.trim().toLowerCase()});return e.length?a.enigmaModel.updateSearchHistoryObject(e[0].qInfo.qId,function(a){a.query=b.trim(),a.searchTerms=c,a.lastUsedDate=(new Date).toISOString()}):a.enigmaModel.createSearchHistoryObject(b,c)})},setLastKnownIndexProgress:function(a,b){(h(a)||{}).$lastKnownIndexProgress=b},getLastKnownIndexProgress:function(a){return(h(a)||{}).$lastKnownIndexProgress},couldEngineBeIndexing:function(a){var b=h(a)||{},c=b.$lastKnownIndexProgress;return void 0!==c&&c<100},requestIndexProgressUpdate:function(a){a.global.getProgress(0).then(q.bind(null,a))},setHaveQuery:function(a,b){p(a).$haveQuery=b}},d.mixin(r),r.notification("IndexProgressUpdate"),r}])}),define("text!client.views/state-count-bar/state-count-bar.ng.html",[],function(){return'<div class="qv-state-count-bar" tid="stateCount" qva-direction x-dir-setting="{{options.direction}}">\n\t<div class="state selected" ng-style="{\'width\': percents.qSelected + \'%\'}"></div>\n\t<div class="state locked" ng-style="{\'width\': percents.qLocked + \'%\'}"></div>\n\t<div class="state optional" ng-style="{\'width\':  percents.qOption + \'%\'}"></div>\n\t<div class="state alternative" ng-style="{\'width\':  percents.qAlternative + \'%\'}"></div>\n</div>'}),define("client.views/state-count-bar/state-count-bar",["qvangular","text!./state-count-bar.ng.html"],function(a,b){"use strict";a.directive("qvStateCountBar",function(){return{restrict:"E",template:b,replace:!0,scope:{stateCounts:"=",options:"="},link:function(a){function b(){var b,c=a.stateCounts;c&&(b=d(c),a.percents=e(b))}function c(a){return Object.keys(a).reduce(function(b,c){return b+a[c]},0)}function d(a){var b=c(a),d={};return["qSelected","qLocked","qOption","qAlternative"].forEach(function(c){var e=a[c]||0,f=Math.round(e/b*100);e>0&&0===f&&(f=1),d[c]=f}),d}function e(a){var b,c,d={},e=0;for(b in a)d[b]=a[b],(!c||a[b]>a[c])&&(c=b),e+=a[b];return e>100&&(d[c]=a[c]-(e-100)),d}a.percents=[],a.$watchCollection("stateCounts",function(){b()})}}})}),define("client.views/current-selections/current-selections",["qvangular","jquery","text!./current-selections.ng.html","client.models/current-selections","core.utils/resize","general.utils/responsive-state","client.utils/state","util","client.utils/rtl/direction-service","core.utils/feature-flags","objects/listbox-popover/listbox-popover-service","general.components/pager/pager","client.views/global-selections/global-selections-service","client.views/global-search/global-search-service","client.views/state-count-bar/state-count-bar","objects.views/charts/tooltip/chart-tooltip-service","client.views/current-selections/current-selections-service","objects/listbox-popover/listbox-popover-service-mobile","client.views/progress-bar/progress-bar"],function(a,b,c,d,e,f,g,h,i,j){"use strict";function k(a,b,c){return a.isPlaceHolder=!0,a.active=!1,a.qLocked=!1,a.feedbackActive=!1,a.translation="",a.qTotal=0,a.qStateCounts=0,b&&(a.qField=b),c&&(a.name=c),a}function l(a,b,c,d,e){return a.showField(b,d.model.app.enigmaModel,c,{},function(){d.activeFieldName="",e(function(){d.closeTooltip()},100)})}a.directive("qvSelectionPager",["qvGlobalSelectionsService","$timeout",function(a,b){return{restrict:"A",priority:1,link:function(c){var d=c.$watch(function(){return a.isSelectActive(c.app)},function(a){c.$emit("globalSelectionActive",a),b(function(){c.refreshPager(!1)})});e.on("end",function(){c.refreshPager(!1)}),c.$on("$destroy",function(){d()})}}}]);var m={template:c,replace:!0,restrict:"E",scope:{app:"="},link:function(b,c){function d(a,c){if(a===b.app.enigmaModel.id){var d=new Number(c);!b.isGlobalSearchIndexing&&d<100?(b.indexPercentDone=d,b.isGlobalSearchIndexing=!0,h(500)):b.isGlobalSearchIndexing?(b.indexPercentDone=d,d<100&&h(500)):e()}}function e(){p.cancel(o),n&&(r.IndexProgressUpdate.unbind(d),n=!1)}function h(a){n||(r.IndexProgressUpdate.bind(d),n=!0),p.cancel(o),o=p(function(){r.requestIndexProgressUpdate(b.app.enigmaModel)},a||0)}function i(){p(function(){b.isSmallDevice=f.isSmallDevice,j.SMARTSEARCH_INDEX_CLOSE&&(b.isSmallDevice?(e(),b.setSearchIndexingDone()):!r.isSearchOpen(b.app.enigmaModel)&&r.couldEngineBeIndexing(b.app.enigmaModel)&&h(0))})}function l(){g.inSheetView()&&f.isSmallDevice&&r.openGlobalSearch(b.app.enigmaModel,s)}function m(a){b.$watch(a.isInModalSelection.bind(a),function(a){b.inSelection=a,b.inSelection&&b.activeFieldName&&b.activeFieldName.length>0?b.cachedPlaceHolders=b.items.map(function(a){return k({},a.qField,a.qReadableName||a.qField)}):(b.cachedPlaceHolders=[],b.items=b.items.filter(function(a){return!a.isPlaceHolder}))})}var n,o,p=a.getService("$timeout"),q=a.getService("qvGlobalSelectionsService"),r=a.getService("qvGlobalSearchService"),s=c.parent();b.nbrSelection=0,b.haveHiddenSelections=!1,b.isSmallDevice=f.isSmallDevice,b.cachedPlaceHolders=[],b.isGlobalSearchIndexing=!1,b.progressBarOptions={hideText:!0},b.setSearchIndexingDone=function(){b.isGlobalSearchIndexing=!1},f.ViewChanged.bind(i),b.$watch("isSmallDevice",function(a){a===!0?r.openGlobalSearch(b.app.enigmaModel,s):r.closeGlobalSearchIfNoQuery(b.app.enigmaModel)}),g.StateChanged.bind(l),b.mobileIndicatorTop=!1,b.mobileIndicatorShow=!1,q.setCsShowCallback(function(a){b.mobileIndicatorShow=a}),b.$on("globalSelectionActive",function(a,c){b.isGlobalSelectionsActive=c});var t=b.$watch("app",function(a){m(a.enigmaModel),t()});b.$watch(function(){return r.isSearchOpen(b.app.enigmaModel)},function(a){if(b.isGlobalSearchActive=a,j.SMARTSEARCH_INDEX_CLOSE)if(b.isSmallDevice||a)e(),b.isGlobalSearchIndexing=!1;else if(r.couldEngineBeIndexing(b.app.enigmaModel)){var c=r.getLastKnownIndexProgress(b.app.enigmaModel);b.isGlobalSearchIndexing=!0,b.indexPercentDone=c,h(500)}}),b.toggleGlobalSelection=function(a){a.preventDefault(),q.toggleGlobalSelection(b.app)},b.toggleGlobalSearch=function(){r.toggleGlobalSearch(b.app.enigmaModel,s)},b.$on("$destroy",function(){f.ViewChanged.unbind(i),r.off(),g.StateChanged.unbind(l),q.setCsShowCallback(null),p.cancel(o),r.IndexProgressUpdate.unbind(d)})},controller:["$scope","$timeout","qvChartTooltipService","qvGlobalSelectionsService","qvCurrentSelectionsService",function(c,e,j,m,n){function o(){m.setCsShow(f.isSmallDevice&&c.items.length>0&&g.view!==g.Views.object)}function p(a){return a.every(function(a){return a.qLocked})}var q,r,s=!1,t=a.getService("qvListboxPopoverService"),u=a.getService("qvListboxPopoverServiceMobile");c.items=[],c.disable={clear:!0,back:!0,forward:!0},d.get(c.app).then(function(a){c.model=a}),d.bindLayout(c,"model",function(a){c.disable.clear=0===a.qSelectionObject.qSelections.length||p(a.qSelectionObject.qSelections),c.disable.back=0===a.qSelectionObject.qBackCount,c.disable.forward=0===a.qSelectionObject.qForwardCount,c.items=a.qSelectionObject.qSelections.filter(function(a){return!a.qIsHidden}).sort(function(a,b){return a.qSortIndex-b.qSortIndex}),c.haveHiddenSelections=a.qSelectionObject.qSelections.some(function(a){return a.qIsHidden});var b=0;c.items.forEach(function(a){a.qLocked===!0&&b++,a.translation=n.translate(a),a.name=a.qReadableName||a.qField}),c.nbrSelections=c.items.length,m.setSelectionCount(c.items.length,c.app),o(),c.cachedPlaceHolders.length>0&&c.activeFieldName&&c.activeFieldName.length>0&&(c.cachedPlaceHolders.forEach(function(a){k(a)}),c.items.forEach(function(a){c.cachedPlaceHolders.forEach(function(b,d){a.qField===b.qField&&(c.cachedPlaceHolders[d]=h.extend(!0,{},a))})}),c.items=c.cachedPlaceHolders),e(function(){c.$broadcast("refreshPager")})}),c.$watch(g.inObjectView,o),c.$watch("isSmallDevice",o),c.clear=function(a){c.$parent.itemSelected&&(c.$parent.itemSelected=!1),c.model.clearField(a)},c.clearAllFields=function(){c.model.clearAll()},c.back=function(){c.model.back()},c.forward=function(){c.model.forward()},c.showPopover=function(a){var d=angular.element(a.target).closest(".item"),g=d.scope().item.qField,h=d.scope().item.isPlaceHolder,j={qvaOutsideIgnoreFor:"currentSelectionsItems",$alignToElement:d,showLock:!0,direction:i.direction};return c.isClearSelectionIcon(a.target)?void(c.activeFieldName&&(f.isSmallDevice?t.close():u.close(),c.activeFieldName="")):g===c.activeFieldName||h?(f.isSmallDevice?t.close():u.close(),void(c.activeFieldName="")):(e(function(){c.closeTooltip()},100),c.activeFieldName=g,void(f.isSmallDevice?l(u,g,j,c,e):l(t,g,j,c,e).then(function(a){var d;a.closing.then(function(a){a&&!b(a.target).closest(".current-selection-elem").length>0&&(c.activeFieldName=""),d=a}),a.closed.then(function(){a=null,d||(c.activeFieldName="")})})))},c.openTooltip=function(a,b){if(c.isClearSelectionIcon(a.target))return void c.closeTooltip();s||Touche.utils.touch||(c.cancelTooltip(),q=e(function(){var c=b.qStateCounts,d="object"==typeof c,e=d?" ("+(c.qSelected+c.qSelectedExcluded+c.qLocked+c.qLockedExcluded)+"/"+b.qTotal+")":"";s=!0,j.open({content:[{header:(b.qReadableName||b.qField)+e,rows:[{content:b.translation}]}],position:{x:a.clientX,y:a.clientY},alwaysOnTop:!0,direction:"bottom",template:"generic"})},500))},c.closeTooltip=function(){s=!1,c.cancelTooltip(),j.close()},c.cancelTooltip=function(){e.cancel(q)},c.isClearSelectionIcon=function(a){return angular.element(a).closest(".remove").is(".remove")},r=a.$rootScope.$on("locked-feedback",function(b,d){c.items.forEach(function(b){d[0].indexOf(b.qField)!==-1&&(d[1]?b.feedbackActive=!1:b.feedbackActive=!0,a.$apply(c))})}),c.$on("$destroy",function(){r()})}]};return a.directive("qvStageCurrentSelections",function(){return m}),m}),void 0===Function.prototype.name&&Object.defineProperty(Function.prototype,"name",{enumerable:!1,get:function(){var a=this.toString().match(/^function( (.*?))?\(/);return a&&a.length>=3?a[2]:"anonymous function"}}),Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e}),Array.prototype.contains||Object.defineProperty(Array.prototype,"contains",{enumerable:!1,value:function(a){return this.indexOf(a)!==-1}}),"scrollX"in window.constructor.prototype||Object.defineProperties(window.constructor.prototype,{scrollX:{get:function(){return this.pageXOffset}},scrollY:{get:function(){return this.pageYOffset}}}),define("core.utils/augment",function(){}),define("extensions.qliktech/straight-table/straight-table-properties",["client.property-panel/default-properties","util","client.utils/property-resolver","translator","general.utils/attribute-expression-util"],function(a,b,c,d,e){var f={textAlignAuto:{ref:"qDef.textAlign.auto",type:"boolean",component:"switch",translation:"Common.Text.TextAlignment",options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}],defaultValue:!0},textAlign:{ref:"qDef.textAlign.align",type:"string",component:"dropdown",options:[{value:"left",translation:"Common.Text.AlignLeft"},{value:"right",translation:"Common.Text.AlignRight"}],defaultValue:"left",show:function(a){return void 0!==a.qDef.textAlign&&!a.qDef.textAlign.auto}}},g={representationType:{ref:"qDef.representation.type",type:"string",component:"dropdown",translation:"Object.Table.Representation",options:[{value:"text",translation:"Object.Table.Representation.Text"},{value:"url",translation:"Object.Table.Representation.Url"}],defaultValue:"text",show:function(a){if("object"!=typeof a.qDef.representation){var b=a.qDef.representation||"text";a.qDef.representation={type:b}}return!0}},representationUrl:{ref:"qDef.representation.urlLabel",type:"string",expression:"optional",translation:"Object.Table.Representation.Url.Label",defaultValue:"",change:function(a){var b=e.getIndexById(a.qAttributeExpressions,e.IDMAP.CELL_URL_LABEL);if(a.qDef.representation.urlLabel.qStringExpression){var c=a.qDef.representation.urlLabel.qStringExpression.qExpr;b===-1?a.qAttributeExpressions.push({id:e.IDMAP.CELL_URL_LABEL,qExpression:c}):a.qAttributeExpressions[b].qExpression=c}else a.qAttributeExpressions&&b>-1&&a.qAttributeExpressions.splice(b,1)},show:function(a){var b=a.qDef.representation;return b&&"url"===b.type}}},h={tableCellColoring:{component:"attribute-expression-reference",defaultValue:[],ref:"qAttributeExpressions",items:[{component:"expression",ref:"qExpression",expressionType:"measure",translation:"Object.Table.Measure.BackgroundExpression",defaultValue:"",id:e.IDMAP.CELL_BACKGROUND_COLOR,tid:"tableColorBgByExpression"},{component:"expression",ref:"qExpression",expressionType:"measure",translation:"Object.Table.Measure.ForegroundExpression",defaultValue:"",id:e.IDMAP.CELL_FOREGROUND_COLOR,tid:"tableColorByExpression"}]},totalsAggr:{type:"items",items:{totalsAggrFunc:{type:"string",component:"dropdown",ref:"qDef.qAggrFunc",translation:"Object.Table.AggrFunc",options:[{value:"Expr",translation:"Common.Auto"},{value:"Avg",translation:"Object.Table.AggrFunc.Avg"},{value:"Count",translation:"Object.Table.AggrFunc.Count"},{value:"Max",translation:"Object.Table.AggrFunc.Max"},{value:"Min",translation:"Object.Table.AggrFunc.Min"},{value:"Sum",translation:"Object.Table.AggrFunc.Sum"},{value:"None",translation:"Object.Table.AggrFunc.None"}],defaultValue:"Expr"},totalsAggrFuncMessage:{component:"text",translation:"Object.Table.AggrFuncMessage",show:function(a,b){return b&&!c.getValue(b,"properties.totals.show")&&"noTotals"===c.getValue(b,"properties.totals.position")}}}}},i={tableCellColoring:{component:"attribute-expression-reference",defaultValue:[],ref:"qAttributeExpressions",items:[{component:"expression",ref:"qExpression",expressionType:"measure",translation:"Object.Table.Measure.BackgroundExpression",defaultValue:"",id:e.IDMAP.CELL_BACKGROUND_COLOR,tid:"tableColorBgByExpression"},{component:"expression",ref:"qExpression",
expressionType:"measure",translation:"Object.Table.Measure.ForegroundExpression",defaultValue:"",id:e.IDMAP.CELL_FOREGROUND_COLOR,tid:"tableColorByExpression"},{component:"expression",ref:"qExpression",expressionType:"measure",defaultValue:"",id:e.IDMAP.CELL_URL_LABEL,tid:"URLLabelByExpression",show:!1}]}},j={uses:"settings",items:{presentation:{type:"items",translation:"properties.presentation",items:{totals:{ref:"totals.show",type:"boolean",translation:"properties.totals",component:"switch",options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}],defaultValue:!0},totalsMode:{ref:"totals.position",translation:"Common.Position",type:"string",component:"dropdown",options:[{value:"noTotals",translation:"Common.None"},{value:"top",translation:"Common.Top"},{value:"bottom",translation:"Common.Bottom"}],defaultValue:"noTotals",show:function(a){return!a.totals.show}},totalsLabel:{ref:"totals.label",translation:"properties.totals.label",type:"string",expression:"optional",defaultValue:function(){return d.get("Object.Table.Totals")}}}}}},k={type:"items",component:"expandable-items",translation:"properties.addons",items:{dataHandling:{uses:"dataHandling"}}};return{type:"items",component:"accordion",items:{data:{type:"items",component:"columns",translation:"Common.Data",sortIndexRef:"qHyperCubeDef.columnOrder",allowMove:!0,allowAdd:!0,addTranslation:"Common.Columns",items:{dimensions:{type:"array",component:"expandable-items",ref:"qHyperCubeDef.qDimensions",grouped:!0,items:b.extend(!0,{},a.dimensions.items,i,f,g)},measures:{type:"array",component:"expandable-items",ref:"qHyperCubeDef.qMeasures",grouped:!0,items:b.extend(!0,{},a.measures.items,h,f)}}},sorting:{uses:"sorting"},addons:k,settings:j}}}),define("text!extensions.qliktech/straight-table/straight-table.ng.html",[],function(){return'<div class="qv-st" ng-class="{ \'qv-st-interactive\': interactive,\n\t\t\'align-column-picker\': scrollApi.settings.columnPicker.show,\n\t\t\'qv-st-selections-active\': selections.active,\n\t\t\'qv-st-virtual-scroll-enabled\': scrollApi.virtualScrollEnabled,\n\t\t\'qv-st-navigatable\': navigatable,\n\t\t\'qv-rtl-layout\': rtl\n\t}">\n\t<div class="qv-st-header-wrapper">\n\t\t<qv-table-column-width-adjuster\n\t\t\t\tmin-col-width="scrollApi.settings.column.minColWidth"\n\t\t\t\tng-if="navigatable && !selections.active"\n\t\t\t\tcolumns="columns"\n\t\t\t\texplicit-column-widths="explicitColumnWidths"\n\t\t\t\tx-rtl="rtl"\n\t\t\t\tdir="{{direction}}">\n\t\t</qv-table-column-width-adjuster>\n\t\t<qv-straight-table-top-header></qv-straight-table-top-header>\n\t</div>\n\t<qv-scroll-area class="qv-grid-object-scroll-area qv-animate" dir="{{direction}}"\n\t\t\t\t\tx-direction="direction"\n\t\t\t\t\tng-style="tableStyles.content">\n\t\t<qv-straight-table-data qv-selections-select-while-locked="selectWhileLocked()"\n\t\t\t\t\t\t\t\tqv-selections-toggle-dimension-value="{ selector: \'.qv-st-data-cell\'}"\n\t\t\t\t\t\t\t\tqv-selections-on-toggle-dimension-value="interactive && selectDimensionValue(cell, $event)"\n\t\t\t\t\t\t\t\tqv-selections-multiselect="{ selector: \'.qv-st-data-cell:not(.qv-st-data-cell-null-value)\' }"\n\t\t\t\t\t\t\t\tqv-selections-start-multiselect="interactive && activateSelections(cell)"\n\t\t\t\t\t\t\t\tqv-selections-update-multiselect="interactive && multiselectDimensionValues(start, current, dataColIx)"\n\t\t\t\t\t\t\t\tqv-selections-end-multiselect="interactive && multiselect()"></qv-straight-table-data>\n\t</qv-scroll-area>\n\t<qv-straight-table-bottom-header></qv-straight-table-bottom-header>\n\t<qv-scroll-loader></qv-scroll-loader>\n\t<qv-straight-table-column-picker-activator ng-if="scrollApi.settings.columnPicker.show"></qv-straight-table-column-picker-activator>\n</div>\n'}),define("extensions.qliktech/straight-table/snapshot/snapshot-helper",["jquery"],function(a){function b(b,c,d,e){for(var f,g,h=d.top+d.height,i=0;i<b.length;){if(a(b[i]).offset().top+a(b[i]).height()>d.top){f=b[i];break}i++}for(i=b.length-1;i>=0;){if(a(b[i]).offset().top<h){g=b[i];break}i--}if(!f||!g||c<=0)return{index:1,height:e?2:1,width:c||1};var j=a(f).scope().row.getIndex();return{index:j,height:a(g).scope().row.getIndex()-j+1,width:c}}return{getIndexHeightAndWidth:b}}),define("objects.grid/data-grid",["core.utils/class","client.utils/rtl/rtl-util"],function(a,b){var c,d,e,f,g,h,i;return d=a.extend("ClassList",{init:function(){this.classList=[]},addClass:function(a){if(a){return this.classList.indexOf(a)===-1&&this.classList.push(a),this}},removeClass:function(a){if(a){var b=this.classList.indexOf(a);return b!==-1&&this.classList.splice(b,1),this}},hasClass:function(a){return this.classList.indexOf(a)!==-1}}),e=d.extend("Cell",{init:function(){this._super.apply(this,arguments),this.setDefaults()},setDefaults:function(){this.classList.length=0,this.style={},this.color={},this.colspan=1,this.rowspan=1,this.text="",this.displayText="",this.dataValue=-1,this.dataColIx=-10,this.dataRowIx=-1,this.isDimensionValue=!1,this.type=void 0,this.locked=!1,this.isNullValue=!1,this.value="",this.tid="",this.dir="auto",this.isRtl=!1,this.isTotal=!1,this.fieldName=""},setText:function(a){var c=b.detectTextDirection(a);this.text=a,this.dir=b.supportDirAuto()?"auto":c,this.isRtl="rtl"===c},setData:function(a,b,c,d,e){this.setText(a),this.rowspan=b||1,this.colspan=c||1,this.dataRowIx=d||-1,this.dataColIx=e||-1},setHeader:function(a,b,c,d,e,f,g,h){this.setText(a),this.dataValue=b,this.rowspan=c||1,this.colspan=d||1,this.dataRowIx=e,this.dataColIx=f,this.isTotal=h,this.templateSrc="pt-header-cell-item.ng.html",this.addClass("header"),this.setNullClass(g)},setTopHeader:function(){this.setHeader.apply(this,arguments),this.addClass("top")},setLeftHeader:function(){this.setHeader.apply(this,arguments),this.addClass("left")},setFromMetaHeader:function(a){Object.keys(a).forEach(function(b){this[b]=a[b]},this),this.setText(a.text),this.setTextAlign(a.autoAlignText,a.explicitTextAlign)},setNullClass:function(a){a&&(this.isNullValue=a,this.addClass("null-value"))}}),Object.defineProperties(e.prototype,{REPRESENTATION_URL:{value:"url"},REPRESENTATION_TEXT:{value:"text"}}),g=e.extend("StraightCell",{setDefaults:function(){this._super.apply(this,arguments),this.isNumeric=!1,this.textAlign="left",this.color.bgByExpression=!1,this.color.bgIsDark=!1,this.selected=!1,this.selectedHighlighted=!1,this.qvaOutsideIgnoreFor="",this.isSearchIcon=!1,this.open=!1,this.sortable=!1,this.isMeasure=!1,this.isSorted=!1,this.reversed=!1,this.isSelectLocked=!1,this.columnHighlighted=this.columnHighlighted||!1,this.hidden=!1},getAutoTextAlign:function(){return this.isNumeric?"right":this.isRtl?"right":"left"},setTextAlign:function(a,b){this.textAlign=a?this.getAutoTextAlign():b||"left"}}),h=e.extend("PivotCell",{setDefaults:function(){this._super.apply(this,arguments),this.templateSrc="pt-cell-item.ng.html",this.collapseExpandClass="",this.isMeta=!1},setCollapseExpandClass:function(a){this.addClass("parent"),a.qCanExpand?this.collapseExpandClass="lui-icon--plus":a.qCanCollapse&&(this.collapseExpandClass="lui-icon--minus")},setEmpty:function(a,b,c){this.setHeader("",-4,a,b),this.addClass("empty"),this.addClass(c)}}),f=d.extend("Row",{init:function(a){this._super.apply(this,arguments),this.cells=[],this.style={},this.isBold=!1,this.classList=[],this.gridType=a,this.reset()},getIndex:function(){var a,b;for(b=0;b<this.cells.length;++b)if(a=this.cells[b],a.dataRowIx>=0)return a.dataRowIx;return-1},setNextCellIx:function(a){this.nextCellIx=a},reset:function(a){var b;for(this.nextCellIx=0,this.isBold=!1,a||(this.classList=[]),b=0;b<this.cells.length;++b)this.cells[b].setDefaults()},removeUnused:function(){this.cells.splice(this.nextCellIx,this.cells.length-this.nextCellIx)},_createCell:function(){switch(this.gridType){case"pivot":return new h;default:return new g}},getCell:function(a){return this.cells[a]||(this.cells[a]=this._createCell()),this.cells[a]},getNextCell:function(){var a;return this.cells[this.nextCellIx]?(a=this.cells[this.nextCellIx],a.setDefaults()):a=this.cells[this.nextCellIx]=this._createCell(),this.nextCellIx++,a},getCellSize:function(){return this.nextCellIx},addEmptyHeaderCell:function(a,b,c,d,e,f){var g=this.getNextCell();return g.setEmpty(c,d,e),g.setData("",c,d,a,b),g.setNullClass(f),g},addEmptyMetaCell:function(a,b,c){var d=this.addEmptyHeaderCell(-1,-1,a,b,c);return d.isMeta=!0,d},addEmptyDataCell:function(a,b){var c=this.getNextCell();return c.setData("",-4,a,b),c.addClass("empty"),c},addTotalCell:function(a,b,c){var d=this.getNextCell();return d.setHeader(a,-1,b,c),d.addClass("bold"),this.addClass("bold"),d},addLeftCollapseExpandCell:function(a,b,c,d,e){var f=this.getNextCell();return f.setLeftHeader("",-1,1,1,a,b,d,e),f.setCollapseExpandClass(c),f}}),i=a.extend("RowList",{init:function(a){this.rows=[],this.gridType=a},reset:function(a){this.rows.forEach(function(b){b.reset(a)}),this.nextRowIx=0},get:function(a){return this.rows[a]||(this.rows[a]=new f(this.gridType)),this.rows[a]},getNext:function(){var a=this.get(this.nextRowIx);return this.nextRowIx++,a},removeUnused:function(){this.rows.splice(this.nextRowIx,this.rows.length-this.nextRowIx),this.rows.forEach(function(a){a.removeUnused()})},setNextRowIx:function(a){this.nextRowIx=a}}),c=a.extend("DataGrid",{init:function(a){this.headerList=new i(a),this.rowList=new i(a),this.footerList=new i(a),this.gridType=a,this.reset()},setTopTreeDepth:function(a){this.topTreeDepth=a},setLeftTreeDepth:function(a){this.leftTreeDepth=a},reset:function(a,b){this.rowList.reset(),a||(this.headerList.reset(b),this.footerList.reset(b)),this.topTreeDepth=-1,this.leftTreeDepth=-1},getRowsByCellType:function(a){return a===this.CELL_TYPE_DATA||a===this.CELL_TYPE_LEFT?this.rows:this.headerRows},getRow:function(a){return this.rowList.get(a)},getHeaderRow:function(a){return this.headerList.get(a)},getFooterRow:function(a){return this.footerList.get(a)},getNextRow:function(){return this.rowList.getNext()},getNextHeaderRow:function(){return this.headerList.getNext()},getNextFooterRow:function(){return this.footerList.getNext()},getCell:function(a,b){return this.getRow(a).getCell(b)},getHeaderCell:function(a,b){return this.getHeaderRow(a).getCell(b)},getFooterCell:function(a,b){return this.getFooterRow(a).getCell(b)},removeUnused:function(){this.rowList.removeUnused(),this.headerList.removeUnused(),this.footerList.removeUnused()},getNextRowIx:function(){return this.rowList.nextRowIx},setNextRowIx:function(a){this.rowList.setNextRowIx(a)},setNextHeaderIx:function(a){this.headerList.setNextRowIx(a)}}),Object.defineProperties(c.prototype,{headerRows:{get:function(){return this.headerList.rows}},footerRows:{get:function(){return this.footerList.rows}},rows:{get:function(){return this.rowList.rows}},GRID_TYPE_STRAIGHT:{value:"straight"},GRID_TYPE_PIVOT:{value:"pivot"},CELL_TYPE_TOP:{value:"top"},CELL_TYPE_LEFT:{value:"left"},CELL_TYPE_DATA:{value:"data"}}),c}),define("objects.grid/services/data-service",["qvangular","translator","general.utils/color","encoder","general.utils/attribute-expression-util"],function(a,b,c,d,e){"use strict";function f(a,b){var c,d=[],e=a.length,f=b.length;for(c=0;c<e;++c)d.push(c);for(c=0;c<f;++c)d.push(e+c);return d}function g(a,b){var c,d,e,f,g=[];for(d=a.rows.length,c=0;c<d;++c)f=a.rows[c],e=f.cells.length,b<e&&b>=0&&g.push(f.cells[b]);return g}function h(a,b,c,d){var e,f,g=i(a,b,c),h=g.length,j=[];for(f=0;f<h;++f)e=g[f],e.dataValue===d&&j.push(e);return j}function i(a,b,c){var d,e,f,g,h=a.getRowsByCellType(b),i=h.length,j=null,k=[];for(d=0;d<i;++d)for(f=h[d],g=f.cells.length,e=0;e<g;++e)j=f.cells[e],j.type===b&&j.dataColIx===c&&k.push(j);return k}function j(a,b,c){var d,e,f,g,h,i=a.getRowsByCellType(b),j=i.length,k=[];for(d=0;d<j;++d)for(f=i[d],h=f.cells.length,e=0;e<h;++e)g=f.cells[e],g.type===b&&g.dataRowIx===c&&k.push(g);return k}function k(a,b,c,d){var e,f,g,h,i=a.getRowsByCellType(b),j=i.length,k=null;for(e=0;e<j;++e)for(g=i[e],h=g.cells.length,f=0;f<h;++f)if(k=g.cells[f],k.dataColIx===c&&k.dataRowIx===d)return k;return null}function l(a,b,c){var d=c.isIndentMode?1:a.leftTreeDepth;return a.getHeaderCell(a.topTreeDepth,b+d)}function m(a,b){return b.type===a.CELL_TYPE_LEFT||b.type===a.CELL_TYPE_DATA?i(a,b.type,b.dataColIx):j(a,b.type,b.dataRowIx)}function n(a,b,c){var d,e,f=m(a,b),g=f.length,h=[];for(e=0;e<g;++e)d=f[e],d.dataValue===c&&h.push(d);return h}function o(a,b){var c=b.qHyperCube.qDimensionInfo.length;return b.qHyperCube.columnOrder?a<c?b.qHyperCube.qDimensionInfo[a]:b.qHyperCube.qMeasureInfo[a-c]:{othersLabel:!1,qLocked:!1}}function p(a,b){var c=b.qGrandTotalRow[a-b.qDimensionInfo.length];return c&&c.qText||(c={qText:""}),c}function q(a){if(a)return"qDimensionType"in a}function r(a){return void 0===a.textAlign||a.textAlign.auto}function s(a){return a.textAlign&&a.textAlign.align}function t(a){var b=a.representation;return b?"object"!=typeof b?{type:b}:b:{}}function u(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,o,p,q,r;for(j=0;j<f.length;++j)k=f[j],r=y(k)||!!i,q=h.getDimInfo(h.leftDimCnt+d),l=e.getHeaderRow(a),m=l.getNextCell(),m.type=e.CELL_TYPE_TOP,m.locked=!B(k)&&q.qLocked,m.isDimensionValue=!(B(k)||w(k)||r||z(k)),n=k.qText,w(k)&&(o=h.leftCellCnt+b,o>=h.pseudoDimIndex&&o--,n=h.layout.qHyperCube.qDimensionInfo[o].othersLabel),m.setTopHeader(n,k.qElemNo,1,1,b,g+c,x(k),r),(r||k.qCanCollapse||k.qCanExpand)&&(m.addClass("bold"),m.setCollapseExpandClass(k),l.addClass("bold")),k.qSubNodes.length?(p=u(a+1,b+1,c,d+1,e,k.qSubNodes,g,h,r),m.colspan=p-c,c=p):c++;return c}function v(a,b,c,d){d.dataColumnsInfo.cnt<=0||(u(1,0,0,0,a,b,c,d),a.setNextHeaderIx(a.topTreeDepth+1),a.headerRows[a.topTreeDepth].addClass("last-top-row"))}function w(a){return a.qElemNo===-3}function x(a){return a.qElemNo===-2}function y(a){return a.qElemNo===-1}function z(a){return a.qElemNo===-4}function A(a){return y(a)||z(a)}function B(a){return"P"===a.qType}function C(a){return a.qCanCollapse||a.qCanExpand||a.qSubNodes.length&&!B(a.qSubNodes[0])}function D(a,b){return 0===a&&(y(b)||B(b))||!A(b)&&!B(b)}function E(a,b,c,d,e,f,g,h){var i,j=0,k=e.getRow(a),l=g.getDimInfo(c),m=!(B(d)||w(d)||y(d)||x(d)),n=!!l&&l.qLocked,o=y(d);return c>0&&(i=k.addEmptyHeaderCell(f+a,b,1,c,"left",x(d)),i.type=e.CELL_TYPE_LEFT,i.isDimensionValue=m,i.locked=n,i.dataValue=d.qElemNo),(d.qCanCollapse||d.qCanExpand)&&(i=k.addLeftCollapseExpandCell(f+a,b,d,x(d),o),i.type=e.CELL_TYPE_LEFT,i.isDimensionValue=m,i.locked=n,i.dataValue=d.qElemNo,j=-1),i=k.getNextCell(),i.type=e.CELL_TYPE_LEFT,i.isDimensionValue=m,i.locked=n,h=h||d.qText,w(d)&&(h=l.othersLabel),i.setLeftHeader(h,d.qElemNo,1,g.leftCellCnt-c+j,f+a,b,x(d),o),(o||C(d))&&(i.addClass("bold"),k.addClass("bold")),i}function F(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,o;for(l=0;l<e.length;++l)m=e[l],D(b,m)&&(f=m,g=b,h=c),b>0&&B(m)&&(i=m),m.qSubNodes.length?(o=c+(b>0&&B(m)?0:1),a=F(a,b+1,o,d,m.qSubNodes,f,g,h,i,j,k)):(n=f.qText,i&&(n+=x(f)?" ":" - "+i.qText,i=null),E(a,g,h,f,d,j,k,n),++a);return a}function G(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s=0;for(h=0;h<d.length;++h)if(i=d[h],r=y(i)||!!g,o=f.getDimInfo(b),p=!B(i)&&!w(i)&&!r,q=!!o&&o.qLocked,j=c.getRow(a),z(i)?(k=j.getNextCell(),k.type=c.CELL_TYPE_LEFT,k.dataValue=i.qElemNo,k.isDimensionValue=p,k.locked=q,k.setLeftHeader("",-4,1,2)):(k=j.getNextCell(),k.type=c.CELL_TYPE_LEFT,k.isDimensionValue=p,k.locked=q,(i.qCanCollapse||i.qCanExpand)&&(l=k,l.setLeftHeader("",i.qElemNo,1,1,e+a,b,x(i),r),l.setCollapseExpandClass(i),k=j.getNextCell(),k.type=c.CELL_TYPE_LEFT,k.isDimensionValue=p,k.locked=q,s=1),n=i.qText,w(i)&&(n=o.othersLabel),k.setLeftHeader(n,i.qElemNo,1,2-s,e+a,b,x(i),r),r&&(k.addClass("bold"),j.addClass("bold"))),i.qSubNodes.length)m=G(a,b+1,c,i.qSubNodes,e,f,r),k.rowspan=m-a,l&&(l.rowspan=k.rowspan),a=m;else{var t=f.leftCellCnt-2*(b+1);t>0&&(k=j.getNextCell(),k.type=c.CELL_TYPE_LEFT,k.dataValue=i.qElemNo,k.isDimensionValue=p,k.locked=q,k.setLeftHeader("",-4,1,t)),++a}return a}function H(a,b,c,d){d.isIndentMode?F(0,0,0,a,b,null,-1,-1,null,c,d):G(0,0,a,b,c,d)}function I(a,b){var d,e;a.style.backgroundColor="",a.color.bgByExpression=!1,a.color.bgIsDark=!1,"U"!==b.qType&&b.qAttrExps&&b.qAttrExps.qValues&&b.qAttrExps.qValues.length&&(a.color.bgByExpression=!0,e="NaN"!==b.qAttrExps.qValues[0].qNum?b.qAttrExps.qValues[0].qNum:b.qAttrExps.qValues[0].qText,d=new c(e,"argb"),d.isInvalid()||(a.style.backgroundColor=d.toRGBA(),a.color.bgIsDark=d.isDark()&&d.getAlpha()>.5,a.addClass(a.color.bgIsDark?"color-light":"color-dark"))),a.style.color="",b.qAttrExps&&b.qAttrExps.qValues&&b.qAttrExps.qValues.length>1&&(e="NaN"!==b.qAttrExps.qValues[1].qNum?b.qAttrExps.qValues[1].qNum:b.qAttrExps.qValues[1].qText,d=new c(e,"argb"),d.isInvalid()||(a.style.color=d.toRGBA()))}function J(a,b,c,d,e){var f,g,h,i,j,k,m;for(f=0,h=b.length;f<h;++f)for(k=a.getNextRow(),0===a.leftTreeDepth&&k.addEmptyHeaderCell(c+f,d,1,1),i=Math.min(e.dataColumnsInfo.cnt,b[f].length),0===i&&0===f&&k.cells[0].addClass("first-data-cell"),g=0;g<i;++g)m=k.getNextCell(),m.type=a.CELL_TYPE_DATA,j=b[f][g],m.setData(j.qText,1,1,c+f,d+g),m.addClass("data"),0===f&&0===g&&m.addClass("first-data-cell"),"U"===j.qType&&m.setNullClass(!0),isNaN(j.qNum)||m.addClass("numeric"),(k.hasClass("bold")||l(a,g,e).isTotal)&&m.addClass("bold"),I(m,j)}function K(a,b,c,d,e,f,g,h){var i,j,k,l,m,n;for(i=0;i<g;++i){for(k=b.getRow(c+i),m=f&&f[i]?f[i].length:1,j=0;j<m;++j)l=k.getCell(d+j),l.rowspan=1,l.colspan=1,l.style.backgroundColor="",l.style.color="",l.color.bgByExpression=!1,l.color.bgIsDark=!1,n=f&&f[i]&&f[i][j],n?O(b,l,n,a,e,i,j,h):l.setDefaults();k.setNextCellIx(d+j)}b.setNextRowIx(c+i)}function L(a,b,d){var f=e.getIndexById(b.qAttrExprInfo,d);if(f!==-1){var g="NaN"!==a.qAttrExps.qValues[f].qNum?a.qAttrExps.qValues[f].qNum:a.qAttrExps.qValues[f].qText;return new c(g,"argb")}return!1}function M(a){return a&&a.length>2048?a.substring(0,2048)+"…":a}function N(a,b){for(var c=0;c<b.length;c++)if(b[c].qFallbackTitle===a.qFallbackTitle)return b[c]}function O(a,b,f,g,h,i,j,k){var l,m,n,p,u=h?h.qLeft+j:null,v=o(u,g),w=new c(255,255,255,1),x=t(v);if(b.colspan=q(v)?2:1,b.type=a.CELL_TYPE_DATA,b.isOtherCell=f.qIsOtherCell,b.isTotalCell=f.qIsTotalCell,b.representation=b.REPRESENTATION_TEXT,b.isNumeric=!isNaN(f.qNum),"url"===x.type){var y,z=N(v,g.qHyperCube.qDimensionInfo),A=e.getIndexById(z.qAttrExprInfo,e.IDMAP.CELL_URL_LABEL);A>-1&&f.qAttrExps.qValues?(y=f.qAttrExps.qValues,p="NaN"!==y[A].qNum||y[A].qText?y[A].qText||y[A].qNum:" "):p=""===x.urlLabel?f.qText:x.urlLabel;try{b.url=d.encodeForHref(f.qText),b.representation=b.REPRESENTATION_URL}catch(a){b.url=""}}else p=f.qText;var B=M(p);b.setText(B),b.setTextAlign(r(v),s(v)),b.isOtherCell&&(b.setText(v.othersLabel),b.setTextAlign(r(v),s(v))),b.locked=v.qLocked,b.dataValue=f.qElemNumber,b.dataColIx=u,b.dataRowIx=k?h.qTop+h.qHeight-i-1:h.qTop+i,b.isNumeric=!isNaN(f.qNum),b.isNullValue=b.isDimensionValue?b.dataValue===-2:f.qIsNull,b.isDimensionValue=!b.isNullValue&&q(v),b.selected=!1,b.selectedHighlighted=!1,b.isNullValue||(l=L(f,v,e.IDMAP.CELL_BACKGROUND_COLOR))&&!l.isInvalid()&&(b.color.bgByExpression=!0,b.style.backgroundColor=l.toRGBA(),b.color.bgIsDark=l.isDark()&&l.getAlpha()>.5,m=c.getBlend(w,new c(l._r,l._g,l._b,1),l._a),b.color.fadeFromColor=new c(m._r,m._g,m._b,0).toRGBA(),b.color.fadeToColor=m.toRGBA(),1===a.headerRows.length&&(n=a.getHeaderRow(0).cells.filter(function(a){return a.dataColIx===b.dataColIx})[0],n.color.bgIsDark=l.isDark())),(l=L(f,v,e.IDMAP.CELL_FOREGROUND_COLOR))&&!l.isInvalid()&&(b.style.color=l.toRGBA())}function P(a,b){var c,d,e,f;c=a.getHeaderRow(0),d=a.getHeaderRow(a.topTreeDepth),b.dataColumnsInfo.cnt>0&&b.leftCellCnt>0&&(e=c.addEmptyMetaCell(a.topTreeDepth,b.leftCellCnt,"left-meta"),e.templateSrc="pt-meta-left.ng.html",e.addClass("meta")),b.dataColumnsInfo.cnt>0&&(f=c.addEmptyMetaCell(1,b.dataColumnsInfo.cnt),f.addClass("top-meta").addClass("meta"),f.templateSrc="pt-meta-top.ng.html");for(var g=0;g<b.leftColumns.length;g++)e=d.addEmptyMetaCell(1,b.leftColumns[g].length,"left-meta"),e.addClass("bottom-meta")}function Q(a,b){return b.length?Q(a+1,b[0].qSubNodes):a}function R(a,c){function d(){return c.qHyperCube.qMeasureInfo.length>0&&c.qHyperCube.qGrandTotalRow.length>0}function e(){return d()&&c.totals&&(c.totals.show||"noTotals"!==c.totals.position)}function f(){return!(e()&&c.totals&&!c.totals.show&&"bottom"===c.totals.position)}var g,h,i,j,k,l,m=a.headerRows[0].getCellSize();if(e()&&f())h=a.getNextHeaderRow();else{if(!e())return;h=a.getNextFooterRow()}for(g=0;g<m;++g)k=a.getHeaderCell(0,g),k.isSearchIcon||(j=h.getNextCell(),j.type=a.CELL_TYPE_TOP,j.tid=k.isSearchIcon?"st.total.search":"st.total",j.colIx=g,j.style={},j.colspan=k.isDimension?2:1,j.isDimension=!f()&&k.isDimension,j.isMeasure=k.isMeasure,k.isMeasure?(i=p(k.dataColIx,c.qHyperCube),l=i.qText,j.isNumeric=!0):(l=0===g?void 0!==c.totals.label?c.totals.label:b.get("Object.Table.Totals"):" ",j.isNumeric=!1),j.setText(l),k.info&&j.setTextAlign(r(k.info),s(k.info)),j.isTotal=!0)}function S(a,b){var c,d,e,f=b.length;for(d=a.getNextHeaderRow(),c=0;c<f;++c)e=d.getNextCell(),e.type=a.CELL_TYPE_TOP,e.setFromMetaHeader(b[c])}function T(a,b,c){a.tid="st.header",a.qvaOutsideIgnoreFor="",a.isSearchIcon=!1,a.open=!1,a.canCollapse=!1,a.canExpand=!1,a.rowspan=1,a.colspan=1,a.color={},b?(a.isFillColumn=!0,a.text="",a.sortable=!1,a.isDimension=!1,a.isSorted=!1,a.reversed=!1,a.style={width:"auto"}):(a.isNumeric="N"===a.info.qDimensionType||void 0===a.info.qDimensionType,a.locked=a.info.qLocked,a.text=a.info.qFallbackTitle,a.sortable=!0,a.dataColIx=a.qLeft,a.isDimension=!!a.info.qDimensionType,a.fieldName=a.isDimension?a.info.qGroupFieldDefs[a.info.qGroupPos]:"",a.isMeasure=!a.isDimension,a.isSorted=a.dataColIx===c[0],a.reversed=!!a.info.qReverseSort,a.sortIndicator=a.info.qSortIndicator,a.autoAlignText=r(a.info),a.explicitTextAlign=s(a.info),a.color={})}function U(){var a={glyphCntRange:{min:0,ok:0,max:1e5}};return T(a,!0,[]),a}function V(a,b,c,d,e,f,g){var h,i,j,k=g.column.glyphWidth,l=Math.ceil(g.column.minColWidth/k),m=Math.ceil(g.column.maxColWidth/k),n=[],o=[],q=[],r=Math.ceil(g.column.paddingWidth/k),s=Math.floor(a/k),u=b>0?Math.round(b/k*10)/10:NaN,v=Math.max(3,d.qApprMaxGlyphCount),w=Math.max(3,d.qFallbackTitle.length),x=0;if(n.push(3),c){var y=p(e,f);o.push(y.qText.length)}else{var z=t(d);"url"===z.type&&z.urlLabel&&(v=z.urlLabel.length),o.push(v),x=Math.ceil(g.column.minSearchWidth/k)}return n.push(m),n.push(s-r-x),o.push(w+x),q.push(w+x),h=Math.min.apply(null,n),o.push(h),i=Math.max.apply(null,o),q.push(i),j=Math.max.apply(null,q),{min:Math.max(l+x,h)+r,ok:Math.min(m,i)+r,optimal:j+r+5,explicit:u,search:x}}function W(a,b,c,d,e){var f,g,h,i,j,k,l=a.columnOrder,m=a.qDimensionInfo,n=a.qMeasureInfo,o=d.column.glyphWidth,q=Math.floor(c/o);for(e||(e=[]),k=0;k<l.length&&(d.useHorizontalScroll||q>0)&&(j=function(a){return a<m.length?m[a]:n[a-m.length]}(l[k]),g=l[k]>=m.length,h=V(c,b[k],g,j,l[k],a,d),i=h.min,!(!d.useHorizontalScroll&&q-i<0&&e.length>0));++k)q-=i,f=e[k],f||(f={},f.style={},e.push(f)),f.info=j,f.isDimension=l[k]<m.length,f.isMeasure=g,f.grandTotal=p(l[k],a),f.qLeft=l[k],f.glyphCntRange=h,T(f,!1,a.qEffectiveInterColumnSortOrder);return e}function X(a,b){var c,d,e,f=0,g=a.length;for(c=0;c<g;c++)d=c-f,e=a[d],e.isDimension||e.isMeasure||(a.splice(d,1),f++);for(;a.length>b;)a.pop()}function Y(a,b,c,d,e,f){var g,h,i,j,k=c.useHorizontalScroll?c.width:c.width-c.columnPicker.width,l=a.qHyperCube.columnOrder,m=c.column.glyphWidth,n=m/k,o=1;for(e&&X(e,l.length),c.columnPicker.show=!1,W(a.qHyperCube,b,k,c,e),c.columnCount=e.length,c.columnPicker.show=e.length<l.length,h=e.length,g=0;g<h;g++)i=e[g],i.widthFactor=i.glyphCntRange.min*m/k,o-=i.widthFactor;if(o>0){var p;if(j=o,c.useAllSpace){var q=(j-.015)/h;e.forEach(function(a){a.widthFactor+=q,o=0})}else p=e.reduce(function(a,b){return a+b.glyphCntRange.ok-b.glyphCntRange.min},0),e.forEach(function(a){var b=a.glyphCntRange.ok-a.glyphCntRange.min,c=b/p,d=Math.min(b*m/k,c*j);b>0&&(d>o?(a.widthFactor+=o,o=0):(a.widthFactor+=d,o-=d))})}if(o>0){var r;r=e.concat().sort(function(a,b){return a.glyphCntRange.optimal-a.glyphCntRange.ok-(b.glyphCntRange.optimal-b.glyphCntRange.ok)}),r.forEach(function(a){var b=a.glyphCntRange.optimal-a.glyphCntRange.ok,c=Math.min(o,b*n);b>0&&(c>o?(a.widthFactor+=o,o=0):(a.widthFactor+=c,o-=c))})}return o=aa(e,c),$(e,k,c.column.minSearchWidth/k,d),Z(e,k,f,c),e}function Z(a,b,c,d){var e,f,g,h=0;for(f=0;f<a.length;++f)e=a[f],e.isFillColumn?g=e:(e.calculatedWidth=Math.round(b*e.widthFactor),d.useHorizontalScroll&&e.calculatedWidth<d.column.minColWidth&&(e.calculatedWidth=d.column.minColWidth),c&&e.isSearchIcon?(e.style.width="1px",h+=1):(e.style.width=e.calculatedWidth+"px",h+=e.calculatedWidth));d.useHorizontalScroll&&g&&(g.style={width:b-h+"px"})}function $(a,b,c,d){var e,f,g,h=0,i=Math.round(b*c);for(e=0,f=a.length;e<h+f;++e)g=a[e],g.isDimension&&(a.splice(e+1,0,_(g,i,c,d)),g.widthFactor=Math.max(0,g.widthFactor-c),++h)}function _(a,b,c,d){return{isSearchIcon:!0,qvaOutsideIgnoreFor:"qv-st-header-cell-search-"+d,tid:"st.header.search",widthFactor:a.shouldBeRemoved?0:c,calculatedWidth:a.shouldBeRemoved?0:b,style:{width:b+"px"},fieldName:a.fieldName,dataColIx:a.dataColIx,colspan:1}}function aa(a,b){var c,d,e=1,f=b.width,g=b.column.glyphWidth,h=b.column.minSearchWidth/f,i=0,j=!1;a.forEach(function(a){if(a.shouldBeRemoved=!1,j)return a.widthFactor=0,void(a.shouldBeRemoved=!0);a.glyphCntRange.explicit?(c=a.glyphCntRange.explicit*g/f,a.isDimension&&(c+=h),i=e-c,i>=0||b.useHorizontalScroll?(a.widthFactor=c,e-=a.widthFactor):(d=a.glyphCntRange.min*g/f,e-d>-.01?(a.widthFactor=e,e-=a.widthFactor):(a.widthFactor=e,a.shouldBeRemoved=!0,j=!0))):(d=a.glyphCntRange.min*g/f,e>=a.widthFactor||b.useHorizontalScroll?e-=a.widthFactor:e-d>-.01?(a.widthFactor=e,e-=a.widthFactor):(a.widthFactor=e,a.shouldBeRemoved=!0,j=!0))});var k=b.columnCount;if(a.forEach(function(b,c){b.shouldBeRemoved&&(k--,c>0&&(a[c-1].widthFactor+=b.widthFactor),b.widthFactor=0)}),b.columnPicker.show||k===b.columnCount||(b.columnPicker.show=!0),!b.columnPicker.show){var l=a.reduceRight(function(a,b){return a||b.widthFactor>0&&!b.glyphCntRange.explicit&&b},!1);l&&(l.widthFactor+=b.columnPicker.width/f)}b.columnCount=k;var m=U();return a.push(m),e}a.service("qvGridObjectDataService",function(){return{getTopTreeDepth:function(a){return Q(0,a.qTop)},getLeftTreeDepth:function(a){return Q(0,a.qLeft)},updatePivotItems:function(a,b,c,d){var e=a.layout,f=a.grid,g=b[0].qTop,h=b[0].qLeft,i=b[0].qData,j=Q(0,g),k=Q(0,h),l=c[0],m=a.metaGhostHeaders,n=e.qHyperCube.qIndentMode,o=this.getPseudoDimIndex(e);f.reset(!1,d,o,n),f.setTopTreeDepth(j),f.setLeftTreeDepth(k),P(f,m),v(f,g,l.qLeft,m),H(f,h,l.qTop,m),J(f,i,l.qTop,l.qLeft,m),f.removeUnused()},updateStraightItems:function(a,b,c,d,e,f){var g,h,i,j,k,l=a.layout,m=a.grid,n=b.length+1;for(d||m.reset(f),f||(S(m,c),R(m,l)),g=m.getNextRowIx(),k=0;k<n;++k)b[k]?(i=b[k].qMatrix,j=b[k].qArea,h=i.length):(i=null,j=null),K(l,m,g,k,j,i,h,e);d&&m.setNextRowIx(m.rows.length),m.removeUnused()},getPseudoDimIndex:function(a){var b=a.qHyperCube.qEffectiveInterColumnSortOrder.indexOf(-1);return~b?b:a.qHyperCube.qEffectiveInterColumnSortOrder.length},getColumnInfo:o,getColumnCells:g,getCellsInColumnWithValue:h,getCellsInColumn:i,getCellsInRow:j,getSiblingCells:m,getSiblingCellsWithValue:n,getCellInColumnWithRowIndex:k,columnOrder:{get:f},getStraightMetaHeaders:Y}})}),define("objects.grid/services/selections",["qvangular","util","objects.grid/services/data-service","objects.grid/directives/selections"],function(a,b){"use strict";a.service("qvGridObjectSelectionService",["$timeout","$document","qvGridObjectDataService",function(a,c,d){var e;return e={$new:function(){var a={active:!1,currentDataColIx:-1,currentDataRowIx:-1,currentCell:void 0,activationCell:void 0,dataValues:{},unbindKeyboard:null};return Object.defineProperties(a,{dataValuesArray:{get:function(){var a,b=[],c=Object.keys(this.dataValues),d=c.length;for(a=0;a<d;++a)b.push(parseInt(c[a]));return b}},selectedIndices:{get:function(){var a,b=[],c=this.dataValuesArray,d=c.length;for(a=0;a<d;++a)b.push(this.dataValues[c[a]]);return b}}}),a},init:function(a,b,c,d,f,g){a.confirm=function(){b.endSelections(!0),a.deactivated(),e.reset(c),e.hide(c),d()},a.cancel=function(){b.endSelections(!1),a.deactivated(),e.reset(c),e.hide(c),f()},a.clear=function(){c.dataValues={},g(),e.reset(c),b.clearSelections(),a.selectionsMade=!1}},reset:function(a){a.dataValues={},a.currentDataColIx=-1,a.currentDataRowIx=-1,a.currentCell=void 0},show:function(a,c){a.active||(a.currentDataColIx=c.dataColIx,a.currentDataRowIx=c.dataRowIx,a.activationCell=b.extend(!0,{},c),a.active=!0)},hide:function(a){a.active=!1},bindKeyboard:function(a,b){var d=".selections-keyboard-"+b;return c.on("keyup"+d,function(b){27===b.which?a.cancel():13===b.which&&a.confirm()}),function(){c.off(d)}},isColumnar:function(a,b){return b.type===a.CELL_TYPE_LEFT||b.type===a.CELL_TYPE_DATA},selectValue:function(a,b,c){c.dataValues[b.dataValue]=e.isColumnar(a,b)?b.dataRowIx:b.dataColIx,c.currentDataColIx=b.dataColIx,c.currentDataRowIx=b.dataRowIx},selectCell:function(a,b,c){a.gridType===a.GRID_TYPE_PIVOT?(b[c?"addClass":"removeClass"]("selected-highlighted"),b[c?"removeClass":"addClass"]("selected")):(b.selectedHighlighted=!!c,b.selected=!c)},lockCell:function(a,b){a.gridType===a.GRID_TYPE_PIVOT?b.addClass("locked"):b.isSelectLocked=!0},deselectValue:function(a,b,c){delete c.dataValues[b.dataValue]},deselectCell:function(a,b){a.gridType===a.GRID_TYPE_PIVOT?(b.removeClass("selected-highlighted"),b.removeClass("selected")):(b.selectedHighlighted=!1,b.selected=!1)},unlockCell:function(a,b){a.gridType===a.GRID_TYPE_PIVOT?b.removeClass("locked"):b.isSelectLocked=!1},removeCellStyle:function(a){(a.color.bgByExpression||a.style.color)&&(a.styleCache={style:a.style,bgByExpression:a.color.bgByExpression},a.style="",a.color.bgByExpression=!1)},restoreCellStyle:function(a){a.styleCache&&(a.style=a.styleCache.style,a.color.bgByExpression=a.styleCache.bgByExpression,delete a.styleCache)},getSelectionType:function(a,b){var c={};return c[a.CELL_TYPE_TOP]="T",c[a.CELL_TYPE_LEFT]="L",c[a.CELL_TYPE_DATA]="D",c[b]},sendSelection:function(a,b,c,d,f){var g,h,i;0!==c.selectedIndices.length&&(e.isColumnar(d,c.currentCell)?(g=[c.currentDataColIx],h=c.selectedIndices):(g=c.selectedIndices,h=[c.currentDataRowIx]),i=e.getSelectionType(d,f.type),b.selectionsMade=!0,a.select(h,g,i).then(function(a){a||b.clear()}))},getCellCountWithDataValue:function(a,b,c){var d,f,g,h=[],i=0,j=b.length;if(0===j)return 0;for(g=0;g<j;++g)f=b[g],d=e.isColumnar(a,f)?f.dataColIx:f.dataRowIx,f.dataValue===c&&h.indexOf(d)===-1&&(h.push(d),i++);return i},getSiblingCell:function(a,b){return a.gridType===a.GRID_TYPE_PIVOT?b.currentCell:b.activationCell},selectDimensionCells:function(a,c,f,g,h,i){var j,k,l=h.dataValue,m=l in f.dataValues,n=d.getSiblingCells(g,e.getSiblingCell(g,f)||h);if(n.indexOf(h)!==-1&&(k=h.type===g.CELL_TYPE_TOP?a.getSize().qcx:a.getSize().qcy,j=e.getCellCountWithDataValue(g,n,l),k!==j||!i||!m))return n.forEach(function(a){a.dataValue in f.dataValues&&e.selectCell(g,a)}),i&&m?(e.deselectValue(g,h,f),n.forEach(function(a){a.dataValue===l&&e.deselectCell(g,a)})):m?i||(n.forEach(function(a){a.dataValue===l&&e.selectCell(g,a)}),e.selectCell(g,h,!0)):(e.selectValue(g,h,f),n.forEach(function(a){a.dataValue===l&&e.selectCell(g,a)}),e.selectCell(g,h,!0)),f.currentCell=b.extend(!0,{},h),function(){0===f.dataValuesArray.length?c.clear():e.sendSelection(a,c,f,g,h)}},selectDimensionValue:function(a,b,c,d,f,g,h){var i,j=e.activateSelections(a,b,c,d,f);return f.locked||f.isNullValue||(i=e.selectDimensionCells(b,c,d,g,f,h))&&i(),j},activateSelections:function(b,c,d,f,g){return f.active||g.locked||(c.beginSelections(),e.show(f,g),f.unbindKeyboard=e.bindKeyboard(d,b),a(function(){d.activated(!0)})),function(){f.unbindKeyboard()}},updateStraight:function(a,b,c){var f,g,h,i
;if(b.dataValuesArray.length)for(i=d.getSiblingCells(a,c),h=i.length,f=0;f<h;++f)g=i[f],g.dataValue in b.dataValues&&(e.selectCell(a,g),b.currentDataRowIx===g.dataRowIx&&e.selectCell(a,g,!0))},updatePivot:function(a,b,c){var f,g,h,i;if(b.dataValuesArray.length)for(i=d.getSiblingCells(a,c),h=i.length,f=0;f<h;++f)g=i[f],g.dataValue in b.dataValues&&e.selectCell(a,g)}}}])}),define("objects.grid/services/column-highlight-service",["qvangular","objects.grid/services/data-service"],function(a){"use strict";a.service("qvGridColumnHighlightService",["qvGridObjectDataService",function(a){function b(a,b){var c=b.filter(function(b){return b.text===a});return 1===c.length?c[0].dataColIx:-1}return{grid:null,headers:[],init:function(a,b){this.grid=a,this.headers=b},highlightColumnByName:function(c,d){if(this.grid){1===arguments.length&&(d=!0);var e=b(c,this.headers);a.getCellsInColumn(this.grid,"data",e).forEach(function(a){a.columnHighlighted=d})}},resetHighlightedColumns:function(){var b,c=this.headers.length;for(b=0;b<c;++b)a.getColumnCells(this.grid,b).forEach(function(a){a.columnHighlighted=!1})}}}])}),define("text!extensions.qliktech/straight-table/layout/top/straight-table-top-header.ng.html",[],function(){return'<div class="qv-st-header" tid="qv-st-header-top" ng-style="scrollApi.topBottomStyle">\n\t<table\tdir="{{direction}}"\n\t\t\tng-style="tableStyles.header"\n\t\t\tqva-delegated-activate=".qv-st-header-sortable:not(.qv-st-custom-header)#interactive && !selections.active && sortHeader($event);\n\t\t   .qv-st-header-cell-search:not(.qv-st-total-cell)#interactive && !selections.active && searchHeader($event)">\n\t\t<colgroup class="qv-st-columns">\n\t\t\t<col ng-repeat="header in grid.headerRows[0].cells"\n\t\t\t\t ng-style="header.style"\n\t\t\t\t ng-class="header.classList"/>\n\t\t</colgroup>\n\t\t<tbody>\n\t\t<tr ng-repeat="row in grid.headerRows">\n\t\t\t<th ng-repeat="header in row.cells"\n\t\t\t\ttid="{{header.tid}}"\n\t\t\t\tclass="qv-st-header-cell"\n\t\t\t\tqva-outside-ignore-for="{{header.qvaOutsideIgnoreFor}}"\n\t\t\t\tng-class="{ \'qv-st-header-cell-numeric\': header.isNumeric,\n\t\t\t\t\t\'qv-st-custom-header\': !!options.customHeader,\n\t\t\t\t\t\'qv-st-header-sortable\': header.sortable,\n\t\t\t\t\t\'qv-st-total-cell\': header.isTotal,\n\t\t\t\t\t\'qv-st-header-cell-hidden\': header.shouldBeRemoved,\n\t\t\t\t\t\'qv-st-header-cell-dimension\': header.isDimension,\n\t\t\t\t\t\'qv-st-header-cell-search\': header.isSearchIcon,\n\t\t\t\t\t\'qv-st-header-cell-search-open\': header.isSearchIcon && header.open }"\n\t\t\t\tcolspan="{{header.colspan}}">\n\t\t\t\t<qv-straight-table-header-cell ng-if="!header.isSearchIcon"></qv-straight-table-header-cell>\n\t\t\t\t<qv-straight-table-header-cell-search ng-if="!header.isTotal && header.isSearchIcon"></qv-straight-table-header-cell-search>\n\t\t\t</th>\n\t\t</tr>\n\t\t</tbody>\n\t</table>\n</div>\n'}),define("extensions.qliktech/straight-table/layout/top/straight-table-top-header",["qvangular","jquery","text!./straight-table-top-header.ng.html"],function(a,b,c){"use strict";a.directive("qvStraightTableTopHeader",function(){return{restrict:"E",replace:!0,template:c,link:function(a){a.sortHeader=function(c){var d=b(c.target).scope().header;a.sort(d)},a.searchHeader=function(c){var d=b(c.target).closest(".qv-st-header-cell"),e=d.scope().header;c.preventDefault(),a.search(d,e)}}}})}),define("text!extensions.qliktech/straight-table/layout/header-cell/straight-table-header-cell.ng.html",[],function(){return'<div class="qv-st-header-cell-wrapper" ng-style="{height: customHeaderHeight}">\n\t<div class="qv-st-value" ng-if="!hasCustomHeader"\n\t\t ng-class="{ \'qv-st-header-selections-active\': header.selectionsActive }"\n\t\t ng-style="{ \'textAlign\': header.textAlign }">\n\t\t<div class="qv-st-value-overflow"\n\t\t\t dir="{{header.dir}}"\n\t\t\t ng-class="{ \'qv-rtl-text\': header.isRtl }">\n\t\t\t<i ng-class="{\'lui-icon\': header.locked, \'lui-icon--lock\': header.locked }"></i><span ng-attr-title="{{header.text}}" ng-bind="header.text"></span>\n\t\t</div>\n\t</div>\n\n\t<i ng-if="header.isSorted && header.sortIndicator !== \'N\' && !hasCustomHeader"\n\t   class="qv-st-sorting-indicator"\n\t   ng-class="{ \'lui-icon lui-icon--triangle-top\': header.sortIndicator === \'A\', \'lui-icon lui-icon--triangle-bottom\': header.sortIndicator === \'D\', \'icon-triangle-light\': header.color.bgIsDark && header.reversed }"\n\t   ng-style="header.sortStyle"></i>\n</div>\n'}),define("extensions.qliktech/straight-table/layout/header-cell/straight-table-header-cell",["qvangular","text!./straight-table-header-cell.ng.html","general.utils/responsive-state"],function(a,b,c){"use strict";a.directive("qvStraightTableHeaderCell",[function(){return{restrict:"E",replace:!0,template:b,link:function(b,d){b.hasCustomHeader=!!b.options.customHeader;var e=d.closest(".qv-st-header-cell");if(b.options.customHeader){b.customHeaderHeight=b.options.customHeader.height;var f=a.getService("$compile");b.dmmodel=b.options.customHeader.model,d.append(f(b.options.customHeader.template)(b))}b.$watch("!header.isTotal && selections.currentDataColIx === header.dataColIx",function(a){if(!a)return void(b.selections.currentDataColIx!==-1&&b.header.removeClass("qv-st-active-col"));b.header.addClass("qv-st-active-col"),b.selectionsApi.getDockToElement=function(){var a=b.rtl?e.next():e;return c.isSmallDevice?d.closest(".qv-object").parent():a}})}}}]),a.directive("qvStraightTableHeaderCellSearch",[function(){return{restrict:"E",replace:!0,template:'<i class="lui-icon  lui-icon--search" q-title-translation="Common.Search"></i>',link:function(a,b){var d=b.closest(".qv-st-header-cell");a.$watch("!header.isTotal && selections.currentDataColIx === header.dataColIx",function(b){if(!b)return void(a.selections.currentDataColIx!==-1&&a.header.removeClass("qv-st-active-col"));a.header.addClass("qv-st-active-col"),a.selectionsApi.getSelectionToolbarWidthOffset=function(){var b=a.rtl?d.prev():d;return c.isSmallDevice?0:b[0].getBoundingClientRect().width+1}})}}}])}),define("text!extensions.qliktech/straight-table/layout/data/straight-table-data.ng.html",[],function(){return'<div class="qv-st-data" tid="qv-st-data">\n\t<qv-scroll-load-button\n\t\t\tclass="qv-st-load-prev"\n\t\t\tdisabled="!navigatable"\n\t\t\tng-show="scrollApi.loadPrevious && scrollApi.settings.columnCount > 0 && ( navigatable || !isLoadPrevVisible )"\n\t\t\ton-load="scrollApi.gotoPreviousBlock()"\n\t\t\ttext="Object.Listbox.LoadPrevious"\n\t\t\tprevious="true">\n\t</qv-scroll-load-button>\n\t<table ng-style="dataTableHeight"\n\t\t   dir="{{direction}}">\n\t\t<colgroup class="qv-st-columns">\n\t\t\t<col ng-repeat="header in grid.headerRows[0].cells"\n\t\t\t\t ng-style="header.style"\n\t\t\t\t ng-class="header.classList"/>\n\t\t</colgroup>\n\t\t<tbody>\n\t\t\t<tr ng-repeat="row in grid.rows" class="qv-st-data-row" ng-class="{ \'qv-grid-object-data-first-row\': $first, \'qv-grid-object-data-last-row\': $last }">\n\t\t\t\t<td ng-repeat="cell in row.cells" class="qv-st-data-cell"\n\t\t\t\t\trowspan="{{ cell.rowspan }}"\n\t\t\t\t\tcolspan="{{ cell.colspan }}"\n\t\t\t\t\tng-style="!cell.selected && !cell.selectedHighlighted && cell.style"\n\t\t\t\t\tng-class="{ \'qv-st-data-cell-dimension-value\' : cell.isDimensionValue,\n\t\t\t\t\t\t\'qv-st-data-cell-hidden\': cell.hidden,\n\t\t\t\t\t\t\'qv-st-data-cell-numeric\': cell.isNumeric,\n\t\t\t\t\t\t\'qv-st-data-cell-selected\': cell.selected,\n\t\t\t\t\t\t\'qv-st-data-cell-selected-highlighted\': cell.selectedHighlighted,\n\t\t\t\t\t\t\'qv-st-data-cell-null-value\': cell.isNullValue,\n\t\t\t\t\t\t\'qv-st-data-cell-locked\': cell.isSelectLocked,\n\t\t\t\t\t\t\'qv-st-data-cell-color-dark\': cell.color.bgByExpression && !cell.color.bgIsDark,\n\t\t\t\t\t\t\'qv-st-data-cell-color-light\': cell.color.bgByExpression && cell.color.bgIsDark,\n\t\t\t\t\t\t\'qv-st-data-cell-column-highlighted\': cell.columnHighlighted}">\n\t\t\t\t<qv-straight-table-data-cell></qv-straight-table-data-cell>\n\t\t\t</td>\n\t\t</tr>\n\t\t</tbody>\n\t</table>\n\t<qv-scroll-loader class="qv-scroll-row-loader"></qv-scroll-loader>\n\t<qv-scroll-load-button\n\t\t\tclass="qv-st-load-next"\n\t\t\tng-show="scrollApi.loadNext && scrollApi.settings.columnCount > 0 && navigatable"\n\t\t\ton-load="scrollApi.gotoNextBlock()"\n\t\t\ttext="Object.Listbox.LoadMore">\n\t</qv-scroll-load-button>\n</div>\n'}),define("extensions.qliktech/straight-table/layout/data/straight-table-data",["qvangular","text!./straight-table-data.ng.html"],function(a,b){"use strict";a.directive("qvStraightTableData",[function(){return{restrict:"E",replace:!0,template:b}}])}),define("text!extensions.qliktech/straight-table/layout/data-cell/straight-table-data-cell.ng.html",[],function(){return'<div class="qv-st-value"\n\t ng-attr-title="{{cell.text}}"\n\t ng-style="{ \'textAlign\': cell.textAlign }"\n\t dir="{{cell.dir}}">\n\t<div class="qv-st-value-overflow"\n\t\t ng-class="{ \'qv-rtl-text\': cell.isRtl }">\n\t\t<a ng-if="cell.representation === \'url\' && !selections.active" ng-style="{\'color\': cell.style.color}" qva-activate="openUrl(cell.url)" ng-attr-title="{{cell.url}}" ng-bind="cell.text"></a>\n\t\t<span ng-if="cell.representation === \'text\' || cell.representation === \'url\' && selections.active" ng-bind="cell.text"></span>\n\t</div>\n</div>\n'}),define("extensions.qliktech/straight-table/layout/data-cell/straight-table-data-cell",["qvangular","text!./straight-table-data-cell.ng.html"],function(a,b){"use strict";a.directive("qvStraightTableDataCell",[function(){return{restrict:"E",replace:!0,template:b,link:function(){}}}])}),define("text!extensions.qliktech/straight-table/layout/bottom/straight-table-bottom-header.ng.html",[],function(){return'<div class="qv-st-bottom-header" tid="qv-st-bottom-header" ng-style="tableStyles.header">\n\t<table dir="{{direction}}">\n\t\t<colgroup class="qv-st-columns">\n\t\t\t<col ng-repeat="header in grid.headerRows[0].cells"\n\t\t\t\t ng-style="header.style"\n\t\t\t\t ng-class="header.classList" />\n\t\t</colgroup>\n\t\t<tbody>\n\t\t\t<tr ng-repeat="row in grid.footerRows">\n\t\t\t\t<th ng-repeat="header in row.cells"\n\t\t\t\t\ttid="{{header.tid}}"\n\t\t\t\t\tclass="qv-st-header-cell"\n\t\t\t\t\tng-class="{ \'qv-st-header-cell-numeric\': header.isNumeric,\n\t\t\t\t\t\t\'qv-st-total-cell\': header.isTotal,\n\t\t\t\t\t\t\'qv-st-header-cell-hidden\': header.shouldBeRemoved,\n\t\t\t\t\t\t\'qv-st-header-cell-dimension\': header.isDimension,\n\t\t\t\t\t\t\'qv-st-header-cell-measure\': header.isMeasure,\n\t\t\t\t\t\t\'qv-st-header-cell-search\': header.isSearchIcon }"\n\t\t\t\t\tcolspan="{{header.colspan}}">\n\t\t\t\t\t<qv-straight-table-header-cell></qv-straight-table-header-cell>\n\t\t\t\t</th>\n\t\t\t</tr>\n\t\t</tbody>\n\t</table>\n</div>\n'}),define("extensions.qliktech/straight-table/layout/bottom/straight-table-bottom-header",["qvangular","text!./straight-table-bottom-header.ng.html"],function(a,b){"use strict";a.directive("qvStraightTableBottomHeader",function(){return{restrict:"E",replace:!0,template:b,link:function(){}}})}),define("text!client.property-panel/popovers/type-popover.ng.html",[],function(){return'<lui-popover style="min-width: 100px;width: 150px;" align-to="alignTo" position="\'bottom\'" on-close-view="closeTypeFoldout(event)" qva-outside-ignore-for="{{qvaOutsideIgnoreFor}}" class="pp-type-popover" tid="pp-type-popover">\n\t<ul class="qui-icontextlist">\n\t\t<li ng-repeat="item in items" tid="{{item.tid}}" ng-class="{ \'lui-disabled\': item.disabled() }" qva-activate="itemClicked($event,item);">\n\t\t\t<span class="qui-textlist-text" q-translation="{{item.translation}}"></span>\n\t\t</li>\n\t</ul>\n</lui-popover>\n'}),define("client.property-panel/popovers/type-popover",["text!./type-popover.ng.html"],function(a){return{template:a,controller:["$scope",function(a){a.itemClicked=function(a,b){a.preventDefault(),b.disabled()||b.select()}}],scope:{items:"=",alignTo:"=",closeTypeFoldout:"=",qvaOutsideIgnoreFor:"="}}}),define("general.sortable/sortable-list-constants",[],function(){var a={};return Object.defineProperties(a,{ENTER_BEFORE:{value:0},ENTER_AFTER:{value:1},ENTER_SWAP:{value:2},TYPEFLAG_PLACEHOLDER:{value:16},TYPEFLAG_LOCKED:{value:32}}),a}),define("general.sortable/sortable-list-service",["jquery","qvangular","general.sortable/sortable-list-constants"],function(a,b,c){"use strict";b.service("qvSortableListDragService",[function(){var b;return b={$new:function(a){return{fromItem:void 0,enterItem:void 0,enterList:void 0,toItem:void 0,toList:void 0,offsetX:0,offsetY:0,left:0,top:0,direction:void 0,clientRect:void 0,scroll:{},pageX:0,pageY:0,zIndex:a.zIndex,enterItemAction:void 0}},startOffset:function(a,b,c,d){var e=c.offsetParent(),f=c.position();b.left=f.left+e[0].scrollLeft,b.top=f.top+e[0].scrollTop,b.offsetX=b.left-d.x-e[0].scrollLeft,b.offsetY=b.top-d.y-e[0].scrollTop},startData:function(a,b,c,d){b.scroll.clientRect=a[0].getBoundingClientRect(),b.scroll.width=a[0].scrollWidth,b.scroll.height=a[0].scrollHeight,b.clientRect=c[0].getBoundingClientRect(),b.minLeft=-b.clientRect.width,b.maxLeft=b.scroll.width,b.minTop=-b.clientRect.height,b.maxTop=b.scroll.height-b.clientRect.height,b.fromItem=c.scope()[d],b.toItem=void 0,b.toList=void 0,b.enterItem=void 0,b.enterList=void 0,b.enterItemAction=void 0},updateDragCoordinates:function(a,b,c,d){d=d||a.scroll.clientRect,a.pageX=b,a.pageY=c,a.pageX<=d.left?a.pageX=d.left+1:a.pageX>=d.left+d.width&&(a.pageX=d.left+d.width-1),a.pageY<=d.top?a.pageY=d.top+1:a.pageY>=d.top+d.height&&(a.pageY=d.top+d.height-1)},updateEnterItemAction:function(a,b){var d,e,f,g=b[0].getBoundingClientRect();switch(a.direction){case"horizontal":d=a.pageX,e=g.left,f=g.width;break;case"vertical":d=a.pageY,e=g.top,f=g.height;break;default:return}d<=e+.5*f?a.enterItemAction=c.ENTER_BEFORE:d>e+.5*f&&(a.enterItemAction=c.ENTER_AFTER)},updateData:function(c,d,e,f,g,h,i,j,k){function l(a){return a.length&&b.isChild(c[0],a[0])}function m(a){return"function"==typeof g?g(a):a.scope()[g]}var n,o,p,q,r=d.enterItemAction,s=function(){},t=e[0].style.display;e[0].style.display="none",o=document.elementFromPoint(d.pageX,d.pageY),n=a(o).closest(h),l(n)?s=function(a){p=a.scope()[i],b.updateEnterItemAction(d,a),(d.enterItem!==p||d.enterItem===p&&r!==d.enterItemAction)&&(d.enterList=void 0,d.enterItem=p,j())}:(n=a(o).closest(f),l(n)?s=function(a){q=m(a),d.enterList!==q&&(d.enterList=q,d.enterItem=void 0,k())}:(d.enterItem=void 0,d.enterList=void 0)),e[0].style.display=t,s(n)},start:function(a,b,c){c[0].style||(c[0].style=""),c[0].style.position="absolute",c[0].style.width=b.clientRect.width+"px",c[0].style.height=b.clientRect.height+"px",c[0].style.pointerEvents="none",c[0].style.left=b.left+"px",c[0].style.top=b.top+"px",c[0].style.zIndex=b.zIndex},update:function(a,b,c,d){var e,f;switch(b.direction){case"horizontal":b.left=d.currentPoint.x+b.offsetX+a[0].scrollLeft;break;case"vertical":b.top=d.currentPoint.y+b.offsetY+a[0].scrollTop;break;default:b.left=d.currentPoint.x+b.offsetX+a[0].scrollLeft,b.top=d.currentPoint.y+b.offsetY+a[0].scrollTop}e=b.left,f=b.top,b.left<b.minLeft?e=b.minLeft:b.left>b.maxLeft&&(e=b.maxLeft),b.top<b.minTop?f=b.minTop:b.top>b.maxTop&&(f=b.maxTop),c[0].style.left=e+"px",c[0].style.top=f+"px"},end:function(a,b){a.stopAutoScrolling&&(a.stopAutoScrolling(),a.stopAutoScrolling=null),b&&b.length&&b[0].removeAttribute("style")},isParent:function(a,b){return a===b},isChild:function(a,c){var d=c;if(b.isParent(a,c))return!1;for(;d;){if(d===a)return!0;d=d.parentNode}return!1},autoScroll:function(a,b,c,d,e,f,g,h){function i(e,g){if(k=a.scrollLeft,l=a.scrollTop,j){if(e<0&&0===k)return void(j=!1);if(e>0&&k+parseInt(b.height+.5,10)>=c)return void(j=!1);if(g<0&&0===l)return void(j=!1);if(g>0&&l+parseInt(b.height+.5,10)>=d)return void(j=!1);0!==e&&(a.scrollLeft+=e),0!==g&&(a.scrollTop+=g),f(),setTimeout(function(){i(e,g)})}}var j=!0,k=0,l=0,m=0,n=0;switch(e.direction){case"horizontal":e.pageX<=b.left+h?m=-g:e.pageX>=b.left+b.width-h&&(m=g);break;case"vertical":e.pageY<=b.top+h?n=-g:e.pageY>=b.top+b.height-h&&(n=g);break;default:e.pageY<=b.top+h?n=-g:e.pageY>=b.top+b.height-h&&(n=g)}return 0===m&&0===n||i(m,n),e.stopAutoScrolling&&(e.stopAutoScrolling(),delete e.stopAutoScrolling),e.stopAutoScrolling=function(){j=!1},e.stopAutoScrolling}}}])}),define("general.sortable/sortable-list",["core.utils/class","util","jquery","qvangular","touche","general.utils/dom-util","general.sortable/sortable-list-service"],function(a,b,c,d,e,f){"use strict";var g=a.extend("DefaultSortableList",{init:function(a,c){this.options=b.extend(!0,{gesture:{name:"swipe",options:{radiusThreshold:2,preventDefault:!1}},direction:"",scrollSelector:"",listSelector:"",listKey:"",itemSelector:"[ng-repeat]",itemDragSelector:"[ng-repeat]",itemKey:"$index",zIndex:1},a||{}),this.ctrl=c},onBegin:function(){},onEnter:function(){},onEnterList:function(){},onMove:function(){},onMoveToList:function(){},onCancel:function(){},onEnd:function(){},allowDrag:function(a){return e.utils.isMouse(a)?!!c(a.target).closest(this.options.itemSelector).length:!!c(a.target).closest(this.options.itemDragSelector).length},allowScroll:function(a){return!this.allowDrag(a)},allowEnter:function(){return!0},allowEnterList:function(){return!0},allowAutoScroll:function(){return!0},onAutoScroll:function(a){a()},getGesture:function(){return this.options.gesture},getDirection:function(){return this.options.direction},getScrollSensitivity:function(a){return e.utils.isMouse(a)?15:25},getScrollSpeed:function(a){return e.utils.isMouse(a)?15:25}});return d.directive("qvSortableList",["$parse","qvSortableListDragService",function(a,b){return{restrict:"A",controller:function(){},link:function(a,d,h,i){var j=a.$watch(h.qvSortableList,function(h){function k(){return n=void 0,e(d[0])[q.name](v).tap(u),e(m[0]).tap({id:"sortable-list-tap-"+a.$id,options:{preventDefault:!1},start:function(a){h.allowScroll(a)||f.isInput(a.target)||a.preventDefault()}}),function(){e(m[0]).off("*","sortable-list-tap-"+a.$id),e(d[0]).off("*",t)}}if(j(),h instanceof g)h.ctrl=i;else{var l=g.extend(h||{});h=new l(h&&h.options,i)}var m=d.closest(h.options.scrollSelector);m.length||(m=d);var n,o,p,q,r,s=b.$new(h.options),t="sortable-list-"+a.$id,u={id:t,options:{preventDefault:!1},start:function(a,d){if(n=void 0,!f.isInput(a.target)&&b.isChild(m[0],a.target)&&h.allowDrag(a)){if(n=c(a.target).closest(h.options.itemSelector),0===n.length)return void(n=void 0);s.direction=h.getDirection(),o=h.getScrollSpeed(a),p=h.getScrollSensitivity(a),b.startOffset(m,s,n,d.pagePoints[0]),b.startData(m,s,n,h.options.itemKey)}},end:function(){n=void 0}},v={id:t,start:function(c){if(!n)return void this.cancel();c.preventDefault(),h.onBegin(s.fromItem,s.clientRect),a.$digest(),b.start(m,s,n)},update:function(c,d){function e(){h.allowEnter(s.enterItem,s.fromItem)&&(s.toItem=s.enterItem,s.toList=void 0,h.onEnter(s.enterItem,s.enterItemAction),a.$digest())}function f(){h.allowEnterList(s.enterList,s.fromItem)&&(s.toItem=void 0,s.toList=s.enterList,h.onEnterList(s.enterList),a.$digest())}function g(){b.update(m,s,n,d.swipe),b.updateDragCoordinates(s,d.pagePoints[0].x,d.pagePoints[0].y,h.options.boundingRect),b.updateData(m,s,n,h.options.listSelector,h.options.listKey,h.options.itemSelector,h.options.itemKey,e,f)}if(!n)return void this.cancel();if(g(),h.allowAutoScroll()){var i=b.autoScroll.bind(this,m[0],s.scroll.clientRect,s.scroll.width,s.scroll.height,s,g,o,p);h.onAutoScroll(i,s.enterList,s.enterItem,function(a,c,d,e){b.autoScroll(a,c,d,e,s,g,o,p)})}},end:function(){b.end(s,n),void 0!==s.toItem?(h.onMove(s.fromItem,s.toItem),a.$digest()):void 0!==s.toList?(h.onMoveToList(s.fromItem,s.toList),a.$digest()):(h.onCancel(),a.$digest()),h.onEnd(),n=void 0},cancel:function(){n&&(b.end(s,n),h.onCancel(),n=void 0,"$digest"!==a.$root.$$phase&&a.$digest())}};q=h.options.gesture,v.options=q.options,a.$on("$destroy",function(){e(m[0]).off("*","sortable-list-tap-"+a.$id),e(d[0]).off("*",t)}),i.on=function(){r||(r=k())},i.off=function(){r&&(r(),r=void 0)},i.cancel=function(){v.cancel()},i.on()})}}}]),g}),define("general.sortable/sortable-item-lists",["core.utils/class","util","general.sortable/sortable-list","general.sortable/sortable-list-constants"],function(a,b,c,d){"use strict";var e=a.extend("SortableItemList",{init:function(a,b){this.items=[],this.disabled=!1,this.typeFlag=a||1,this.locked=!1,Object.keys(b||{}).forEach(function(a){this[a]=b[a]},this)},addSortableItem:function(a,b){Object.defineProperty(a,"__sortableItem__",{configurable:!1,enumerable:!0,writable:!0,value:{typeFlag:b||1}}),this.items.push(a)},moveItem:function(a,b){this.items.splice(b,0,this.items.splice(a,1)[0])},getIndexByItem:function(a){return this.items.indexOf(a)},get:function(a){return this.items.filter(a||function(){return!0})},getLockedIndices:function(){return this.get(function(a){return!!(a.__sortableItem__.typeFlag&d.TYPEFLAG_LOCKED)}).map(function(a){return this.getIndexByItem(a)},this)},reset:function(){this.items.length=0,this.disabled=!1},isEmpty:function(){return 0===this.items.length},setLocked:function(a){this.locked=a}});Object.defineProperties(e.prototype,{length:{get:function(){return this.items.length}}});var f=c.extend("SortableItemLists",{init:function(){this._super.apply(this,arguments),this.lists=[],this.dragPlaceholder=null},addPlaceholder:function(a){var c=this.getList(a),e=c.items.indexOf(a);return this.dragPlaceholder=b.extend(!0,{},a),this.dragPlaceholder.id="placeholder",this.dragPlaceholder.__sortableItem__.typeFlag=d.TYPEFLAG_PLACEHOLDER,this.dragPlaceholder.style={opacity:"0.3"},c.items.splice(e,0,this.dragPlaceholder),this.dragPlaceholder},removePlaceholder:function(){if(this.dragPlaceholder){var a=this.getList(this.dragPlaceholder),b=a?a.items.indexOf(this.dragPlaceholder):-1;b!==-1&&(a.items.splice(b,1),this.dragPlaceholder=null)}},getPlaceholder:function(){return this.dragPlaceholder},createList:function(a,b){var c=new e(a,b);return this.lists.push(c),c},reset:function(){this.lists.forEach(function(a){a.reset()})},getList:function(a){return this.lists.filter(function(b){return b.items.indexOf(a)!==-1})[0]},disable:function(a){this.lists.forEach(function(b){b.disabled=!(a.__sortableItem__.typeFlag&b.typeFlag)})},enable:function(){this.lists.forEach(function(a){a.disabled=!1})},getIndexOfItem:function(a){return this.getList(a).items.indexOf(a)},moveItem:function(a,b){var c,d,e=this.getList(a),f=this.getList(b);e&&f&&(d=f.items.indexOf(b),c=e.items.indexOf(a),e.items.splice(c,1),f.items.splice(d,0,a))},onBegin:function(a,b){this.addPlaceholder(a,b),this.disable(a)},onEnter:function(a,b){var c=this.getList(a),e=c.getLockedIndices();if(a!==this.dragPlaceholder){if(b===d.ENTER_BEFORE||b===d.ENTER_AFTER){var f,g,h=this.getList(this.dragPlaceholder);if(!h||!c)return;f=h.getIndexByItem(this.dragPlaceholder),h.items.splice(f,1),g=c.getIndexByItem(a),g+=b===d.ENTER_AFTER?1:0,c.items.splice(g,0,this.dragPlaceholder)}else this.moveItem(this.dragPlaceholder,a);var i=c.getLockedIndices();e.forEach(function(a,b){c.moveItem(i[b],a)})}},onEnterList:function(a){if(!a.disabled&&!a.locked){var b=this.getList(this.dragPlaceholder),c=b.getIndexByItem(this.dragPlaceholder);b.items.splice(c,1),a.items.push(this.dragPlaceholder)}},onMove:function(a){var b=this.dragPlaceholder;this.moveItem(a,b),this.removePlaceholder(),this.enable()},onMoveToList:function(a,b){if(!b.disabled&&!b.locked){var c=this.getList(a),d=c.items.indexOf(a);if(c===b)return void this.onMove(a,this.dragPlaceholder);c.items.splice(d,1),b.items.push(a)}this.removePlaceholder(),this.enable()},onCancel:function(){this.removePlaceholder(),this.enable()},allowEnter:function(a,b){var c=this.getList(a);return void 0!==c&&!c.disabled&&!c.locked&&!!(b.__sortableItem__.typeFlag&c.typeFlag)},allowEnterList:function(a,b){return!a.disabled&&!a.locked&&!!(b.__sortableItem__.typeFlag&a.typeFlag)}});return f.create=function(a){return a=new(f.extend(a||{}))(a&&a.options)},f}),define("extensions.qliktech/straight-table/properties/columns/columns-sorting-util",["general.utils/array-util"],function(a){function b(a){function b(){for(var a=[],b=0;b<d.length+e.length;b++)a.push(b);return a}var d=a.qDimensions,e=a.qMeasures;c(d,e,a.columnOrder)&&(a.columnOrder=b()),c(d,e,a.qInterColumnSortOrder)&&(a.qInterColumnSortOrder=b())}function c(a,b,c){var d={},e=[],f=!1;c.forEach(function(a){d[a]?f=!0:d[a]=!0}),f=f||a.length+b.length!==Object.keys(d).length,Object.keys(d).forEach(function(a){e.push(parseInt(a,10))}),e=e.sort(function(a,b){return a-b});for(var g=0;g<e.length;++g)f=f||e[g]!==g;return f}function d(c){b(c);for(var d,e=c.qDimensions,f=c.qMeasures,g=c.columnOrder,h=c.qInterColumnSortOrder,i=[],j=[],k=0;k<g.length;k++)d=g[k],d<e.length?i.push(d):j.push(d);!function(){for(var b=0;b<i.length;b++)if(i[b]!==b){var c=i[b],d=i.indexOf(b),f=i[d];a.swap(i,b,d),a.swap(e,c,f),a.swap(g,g.indexOf(c),g.indexOf(f)),a.swap(h,h.indexOf(c),h.indexOf(f))}}(),function(){for(var b=0;b<j.length;b++)if(j[b]!==b+e.length){var c=j[b],d=j.indexOf(b+e.length),i=j[d];a.swap(j,b,d),a.swap(f,c-e.length,i-e.length),a.swap(g,g.indexOf(c),g.indexOf(i)),a.swap(h,h.indexOf(c),h.indexOf(i))}}()}function e(b,c,d){var e;if(c<d)for(e=c;e<d;e++)a.swap(b.columnWidths,e,e+1);else for(e=c;e>d;e--)a.swap(b.columnWidths,e,e-1)}return{validateTableHyperCube:b,fixTableHypercubeOrders:d,isInvalidOrderArray:c,updateColumnInfoOrders:e}}),define("text!client.property-panel/components/common/data.ng.html",[],function(){return'<div class="pp-component pp-list-component pp-toplist" tcl="data">\n\t<button class="lui-button  lui-button--block  pp-toplist-add-button" ng-class="{\'lui-active\': adding === true}" qva-activate="addClicked($event)" qv-enter="addClicked($event)" qva-outside-ignore-for="{{\'addButton-\' + $id}}"\n\t\t\tng-disabled="addDisabled()" tid="add-data">\n\t\t<span class="lui-button__text">{{getAddLabel()}}</span>\n\t\t<i class="toggle-expand  lui-button__caret  lui-caret" ng-if="hasMultipleAddOptions()"></i>\n\t</button>\n\n\t<div class="pp-toplist-content pp-data-container" qv-sortable-list="sortableItemLists">\n\t\t<div class="pp-data" ng-repeat="list in sortableItemLists.lists" tid="{{list.tid}}" ng-class="{ \'disabled\': list.disabled }" ng-if="list.show() != false">\n\t\t\t<div class="pp-data-header ">\n\t\t\t\t<span class="pp-data-header-text">{{list.title}}</span>\n\t\t\t</div>\n\n\t\t\t<ul class="pp-expandable-list pp-data-list">\n\t\t\t\t<li ng-repeat="item in list.items track by item.id" ng-include src="item.templateSrc" ng-class="item.classList"></li>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n</div>\n'}),define("extensions.qliktech/straight-table/properties/columns/columns",["qvangular","touche","client.property-panel/components/components","general.utils/support","objects.error-handling/error-translation","translator","objects.add-popovers/add-dimension-popover","objects.add-popovers/add-measure-popover","client.property-panel/popovers/type-popover","client.utils/property-resolver","general.sortable/sortable-item-lists","extensions.qliktech/straight-table/properties/columns/columns-sorting-util","text!client.property-panel/components/common/data.ng.html","general.components/context-menu/context-menu-service"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){return{name:"columns",template:m,controller:["$scope","$element","$timeout","qvGridObjectDataService","luiPopover",function(m,n,o,p,q){function r(a){if(m.adding)return s(),void(m.adding=!1);var b=a.currentTarget;G=q.show({template:i.template,controller:i.controller,input:{items:[{tid:"dimension",select:function(){z("dimension",b)},disabled:function(){return m.args.handler.getDimensions().length>=m.args.handler.maxDimensions()},translation:"Common.Dimension"},{tid:"measure",select:function(){z("measure",b)},disabled:function(){return m.args.handler.getMeasures().length>=m.args.handler.maxMeasures()},translation:"Common.Measure"}],closeTypeFoldout:s},alignTo:b}),G.closing.then(function(a){a&&!a.target.classList.contains("lui-button__text")&&(m.adding=!1)}),G.closed.then(function(){G=null}),m.adding=!0}function s(a){G&&(G.close(),G=null),a&&a.target.classList.contains("pp-toplist-add-button")&&b.preventGestures(),m.addType=null}function t(){var a=j.getValue(m.data,m.definition.sortIndexRef);void 0===a?(a=p.columnOrder.get(m.args.handler.getDimensionLayouts(),m.args.handler.getMeasureLayouts()),j.setValue(m.data,m.definition.sortIndexRef,a),m.$emit("saveProperties")):a.length&&"number"!=typeof a[0]&&(j.setValue(m.data,m.definition.sortIndexRef,a.map(function(a){return a.dataColIx})),m.$emit("saveProperties"))}function u(){t();var a=j.getValue(m.data,m.definition.sortIndexRef),b=m.data.qHyperCubeDef.qDimensions.length;if(m.sortableItemLists.reset(),a.forEach(function(a,c){var d,f,g,h,i;a<b?(f=a,g=m.data.qHyperCubeDef.qDimensions[f],h="dimension",i=g.qDef.cId,d=m.definition.items.dimensions):(f=a-b,g=m.data.qHyperCubeDef.qMeasures[f],i=g.qDef.cId,h="measure",d=m.definition.items.measures);var j={title:function(){var a;if("dimension"===h){var b=m.args.handler.getDimensionLayout(i);a=b&&b.qError?e.getDimensionError(b.qError.qErrorCode):g.qLibraryId?b&&b.title||"":b&&b.qFallbackTitle||""}else{var c=m.args.handler.getMeasureLayout(g.qDef.cId);a=c&&c.qError?e.getMeasureError(c.qError.qErrorCode):c&&c.qFallbackTitle||""}return a},isInvalid:function(){if("dimension"===h){var a=m.args.handler.getDimensionLayout(i);return a&&!!a.qError}var b=m.args.handler.getMeasureLayout(i);return b&&!!b.qError},component:F,definition:{type:"items",items:d.items},data:g,args:m.args,id:i,expanded:D.get(E+i)||!1,index:c,type:h,sourceIndex:f,dataColIx:a,templateSrc:"pp-data-item.ng.html",markerClass:"dimension"===h?"pp-dimension":"pp-measure",sortable:m.definition.allowMove!==!1};J.addSortableItem(j)}),J.isEmpty()){var c={id:"empty-item",templateSrc:"pp-empty-data-item.ng.html",index:-1};J.addSortableItem(c)}}function v(a){m.args.handler.addFieldDimension(a.value,"").then(function(a){D.put(E+a.qDef.cId,!0),m.$emit("saveProperties",m.data),A(),B()})}function w(a){m.args.handler.addLibraryDimension(a.libraryId).then(function(a){D.put(E+a.qDef.cId,!0),m.$emit("saveProperties",m.data),A(),B()})}function x(a){m.args.handler.addLibraryMeasure(a.libraryId).then(function(a){D.put(E+a.qDef.cId,!0),m.$emit("saveProperties",m.data),A(),B()})}function y(a){m.args.handler.addExpressionMeasure(a.value,"").then(function(a){D.put(E+a.qDef.cId,!0),m.$emit("saveProperties",m.data),A(),B()})}function z(a,b){m.addType=a,s(),C();var c,d={app:m.args.app,closeAddPopover:A};"dimension"===a?(c=g,d.addFieldDimension=v,d.addLibraryDimension=w):(c=h,d.addLibraryMeasure=x,d.addExpressionMeasure=y),H=q.show({template:c.template,controller:c.controller,input:d,alignTo:b,dock:"bottom"})}function A(a){H&&(H.close(),H=null),a&&a.target.classList.contains("pp-toplist-add-button")&&b.preventGestures(),m.adding=!1}function B(){o(function(){var a=n.find(".pp-toplist-content"),b=a.find(".pp-data-list").children().last();a[0].scrollTop=b[0].offsetTop-1},100)}function C(){J.items.forEach(function(a){a.expanded=!1,D.put(E+a.id,!1)})}var D=m.args.cache,E="columns_",F=c.getComponent("items");m.expandClicked=function(a,b){b.disabled||a.target.classList.contains("pp-move-item")||(b.expanded=!b.expanded,D.put(E+b.id,b.expanded))};var G=null,H=null,I=null;m.addClicked=function(a){r(a)},m.hasMultipleAddOptions=function(){return!0},m.getAddLabel=function(){return f.get("properties.columns.add")},m.removeItem=function(a){"dimension"===a.type?m.args.handler.removeDimension(a.sourceIndex).then(function(){m.$emit("saveProperties")}):m.args.handler.removeMeasure(a.sourceIndex).then(function(){m.$emit("saveProperties")})},m.openContextMenu=function(b,c){var d=a.getService("qvContextMenu").menu();d.addItem({translation:"Common.Delete",tid:"delete",select:function(){m.removeItem(c)}}),I=a.getService("qvContextMenu").show(d,{position:{x:b.pageX,y:b.pageY},docking:"Top"})},
m.$on("pp-open-path",function(a,b){var c=b.split("."),d=c[0],e=c[1];"columns"===d&&e&&(D.put(E+e,!0),B())}),m.add=function(a){a&&a.trim().length&&("measure"===m.addType?y({value:a,label:a}):"dimension"===m.addType&&v({value:a,label:a}))},m.sortableItemLists=k.create({options:{direction:"vertical",listKey:"list",listSelector:".pp-expandable-list",itemKey:"item",itemSelector:".qv-pp-sortable",itemDragSelector:".qv-pp-sortable-handle",gesture:{name:"swipe",options:{radiusThreshold:d.treatAsDesktop()?4:0,preventDefault:!1}}},addPlaceholder:function(){this._super.apply(this,arguments).classList=["qv-pp-sortable"]},onBegin:function(){this._super.apply(this,arguments),C()},onMove:function(){var a,b=this.getIndexOfItem(arguments[0]);this._super.apply(this,arguments),a=this.getIndexOfItem(arguments[0]),a<b&&b--,m.data.qHyperCubeDef.columnOrder=J.get().filter(function(a){return"empty-item"!==a.id}).map(function(a){return a.dataColIx}),l.fixTableHypercubeOrders(m.data.qHyperCubeDef),l.updateColumnInfoOrders(m.data.qHyperCubeDef,b,a),m.$emit("saveProperties")}});var J=m.sortableItemLists.createList(1,{title:f.get("Common.Columns"),tid:"columns"});m.$watchCollection("data.qHyperCubeDef.columnOrder",u),m.$watchCollection("data.qHyperCubeDef.qDimensions",u),m.$watchCollection("data.qHyperCubeDef.qMeasures",u),m.$on("$destroy",function(){s(),A(),I&&I.close()})}]}}),define("text!extensions.qliktech/straight-table/column-picker/column-picker.ng.html",[],function(){return'<div class="qv-st-column-picker"\n\t tid="qv-st-column-picker"\n\t qva-activate="interactive && !selections.active && toggleColumnPickerPopover();"\n\t qva-outside-ignore-for="{{columnPicker.qvaOutsideIgnoreFor}}"\n\t ng-class="{ \'qv-st-column-picker-open\': columnPicker.showPopover }">\n\t<table>\n\t\t<tr>\n\t\t\t<td q-title-translation="{{columnPicker.showPopover ? \'Tooltip.CloseColumnPicker\' : \'Tooltip.ColumnPicker\'}}">\n\t\t\t\t<div class="qv-st-column-picker-more"></div>\n\t\t\t</td>\n\t\t</tr>\n\t</table>\n</div>\n'}),define("text!extensions.qliktech/straight-table/column-picker/column-picker-popover.ng.html",[],function(){return'<immidiate-contextual class="qv-st-column-picker-popover"\n\t\t\t\t\t  align-to="$alignColumnPickerTo"\n\t\t\t\t\t  position="\'left\'"\n\t\t\t\t\t  collision="\'flip fit\'"\n\t\t\t\t\t  width="180"\n\t\t\t\t\t  height="\'auto\'"\n\t\t\t\t\t  qva-outside-ignore-for="{{qvaOutsideIgnoreFor}}"\n\t\t\t\t\t  on-close-view=" toggleColumnPickerPopover();"\n\t\t\t\t\t  qva-direction x-dir-setting="{{options.direction}}">\n\t<div class="qv-st-cp-header-wrapper"><p class="qv-st-cp-header" q-translation="Common.Columns"></p></div>\n\t<ul class="qv-st-cp-popover-list"\n\t\tqv-sortable-list="sortableItemLists">\n\t\t<li class="qv-st-cp-popover-list-item"\n\t\t\tdraggable="false"\n\t\t\tng-repeat="col in columnPicker.columns.items track by col.id"\n\t\t\tng-class="col.classList"\n\t\t\tng-style="col.style">\n\t\t\t<table class="qv-st-cp-popover-table" ng-if="col.id !== -2">\n\t\t\t\t<tr>\n\t\t\t\t\t<td ng-class="{ \'disabled\': col.disabled }">\n\t\t\t\t\t\t<div class="qv-st-cp-overflow" ng-bind="col.title" qva-direction x-dir-setting="{{options.direction}}" x-dir-text="{{col.title}}"></div>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td ng-if="col.id !== -2" class="qv-st-cp-handle">\n\t\t\t\t\t\t<div class="icon-handle"></div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</li>\n\t</ul>\n</immidiate-contextual>\n'}),define("extensions.qliktech/straight-table/column-picker/column-picker",["jquery","qvangular","text!./column-picker.ng.html","text!./column-picker-popover.ng.html","core.utils/resize","general.sortable/sortable-item-lists","general.sortable/sortable-list"],function(a,b,c,d,e,f){"use strict";return b.service("qvStraighTableColumnPickerService",["$document",function(b){var c,e=b.find("body");return{show:function(f){return c=b.find(".qv-st-column-picker-popover"),c.length||(c=a("<div>")),c.showComponent({controller:function(){},template:d},f),c.appendTo(e),function(){c.remove()}}}}]),b.directive("qvStraightTableColumnPicker",function(){return{restrict:"A",require:"qvSortableList",link:function(a,b,c,d){a.columnPicker.cancel=function(){d.cancel()}}}}),b.directive("qvStraightTableColumnPickerActivator",["qvStraighTableColumnPickerService",function(a){return{restrict:"E",replace:!0,template:c,require:"^qvObjectContent",link:function(b,c,d,g){function h(){b.columnPicker.columns.get().forEach(function(a,c){b.scrollApi.settings.columnCount<c?a.disabled=!0:a.disabled=!1})}function i(){var a,c,d=b.layout.qHyperCube.qDimensionInfo,e=b.layout.qHyperCube.qMeasureInfo,f=d.length,g={};b.columnPicker.cancel(),b.columnPicker.columns.reset(),b.layout.qHyperCube.columnOrder.forEach(function(a){var c={id:a,classList:["qv-st-cp-sortable"]};c.title=a<f?d[a].qFallbackTitle:e[a-f].qFallbackTitle,b.columnPicker.columns.addSortableItem(c)}),g.title="",g.id=-2,g.classList=["qv-st-cp-divider"],g.isDivider=!0,b.columnPicker.columns.addSortableItem(g,32),a=b.columnPicker.columns.getIndexByItem(g),c=b.scrollApi.settings.columnCount,b.columnPicker.columns.moveItem(a,c),h()}function j(){e.off("start."+b.$id,j),b.columnPicker.showPopover&&(k(),b.columnPicker.showPopover=!1,b.$digest())}var k;b.sortableItemLists=f.create({options:{direction:"vertical",itemKey:"col",itemSelector:".qv-st-cp-sortable",itemDragSelector:".qv-st-cp-handle"},addPlaceholder:function(a,b){var c=this._super.apply(this,arguments);c.style.height=b.height,c.id=-1},onMove:function(){this._super.apply(this,arguments),h(),b.applyColumnOrderSoftPatch(!1,b.columnPicker.columns.get(function(a){return a.id>=0}).map(function(a){return a.id}))}}),b.columnPicker={showPopover:!1,columns:b.sortableItemLists.createList(),qvaOutsideIgnoreFor:"qv-st-column-picker-"+b.$id,cancel:function(){}},g.watchPaint(i),b.toggleColumnPickerPopover=function(){b.$alignColumnPickerTo=c,b.columnPicker.showPopover=!b.columnPicker.showPopover,b.columnPicker.showPopover?(i(),k=a.show({$alignColumnPickerTo:b.$alignColumnPickerTo,columnPicker:b.columnPicker,onMoveBegin:b.onMoveBegin,onMoveEnter:b.onMoveEnter,onMoveCancel:b.onMoveCancel,onMove:b.onMove,toggleColumnPickerPopover:b.toggleColumnPickerPopover,qvaOutsideIgnoreFor:b.columnPicker.qvaOutsideIgnoreFor,sortableItemLists:b.sortableItemLists,hc:b.layout.qHyperCube,options:b.options}),e.on("start."+b.$id,j)):k&&k()}}}}])}),define("text!objects.grid/column-width-adjuster/column-adjuster.ng.html",[],function(){return'<div class="column-width-adjuster">\n\t<qv-column-width-adjust-column ng-repeat="column in columns" column="column" explicit-column-width="explicitColumnWidths[$index]" x-rtl="rtl" min-col-width="minColWidth"></qv-column-width-adjust-column>\n</div>\n'}),define("text!objects.grid/column-width-adjuster/column-adjuster-column.ng.html",[],function(){return'<div class="column-width-adjust-column" ng-style="columnStyle" >\n\t<div class="column-width-adjust-line" ng-class="{active : isActive}"></div>\n</div>\n'}),define("objects.grid/column-width-adjuster/column-adjuster",["qvangular","text!./column-adjuster.ng.html","text!./column-adjuster-column.ng.html","touche"],function(a,b,c,d){"use strict";a.directive("qvTableColumnWidthAdjuster",function(){return{restrict:"E",replace:!0,template:b,scope:{columns:"=",explicitColumnWidths:"=",rtl:"=",minColWidth:"="}}}),a.directive("qvColumnWidthAdjustColumn",function(){return{restrict:"E",scope:{column:"=",explicitColumnWidth:"=",rtl:"=",minColWidth:"="},template:c,replace:!0,link:function(a,b){var c,e=a.minColWidth||40;a.columnStyle={},a.$watch("column.left",function(){a.columnStyle.left=a.column.left+"px"}),a.$watch("column.hidden",function(){a.columnStyle.display=a.column.hidden?"none":"block"}),a.$watch("column.height",function(){a.columnStyle.height=a.column.height+"px"}),a.$watch("column.top",function(){a.columnStyle.top=a.column.top+"px"}),a.$on("$destroy",function(){d(b[0]).off("*","columnAdjuster")}),d(b[0]).swipe({id:"columnAdjuster",options:{radiusThreshold:5,preventDefault:!1},start:function(){(a.explicitColumnWidth===-1||isNaN(a.explicitColumnWidth))&&(a.explicitColumnWidth=a.column.width),c=a.explicitColumnWidth,a.$emit("onExplicitColumnStarted")},update:function(b,d){var f=(a.rtl?-1:1)*d.swipe.deltaX,g=Math.max(c+f,e);a.isActive||(a.isActive=!0),a.explicitColumnWidth=g,a.$apply(),a.$emit("onExplicitColumnChanging")},end:function(){a.isActive=!1,a.$emit("onExplicitColumnChanged")}}).doubletap({id:"columnAdjuster",end:function(){a.isActive=!1,a.explicitColumnWidth=-1,a.$apply(),a.$emit("onExplicitColumnChanged")}})}}})}),define("extensions.qliktech/straight-table/straight-table",["jquery","qvangular","core.utils/deferred","objects.backend-api/hypercube-api","extensions.qliktech/straight-table/straight-table-properties","text!./straight-table.ng.html","objects.extension/base-controller","objects.extension/object-conversion","general.utils/array-util","extensions.qliktech/straight-table/snapshot/snapshot-helper","general.scroll/api/vertical-scroll-api","general.scroll/api/dom-api","general.scroll/api/data-api","objects.utils/event-utils","objects.grid/data-grid","general.utils/shapes/rect","client.utils/theme/theme-module","core.utils/feature-flags","objects.utils/selection-util","general.utils/responsive-state","client.utils/property-resolver","objects.grid/services/data-service","objects.grid/services/selections","objects.grid/services/column-highlight-service","extensions.qliktech/straight-table/layout/top/straight-table-top-header","extensions.qliktech/straight-table/layout/header-cell/straight-table-header-cell","extensions.qliktech/straight-table/layout/data/straight-table-data","extensions.qliktech/straight-table/layout/data-cell/straight-table-data-cell","extensions.qliktech/straight-table/layout/bottom/straight-table-bottom-header","extensions.qliktech/straight-table/properties/columns/columns","extensions.qliktech/straight-table/column-picker/column-picker","objects.grid/column-width-adjuster/column-adjuster","objects/listbox-popover/listbox-popover-service","objects/listbox-popover/listbox-popover-service-mobile"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){"use strict";function v(a,b){a.tableStyles={header:{"font-size":b.getStyle("header","fontSize"),color:b.getStyle("header","color")},content:{"font-size":b.getStyle("content","fontSize"),color:b.getStyle("content","color")}},a.scrollApi&&(a.scrollApi.settings.minRowHeight=w(a),a.scrollApi.settings.maxRowHeight=3*w(a))}function w(a){var b;if(r.THEMING){var c=parseInt(a.tableStyles.content["font-size"]);b=c?c/13*29-1.23076923:29}return b||29}function x(a,b,c,d){return a.showField(b,c.backendApi.model.app,{$alignToElement:d,qvaOutsideIgnoreFor:"qv-st-header-cell-search-"+c.$id,collision:"flipfit",direction:c.options.direction},null,function(){c.currentHeaderSearch&&(c.currentHeaderSearch.open=!1),c.currentHeaderSearch=null})}function y(a,b,c,d){a.getCellsInColumn(b,"data",c).forEach(function(a){a.hidden=d})}var z,A,B;return A=m.extend({init:function(a){this.visualizationCtrl=a},getRows:function(){return this.visualizationCtrl.getRows()},getRowCount:function(){return this.visualizationCtrl.getRowCount()},getFirstElementIndex:function(){return this.visualizationCtrl.getFirstElementIndex()},getLastElementIndex:function(){return this.visualizationCtrl.getLastElementIndex()},onVirtualScroll:function(a,b){return this.visualizationCtrl.onVirtualScroll(a,b)},onInitialNativeScroll:function(a,b){return this.visualizationCtrl.onInitialNativeScroll(a,b)},onGotoNextBlock:function(a,b){return this.visualizationCtrl.onGotoNextBlock(a,b)},onGotoPreviousBlock:function(a,b){return this.visualizationCtrl.onGotoPreviousBlock(a,b)}}),B=l.extend({init:function(a,b,c,d,e,f,g,h){this.snapshotObject=g,this.options=h,this._super.apply(this,arguments)},getBoundingBox:function(){return this.options.freeResize?this.$element[0].getBoundingClientRect():{height:this.snapshotObject.size.h,width:this.snapshotObject.size.w}}}),z=g.extend({init:function(a,b,c,d,e){this.appliedSoftPatch=!1,this._paintWatches=[],this._resizeWatches=[],this.$element=b,this.horizontalScrollElement=this.$element.closest(".qv-object-content-container")[0],this.dataService=d,this.selectionService=e,this.$timeout=c,this.metaHeaders=[],this._super.apply(this,arguments);var f=q.get();if(a.backendApi.setCacheOptions({width:1}),a.interactive=!1,a.isLoadPrevVisible=!1,a.direction=a.options.direction,a.rtl="rtl"===a.options.direction,r.THEMING){this.styleService=f.initializeService("object.straightTable");var g=this;v(this.$scope,this.styleService),f.ThemeChanged.bind(function(){v(g.$scope,g.styleService)})}a.$on("onExplicitColumnChanged",function(){a.applyColumnWidthSoftPatch(!1,a.explicitColumnWidths)}),a.$on("onExplicitColumnChanging",function(){var a=this.$scope;this.dataService.getStraightMetaHeaders(a.layout,a.explicitColumnWidths,a.scrollApi.settings,a.$id,this.metaHeaders,this.$scope.options.customHeader),this.updateColumnInfo(this.metaHeaders),this.metaHeaders.forEach(function(b,c){a.grid.headerRows[0].cells[c].style.width=b.style.width})}.bind(this))},setDirection:function(a){this._super(a),this.$scope.direction=this.$scope.options.direction,this.$scope.rtl="rtl"===this.$scope.options.direction,this.processResize()},watchPaint:function(a){var b=this;return b._paintWatches.push(a),function(){var c=b._paintWatches.indexOf(a);b._paintWatches.splice(c,1)}},watchResize:function(a){var b=this;return b._resizeWatches.push(a),function(){var c=b._resizeWatches.indexOf(a);b._resizeWatches.splice(c,1)}},update:function(a,b,d,e,f){f||(this.$scope.explicitColumnWidths=this.$scope.layout.qHyperCube.columnWidths.concat(),this.dataService.getStraightMetaHeaders(this.$scope.layout,this.$scope.explicitColumnWidths,this.$scope.scrollApi.settings,this.$scope.$id,this.metaHeaders,this.$scope.options.customHeader));var g=this.getDataInfo(a,b,this.metaHeaders),h=c();return this.$scope.backendApi.getData(g.rects).then(function(a){this.onUpdateData({dataPages:a,dataInfo:g},d,e,f).then(function(){h.resolve(a)})}.bind(this)),h.promise},updateLocked:function(a){var b,c,d,e,f,g,h,i=this.dataService,j=this.selectionService,k=this.$scope.selections,l=k.activationCell,m=[];if(l){for(b=a.getRowsByCellType(a.CELL_TYPE_DATA),f=i.getSiblingCells(a,l),c=b.length,h=0;h<c;++h)m=m.concat(b[h].cells);for(e=m.length,h=0;h<e;++h)d=m[h],g=f.indexOf(d)!==-1,g&&!d.isDimensionValue||!g&&!d.isMeta?j[l&&k.active?"lockCell":"unlockCell"](a,d):j[l&&k.active?"removeCellStyle":"restoreCellStyle"](d)}},getDataInfo:function(a,b,c){var d,e,f=c.length,g=[];for(d=0;d<f;++d)e=c[d],e.isSearchIcon||e.isFillColumn||g.push({qLeft:e.qLeft,qTop:a||0,qWidth:1,qHeight:b});return g.length||g.push({qTop:0,qLeft:0,qWidth:0,qHeight:0}),{rects:g,metaHeaders:c}},updateColumnInfo:function(a){var b=this.$scope,c=b.scrollApi.settings,d=0,e=c.width-(c.columnPicker.show?c.columnPicker.width:0);b.columns||(b.columns=[]);var f,g,h,i=0,j=0;for(h=0,g=a.length;h<g;h++)f=a[h],y(this.dataService,b.grid,f.dataColIx,f.shouldBeRemoved),f.isFillColumn||(f.isDimension?(this.$scope.options.customHeader?i+=h>0?f.calculatedWidth+1:f.calculatedWidth:i+=f.calculatedWidth+a[h+1].calculatedWidth,h++):i+=f.calculatedWidth,b.columns[j]||(b.columns[j]={}),b.columns[j].width=f.calculatedWidth,b.columns[j].left=b.rtl?e-i:i,b.columns[j].hidden=f.shouldBeRemoved,d+=f.calculatedWidth,j++);this.horizontalScrollElement&&(c.useHorizontalScroll&&d>e+5?this.horizontalScrollElement.style.overflow="auto":this.horizontalScrollElement.style.overflow="")},onUpdateData:function(a,b,c,d){return c&&a.dataPages.forEach(function(a){a.qMatrix.reverse()}),this.dataService.updateStraightItems(this.$scope,a.dataPages,a.dataInfo.metaHeaders,b,c,d),this.updateColumnInfo(a.dataInfo.metaHeaders),c&&this.$scope.grid.rows.reverse(),this.$scope.selections.active&&(this.selectionService.updateStraight(this.$scope.grid,this.$scope.selections,this.$scope.selections.activationCell),this.updateLocked(this.$scope.grid)),this.$timeout(function(){},0,!1)},setSnapshotData:function(a){var b,c,d=!!a.sourceObjectId,e=this.$scope,f=e.scrollApi.domApi,g=f.getScrollAreaBoundingBox(),h=f.$scrollArea.find(".qv-st-data-row"),i=e.scrollApi.settings.columnCount;return b=j.getIndexHeightAndWidth(h,i,g,a.totals&&a.totals.show),this.dataService.getStraightMetaHeaders(this.$scope.layout,this.$scope.explicitColumnWidths,this.$scope.scrollApi.settings,this.$scope.$id,this.metaHeaders,this.$scope.options.customHeader),c=this.getDataInfo(b.index,b.height,this.metaHeaders),c.rects.splice(b.width),e.backendApi.getData(c.rects).then(function(b){a.qHyperCube.qDataPages=b;var f=e.layout.qHyperCube.columnOrder.slice(0,c.rects.length);return d||(a.qHyperCube.columnOrder=f),a})},getViewState:function(){return{virtualScrollPosition:this.$scope.scrollApi.virtualScrollApi.getVirtualPosition()}},process:function(a,b,c){return this.update(a,b,!1,!1,!1).then(function(){this.$scope.scrollApi.setTotalRows(this.$scope.layout.qHyperCube.qSize.qcy),this.$scope.scrollApi.setVirtualSize(c)}.bind(this))},processPaint:function(){this.$scope.scrollApi.updateViewport();var a,b=this.$scope.scrollApi.settings.viewportRowCount;return a=this.$scope.scrollApi.resetNativeScroll(),this.process(0,b,!1).then(function(){a()})},processResize:function(){var a,b=this.$scope.grid.rows.length,c=b?this.$scope.grid.rows[0].getIndex():0,d=this.$scope.scrollApi.settings.viewportRowCount;return this.$scope.scrollApi.totalRows&&c+d>this.$scope.scrollApi.totalRows&&(a=Math.min(c,c+d-this.$scope.scrollApi.totalRows),c-=a),d<b&&(d=b),this.process(c,d,!0)},onVirtualScroll:function(a,b){return this.update(a,b,!1,!1,!0)},gotoBlock:function(a,b,c){var d=this.$scope.scrollApi.getSpliceArgs(),e=this.$scope.grid.rows,f=this.$scope.grid.getNextRowIx();return c&&e.reverse(),e.splice.apply(e,d),f-=d[1],this.$scope.grid.setNextRowIx(f),this.update(a,b,!0,c,!0)},onGotoNextBlock:function(a,b){return this.gotoBlock(a,b,!1)},onGotoPreviousBlock:function(a,b){return this.gotoBlock(a,b,!0)},getRows:function(){return this.$scope.grid.rows},getRowCount:function(){return this.$scope.grid.rows.length},getFirstElementIndex:function(){return this.$scope.grid.rows[0].getIndex()},getLastElementIndex:function(){return this.$scope.grid.rows[this.$scope.grid.rows.length-1].getIndex()},getPreferredSize:function(){var a=c(),b=function(){return this.$element.find(".qv-st-data")[0].offsetHeight}.bind(this),d=this.$scope.$watch(b,function(b){if(b&&b>0){var c=this.$element.find(".qv-st-header")[0].offsetHeight,e=this.$element.find(".qv-st-bottom-header")[0].offsetHeight;a.resolve({w:this.$element.width(),h:b+c+e}),d()}}.bind(this));return a.promise}}),z.$inject=["$scope","$element","$timeout","qvGridObjectDataService","qvGridObjectSelectionService"],b.directive("qvStraightTable",["$timeout","qvGridObjectDataService","qvGridObjectSelectionService","qvGridColumnHighlightService","qvListboxPopoverService","qvListboxPopoverServiceMobile","$window",function(b,d,e,g,h,j,m){return{restrict:"E",replace:!0,template:f,require:"qvObjectContent",link:function(f,q,r,u){function v(a,b){return u[a]().then(function(){b.forEach(function(a){a()})})}function y(a,b){var c,d,e,f=q.find(a);return!!f.length&&(c=f[0].getBoundingClientRect(),d=new p(b.left,b.top,b.width,b.height),e=new p(c.left,c.top,c.width,c.height),e.intersectsWith(d))}function z(){u.updateLocked(f.grid),G&&G()}function C(){d.getSiblingCells(f.grid,f.selections.activationCell).forEach(function(a){e.deselectCell(f.grid,a)}),u.updateLocked(f.grid),G&&G()}function D(){f.selections.active&&f.selections.activationCell&&(d.getSiblingCells(f.grid,f.selections.activationCell).forEach(function(a){e.deselectCell(f.grid,a)}),u.updateLocked(f.grid))}function E(){f.object.selectionsClass="",u.updateLocked(f.grid)}function F(a,b){var c,d,e=a.length;for(c=0;c<e;++c)if(d=a[c],d.dataRowIx===b)return d}var G,H=q.find(".qv-grid-object-scroll-area"),I=q.closest(".qv-object-content-container"),J=H.controller("qvScrollArea"),K=q.find(".qv-scroll-loader:not(.qv-scroll-row-loader)").controller("qvScrollLoader"),L=H.find(".qv-scroll-row-loader").controller("qvScrollLoader"),M="."+f.id+"-straight-table",N={alignToBottom:"reduce",minRowHeight:w(f),maxRowHeight:3*w(f),columnCount:0,useHorizontalScroll:f.options.useHorizontalScroll,useAllSpace:f.options.useAllSpace,column:{glyphWidth:8,paddingWidth:14,minSearchWidth:f.options.customHeader?1:35,minColWidth:f.options.minColumnWidth||24,maxColWidth:250},columnPicker:{show:!1,width:21},blockSize:50},O=f.scrollApi=new k(b,N),P=new A(u),Q=l.extend({init:function(a,b,c,d,e,f,g){this.columnPicker=g,this._super.apply(this,arguments)},getScrollAreaClientHeight:function(){var a=this.$element[0].getBoundingClientRect(),b=this.$scrollArea[0].getBoundingClientRect();return a.top+a.height-b.top},getBoundingBox:function(){var a=this.$element[0].getBoundingClientRect(),b={};return b.bottom=a.bottom,b.height=a.height,b.left=a.left,b.right=a.right,b.top=a.top,b.width=a.width,this.$element.find(".qv-st-column-picker").length>0&&(b.width+=this.columnPicker.width),b}}),R=q;N.useHorizontalScroll&&(R=R.parent().parent(),Q=Q.extend({getScrollAreaBoundingBox:function(){var a=this.$scrollArea[0].getBoundingClientRect(),b=I[0].clientWidth+I[0].scrollLeft;return{bottom:a.bottom,height:a.height,left:a.left,right:a.right,top:a.top,width:b}}}));var S=f.backendApi.isSnapshot?new B(q,H,".qv-st-data-row","","",null,f.layout.snapshotData.object,f.options):new Q(R,H,".qv-st-data-row",".qv-grid-object-data-first-row",".qv-grid-object-data-last-row",null,O.settings.columnPicker);f.grid=new o("straight"),f.selections=e.$new(),f.$on("$destroy",function(){O.destroy(),q.off(M)}),q.on("contextmenu"+M,function(a){f.selections.active&&a.preventDefault()});var T;f.options.useHorizontalScroll&&I.scroll(function(){J.fadeScrollbarsWithoutDelay(),b.cancel(T),T=b(function(){v("processResize",[]),J.fadeInScrollbars()},300)});var U=O.initialize(S,P,J,K).then(function(){u.setInteractionState=function(){var a=f.object.inAnalysisState(),b=a&&f.options.navigation!==!1,c=a&&f.options.selections!==!1;f.interactive=c,b&&!f.navigatable?(f.navigatable=!0,f.scrollApi.activate()):!b&&f.navigatable&&(f.navigatable=!1,f.scrollApi.deactivate()),a||(f.isLoadPrevVisible=y(".qv-st-load-prev",O.domApi.getScrollAreaBoundingBox()))},u.onPaint=function(){return s.isInSelection(f.layout)?c.resolve():(s.isModalSelectionModel(f.object.model)&&f.selectionsApi.confirm(),v("processPaint",u._paintWatches))},u.onResize=function(){return f.scrollApi.updateViewport(),v("processResize",u._resizeWatches)},u.onInitialNativeScroll=function(a,b){return L.fadeIn(null,{width:"100%",height:"30px"},"relative").then(function(){return u.update(a,b,!0,!1,!0).then(function(){return L.fadeOut()})})},u.setInteractionState(f.options.interactionState)});u.onInit=function(){return U},f.applyColumnOrderSoftPatch=function(a,b){var c=a?"add":"replace",d=[{qPath:"/qHyperCubeDef/columnOrder",qOp:c.toString(),qValue:JSON.stringify(b)}];f.backendApi.applyPatches(d,!0)},g.init(f.grid,u.metaHeaders),f.options.externalInterface&&(f.options.externalInterface.columnHighlightService=g,f.options.externalInterface.forceRedraw=function(){u.onPaint()}),f.applyColumnWidthSoftPatch=function(a,b){var c=a?"add":"replace",d=[{qPath:"/qHyperCubeDef/columnWidths",qOp:c.toString(),qValue:JSON.stringify(b)}];f.backendApi.applyPatches(d,!0),f._columnWidthsExistsInLayout=!0},e.init(f.selectionsApi,f.backendApi,f.selections,z,C,D);var V=f.selectionsApi.ignoreOnOutside;f.selectionsApi.ignoreOnOutside=function(a){return!!a.closest(".qv-st-dim-columns").length||(!(!V(a)&&!a.closest(".qv-st-selections-active").length)||void 0)},f.selectionsApi.getMenuMaxHeight=function(){return q.outerHeight()},f.selectWhileLocked=function(){n.showLockedFeedback(f.layout.qHyperCube.qDimensionInfo)},f.selectDimensionValue=function(b,c){if(f.scrollApi.updateViewport(),b.representation!==b.REPRESENTATION_URL||!a(c.target).is("a")){f.selectionsApi.getKeyAsToggleSelected(c)||(D(),e.reset(f.selections)),G=e.selectDimensionValue(f.$id,f.backendApi,f.selectionsApi,f.selections,b,f.grid,!0);var d=f.selectionsApi.watchActivated(function(){E(),d()})}},f.activateSelections=function(a){f.scrollApi.updateViewport(),G=e.activateSelections(f.$id,f.backendApi,f.selectionsApi,f.selections,a);var b=f.selectionsApi.watchActivated(function(){E(),b()})},f.multiselectDimensionValues=function(a,b){function c(a){var b=F(h,a);b&&b.isDimensionValue&&e.selectDimensionCells(f.backendApi,f.selectionsApi,f.selections,f.grid,b,!1)}var g,h=d.getSiblingCells(f.grid,a),i=a.dataRowIx,j=b.dataRowIx;if(i<=j)for(g=i;g<=j;++g)c(g);else if(i>j)for(g=i;g>=j;--g)c(g)},f.multiselect=function(){f.selections.active&&e.sendSelection(f.backendApi,f.selectionsApi,f.selections,f.grid,f.selections.currentCell)},f.sort=function(a){if(a){f.scrollApi.updateViewport();var b,c,e,g=a.dataColIx,h=[].concat(f.layout.qHyperCube.qEffectiveInterColumnSortOrder),j=h[0],k="";g!==j&&(e=h.indexOf(g),i.move(h,e,0));var l=[{qPath:"/qHyperCubeDef/qInterColumnSortOrder",qOp:"replace",qValue:"["+h.join(",")+"]"}];g===j&&(k=a.isDimension?"/qHyperCubeDef/qDimensions/":"/qHyperCubeDef/qMeasures/",b=d.getColumnInfo(g,f.layout),a.reversed=!b.qReverseSort,c=a.isDimension?g:g-f.layout.qHyperCube.qDimensionInfo.length,k+=c+"/qDef/qReverseSort",l.push({qPath:k,qOp:"replace",qValue:a.reversed.toString()})),f.backendApi.applyPatches(l,!0)}},f.currentHeaderSearch=null,f.search=function(b,c){if(f.currentHeaderSearch===c)return c.open=!1,f.currentHeaderSearch=null,void(t.isSmallDevice?j.close():h.close());f.currentHeaderSearch&&(f.currentHeaderSearch.open=!1,f.currentHeaderSearch=null),t.isSmallDevice?x(j,c.fieldName,f,b):x(h,c.fieldName,f,b).then(function(b){var d;b.closing.then(function(b){b&&!a(b.target).closest(".qv-st-header-cell-search").length>0&&(f.currentHeaderSearch=null,c.open=!1),d=b}),b.closed.then(function(){b=null,c.open=!1,d||(f.currentHeaderSearch=null)}),f.currentHeaderSearch&&f.currentHeaderSearch===c&&(b=null)}),c.open=!0,f.currentHeaderSearch=c},f.openUrl=function(a){f.interactive&&m.open(a,"_blank")}}}}]),{initialProperties:{qHyperCubeDef:{qDimensions:[],qMeasures:[],qSuppressMissing:!0,qMode:"S",columnOrder:[],columnWidths:[]}},data:{dimensions:{min:1,max:1e3,add:function(a,b,c){var d=c.hcProperties.columnOrder,e=c.hcProperties.columnWidths,f=c.getDimensions().length-1;return i.indexAdded(d,f),e.splice(f,0,-1),a},remove:function(a,b,c,d){var e=c.hcProperties.columnOrder,f=c.hcProperties.columnWidths;i.indexRemoved(e,d),f.splice(e[d],1)}},measures:{add:function(a,b,c){var d=c.hcProperties.columnOrder,e=c.hcProperties.columnWidths,f=c.getDimensions().length+c.getMeasures().length-1;i.indexAdded(d,f),e.splice(d[f],0,-1)},remove:function(a,b,c,d){var e=c.hcProperties.columnOrder,f=c.hcProperties.columnWidths,g=(c.hcProperties.qDimensions?c.hcProperties.qDimensions.length:0)+d;i.indexRemoved(e,g),f.splice(g,1)},min:0,max:1e3}},support:{cssScaling:!0,snapshot:!0,export:!0,exportData:!0,sharing:!1},type:"table",template:"<qv-straight-table></qv-straight-table>",BackendApi:d,definition:e,importProperties:function(a,c,d){for(var e=h.hypercube.importProperties(a,c,d),f=e.qProperty.qHyperCubeDef.columnOrder,g=e.qProperty.qHyperCubeDef.qDimensions,i=e.qProperty.qHyperCubeDef.qMeasures,j=0;j<g.length;j++){var k=g[j].qDef.representation;if(k&&k.urlLabel&&k.urlLabel.qStringExpression){var l=[];l.push({qExpression:k.urlLabel.qStringExpression.qExpr,id:"urlLabel"}),u.setValue(e,"qProperty.qHyperCubeDef.qDimensions."+j+".qAttributeExpressions",l)}}return f.length&&g.length+i.length===f.length||(e.qProperty.qHyperCubeDef.columnOrder=b.getService("qvGridObjectDataService").columnOrder.get(g,i)),e.qProperty.qHyperCubeDef.qDimensions.forEach(function(a){a.qOtherTotalSpec&&a.qOtherTotalSpec.qTotalMode&&(a.qOtherTotalSpec.qTotalMode="TOTAL_OFF")}),e},exportProperties:h.hypercube.exportProperties,controller:z}}),define("extensions.qliktech/listbox/listbox-properties",["client.utils/property-resolver"],function(a){var b,c,d,e=[{value:"ascending",translation:"properties.sorting.ascending"},{value:"descending",translation:"properties.sorting.descending"}];return b={uses:"settings",items:{}},c={type:"items",translation:"Common.Dimension",ref:"qListObjectDef",min:1,max:1,items:{label:{type:"string",ref:"qListObjectDef.qDef.qFieldLabels.0",translation:"Common.Label",show:!1},libraryId:{type:"string",component:"library-item",libraryItemType:"dimension",ref:"qListObjectDef.qLibraryId",translation:"Common.Dimension",show:function(a){return a.qListObjectDef&&a.qListObjectDef.qLibraryId}},field:{type:"string",expressionType:"dimension",ref:"qListObjectDef.qDef.qFieldDefs.0",translation:"Common.Field",change:function(a){var b=a.qListObjectDef.qDef;b.qFieldLabels||(b.qFieldLabels=[]),b.qFieldLabels[0]=b.qFieldDefs[0]},show:function(a){return a.qListObjectDef&&!a.qListObjectDef.qLibraryId}},autoSort:{ref:"qListObjectDef.qDef.autoSort",type:"boolean",defaultValue:!0,show:!1},cId:{ref:"qListObjectDef.qDef.cId",type:"string",show:!1}}},d={type:"items",translation:"properties.sorting",grouped:!0,schemaIgnore:!0,items:{autoSort:{ref:"qListObjectDef.qDef.autoSort",type:"boolean",translation:"properties.sorting",component:"switch",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}],change:function(a,b){if(a.qListObjectDef.qDef.autoSort)return b.autoSortDimension(a.qListObjectDef)}},expression:{type:"items",show:function(a){return!!a.qListObjectDef&&!a.qListObjectDef.qDef.autoSort},items:{expressionToggled:{type:"boolean",ref:"qListObjectDef.qDef.qSortCriterias.0.qSortByExpression",translation:"properties.sorting.sortByExpression",resolveFunctions:"booleanToSortInteger"},expression:{type:"number",component:"expression",ref:"qListObjectDef.qDef.qSortCriterias.0.qExpression",translation:"Common.Expression",show:function(b){return 0!==a.getValue(b,"qListObjectDef.qDef.qSortCriterias.0.qSortByExpression",0)}},expressionOrder:{type:"string",component:"dropdown",ref:"qListObjectDef.qDef.qSortCriterias.0.qSortByExpression",options:e,resolveFunctions:"enumToSortInteger",show:function(b){return 0!==a.getValue(b,"qListObjectDef.qDef.qSortCriterias.0.qSortByExpression",0)}}}},frequency:{type:"items",show:function(a){return!!a.qListObjectDef&&!a.qListObjectDef.qDef.autoSort},items:{frequencyToggled:{type:"boolean",ref:"qListObjectDef.qDef.qSortCriterias.0.qSortByFrequency",translation:"properties.sorting.sortByFrequency",defaultSort:-1,resolveFunctions:"booleanToSortInteger"},frequencyOrder:{type:"string",component:"dropdown",ref:"qListObjectDef.qDef.qSortCriterias.0.qSortByFrequency",options:e,resolveFunctions:"invertedEnumToSortInteger",show:function(b){return 0!==a.getValue(b,"qListObjectDef.qDef.qSortCriterias.0.qSortByFrequency",0)}}}},numeric:{type:"items",show:function(a){return!!a.qListObjectDef&&!a.qListObjectDef.qDef.autoSort},items:{numericToggled:{type:"boolean",ref:"qListObjectDef.qDef.qSortCriterias.0.qSortByNumeric",translation:"properties.sorting.sortByNumeric",defaultSort:-1,resolveFunctions:"booleanToSortInteger"},numericOrder:{type:"string",component:"dropdown",ref:"qListObjectDef.qDef.qSortCriterias.0.qSortByNumeric",options:e,resolveFunctions:"enumToSortInteger",show:function(b){return 0!==a.getValue(b,"qListObjectDef.qDef.qSortCriterias.0.qSortByNumeric",0)}}}},ascii:{type:"items",show:function(a){return!!a.qListObjectDef&&!a.qListObjectDef.qDef.autoSort},items:{asciiToggled:{type:"boolean",ref:"qListObjectDef.qDef.qSortCriterias.0.qSortByAscii",translation:"properties.sorting.sortByAlphabetic",resolveFunctions:"booleanToSortInteger"},asciiOrder:{type:"string",component:"dropdown",ref:"qListObjectDef.qDef.qSortCriterias.0.qSortByAscii",options:e,resolveFunctions:"enumToSortInteger",show:function(b){return 0!==a.getValue(b,"qListObjectDef.qDef.qSortCriterias.0.qSortByAscii",0)}}}}}},{type:"items",component:"accordion",items:{dimension:c,sorting:d,
settings:b}}}),define("text!extensions.qliktech/listbox/listbox.ng.html",[],function(){return'<div class="qv-listbox-container" ng-class="{ \'qv-listbox-interactive\': navigatable }" tid="qv-listbox-container">\n\t<div qva-direction x-dir-setting="{{options.direction}}" qv-listbox-search ng-show="options.search.show" class="qv-listbox-search">\n\t\t<lui-search query="query" is-focused="focused" on-escape="onEscape($event);" auto-focus="autoFocus" />\n\t</div>\n\t<div class="qv-listbox-wrapper" ng-class="{ \'searchActive\': options.search.show }">\n\t\t<qv-scroll-area class="qv-listbox-scroll-area qv-animate"\n\t\t\t\t\t\tng-class="{ \'qv-listbox-virtual-scroll-enabled\': scrollApi.virtualScrollEnabled }"\n\t\t\t\t\t\tx-direction="options.direction">\n\t\t\t<ul class="qv-listbox"\n\t\t\t\tng-class="{ \'align-bottom\': scrollApi.alignBottomAbsolute }"\n\t\t\t\tng-style="listStyle"\n\t\t\t\tqva-direction x-dir-setting="{{options.direction}}"\n\t\t\t\tqv-selections-select-while-locked="selectWhileLocked()"\n\t\t\t\tqv-selections-toggle-dimension-value="{ selector: \'li\', itemKey: \'item\' }"\n\t\t\t\tqv-selections-on-toggle-dimension-value="interactive && select($event, item)"\n\t\t\t\tqv-selections-multiselect="{ selector: \'li\', itemKey: \'item\' }"\n\t\t\t\tqv-selections-start-multiselect="interactive && multiselectStart($event)"\n\t\t\t\tqv-selections-update-multiselect="interactive && multiselectUpdate(start, current)"\n\t\t\t\tqv-selections-end-multiselect="interactive && multiselectEnd($event)">\n\t\t\t\t<qv-scroll-load-button tag="li" class="qv-listbox-load-buttons" ng-show="navigatable && scrollApi.loadPrevious" on-load="scrollApi.gotoPreviousBlock()" text="Object.Listbox.LoadPrevious" previous="true">\n\t\t\t\t</qv-scroll-load-button>\n\t\t\t\t<li ng-repeat="item in items" ng-class="item.classNames" tid="listbox.item">\n\t\t\t\t\t<div class="qv-listbox-tick"><i class="lui-icon tick-icon" ng-class="{\'lui-icon--tick\': !item.locked, \'lui-icon--lock\': item.locked, }"></i></div>\n\t\t\t\t\t<div class="qv-listbox-text" ng-style="item.style" dir="{{item.dir}}">\n\t\t\t\t\t\t<span ng-attr-title="{{item.tipText}}">\n\t\t\t\t\t\t\t<span ng-repeat="textItem in item.textItems" ng-class="{ highlighted: textItem.isHighlighted }" ng-bind="textItem.text"></span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</li>\n\t\t\t\t<qv-scroll-loader tag="li" class="qv-scroll-row-loader"></qv-scroll-loader>\n\t\t\t\t<qv-scroll-load-button tag="li" class="qv-listbox-load-buttons" ng-show="navigatable && scrollApi.loadNext" on-load="scrollApi.gotoNextBlock()" text="Object.Listbox.LoadMore"></qv-scroll-load-button>\n\t\t\t</ul>\n\t\t</qv-scroll-area>\n\t\t<qv-scroll-loader></qv-scroll-loader>\n\t</div>\n</div>\n'}),define("text!client.services/export-dialog/export-dialog.ng.html",[],function(){return'<qv-modal-dialog qv-id="export-dialog">\n\t<div ng-if="state === states.PENDING">\n\t\t<header class="dm-header" q-translation="Export.Exporting"></header>\n\t\t<main class="dm-main">\n\t\t\t<div class="qv-loader dm-p"></div>\n\t\t</main>\n\t\t<footer class="dm-footer">\n\t\t\t<lui-button x-variant="inverse" qva-activate="cancel()" q-translation="Common.Cancel"></lui-button>\n\t\t</footer>\n\t</div>\n\t<div ng-if="state === states.COMPLETED">\n\t\t<header class="dm-header" q-translation="Export.Completed"></header>\n\t\t<main class="dm-main">\n\t\t\t<p class="dm-p">\n\t\t\t\t<span q-translation="Export.CompletedDescription"></span>\n\t\t\t\t<span q-translation="Export.WarningDataTruncated" ng-if="dataIsTruncated"></span>\n\t\t\t</p>\n\t\t\t<p class="dm-p">\n\t\t\t\t<a ng-href="{{exportUrl}}" target="_blank" q-translation="Export.CompletedLink"></a>\n\t\t\t</p>\n\t\t</main>\n\t\t<footer class="dm-footer">\n\t\t\t<lui-button x-variant="inverse" qva-activate="close()" q-translation="Common.Close"></lui-button>\n\t\t</footer>\n\t</div>\n\t<div ng-if="state === states.FAILED">\n\t\t<header class="dm-header" q-translation="Export.Failed"></header>\n\t\t<main class="dm-main">\n\t\t\t<p class="dm-p" q-translation="{{errorTranslation}}"></p>\n\t\t</main>\n\t\t<footer class="dm-footer">\n\t\t\t<lui-button x-variant="inverse" qva-activate="close()" q-translation="Common.Close"></lui-button>\n\t\t</footer>\n\t</div>\n</qv-modal-dialog>\n'}),define("client.services/export-dialog/export-dialog",["qvangular","text!./export-dialog.ng.html","general.services/show-service/show-service","assets/client/dialogs/directives/dialog-directives"],function(a,b,c){var d={template:b,scope:{model:"=",hypercubePath:"="},controller:["$scope",function(a){a.states={FAILED:-1,IDLE:0,PENDING:1,COMPLETED:2},a.state=a.states.PENDING,a.model.getLayout().then(function(b){var c=a.model.exportData(null,a.hypercubePath,b.title||null);a.rpcId=c.requestId,c.then(function(b){a.exportUrl=require.toUrl(".."+b.qUrl),a.state=a.states.COMPLETED,b.qWarnings&&1e3===b.qWarnings[0]&&(a.dataIsTruncated=!0)},function(b){a.state=a.states.FAILED,a.errorTranslation="ErrorCode."+b.code,b.isHandled=!0})}),a.openExportWindow=function(){window.open(a.exportUrl)},a.cancel=function(){a.rpcId?a.model.app.global.cancelRequest(a.rpcId).finally(a.close):a.close()},a.close=function(){a.destroyComponent()}}]};a.service("$exportDialog",[function(){return{show:function(a,b){var e={model:a,hypercubePath:b};return c.show(d,e)}}}])}),define("extensions.qliktech/listbox/listbox-search",["qvangular","util","general.utils/support"],function(a,b,c){"use strict";var d=document.createElement("input");d.type="text",a.directive("qvListboxSearch",["$document","$timeout",function(e,f){return{link:function(g,h){function i(a){g.backendApi.search(a)}function j(){return e.on("keypress.watchKeyChars"+g.$id,function(a){27===a.keyCode||13===a.keyCode||g.options.search.show||(d.value=String.fromCharCode(a.which),d.value.length&&g.$apply(function(){g.options.search.toggle(!0,d.value)}))}),function(){e.off(".watchKeyChars"+g.$id)}}function k(){function a(){return g.$watch("query",function(a,b){void 0!==a&&a!==b&&(a.length>0?i(a):g.backendApi.abortSearch())})}function b(){d&&d(),g.query="",d=a()}function c(a){return a.split(" ").some(function(a){var b=a.trim()[0];return"<"===b||">"===b})}var d,h;return b(),h=g.$watch("focused",function(a){void 0!==a&&g.selectionsApi.toggleKeyboardAccelerators(!a)}),e.on("keydown.listboxSearch"+g.$id,function(a){g.focused===!0&&f(function(){switch(g.clearItemStates(!1),a.which){case 13:var d,e=g.backendApi.getSize();g.backendApi.isLocked()||g.options.selections===!1?g.selectWhileLocked():e.qcy>0&&g.query.length>0&&(d=g.selectionsApi.getKeyAsToggleSelected(a),d=c(g.query)?!d:d,g.backendApi.confirmSearch(d),g.selectionsApi.selectionsMade=!0,b());break;case 27:g.backendApi.abortSearch(),b()}})}),function(){d(),h(),e.off(".listboxSearch"+g.$id)}}var l,m;g.autoFocus=!1,g.selectionsApi.deactivateSearch=function(){l&&l(),m&&m(),a.$apply(g,function(){g.options.search&&g.options.search.toggle(!1)})},g.onEscape=function(a){g.query&&g.query.length?g.query="":(g.backendApi.abortSearch(),g.selectionsApi.cancel()),a.preventDefault()},g.options.search=b.extend(!0,{show:g.options.isPopover,toggle:function(a,b){g.options.search.show=void 0!==a?a:!g.options.search.show,g.options.search.show?(l=k(),b&&b.length>0&&(g.query=b,i(b))):(l&&l(),g.backendApi.abortSearch(),g.query="")}},g.options.search),g.options.showSearch=!0,g.$watch("options.search.show",function(a){g.autoFocus=a&&c.treatAsDesktop(),a||h.find("input").blur()}),g.$watch("selectionsApi.active && !focused",function(a){a?m=j():void 0!==a&&m&&m()}),g.$on("$destroy",function(){e.off(".listboxSearch"+g.$id),e.off(".watchKeyChars"+g.$id),delete g.options.search}),g.options.isPopover&&g.options.search.toggle(!0,g.options.search.defaultStr)}}}])}),define("extensions.qliktech/listbox/listbox",["qvangular","objects.backend-api/listbox-api","extensions.qliktech/listbox/listbox-properties","client.utils/property-mapper","text!./listbox.ng.html","objects.utils/data-properties/listobject-handler","objects.extension/object-conversion","general.scroll/api/vertical-scroll-api","general.scroll/api/dom-api","general.scroll/api/data-api","objects.extension/base-controller","general.utils/support","objects.extension/default-selection-toolbar","objects.utils/event-utils","client.utils/rtl/rtl-util","general.utils/qv-keyboard-shortcuts","core.utils/feature-flags","client.utils/theme/theme-module","client.services/export-dialog/export-dialog","general.scroll/scroll-area","objects.grid/directives/selections","./listbox-search"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){"use strict";function s(a,b,c){var d=".selections-keyboard-"+c;a.on("keyup"+d,function(a){b.focused||(27===a.which?b.selectionsApi.cancel():13===a.which&&b.selectionsApi.confirm())});var e=p.createGroup("listbox",0),f=b;return e.registerKeys("ctrl+a",function(){f.clearItemStates(!1),f.selectionsApi.selectionsMade=!0,f.backendApi.selectAll()}),e.on(),function(){a.off(d),e.delete()}}function t(a,b){a.listStyle={color:b.getStyle("content","color"),"font-size":b.getStyle("content","fontSize")}}var u,v,w;return w=i.extend({getBoundingBox:function(){return this.$scrollArea[0].getBoundingClientRect()}}),v=j.extend({init:function(a){this.visualizationCtrl=a},getRows:function(){return this.visualizationCtrl.getRows()},getRowCount:function(){return this.visualizationCtrl.getRowCount()},getFirstElementIndex:function(){return this.visualizationCtrl.getFirstElementIndex()},getLastElementIndex:function(){return this.visualizationCtrl.getLastElementIndex()},onVirtualScroll:function(a,b){return this.visualizationCtrl.onVirtualScroll(a,b)},onInitialNativeScroll:function(a,b){return this.visualizationCtrl.onInitialNativeScroll(a,b)},onGotoNextBlock:function(a,b){return this.visualizationCtrl.onGotoNextBlock(a,b)},onGotoPreviousBlock:function(a,b){return this.visualizationCtrl.onGotoPreviousBlock(a,b)}}),u=k.extend({init:function(a,b,c){function d(b,c){var d=g.isSelected(b);d&&!c?(a.itemStates[b.dataValue]=!1,b.classNames="serverAlternative"):d||(a.selectedValues.push(b.dataValue),a.itemStates[b.dataValue]=!0,b.classNames="selected")}this._super.apply(this,arguments),this.$timeout=c;var e=r.get();q.THEMING&&(this.styleService=e.initializeService("object.listBox"));var f,g=this;a.itemStates={},a.selectedValues=[],a.ignoreSelectionState=!1,a.selectionsApi.watchDeactivated(function(){a.$emit("childSelectionActive",!1),a.clearItemStates(!1),a.options.search&&(a.options.search.show=!1),f&&f()}),a.selectionsApi.watchActivated(function(){a.$emit("childSelectionActive",!0),f&&f(),f=s(b,a,a.$id)}),a.selectionsApi.clear=function(){this.selectionsMade=!0,a.backendApi.clearSelections(),a.removeAllSelections()},a.activateSelections=function(){a.selectionsApi.active||a.clearItemStates(!1),a.selectionsApi.activate()},a.clearItemStates=function(b){a.itemStates={},a.ignoreSelectionState=b},a.removeAllSelections=function(b){a.clearItemStates(!0),a.items.forEach(function(a){a!==b&&(a.classNames="serverOptional")})},a.selectValues=function(b,c){a.selectionsApi.selectionsMade=!0,a.backendApi.select(0,b,c).then(function(b){b||a.selectionsApi.clear()})},a.select=function(b,c){var e=a.selectionsApi.getKeyAsToggleSelected(b);a.activateSelections(),e||a.removeAllSelections(c),d(c,!1),a.selectValues([c.dataValue],e)},a.multiselectStart=function(b){var c=a.selectionsApi.getKeyAsToggleSelected(b);a.activateSelections(),a.selectedValues=[],c||a.removeAllSelections()},a.multiselectUpdate=function(b,c){var e,f,g,h;if(a.items.indexOf(c)!==-1)if(g=a.items.indexOf(b),h=a.items.indexOf(c),g<=h)for(e=g;e<=h;++e)f=a.items[e],d(f,!0);else if(g>h)for(e=g;e>=h;--e)f=a.items[e],d(f,!0)},a.multiselectEnd=function(b){a.selectedValues.length&&a.selectValues(a.selectedValues,a.selectionsApi.getKeyAsToggleSelected(b))},a.selectWhileLocked=function(){n.showLockedFeedback([a.layout.qListObject.qDimensionInfo])},a.$on("$destroy",function(){f&&f()}),Object.defineProperties(a,{isDesktop:{get:function(){return l.treatAsDesktop()}}})},update:function(a,b,c,d){q.THEMING&&t(this.$scope,this.styleService);var e=this.getDataInfo(a,b);return this.$scope.backendApi.getData(e.rects).then(function(a){return this.onUpdateData(a,c,d)}.bind(this))},getDataInfo:function(a,b){return a=a||0,{rects:[{qTop:a,qLeft:0,qWidth:1,qHeight:b}]}},stateMap:{S:"Selected",A:"Alternative",O:"Optional",XS:"SelectedExcluded",L:"Locked",X:"Excluded",XL:"ExcludedLock"},getState:function(a){return this.stateMap[a]},getItemClassNames:function(a,b){var c=this.getState(b);return this.useClientItemState(a)?this.$scope.itemStates[a]?"XS"===b?"server"+c:"selected server"+c:"Selected"===c?"serverOptional":"server"+c:"server"+c},useClientItemState:function(a){return this.$scope.ignoreSelectionState||a in this.$scope.itemStates},isSelected:function(a){return this.useClientItemState(a.dataValue)?!!this.$scope.itemStates[a.dataValue]:"S"===a.state||"XS"===a.state},updateTextItem:function(a,b){var c,d,e,f,g=b.qHighlightRanges&&b.qHighlightRanges.qRanges.length||0,h=b.qText&&b.qText.split("")||[],i=0;if(a.textItems=[],h.length||a.textItems.push({isHighlighted:!1,text:""}),!g)return void a.textItems.push({isHighlighted:!1,text:(b.qText||"").substring(0,1024)});for(e=b.qHighlightRanges.qRanges.sort(function(a,b){return a.qCharPos-b.qCharPos}),c=0;c<g;++c)d=e[c],f=d.qCharPos,f!==i&&a.textItems.push({isHighlighted:!1,text:h.splice(0,f-i).join("")}),a.textItems.push({isHighlighted:!0,text:h.splice(0,d.qCharCount).join("")}),i=d.qCharPos+d.qCharCount;h.length&&1024-i>0&&a.textItems.push({isHighlighted:!1,text:h.splice(0,1024-i).join("")})},updateItems:function(a,b,c){var d,e,f,g,h,i,j,k=0,l=a[0].qArea.qTop,m=a[0].qArea.qHeight,n=this.$scope.items,p=a[0].qMatrix,q=o.supportDirAuto(),r={rtl:"right",ltr:"left"};for(c&&p.reverse(),b&&(k=n.length),h=this.$scope.backendApi.isLocked(),d=0,e=p.length;d<e;++d)n[k+d]||(n[k+d]={style:{}}),g=n[k+d],f=p[d][0],i="NaN"!==f.qNum,j=o.detectTextDirection(f.qText),g.locked=h,g.dataValue=f.qElemNumber,g.dataColIx=0,g.dataRowIx=c?l+m-d-1:l+d,g.state=f.qState,g.classNames=this.getItemClassNames(f.qElemNumber,f.qState),g.isDimensionValue=!0,g.text=f.qText,g.tipText=(f.qText||"").substring(0,1024),g.dir=q?"auto":j,g.style.textAlign=i?"right":r[j],this.updateTextItem(g,f);b||n.splice(d),c&&n.reverse()},onUpdateData:function(a,b,c){return this.updateItems(a,b,c),this.$timeout(function(){},0,!1)},process:function(a,b,c){return this.update(a,b,!1,!1).then(function(){return this.$scope.scrollApi.setTotalRows(this.$scope.layout.qListObject.qSize.qcy),this.$scope.scrollApi.setVirtualSize(c)}.bind(this))},processPaint:function(){var a,b;return a=this.$scope.scrollApi.settings.viewportRowCount,b=this.$scope.scrollApi.resetNativeScroll(),this.process(0,a,!1).then(function(){b()})},processResize:function(){var a=this.$scope.items.length,b=a?this.$scope.items[0].dataRowIx:0,c=this.$scope.scrollApi.settings.viewportRowCount;return c<a&&(c=a),this.process(b,c,!0)},onVirtualScroll:function(a,b){var c=this.update(a,b,!1,!1);return this.$scope.$digest(),c},gotoBlock:function(a,b,c){var d=this.$scope.scrollApi.getSpliceArgs(),e=this.$scope.items;return c&&e.reverse(),e.splice.apply(e,d),this.update(a,b,!0,c)},onGotoNextBlock:function(a,b){return this.gotoBlock(a,b,!1)},onGotoPreviousBlock:function(a,b){return this.gotoBlock(a,b,!0)},getRows:function(){return this.$scope.items},getRowCount:function(){return this.$scope.items.length},getFirstElementIndex:function(){return this.$scope.items[0].dataRowIx},getLastElementIndex:function(){return this.$scope.items[this.$scope.items.length-1].dataRowIx},getSelectionToolbar:function(){var a=this.$scope,b=new m(a.backendApi,a.selectionsApi,!1,!1,[],[{name:"Selections.All",tid:"selection-toolbar-menu.selectAll",iconClass:"icon-selection-toolbar-selectAll",buttonClass:"",action:function(){a.clearItemStates(!1),this.selectionsApi.selectionsMade=!0,this.backendApi.selectAll()},isDisabled:function(){return!this.hasState(["qOption","qAlternative","qExcluded","qDeselected"])}},{name:"Selections.Possible",tid:"selection-toolbar-menu.selectPossible",iconClass:"icon-selection-toolbar-selectPossible",buttonClass:"",action:function(){a.clearItemStates(!1),this.selectionsApi.selectionsMade=!0,this.backendApi.selectPossible()},isDisabled:function(){return!this.hasState(["qOption"])}},{name:"Selections.Alternative",tid:"selection-toolbar-menu.selectAlternative",iconClass:"icon-selection-toolbar-selectAlternative",buttonClass:"",action:function(){a.clearItemStates(!1),this.selectionsApi.selectionsMade=!0,this.backendApi.selectAlternative()},isDisabled:function(){return!this.hasState(["qAlternative"])}},{name:"Selections.Excluded",tid:"selection-toolbar-menu.selectExcluded",iconClass:"icon-selection-toolbar-selectExcluded",buttonClass:"",action:function(){a.clearItemStates(!1),this.selectionsApi.selectionsMade=!0,this.backendApi.selectExcluded()},isDisabled:function(){return!this.hasState(["qExcluded","qAlternative"])}}]);return b.buttons[0].isDisabled=function(){return!a.backendApi.hasSelections()},b}}),u.$inject=["$scope","$document","$timeout"],a.directive("qvListbox",["$timeout",function(a){return{restrict:"E",replace:!0,template:e,require:"^qvObjectContent",link:function(b,c,d,e){var f=c.find(".qv-listbox-scroll-area"),g=f.controller("qvScrollArea"),i=c.find(".qv-scroll-loader:not(.qv-scroll-row-loader)").controller("qvScrollLoader"),j=f.find(".qv-scroll-row-loader").controller("qvScrollLoader"),k="."+b.id+"-listbox",l={blockSize:200,minRowHeight:30,maxRowHeight:30},m=b.scrollApi=new h(a,l),n=new v(e),o=new w(c,f,"li:not(.qv-listbox-load-buttons)","li:not(.qv-listbox-load-buttons):first","li:not(.qv-listbox-load-buttons):not(.qv-scroll-row-loader):last");b.items=[],b.$on("$destroy",function(){m.destroy(),c.off(k)}),c.on("contextmenu"+k,function(a){b.object.selectionsApi.active&&a.preventDefault()});var p=m.initialize(o,n,g,i).then(function(){b.options.isPopover&&b.activateSelections(),b.$watch("options.search.show",function(a,c){var d=a===c;b.options.isPopover||d||b.scrollApi.setVirtualSize(!0)}),e.setInteractionState=function(){var a=this.$scope.object&&this.$scope.object.inAnalysisState(),c=a&&b.options.navigation!==!1,d=a&&b.options.selections!==!1;b.interactive=d,c&&!b.navigatable?(b.navigatable=!0,b.scrollApi.activate()):!c&&b.navigatable&&(b.navigatable=!1,b.scrollApi.deactivate())},e.setDirection=function(a){b.options.direction=a},e.onPaint=function(){var a=b.scrollApi.totalRows===this.$scope.layout.qListObject.qSize.qcy,c=b.selectionsApi.active;return c&&a?e.processResize():c||a?e.processPaint():(b.scrollApi.updateViewport(),e.processResize())},e.onResize=function(){return b.scrollApi.updateViewport(),e.processResize()},e.onInitialNativeScroll=function(a,b){return j.fadeIn(null,{width:"100%",height:"30px"},"relative").then(function(){return e.update(a,b,!0,!1).then(function(){return j.fadeOut()})})}});e.onInit=function(){return p}}}}]),{type:"listbox",template:"<qv-listbox></qv-listbox>",controller:u,initialProperties:{qListObjectDef:{qShowAlternatives:!0,qInitialDataFetch:[{qTop:0,qLeft:0,qWidth:0,qHeight:0}],qDef:{qSortCriterias:[{qSortByState:1,qSortByAscii:1,qSortByNumeric:1,qSortByLoadOrder:1}]}}},data:{dimensions:{min:1,max:1}},mapProperties:function(){this.mappedDefinition=d.mapDefinition(this.definition,this.type),this.dimensionDefinition=d.findDefinition(this.mappedDefinition,"qListObjectDef",!0)},getCreatePropertyHandler:function(a){return new f({app:a,dimensionDefinition:this.dimensionDefinition})},showRequirements:function(a){var b=a.layout;return!b.qListObject||!b.qListObject.qDimensionInfo||!!b.qListObject.qDimensionInfo.qError},BackendApi:b,definition:c,options:{search:{},selections:{}},getDropFieldOptions:function(a,b,c,d){a.Add(c,b),a.ReplaceDimensions(c,b),d()},getDropMeasureOptions:function(a,b,c,d){d()},importProperties:g.listbox.importProperties,exportProperties:g.listbox.exportProperties}}),define("objects.backend-api/field-api",["./backend-api"],function(a){"use strict";return a.extend("FieldApi",{init:function(a){this._super(a,"/dimensions"),this.cacheCube.setMethodName("getListObjectData")},updateCache:function(){},getProperties:function(){return this.model.getProperties()},getData:function(a){return this.cacheCube.getData(a)},getSize:function(){return this.model.layout.qListObject.qSize},isLocked:function(){return this.model.layout.qListObject.qDimensionInfo.qLocked}})}),define("extensions.qliktech/filterpane/filterpane-properties",["client.property-panel/default-sorting-properties","util"],function(a,b){var c,d,e,f;return f={qSortByState:1,qSortByAscii:1,qSortByNumeric:1,qSortByLoadOrder:1},c={uses:"settings",items:{general:{items:{showTitles:{defaultValue:!1}}}}},d={type:"array",component:"filterpane-data",translation:"Common.Data",allowAdd:!0,allowRemove:!0,allowMove:!0,addTranslation:"properties.dimensions.add",grouped:!1,ref:"qChildListDef",items:{libraryId:{type:"string",component:"library-item",libraryItemType:"dimension",ref:"qListObjectDef.qLibraryId",translation:"Common.Dimension",show:function(a){return a.qListObjectDef.qLibraryId}},field:{type:"string",component:"expression",expressionType:"dimension",ref:"qListObjectDef.qDef.qFieldDefs.0",translation:"Common.Field",show:function(a){return!a.qListObjectDef.qLibraryId},change:function(a){var b=a.qListObjectDef.qDef;b.qFieldLabels||(b.qFieldLabels=[]),b.qFieldLabels[0]=b.qFieldDefs[0]}},title:{ref:"title",type:"string",expression:"optional",translation:"Common.Title"},autoSort:{ref:"qListObjectDef.qDef.autoSort",type:"boolean",defaultValue:!0,show:!1},cId:{ref:"qListObjectDef.qDef.cId",type:"string",show:!1}}},e={type:"items",component:"filterpane-sorting",translation:"properties.sorting",allowMove:!0,schemaIgnore:!0,items:{autoSort:{ref:"qListObjectDef.qDef.autoSort",type:"boolean",translation:"properties.sorting",component:"switch",defaultValue:!0,options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}],change:function(a){if(a.qListObjectDef.qDef.autoSort)for(var b=a.qListObjectDef,c=0;c<b.qDef.qSortCriterias.length;c++)b.qDef.qSortCriterias[c]=f}},dimension:{component:"sorting-dimension",type:"items",ref:"qListObjectDef",show:function(a){return!a.qListObjectDef.qDef.autoSort},items:b.extend(!0,{},a.items.dimensions.items.dimension.items,{dimensionDefinition:{items:{frequency:{show:!0}}}})}}},{type:"items",component:"accordion",items:{data:d,sorting:e,settings:c}}}),define("extensions.qliktech/filterpane/filterpane-handler",["objects.utils/data-properties/data-property-handler","objects.utils/data-properties/listobject-util","objects.utils/data-properties/library-utils","util","general.utils/visualizations"],function(a,b,c,d,e){"use strict";return a.extend({init:function(a){this._super(a),this.dimensionLayout=[],this.dimensions=[]},autoSortDimension:function(a){return a.qLibraryId?this.app.getDimensionList().then(function(d){var e=c.findLibraryDimension(a.qLibraryId,d),f=e?e.qData.info:void 0;return b.autoSortDimension(a,f),a}):this.app.getFieldList().then(function(d){var e=c.findField(a.qDef.qFieldDefs[0],d),f=e?[e]:void 0;return b.autoSortDimension(a,f),a})},getDimensions:function(){return this.dimensions||[]},minDimensions:function(){return 1},maxDimensions:function(){return 1e3},setModel:function(a){this.model=a},addDimension:function(a){var b,f,g=this;if(a.qDef.cId=d.generateId(),a.qShowAlternatives=!0,this.getDimensions().length<1e3)return b=e.getType("listbox"),f=b.getInitialProperties({}),f.then(function(b){return g.autoSortDimension(a).then(function(){return b.qListObjectDef=a,a.qLibraryId?g.app.getDimensionList().then(function(d){var e=c.findLibraryDimension(a.qLibraryId,d);return b.title=e.qData.title,g.model.createChild(b,g.properties).then(function(){return b.qListObjectDef})}):(b.title=a.qDef.title||a.qDef.qFieldLabels[0]||a.qDef.qFieldDefs[0],g.model.createChild(b,g.properties).then(function(){return b.qListObjectDef}))})})},removeDimension:function(a){var b=this.layout.qChildList.qItems[a];return this.model.destroyChild(b.qInfo.qId,this.properties).then(function(){return b})},getDimensionLayouts:function(){return this.dimensionLayout||[]},getDimensionLayout:function(a){var b=this.getDimensionLayouts();return b[a]?b[a].qListObject.qDimensionInfo:""}})}),define("text!extensions.qliktech/filterpane/filterpane.ng.html",[],function(){return'<qv-filterpane\n\t\tclass="qv-filterpane"\n\t\tqv-collapsed-listbox-delegated-open\n\t\toutside-ignore-name="outsideIgnoreName"\n\t\tinteractive="interactive"\n\t\tqva-direction x-dir-setting="{{options.direction}}"\n\t\tng-class="{\'qv-filterpane-scrollable\': !hasExpanded && !options.zoomEnabled}">\n\t<div ng-repeat="column in columns" class="qv-filterpane-column">\n\t\t<div ng-repeat="item in column.items"\n\t\t\t ng-class="{\'qv-filterpane-collapsed\': !item.expand, \'qv-filterpane-expanded\': item.expand}"\n\t\t\t ng-style="{height: item.height}"\n\t\t\t tid="qv-object-filterpane.dimension">\n\t\t\t<qv-object ng-if="item.expand" model="item.model" options="item.options" object="item.object"></qv-object>\n\t\t\t<qv-collapsed-listbox ng-if="!item.expand" model="item.model" read-direction="options.direction" outside-ignore-name="outsideIgnoreName" responsive-mode="item.responsiveMode" interactive="interactive"></qv-collapsed-listbox>\n\t\t</div>\n\n\t\t<div ng-if="column.showAll && object.expanded" class="qv-filterpane-collapsed qv-filterpane-showall">\n\t\t\t<div class="presentation" q-title-translation="Tooltip.Filterpane.NotAllItemsShow"></div>\n\t\t</div>\n\t\t<div ng-if="column.showAll && !object.expanded" class="qv-filterpane-collapsed qv-filterpane-fullscreen">\n\t\t\t<button class="add-button lui-button"\n\t\t\t\t\tng-class="{ \'lui-disabled\': !object.inAnalysisState() }"\n\t\t\t\t\tqva-activate="triggerFullScreen()"\n\t\t\t\t\tq-title-translation="Tooltip.Filterpane.ClickForFullScreen"></button>\n\t\t</div>\n\t</div>\n</qv-filterpane>\n'}),define("extensions.qliktech/filterpane/filterpane-layout",["qvangular","general.utils/responsive-state","client.utils/property-resolver"],function(a,b,c){"use strict";a.service("qvFilterpaneLayout",function(){return{getMaxColumns:function(a){return b.isSmallDevice?1:Math.floor((a.width+20)/180)||1},getMaxItemsPerColumn:function(a){return Math.max(1,Math.floor((a.height+10)/44))},getDimensionCount:function(a){return a.qChildList.qItems.length},getColumnItemsCount:function(a){var b=0;return a.forEach(function(a){b+=a.itemCount}),b},getHeightOf:function(a){var b=44*a-10;return Math.max(b,0)},getDimensionCardinal:function(a){var b=c.getValue(a,"model.layout.qListObject.qDimensionInfo.qStateCounts",void 0);if(b)return Object.keys(b).reduce(function(a,c){return a+b[c]},0)},getHeightOfExpanded:function(a){return 30*a+47+3},doesAllFit:function(a,b,c){return c<=a*b},haveRoomToExpandOne:function(a,c){var d=c.itemCount>1?10:0;return!b.isSmallDevice&&a.height>this.getHeightOf(c.itemCount-1)+89+d},getSize:function(a,b){return{width:a.innerWidth()-1,height:a.innerHeight(),dimensionCount:this.getDimensionCount(b)}},sizeChanged:function(a,b){return!angular.equals(a,b)},calculateColumns:function(a,c,d){var e=!b.isSmallDevice&&a.height>89,f=this.getMaxColumns(a),g=this.getMaxItemsPerColumn(a),h=this.getColumnItemsCount(c);if(e&&this.doesAllFit(g,f-c.length-1,a.dimensionCount-h-1))c.push({expand:!0,itemCount:1}),h+1<a.dimensionCount&&this.calculateColumns(a,c,d);else{var i;i=Math.min(a.dimensionCount-h,g),b.isSmallDevice?i=a.dimensionCount-h:d||(i=Math.ceil((a.dimensionCount-h)/(f-c.length)),i=Math.max(g,i),i=Math.min(a.dimensionCount-h,i)),c.push({expand:!1,itemCount:i}),c.length>=f&&g>0&&this.getColumnItemsCount(c)<a.dimensionCount&&(c[c.length-1].showAll=!0,38>a.height-this.getHeightOf(g)&&(c[c.length-1].itemCount=Math.max(c[c.length-1].itemCount-1,0))),this.getColumnItemsCount(c)<a.dimensionCount&&c.length<f&&this.calculateColumns(a,c,d)}},balanceColumns:function(a,b){var c,d,e;return c=b.filter(function(a){return a.expand}),d=b.filter(function(a){return a.expand===!1}),d.length>0&&!d[d.length-1].showAll&&this.haveRoomToExpandOne(a,d[d.length-1])?d[d.length-1].expand=!0:(e=this.getColumnItemsCount(d),d.forEach(function(a,b){var c,f;c=b<e%d.length?1:0,f=Math.floor(e/d.length)+c,a.itemCount=f},this)),d.concat(c)},getDimensions:function(a){return a.qChildList.qItems.map(function(a){return{id:a.qInfo.qId,expand:!1,height:void 0,responsiveMode:"full"}})},sortDimensions:function(a,b){var c;return c=a.qChildList.qItems.map(function(a){return a.qInfo.qId}),c.map(function(a){return b.filter(function(b){return b.id===a})[0]})},isValid:function(a){return!!a&&!!a.qChildList&&!!a.qChildList.qItems&&this.getDimensionCount(a)>0},mergeColumnsAndDimensions:function(a,b){return a.forEach(function(a){a.items=b.slice(0,a.itemCount),b=b.slice(a.itemCount)},this),a},reSizeArray:function(a,b,c,d){for(;a.length>b;)a.pop();for(;a.length<b;)a.push(c.extend(!0,{},d))},dimensionsEqual:function(a,b){return a.id===b.id&&a.expand===b.expand&&a.height===b.height},shouldDimensionBeUpdated:function(a,b){return!this.dimensionsEqual(a,b)},patchScope:function(a,b,c){this.resizeScopeArrays(a,b,c),a.columns.forEach(function(c,d,e){var f=b[d];e[d].showAll=f.showAll,e[d].expand=f.expand,e[d].itemCount=f.itemCount,c.items.forEach(function(b,c){var d=f.items[c];this.shouldDimensionBeUpdated(b,d)&&(d.expand||delete b.options,d.expand&&!b.options&&(b.options={isPopover:!1,isReadonly:a.object.isReadonly,interactionState:a.options.interactionState,card:a.options.card,selections:a.options.selections,navigation:a.options.navigation,direction:a.options.direction}),this.copyDimensionValues(d,b))},this)},this)},expandOne:function(a,b){var c,d,e;for(c=0;c<a.length;c++)if(d=a[c],d.cardinal&&!d.expand&&(e=this.getHeightOfExpanded(d.cardinal))<b)return d.expand=!0,d.height=e+"px",e+10;return!1},calculateExpandPriority:function(a,b){a.forEach(function(a){if(a.expand){var c,d,e=0,f=b.height-this.getHeightOf(a.itemCount-1)-10,g=0;if(a.items.forEach(function(a){a.cardinal=this.getDimensionCardinal(a)}.bind(this)),c=a.items.concat().sort(function(a,b){return a.cardinal-b.cardinal}),c.length>1){for(;f>89;){var h=this.expandOne(c,f);if(!h)break;e++,g+=h,f=b.height-this.getHeightOf(a.itemCount-e)-g}var i=c.filter(function(a){return a.expand});g=0,i.forEach(function(a){g+=this.getHeightOfExpanded(a.cardinal)+10},this),f=b.height-this.getHeightOf(a.itemCount-i.length)-g}if(d=c.filter(function(a){return!a.expand}),f>89&&d.length){var j=d[0],k=d.length>1?10:0;j.expand||(c.length>1&&(j.height=b.height-this.getHeightOf(d.length-1)-g-k+"px"),j.expand=!0)}}1===a.items.length&&b.height<30&&(a.items[0].responsiveMode=b.height<17?"spark":"small",a.items[0].height=b.height+"px")},this)},resolveAllModels:function(a,b,c,d){var e=[];return b.forEach(function(b,d){var f=a.columns[d]||{items:[]};b.items.forEach(function(a,b){var d=f.items[b]||{};this.shouldDimensionBeUpdated(a,d)||!d.model?e.push(c(a)):a.model=d.model},this)},this),d.all(e)},resizeScopeArrays:function(a,b,c){a.columns.length!==b.length&&this.reSizeArray(a.columns,b.length,c,{items:[]}),a.columns.forEach(function(d,e){d.items.length!==b[e].items.length&&this.reSizeArray(a.columns[e].items,b[e].items.length,c,{})},this)},copyDimensionValues:function(a,b){Object.keys(a).forEach(function(c){b[c]=a[c]})},getResolveModelFunction:function(a){return function(b){return this.resolveModel(b,a)}.bind(this)},resolveModel:function(a,b){return b.getObject(a.id).then(function(b){return a.model=b,b.getLayout()})}}})}),define("text!extensions.qliktech/filterpane/directives/collapsed-listbox/collapsed.ng.html",[],function(){
return'<div class="qv-collapsed-listbox"\n\t ng-class="{locked: isLocked, error: hasError, spark: responsiveMode == \'spark\', small: responsiveMode == \'small\', interactive: interactive}"\n\t qva-outside-ignore-for="{{outsideIgnoreName}}"\n\t qva-direction x-dir-setting="{{readDirection}}">\n\t<div class="error-layer"></div>\n\t<div class="title-wrapper">\n\t\t<span ng-if="isLocked" class="lui-icon lui-icon--lock" qva-direction x-dir-setting="{{readDirection}}"></span>\n\t\t<span ng-if="isDrillDown" class="lui-icon lui-icon--select-alternative" q-title-translation="Tooltip.dimensions.drilldown" x-dir-setting="{{readDirection}}"></span>\n\t\t<span class="title" ng-attr-title="{{title}}" qva-direction x-dir-setting="{{readDirection}}" x-dir-text="{{title}}">{{title}}</span>\n\t</div>\n\t<qv-state-count-bar ng-if="!hasError" state-counts="stateCounts" options="options"></qv-state-count-bar>\n</div>\n'}),define("extensions.qliktech/filterpane/directives/collapsed-listbox/collapsed",["qvangular","jquery","objects.models/listbox","text!./collapsed.ng.html","general.utils/responsive-state","client.views/state-count-bar/state-count-bar","objects/listbox-popover/listbox-popover-service","objects/listbox-popover/listbox-popover-service-mobile"],function(a,b,c,d,e){"use strict";a.directive("qvCollapsedListbox",function(){return{restrict:"E",replace:!0,template:d,scope:{model:"=",outsideIgnoreName:"=",responsiveMode:"=",interactive:"=",readDirection:"="},require:"^qv-collapsed-listbox-delegated-open",link:function(b){b.title="",b.hasError=!1,b.isLocked=!1,b.options={direction:b.readDirection},c.bindLayout(b,"model",function(c){a.$apply(b,function(){var a=c.qListObject.qDimensionInfo;b.hasError=!(!c.qListObject.qError&&!c.qListObject.qDimensionInfo.qError),b.stateCounts=a.qStateCounts,b.isLocked=a.qStateCounts.qLocked>0,b.isDrillDown="H"===a.qGrouping,b.title=c.title,b.id=c.qInfo.qId})})}}}),a.directive("qvCollapsedListboxDelegatedOpen",function(){return{restrict:"A",scope:{outsideIgnoreName:"=",interactive:"=?"},controller:["$scope","$element","qvListboxPopoverService","qvListboxPopoverServiceMobile",function(a,c,d,f){function g(a,b){return{left:a.position().left-b.position().left,top:a.position().top-b.position().top,right:b.width()-a.position().left-a.width(),bottom:b.height()-a.position().top-a.height()}}function h(a,b){var c=g(a,b);return Math.max(c.left,c.right)>Math.max(c.top,c.bottom)?c.left>c.right?"left":"right":c.top>c.bottom?"top":"bottom"}var i;c.on("qv-activate",".qv-collapsed-listbox:not(.error)",function(g){var j=angular.element(g.target).closest(".qv-collapsed-listbox"),k=j.isolateScope().model,l=j.isolateScope().id,m=j.isolateScope().options.direction,n={qvaOutsideIgnoreFor:a.outsideIgnoreName,$alignToElement:j,position:h(j,c),collision:"flipfit",direction:m};if(g.preventDefault(),a.interactive){if(l===i)return e.isSmallDevice?f.close():d.close(),void(i=void 0);i=l;var o,p=e.isSmallDevice?f.show(k,n):d.show(k,n);e.isSmallDevice||(p.closing.then(function(a){a&&!b(a.target).closest(".qv-collapsed-listbox").length>0&&(i=void 0),o=a}),p.closed.then(function(){p=null,o||(i=void 0)}))}})}]}})}),define("extensions.qliktech/filterpane/filterpane",["jquery","qvangular","util","core.utils/deferred","objects.backend-api/field-api","extensions.qliktech/filterpane/filterpane-properties","extensions.qliktech/filterpane/filterpane-handler","objects.utils/data-properties/listobject-util","client.utils/property-mapper","text!./filterpane.ng.html","objects.extension/base-controller","objects.extension/export-format","objects.extension/object-conversion","extensions.qliktech/filterpane/filterpane-layout","extensions.qliktech/filterpane/directives/collapsed-listbox/collapsed"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";function n(){return"filterpane-"+ ++p}function o(a){return a.columns.some(function(a){return a.items.some(function(a){return a.expand&&(!a.object||1!==a.object.renderState)})})}var p=0,q=k.extend({size:{},columns:[],expandable:!1,init:function(b,c,d,e){this.$scope=b,this.$element=c,this.$timeout=d,this.filterpaneLayout=e,b.object.throbberApi.off(),this.showThrobberTimeout=d(function(){b.object.throbberApi.show()},1e3),b.outsideIgnoreName=n(),b.columns=[],b.ext.expandable=function(){return this.expandable}.bind(this),b.options||(b.options={}),b.triggerFullScreen=function(){b.object.inAnalysisState()&&(a(".embedded-sheet-toolbar").length>0&&a(".embedded-sheet-toolbar").css("display","none"),b.$emit("zoomOnCell"))},b.$on("objectRenderStateChange",function(a,c){a.stopPropagation(),c&&!o(b)&&this.renderStateDfd.resolve()}.bind(this))},onPaint:function(){return this.renderStateDfd=d(),this.update(this.$scope.layout).then(function(){o(this.$scope)||this.renderStateDfd.resolve()}.bind(this)),this.renderStateDfd.promise},onResize:function(){return this.renderStateDfd=d(),this.update(this.$scope.layout).then(function(){o(this.$scope)||this.renderStateDfd.resolve()}.bind(this)),this.renderStateDfd.promise},update:function(a){var b,e=this.size,f=this.$scope,g=this.columns,h=this.$element,i=f.object.model.app,j=this.filterpaneLayout,k=j.getSize(h,a),l=j.getResolveModelFunction(i);return j.sizeChanged(e,k)&&(this.size=e=k,this.columns=g=this.getColumns(e)),j.isValid(a)?(b=j.getDimensions(a),b=j.sortDimensions(a,b),this.dimensions=b,this.preferredSizeDeferred&&this.preferredSizeDeferred.resolve(),g=j.mergeColumnsAndDimensions(g,b),j.resolveAllModels(f,g,l,d).then(function(){j.calculateExpandPriority(g,e),j.patchScope(f,g,c),this.$timeout.cancel(this.showThrobberTimeout),f.object.throbberApi.hide(),this.expandable=!f.columns.some(function(a){return a.items.some(function(a){var b=a.model;return b&&b.layout&&b.layout.qSelectionInfo&&b.layout.qSelectionInfo.qInSelections})}),f.hasExpanded=f.columns.some(function(a){return a.expand})}.bind(this))):(f.columns=g=[],d.resolve())},getColumns:function(a){var b=[];return this.filterpaneLayout.calculateColumns(a,b,this.$scope.options.zoomEnabled),this.filterpaneLayout.balanceColumns(a,b)},setInteractionState:function(a){this.$scope.interactive=this.$scope.object&&this.$scope.object.inAnalysisState()&&this.$scope.options.navigation!==!1&&this.$scope.options.selections!==!1,this.$scope.columns.forEach(function(b){b.items.forEach(function(b){b.expand&&b.object.setInteractionState(a)})})},setDirection:function(a){this.$scope.options&&(this.$scope.options.direction=a),this.$scope.columns.forEach(function(b){b.items.forEach(function(b){b.expand&&b.object.setDirection(a)})})},getPreferredSize:function(){var a=d();this.preferredSizeDeferred&&this.preferredSizeDeferred.reject(),this.preferredSizeDeferred=d();var b=this;return this.preferredSizeDeferred.promise.then(function(){b.preferredSizeDeferred=null,a.resolve({w:b.$element.width(),h:b.filterpaneLayout.getHeightOf(b.dimensions.length)})}),this.dimensions&&this.preferredSizeDeferred.resolve(),a.promise}});return q.$inject=["$scope","$element","$timeout","qvFilterpaneLayout"],{type:"filterpane",template:j,BackendApi:e,controller:q,definition:f,initialProperties:{qChildListDef:{qData:{info:"/qInfo"}}},data:{dimensions:{min:1,max:1e3}},expandable:function(){return!1},mapProperties:function(){this.mappedDefinition=i.mapDefinition(this.definition,this.type),this.dimensionDefinition={min:1}},getCreatePropertyHandler:function(a){return new g({app:a,dimensionDefinition:this.dimensionDefinition})},addFieldDimension:function(a,c){return c.model.getProperties().then(function(d){var e=c.getCreatePropertyHandler();return e.setProperties(d),e.setModel(c.model),e.addFieldDimension(a.value,a.displayName).then(function(a){b.$rootScope.$broadcast("pp-open-path","data."+a.qDef.cId)})})},addLibraryDimension:function(a,c){return c.model.getProperties().then(function(d){var e=c.getCreatePropertyHandler();return e.setProperties(d),e.setModel(c.model),e.addLibraryDimension(a.libraryId).then(function(a){b.$rootScope.$broadcast("pp-open-path","data."+a.qDef.cId)})})},getDropFieldOptions:function(a,c,d){c.getDimensions().length<c.maxDimensions()&&(c.setModel(d),c.addFieldDimension(a.item.name,a.item.displayName).then(function(a){d.setProperties(c.properties),b.$rootScope.$broadcast("pp-open-path","data."+a.qDef.cId)}))},getDropDimensionOptions:function(a,c,d){c.getDimensions().length<c.maxDimensions()&&(c.setModel(d),c.addLibraryDimension(a.item.id).then(function(a){d.setProperties(c.properties),b.$rootScope.$broadcast("pp-open-path","data."+a.qDef.cId)}))},getDropMeasureOptions:function(a,b,c,d){d()},getExportRawDataOptions:function(a,c,e){c.model.getLayout().then(function(f){if(1===f.qChildList.qItems.length)return a.addItem({translation:"contextMenu.export",tid:"export",icon:"lui-icon lui-icon--export",select:function(){c.model.app.getObject(f.qChildList.qItems[0].qInfo.qId).then(function(a){b.getService("$exportDialog").show(a)})}}),void e.resolve();var g=[],h=a.addItem({translation:"contextMenu.export",tid:"export-submenu",icon:"lui-icon lui-icon--export"});h.addItem({translation:"Export.AllDimensions",tid:"export-all-dimensions",select:function(){b.getService("$exportDialog").show(c.model)}}),f.qChildList.qItems.forEach(function(a){g.push(c.model.app.getObject(a.qInfo.qId).then(function(a){return a.getLayout().then(function(c){h.addItem({translation:c.title,tid:"export",select:function(){b.getService("$exportDialog").show(a)}})})}))}),d.all(g).then(e.resolve)})},exportProperties:function(a){var b,c,d,e,f,g=new l,h=a.qProperty,i=g.data[0];for(c=0;c<a.qChildren.length;++c)b=a.qChildren[c].qProperty,i.dimensions.push({qDef:b.qListObjectDef.qDef,qLibraryId:b.qListObjectDef.qLibraryId,qOtherTotalSpec:b.qListObjectDef.qOtherTotalSpec||{qOtherMode:"OTHER_OFF",qOtherCounted:{qv:"10"}},title:b.title});if(h.qLayoutExclude&&h.qLayoutExclude.qHyperCubeDef){if(h.qLayoutExclude.qHyperCubeDef.qDimensions)for(c=0;c<h.qLayoutExclude.qHyperCubeDef.qDimensions.length;++c)i.excludedDimensions.push(h.qLayoutExclude.qHyperCubeDef.qDimensions[c]);if(h.qLayoutExclude.qHyperCubeDef.qMeasures)for(c=0;c<h.qLayoutExclude.qHyperCubeDef.qMeasures.length;++c)i.excludedMeasures.push(h.qLayoutExclude.qHyperCubeDef.qMeasures[c]);if(h.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder)for(c=0;c<h.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder.length;++c)i.interColumnSortOrder.push(h.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder[c])}for(e in h)"qChildListDef"!==e&&(g.properties[e]=h[e]);if(h.qLayoutExclude||(h.qLayoutExclude={}),h.qLayoutExclude.disabled){for(e in h.qLayoutExclude.disabled)f=e,g.properties.hasOwnProperty(f)||(g.properties[f]=h.qLayoutExclude.disabled[e]);h.qLayoutExclude.disabled.previousShowTitles&&(g.properties.showTitles=!0)}for(delete h.qLayoutExclude,c=0;c<i.dimensions.length;++c)for(d=0;d<i.dimensions[c].qDef.qSortCriterias.length;++d)i.dimensions[0].qDef.qSortCriterias[d].qSortByFrequency=0,i.dimensions[0].qDef.qSortCriterias[d].qSortByState=0;return g},importProperties:function(a,b){var d,e,f={qChildren:[]},g={},i=a.data[0];g.qLayoutExclude||(g.qLayoutExclude={}),g.qLayoutExclude.disabled={};for(d in a.properties)"qLayoutExclude"===d?a.properties[d].quarantine&&(g.qLayoutExclude.quarantine=c.extend(!0,{},a.properties[d].quarantine)):b.hasOwnProperty(d)||"qMetaDef"===d?g[d]=a.properties[d]:g.qLayoutExclude.disabled[d]=a.properties[d];for(g=c.extend(!0,{},b,g),e=0;e<i.dimensions.length;++e)f.qChildren.length<1e3?f.qChildren.push({qProperty:h.createDefaultListBox(i.dimensions[e],i.dimensions[e].title),qChildren:[]}):(g.qLayoutExclude||(g.qLayoutExclude={}),g.qLayoutExclude.qHyperCubeDef||(g.qLayoutExclude.qHyperCubeDef={}),g.qLayoutExclude.qHyperCubeDef.qDimensions||(g.qLayoutExclude.qHyperCubeDef.qDimensions=[]),g.qLayoutExclude.qHyperCubeDef.qDimensions.push(i.dimensions[e]));if(i.measures.length)for(g.qLayoutExclude.qHyperCubeDef||(g.qLayoutExclude.qHyperCubeDef={}),g.qLayoutExclude.qHyperCubeDef.qMeasures||(g.qLayoutExclude.qHyperCubeDef.qMeasures=[]),e=0;e<i.measures.length;++e)g.qLayoutExclude.qHyperCubeDef.qMeasures.push(i.measures[e]);for(e=0;e<i.excludedDimensions.length;++e)f.qChildren.length<1?f.qChildren.push({qProperty:h.createDefaultListBox(i.excludedDimensions[e],i.excludedDimensions[e].title),qChildren:[]}):(g.qLayoutExclude.qHyperCubeDef||(g.qLayoutExclude.qHyperCubeDef={}),g.qLayoutExclude.qHyperCubeDef.qDimensions||(g.qLayoutExclude.qHyperCubeDef.qDimensions=[]),g.qLayoutExclude.qHyperCubeDef.qDimensions.push(i.excludedDimensions[e]));for(e=0;e<i.excludedMeasures.length;++e)g.qLayoutExclude.qHyperCubeDef||(g.qLayoutExclude.qHyperCubeDef={}),g.qLayoutExclude.qHyperCubeDef.qMeasures||(g.qLayoutExclude.qHyperCubeDef.qMeasures=[]),g.qLayoutExclude.qHyperCubeDef.qMeasures.push(i.excludedMeasures[e]);for(e=0;e<i.interColumnSortOrder.length;++e)g.qLayoutExclude.qHyperCubeDef&&(g.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder||(g.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder=[]),g.qLayoutExclude.qHyperCubeDef.qInterColumnSortOrder.push(i.interColumnSortOrder[e]));return m.importCommonProperties(g,a,b),g.showTitles&&(g.qLayoutExclude.disabled.previousShowTitles=!0,g.showTitles=!1),f.qProperty=g,f}}}),define("text!extensions.qliktech/text-image/text-image.ng.html",[],function(){return'<div class="qv-ti" style=\'width: 100%; height: 100%;\' qva-activate="edit()">\n\t<div class="media-tool-scrollbar" ng-if="!editing && !initializing && !saving && !empty" dir="{{ direction }}">\n\t\t<div class="qv-media-tool-html" ng-class="[sizeClass, visibilityClass, responsiveClass, {\'qv-interactive\': navigation}]" ng-click="clickHtml($event)" ng-bind-html="html" dir="{{ textDirection }}"></div>\n\t</div>\n\t<div class="text-image-hint" ng-if="empty && !editing" ng-class="{ \'selected\': isSelected() }">\n\t\t<div class="hint-content" ng-show="!isSelected() || !editmode || object.isLink">\n\t\t\t<i class="hint-icon lui-icon lui-icon--text"></i>\n\t\t\t<div class="text" q-translation="Object.TextImage.EmptyHint"></div>\n\t\t</div>\n\t\t<div class="hint-content" ng-show="isSelected() && editmode && !object.isLink">\n\t\t\t<i class="hint-icon lui-icon lui-icon--plus"></i>\n\t\t\t<div class="text" q-translation="Object.TextImage.EmptySelectedHint"></div>\n\t\t</div>\n\t</div>\n\t<div class="qv-media-tool-editor" ng-class="[sizeClass, visibilityClass, responsiveClass]" ng-if="initializing || editing || saving" qv-text-image-editor x-editor-options="editorOptions" x-save="save" dir="{{ direction }}" qva-outside-ignore-for="media-toolbar"></div>\n</div>'}),define("extensions.qliktech/text-image/text-image-properties",["client.utils/property-resolver"],function(a){return{type:"items",component:"accordion",items:{data:{uses:"data",items:{measures:{disabledRef:""},dimensions:{disabledRef:""}}},settings:{uses:"settings",items:{general:{items:{showTitles:{defaultValue:!1}}},presentation:{type:"items",translation:"properties.presentation",items:{responsive:{type:"string",component:"dropdown",ref:"responsive",translation:"properties.textImage.responsive",defaultValue:"all",undefinedValue:"none",snapshot:{tid:"property-responsive"},options:[{value:"all",translation:"properties.textImage.responsive.textImages"},{value:"text",translation:"properties.textImage.responsive.text"},{value:"images",translation:"properties.textImage.responsive.images"},{value:"none",translation:"properties.textImage.responsive.none"}]}}},markdown:{type:"string",ref:"markdown",show:!1,defaultValue:""},images:{type:"array",ref:"images",show:!1,defaultValue:[]},backgroundImage:{type:"items",translation:"properties.backgroundImage",grouped:!0,items:{useBackgroundImage:{ref:"background.isUsed",type:"boolean",translation:"properties.backgroundImage.use",component:"switch",defaultValue:!1,options:[{value:!0,translation:"properties.on"},{value:!1,translation:"properties.off"}]},backgroundUrl:{ref:"background.url.qStaticContentUrlDef.qUrl",layoutRef:"background.url.qStaticContentUrl.qUrl",schemaIgnore:!0,translation:"Common.Image",tooltip:{select:"properties.media.select",remove:"properties.media.removeBackground"},type:"string",component:"media",defaultValue:"",show:function(b){return a.getValue(b,"background.isUsed")}},backgroundSize:{ref:"background.size",translation:"properties.backgroundImage.size",type:"string",component:"dropdown",defaultValue:"auto",options:[{value:"auto",translation:"properties.backgroundImage.originalSize"},{value:"alwaysFit",translation:"properties.backgroundImage.sizeAlwaysFit"},{value:"fitWidth",translation:"properties.backgroundImage.sizeFitWidth"},{value:"fitHeight",translation:"properties.backgroundImage.sizeFitHeight"},{value:"fill",translation:"properties.backgroundImage.sizeStretch"}],show:function(b){return a.getValue(b,"background.isUsed")&&a.getValue(b,"background.url.qStaticContentUrlDef.qUrl")}},backgroundPosition:{ref:"background.position",translation:"Common.Position",type:"string",component:"align-matrix",defaultValue:"topLeft",show:function(b){return a.getValue(b,"background.isUsed")&&a.getValue(b,"background.url.qStaticContentUrlDef.qUrl")&&"fill"!==a.getValue(b,"background.size")},currentSize:function(b){return a.getValue(b,"background.size")}}}}}}}}}),define("extensions.qliktech/text-image/measure-utils",["general.utils/array-util","util"],function(a,b){function c(a,b){var c,d,e,f=[],g=[];for(c=a.map(function(a){return a.qDef.cId}),d=b.map(function(a){return a.qDef.cId}),e=d.length-1;e>=0;--e)c.contains(d[e])||f.push({index:e,id:d[e],measure:b[e]});for(e=0;e<c.length;++e)d.contains(c[e])?c.lastIndexOf(c[e])!==e&&g.push({index:e,id:c[e],measure:a[e]}):g.push({index:e,id:c[e],measure:a[e]});return{removed:f,added:g}}function d(a,b){return b.replace(/=\[(\w*?)]\((\w*?)\)/g,function(b,c,d){return a===d?"":b})}function e(a,b,c,d){var e=-1;return c.replace(/=\[(\w*?)]\((\w*?)\)/g,function(c,f,g){if(g===a){++e;var h=void 0!==d;if(!h||h&&e===d)return"=["+f+"]("+b+")"}return c})}function f(d,f){var g=f.qHyperCubeDef.qMeasures,h=c(d,g);h.removed.forEach(function(b){var c=b.index;g.splice(c,1),a.indexRemoved(f.qHyperCubeDef.qInterColumnSortOrder,f.qHyperCubeDef.qDimensions.length+c)}),h.added.forEach(function(c){var d=c.measure.qDef.cId,h=b.generateId();c.measure.qDef.cId=h,g.push(c.measure),a.indexAdded(f.qHyperCubeDef.qInterColumnSortOrder,f.qHyperCubeDef.qDimensions.length+g.length-1),f.markdown=e(d,h,f.markdown,1)})}return{removeMeasure:d,replaceMeasure:e,syncMeasures:f}}),define("extensions.qliktech/text-image/image-utils",["client.services/media-tool/markdown-html-parser","general.utils/paths","util"],function(a,b,c){function d(a,b){var c,d=[],e=[],f=a.map(function(a){return a.id||""}),g=b.map(function(a){return a.id});for(c=g.length-1;c>=0;--c)f.contains(g[c])||d.push({index:c,id:g[c],url:b[c].url});for(c=0;c<f.length;++c)g.contains(f[c])?f.lastIndexOf(f[c])!==c&&e.push({index:c,id:f[c],url:function(a){for(var c=0;c<b.length;c++)if(b[c].id===a)return b[c].url.qStaticContentUrlDef.qUrl;return null}(f[c])}):e.push({index:c,id:f[c],url:a[c].url});return{removed:d,added:e}}function e(a,b,c,d){var e=-1;return c.replace(/!\[(\w*?)]\((.*?)\)/g,function(c,f,g){if(f===a){++e;var h=void 0!==d;if(!h||h&&e===d)return"!["+b+"]("+g+")"}return c})}function f(f,g){g.images||(g.images=[]);var h=g.images,i=d(f,h);i.removed.forEach(function(a){var b=a.index;h.splice(b,1)}),i.added.forEach(function(d){var f=d.id,i=c.generateId(),j=a.unescapeMarkdown(d.url);j=b.stripBasePath(j),h.push({id:i,url:{qStaticContentUrlDef:{qUrl:j}}}),g.markdown=f?e(f,i,g.markdown,1):e(f,i,g.markdown,0)})}return{syncImages:f}}),define("client.utils/rtl/bidirectional-input-service",["jquery","client.utils/rtl/rtl-util","client.utils/rtl/direction-service"],function(a,b,c){"use strict";function d(a){return a.is("textarea,input")&&0===a.val().length||""===a[0].textContent&&0===a.has("img").length}function e(a,b){d(a)?a.css("direction",b):"rtl"!==a.css("direction")&&"ltr"!==a.css("direction")||a.css("direction","")}function f(c,d,f){c.find("div,p").each(function(c,g){d?"auto"!==g.getAttribute("dir")&&g.setAttribute("dir","auto"):g.setAttribute("dir",b.detectTextDirection(g.innerText)),e(a(g),f)})}var g={},h=b.supportDirAuto();return g.enable=function(d,g){var i=a(d);e(i,c.direction),i.attr("dir",b.getAutoOrAlternativeDirection(i[0].innerText)),g&&(i.attr("x-auto-direction-for-paragraphs",""),f(i,h,c.direction)),i.on("keyup",function(){h||i.attr("dir",b.detectTextDirection(i[0].innerText)),g&&f(i,h,c.direction),e(i,c.direction)})},g}),define("extensions.qliktech/text-image/text-image",["jquery","qvangular","core.utils/deferred","lz-string","text!./text-image.ng.html","./text-image-properties","objects.backend-api/hypercube-api","client.services/media-tool/media-tool-service","general.utils/string-limits","./measure-utils","./image-utils","client.utils/rtl/rtl-util","general.utils/paths","core.utils/resize","client.utils/rtl/bidirectional-input-service"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(a){return a.background&&a.background.isUsed&&a.background.url&&a.background.url.qStaticContentUrl&&a.background.url.qStaticContentUrl.qUrl||""}function q(d,e){var f=b.getService("$timeout"),g=e.find(".qv-media-tool-html")[0];return"none"===d.responsive||void 0===d.responsive?f(function(){d.sizeClass="",d.sizeStyle={maxWidth:"",maxHeight:""},a(g).find("img").css(d.sizeStyle),d.visibilityClass="",d.responsiveClass=""},0):(d.sizeClass="",d.visibilityClass="hidden","images"===d.responsive?d.responsiveClass="responsive-images":"text"===d.responsive?d.responsiveClass="responsive-text":d.responsiveClass="responsive-images responsive-text",g?f(function(){d.sizeClass="",d.sizeStyle={maxWidth:"100%",maxHeight:"100%"},a(g).find("img").css(d.sizeStyle),a(g).addClass("default-font-size");var b=g.scrollHeight/g.clientHeight;a(g).removeClass("default-font-size"),b>1&&(d.sizeStyle={maxWidth:Math.floor(1/b*100)+"%",maxHeight:Math.floor(1/b*100)+"%"},a(g).find("img").css(d.sizeStyle)),d.sizeClass=b>3?"bp-4":b>2?"bp-3":b>1.5?"bp-2":b>1?"bp-1":"",d.visibilityClass=""},10):(d.visibilityClass="",c.resolve()))}function r(a){return!h.hasContent(a)||""===a.trim()}function s(a){var b=0;if(document.createRange){var c=document.createRange();if(c.selectNodeContents(a),c.getBoundingClientRect){var d=c.getBoundingClientRect();d&&(b=d.bottom-d.top)}}return b}function t(a){return!r(a.markdown)||p(a)}var u,v,w=b.getService("$sce");return u={auto:"auto auto",alwaysFit:"contain",fitWidth:"100% auto",fitHeight:"auto 100%",fill:"100% 100%"},v={topLeft:"0% 0%",centerLeft:"50% 0%",bottomLeft:"100% 0%",topCenter:"0% 50%",centerCenter:"50% 50%",bottomCenter:"100% 50%",topRight:"0% 100%",centerRight:"50% 100%",bottomRight:"100% 100%"},b.directive("qvTextImageEditor",[function(){return{restrict:"A",scope:{editorOptions:"=",save:"="},link:function(b,c){h.show(c,b.editorOptions),c.on("qv-outside",function(c){a(c.target).closest(".qv-texttool-toolbar, .modal-container, .qui-immidiateContextual, .lui-popover").length||b.save()}),b.$on("$destroy",function(){b.save(),h.hide()})}}}]),{type:"text-image",BackendApi:g,definition:f,initialProperties:{qHyperCubeDef:{qDimensions:[],qMeasures:[],customErrorMessage:{calcCond:""}},images:[],markdown:"",background:{url:{},size:"auto"}},data:{measures:{min:0,max:1e3,add:function(a,b){b.markdown+="=[]("+a.qDef.cId+")"},remove:function(a,b){b.markdown=j.removeMeasure(a.qDef.cId,b.markdown)},replace:function(a,b,c,d){d.markdown=j.replaceMeasure(b.qDef.cId,a.qDef.cId,d.markdown)}}},support:{cssScaling:!0,snapshot:t,export:t,exportData:!0,sharing:!1},exportProperties:null,importProperties:null,template:e,showRequirements:function(){return!1},getDropMeasureOptions:function(a,b,c,d){b.getMeasures().length<b.maxMeasures()?"expression"===a.item.type?b.addExpressionMeasure(a.item.name,"").then(function(){c.setProperties(b.properties)}):b.addLibraryMeasure(a.item.id).then(function(){c.setProperties(b.properties)}):(a.ReplaceMeasures(c,b),d())},controller:["$scope","$element",function(e,f){function g(){var a=h.getEditorElement();o.enable(a,!0)}function t(a){var b=[];return a.find(".tokenized-measure").each(function(a,c){var e=c.getAttribute("data-measure");e=d.decompressFromBase64(e),b.push(JSON.parse(e))}),b}function x(a){function b(a){for(var b=h.getOptions().insertedImages,c=0;c<b.length;c++)if(b[c].url===a)return b[c].urlDef;return null}var c=[];return a.find("img:not(.tokenized-measure)").map(function(a,d){var e=d.getAttribute("data-image-id"),f=d.getAttribute("src"),g=b(f);g||(g=d.getAttribute("src")),c.push({id:e,url:g})}),c}function y(){b.$apply(e,function(){e.editing=!1})}var z=f.find(".qv-ti");e.isSelected=function(){return e.options.isActive||e.options.isZoomed},e.$watch("editing",function(a){e.object.preventDrag=a}),e.edit=function(){!e.object.inEditState()||e.editing||e.object.isLink||e.isSelected()&&(e.saving=!1,e.saved=!1,e.backendApi.getProperties().then(function(a){var b=e.object.getCreatePropertyHandler();b.setProperties(a),e.editorOptions={markdown:a.markdown,maxlength:i.textImage,toolbar:{style:"popover",buttons:"all",width:561},useMeasures:!0,layout:e.backendApi.model.layout,properties:a,propertyHandler:b,copiedMeasures:[],insertedImages:[],onOpen:function(a){a.saveRange(),e.$apply(function(){e.editing=!0,e.initializing=!1}),setTimeout(function(){g()},0)},isActive:function(){return e.editing||e.initializing}},e.initializing=!0}))},e.save=function(){if(!e.saving&&!e.saved){h.closing();var a=h.getMarkdown(),b=h.getEditorElement();if(null!==a&&a!==e.markdown){e.saving=!0;var c=h.getOptions().properties;c.markdown=a,j.syncMeasures(t(b),c),k.syncImages(x(b),c),e.backendApi.model.setProperties(c),e.saved=!0}else e.editing=!1}},e.clickHtml=function(b){!e.navigation&&a(b.target).closest("a").length&&b.preventDefault()},this.onPaint=function(a){var d="",f="",g="",i="",j=[];if(e.finishRender=!1,e.saving&&(e.editing=!1,e.saving=!1),d=p(a)){m.stripBasePath(d),d=d.replace(/"/g,'\\"'),d=d.replace(/'/g,"\\'"),f=m.getUrl(d),g=u[a.background.size]||u.auto,i=v[a.background.position]||v.topLeft;var k=new Image,n=c();j.push(n.promise),k.onload=function(){n.resolve()},k.onerror=function(){n.resolve()},k.src=f,k.complete&&(k.onload=null,k.onerror=null,n.resolve())}return z.css({backgroundImage:"url('"+f+"')",backgroundSize:g,backgroundPosition:i,backgroundRepeat:"no-repeat"}),e.empty=r(a.markdown)&&!d,e.html=w.trustAsHtml(h.toHTML(a.markdown,a,!0)),e.direction=this.view.options.direction,e.textDirection=l.getAutoOrAlternativeDirection(a.markdown),e.markdown=a.markdown,e.responsive=a.responsive,q(e,z).then(function(){return b.getService("$timeout")(function(){if(z.find("img").each(function(a,b){b.complete||function(a){var b=c();j.push(b.promise),a.onload=function(){b.resolve()},a.onerror=function(){b.resolve()}}(b)}),j.length)return c.all(j).then(function(a){return q(e,z).then(function(){return e.finishRender=!0,a})});e.finishRender=!0},0,!1)}).then(function(){e.backendApi.isSnapshot&&(a.snapshotData.scrollTopPercent&&z.closest(".qv-object-content").css("top",-a.snapshotData.scrollTopPercent+"%"),a.snapshotData.verticalScrollWidth&&z.find(".qv-media-tool-html").css("padding-right",a.snapshotData.verticalScrollWidth+"px")),c().resolve()})},this.onResize=function(){return this.onPaint.apply(this,arguments)},this.setInteractionState=function(a){this._super(a),e.navigation=(e.options.navigation||e.options.limitedInteraction)&&e.object.inAnalysisState(),e.editmode=e.object.inEditState(),e.editmode||(e.editing=!1)},this.getPreferredSize=function(){var a=c(),b=e.$watch("finishRender",function(c){if(c===!0){var d=0;z.find(".qv-media-tool-html").contents().each(function(){d+=3===this.nodeType?s(this):this.offsetHeight,"BR"===this.nodeName&&(d+=8)}),a.resolve({w:z.width(),h:d}),b()}});return a.promise},this.setSnapshotData=function(b){if(e.backendApi.isSnapshot)e.object.layout.snapshotData.scrollTopPercent&&(b.snapshotData.scrollTopPercent=e.object.layout.snapshotData.scrollTopPercent);else{var c=z.find(".qv-media-tool-html")[0];b.snapshotData.scrollTopPercent=c.scrollTop/c.clientHeight*100,b.snapshotData.verticalScrollWidth=a(c).innerWidth()-c.clientWidth}},n.on("start",y),e.$on("$destroy",function(){n.off("start",y)})}],getDropFieldOptions:function(a,b,c,d,e){a.AddFieldAsMeasure(c,b,e),d()},getDropDimensionOptions:function(a,b,c,d){d()}}}),define("objects.backend-api/pivot-api",["./backend-api"],function(a){"use strict";function b(a,b,c){var d,e,f,g=[];for(e=0;e<b.length;e++)for(d=0;d<a.length;d++)f={qType:c,qCol:b[e],qRow:a[d]},g.push(f);return g}return a.extend("PivotApi",{init:function(a){this._super(a,"/qHyperCubeDef",{mode:"P"}),this.cacheCube.setMethodName("getHyperCubePivotData")},updateCache:function(a){a&&a.qHyperCube&&"P"===a.qHyperCube.qMode?(this.cacheCube.set(a.qHyperCube.qPivotDataPages),this.cacheCube.setCubeSize(a.qHyperCube.qSize)):this.cacheCube.clear(),this.backendStackThrottle.clear()},getData:function(a){switch(this.model.layout.qHyperCube.qMode){case"P":return this.cacheCube.getData(a);default:throw"you are using a non-supported backend-api"}},getReducedData:function(a,b,c){return c=void 0!==c?c:"D1",this.model.getHyperCubeReducedData(this.path,a,b,c)},select:function(a,c,d){switch(this.model.layout.qHyperCube.qMode){case"P":return this.model.selectPivotCells(this.path,b(a,c,d));default:throw"you are using a non-supported backend-api"}},expandTop:function(a,b,c){return this.model.expandTop(this.path,a,b,c)},expandLeft:function(a,b,c){return this.model.expandLeft(this.path,a,b,c)},collapseTop:function(a,b,c){return this.model.collapseTop(this.path,a,b,c)},collapseLeft:function(a,b,c){return this.model.collapseLeft(this.path,a,b,c)},clearSelections:function(){return this.model.resetMadeSelections()},hasSelections:function(){return this.model.layout.qSelectionInfo.qMadeSelections},getSize:function(){return this.model.layout.qHyperCube.qSize}})}),define("extensions.qliktech/pivot-table/pivot-table-properties",["client.property-panel/default-properties","client.utils/property-resolver","util","translator"],function(a,b,c,d){function e(a,b,c){if(!c.properties.qHyperCubeDef.qIndentMode)return!0;var d,e=c.properties.qHyperCubeDef.qInterColumnSortOrder.indexOf(-1),f=c.properties.qHyperCubeDef.qNoOfLeftDims;return e>-1&&e<f&&f--,0===(d=c.properties.qHyperCubeDef.qDimensions.indexOf(a))||d>=f}var f,g,h;f={uses:"settings",items:{presentation:{type:"items",translation:"properties.presentation",items:{alwaysFullyExpanded:{ref:"qHyperCubeDef.qAlwaysFullyExpanded",type:"boolean",translation:"properties.pivot.fullyExpanded",defaultValue:!1},indentMode:{ref:"qHyperCubeDef.qIndentMode",type:"boolean",translation:"properties.pivot.indentMode"}}}}},g={type:"items",translation:"properties.sorting",items:{defaultSorting:{uses:"sorting",items:{dimensions:{showPriority:!1,allowMove:!1},measures:{included:!1}}}}};var i={type:"items",component:"pivot-data",translation:"properties.data",addTranslation:"Properties.AddData",items:{dimensions:c.extend(!0,{},a.dimensions,{items:{globalGrouping:{type:"boolean",translation:"properties.dimensionLimits.globalGrouping",ref:"qOtherTotalSpec.qGlobalOtherGrouping",defaultValue:!1,show:function(a){return"OTHER_OFF"!==b.getValue(a,"qOtherTotalSpec.qOtherMode")}},totalMode:{type:"string",component:"switch",translation:"properties.showTotals",ref:"qOtherTotalSpec.qTotalMode",defaultValue:"TOTAL_OFF",trueOption:{value:"TOTAL_EXPR",translation:"properties.on"},falseOption:{value:"TOTAL_OFF",translation:"properties.off"},show:e},totalsLabel:{type:"string",component:"expression",expressionType:"StringExpr",ref:"qTotalLabel",translation:"properties.totals.label",defaultValue:function(){return d.get("Object.Table.Totals")},show:function(a,c,d){return"TOTAL_OFF"!==b.getValue(a,"qOtherTotalSpec.qTotalMode")&&e(a,c,d)}}}}),measures:c.extend(!0,{},a.measures,{items:{tableColorBgByExpression:{component:"expression",expressionType:"measure",ref:"qAttributeExpressions.0.qExpression",translation:"Object.Table.Measure.BackgroundExpression",defaultValue:""},tableColorByExpression:{
component:"expression",expressionType:"measure",ref:"qAttributeExpressions.1.qExpression",translation:"Object.Table.Measure.ForegroundExpression",defaultValue:"",change:function(a){void 0===a.qAttributeExpressions[0]&&(a.qAttributeExpressions[0]={})}}}})}};return h={type:"items",component:"expandable-items",translation:"properties.addons",items:{dataHandling:{uses:"dataHandling"}}},{type:"items",component:"accordion",items:{data:i,sorting:g,addons:h,settings:f}}}),define("extensions.qliktech/pivot-table/pivot-sorting-util",["general.utils/array-util"],function(a){function b(a){var b=a.qDimensions;c(b,a.qInterColumnSortOrder)&&(a.qInterColumnSortOrder=function(){for(var c=[],d=0;d<b.length;d++)c.push(d);return a.qMeasures.length>=2&&c.push(-1),c}())}function c(a,b){var c={},d=[],e=!1,f=b.indexOf(-1)!==-1;b.forEach(function(a){c[a]?e=!0:c[a]=!0}),e=f?e||a.length+1!==Object.keys(c).length:e||a.length!==Object.keys(c).length,Object.keys(c).forEach(function(a){"-1"!==a&&d.push(parseInt(a,10))}),d=d.sort(function(a,b){return a-b});for(var g=0;g<d.length;++g)e=e||d[g]!==g;return e}function d(c){b(c);var d,e=c.qDimensions,f=c.qInterColumnSortOrder;d=f.filter(function(a){return a!==-1}),function(){for(var b=0;b<d.length;b++)if(d[b]!==-1&&d[b]!==b){var c=d[b],g=d.indexOf(b),h=d[g];a.swap(d,b,g),a.swap(e,b,g),a.swap(f,f.indexOf(c),f.indexOf(h))}}()}function e(a,b){var c=a.qDimensions,d=a.qInterColumnSortOrder,e=[],g=b.indexOf(-1);b.forEach(function(a){a!==-1&&e.push(c[a])}),e.forEach(function(a,b){c[b]=a}),d.splice(0,d.length);for(var h=0;h<e.length;h++)d.push(h);g>-1&&d.splice(g,0,-1),f(a,b)}function f(a,b){if(a.columnWidths&&!(a.columnWidths.length<2)){var c=a.columnWidths[1],d=[];b.forEach(function(a){a!==-1&&d.push(c[a])}),d.forEach(function(a,b){c[b]=a})}}function g(a,b){var c=a.qMeasures,d=[];b.forEach(function(a){d.push(c[a])}),c.splice(0,c.length),d.forEach(function(a){c.push(a)})}return{validatePivotHyperCube:b,fixPivotHypercubeOrders:d,reorderPivotDimensions:e,reorderMeasures:g,isInvalidOrderArray:c}}),define("extensions.qliktech/pivot-table/pivot-hypercube-handler",["objects.utils/data-properties/hypercube-handler","core.utils/deferred","general.utils/array-util","extensions.qliktech/pivot-table/pivot-sorting-util","util"],function(a,b,c,d,e){"use strict";return a.extend({addDimension:function(a,c){var f=this.getDimensions(),g=this;if(a.qDef.cId||(a.qDef.cId=e.generateId()),f.length<this.maxDimensions())return this.autoSortDimension(a).then(function(){var e,h,i=g.hcProperties.qNoOfLeftDims,j=f.length;return d.fixPivotHypercubeOrders(g.hcProperties),e=g.hcProperties.qInterColumnSortOrder,h=e.indexOf(-1),c||i!==-1?!c&&i>=0?(h>=i?(e.splice(h,1),e.push(j),e.splice(h+1,0,-1)):(h!==-1&&--i,e.push(j)),f.splice(i,0,a),g.hcProperties.qNoOfLeftDims++):(0===j&&(g.hcProperties.qNoOfLeftDims=0),e.push(j),f.push(a)):(g.hcProperties.qNoOfLeftDims=1,e.unshift(j),f.splice(0,0,a)),b.resolve(a)})},removeDimension:function(a){var e,f,g,h=this.getDimensions(),i=this.properties.qHyperCubeDef.qNoOfLeftDims,j=this.hcProperties.qInterColumnSortOrder;for(g=0;g<j.length;g++)if(j[g]===a){f=g;break}f+1<=i&&this.properties.qHyperCubeDef.qNoOfLeftDims--;var k=this.properties.qHyperCubeDef.columnWidths?this.properties.qHyperCubeDef.columnWidths[1]:void 0;return Array.isArray(k)&&k.length>a&&k.splice(a,1),e=h.splice(a,1)[0],c.indexRemoved(this.hcProperties.qInterColumnSortOrder,a),d.fixPivotHypercubeOrders(this.hcProperties),b.resolve(e)},addMeasure:function(a){var c=this.getMeasures(),d=this;if(a.qDef.cId||(a.qDef.cId=e.generateId()),delete a.qDef.qNumFormat,c.length<this.maxMeasures()){var f=1===c.length;return c.push(a),this.autoSortMeasure(a).then(function(){return f&&d.hcProperties.qInterColumnSortOrder.push(-1),a})}if(c.length<1e3)return this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures.push(a),b.resolve(a)},removeMeasure:function(a){var c,d,e,f=this.getMeasures();if(a<f.length){if(c=2===f.length,d=this.hcProperties.qMeasures.splice(a,1)[0],c){var g=this.hcProperties.qInterColumnSortOrder;e=g.indexOf(-1),g.splice(e,1),e+1<=this.hcProperties.qNoOfLeftDims&&this.hcProperties.qNoOfLeftDims--}}else d=this.hcProperties.qLayoutExclude.qHyperCubeDef.qMeasures.splice(a-f.length,1)[0];return b.resolve(d)},getSorting:function(){throw"don't call this"},changeSorting:function(){throw"don't call this"},setSorting:function(){throw"don't call this"}})}),define("text!extensions.qliktech/pivot-table/pivot-table.ng.html",[],function(){return'<div class="qv-pt" ng-class="{ \'qv-pt-interactive\': interactive, \'sortable-active\': pivoting.dragPlaceholder, \'qv-rtl-layout\': options.direction === \'rtl\' }">\n\t<qv-table-column-width-adjuster\n\t\t\tmin-col-width="scrollApi.settings.column.minColWidth"\n\t\t\tng-if="navigatable && !selectionsApi.active && layout.qHyperCube.qNoOfLeftDims"\n\t\t\tcolumns="columns"\n\t\t\texplicit-column-widths="explicitColumnWidths"\n\t\t\tx-rtl="rtl"\n\t\t\tdir="{{direction}}">\n\t</qv-table-column-width-adjuster>\n\t<qv-scroll-area x-non-mouse-viewport-scrolling="nonMouseViewportScrolling"\n\t\t\t\t\tclass="qv-grid-object-scroll-area"\n\t\t\t\t\tqva-delegated-activate=".qv-pt-expandable#interactive && !selectionsApi.active && collapseExpand($event);"\n\t\t\t\t\tqv-sortable-list="pivoting"\n\t\t\t\t\tx-direction="viewport.direction">\n\t\t<table\tdir="{{viewport.direction}}"\n\t\t\t\tqv-selections-select-while-locked="selectWhileLocked()"\n\t\t\t\tqv-selections-toggle-dimension-value="{ selector: \'.cell\' }"\n\t\t\t\tqv-selections-on-toggle-dimension-value="interactive && selectDimensionValue(cell, $event)"\n\t\t\t\tqv-selections-exclude-toggle-dimension-value="excludeDimensionToggle($event)"\n\t\t\t\tqv-selections-multiselect="{ selector: \'.cell:not(.null-value)\' }"\n\t\t\t\tqv-selections-start-multiselect="interactive && activateSelections(cell)"\n\t\t\t\tqv-selections-update-multiselect="interactive && multiselectDimensionValues(start, current, dataColIx)"\n\t\t\t\tqv-selections-end-multiselect="interactive && multiselect()">\n\t\t\t<colgroup>\n\t\t\t\t<col ng-repeat="cell in metaGhostHeaders.headers" ng-style="cell.style" />\n\t\t\t</colgroup>\n\t\t\t<tbody ng-style="themeStyle.header">\n\t\t\t\t<tr ng-repeat="row in grid.headerRows" tid="header.row"\n\t\t\t\t\tng-class="row.classList" on-finish-render>\n\t\t\t\t\t<th ng-repeat="cell in row.cells"\n\t\t\t\t\t\tng-class="cell.classList"\n\t\t\t\t\t\tclass="cell"\n\t\t\t\t\t\tcolspan="{{cell.colspan}}"\n\t\t\t\t\t\trowspan="{{cell.rowspan}}"\n\t\t\t\t\t\tng-style="cell.style"\n\t\t\t\t\t\tqv-pivot-table-include="cell.templateSrc"\n\t\t\t\t\t\ttitle="{{cell.text}}"\n\t\t\t\t\t\ttid="header.row.cell"></th>\n\t\t\t\t</tr>\n\t\t\t\t<tr ng-repeat="row in grid.rows" tid="data.row" ng-style="themeStyle.content" on-finish-render>\n\t\t\t\t\t<td ng-repeat="cell in row.cells"\n\t\t\t\t\t\tng-class="cell.classList"\n\t\t\t\t\t\tclass="cell"\n\t\t\t\t\t\tcolspan="{{cell.colspan}}"\n\t\t\t\t\t\trowspan="{{cell.rowspan}}"\n\t\t\t\t\t\tng-style="cell.style"\n\t\t\t\t\t\tqv-pivot-table-include="cell.templateSrc"\n\t\t\t\t\t\ttitle="{{cell.text}}"\n\t\t\t\t\t\ttid="data.row.cell"></td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\t</qv-scroll-area>\n</div>\n'}),define("text!extensions.qliktech/pivot-table/cell-item.ng.html",[],function(){return'<div class="value" ng-class="{ \'qv-rtl-text\': cell.isRtl }" ng-bind="cell.text" dir="{{cell.dir}}"></div>\n'}),define("text!extensions.qliktech/pivot-table/header-cell-item.ng.html",[],function(){return'<div class="value" dir="{{cell.dir}}" ng-class="{ \'qv-rtl-text\': cell.isRtl }">\n\t<i class="qv-pt-expandable lui-icon" ng-if="cell.collapseExpandClass" ng-class="cell.collapseExpandClass"></i>\n\t<span ng-bind="cell.text"></span>\n</div>\n'}),define("text!extensions.qliktech/pivot-table/meta/meta-left.ng.html",[],function(){return'<div class="left-meta-headers list"\n\t tid="meta.rows"\n\t ng-repeat="list in [pivoting.rows]"\n\t qv-pivot-table-include="list.templateSrc">\n</div>'}),define("text!extensions.qliktech/pivot-table/meta/meta-top.ng.html",[],function(){return'<div class="top-meta-headers list"\n\t tid="meta.columns"\n\t ng-repeat="list in [pivoting.columns]"\n\t qv-pivot-table-include="list.templateSrc">\n</div>'}),define("text!extensions.qliktech/pivot-table/meta/meta-list.ng.html",[],function(){return'<div class="button-wrapper"\n\t ng-repeat="header in list.items track by header.id"\n\t qv-pivot-table-include="header.templateSrc">\n</div>'}),define("text!extensions.qliktech/pivot-table/meta/meta-item.ng.html",[],function(){return'<div class="lui-button qv-pt-meta-button"\n\t\ttid="meta.button"\n\t\tng-style="header.style"\n\t\tng-class="{ \'lui-active\': header.open, \'pseudo\': header.isPseudoDim, \'dragging\': header.dragging, \'lui-disabled\': !interactive || selectionsApi.active }"\n\t\tqva-outside-ignore-for="{{header.qvaOutsideIgnoreFor}}"\n\t\tqva-activate="!header.isPseudoDim && !selectionsApi.active && interactive && showDimension($event, header)">\n\t<span ng-if="header.locked" class="lui-icon lui-icon--lock"></span>\n\t<div class="meta-text" dir="{{header.dir}}" title="{{header.title}}">{{header.title}}</div>\n\t<span ng-if="!header.isPseudoDim" class="lui-caret"></span>\n</div>\n'}),define("ng",[],function(){return{load:function(a,b,c,d){function e(){"undefined"!=typeof window&&window.qvangularGlobal?c(window.qvangularGlobal.getService(a)):setTimeout(e,5)}d.isBuild||"undefined"==typeof window?c():e()}}}),define("objects.grid/data-grid-provider",["qvangular","./data-grid"],function(a,b){"use strict";a.provider("qvDataGrid",function(){this.$get=[function(){return function(a){return new b(a)}}]})}),define("extensions.qliktech/pivot-table/meta/ghost-headers-provider",["qvangular","util","translator","general.utils/support"],function(a,b,c,d){"use strict";function e(a,b,c){this.calcApprMaxGlyphCnt=a,this.maxGlyphCnt=c,this.isWidthFlexible=b,this.style={}}function f(a,c,e){var f={glyphWidth:i,collapseExpandIconGlyphCnt:d.treatAsDesktop()?3:4,columnPaddingGlyphCnt:3,metaHeaderMaxGlyphCnt:160/i,cellPaddingGlyphCnt:Math.ceil(12/i),buttonPaddingGlyphCnt:Math.ceil(20/i),buttonArrowGlyphCnt:Math.ceil(13/i),buttonMarginOfSafetyGlyphCnt:2,leftTree:{minNonEmptyGlyphCnt:12,emptyGlyphCnt:3,widthFactor:.35},topTree:{wideWidthFactor:.3,growFactor:1.2,minGlyphCnt:8}};this.opts=b.extend(!0,f,a),this.layout=c,this.viewportRect=e,this.headers=[],this.maxGlyphs=0,this.availableGlyphs=0,this.leftCellCnt=0,this.dataColumnsInfo={cnt:0,width:0}}function g(a){var b=!!this.layout.qHyperCube.qAlwaysFullyExpanded;return this.sortOrder.filter(function(b,c){return a?c>=this.leftDimCnt:c<this.leftDimCnt},this).map(function(a,c){var d=0;if(a===-1)return 0;var e=this.layout.qHyperCube.qDimensionInfo[a];return c+1<this.leftDimCnt?(d=e.qApprMaxGlyphCount,b||(d+=this.opts.collapseExpandIconGlyphCnt),d=Math.max(e.othersLabel?e.othersLabel.length:0,d)):(d=e.qApprMaxGlyphCount,d+=this.opts.columnPaddingGlyphCnt),d},this).sort(function(a,b){return b-a})[0]||0}function h(a){return this.sortOrder.filter(function(b,c){return a?c>=this.leftDimCnt:c<this.leftDimCnt},this).map(function(a){var b=0;return a===-1?b=c.get("Common.Measures").length:(b=this.layout.qHyperCube.qDimensionInfo[a].qFallbackTitle.length+this.opts.buttonArrowGlyphCnt,this.layout.qHyperCube.qDimensionInfo[a].othersLabel&&(b=Math.max(this.layout.qHyperCube.qDimensionInfo[a].othersLabel.length,b))),b+this.opts.buttonPaddingGlyphCnt+this.opts.buttonMarginOfSafetyGlyphCnt},this).sort(function(a,b){return b-a})[0]||0}var i=8;f.prototype={_reset:function(){this.headers.length=0,this.maxGlyphs=0,this.availableGlyphs=0,this.leftCellCnt=0,this.dataColumnsInfo.cnt=0,this.dataColumnsInfo.width=0},_addCollapseExpandHeader:function(a){var b=new e(this.opts.collapseExpandIconGlyphCnt,!1);b.isCollapseExpandIcon=!0,a.push(b),this.availableGlyphs-=this.opts.collapseExpandIconGlyphCnt},_addCollapseExpandHeaders:function(a){for(var b=0;b<this.leftDimCnt-1&&this.leftDimCnt>1&&this.leftDimCnt<=this.sortOrderCnt;++b)this._addCollapseExpandHeader(a)},_getLeftCollapseExpandCnt:function(a){return this.isIndentMode?this.leftDimCnt-1:a},_addLeftTreeMetaGhostHeader:function(a,b,c){var d=c>b,f=new e(b,d,c);a.push(f),this.availableGlyphs-=b},_addEmptyLeftTreeMetaGhostHeader:function(a,b){var c=new e(b||this.opts.leftTree.emptyGlyphCnt,!1);a.push(c),this.availableGlyphs-=c.calcApprMaxGlyphCnt},_getDataGhostHeaders:function(){var a,b,c=[];for(a=0;this.availableGlyphs>0&&this.totDataColCnt>0&&a<this.totDataColCnt;++a){if(b=this.longestMeasureGlyphCnt,b+=this.opts.columnPaddingGlyphCnt,b/this.longestTopDimGlyphCnt<this.opts.topTree.wideWidthFactor&&(b+=b*this.opts.topTree.growFactor),0===a&&b>this.availableGlyphs&&(b=this.availableGlyphs),this.availableGlyphs-b<0){this.availableGlyphs=0;break}this.availableGlyphs-=b;var d=new e(b,!0);c.push(d)}return c},_getLeftGhostHeaders:function(a,b,c){var d=[],e=this.opts.collapseExpandIconGlyphCnt*this._getLeftCollapseExpandCnt(b),f=this.longestLeftDimGlyphCnt,g=Math.min(this.longestLeftDimTitleGlyphCnt,this.opts.metaHeaderMaxGlyphCnt);return b>0?this.isIndentMode?this._getLeftGhostHeadersIndent(d,f,g,e,b,c):this._getLeftGhostHeadersNonIndent(d,b,g,e):this._addEmptyLeftTreeMetaGhostHeader(d,a),d},_isSpaceForDataColumn:function(a,b){return this.maxGlyphs-a>=b.calcApprMaxGlyphCnt},_getLeftGhostHeadersIndent:function(a,b,c,d,e,f){var g,h,i=b;if(this.pseudoInLeftTree&&(i+=this.longestMeasureTitleGlyphCnt),e>0&&i<this.opts.leftTree.minNonEmptyGlyphCnt&&(i=this.opts.leftTree.minNonEmptyGlyphCnt),i<c-d&&(0===f.length||f.length>0&&this._isSpaceForDataColumn(c-d,f[0]))&&(i=c-d),i+d>this.availableGlyphs&&f.length>0&&!this._isSpaceForDataColumn(i+d,f[0])){var j=[],k=[];j.push(Math.ceil(i/3)),j.push(Math.ceil(this.opts.leftTree.widthFactor*this.maxGlyphs)),j.push(this.opts.metaHeaderMaxGlyphCnt),k.push(Math.min.apply(null,j)),e>0&&k.push(this.opts.leftTree.minNonEmptyGlyphCnt),k.push(this.availableGlyphs),h=i,g=Math.max.apply(null,k)}else g=i;this._addCollapseExpandHeaders(a),this._addLeftTreeMetaGhostHeader(a,g,h)},_getLeftGhostHeadersNonIndent:function(a,b,c,d){this._getLeftDimsWidths(b,c,d).forEach(function(b){this._addCollapseExpandHeader(a),this._addLeftTreeMetaGhostHeader(a,b)},this)},_getLeftDimsWidths:function(a,b,c){for(var d,e,f,g=[],h=0,i=0,j=0;j<a;++j)d=this._getDimGlyphCnt(j)+this.opts.cellPaddingGlyphCnt,h+=d,g.push({target:d,adjusted:d});if(h<b-c){var k=b-c-h,l=g[g.length-1];l.adjusted=l.target+=Math.min(k,this.maxGlyphs-h),h=g.reduce(function(a,b){return a+b.target},0)}if(h+c>this.availableGlyphs&&h+c>this.maxGlyphs*this.opts.leftTree.widthFactor)for(h=0,j=0;j<a;++j)d=Math.min(this.opts.metaHeaderMaxGlyphCnt-c,g[j].target>8?g[j].target/2:g[j].target),g[j].adjusted=d,h+=d;if(h+c>this.availableGlyphs&&h+c>this.maxGlyphs)for(i=(h+c-this.maxGlyphs)/h,j=0;j<a;++j)d=g[j].adjusted,g[j].adjusted=Math.floor(d-d*i);else if(h+c<this.availableGlyphs)for(f=this.availableGlyphs-h-c,e=g.reduce(function(a,b){return a+(b.adjusted<b.target?b.target:0)},0),j=0;j<a;++j)d=g[j],d.adjusted<d.target&&(g[j].adjusted+=Math.floor(d.target/e*f));return g.map(function(a){return a.adjusted})},_calculateGhostMetaHeadersWidth:function(a,b,c){var d,e,f,g=1;b=b||this.headers,c=c||a,b.forEach(function(b){b.minWidth=b.calcApprMaxGlyphCnt*this.opts.glyphWidth,b.widthFactor=b.calcApprMaxGlyphCnt*this.opts.glyphWidth/a,g-=b.widthFactor},this),g>0&&(d=g,f=b.filter(function(a){return a.isWidthFlexible&&a.maxGlyphCnt>a.calcApprMaxGlyphCnt}),e=f.reduce(function(a,b){return b.maxGlyphCnt-b.calcApprMaxGlyphCnt},0),f.forEach(function(b){var c=b.maxGlyphCnt-b.calcApprMaxGlyphCnt,f=c/e,h=Math.min(c*this.opts.glyphWidth/a,f*d);b.widthFactor+=h,g-=h},this)),g>0&&(f=b.filter(function(a){return a.isWidthFlexible===!0}),f.forEach(function(a){a.widthFactor+=g/f.length})),b.forEach(function(b){b.width=Math.round(b.widthFactor*a),b.style.width=b.width+"px"})},calculateColumns:function(a){var b=0,c=[],d=!0;return a.forEach(function(a){a.column=b,d&&(c[b]=[],d=!1),c[b][c[b].length]=a,a.isCollapseExpandIcon||(b++,d=!0)}),c},calculateNumColumns:function(a){return a.reduce(function(a,b){return a+(b.isCollapseExpandIcon?0:1)},0)},_updateLeftHeadersGlyphCnt:function(a,b){var c,d,e,f,g,h,i,j,k,l,m;for(c=a.filter(function(a){return!a.isCollapseExpandIcon}),d=a.filter(function(a){return a.isCollapseExpandIcon}),e=c.reduce(function(a,b){return a+b.calcApprMaxGlyphCnt},0),f=d.reduce(function(a,b){return a+b.calcApprMaxGlyphCnt},0),g=e*this.opts.glyphWidth,h=f*this.opts.glyphWidth,i=b-h,j=i/g,k=0,c.forEach(function(a){a.oldCalcApprMaxGlyphCnt=a.calcApprMaxGlyphCnt,a.calcApprMaxGlyphCnt=Math.floor(a.calcApprMaxGlyphCnt*j),k+=a.calcApprMaxGlyphCnt}),l=Math.floor(i/this.opts.glyphWidth)-k,c.sort(function(a,b){return b.calcApprMaxGlyphCnt-a.calcApprMaxGlyphCnt}),m=0;m<l;m++)c[m].calcApprMaxGlyphCnt+=1},update:function(a,b,c){var d,e,f,g,h,i,j=[],k=[],l=[],m=0;for(c=c||this.explicitColumnWidths,this._reset(),this.maxGlyphs=Math.floor(this.viewportRect.width/this.opts.glyphWidth),this.availableGlyphs=this.maxGlyphs,this.availableGlyphs>0&&(j=this._getDataGhostHeaders()),d=this._getLeftGhostHeaders(a,b,j),h=this.calculateColumns(d),i=0;i<h.length;i++)c[i]>0?(this._updateLeftHeadersGlyphCnt(h[i],c[i]),k=k.concat(h[i])):l=l.concat(h[i]);for(g=j.reduce(function(a,b){return a+b.calcApprMaxGlyphCnt},0),f=d.reduce(function(a,b){return a+b.calcApprMaxGlyphCnt},0);j.length>0&&g+f>this.maxGlyphs;){if(e=j.pop(),0===j.length&&this.maxGlyphs-f>=this.opts.topTree.minGlyphCnt){e.calcApprMaxGlyphCnt=this.maxGlyphs-f,j.push(e),g=e.calcApprMaxGlyphCnt;break}g-=e.calcApprMaxGlyphCnt}if(this.leftHeaders=d,this.dataHeaders=j,this.leftColumns=h,this.headers=d.concat(j),this.dataColumnsInfo.cnt=j.length,this.leftCellCnt=d.length,d.length&&c&&c.length){for(i=0;i<h.length;i++)c[i]>0&&(this._calculateGhostMetaHeadersWidth(c[i],h[i],this.viewportRect.width),m+=c[i]);this._calculateGhostMetaHeadersWidth(this.viewportRect.width-m,l.concat(j),this.viewportRect.width),d.forEach(function(a){a.oldCalcApprMaxGlyphCnt&&(a.calcApprMaxGlyphCnt=a.oldCalcApprMaxGlyphCnt)})}else this._calculateGhostMetaHeadersWidth(this.viewportRect.width);this.dataColumnsInfo.width=j[0]?j[0].widthFactor*this.viewportRect.width:0},_getDimGlyphCnt:function(a){return a===this.pseudoDimIndex?this.longestMeasureTitleGlyphCnt:this.layout.qHyperCube.qDimensionInfo[this.sortOrder[a]].qApprMaxGlyphCount},getDimInfo:function(a){if(a!==this.pseudoDimIndex)return this.layout.qHyperCube.qDimensionInfo[this.sortOrder[a]]}},Object.defineProperties(f.prototype,{isIndentMode:{get:function(){return this.layout.qHyperCube.qIndentMode}},pseudoDimIndex:{get:function(){var a=this.sortOrder.indexOf(-1);return~a?a:this.sortOrderCnt}},longestMeasureGlyphCnt:{get:function(){return this.layout.qHyperCube.qMeasureInfo.map(function(a){return Math.max(a.qApprMaxGlyphCount,2)}).sort(function(a,b){return b-a})[0]||0}},longestMeasureTitleGlyphCnt:{get:function(){return this.layout.qHyperCube.qMeasureInfo.map(function(a){return a.qFallbackTitle.length}).sort(function(a,b){return b-a})[0]||0}},longestLeftDimTitleGlyphCnt:{get:function(){return h.call(this)}},longestLeftDimGlyphCnt:{get:function(){return g.call(this)}},longestTopDimGlyphCnt:{get:function(){return g.call(this,!0)}},sortOrder:{get:function(){return this.layout.qHyperCube.qEffectiveInterColumnSortOrder}},sortOrderCnt:{get:function(){return this.sortOrder.length}},leftDimCnt:{get:function(){return this.layout.qHyperCube.qNoOfLeftDims>=0?this.layout.qHyperCube.qNoOfLeftDims:this.sortOrderCnt}},totDataColCnt:{get:function(){return this.layout.qHyperCube.qSize.qcx}},pseudoInLeftTree:{get:function(){return this.pseudoDimIndex<this.leftDimCnt}},columnWidths:{get:function(){var a=this.layout.qHyperCube.columnWidths;return a?2===a.length&&Array.isArray(a[0])&&Array.isArray(a[1])?[a[0].slice(),a[1].slice()]:a.slice():[[],[]]}},explicitColumnWidths:{get:function(){var a,b,c,d,e=this.columnWidths;if(!e||!e.length||1===e.length&&!Array.isArray(e[0])&&e[0]<=0)return[];if(e.length&&!Array.isArray(e[0])&&e[0]>0)a=e;else{if(this.isIndentMode)return e&&Array.isArray(e[0])?e[0]:[];a=e&&Array.isArray(e[1])?e[1]:[]}for(b=a?a.length:0,c=[],d=0;d<b;d++)c[d]=a[this.sortOrder[d]];return c}}}),a.provider("qvPivotTableMetaGhostHeadersProvider",function(){this.$get=[function(){return function(a,b,c){return new f(a,b,c)}}]})}),define("extensions.qliktech/pivot-table/meta/pivoting",["general.sortable/sortable-item-lists","translator","client.utils/rtl/rtl-util"],function(a,b,c){"use strict";var d;return d=a.extend("SortableMetaLists",{init:function(a,b,c,d,e,f,g){this._super.apply(this,[a]),this.layout=e,this.backendApi=b,this.grid=c,this.metaGhostHeaders=d,this.$id=f,this.currentPopover=g,this.rows=this.createList(),this.rows.templateSrc="pt-meta-list.ng.html",this.columns=this.createList(),this.columns.templateSrc="pt-meta-list.ng.html"},reset:function(){this._super.apply(this,arguments)},update:function(a){var d,e,f,g,h,i;for(this.reset(),d=0;d<this.sortOrderCnt;++d){if(e=this.sortOrder[d],d<this.leftDimCnt)f=this.rows;else{if(a<=0)continue;f=this.columns}e!==-1?(i=this.layout.qHyperCube.qDimensionInfo[e].qGroupFieldDefs[this.layout.qHyperCube.qDimensionInfo[e].qGroupPos],h=this.layout.qHyperCube.qDimensionInfo[e].qFallbackTitle,g={title:h,id:this.layout.qHyperCube.qDimensionInfo[e].cId,fieldName:i,style:{},qvaOutsideIgnoreFor:"qv-pt-meta-header-"+this.$id,open:this.currentPopover.header&&i===this.currentPopover.header.fieldName,dimIx:e,locked:!!this.layout.qHyperCube.qDimensionInfo[e].qLocked,dir:c.getAutoOrAlternativeDirection(h)}):(h=b.get("Common.Measures"),g={title:b.get("Common.Measures"),dimIx:-1,isPseudoDim:!0,style:{},locked:!1,dir:c.getAutoOrAlternativeDirection(h)}),g.templateSrc="pt-meta-item.ng.html",f.addSortableItem(g)}}}),Object.defineProperties(d.prototype,{sortOrder:{get:function(){return this.layout.qHyperCube.qEffectiveInterColumnSortOrder}},sortOrderCnt:{get:function(){return this.sortOrder.length}},leftDimCnt:{get:function(){return this.layout.qHyperCube.qNoOfLeftDims>=0?this.layout.qHyperCube.qNoOfLeftDims:this.sortOrderCnt}}}),d}),define("extensions.qliktech/pivot-table/meta/pivoting-provider",["qvangular","./pivoting"],function(a,b){"use strict";function c(){this.$get=[function(){return function(a,c,d,e,f,g,h,i){return new(b.extend("PivotTableSortableMetaLists",{addPlaceholder:function(a,b){this._super.apply(this,arguments).style.width=b.width,a.dragging=!0},allowAutoScroll:function(){return!1},onBegin:function(){this._super.apply(this,arguments),h.off(),i.off(),this.toggleCellsWhenSorting(this.grid.headerRows,this.grid.rows,!0)},enable:function(){this._super.apply(this,arguments),h.on(),i.on(),this.toggleCellsWhenSorting(this.grid.headerRows,this.grid.rows,!1)},allowDrag:function(){return this._super.apply(this,arguments)&&!(e&&e.qSelectionInfo&&e.qSelectionInfo.qMadeSelections)},onMove:function(){this._super.apply(this,arguments),this.patchPivotingProperties()},onMoveToList:function(){this._super.apply(this,arguments),this.patchPivotingProperties()},onEnterList:function(a){a===this.rows&&a.isEmpty()&&this.metaGhostHeaders.update(2*this.metaGhostHeaders.opts.leftTree.emptyGlyphCnt),this._super.apply(this,arguments),a===this.columns&&this.rows.isEmpty()&&this.metaGhostHeaders.update(this.metaGhostHeaders.opts.leftTree.emptyGlyphCnt)},patchPivotingProperties:function(){var a,b=[];this.rows.items.forEach(function(a){b.push(a.dimIx)}),a=b.length,this.columns.items.forEach(function(a){b.push(a.dimIx)});var c=[{qPath:"/qHyperCubeDef/qInterColumnSortOrder",qOp:"replace",qValue:JSON.stringify(b)},{qPath:"/qHyperCubeDef/qNoOfLeftDims",qOp:"replace",qValue:JSON.stringify(a)}];this.backendApi.applyPatches(c,!0)},toggleCellsWhenSorting:function(){var a,b;for(a=arguments.length-1;a>=0;--a)if(Array.isArray(arguments[a])){var c,d,e,f,g=arguments[a];for(c=0;c<g.length;++c)for(e=g[c].cells.length,d=0;d<e;++d)f=g[c].cells[d],f.isMeta?f[b?"addClass":"removeClass"]("drop"):f[b?"addClass":"removeClass"]("locked")}else b=arguments[a]}}))({listSelector:".meta",listKey:function(a){return a.find(".list").scope().list},itemSelector:".button-wrapper",itemDragSelector:".button-wrapper",itemKey:"header"},a,c,d,e,f,g)}}]}a.provider("qvPivotTablePivoting",c)}),define("extensions.qliktech/pivot-table/snapshot/snapshot-helper",[],function(){function a(a,b){var c=a[0].getBoundingClientRect();return{height:b.size.h,width:b.size.w,top:c.top,left:c.left}}return{getSnapshotScrollAreaBBox:a}}),define("extensions.qliktech/pivot-table/viewport-provider",["qvangular","extensions.qliktech/pivot-table/snapshot/snapshot-helper"],function(a,b){"use strict";function c(a,c,d,e,f,g,h,i,j,k){var l,m,n,o=c.find(e),p=o.find(f),q=p.find(g);return l={minRowHeight:d,rect:{left:0,top:0,width:0,height:0},scrollRect:{left:0,top:0,width:0,height:0},rowCount:0,direction:k.direction,getVirtualScrollController:function(){return o.controller("qvScrollArea")},getSortableListController:function(){return o.controller("qvSortableList")},getMultiSelectController:function(){return q.controller("qvSelectionsMultiselect")},getEmptyMetaCellsOfLastHeaderRow:function(){return o.find(".last-top-row .header.empty.left-meta.bottom-meta")},getFirstDataCell:function(){var a,b=o.find(h);if(a={top:0,left:0,width:0},b.length){var c=b[0].getBoundingClientRect(),d=b.position();a.top=d.top,a.left=d.left,a.width=c.width}return a},getTopHeaders:function(){return o.find(i)},getScrollAreaBBox:function(){return j&&j.object&&!k.freeResize?b.getSnapshotScrollAreaBBox(o,j.object):o[0].getBoundingClientRect()},getScrollAreaPosition:function(){return o.position()},getScrollContentBBox:function(){return p[0].getBoundingClientRect()},updateRowCount:function(a){l.rowCount=Math.ceil(a)},getMaxRowCount:function(){return Math.ceil(l.scrollRect.height/l.minRowHeight)},getVisibleRowCount:function(){function a(a,b){return a.offsetTop+a.getBoundingClientRect().height<=b.top+b.height}function b(a,b){var c=b-a;return 1===c?b:Math.floor(a+c/2)}function d(c,e,f){var g=f-e,h=b(e,f),i=a(c[h],l.scrollRect);return 0===g?i?h:-1:1===g?i?h:d(c,e,e):i?d(c,h,f):d(c,e,h)}var e,f,g=c[0].querySelector(h);if(!g)return 0;if(e=g.parentNode,f=Array.prototype.slice.call(e.parentNode.childNodes),f=f.filter(function(a){return a.nodeType===Node.ELEMENT_NODE}),f=f.splice(f.indexOf(e)),0===f.length)return 0;var i=d(f,0,f.length-1)+1;if(i===f.length){var j=f[f.length-1],k=l.scrollRect.top+l.scrollRect.height-(j.offsetTop+j.getBoundingClientRect().height);i+=Math.floor(k/(3*l.minRowHeight))}return i},updateRect:function(){return a.cancel(m),m=a(function(){var a=l.getScrollAreaBBox();l.rect.top=a.top,l.rect.left=a.left,l.rect.width=a.width,l.rect.height=a.height,l.updateRowCount(l.rect.height/l.minRowHeight)},!1)},updateScrollRect:function(b){return a.cancel(n),n=a(function(){var a=l.getScrollAreaPosition(),c=l.getFirstDataCell();l.scrollRect.top=a.top+c.top,l.scrollRect.height=l.rect.height-c.top,"rtl"===l.direction?(l.scrollRect.left=0,l.scrollRect.width=c.left+c.width):(l.scrollRect.left=c.left,l.scrollRect.width=l.rect.width-c.left),b&&(l.updateRowCount(l.collapsedRowCount||l.scrollRect.height/l.minRowHeight),delete l.collapsedRowCount)},!1)},getScrollRect:function(){return{top:l.scrollRect.top,left:l.scrollRect.left,width:l.scrollRect.width,height:l.scrollRect.height}}}}function d(a){return c.bind(null,a)}function e(){this.$get=["$timeout",d]}a.provider("qvPivotTableViewportProvider",e)}),define("extensions.qliktech/pivot-table/virtual-scroll-provider",["qvangular"],function(a){"use strict";function b(a,b,c){function d(b){var d=a.getMaxRowCount();j.activeFromStart||(b.qHeight=Math.min(c.qcy-b.qTop,d),a.updateRowCount(Math.min(b.qHeight,a.rowCount)))}function e(c){return{qLeft:b.cnt>0?Math.round(c.vPosX/b.width):0,qTop:Math.round(c.vPosY/a.minRowHeight),qWidth:Math.max(1,b.cnt),qHeight:Math.max(1,a.rowCount)}}function f(a){a.qTop>0&&a.qTop+a.qHeight>c.qcy&&(a.qTop=Math.max(0,c.qcy-a.qHeight),a.qHeight=Math.min(c.qcy,a.qHeight)),a.qLeft>0&&a.qLeft+a.qWidth>c.qcx&&(a.qLeft=Math.max(0,c.qcx-a.qWidth),a.qWidth=Math.min(c.qcx,a.qWidth))}var g,h,i=a.getVirtualScrollController(),j={active:!1,activeFromStart:!1},k={xAxis:0,yAxis:0};return h={page:{qLeft:0,qTop:0,qWidth:0,qHeight:0},equalsPage:function(a){return this.page.qLeft===a.qLeft&&this.page.qTop===a.qTop&&this.page.qWidth===a.qWidth&&this.page.qHeight===a.qHeight},setPage:function(a){this.page.qLeft=a.qLeft,this.page.qTop=a.qTop,this.page.qWidth=a.qWidth,this.page.qHeight=a.qHeight},onGetData:function(a){g=a},setScrollViewport:function(){a.updateScrollRect(!1).then(function(){i.setViewport(a.getScrollRect())})},setVirtualSize:function(){var d=this;a.updateScrollRect(!0).then(function(){var e,f,g,k,l;j.active=!1,j.activeFromStart=!1,a.scrollRect.top+a.scrollRect.height>=a.rect.height&&h.page.qHeight>=c.qcy&&(e=a.getVisibleRowCount())<h.page.qHeight&&(j.active=!0,j.activeFromStart=!0,a.updateRowCount(e)),f={vPosY:d.page.qTop*a.minRowHeight,vPosX:d.page.qLeft*b.width},k=h.page.qWidth===c.qcx?a.scrollRect.width:c.qcx*b.width,g={width:k,height:c.qcy*a.minRowHeight},l={width:a.scrollRect.width,height:a.rowCount*a.minRowHeight},i.setVirtualSize(g,l,a.getScrollRect()),(f.vPosY>0||f.vPosX>0)&&i.scroll(f.vPosX,f.vPosY)})},alignToBottom:function(){var b=!1;if(j.active){if(k.yAxis>0){var c=a.getVisibleRowCount();c<a.rowCount&&a.updateRowCount(c)}else{var d=a.getMaxRowCount();a.rowCount>=d&&(j.active=!1),b=!0}i.setVirtualViewport({width:a.scrollRect.width,height:a.rowCount*a.minRowHeight}),b&&i.setVirtualScrollPos(0,-1)}}},i.onScroll(function(a,b){var c=i.getVirtualPosition(),l=i.getMaxPosition(),m=e(c);j.active&&b<0&&(d(m),l=i.getMaxPosition()),l.vPosY>0&&c.vPosY===l.vPosY&&(j.active=!0),f(m),j.lastTop=m.qTop,k.xAxis=a,k.yAxis=b,h.equalsPage(m)&&!j.active||(h.setPage(m),g(h.page).then(function(){h.alignToBottom()}))}),i.getScrollAmount=function(c,d,e){var f=i.getVirtualPosition(),g=i.getMaxPosition();switch(e){case 1:return{deltaX:b.width*c,deltaY:a.minRowHeight*d};case 2:return{deltaX:b.cnt*b.width*c,deltaY:a.minRowHeight*a.rowCount*d};case 10:return{deltaX:0,deltaY:d>0?f.vPosY*d:f.vPosY-g.vPosY};default:return{deltaX:c,deltaY:d}}},h}function c(){return b}function d(){this.$get=[c]}a.provider("qvPivotTableVirtualScrollProvider",d)}),define("extensions.qliktech/pivot-table/selections-provider",["qvangular","jquery","objects.utils/event-utils"],function(a,b,c){"use strict";function d(a,d,e,f,g,h,i,j){function k(b,c){var e,f,g,h,i,j,k,l=[],m=q.dataValuesArray.length;for(e=b.getRowsByCellType(b.CELL_TYPE_TOP).concat(b.getRowsByCellType(b.CELL_TYPE_LEFT)),i=m>0?d.getSiblingCells(b,c):[],f=e.length,k=0;k<f;++k)l=l.concat(e[k].cells);for(h=l.length,k=0;k<h;++k)g=l[k],((j=i.indexOf(g)!==-1)&&!g.isDimensionValue||!j&&!g.isMeta)&&a[m?"lockCell":"unlockCell"](b,g)}function l(){q.active&&(a.updatePivot(h,q,q.currentCell),k(h,q.currentCell))}function m(){j.on(),p&&p()}function n(){j.on(),p&&p()}function o(){q.active&&q.currentCell&&(d.getSiblingCells(h,q.currentCell).forEach(function(b){a.deselectCell(h,b)}),k(h,q.currentCell))}var p,q=a.$new();return e.excludeDimensionToggle=function(a){return!f.active&&b(a.target).is(".qv-pt-expandable")},e.selectDimensionValue=function(b,c){var d=f.getKeyAsToggleSelected(c);d||(o(),a.reset(q)),p=a.selectDimensionValue(e.$id,g,f,q,b,h,d),k(h,q.currentCell)},e.activateSelections=function(b){p=a.activateSelections(e.$id,g,f,q,b)},e.multiselectDimensionValues=function(b,c){var i,j,l,m=d.getSiblingCells(h,b),n=m.length,o=a.isColumnar(h,b),p=o?b.dataRowIx:b.dataColIx,r=o?c.dataRowIx:c.dataColIx;if(m.indexOf(c)!==-1&&c.isDimensionValue){for(i=0;i<n;++i)l=m[i],j=o?l.dataRowIx:l.dataColIx,(p<=r?j>=p&&j<=r:j>=r&&j<=p)&&l.isDimensionValue&&l!==c&&a.selectDimensionCells(g,f,q,e.grid,l,!1);a.selectDimensionCells(g,f,q,e.grid,c,!1),k(h,q.currentCell)}},e.multiselect=function(){q.active&&a.sendSelection(g,f,q,h,q.currentCell)
},e.selectWhileLocked=function(){q.dataValuesArray.length>0||c.showLockedFeedback(i.qHyperCube.qDimensionInfo)},f.watchActivated(function(){j.off()}),a.init(f,g,q,m,n,o),{updateSelections:l}}function e(a,b){return d.bind(null,a,b)}function f(){this.$get=["qvGridObjectSelectionService","qvGridObjectDataService",e]}a.provider("qvPivotTableSelectionsProvider",f)}),define("text!extensions.qliktech/pivot-table/pivot-panel/pivot-panel.ng.html",[],function(){return'<div class="qv-pivot-panel"\n\t qv-sortable-list="sortableItemLists">\n\t<div class="qv-pivot-panel-row" ng-repeat="row in grid.rows">\n\t\t<div class="qv-pivot-panel-column" ng-if="$first"></div>\n\t\t<div ng-repeat="list in row.lists" class="qv-pivot-panel-column" ng-class="{\'qv-pivot-panel-disabled\': list.disabled}">\n\t\t\t<h2>{{list.title}}</h2>\n\t\t\t<div class="qv-pivot-panel-list">\n\t\t\t\t<ul>\n\t\t\t\t\t<li ng-repeat="item in list.items track by item.id" class="qv-pivot-panel-item" ng-class="item.classList" ng-include src="itemTemplateSrc"></li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n'}),define("text!extensions.qliktech/pivot-table/pivot-panel/pivot-panel-item.ng.html",[],function(){return'<div class="field-wrapper field-token" ng-style="item.style">\n\t<div ng-if="list.showMoveHandle" class="icon-handle"></div>\n\t<div class="field-text">{{item.title}}</div>\n</div>\n'}),define("extensions.qliktech/pivot-table/pivot-panel/pivot-panel",["jquery","qvangular","text!./pivot-panel.ng.html","text!./pivot-panel-item.ng.html","ng!$templateCache","general.sortable/sortable-item-lists","translator","general.sortable/sortable-list"],function(a,b,c,d,e,f,g){var h={Dimension:"dimension",Measure:"measure",Pseudo:"pseudo"};e.put("pivot-panel-item.ng.html",d),b.directive("qvPivotPanel2",function(){return{restrict:"E",template:c,replace:!0,scope:{layout:"=layout",backendApi:"=backendApi"},controller:["$scope","$element",function(b,c){function d(a){return a.qLibraryId?a.title||"":a.qFallbackTitle||""}function e(){var a,c=b.layout.qHyperCube.qNoOfLeftDims;b.sortableItemLists.reset(),a=b.layout.qHyperCube.qEffectiveInterColumnSortOrder.map(function(a){var c;return b.$broadcast("pivotPanelUpdated"),a===-1?{title:"Measures",cId:"pseudo-dimension",type:h.Pseudo,dimIndex:a,cssClass:["sortable","is-pseudo"]}:(c=b.layout.qHyperCube.qDimensionInfo[a],{title:d(c),cId:c.cId,type:h.Dimension,dimIndex:a,cssClass:["sortable"]})}),c=c<0?a.length:c,a.splice(0,c).forEach(function(a){b.rows.add(a.title,a.cId,a.cssClass,1).dimIndex=a.dimIndex}),a.forEach(function(a){b.columns.add(a.title,a.cId,a.cssClass,1).dimIndex=a.dimIndex}),b.layout.qHyperCube.qMeasureInfo.forEach(function(a){b.measures.add(a.qFallbackTitle||"",a.cId,[],2)})}var i=this;b.itemTemplateSrc="pivot-panel-item.ng.html",b.sortableItemLists=f.create({options:{listKey:"list",listSelector:".qv-pivot-panel-column",itemSelector:".sortable",itemDragSelector:".icon-handle",itemKey:"item"},addPlaceholder:function(){this._super.apply(this,arguments).addClass("sortable")},bindAutoScroll:function(){c.find(".qv-pivot-panel-list ul").each(function(){var b=a(this);b.scope().list.scrollInfo={elem:b[0],clientRect:b[0].getBoundingClientRect(),scrollWidth:b[0].scrollWidth,scrollHeight:b[0].scrollHeight}})},onBegin:function(){this._super.apply(this,arguments),this.bindAutoScroll()},onEnterList:function(){this.bindAutoScroll()},onMove:function(){this._super.apply(this,arguments),i.sortOrderUpdated()},onMoveToList:function(a,b){this._super.apply(this,arguments),b.disabled||i.sortOrderUpdated()},onAutoScroll:function(a,b,c,d){if(this._super.apply(this,arguments),!b&&c&&(b=this.getList(c)),b){var e=b.scrollInfo;d(e.elem,e.clientRect,e.scrollWidth,e.scrollHeight)}}}),b.columns=b.sortableItemLists.createList(1,{title:g.get("Common.Columns"),showMoveHandle:!0}),b.rows=b.sortableItemLists.createList(1,{title:g.get("Common.Rows"),showMoveHandle:!0}),b.measures=b.sortableItemLists.createList(2,{title:g.get("Common.Measures")}),b.grid={rows:[]},b.grid.rows.push({lists:[b.columns]}),b.grid.rows.push({lists:[b.rows,b.measures]}),i.sortOrderUpdated=function(){var a,c=[];b.rows.items.forEach(function(a){c.push(a.dimIndex)}),a=c.length,b.columns.items.forEach(function(a){c.push(a.dimIndex)});var d=[{qPath:"/qHyperCubeDef/qInterColumnSortOrder",qOp:"replace",qValue:JSON.stringify(c)},{qPath:"/qHyperCubeDef/qNoOfLeftDims",qOp:"replace",qValue:JSON.stringify(a)}];b.backendApi.applyPatches(d,!0)},b.$watchCollection("layout.qHyperCube.qDimensionInfo",e),b.$watchCollection("layout.qHyperCube.qEffectiveInterColumnSortOrder",e),b.$watchCollection("layout.qHyperCube.qMeasureInfo",e),b.$watchCollection("layout.qHyperCube.qNoOfLeftDims",e)}]}})}),define("extensions.qliktech/pivot-table/pivot-table",["qvangular","jquery","objects.backend-api/pivot-api","extensions.qliktech/pivot-table/pivot-table-properties","extensions.qliktech/pivot-table/pivot-hypercube-handler","objects.extension/object-conversion","client.utils/property-mapper","text!./pivot-table.ng.html","text!./cell-item.ng.html","text!./header-cell-item.ng.html","text!./meta/meta-left.ng.html","text!./meta/meta-top.ng.html","text!./meta/meta-list.ng.html","text!./meta/meta-item.ng.html","ng!$templateCache","general.utils/support","core.utils/deferred","objects.extension/default-selection-toolbar","core.utils/feature-flags","client.utils/theme/theme-module","objects.utils/selection-util","general.utils/responsive-state","objects/listbox-popover/listbox-popover-service","objects.grid/data-grid-provider","./meta/ghost-headers-provider","./meta/pivoting-provider","./viewport-provider","./virtual-scroll-provider","./selections-provider","general.scroll/scroll-area","objects.grid/services/data-service","objects.grid/services/selections","extensions.qliktech/pivot-table/pivot-panel/pivot-panel","objects.grid/column-width-adjuster/column-adjuster","objects/listbox-popover/listbox-popover-service-mobile"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){"use strict";function w(a,b){a.themeStyle={header:{"font-size":b.getStyle("header","fontSize"),color:b.getStyle("header","color")},content:{"font-size":b.getStyle("content","fontSize"),color:b.getStyle("content","color")}}}function x(a){var b;if(s.THEMING){var c=parseInt(a.themeStyle.content["font-size"]);b=p.treatAsDesktop()?c?c/13*21-1.23076923:21:c?c/13*31-1.23076923:31}return b||(p.treatAsDesktop()?21:31)}function y(a,b){a.currentPopover.header===b?b.open=!1:a.currentPopover.header&&(a.currentPopover.header.open=!1),a.currentPopover.header=void 0,a.pivoting.update(a.metaGhostHeaders.dataColumnsInfo.cnt)}function z(a,b,c,d,e){return a.showField(b,c.backendApi.model.app,{$alignToElement:d,qvaOutsideIgnoreFor:"qv-pt-meta-header-"+c.$id,collision:"flipfit",direction:c.options.direction},null,function(){c.currentPopover.header=void 0,e.on(),c.processPaint()})}function A(a,b){b.on(),a.processPaint()}function B(a,c,d,e,f,g,i,j,k,l){function m(h,m,n,o){function p(a,b,c){h.interactive=a&&b,h.navigatable=a&&c,a?c&&(B.on(),C.on()):a||(B.off(),C.off())}var B,C,D,E,F,G,H,I,J=[];if(s.THEMING){var K=t.get(),L=K.initializeService("object.pivotTable");K.ThemeChanged.bind(function(){w(h,L),h.viewport&&(h.viewport.minRowHeight=x(h))}),w(h,L)}h.currentPopover={header:void 0},h.nonMouseViewportScrolling={scrollbarSize:36,className:"show-non-mouse-scrollbars"},h.grid=a("pivot"),h.viewport=g(m,x(h),".qv-grid-object-scroll-area",".scroll-content","table",".first-data-cell","th.top:nth-child(2)",h.layout.snapshotData,h.options),B=h.viewport.getVirtualScrollController(),C=h.viewport.getSortableListController(),D=h.viewport.getMultiSelectController(),h.metaGhostHeaders=f({},h.layout,h.viewport.rect),h.pivoting=e(h.backendApi,h.grid,h.metaGhostHeaders,h.layout,h.$id,h.currentPopover,B,D);var M=function(a,b){return"%"===a.substring(a.length-1,a.length)?parseFloat(a)*b/100:parseFloat(a)},N=function(a){var b=I[a].getBoundingClientRect(),c=I.position();J[a]||(J[a]={}),J[a].top=c.top,J[a].left=c.left,J[a].width=b.width,J[a].height=b.height},O=function(a,b,c){return c?J[b].width:a.metaGhostHeaders.leftColumns[b].reduce(function(b,c){return b+Math.max(0,M(c.style.width,a.viewport.rect.width))},0)},P=function(a,b){a.columns[b].definedTopHeight||(Object.defineProperties(a.columns[b],{top:{get:function(){return this._top||0}},height:{get:function(){return this._height||40}}}),a.columns[b].definedTopHeight=!0)},Q=function(a,b){a.explicitColumnWidths||(a.explicitColumnWidths=a.metaGhostHeaders.explicitColumnWidths),a.columns||(a.columns=[]),a.columns.length>b&&a.columns.splice(b,a.columns.length-b),a.explicitColumnWidths.length>b&&a.explicitColumnWidths.splice(b,a.explicitColumnWidths.length-b)},R=function(a,b,c,d){a.explicitColumnWidths[c]>0&&(a.explicitColumnWidths[c]=b),a.columns[c]||(a.columns[c]={}),a.columns[c].index=c,a.columns[c].width=b,a.columns[c].isLastColumn=d,J[c]?(a.columns[c]._top=d?0:J[c].top,a.columns[c]._height=d?J[c].top+J[c].height:J[c].height):(a.columns[c]._top=0,a.columns[c]._height=40),P(a,c)},S=function(a,b){var c,d,e,f=[],g=a.metaGhostHeaders.leftColumns.length;if(b){if(!(I=a.viewport.getEmptyMetaCellsOfLastHeaderRow())||I.length!==g)return;for(c=0;c<g;c++)N(c)}else a.changingColumnIndex>=0&&N(a.changingColumnIndex);for(Q(a,g),c=0;c<g;c++)d=O(a,c,b&&I),e=c===g-1,R(a,d,c,e),f[c]=0===c?d:f[c-1]+d;for(c=0;c<g;c++)a.columns[c].left=a.rtl?a.viewport.rect.width-f[c]:f[c];b&&(a.changingColumnIndex=-1)};h.$on("onExplicitColumnStarted",function(a){var b,c,d=a.targetScope.column.index,e=0;for(H=h.explicitColumnWidths[d]?h.explicitColumnWidths[d]:h.columns[d].width,b=h.metaGhostHeaders.dataHeaders,c=0;c<b.length;c++)b[c].oldWidth=b[c].width,e+=b[c].width;G=H+e-b[0].minWidth}),h.$on("onExplicitColumnChanging",function(a){if(0!==h.layout.qHyperCube.qNoOfLeftDims){var b,c,d,e=a.targetScope.column.index,f=h.metaGhostHeaders.leftColumns[e],g=0;for(h.changingColumnIndex=e,a.targetScope.explicitColumnWidth>G&&(h.explicitColumnWidths[e]=a.targetScope.explicitColumnWidth=G),1===h.metaGhostHeaders.leftColumns.length&&a.targetScope.explicitColumnWidth<70&&(h.explicitColumnWidths[e]=a.targetScope.explicitColumnWidth=70),h.metaGhostHeaders.leftColumns.length>1&&a.targetScope.explicitColumnWidth<40&&(h.explicitColumnWidths[e]=a.targetScope.explicitColumnWidth=40),d=0;d<f.length;d++)f[d].isCollapseExpandIcon&&(g+=f[d].width);for(f[f.length-1].width=h.explicitColumnWidths[e]-g,f[f.length-1].style.width=f[f.length-1].width+"px",b=h.metaGhostHeaders.dataHeaders,c=(h.explicitColumnWidths[e]-H)/b.length,d=0;d<b.length;d++)b[d].width=Math.max(b[d].oldWidth-c,b[d].minWidth),b[d].style.width=b[d].width+"px";S(h)}}),h.$on("onExplicitColumnChanged",function(){h.metaGhostHeaders.update(0,c.getLeftTreeDepth(h.layout.qHyperCube.qPivotDataPages[0]),h.explicitColumnWidths),S(h),h.applyColumnWidthSoftPatch(h.explicitColumnWidths)}),h.$on("$destroy",function(){k.cancel(E),k.cancel(F)}),h.applyColumnWidthSoftPatch=function(a){var b,c,d=h.layout.qHyperCube,e=d.columnWidths?"replace":"add",f=d.qIndentMode?1:0,g=d.columnWidths,i=h.metaGhostHeaders.leftColumns?h.metaGhostHeaders.leftColumns.length:0;if(g&&Array.isArray(g[0])||(g=[[],[]]),f)g[0]=a;else for(b=d.qEffectiveInterColumnSortOrder,c=0;c<i;c++)g[1][b[c]]=a[c];var j=[{qPath:"/qHyperCubeDef/columnWidths",qOp:e.toString(),qValue:JSON.stringify(g)}];h.backendApi.applyPatches(j,!0)},h.selections=j(h,h.selectionsApi,h.backendApi,h.grid,h.layout,C),h.virtualScroll=i(h.viewport,h.metaGhostHeaders.dataColumnsInfo,h.layout.qHyperCube.qSize),h.virtualScroll.onGetData(function(a){return h.getData(a,!0).then(function(){k.cancel(E),E=k(function(){h.virtualScroll.setScrollViewport()},100)})}),h.getData=function(a,b){var c=q();return h.backendApi.getData([a]).then(function(d){h.onUpdateData(d,a,b).then(function(){c.resolve()})}),c.promise},h.onUpdateData=function(a,b,d){return c.updatePivotItems(h,a,[b],d),h.selections.updateSelections(),k(function(){},0,!1)},h.process=function(a){return a&&h.virtualScroll.setPage(a),h.getData(h.virtualScroll.page).then(function(){h.virtualScroll.setVirtualSize(),k.cancel(F),F=k(function(){S(h,!0)},100)})},h.processPaint=function(){return h.updateMetaInfo().then(function(a){var b=h.layout.qHyperCube.qLastExpandedPos,c=b&&void 0!==h.expandedPosDiffX&&void 0!==h.expandedPosDiffY,d=h.viewport.getVisibleRowCount(),e={qLeft:Math.max(0,c?b.qx-h.expandedPosDiffX:0),qTop:Math.max(0,c?b.qy-h.expandedPosDiffY:0),qWidth:a.qWidth,qHeight:a.qHeight};return b&&e.qLeft+e.qWidth>h.layout.qHyperCube.qSize.qcx&&(e.qLeft=Math.max(0,h.layout.qHyperCube.qSize.qcx-a.qWidth)),b&&h.collapsed&&e.qTop+d>h.layout.qHyperCube.qSize.qcy&&(h.viewport.collapsedRowCount=d,e.qTop=Math.max(0,h.layout.qHyperCube.qSize.qcy-d),e.qHeight=d),delete h.expandedPosDiffX,delete h.expandedPosDiffY,delete h.collapsed,h.process(e)})},h.processResize=function(){return h.updateMetaInfo().then(function(a){var b=h.layout.qHyperCube.qSize,c={qLeft:h.virtualScroll.page.qLeft,qTop:h.virtualScroll.page.qTop,qWidth:a.qWidth,qHeight:a.qHeight};return c.qTop+c.qHeight>b.qcy&&(c.qTop=Math.max(0,b.qcy-c.qHeight)),c.qLeft+c.qWidth>b.qcx&&(c.qLeft=Math.max(0,b.qcx-c.qWidth)),h.$emit("ngRepeatFinished"),h.process(c)})},o.setDirection=function(){h.viewport.direction=h.options.direction,h.rtl="rtl"===h.options.direction,h.processPaint()},o.getSelectionToolbar=function(){return new r(o.$scope.backendApi,o.$scope.selectionsApi,!1,!1)},h.updateMetaInfo=function(){return h.viewport.updateRect().then(function(){var a=h.metaGhostHeaders.explicitColumnWidths;return h.metaGhostHeaders.update(0,c.getLeftTreeDepth(h.layout.qHyperCube.qPivotDataPages[0]),a),h.pivoting.update(h.metaGhostHeaders.dataColumnsInfo.cnt),S(h),{qWidth:Math.max(1,h.metaGhostHeaders.dataColumnsInfo.cnt),qHeight:Math.max(1,h.viewport.rowCount)}})},h.collapseExpand=function(a){var c,d=b(a.target);(c=d.scope().cell)&&(h.expandedPosDiffX=c.dataColIx-h.virtualScroll.page.qLeft,h.expandedPosDiffY=c.dataRowIx-h.virtualScroll.page.qTop,"lui-icon--plus"===c.collapseExpandClass?c.hasClass("top")?h.backendApi.expandTop(c.dataRowIx,c.dataColIx,!1):c.hasClass("left")&&h.backendApi.expandLeft(c.dataRowIx,c.dataColIx,!1):"lui-icon--minus"===c.collapseExpandClass&&(h.collapsed=!0,c.hasClass("top")?h.backendApi.collapseTop(c.dataRowIx,c.dataColIx,!1):c.hasClass("left")&&h.backendApi.collapseLeft(c.dataRowIx,c.dataColIx,!1)))},h.showDimension=function(a,c){var e=b(a.target).closest(".qv-pt-meta-button");if(C.off(),h.currentPopover.header===c)return c.open=!1,h.currentPopover.header=void 0,d.close(),void A(h,C);h.currentPopover.header&&(h.currentPopover.header.open=!1,h.currentPopover.header=void 0),v.isSmallDevice?z(l,c.fieldName,h,e,C):z(d,c.fieldName,h,e,C).then(function(a){var d;a.closing.then(function(a){a&&!b(a.target).closest(".qv-pt-meta-button").length>0&&(y(h,c),A(h,C)),d=a}),a.closed.then(function(){d||(y(h,c),h.processPaint()),a=null})}),c.open=!0,h.currentPopover.header=c},o.setInteractionState=function(){var a=h.object.inAnalysisState(),b=h.options.navigation!==!1;p(a,h.options.selections!==!1,b)},o.onPaint=function(){return this.setInteractionState(h.options.interactionState),u.isInSelection(this.$scope.layout)||void 0!==this.$scope.currentPopover.header?(this.$scope.currentPopover.header&&h.pivoting.update(h.metaGhostHeaders.dataColumnsInfo.cnt),q.resolve()):(C.cancel(),u.isModalSelectionModel(this.$scope.object.model)&&this.$scope.selectionsApi.confirm(),h.processPaint())},o.onResize=function(){return h.processResize()},o.setSnapshotData=function(a){var b=h.virtualScroll.page;return h.backendApi.getData([b]).then(function(b){return h.backendApi.isSnapshot||(b[0].qArea.qTop=0,b[0].qArea.qLeft=0),a.qHyperCube.qPivotDataPages=b,a.qHyperCube.qSize.qcx=b[0].qArea.qWidth,a})},o.getPreferredSize=function(){var a=q(),b=this.$scope.$on("ngRepeatFinished",function(){a.resolve({w:m.width(),h:m.find("table").height()+5}),b()});return a.promise}}return{restrict:"E",replace:!0,template:h,require:"qvObjectContent",link:m}}return o.put("pt-cell-item.ng.html",i),o.put("pt-header-cell-item.ng.html",j),o.put("pt-meta-left.ng.html",k),o.put("pt-meta-top.ng.html",l),o.put("pt-meta-list.ng.html",m),o.put("pt-meta-item.ng.html",n),a.directive("qvPivotTableInclude",["$compile","$animate",function(a,b){return{link:function(c,d,e){b.enabled(d,!1),c.$watch(e.qvPivotTableInclude,function(){var b=c.$eval(e.qvPivotTableInclude),f=o.get(b);d.html(f),a(d.contents())(c)})}}}]),a.directive("onFinishRender",["$timeout",function(a){return{restrict:"A",link:function(b){b.$last===!0&&a(function(){b.$emit("ngRepeatFinished")})}}}]),a.directive("qvPivotTable",["qvDataGrid","qvGridObjectDataService","qvListboxPopoverService","qvPivotTablePivoting","qvPivotTableMetaGhostHeadersProvider","qvPivotTableViewportProvider","qvPivotTableVirtualScrollProvider","qvPivotTableSelectionsProvider","$timeout","qvListboxPopoverServiceMobile",B]),{initialProperties:{qHyperCubeDef:{qDimensions:[],qMeasures:[],qSuppressMissing:!0,qMode:"P",qShowTotalsAbove:!0,qInitialDataFetch:[{qTop:0,qLeft:0,qWidth:50,qHeight:50}],qIndentMode:!0,columnWidths:[]}},data:{dimensions:{min:1,max:1e3},measures:{min:1,max:1e3}},getCreatePropertyHandler:function(a){var b=g.mapProperties(this.mappedDefinition.items.data.items.dimensions),c=g.mapProperties(this.mappedDefinition.items.data.items.measures);return new e({app:a,dimensionDefinition:this.dimensionDefinition,measureDefinition:this.measureDefinition,dimensionProperties:b,measureProperties:c})},support:{cssScaling:!0,snapshot:!0,export:!0,exportData:!0,sharing:!1},type:"pivot-table",template:"<qv-pivot-table></qv-pivot-table>",BackendApi:c,definition:d,importProperties:f.pivotChart.importProperties.bind(f),exportProperties:f.pivotChart.exportProperties.bind(f)}}),define("dev-hub.lib/utils-components",["require","qvangular","core.utils/deferred"],function(a,b,c){"use strict";function d(a){var d=new c;return a?(Array.isArray(a)||(a=[a]),a.forEach(function(a){var c=a;g.has(a.name+"Directive")||(b.directive(a.name,function(){return c}),f[a.path]=a)}),d.resolve(a)):(console.warn("plugin is invalid or missing, '"+JSON.stringify(a)+"'"),d.resolve({success:!1,error:"plugin is invalid or missing"})),d.promise}function e(b,e){var g=new c,h=this;return f[b]?g.resolve(f[b]):a([b],function(a){a.path=b,a.name=a.name||e,g.resolve(h&&h._applyComponentAsDirective?h._applyComponentAsDirective(a):d(a))},function(a){g.resolve({success:!1,error:"plugin is invalid or missing: "+JSON.stringify(a)})}),g.promise}var f={},g=b.getService("$injector");return{requireComponent:e,loadedRequiredComponents:f,__onlytest__:{_loadComponent:e,_applyComponentAsDirective:d}}}),define("dev-hub.lib/utils-conversions",[],function(){"use strict";function a(a){var b=!1;if(a&&a.length>3){b="",a=a.replace("qw",""),a=a[0].toLowerCase()+a.substr(1);for(var c in a){var d=a[c];"string"==typeof d&&(d===d.toUpperCase()&&(d="-"+d.toLocaleLowerCase()),b+=d)}}return b}function b(a,b){var c=!1;return a&&(c=a,b&&(c=a.toLowerCase()),c=c[0].toUpperCase()+c.substr(1)),c}return{directiveToFile:a,capitalizeString:b}}),define("dev-hub.lib/utils",["util","angular","jquery","dev-hub.lib/utils-components","dev-hub.lib/utils-conversions","qvangular"],function(a,b,c,d,e){"use strict";function f(a,b){return(new RegExp(b+"=(.+?)(&|$)").exec(a)||[null,null])[1]}function g(a,b){for(var c,d=new RegExp(b+"=(.+?)(&|$)","g"),e=[];c=d.exec(a);)e.push(decodeURIComponent(c[1]));return e}function h(a){document.title=a+" | Dev Hub"}function i(a){var c=[];return b.forEach(a,function(a,d){b.isObject(a)&&(a.key=d),c.push(a)}),c}function j(a){if(location.hash){var b=new RegExp(a+"{(.*)}",""),c=location.hash.match(b);return!!(c&&c.length>1)&&decodeURIComponent(c[1])}return!1}function k(){return window.location.pathname.substr(0,window.location.pathname.toLowerCase().lastIndexOf("/dev-hub")+1)}function l(a){if(a){window.location.href.indexOf("#")>0&&(window.location.hash="")}window.location.reload()}function m(a){return p(a)&&a.indexOf(".")<0}function n(a,b,c){var d=o(b,a);return d||(d=c.some(function(b){return o(b.items,a)})),d}function o(a,b){return a.filter(function(a){return a.id.toLowerCase()===b.toLowerCase()}).length>0}function p(a){return!!(a&&a.length&&a.length>0)&&(/^[\.0-9a-zA-Z_-]+$/.test(a)&&!/^\./.test(a))}function q(a){return/^[$A-Z_][0-9A-Z_$]*$/i.test(a)&&I.indexOf(a)===-1}function r(a){return/^[$A-Z_][0-9A-Z_$]*$/i.test(a)}function s(a){return I.indexOf(a)!==-1}function t(b,c,d){return d?a.isInteger(b)&&a.isInteger(c)&&b>=0&&c>=0&&c>=b:a.isInteger(b)&&a.isInteger(c)&&c>=b}function u(a){return!!a&&(!(a.lastIndexOf(".")<0)&&H.indexOf(a.substr(a.lastIndexOf(".")+1).toLowerCase())>-1)}function v(a){return/^[a-z]+[a-zA-Z0-9]*\b/g.test(a)}function w(a){return/[^A-Z0-9]/i.test(a)}function x(a){return a.substr(a.lastIndexOf(".")+1).toLowerCase()}function y(a){return a.substr(0,a.lastIndexOf("."))}function z(a){return a.replace(/[^a-z0-9]/gi,"-").toLowerCase()}function A(a){for(var b="",c=0;c<a.length-1;c++)b+="."+a[c]+", ";return b+="."+a[a.length-1]}function B(){G||(G=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,c.fn.mutation=function(a,b,c){if(G)return b=b||{subtree:!1,attributes:!0},F=new G(function(b){b.forEach(function(b){c?c(b,a):a(b.target,b.attributeName,b)})}),this.each(function(){F.observe(this,b)})})}function C(a,b){b?(a.find("span[q-title-translation='Devhub.EditItem']").css({"pointer-events":"all"}),a.find("*").not("span[q-title-translation='Devhub.EditItem']").css({"pointer-events":"none"})):a.find("*").css({"pointer-events":"auto"})}function D(){var a=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return("x"===b?c:3&c|8).toString(16)})}function E(a,b,c){function d(a){a.debounceTimer&&clearTimeout(a.debounceTimer),a.debounceTimer=null}return function(){var e,f=this,g=arguments;d(c),e=setTimeout(function(){a.apply(f,g)},b),c.debounceTimer=e}}var F,G,H=["js","css","html","json"],I=["break","do","instanceof","typeof","case","else","new","var","catch","finally","return","void","continue","for","switch","while","debugger","function","this","with","default","if","throw","delete","in","try","class","enum","extends","super","const","export","import","implements","let","private","public","yield","interface","package","protected","static","null","true","false"];return{getURLParameter:f,getURLParameters:g,setBrowserTitle:h,getHashParameter:j,getPrefix:k,reload:l,isInteger:function(b){return a.isInteger(b)},extend:function(){return b.extend.apply(null,arguments)},deepCopy:function(){return b.copy.apply(null,arguments)},isValidExtensionName:m,isExistingExtensionName:n,isValidName:p,isValidFunctionName:q,isJsReservedWord:s,isValidSyntax:r,isValidInterval:t,isValidCamelCase:v,hasInvalidCharacters:w,sanitizeFileName:z,hasValidFileExtension:u,getFileExtension:x,getFileName:y,fileExtensionArrayToString:A,objectToArray:i,addMutationObserver:B,toggleElementSubtreeInteraction:C,generateId:D,debounce:E,components:d,conversions:e,__onlytest__:{_isIdInList:o}}}),define("dev-hub.services/message-service",["core.utils/environment"],function(a){function b(a,b,c){this.message=a,this.source=b,this.type=c}function c(b){var c;switch(b.type){case h.ERROR:c=console.error;break;case h.WARNING:c=console.warn;break;case h.INFO:c=console.info}i||a.inClient()||c(b.type.name," ",b.message)}function d(a,d){c(new b(a,d,h.ERROR))}function e(a,d){c(new b(a,d,h.WARNING))}function f(a,d){c(new b(a,d,h.INFO))}function g(a){i=a}var h={ERROR:{value:0,name:"Error"},WARNING:{value:1,name:"Warning"},INFO:{value:2,name:"Information"}},i=!1;return{error:d,warn:e,info:f,suppress:g}}),define("dev-hub.custom-components/custom-component-wrapper",["dev-hub.services/message-service","ng!$compile"],function(a,b){function c(b,c){if(b.internal)return b.data.version;for(var d in c)if(d===b.data.name)return c[d];var e="Component "+b.data.name+" not found in the dependency.";a.warn(e,"custom component wrapper")}function d(a){for(var b=a;a.length>1&&/[A-Z]/.test(b);)b=b.replace(/([a-z\d])([A-Z])/g,function(a,b,c){return b+"-"+c.toLowerCase()});return b}function e(a,e){return{restrict:"E",scope:{},priority:1001,compile:function(f){var g=f[0].outerHTML;return{pre:function(f,h){for(var i,j=f;j.$parent;){if(j.layout){i=j.layout.dependencies;break}j=j.$parent}var k=i?c(e,i):e.data.version,l=d(a),m=g.replace(l,l+"."+k),n=b(m)(f.$parent);h.replaceWith(n)}}}}}return{getComponentWrapper:e,__onlytest__:{_getAppropriateVersion:c,_camelCaseToDash:d}}});define("dev-hub.custom-components/custom-component-loader",["qvangular","core.utils/deferred","dev-hub.lib/utils","dev-hub.custom-components/custom-component-wrapper","dev-hub.services/message-service","core.utils/feature-flags"],function(a,b,c,d,e,f){function g(){return!!f.CUSTOM_COMPONENTS&&f.CUSTOM_COMPONENTS}function h(a){var c=new b,d=this,e=[];return a.forEach(function(a){e.push(d._requireComponent(a))}),b.all(e,function(){c.resolve(l)}).catch(function(){c.resolve()}).finally(function(){c.resolve(l)}),c.promise}function i(c,f){var h=new b;if(f)Array.isArray(f)||(f=[f]),f.forEach(function(b){var e=b;if(g()){var f=b.componentName;m.has(f+"Directive")||a.directive(f,function(){return d.getComponentWrapper(b.componentName,c)});var h=b.componentName+"."+c.data.version;m.has(h+"Directive")||(a.directive(h,function(){return e}),l[b.path]=b)}else m.has(b.componentName+"Directive")||(a.directive(b.componentName,function(){return e}),l[b.path]=b)}),h.resolve(f);else{var i="Plugin is invalid or missing, '"+JSON.stringify(f)+"'";e.warning(i,"custom component loader"),h.resolve({success:!1,error:"plugin is invalid or missing"})}return h.promise}function j(a){var c=new b;return l[a.path]?c.resolve(l[a.path]):require([a.path],function(b){k(b).then(function(d){if(d.success)b.path=a.path,c.resolve(i(a,b));else{var f=d.error+": '"+a.data.name+"' - "+d.reason;e.error(f,"Custom component loader"),c.resolve(d)}})},function(){c.resolve({success:!1,error:"Require failed while loading the custom component: '"+a.data.name+"'."})}),c.promise}function k(a){var d=new b,e={success:!1,error:"Validation for the custom component failed"};return a&&a.componentName?c.hasInvalidCharacters(a.componentName)?e.reason="The name must not contain white-spaces or special characters: "+a.componentName:c.isValidCamelCase(a.componentName)?e={success:!0,error:void 0}:e.reason="Invalid component name:"+a.componentName+". Only lower camel case is allowed.":e.reason="The property componentName is undefined.",d.resolve(e),d.promise}var l={},m=a.getService("$injector");return{load:h,validateComponent:k,loadedCustomComponents:l,_requireComponent:j,_registerComponent:i}}),define("dev-hub.custom-components/custom-components",["core.utils/deferred","dev-hub.custom-components/custom-component-loader","general.models/library/extension-list","dev-hub.services/message-service","core.utils/feature-flags"],function(a,b,c,d,e){function f(){return!!e.CUSTOM_COMPONENTS&&e.CUSTOM_COMPONENTS}function g(a){var c=this;return this.getList().then(function(d){return f()?c._filterListByDependencies(d,a).then(function(a){return b.load(a)}):b.load(d)})}function h(){var a=[],b=this;return b._getInternalComponents().then(function(c){return a=a.concat(c),b._getExternalComponents().then(function(b){return a=a.concat(b)})})}function i(b,c){b||(b=l);var d=new a;if(!c&&m.length>0)d.resolve(m);else{var e=[];b.forEach(function(a){e.push("text!dev-hub.custom-components/"+a+"/"+a+".qext")}),require(e,function(){for(var a=0;a<arguments.length;a++){var b=JSON.parse(arguments[a]),c={id:b.name,data:b,internal:!0,path:"dev-hub.custom-components/"+b.name+"/"+b.name};m.push(c)}d.resolve(m)},function(a){d.reject(a)})}return d.promise}function j(){var a=[];return c.getList().then(function(b){return b.forEach(function(b){b.data&&"component"===b.data.type&&(b.path="extensions/"+b.id+"/"+b.id,a.push(b))}),a})}function k(b,c){var e=new a,f=[];f=b.filter(function(a){return a.internal});for(var g in c){var h=c[g],i=!1,j=g.toLowerCase();if(b.forEach(function(a){if(a.data.name.toLowerCase()===j&&a.data.version===h)return f.push(a),void(i=!0)}),!i){var k="No matching component found for "+g+" (version: "+h+")";d.error(k,"custom components")}}return e.resolve(f),e.promise}var l=["qw-sys-info","qw-console"],m=[];return{init:g,getList:h,validateComponent:b.validateComponent,_getInternalComponents:i,_getExternalComponents:j,_filterListByDependencies:k,isEnabled:f}}),define("dev-hub.lib/assets-files-utils",["qvangular","underscore","core.utils/deferred","translator","dev-hub.lib/utils","general.services/content-api/content-api"],function(a,b,c,d,e){"use strict";function f(a,b){var c=e.getFileExtension(a),d=t(c);return b instanceof ArrayBuffer&&(b=new Blob([b])),{fileName:a,extension:c,content:b||d.defaultContent,contentType:null,mode:d.editorMode,lastModified:null,isDirty:!0}}function g(a){return["gif","png","jpeg","jpg"].indexOf(a)>-1}function h(a){return["eot","woff","woff2","ttf","otf"].indexOf(a)>-1}function i(a,b){var e=new c,f=[];return a.isDirty()&&a.files.forEach(function(c){if(c.isDirty){if(!g(c.extension)){var d=b?b(c.fileName):void 0;c.content=c.newContent?c.newContent:d?d.getValue():c.content}f.push(C(a.extensionUniqueName,c))}}),c.all(f).then(function(){e.resolve(a)},function(a){e.reject({errName:"ExtensionUploadToQRSErr",errMessage:d.get(a.errMessage),errObject:a})}),e.promise}function j(a,b){return b.files.filter(function(b){return b.fileName.toLowerCase()===a.toLowerCase()}).length>0}function k(a,b){var d=new c;return d.resolve(b.files.splice(b.files.indexOf(a),1)),d.promise}function l(a,b){var c={method:"GET",url:"/extensions/"+a+"/"+b,cache:!1};return g(e.getFileExtension(b))||h(e.getFileExtension(b))?c.responseType="blob":c.transformResponse=function(a){return a},F.request(c)}function m(a,b){var d=new c;return F.request({method:"GET",url:"/extensions/"+a+"/"+b}).success(function(){d.resolve(!0)}).error(function(){d.resolve(!1)}),d.promise}function n(a){var b=new c;return F.request({method:"DELETE",url:"/qrs/extension/name/"+a}).success(function(){b.resolve()}).error(function(c){b.reject({errMsg:d.get("Devhub.ErrorExtensionDelete",a),errObject:c})}),b.promise}function o(a){var b=new c;return F.request({method:"POST",url:"/qrs/extension/name/"+a.name,data:JSON.stringify(a,null,"\t")}).success(function(){b.resolve(a)}).error(function(a){b.reject({errName:"errCreateExtension",errMessage:d.get("Devhub.ErrorCreateExtension"),errObject:a})}),b.promise}function p(a,b){var d=e.getFileExtension(b),f=t(d),g=new c;return l(a,b).success(function(a,c,e){g.resolve({success:!0,file:{fileName:b,extension:d,content:a,contentType:e()["content-type"],mode:f.editorMode,lastModified:e()["last-modified"],isDirty:!1}})}).error(function(a){g.resolve({success:!1,errObject:a,file:{fileName:b,extension:d,content:f.defaultContent,contentType:null,mode:f.editorMode,lastModified:null,isDirty:!0,loadingErr:a}})}),g.promise}function q(a){var b=new c,e=new FileReader;return e.onload=function(c){b.resolve(f(a.name,c.target.result))},e.onerror=function(a){b.reject({errName:"errFileReader",errMessage:d.get("Devhub.ErrorReadingLocalFile"),errObject:a})},(!a.type.match("image.*")&&!a.type.match("font")||a.type.match("svg")&&a.type.match("xml"))&&""!==a.type?e.readAsText(a):e.readAsArrayBuffer(a),b.promise}function r(a){var b=[],e=new c;return l(a,"wbfolder.wbl").success(function(f){if(f.length>0){y(f).forEach(function(c){b.push(p(a,c))}),c.all(b).then(function(a){var b=a.map(function(a){return a.file});e.resolve(b)}).catch(function(b){e.reject({errName:"loadFilesFromRepo",errMessage:d.get("Devhub.ErrorLoadingFilesFromRepo",a),errObject:b})})}else e.reject({errName:"wbFolderEmpty",errMessage:d.get("Devhub.wbFolderEmpty",a)})}).error(function(){e.reject({errName:"ErrorIncompleteWbFolder",errMessage:d.get("Devhub.ErrorIncompleteWbFolder",a)})}),e.promise}function s(a){var b=new c
;return l(a,"wbfolder.wbl").success(function(a){b.resolve(a)}).error(function(){b.reject()}),b.promise}function t(a){switch(a.toLowerCase()){case"html":return{defaultContent:"<div></div>",editorMode:"htmlmixed"};case"js":return{defaultContent:"// JavaScript\r\n",editorMode:"javascript"};case"qext":case"json":return{defaultContent:"{\r\n\r\n}",editorMode:"javascript"};case"css":return{defaultContent:"/* CSS */\r\n",editorMode:"css"};case"gif":case"png":case"jpg":case"jpeg":return{defaultContent:void 0,editorMode:void 0};default:return{defaultContent:"",editorMode:"javascript"}}}function u(a,b){var e=new c;return r(a).then(function(c){var g=x(c),h=g.replace("-template",""),j=/-template/.test(g)?v(c,a,b):w(c,a,b);if(j.push(f("wbfolder.wbl",B(j))),h){j.forEach(function(a){a.isDirty=!0});var k={extensionUniqueName:b,files:j,type:h,isDirty:function(){return!0}};o({name:b,type:h}).then(function(){i(k).then(function(a){e.resolve(a)}).catch(function(a){e.reject({errName:"errDuplicateExtensionTasks",errMessage:d.get("Devhub.ErrorCopyingExtension"),errObject:a})})}).catch(function(a){e.reject({errName:"errDuplicateExtensionTasks",errMessage:d.get("Devhub.ErrorCopyingExtension"),errObject:a})})}}).catch(function(a){e.reject(a)}),e.promise}function v(a,b,c){return a.forEach(function(a){if(a.fileName=a.fileName.replace(b,c),a.content&&a.content.length>0&&(a.content.indexOf("${name}")>-1&&(a.content=a.content.replace(/\${name}/g,c)),["js","css","html","htm","json"].indexOf(a.extension)>-1&&(a.content=a.content.replace(new RegExp(b,"g"),c)),"qext"===a.extension)){var d=JSON.parse(a.content);d.name=c,d.type=d.type.replace("-template",""),a.content=JSON.stringify(d,null,"\t")}}),a}function w(a,b,c){var d=[];return a.forEach(function(a){var e=a.fileName,f=!1;if(new RegExp("^("+b+"\\.)","i").test(a.fileName)&&(a.fileName=f=a.fileName.replace(b,c),d[e]=f),a.content&&a.content.length>0&&"qext"===a.extension){var g=JSON.parse(a.content);g.name=c,a.fileName=c+"."+a.extension,a.content=JSON.stringify(g,null,"\t")}}),a.forEach(function(a){if(["js","css","html","htm","json"].indexOf(a.extension)>-1){var b;for(var c in d)b=new RegExp(c,"g"),a.content=a.content.replace(b,d[c]);["css"].indexOf(a.extension)>-1&&(b=new RegExp(c.split(".")[0],"g"),a.content=a.content.replace(b,d[c].split(".")[0]))}}),a}function x(a){var c=b.findWhere(a,{extension:"qext"});if(c&&c.content)return JSON.parse(c.content).type}function y(a){return a.replace(/[\r\n]/g,"").split(";").filter(function(a){return""!==a.trim()})}function z(a){var b=new c;return l(a,"wbfolder.wbl").success(function(a){if(a.length>0){var c=y(a);1===c.filter(function(a){return"qext"===e.getFileExtension(a)}).length?b.resolve(c):b.reject({errName:"moreThanOneQEXT",errMessage:d.get("Devhub.ErrorMoreThanOneQEXT")})}}).error(function(){b.reject({errName:"ErrorIncompleteWbFolder",errMessage:d.get("Devhub.ErrorIncompleteWbFolder",a)})}),b.promise}function A(a,b){return C(a,f("wbfolder.wbl",B(b)))}function B(a){return a.map(function(a){return a.fileName}).join(";\r\n")}function C(a,b){var e=new c;return F.request({method:"POST",url:"/qrs/extension/"+a+"/uploadfile?externalpath="+encodeURIComponent(b.fileName)+"&overwrite=true",data:b.content}).success(function(){l(a,b.fileName).success(function(a,c,d){b.lastModified=d("last-modified"),b.isDirty=!1,e.resolve(b)}).error(function(a){e.reject({errName:"LoadFileFromQRSErr",errMessage:d.get("Devhub.ErrorReadingLocalFile",b.fileName),errObject:a})})}).error(function(a){e.reject({errName:"ExtensionUploadToQRSErr",errMessage:d.get("Devhub.ErrorCreatingFile",b.fileName),errObject:a})}),e.promise}function D(a){var b=new c;return F.getExtensions().then(function(c){a===!0?b.resolve(M(c)):b.resolve(c)}),b.promise}function E(a){return D(!0).then(function(c){return b.filter(c.extensionList,function(b){return b.qext.type===a})})}var F=a.getService("$contentApi"),G=function(){d.setup({context:"devhub",language:"en"}).then(function(){})},H=function(a,b){var e=new c;if(j(a,b))e.reject({errorMsg:d.get("Devhub.FileAlreadyExists",a)});else{var g=L(a,!0);g.success===!0?m(b.extensionUniqueName,a).then(function(c){c===!0?e.reject({errorMsg:d.get("Devhub.FileAlreadyExists",a)}):C(b.extensionUniqueName,f(a,null)).then(function(a){a.isDirty=!0,b.files.push(a),A(b.extensionUniqueName,b.files).then(function(){e.resolve(b)}).catch(function(a){e.reject(a)})}).catch(function(a){e.reject(a)})}):e.reject({errorMsg:g.errorMsg})}return e.promise},I=function(a,d){var e=new c,f=b.extend({},d);return f.files=d.files.slice(),k(a,f),c.all({deleteFileFromRepo:J(d.extensionUniqueName,a.fileName),saveFilesToWbFolder:A(d.extensionUniqueName,f.files)}).then(function(){k(a,d),e.resolve(d)}).catch(function(a){e.reject(a)}),e.promise},J=function(a,b){var d=new c;return m(a,b).then(function(c){c?F.request({method:"DELETE",url:"/qrs/extension/"+a+"/deletecontent?externalpath="+b}).success(function(){d.resolve()}).error(function(a){d.reject(a)}):d.resolve()}),d.promise},K=function(a,e){var f=new c;return q(a).then(function(a){if(j(a.fileName,e))f.reject({errMessage:d.get("Devhub.ErrorImportDuplicateFile",a.fileName)});else{var g=b.extend({},e);g.files=e.files.slice(),g.files.push(a),c.all({saveFileInRepo:C(e.extensionUniqueName,a),saveFilesToWbFolder:A(e.extensionUniqueName,g.files)}).then(function(a){a.saveFileInRepo.selected=!0,f.resolve(g)}).catch(function(a){f.reject(a)})}}).catch(function(a){f.reject({errName:"errorReadLocalFile",errMessage:d.get("Devhub.ErrorReadingLocalFile"),errObject:a})}),f.promise},L=function(a,b){if(b)return/^[\.0-9a-zA-Z_-]+\..{2,4}$/.test(a)&&e.hasValidFileExtension(a)?{success:!0}:{success:!1,errorMsg:d.get("Devhub.InvalidFileName")};var c=a&&e.isValidExtensionName(a);return{success:c,errorMsg:c?void 0:d.get("Devhub.InvalidExtensionName")}},M=function(a){var b={extensionList:[],templateList:[]};for(var c in a){var d=/^(.*)\-template$/.exec(a[c].type);if(d){var f=d[1],g=b.templateList.filter(function(a){return a.type===f});if(g.length>0)g[0].items.push({id:c,name:a[c].name||c,title:a[c].name||c});else{var h={type:f,items:[{id:c,name:a[c].name||c,title:a[c].name||c}]};b.templateList.push(h)}}else b.extensionList.push({id:c,title:a[c].name||c,qext:a[c],src:a[c].preview&&a[c].preview.indexOf(".")!==-1?e.getPrefix()+"extensions/"+c+"/"+a[c].preview:""})}return b};return{init:G,isValidFileName:L,isFileInAssets:j,isImage:g,getWbFolder:s,createFileObject:f,getExtensionFileObjectsFromRepo:r,getExtensionFileListFromRepo:z,saveFileInRepo:C,saveFilesToRepo:i,removeFileFromAssets:k,addNewFile:H,getExtensionsFromRepo:D,getExtensionsByType:E,deleteExtensionFromRepo:n,deleteFileFromRepo:J,deleteFile:I,importFromLocal:K,duplicateExtension:u,saveFilesToWbFolder:A,readLocalFile:q,createExtensionInRepo:o,_loadFileFromRepo:l,__onlytest__:{_getFileDefaults:t,_getFilesFromWbFolderContent:y,_isFileInRepo:m}}}),define("dev-hub.models/widget-file",["core.utils/deferred","qvangular","general.models/library/extension-list","dev-hub.lib/assets-files-utils","general.services/content-api/content-api"],function(a,b,c,d){function e(a){return(a.libid?a.libid:a.id)+"/"+a.id}function f(a){var b=A.filter(function(b){return b.data.widgets&&b.data.widgets.indexOf(a)>-1});return b.length>1&&console.log("Duplicate libraries for widget:"+a,b),b[0]}function g(b){if(!y||b){y=new a;var d=[];c.getList(b).then(function(a){A.length=0,a.forEach(function(a){"widget-library"===a.data.type&&(A.push(a),a.data.widgets&&a.data.widgets.forEach(function(b){d.push({libid:a.id,id:b})}))}),y.resolve(d)})}return y.promise}function h(b){var d=[],e=new a;return c.getList(!1).then(function(a){A.length=0,a.forEach(function(a){"widget-library"===a.data.type&&a.id===b&&(A.push(a),a.data.widgets&&a.data.widgets.forEach(function(b){d.push({libid:a.id,id:b})}))}),e.resolve(d)}),e.promise}function i(a,c){return b.getService("$contentApi").request({method:"GET",url:"/extensions/"+a+(c?"?"+(new Date).getTime():""),cache:!1,transformResponse:function(a){return a}})}function j(c,d,e){var f=new a;if(e)return i(c).success(function(a,b,g){g("last-modified")!==e?f.reject("File modified by another user"):j(c,d).then(function(){f.resolve()}).catch(function(a){f.reject(a)})}),f.promise;var g=c.split("/");return b.getService("$contentApi").request({method:"POST",url:"/qrs/extension/"+g[0]+"/uploadfile?externalpath="+g[1]+"&overwrite=true",data:d}).success(function(){f.resolve()}).error(function(a){f.reject(a)}),f.promise}function k(c){var d=new a,e=c.split("/");return b.getService("$contentApi").request({method:"DELETE",url:"/qrs/extension/"+e[0]+"/deletecontent?externalpath="+e[1]}).success(function(){d.resolve()}).error(function(a){d.reject(a)}),d.promise}function l(b){var c=new a;return j(e(b)+".qext",JSON.stringify(b.data,null,2)).then(function(){c.resolve()},function(a){c.reject(a)}),c.promise}function m(a){return k(e(a)+".qext")}function n(a,b){return d.createExtensionInRepo({name:a,description:b,type:"widget-library"})}function o(b){var c=new a;return i(b+"/"+b+".qext",!0).success(function(a){var b=JSON.parse(a);c.resolve(b)}).error(function(a){c.reject(a)}),c.promise}function p(b,c){var d=new a;return o(b).then(function(a){a.widgets||(a.widgets=[]),a.widgets.push(c),l({id:b,data:a}).then(function(){d.resolve()},function(a){d.reject(a)})}),d.promise}function q(b,c){var d=new a;return o(b).then(function(a){a.widgets?(a.widgets=a.widgets.filter(function(a){return a!==c}),l({id:b,data:a}).then(function(){d.resolve()},function(a){d.reject(a)})):d.reject()}),d.promise}function r(){var b=new a;return c.getList(!0).then(function(a){A.length=0,a.forEach(function(a){"widget-library"===a.data.type&&A.push(a)}),b.resolve()}).catch(function(a){b.reject(a)}),b.promise}function s(b){var c=new a,d=e(b);return j(d+".json",JSON.stringify({name:b.name,description:b.description,author:b.author,library:b.libid,meta:b.meta,properties:b.properties,dependencies:b.dependencies},null,2),b.lastModified).then(function(){var a="<style>"+b.css+"</style>\n<div>"+b.html+"</div>";j(d+".html",a).then(function(){b.lastModified?i(d+".json",!0).success(function(a,c,d){b.lastModified=d("last-modified")}).then(function(){c.resolve()}):p(b.libid,b.id).then(function(){i(d+".json",!0).success(function(a,c,d){b.lastModified=d("last-modified")}).then(function(){c.resolve()})})},function(a){c.reject(a)})},function(a){c.reject(a)}),c.promise}function t(b){var c=new a;return i(b+".json",!0).success(function(a,b,d){try{var e=JSON.parse(a);e.lastModified=d("last-modified"),c.resolve(e)}catch(a){c.reject(a)}}).error(function(){c.reject()}),c.promise}function u(a,b){var c=a+"/"+b;return z[c]||(z[c]=t(c)),z[c]}function v(b){var c=new a,d=e(b);return k(d+".json").then(function(){q(b.libid,b.id).then(function(){k(d+".html").then(function(){delete z[d],c.resolve()},function(a){c.reject(a)})},function(a){c.reject(a)})},function(){c.reject()}),c.promise}function w(b){var c=new a;return i(e(b)+".html",!0).success(function(a){var d=document.createElement("div");d.innerHTML=a;for(var e=d.getElementsByTagName("script"),f=e.length;f--;)e[f].parentNode.removeChild(e[f]);var g=d.getElementsByTagName("style");if(1===g.length){b.css=g[0].innerHTML;var h=d.getElementsByTagName("div");b.html=h[0].innerHTML,c.resolve()}else c.reject("Widget.InvalidTemplate")}).error(function(){c.reject()}),c.promise}function x(b){var c=e(b);if(!z[c]){var d=new a;z[c]=d.promise,d.resolve(b)}}var y,z={},A=[];return{saveTemplate:s,getTemplate:u,deleteTemplate:v,addTemplate:x,getWidgetList:g,getWidgetListFromLibrary:h,loadWidget:w,getLibForId:f,loadFile:i,getLibrary:o,saveLibrary:l,deleteLibrary:m,createLibrary:n,reloadCachedLibraries:r}}),define("dev-hub.models/widget-template",["core.utils/deferred","translator","./widget-file","core.utils/notification"],function(a,b,c,d){function e(a){var b=null;f.forEach(function(c,d){a.id===c.id&&(b=d)}),null===b?f.push(a):f[b]=a,g[a.id]=a}var f=[],g={},h="",i=[{id:"chart",name:"Widget.Type.chart",icon:"line-chart"},{id:"table",name:"Widget.Type.table",icon:"table"},{id:"kpi",name:"Widget.Type.kpi",icon:"kpi"},{id:"navigation",name:"Widget.Type.navigation",icon:"navigation"},{id:"other",name:"Widget.Type.other"}],j=function(a,b,c,d,e,f,g,h,i){this._version=0,f||(f={}),Object.defineProperties(this,{libid:{value:a},id:{value:b},name:{value:c,writable:!0},description:{value:d,writable:!0},author:{value:e,writable:!0},meta:{value:f,writable:!0},dummy:{value:i===!0?"true":null},html:{get:function(){return this._html},set:function(a){this._html=a,this._version++}},css:{get:function(){return this._css},set:function(a){this._css=a,this._version++}},properties:{value:g,writable:!0},dependencies:{value:h,writable:!0},version:{get:function(){return this._version}},isLoaded:{get:function(){return void 0!==this._html}}})};return j.getIcon=function(a){var b;return i.forEach(function(c){c.id===a&&c.icon&&(b=c.icon)}),b||"widget"},j.prototype.load=function(a){return this.loadDfd&&!a||(this.loadDfd=c.loadWidget(this)),this.loadDfd},j.prototype.save=function(){var a=this;return c.saveTemplate(this).then(function(){return j.Updated.emit(f),a})},j.prototype.copy=function(a){return j.add({libid:a.libid||this.libid,id:a.id||this.id,name:a.name||this.name,description:a.description||""===a.description?a.description:this.description,author:a.author||this.author,meta:a.meta||this.meta,html:a.html||this.html,css:a.css||this.css,properties:a.properties||this.properties})},j.prototype.delete=function(){var a=c.deleteTemplate(this),b=this;return f.forEach(function(a,c){a.id===b.id&&f.splice(c,1)}),g&&g[b.id]&&delete g[b.id],a.then(function(){j.Updated.emit(f)}),a},j.prototype.move=function(a){var b=this,d=this.copy({libid:a});return d.save().then(function(){return b.delete().then(function(){return c.reloadCachedLibraries().then(function(){return d})})})},j.getTemplateListFromLibrary=function(b){var d=[],e=new a;return f.length=0,c.getWidgetListFromLibrary(b).then(function(b){b.forEach(function(a){d.push(j.get(a.id,!0,a.libid))}),a.all(d).then(function(){e.resolve(f)})}),e.promise},j.getTemplateList=function(b){var d=[];return h&&!b||(h=new a,c.getWidgetList(b).then(function(b){b.forEach(function(a){d.push(j.get(a.id,!0,a.libid))}),a.all(d).then(function(){h.resolve(f)})})),h.promise},j.getLoaded=function(a){return g[a]},j.resetWidgetsProperties=function(a){g[a].propertiesObj&&g[a].propertiesObj.lastSavedProperties&&(g[a].properties=g[a].propertiesObj.lastSavedProperties)},j.get=function(d,f,h){if(d.indexOf("/")>-1){var i=d.split("/");h=i[0],d=i[1]}var k=new a;if(g[d]){var l=g[d];l.isLoaded||f?k.resolve(l):l.load().then(function(){k.resolve(l)},function(a){k.reject(a)})}else{if(!h){var m=c.getLibForId(d);h=m?m.id:void 0}h?c.getTemplate(h,d).then(function(a){a.properties||(a.properties={});var c=new j(h,d,a.name||b.get("Widget.NoName"),a.description||"",a.author||"",a.meta||{},a.properties,a.dependencies||{});c.lastModified=a.lastModified,e(c),c.isLoaded||f?k.resolve(c):c.load().then(function(){k.resolve(c)},function(a){c.err=a,k.resolve(c)})},function(){var a=new j(h,d);k.resolve(a)}):k.reject(b.get("Error.NoLibraryForWidget",d))}return k.promise},j.add=function(a){if(!a.id||!a.libid)return!1;var b=new j(a.libid,a.id,a.name||"",a.description||"",a.author||"",a.meta,a.properties,a.dependencies||{},a.dummy);return b.html=a.html||"",b.css=a.css||"",e(b),c.addTemplate(b),j.Updated.emit(f),b},d.create(j,"Updated"),j.types=i,j}),/** * @license 
 */
function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define("assets/external/less/less",[],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.less=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=a("./utils").addDataAttr,e=a("./browser");b.exports=function(a,b){d(b,e.currentScript(a)),void 0===b.isFileProtocol&&(b.isFileProtocol=/^(file|(chrome|safari)(-extension)?|resource|qrc|app):/.test(a.location.protocol)),b.async=b.async||!1,b.fileAsync=b.fileAsync||!1,b.poll=b.poll||(b.isFileProtocol?1e3:1500),b.env=b.env||("127.0.0.1"==a.location.hostname||"0.0.0.0"==a.location.hostname||"localhost"==a.location.hostname||a.location.port&&a.location.port.length>0||b.isFileProtocol?"development":"production");var c=/!dumpLineNumbers:(comments|mediaquery|all)/.exec(a.location.hash);c&&(b.dumpLineNumbers=c[1]),void 0===b.useFileCache&&(b.useFileCache=!0),void 0===b.onReady&&(b.onReady=!0)}},{"./browser":3,"./utils":9}],2:[function(a,b,c){a("promise/polyfill.js");var d=window.less||{};a("./add-default-options")(window,d);var e=b.exports=a("./index")(window,d);window.less=e,d.onReady&&(/!watch/.test(window.location.hash)&&e.watch(),e.registerStylesheetsImmediately(),e.pageLoadFinished=e.refresh("development"===e.env))},{"./add-default-options":1,"./index":7,"promise/polyfill.js":95}],3:[function(a,b,c){var d=a("./utils");b.exports={createCSS:function(a,b,c){var e=c.href||"",f="less:"+(c.title||d.extractId(e)),g=a.getElementById(f),h=!1,i=a.createElement("style");i.setAttribute("type","text/css"),c.media&&i.setAttribute("media",c.media),i.id=f,i.styleSheet||(i.appendChild(a.createTextNode(b)),h=null!==g&&g.childNodes.length>0&&i.childNodes.length>0&&g.firstChild.nodeValue===i.firstChild.nodeValue);var j=a.getElementsByTagName("head")[0];if(null===g||h===!1){var k=c&&c.nextSibling||null;k?k.parentNode.insertBefore(i,k):j.appendChild(i)}if(g&&h===!1&&g.parentNode.removeChild(g),i.styleSheet)try{i.styleSheet.cssText=b}catch(a){throw new Error("Couldn't reassign styleSheet.cssText.")}},currentScript:function(a){var b=a.document;return b.currentScript||function(){var a=b.getElementsByTagName("script");return a[a.length-1]}()}}},{"./utils":9}],4:[function(a,b,c){b.exports=function(a,b,c){var d=null;if("development"!==b.env)try{d=void 0===a.localStorage?null:a.localStorage}catch(a){}return{setCSS:function(a,b,e){if(d){c.info("saving "+a+" to cache.");try{d.setItem(a,e),d.setItem(a+":timestamp",b)}catch(b){c.error('failed to save "'+a+'" to local storage for caching.')}}},getCSS:function(a,b){var c=d&&d.getItem(a),e=d&&d.getItem(a+":timestamp");if(e&&b.lastModified&&new Date(b.lastModified).valueOf()===new Date(e).valueOf())return c}}}},{}],5:[function(a,b,c){var d=a("./utils"),e=a("./browser");b.exports=function(a,b,c){function f(b,f){var g,h,i="less-error-message:"+d.extractId(f||""),j='<li><label>{line}</label><pre class="{class}">{content}</pre></li>',k=a.document.createElement("div"),l=[],m=b.filename||f,n=m.match(/([^\/]+(\?.*)?)$/)[1];k.id=i,k.className="less-error-message",h="<h3>"+(b.type||"Syntax")+"Error: "+(b.message||"There is an error in your .less file")+'</h3><p>in <a href="'+m+'">'+n+"</a> ";var o=function(a,b,c){void 0!==a.extract[b]&&l.push(j.replace(/\{line\}/,(parseInt(a.line,10)||0)+(b-1)).replace(/\{class\}/,c).replace(/\{content\}/,a.extract[b]))};b.extract&&(o(b,0,""),o(b,1,"line"),o(b,2,""),h+="on line "+b.line+", column "+(b.column+1)+":</p><ul>"+l.join("")+"</ul>"),b.stack&&(b.extract||c.logLevel>=4)&&(h+="<br/>Stack Trace</br />"+b.stack.split("\n").slice(1).join("<br/>")),k.innerHTML=h,e.createCSS(a.document,[".less-error-message ul, .less-error-message li {","list-style-type: none;","margin-right: 15px;","padding: 4px 0;","margin: 0;","}",".less-error-message label {","font-size: 12px;","margin-right: 15px;","padding: 4px 0;","color: #cc7777;","}",".less-error-message pre {","color: #dd6666;","padding: 4px 0;","margin: 0;","display: inline-block;","}",".less-error-message pre.line {","color: #ff0000;","}",".less-error-message h3 {","font-size: 20px;","font-weight: bold;","padding: 15px 0 5px 0;","margin: 0;","}",".less-error-message a {","color: #10a","}",".less-error-message .error {","color: red;","font-weight: bold;","padding-bottom: 2px;","border-bottom: 1px dashed red;","}"].join("\n"),{title:"error-message"}),k.style.cssText=["font-family: Arial, sans-serif","border: 1px solid #e00","background-color: #eee","border-radius: 5px","-webkit-border-radius: 5px","-moz-border-radius: 5px","color: #e00","padding: 15px","margin-bottom: 15px"].join(";"),"development"===c.env&&(g=setInterval(function(){var b=a.document,c=b.body;c&&(b.getElementById(i)?c.replaceChild(k,b.getElementById(i)):c.insertBefore(k,c.firstChild),clearInterval(g))},10))}function g(a,b){c.errorReporting&&"html"!==c.errorReporting?"console"===c.errorReporting?k(a,b):"function"==typeof c.errorReporting&&c.errorReporting("add",a,b):f(a,b)}function h(b){var c=a.document.getElementById("less-error-message:"+d.extractId(b));c&&c.parentNode.removeChild(c)}function i(a){}function j(a){c.errorReporting&&"html"!==c.errorReporting?"console"===c.errorReporting?i(a):"function"==typeof c.errorReporting&&c.errorReporting("remove",a):h(a)}function k(a,d){var e="{line} {content}",f=a.filename||d,g=[],h=(a.type||"Syntax")+"Error: "+(a.message||"There is an error in your .less file")+" in "+f+" ",i=function(a,b,c){void 0!==a.extract[b]&&g.push(e.replace(/\{line\}/,(parseInt(a.line,10)||0)+(b-1)).replace(/\{class\}/,c).replace(/\{content\}/,a.extract[b]))};a.extract&&(i(a,0,""),i(a,1,"line"),i(a,2,""),h+="on line "+a.line+", column "+(a.column+1)+":\n"+g.join("\n")),a.stack&&(a.extract||c.logLevel>=4)&&(h+="\nStack Trace\n"+a.stack),b.logger.error(h)}return{add:g,remove:j}}},{"./browser":3,"./utils":9}],6:[function(a,b,c){b.exports=function(b,c){function d(){if(window.XMLHttpRequest&&!("file:"===window.location.protocol&&"ActiveXObject"in window))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){return c.error("browser doesn't support AJAX."),null}}var e=a("../less/environment/abstract-file-manager.js"),f={},g=function(){};return g.prototype=new e,g.prototype.alwaysMakePathsAbsolute=function(){return!0},g.prototype.join=function(a,b){return a?this.extractUrlParts(b,a).path:b},g.prototype.doXHR=function(a,e,f,g){function h(b,c,d){b.status>=200&&b.status<300?c(b.responseText,b.getResponseHeader("Last-Modified")):"function"==typeof d&&d(b.status,a)}var i=d(),j=b.isFileProtocol?b.fileAsync:b.async;"function"==typeof i.overrideMimeType&&i.overrideMimeType("text/css"),c.debug("XHR: Getting '"+a+"'"),i.open("GET",a,j),i.setRequestHeader("Accept",e||"text/x-less, text/css; q=0.9, */*; q=0.5"),i.send(null),b.isFileProtocol&&!b.fileAsync?0===i.status||i.status>=200&&i.status<300?f(i.responseText):g(i.status,a):j?i.onreadystatechange=function(){4==i.readyState&&h(i,f,g)}:h(i,f,g)},g.prototype.supports=function(a,b,c,d){return!0},g.prototype.clearFileCache=function(){f={}},g.prototype.loadFile=function(a,b,c,d,e){b&&!this.isPathAbsolute(a)&&(a=b+a),c=c||{};var g=this.extractUrlParts(a,window.location.href),h=g.url;if(c.useFileCache&&f[h])try{var i=f[h];e(null,{contents:i,filename:h,webInfo:{lastModified:new Date}})}catch(a){e({filename:h,message:"Error loading file "+h+" error was "+a.message})}else this.doXHR(h,c.mime,function(a,b){f[h]=a,e(null,{contents:a,filename:h,webInfo:{lastModified:b}})},function(a,b){e({type:"File",message:"'"+b+"' wasn't found ("+a+")",href:h})})},g}},{"../less/environment/abstract-file-manager.js":14}],7:[function(a,b,c){var d=a("./utils").addDataAttr,e=a("./browser");b.exports=function(b,c){function f(a){return c.postProcessor&&"function"==typeof c.postProcessor&&(a=c.postProcessor.call(a,a)||a),a}function g(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function h(a,b){var c=Array.prototype.slice.call(arguments,2);return function(){var d=c.concat(Array.prototype.slice.call(arguments,0));return a.apply(b,d)}}function i(a){for(var b,d=m.getElementsByTagName("style"),e=0;e<d.length;e++)if(b=d[e],b.type.match(t)){var f=g(c);f.modifyVars=a;var i=b.innerHTML||"";f.filename=m.location.href.replace(/#.*$/,""),n.render(i,f,h(function(a,b,c){b?r.add(b,"inline"):(a.type="text/css",a.styleSheet?a.styleSheet.cssText=c.css:a.innerHTML=c.css)},null,b))}}function j(a,b,e,h,i){function j(c){var d=c.contents,g=c.filename,i=c.webInfo,j={currentDirectory:q.getPath(g),filename:g,rootFilename:g,relativeUrls:k.relativeUrls};if(j.entryPath=j.currentDirectory,j.rootpath=k.rootpath||j.currentDirectory,i&&(i.remaining=h,!k.modifyVars)){var l=s.getCSS(g,i);if(!e&&l)return i.local=!0,void b(null,l,d,a,i,g)}r.remove(g),k.rootFileInfo=j,n.render(d,k,function(c,e){c?(c.href=g,b(c)):(e.css=f(e.css),k.modifyVars||s.setCSS(a.href,i.lastModified,e.css),b(null,e.css,d,a,i,g))})}var k=g(c);d(k,a),k.mime=a.type,i&&(k.modifyVars=i),q.loadFile(a.href,null,k,o,function(a,c){if(a)return void b(a);j(c)})}function k(a,b,c){for(var d=0;d<n.sheets.length;d++)j(n.sheets[d],a,b,n.sheets.length-(d+1),c)}function l(){"development"===n.env&&(n.watchTimer=setInterval(function(){n.watchMode&&(q.clearFileCache(),k(function(a,c,d,f,g){a?r.add(a,a.href||f.href):c&&e.createCSS(b.document,c,f)}))},c.poll))}var m=b.document,n=a("../less")();n.options=c;var o=n.environment,p=a("./file-manager")(c,n.logger),q=new p;o.addFileManager(q),n.FileManager=p,a("./log-listener")(n,c);var r=a("./error-reporting")(b,n,c),s=n.cache=c.cache||a("./cache")(b,c,n.logger);c.functions&&n.functions.functionRegistry.addMultiple(c.functions);var t=/^text\/(x-)?less$/;return n.watch=function(){return n.watchMode||(n.env="development",l()),this.watchMode=!0,!0},n.unwatch=function(){return clearInterval(n.watchTimer),this.watchMode=!1,!1},n.registerStylesheetsImmediately=function(){var a=m.getElementsByTagName("link");n.sheets=[];for(var b=0;b<a.length;b++)("stylesheet/less"===a[b].rel||a[b].rel.match(/stylesheet/)&&a[b].type.match(t))&&n.sheets.push(a[b])},n.registerStylesheets=function(){return new Promise(function(a,b){n.registerStylesheetsImmediately(),a()})},n.modifyVars=function(a){return n.refresh(!0,a,!1)},n.refresh=function(a,c,d){return(a||d)&&d!==!1&&q.clearFileCache(),new Promise(function(d,f){var g,h,j;g=h=new Date,k(function(a,c,i,k,l){if(a)return r.add(a,a.href||k.href),void f(a);l.local?n.logger.info("loading "+k.href+" from cache."):n.logger.info("rendered "+k.href+" successfully."),e.createCSS(b.document,c,k),n.logger.info("css for "+k.href+" generated in "+(new Date-h)+"ms"),0===l.remaining&&(j=new Date-g,n.logger.info("less has finished. css generated in "+j+"ms"),d({startTime:g,endTime:h,totalMilliseconds:j,sheets:n.sheets.length})),h=new Date},a,c),i(c)})},n.refreshStyles=i,n}},{"../less":30,"./browser":3,"./cache":4,"./error-reporting":5,"./file-manager":6,"./log-listener":8,"./utils":9}],8:[function(a,b,c){b.exports=function(a,b){b.logLevel=void 0!==b.logLevel?b.logLevel:"development"===b.env?3:1,b.loggers||(b.loggers=[{debug:function(a){b.logLevel>=4&&console.log(a)},info:function(a){b.logLevel>=3&&console.log(a)},warn:function(a){b.logLevel>=2&&console.warn(a)},error:function(a){b.logLevel>=1&&console.error(a)}}]);for(var c=0;c<b.loggers.length;c++)a.logger.addListener(b.loggers[c])}},{}],9:[function(a,b,c){b.exports={extractId:function(a){return a.replace(/^[a-z-]+:\/+?[^\/]+/,"").replace(/[\?\&]livereload=\w+/,"").replace(/^\//,"").replace(/\.[a-zA-Z]+$/,"").replace(/[^\.\w-]+/g,"-").replace(/\./g,":")},addDataAttr:function(a,b){for(var c in b.dataset)if(b.dataset.hasOwnProperty(c))if("env"===c||"dumpLineNumbers"===c||"rootpath"===c||"errorReporting"===c)a[c]=b.dataset[c];else try{a[c]=JSON.parse(b.dataset[c])}catch(a){}}}},{}],10:[function(a,b,c){var d={};b.exports=d;var e=function(a,b,c){if(a)for(var d=0;d<c.length;d++)a.hasOwnProperty(c[d])&&(b[c[d]]=a[c[d]])},f=["paths","relativeUrls","rootpath","strictImports","insecure","dumpLineNumbers","compress","syncImport","chunkInput","mime","useFileCache","processImports","reference","pluginManager"];d.Parse=function(a){e(a,this,f),"string"==typeof this.paths&&(this.paths=[this.paths])};var g=["paths","compress","ieCompat","strictMath","strictUnits","sourceMap","importMultiple","urlArgs","javascriptEnabled","pluginManager","importantScope"];d.Eval=function(a,b){e(a,this,g),"string"==typeof this.paths&&(this.paths=[this.paths]),this.frames=b||[],this.importantScope=this.importantScope||[]},d.Eval.prototype.inParenthesis=function(){this.parensStack||(this.parensStack=[]),this.parensStack.push(!0)},d.Eval.prototype.outOfParenthesis=function(){this.parensStack.pop()},d.Eval.prototype.isMathOn=function(){return!this.strictMath||this.parensStack&&this.parensStack.length},d.Eval.prototype.isPathRelative=function(a){return!/^(?:[a-z-]+:|\/|#)/i.test(a)},d.Eval.prototype.normalizePath=function(a){var b,c=a.split("/").reverse();for(a=[];0!==c.length;)switch(b=c.pop()){case".":break;case"..":0===a.length||".."===a[a.length-1]?a.push(b):a.pop();break;default:a.push(b)}return a.join("/")}},{}],11:[function(a,b,c){b.exports={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}},{}],12:[function(a,b,c){b.exports={colors:a("./colors"),unitConversions:a("./unit-conversions")}},{"./colors":11,"./unit-conversions":13}],13:[function(a,b,c){b.exports={length:{m:1,cm:.01,mm:.001,in:.0254,px:.0254/96,pt:.0254/72,pc:.0254/72*12},duration:{s:1,ms:.001},angle:{rad:1/(2*Math.PI),deg:1/360,grad:.0025,turn:1}}},{}],14:[function(a,b,c){var d=function(){};d.prototype.getPath=function(a){var b=a.lastIndexOf("?");return b>0&&(a=a.slice(0,b)),b=a.lastIndexOf("/"),b<0&&(b=a.lastIndexOf("\\")),b<0?"":a.slice(0,b+1)},d.prototype.tryAppendExtension=function(a,b){return/(\.[a-z]*$)|([\?;].*)$/.test(a)?a:a+b},d.prototype.tryAppendLessExtension=function(a){return this.tryAppendExtension(a,".less")},d.prototype.supportsSync=function(){return!1},d.prototype.alwaysMakePathsAbsolute=function(){return!1},d.prototype.isPathAbsolute=function(a){return/^(?:[a-z-]+:|\/|\\|#)/i.test(a)},d.prototype.join=function(a,b){return a?a+b:b},d.prototype.pathDiff=function(a,b){var c,d,e,f,g=this.extractUrlParts(a),h=this.extractUrlParts(b),i="";if(g.hostPart!==h.hostPart)return"";for(d=Math.max(h.directories.length,g.directories.length),c=0;c<d&&h.directories[c]===g.directories[c];c++);for(f=h.directories.slice(c),e=g.directories.slice(c),c=0;c<f.length-1;c++)i+="../";for(c=0;c<e.length-1;c++)i+=e[c]+"/";return i},d.prototype.extractUrlParts=function(a,b){var c,d,e=/^((?:[a-z-]+:)?\/+?(?:[^\/\?#]*\/)|([\/\\]))?((?:[^\/\\\?#]*[\/\\])*)([^\/\\\?#]*)([#\?].*)?$/i,f=a.match(e),g={},h=[];if(!f)throw new Error("Could not parse sheet href - '"+a+"'");if(b&&(!f[1]||f[2])){if(!(d=b.match(e)))throw new Error("Could not parse page url - '"+b+"'");f[1]=f[1]||d[1]||"",f[2]||(f[3]=d[3]+f[3])}if(f[3]){for(h=f[3].replace(/\\/g,"/").split("/"),c=0;c<h.length;c++)"."===h[c]&&(h.splice(c,1),c-=1);for(c=0;c<h.length;c++)".."===h[c]&&c>0&&(h.splice(c-1,2),c-=2)}return g.hostPart=f[1],g.directories=h,g.path=(f[1]||"")+h.join("/"),g.fileUrl=g.path+(f[4]||""),g.url=g.fileUrl+(f[5]||""),g},b.exports=d},{}],15:[function(a,b,c){var d=a("../logger"),e=function(a,b){this.fileManagers=b||[],a=a||{};for(var c=["encodeBase64","mimeLookup","charsetLookup","getSourceMapGenerator"],d=[],e=d.concat(c),f=0;f<e.length;f++){var g=e[f],h=a[g];h?this[g]=h.bind(a):f<d.length&&this.warn("missing required function in environment - "+g)}};e.prototype.getFileManager=function(a,b,c,e,f){a||d.warn("getFileManager called with no filename.. Please report this issue. continuing."),null==b&&d.warn("getFileManager called with null directory.. Please report this issue. continuing.");var g=this.fileManagers;c.pluginManager&&(g=[].concat(g).concat(c.pluginManager.getFileManagers()));for(var h=g.length-1;h>=0;h--){var i=g[h];if(i[f?"supportsSync":"supports"](a,b,c,e))return i}return null},e.prototype.addFileManager=function(a){this.fileManagers.push(a)},e.prototype.clearFileManagers=function(){this.fileManagers=[]},b.exports=e},{"../logger":32}],16:[function(a,b,c){function d(a,b,c){var d,f,g,h,i=b.alpha,j=c.alpha,k=[];g=j+i*(1-j);for(var l=0;l<3;l++)d=b.rgb[l]/255,f=c.rgb[l]/255,h=a(d,f),g&&(h=(j*f+i*(d-j*(d+f-h)))/g),k[l]=255*h;return new e(k,g)}var e=a("../tree/color"),f=a("./function-registry"),g={multiply:function(a,b){return a*b},screen:function(a,b){return a+b-a*b},overlay:function(a,b){return a*=2,a<=1?g.multiply(a,b):g.screen(a-1,b)},softlight:function(a,b){var c=1,d=a;return b>.5&&(d=1,c=a>.25?Math.sqrt(a):((16*a-12)*a+4)*a),a-(1-2*b)*d*(c-a)},hardlight:function(a,b){return g.overlay(b,a)},difference:function(a,b){return Math.abs(a-b)},exclusion:function(a,b){return a+b-2*a*b},average:function(a,b){return(a+b)/2},negation:function(a,b){return 1-Math.abs(a+b-1)}};for(var h in g)g.hasOwnProperty(h)&&(d[h]=d.bind(null,g[h]));f.addMultiple(d)},{"../tree/color":49,"./function-registry":21}],17:[function(a,b,c){function d(a){return Math.min(1,Math.max(0,a))}function e(a){return h.hsla(a.h,a.s,a.l,a.a)}function f(a){if(a instanceof i)return parseFloat(a.unit.is("%")?a.value/100:a.value);if("number"==typeof a)return a;throw{type:"Argument",message:"color functions take numbers as parameters"}}function g(a,b){return a instanceof i&&a.unit.is("%")?parseFloat(a.value*b/100):f(a)}var h,i=a("../tree/dimension"),j=a("../tree/color"),k=a("../tree/quoted"),l=a("../tree/anonymous"),m=a("./function-registry");h={rgb:function(a,b,c){return h.rgba(a,b,c,1)},rgba:function(a,b,c,d){var e=[a,b,c].map(function(a){return g(a,255)});return d=f(d),new j(e,d)},hsl:function(a,b,c){return h.hsla(a,b,c,1)},hsla:function(a,b,c,e){function g(a){return a=a<0?a+1:a>1?a-1:a,6*a<1?j+(i-j)*a*6:2*a<1?i:3*a<2?j+(i-j)*(2/3-a)*6:j}a=f(a)%360/360,b=d(f(b)),c=d(f(c)),e=d(f(e));var i=c<=.5?c*(b+1):c+b-c*b,j=2*c-i;return h.rgba(255*g(a+1/3),255*g(a),255*g(a-1/3),e)},hsv:function(a,b,c){return h.hsva(a,b,c,1)},hsva:function(a,b,c,d){a=f(a)%360/360*360,b=f(b),c=f(c),d=f(d);var e,g;e=Math.floor(a/60%6),g=a/60-e;var i=[c,c*(1-b),c*(1-g*b),c*(1-(1-g)*b)],j=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]];return h.rgba(255*i[j[e][0]],255*i[j[e][1]],255*i[j[e][2]],d)},hue:function(a){return new i(a.toHSL().h)},saturation:function(a){return new i(100*a.toHSL().s,"%")},lightness:function(a){return new i(100*a.toHSL().l,"%")},hsvhue:function(a){return new i(a.toHSV().h)},hsvsaturation:function(a){return new i(100*a.toHSV().s,"%")},hsvvalue:function(a){return new i(100*a.toHSV().v,"%")},red:function(a){return new i(a.rgb[0])},green:function(a){return new i(a.rgb[1])},blue:function(a){return new i(a.rgb[2])},alpha:function(a){return new i(a.toHSL().a)},luma:function(a){return new i(a.luma()*a.alpha*100,"%")},luminance:function(a){var b=.2126*a.rgb[0]/255+.7152*a.rgb[1]/255+.0722*a.rgb[2]/255;return new i(b*a.alpha*100,"%")},saturate:function(a,b,c){if(!a.rgb)return null;var f=a.toHSL();return void 0!==c&&"relative"===c.value?f.s+=f.s*b.value/100:f.s+=b.value/100,f.s=d(f.s),e(f)},desaturate:function(a,b,c){var f=a.toHSL();return void 0!==c&&"relative"===c.value?f.s-=f.s*b.value/100:f.s-=b.value/100,f.s=d(f.s),e(f)},lighten:function(a,b,c){var f=a.toHSL();return void 0!==c&&"relative"===c.value?f.l+=f.l*b.value/100:f.l+=b.value/100,f.l=d(f.l),e(f)},darken:function(a,b,c){var f=a.toHSL();return void 0!==c&&"relative"===c.value?f.l-=f.l*b.value/100:f.l-=b.value/100,f.l=d(f.l),e(f)},fadein:function(a,b,c){var f=a.toHSL();return void 0!==c&&"relative"===c.value?f.a+=f.a*b.value/100:f.a+=b.value/100,f.a=d(f.a),e(f)},fadeout:function(a,b,c){var f=a.toHSL();return void 0!==c&&"relative"===c.value?f.a-=f.a*b.value/100:f.a-=b.value/100,f.a=d(f.a),e(f)},fade:function(a,b){var c=a.toHSL();return c.a=b.value/100,c.a=d(c.a),e(c)},spin:function(a,b){var c=a.toHSL(),d=(c.h+b.value)%360;return c.h=d<0?360+d:d,e(c)},mix:function(a,b,c){a.toHSL&&b.toHSL||(console.log(b.type),console.dir(b)),c||(c=new i(50));var d=c.value/100,e=2*d-1,f=a.toHSL().a-b.toHSL().a,g=((e*f==-1?e:(e+f)/(1+e*f))+1)/2,h=1-g,k=[a.rgb[0]*g+b.rgb[0]*h,a.rgb[1]*g+b.rgb[1]*h,a.rgb[2]*g+b.rgb[2]*h],l=a.alpha*d+b.alpha*(1-d);return new j(k,l)},greyscale:function(a){return h.desaturate(a,new i(100))},contrast:function(a,b,c,d){if(!a.rgb)return null;if(void 0===c&&(c=h.rgba(255,255,255,1)),void 0===b&&(b=h.rgba(0,0,0,1)),b.luma()>c.luma()){var e=c;c=b,b=e}return d=void 0===d?.43:f(d),a.luma()<d?c:b},argb:function(a){return new l(a.toARGB())},color:function(a){if(a instanceof k&&/^#([a-f0-9]{6}|[a-f0-9]{3})$/i.test(a.value))return new j(a.value.slice(1));if(a instanceof j||(a=j.fromKeyword(a.value)))return a.value=void 0,a;throw{type:"Argument",message:"argument must be a color keyword or 3/6 digit hex e.g. #FFF"}},tint:function(a,b){return h.mix(h.rgb(255,255,255),a,b)},shade:function(a,b){return h.mix(h.rgb(0,0,0),a,b)}},m.addMultiple(h)},{"../tree/anonymous":45,"../tree/color":49,"../tree/dimension":55,"../tree/quoted":72,"./function-registry":21}],18:[function(a,b,c){b.exports=function(b){var c=a("../tree/quoted"),d=a("../tree/url"),e=a("./function-registry"),f=function(a,b){return new d(b,a.index,a.currentFileInfo).eval(a.context)},g=a("../logger");e.add("data-uri",function(a,e){e||(e=a,a=null);var h=a&&a.value,i=e.value,j=this.currentFileInfo,k=j.relativeUrls?j.currentDirectory:j.entryPath,l=i.indexOf("#"),m="";l!==-1&&(m=i.slice(l),i=i.slice(0,l));var n=b.getFileManager(i,k,this.context,b,!0);if(!n)return f(this,e);var o=!1;if(a)o=/;base64$/.test(h);else{if("image/svg+xml"===(h=b.mimeLookup(i)))o=!1;else{var p=b.charsetLookup(h);o=["US-ASCII","UTF-8"].indexOf(p)<0}o&&(h+=";base64")}var q=n.loadFileSync(i,k,this.context,b);if(!q.contents)return g.warn("Skipped data-uri embedding of "+i+" because file not found"),f(this,e||a);var r=q.contents;if(o&&!b.encodeBase64)return f(this,e);r=o?b.encodeBase64(r):encodeURIComponent(r);var s="data:"+h+","+r+m;return s.length>=32768&&this.context.ieCompat!==!1?(g.warn("Skipped data-uri embedding of "+i+" because its size ("+s.length+" characters) exceeds IE8-safe 32768 characters!"),f(this,e||a)):new d(new c('"'+s+'"',s,!1,this.index,this.currentFileInfo),this.index,this.currentFileInfo)})}},{"../logger":32,"../tree/quoted":72,"../tree/url":79,"./function-registry":21}],19:[function(a,b,c){var d=a("../tree/keyword"),e=a("./function-registry"),f={eval:function(){var a=this.value_,b=this.error_;if(b)throw b;if(null!=a)return a?d.True:d.False},value:function(a){this.value_=a},error:function(a){this.error_=a},reset:function(){this.value_=this.error_=null}};e.add("default",f.eval.bind(f)),b.exports=f},{"../tree/keyword":64,"./function-registry":21}],20:[function(a,b,c){var d=a("../tree/expression"),e=function(a,b,c,d){this.name=a.toLowerCase(),this.index=c,this.context=b,this.currentFileInfo=d,this.func=b.frames[0].functionRegistry.get(this.name)};e.prototype.isValid=function(){return Boolean(this.func)},e.prototype.call=function(a){return Array.isArray(a)&&(a=a.filter(function(a){return"Comment"!==a.type}).map(function(a){if("Expression"===a.type){var b=a.value.filter(function(a){return"Comment"!==a.type});return 1===b.length?b[0]:new d(b)}return a})),this.func.apply(this,a)},b.exports=e},{"../tree/expression":58}],21:[function(a,b,c){function d(a){return{_data:{},add:function(a,b){a=a.toLowerCase(),this._data.hasOwnProperty(a),this._data[a]=b},addMultiple:function(a){Object.keys(a).forEach(function(b){this.add(b,a[b])}.bind(this))},get:function(b){return this._data[b]||a&&a.get(b)},inherit:function(){return d(this)}}}b.exports=d(null)},{}],22:[function(a,b,c){b.exports=function(b){var c={functionRegistry:a("./function-registry"),functionCaller:a("./function-caller")};return a("./default"),a("./color"),a("./color-blending"),a("./data-uri")(b),a("./math"),a("./number"),a("./string"),a("./svg")(b),a("./types"),c}},{"./color":17,"./color-blending":16,"./data-uri":18,"./default":19,"./function-caller":20,"./function-registry":21,"./math":24,"./number":25,"./string":26,"./svg":27,"./types":28}],23:[function(a,b,c){var d=a("../tree/dimension"),e=function(){};e._math=function(a,b,c){if(!(c instanceof d))throw{type:"Argument",message:"argument must be a number"};return null==b?b=c.unit:c=c.unify(),new d(a(parseFloat(c.value)),b)},b.exports=e},{"../tree/dimension":55}],24:[function(a,b,c){var d=a("./function-registry"),e=a("./math-helper.js"),f={ceil:null,floor:null,sqrt:null,abs:null,tan:"",sin:"",cos:"",atan:"rad",asin:"rad",acos:"rad"};for(var g in f)f.hasOwnProperty(g)&&(f[g]=e._math.bind(null,Math[g],f[g]));f.round=function(a,b){var c=void 0===b?0:b.value;return e._math(function(a){return a.toFixed(c)},null,a)},d.addMultiple(f)},{"./function-registry":21,"./math-helper.js":23}],25:[function(a,b,c){var d=a("../tree/dimension"),e=a("../tree/anonymous"),f=a("./function-registry"),g=a("./math-helper.js"),h=function(a,b){switch(b=Array.prototype.slice.call(b),b.length){case 0:throw{type:"Argument",message:"one or more arguments required"}}var c,f,g,h,i,j,k,l,m=[],n={};for(c=0;c<b.length;c++)if((g=b[c])instanceof d)if(h=""===g.unit.toString()&&void 0!==l?new d(g.value,l).unify():g.unify(),j=""===h.unit.toString()&&void 0!==k?k:h.unit.toString(),k=""!==j&&void 0===k||""!==j&&""===m[0].unify().unit.toString()?j:k,l=""!==j&&void 0===l?g.unit.toString():l,void 0!==(f=void 0!==n[""]&&""!==j&&j===k?n[""]:n[j]))i=""===m[f].unit.toString()&&void 0!==l?new d(m[f].value,l).unify():m[f].unify(),(a&&h.value<i.value||!a&&h.value>i.value)&&(m[f]=g);else{if(void 0!==k&&j!==k)throw{type:"Argument",message:"incompatible types"};n[j]=m.length,m.push(g)}else Array.isArray(b[c].value)&&Array.prototype.push.apply(b,Array.prototype.slice.call(b[c].value));return 1==m.length?m[0]:(b=m.map(function(a){return a.toCSS(this.context)}).join(this.context.compress?",":", "),new e((a?"min":"max")+"("+b+")"))};f.addMultiple({min:function(){return h(!0,arguments)},max:function(){return h(!1,arguments)},convert:function(a,b){return a.convertTo(b.value)},pi:function(){return new d(Math.PI)},mod:function(a,b){return new d(a.value%b.value,a.unit)},pow:function(a,b){if("number"==typeof a&&"number"==typeof b)a=new d(a),b=new d(b);else if(!(a instanceof d&&b instanceof d))throw{type:"Argument",message:"arguments must be numbers"};return new d(Math.pow(a.value,b.value),a.unit)},percentage:function(a){return g._math(function(a){return 100*a},"%",a)}})},{"../tree/anonymous":45,"../tree/dimension":55,"./function-registry":21,"./math-helper.js":23}],26:[function(a,b,c){var d=a("../tree/quoted"),e=a("../tree/anonymous"),f=a("../tree/javascript");a("./function-registry").addMultiple({e:function(a){return new e(a instanceof f?a.evaluated:a.value)},escape:function(a){return new e(encodeURI(a.value).replace(/=/g,"%3D").replace(/:/g,"%3A").replace(/#/g,"%23").replace(/;/g,"%3B").replace(/\(/g,"%28").replace(/\)/g,"%29"))},replace:function(a,b,c,e){var f=a.value;return c="Quoted"===c.type?c.value:c.toCSS(),f=f.replace(new RegExp(b.value,e?e.value:""),c),new d(a.quote||"",f,a.escaped)},"%":function(a){for(var b=Array.prototype.slice.call(arguments,1),c=a.value,e=0;e<b.length;e++)c=c.replace(/%[sda]/i,function(a){var c="Quoted"===b[e].type&&a.match(/s/i)?b[e].value:b[e].toCSS();return a.match(/[A-Z]$/)?encodeURIComponent(c):c});return c=c.replace(/%%/g,"%"),new d(a.quote||"",c,a.escaped)}})},{"../tree/anonymous":45,"../tree/javascript":62,"../tree/quoted":72,"./function-registry":21}],27:[function(a,b,c){b.exports=function(b){var c=a("../tree/dimension"),d=a("../tree/color"),e=a("../tree/expression"),f=a("../tree/quoted"),g=a("../tree/url");a("./function-registry").add("svg-gradient",function(a){function b(){throw{type:"Argument",message:"svg-gradient expects direction, start_color [start_position], [color position,]..., end_color [end_position] or direction, color list"}}var h,i,j,k,l,m,n,o,p="linear",q='x="0" y="0" width="1" height="1"',r={compress:!1},s=a.toCSS(r);switch(2==arguments.length?(arguments[1].value.length<2&&b(),h=arguments[1].value):arguments.length<3?b():h=Array.prototype.slice.call(arguments,1),s){case"to bottom":i='x1="0%" y1="0%" x2="0%" y2="100%"';break;case"to right":i='x1="0%" y1="0%" x2="100%" y2="0%"';break;case"to bottom right":i='x1="0%" y1="0%" x2="100%" y2="100%"';break;case"to top right":i='x1="0%" y1="100%" x2="100%" y2="0%"';break;case"ellipse":case"ellipse at center":p="radial",i='cx="50%" cy="50%" r="75%"',q='x="-50" y="-50" width="101" height="101"';break;default:throw{type:"Argument",
message:"svg-gradient direction must be 'to bottom', 'to right', 'to bottom right', 'to top right' or 'ellipse at center'"}}for(j='<?xml version="1.0" ?><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100%" height="100%" viewBox="0 0 1 1" preserveAspectRatio="none"><'+p+'Gradient id="gradient" gradientUnits="userSpaceOnUse" '+i+">",k=0;k<h.length;k+=1)h[k]instanceof e?(l=h[k].value[0],m=h[k].value[1]):(l=h[k],m=void 0),l instanceof d&&((0===k||k+1===h.length)&&void 0===m||m instanceof c)||b(),n=m?m.toCSS(r):0===k?"0%":"100%",o=l.alpha,j+='<stop offset="'+n+'" stop-color="'+l.toRGB()+'"'+(o<1?' stop-opacity="'+o+'"':"")+"/>";return j+="</"+p+"Gradient><rect "+q+' fill="url(#gradient)" /></svg>',j=encodeURIComponent(j),j="data:image/svg+xml,"+j,new g(new f("'"+j+"'",j,!1,this.index,this.currentFileInfo),this.index,this.currentFileInfo)})}},{"../tree/color":49,"../tree/dimension":55,"../tree/expression":58,"../tree/quoted":72,"../tree/url":79,"./function-registry":21}],28:[function(a,b,c){var d=a("../tree/keyword"),e=a("../tree/detached-ruleset"),f=a("../tree/dimension"),g=a("../tree/color"),h=a("../tree/quoted"),i=a("../tree/anonymous"),j=a("../tree/url"),k=a("../tree/operation"),l=a("./function-registry"),m=function(a,b){return a instanceof b?d.True:d.False},n=function(a,b){if(void 0===b)throw{type:"Argument",message:"missing the required second argument to isunit."};if("string"!=typeof(b="string"==typeof b.value?b.value:b))throw{type:"Argument",message:"Second argument to isunit should be a unit or a string."};return a instanceof f&&a.unit.is(b)?d.True:d.False},o=function(a){return Array.isArray(a.value)?a.value:Array(a)};l.addMultiple({isruleset:function(a){return m(a,e)},iscolor:function(a){return m(a,g)},isnumber:function(a){return m(a,f)},isstring:function(a){return m(a,h)},iskeyword:function(a){return m(a,d)},isurl:function(a){return m(a,j)},ispixel:function(a){return n(a,"px")},ispercentage:function(a){return n(a,"%")},isem:function(a){return n(a,"em")},isunit:n,unit:function(a,b){if(!(a instanceof f))throw{type:"Argument",message:"the first argument to unit must be a number"+(a instanceof k?". Have you forgotten parenthesis?":"")};return b=b?b instanceof d?b.value:b.toCSS():"",new f(a.value,b)},"get-unit":function(a){return new i(a.unit)},extract:function(a,b){return b=b.value-1,o(a)[b]},length:function(a){return new f(o(a).length)}})},{"../tree/anonymous":45,"../tree/color":49,"../tree/detached-ruleset":54,"../tree/dimension":55,"../tree/keyword":64,"../tree/operation":70,"../tree/quoted":72,"../tree/url":79,"./function-registry":21}],29:[function(a,b,c){var d=a("./contexts"),e=a("./parser/parser"),f=a("./plugins/function-importer");b.exports=function(a){var b=function(a,b){this.rootFilename=b.filename,this.paths=a.paths||[],this.contents={},this.contentsIgnoredChars={},this.mime=a.mime,this.error=null,this.context=a,this.queue=[],this.files={}};return b.prototype.push=function(b,c,g,h,i){var j=this;this.queue.push(b);var k=function(a,c,d){j.queue.splice(j.queue.indexOf(b),1);var e=d===j.rootFilename;h.optional&&a?i(null,{rules:[]},!1,null):(j.files[d]=c,a&&!j.error&&(j.error=a),i(a,c,e,d))},l={relativeUrls:this.context.relativeUrls,entryPath:g.entryPath,rootpath:g.rootpath,rootFilename:g.rootFilename},m=a.getFileManager(b,g.currentDirectory,this.context,a);if(!m)return void k({message:"Could not find a file-manager for "+b});c&&(b=m.tryAppendExtension(b,h.plugin?".js":".less"));var n=function(a){var b=a.filename,c=a.contents.replace(/^\uFEFF/,"");l.currentDirectory=m.getPath(b),l.relativeUrls&&(l.rootpath=m.join(j.context.rootpath||"",m.pathDiff(l.currentDirectory,l.entryPath)),!m.isPathAbsolute(l.rootpath)&&m.alwaysMakePathsAbsolute()&&(l.rootpath=m.join(l.entryPath,l.rootpath))),l.filename=b;var i=new d.Parse(j.context);i.processImports=!1,j.contents[b]=c,(g.reference||h.reference)&&(l.reference=!0),h.plugin?new f(i,l).eval(c,function(a,c){k(a,c,b)}):h.inline?k(null,c,b):new e(i,j,l).parse(c,function(a,c){k(a,c,b)})},o=m.loadFile(b,g.currentDirectory,this.context,a,function(a,b){a?k(a):n(b)});o&&o.then(n,k)},b}},{"./contexts":10,"./parser/parser":37,"./plugins/function-importer":39}],30:[function(a,b,c){b.exports=function(b,c){var d,e,f,g,h;return{version:[2,5,3],data:a("./data"),tree:a("./tree"),Environment:h=a("./environment/environment"),AbstractFileManager:a("./environment/abstract-file-manager"),environment:b=new h(b,c),visitors:a("./visitors"),Parser:a("./parser/parser"),functions:a("./functions")(b),contexts:a("./contexts"),SourceMapOutput:d=a("./source-map-output")(b),SourceMapBuilder:e=a("./source-map-builder")(d,b),ParseTree:f=a("./parse-tree")(e),ImportManager:g=a("./import-manager")(b),render:a("./render")(b,f,g),parse:a("./parse")(b,f,g),LessError:a("./less-error"),transformTree:a("./transform-tree"),utils:a("./utils"),PluginManager:a("./plugin-manager"),logger:a("./logger")}}},{"./contexts":10,"./data":12,"./environment/abstract-file-manager":14,"./environment/environment":15,"./functions":22,"./import-manager":29,"./less-error":31,"./logger":32,"./parse":34,"./parse-tree":33,"./parser/parser":37,"./plugin-manager":38,"./render":40,"./source-map-builder":41,"./source-map-output":42,"./transform-tree":43,"./tree":61,"./utils":82,"./visitors":86}],31:[function(a,b,c){var d=a("./utils"),e=b.exports=function(a,b,c){Error.call(this);var e=a.filename||c;if(b&&e){var f=b.contents[e],g=d.getLocation(a.index,f),h=g.line,i=g.column,j=a.call&&d.getLocation(a.call,f).line,k=f.split("\n");this.type=a.type||"Syntax",this.filename=e,this.index=a.index,this.line="number"==typeof h?h+1:null,this.callLine=j+1,this.callExtract=k[j],this.column=i,this.extract=[k[h-1],k[h],k[h+1]]}this.message=a.message,this.stack=a.stack};if(void 0===Object.create){var f=function(){};f.prototype=Error.prototype,e.prototype=new f}else e.prototype=Object.create(Error.prototype);e.prototype.constructor=e},{"./utils":82}],32:[function(a,b,c){b.exports={error:function(a){this._fireEvent("error",a)},warn:function(a){this._fireEvent("warn",a)},info:function(a){this._fireEvent("info",a)},debug:function(a){this._fireEvent("debug",a)},addListener:function(a){this._listeners.push(a)},removeListener:function(a){for(var b=0;b<this._listeners.length;b++)if(this._listeners[b]===a)return void this._listeners.splice(b,1)},_fireEvent:function(a,b){for(var c=0;c<this._listeners.length;c++){var d=this._listeners[c][a];d&&d(b)}},_listeners:[]}},{}],33:[function(a,b,c){var d=a("./less-error"),e=a("./transform-tree"),f=a("./logger");b.exports=function(a){var b=function(a,b){this.root=a,this.imports=b};return b.prototype.toCSS=function(b){var c,g,h={};try{c=e(this.root,b)}catch(a){throw new d(a,this.imports)}try{var i=Boolean(b.compress);i&&f.warn("The compress option has been deprecated. We recommend you use a dedicated css minifier, for instance see less-plugin-clean-css.");var j={compress:i,dumpLineNumbers:b.dumpLineNumbers,strictUnits:Boolean(b.strictUnits),numPrecision:8};b.sourceMap?(g=new a(b.sourceMap),h.css=g.toCSS(c,j,this.imports)):h.css=c.toCSS(j)}catch(a){throw new d(a,this.imports)}if(b.pluginManager)for(var k=b.pluginManager.getPostProcessors(),l=0;l<k.length;l++)h.css=k[l].process(h.css,{sourceMap:g,options:b,imports:this.imports});b.sourceMap&&(h.map=g.getExternalSourceMap()),h.imports=[];for(var m in this.imports.files)this.imports.files.hasOwnProperty(m)&&m!==this.imports.rootFilename&&h.imports.push(m);return h},b}},{"./less-error":31,"./logger":32,"./transform-tree":43}],34:[function(a,b,c){var d,e=a("./contexts"),f=a("./parser/parser"),g=a("./plugin-manager");b.exports=function(b,c,h){var i=function(b,c,j){if(c=c||{},"function"==typeof c&&(j=c,c={}),!j){d||(d="undefined"==typeof Promise?a("promise"):Promise);var k=this;return new d(function(a,d){i.call(k,b,c,function(b,c){b?d(b):a(c)})})}var l,m,n=new g(this);if(n.addPlugins(c.plugins),c.pluginManager=n,l=new e.Parse(c),c.rootFileInfo)m=c.rootFileInfo;else{var o=c.filename||"input",p=o.replace(/[^\/\\]*$/,"");m={filename:o,relativeUrls:l.relativeUrls,rootpath:l.rootpath||"",currentDirectory:p,entryPath:p,rootFilename:o},m.rootpath&&"/"!==m.rootpath.slice(-1)&&(m.rootpath+="/")}var q=new h(l,m);new f(l,q,m).parse(b,function(a,b){if(a)return j(a);j(null,b,q,c)},c)};return i}},{"./contexts":10,"./parser/parser":37,"./plugin-manager":38,promise:void 0}],35:[function(a,b,c){b.exports=function(a,b){function c(b){var c=h-q;c<512&&!b||!c||(p.push(a.slice(q,h+1)),q=h+1)}var d,e,f,g,h,i,j,k,l,m=a.length,n=0,o=0,p=[],q=0;for(h=0;h<m;h++)if(!((j=a.charCodeAt(h))>=97&&j<=122||j<34))switch(j){case 40:o++,e=h;continue;case 41:if(--o<0)return b("missing opening `(`",h);continue;case 59:o||c();continue;case 123:n++,d=h;continue;case 125:if(--n<0)return b("missing opening `{`",h);n||o||c();continue;case 92:if(h<m-1){h++;continue}return b("unescaped `\\`",h);case 34:case 39:case 96:for(l=0,i=h,h+=1;h<m;h++)if(!((k=a.charCodeAt(h))>96)){if(k==j){l=1;break}if(92==k){if(h==m-1)return b("unescaped `\\`",h);h++}}if(l)continue;return b("unmatched `"+String.fromCharCode(j)+"`",i);case 47:if(o||h==m-1)continue;if(47==(k=a.charCodeAt(h+1)))for(h+=2;h<m&&(!((k=a.charCodeAt(h))<=13)||10!=k&&13!=k);h++);else if(42==k){for(f=i=h,h+=2;h<m-1&&(k=a.charCodeAt(h),125==k&&(g=h),42!=k||47!=a.charCodeAt(h+1));h++);if(h==m-1)return b("missing closing `*/`",i);h++}continue;case 42:if(h<m-1&&47==a.charCodeAt(h+1))return b("unmatched `/*`",h);continue}return 0!==n?f>d&&g>f?b("missing closing `}` or `*/`",d):b("missing closing `}`",d):0!==o?b("missing closing `)`",e):(c(!0),p)}},{}],36:[function(a,b,c){var d=a("./chunker");b.exports=function(){var a,b,c,e,f,g,h,i=[],j={};j.save=function(){h=j.i,i.push({current:g,i:j.i,j:b})},j.restore=function(a){(j.i>c||j.i===c&&a&&!e)&&(c=j.i,e=a);var d=i.pop();g=d.current,h=j.i=d.i,b=d.j},j.forget=function(){i.pop()},j.isWhitespace=function(b){var c=j.i+(b||0),d=a.charCodeAt(c);return d===k||d===n||d===l||d===m},j.$re=function(a){j.i>h&&(g=g.slice(j.i-h),h=j.i);var b=a.exec(g);return b?(o(b[0].length),"string"==typeof b?b:1===b.length?b[0]:b):null},j.$char=function(b){return a.charAt(j.i)!==b?null:(o(1),b)},j.$str=function(b){for(var c=b.length,d=0;d<c;d++)if(a.charAt(j.i+d)!==b.charAt(d))return null;return o(c),b},j.$quoted=function(){var b=a.charAt(j.i);if("'"===b||'"'===b){for(var c=a.length,d=j.i,e=1;e+d<c;e++){switch(a.charAt(e+d)){case"\\":e++;continue;case"\r":case"\n":break;case b:var f=a.substr(d,e+1);return o(e+1),f}}return null}};var k=32,l=9,m=10,n=13;j.autoCommentAbsorb=!0,j.commentStore=[],j.finished=!1;var o=function(c){for(var d,e,i,p=j.i,q=b,r=j.i-h,s=j.i+g.length-r,t=j.i+=c,u=a;j.i<s;j.i++){if(d=u.charCodeAt(j.i),j.autoCommentAbsorb&&47===d){if("/"===(e=u.charAt(j.i+1))){i={index:j.i,isLineComment:!0};var v=u.indexOf("\n",j.i+2);v<0&&(v=s),j.i=v,i.text=u.substr(i.i,j.i-i.i),j.commentStore.push(i);continue}if("*"===e){var w=u.indexOf("*/",j.i+2);if(w>=0){i={index:j.i,text:u.substr(j.i,w+2-j.i),isLineComment:!1},j.i+=i.text.length-1,j.commentStore.push(i);continue}}break}if(d!==k&&d!==m&&d!==l&&d!==n)break}if(g=g.slice(c+j.i-t+r),h=j.i,!g.length){if(b<f.length-1)return g=f[++b],o(0),!0;j.finished=!0}return p!==j.i||q!==b};return j.peek=function(b){if("string"==typeof b){for(var c=0;c<b.length;c++)if(a.charAt(j.i+c)!==b.charAt(c))return!1;return!0}return b.test(g)},j.peekChar=function(b){return a.charAt(j.i)===b},j.currentChar=function(){return a.charAt(j.i)},j.getInput=function(){return a},j.peekNotNumeric=function(){var b=a.charCodeAt(j.i);return b>57||b<43||47===b||44===b},j.start=function(e,i,k){a=e,j.i=b=h=c=0,f=i?d(e,k):[e],g=f[0],o(0)},j.end=function(){var b,d=j.i>=a.length;return j.i<c&&(b=e,j.i=c),{isFinished:d,furthest:j.i,furthestPossibleErrorMessage:b,furthestReachedEnd:j.i>=a.length-1,furthestChar:a[j.i]}},j}},{"./chunker":35}],37:[function(a,b,c){var d=a("../less-error"),e=a("../tree"),f=a("../visitors"),g=a("./parser-input"),h=a("../utils"),i=function a(b,c,i){function j(a,b,c){var d="[object Function]"===Object.prototype.toString.call(a)?a.call(n):o.$re(a);if(d)return d;l(b||("string"==typeof a?"expected '"+a+"' got '"+o.currentChar()+"'":"unexpected token"))}function k(a,b){if(o.$char(a))return a;l(b||"expected '"+a+"' got '"+o.currentChar()+"'")}function l(a,b){throw new d({index:o.i,filename:i.filename,type:b||"Syntax",message:a},c)}function m(a){var b=i.filename;return{lineNumber:h.getLocation(a,o.getInput()).line+1,fileName:b}}var n,o=g();return{parse:function(g,h,j){var k,l,m,n,p=null,q="";if(l=j&&j.globalVars?a.serializeVars(j.globalVars)+"\n":"",m=j&&j.modifyVars?"\n"+a.serializeVars(j.modifyVars):"",b.pluginManager)for(var r=b.pluginManager.getPreProcessors(),s=0;s<r.length;s++)g=r[s].process(g,{context:b,imports:c,fileInfo:i});(l||j&&j.banner)&&(q=(j&&j.banner?j.banner:"")+l,n=c.contentsIgnoredChars,n[i.filename]=n[i.filename]||0,n[i.filename]+=q.length),g=g.replace(/\r\n?/g,"\n"),g=q+g.replace(/^\uFEFF/,"")+m,c.contents[i.filename]=g;try{o.start(g,b.chunkInput,function(a,b){throw new d({index:b,type:"Parse",message:a,filename:i.filename},c)}),k=new e.Ruleset(null,this.parsers.primary()),k.root=!0,k.firstRoot=!0}catch(a){return h(new d(a,c,i.filename))}var t=o.end();if(!t.isFinished){var u=t.furthestPossibleErrorMessage;u||(u="Unrecognised input","}"===t.furthestChar?u+=". Possibly missing opening '{'":")"===t.furthestChar?u+=". Possibly missing opening '('":t.furthestReachedEnd&&(u+=". Possibly missing something")),p=new d({type:"Parse",message:u,index:t.furthest,filename:i.filename},c)}var v=function(a){return a=p||a||c.error,a?(a instanceof d||(a=new d(a,c,i.filename)),h(a)):h(null,k)};if(b.processImports===!1)return v();new f.ImportVisitor(c,v).run(k)},parsers:n={primary:function(){for(var a,b=this.mixin,c=[];;){for(;;){if(!(a=this.comment()))break;c.push(a)}if(o.finished)break;if(o.peek("}"))break;if(a=this.extendRule())c=c.concat(a);else if(a=b.definition()||this.rule()||this.ruleset()||b.call()||this.rulesetCall()||this.directive())c.push(a);else{for(var d=!1;o.$char(";");)d=!0;if(!d)break}}return c},comment:function(){if(o.commentStore.length){var a=o.commentStore.shift();return new e.Comment(a.text,a.isLineComment,a.index,i)}},entities:{quoted:function(){var a,b=o.i,c=!1;return o.save(),o.$char("~")&&(c=!0),(a=o.$quoted())?(o.forget(),new e.Quoted(a.charAt(0),a.substr(1,a.length-2),c,b,i)):void o.restore()},keyword:function(){var a=o.$char("%")||o.$re(/^[_A-Za-z-][_A-Za-z0-9-]*/);if(a)return e.Color.fromKeyword(a)||new e.Keyword(a)},call:function(){var a,b,c,d=o.i;if(!o.peek(/^url\(/i))return o.save(),(a=o.$re(/^([\w-]+|%|progid:[\w\.]+)\(/))?(a=a[1],"alpha"===a.toLowerCase()&&(c=n.alpha())?(o.forget(),c):(b=this.arguments(),o.$char(")")?(o.forget(),new e.Call(a,b,d,i)):void o.restore("Could not parse call arguments or missing ')'"))):void o.forget()},arguments:function(){for(var a,b=[];;){if(!(a=this.assignment()||n.expression()))break;if(b.push(a),!o.$char(","))break}return b},literal:function(){return this.dimension()||this.color()||this.quoted()||this.unicodeDescriptor()},assignment:function(){var a,b;return o.save(),(a=o.$re(/^\w+(?=\s?=)/i))&&o.$char("=")&&(b=n.entity())?(o.forget(),new e.Assignment(a,b)):void o.restore()},url:function(){var a,b=o.i;return o.autoCommentAbsorb=!1,o.$str("url(")?(a=this.quoted()||this.variable()||o.$re(/^(?:(?:\\[\(\)'"])|[^\(\)'"])+/)||"",o.autoCommentAbsorb=!0,k(")"),new e.URL(null!=a.value||a instanceof e.Variable?a:new e.Anonymous(a),b,i)):void(o.autoCommentAbsorb=!0)},variable:function(){var a,b=o.i;if("@"===o.currentChar()&&(a=o.$re(/^@@?[\w-]+/)))return new e.Variable(a,b,i)},variableCurly:function(){var a,b=o.i;if("@"===o.currentChar()&&(a=o.$re(/^@\{([\w-]+)\}/)))return new e.Variable("@"+a[1],b,i)},color:function(){var a;if("#"===o.currentChar()&&(a=o.$re(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})/))){var b=a.input.match(/^#([\w]+).*/);return b=b[1],b.match(/^[A-Fa-f0-9]+$/)||l("Invalid HEX color code"),new e.Color(a[1],void 0,"#"+b)}},dimension:function(){if(!o.peekNotNumeric()){var a=o.$re(/^([+-]?\d*\.?\d+)(%|[a-z]+)?/i);return a?new e.Dimension(a[1],a[2]):void 0}},unicodeDescriptor:function(){var a;if(a=o.$re(/^U\+[0-9a-fA-F?]+(\-[0-9a-fA-F?]+)?/))return new e.UnicodeDescriptor(a[0])},javascript:function(){var a,b=o.i;o.save();var c=o.$char("~");return o.$char("`")?(a=o.$re(/^[^`]*`/))?(o.forget(),new e.JavaScript(a.substr(0,a.length-1),Boolean(c),b,i)):void o.restore("invalid javascript definition"):void o.restore()}},variable:function(){var a;if("@"===o.currentChar()&&(a=o.$re(/^(@[\w-]+)\s*:/)))return a[1]},rulesetCall:function(){var a;if("@"===o.currentChar()&&(a=o.$re(/^(@[\w-]+)\s*\(\s*\)\s*;/)))return new e.RulesetCall(a[1])},extend:function(a){var b,c,d,f,g,h=o.i;if(o.$str(a?"&:extend(":":extend(")){do{for(d=null,b=null;!(d=o.$re(/^(all)(?=\s*(\)|,))/))&&(c=this.element());)b?b.push(c):b=[c];d=d&&d[1],b||l("Missing target selector for :extend()."),g=new e.Extend(new e.Selector(b),d,h),f?f.push(g):f=[g]}while(o.$char(","));return j(/^\)/),a&&j(/^;/),f}},extendRule:function(){return this.extend(!0)},mixin:{call:function(){var a,b,c,d,f,g,h=o.currentChar(),j=!1,l=o.i;if("."===h||"#"===h){for(o.save();;){if(a=o.i,!(d=o.$re(/^[#.](?:[\w-]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+/)))break;c=new e.Element(f,d,a,i),b?b.push(c):b=[c],f=o.$char(">")}if(b&&(o.$char("(")&&(g=this.args(!0).args,k(")")),n.important()&&(j=!0),n.end()))return o.forget(),new e.mixin.Call(b,g,l,i,j);o.restore()}},args:function(a){var b,c,d,f,g,h,i,j=n.entities,k={args:null,variadic:!1},m=[],p=[],q=[];for(o.save();;){if(a)h=n.detachedRuleset()||n.expression();else{if(o.commentStore.length=0,o.$str("...")){k.variadic=!0,o.$char(";")&&!b&&(b=!0),(b?p:q).push({variadic:!0});break}h=j.variable()||j.literal()||j.keyword()}if(!h)break;f=null,h.throwAwayComments&&h.throwAwayComments(),g=h;var r=null;if(a?h.value&&1==h.value.length&&(r=h.value[0]):r=h,r&&r instanceof e.Variable)if(o.$char(":")){if(m.length>0&&(b&&l("Cannot mix ; and , as delimiter types"),c=!0),!(g=n.detachedRuleset()||n.expression())){if(!a)return o.restore(),k.args=[],k;l("could not understand value for named argument")}f=d=r.name}else if(o.$str("...")){if(!a){k.variadic=!0,o.$char(";")&&!b&&(b=!0),(b?p:q).push({name:h.name,variadic:!0});break}i=!0}else a||(d=f=r.name,g=null);g&&m.push(g),q.push({name:f,value:g,expand:i}),o.$char(",")||(o.$char(";")||b)&&(c&&l("Cannot mix ; and , as delimiter types"),b=!0,m.length>1&&(g=new e.Value(m)),p.push({name:d,value:g,expand:i}),d=null,m=[],c=!1)}return o.forget(),k.args=b?p:q,k},definition:function(){var a,b,c,d,f=[],g=!1;if(!("."!==o.currentChar()&&"#"!==o.currentChar()||o.peek(/^[^{]*\}/)))if(o.save(),b=o.$re(/^([#.](?:[\w-]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+)\s*\(/)){a=b[1];var h=this.args(!1);if(f=h.args,g=h.variadic,!o.$char(")"))return void o.restore("Missing closing ')'");if(o.commentStore.length=0,o.$str("when")&&(d=j(n.conditions,"expected condition")),c=n.block())return o.forget(),new e.mixin.Definition(a,f,c,d,g);o.restore()}else o.forget()}},entity:function(){var a=this.entities;return this.comment()||a.literal()||a.variable()||a.url()||a.call()||a.keyword()||a.javascript()},end:function(){return o.$char(";")||o.peek("}")},alpha:function(){var a;if(o.$re(/^opacity=/i))return a=o.$re(/^\d+/),a||(a=j(this.entities.variable,"Could not parse alpha")),k(")"),new e.Alpha(a)},element:function(){var a,b,c,d=o.i;if(b=this.combinator(),a=o.$re(/^(?:\d+\.\d+|\d+)%/)||o.$re(/^(?:[.#]?|:*)(?:[\w-]|[^\x00-\x9f]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+/)||o.$char("*")||o.$char("&")||this.attribute()||o.$re(/^\([^&()@]+\)/)||o.$re(/^[\.#:](?=@)/)||this.entities.variableCurly(),a||(o.save(),o.$char("(")?(c=this.selector())&&o.$char(")")?(a=new e.Paren(c),o.forget()):o.restore("Missing closing ')'"):o.forget()),a)return new e.Element(b,a,d,i)},combinator:function(){var a=o.currentChar();if("/"===a){o.save();var b=o.$re(/^\/[a-z]+\//i);if(b)return o.forget(),new e.Combinator(b);o.restore()}if(">"===a||"+"===a||"~"===a||"|"===a||"^"===a){for(o.i++,"^"===a&&"^"===o.currentChar()&&(a="^^",o.i++);o.isWhitespace();)o.i++;return new e.Combinator(a)}return o.isWhitespace(-1)?new e.Combinator(" "):new e.Combinator(null)},lessSelector:function(){return this.selector(!0)},selector:function(a){for(var b,c,d,f,g,h,k,m=o.i;(a&&(c=this.extend())||a&&(h=o.$str("when"))||(f=this.element()))&&(h?k=j(this.conditions,"expected condition"):k?l("CSS guard can only be used at the end of selector"):c?g=g?g.concat(c):c:(g&&l("Extend can only be used at the end of selector"),d=o.currentChar(),b?b.push(f):b=[f],f=null),"{"!==d&&"}"!==d&&";"!==d&&","!==d&&")"!==d););if(b)return new e.Selector(b,g,k,m,i);g&&l("Extend must be used to extend a selector, it cannot be used on its own")},attribute:function(){if(o.$char("[")){var a,b,c,d=this.entities;return(a=d.variableCurly())||(a=j(/^(?:[_A-Za-z0-9-\*]*\|)?(?:[_A-Za-z0-9-]|\\.)+/)),c=o.$re(/^[|~*$^]?=/),c&&(b=d.quoted()||o.$re(/^[0-9]+%/)||o.$re(/^[\w-]+/)||d.variableCurly()),k("]"),new e.Attribute(a,c,b)}},block:function(){var a;if(o.$char("{")&&(a=this.primary())&&o.$char("}"))return a},blockRuleset:function(){var a=this.block();return a&&(a=new e.Ruleset(null,a)),a},detachedRuleset:function(){var a=this.blockRuleset();if(a)return new e.DetachedRuleset(a)},ruleset:function(){var a,c,d,f;for(o.save(),b.dumpLineNumbers&&(f=m(o.i));;){if(!(c=this.lessSelector()))break;if(a?a.push(c):a=[c],o.commentStore.length=0,c.condition&&a.length>1&&l("Guards are only currently allowed on a single selector."),!o.$char(","))break;c.condition&&l("Guards are only currently allowed on a single selector."),o.commentStore.length=0}if(a&&(d=this.block())){o.forget();var g=new e.Ruleset(a,d,b.strictImports);return b.dumpLineNumbers&&(g.debugInfo=f),g}o.restore()},rule:function(a){var c,d,f,g,h,j=o.i,k=o.currentChar();if("."!==k&&"#"!==k&&"&"!==k&&":"!==k)if(o.save(),c=this.variable()||this.ruleProperty()){if(h="string"==typeof c,h&&(d=this.detachedRuleset()),o.commentStore.length=0,!d){g=!h&&c.length>1&&c.pop().value;var l=!a&&(b.compress||h);if(l&&(d=this.value()),!d&&(d=this.anonymousValue()))return o.forget(),new e.Rule(c,d,!1,g,j,i);l||d||(d=this.value()),f=this.important()}if(d&&this.end())return o.forget(),new e.Rule(c,d,f,g,j,i);if(o.restore(),d&&!a)return this.rule(!0)}else o.forget()},anonymousValue:function(){var a=o.$re(/^([^@+\/'"*`(;{}-]*);/);if(a)return new e.Anonymous(a[1])},import:function(){var a,b,c=o.i,d=o.$re(/^@import?\s+/);if(d){var f=(d?this.importOptions():null)||{};if(a=this.entities.quoted()||this.entities.url())return b=this.mediaFeatures(),o.$char(";")||(o.i=c,l("missing semi-colon or unrecognised media features on import")),b=b&&new e.Value(b),new e.Import(a,b,f,c,i);o.i=c,l("malformed import statement")}},importOptions:function(){var a,b,c,d={};if(!o.$char("("))return null;do{if(a=this.importOption()){switch(b=a,c=!0,b){case"css":b="less",c=!1;break;case"once":b="multiple",c=!1}if(d[b]=c,!o.$char(","))break}}while(a);return k(")"),d},importOption:function(){var a=o.$re(/^(less|css|multiple|once|inline|reference|optional)/);if(a)return a[1]},mediaFeature:function(){var a,b,c=this.entities,d=[];o.save();do{if(a=c.keyword()||c.variable())d.push(a);else if(o.$char("(")){if(b=this.property(),a=this.value(),!o.$char(")"))return o.restore("Missing closing ')'"),null;if(b&&a)d.push(new e.Paren(new e.Rule(b,a,null,null,o.i,i,!0)));else{if(!a)return o.restore("badly formed media feature definition"),null;d.push(new e.Paren(a))}}}while(a);if(o.forget(),d.length>0)return new e.Expression(d)},mediaFeatures:function(){var a,b=this.entities,c=[];do{if(a=this.mediaFeature()){if(c.push(a),!o.$char(","))break}else if((a=b.variable())&&(c.push(a),!o.$char(",")))break}while(a);return c.length>0?c:null},media:function(){var a,c,d,f;if(b.dumpLineNumbers&&(f=m(o.i)),o.save(),o.$str("@media"))return a=this.mediaFeatures(),(c=this.block())?(o.forget(),d=new e.Media(c,a,o.i,i),b.dumpLineNumbers&&(d.debugInfo=f),d):void o.restore("media definitions require block statements after any features");o.restore()},plugin:function(){var a,b=o.i;if(o.$re(/^@plugin?\s+/)){var c={plugin:!0};if(a=this.entities.quoted()||this.entities.url())return o.$char(";")||(o.i=b,l("missing semi-colon on plugin")),new e.Import(a,null,c,b,i);o.i=b,l("malformed plugin statement")}},directive:function(){var a,c,d,f,g,h,j,k=o.i,n=!0,p=!0;if("@"===o.currentChar()){if(c=this.import()||this.plugin()||this.media())return c;if(o.save(),a=o.$re(/^@[a-z-]+/)){switch(f=a,"-"==a.charAt(1)&&a.indexOf("-",2)>0&&(f="@"+a.slice(a.indexOf("-",2)+1)),f){case"@counter-style":g=!0,n=!0;break;case"@charset":g=!0,n=!1;break;case"@namespace":h=!0,n=!1;break;case"@keyframes":g=!0;break;case"@host":case"@page":j=!0;break;case"@document":case"@supports":j=!0,p=!1}if(o.commentStore.length=0,g?(c=this.entity())||l("expected "+a+" identifier"):h?(c=this.expression())||l("expected "+a+" expression"):j&&(c=(o.$re(/^[^{;]+/)||"").trim())&&(c=new e.Anonymous(c)),n&&(d=this.blockRuleset()),d||!n&&c&&o.$char(";"))return o.forget(),new e.Directive(a,c,d,k,i,b.dumpLineNumbers?m(k):null,!1,p);o.restore("directive options not recognised")}}},value:function(){var a,b=[];do{if((a=this.expression())&&(b.push(a),!o.$char(",")))break}while(a);if(b.length>0)return new e.Value(b)},important:function(){if("!"===o.currentChar())return o.$re(/^! *important/)},sub:function(){var a,b;if(o.save(),o.$char("("))return(a=this.addition())&&o.$char(")")?(o.forget(),b=new e.Expression([a]),b.parens=!0,b):void o.restore("Expected ')'");o.restore()},multiplication:function(){var a,b,c,d,f;if(a=this.operand()){for(f=o.isWhitespace(-1);;){if(o.peek(/^\/[*\/]/))break;if(o.save(),!(c=o.$char("/")||o.$char("*"))){o.forget();break}if(!(b=this.operand())){o.restore();break}o.forget(),a.parensInOp=!0,b.parensInOp=!0,d=new e.Operation(c,[d||a,b],f),f=o.isWhitespace(-1)}return d||a}},addition:function(){var a,b,c,d,f;if(a=this.multiplication()){for(f=o.isWhitespace(-1);;){if(!(c=o.$re(/^[-+]\s+/)||!f&&(o.$char("+")||o.$char("-"))))break;if(!(b=this.multiplication()))break;a.parensInOp=!0,b.parensInOp=!0,d=new e.Operation(c,[d||a,b],f),f=o.isWhitespace(-1)}return d||a}},conditions:function(){var a,b,c,d=o.i;if(a=this.condition()){for(;;){if(!o.peek(/^,\s*(not\s*)?\(/)||!o.$char(","))break;if(!(b=this.condition()))break;c=new e.Condition("or",c||a,b,d)}return c||a}},condition:function(){var a,b,c,d,f=this.entities,g=o.i,h=!1;if(o.$str("not")&&(h=!0),k("("),a=this.addition()||f.keyword()||f.quoted())return o.$char(">")?d=o.$char("=")?">=":">":o.$char("<")?d=o.$char("=")?"<=":"<":o.$char("=")&&(d=o.$char(">")?"=>":o.$char("<")?"=<":"="),d?(b=this.addition()||f.keyword()||f.quoted(),b?c=new e.Condition(d,a,b,g,h):l("expected expression")):c=new e.Condition("=",a,new e.Keyword("true"),g,h),k(")"),o.$str("and")?new e.Condition("and",c,this.condition()):c},operand:function(){var a,b=this.entities;o.peek(/^-[@\(]/)&&(a=o.$char("-"));var c=this.sub()||b.dimension()||b.color()||b.variable()||b.call();return a&&(c.parensInOp=!0,c=new e.Negative(c)),c},expression:function(){var a,b,c=[];do{a=this.comment(),a?c.push(a):(a=this.addition()||this.entity())&&(c.push(a),o.peek(/^\/[\/*]/)||(b=o.$char("/"))&&c.push(new e.Anonymous(b)))}while(a);if(c.length>0)return new e.Expression(c)},property:function(){var a=o.$re(/^(\*?-?[_a-zA-Z0-9-]+)\s*:/);if(a)return a[1]},ruleProperty:function(){function a(a){var b=o.i,c=o.$re(a);if(c)return f.push(b),d.push(c[1])}var b,c,d=[],f=[];o.save();var g=o.$re(/^([_a-zA-Z0-9-]+)\s*:/);if(g)return d=[new e.Keyword(g[1])],o.forget(),d;for(a(/^(\*?)/);;)if(!a(/^((?:[\w-]+)|(?:@\{[\w-]+\}))/))break;if(d.length>1&&a(/^((?:\+_|\+)?)\s*:/)){for(o.forget(),""===d[0]&&(d.shift(),f.shift()),c=0;c<d.length;c++)b=d[c],d[c]="@"!==b.charAt(0)?new e.Keyword(b):new e.Variable("@"+b.slice(2,-1),f[c],i);return d}o.restore()}}}};i.serializeVars=function(a){var b="";for(var c in a)if(Object.hasOwnProperty.call(a,c)){var d=a[c];b+=("@"===c[0]?"":"@")+c+": "+d+(";"===String(d).slice(-1)?"":";")}return b},b.exports=i},{"../less-error":31,"../tree":61,"../utils":82,"../visitors":86,"./parser-input":36}],38:[function(a,b,c){var d=function(a){this.less=a,this.visitors=[],this.preProcessors=[],this.postProcessors=[],this.installedPlugins=[],this.fileManagers=[]};d.prototype.addPlugins=function(a){if(a)for(var b=0;b<a.length;b++)this.addPlugin(a[b])},d.prototype.addPlugin=function(a){this.installedPlugins.push(a),a.install(this.less,this)},d.prototype.addVisitor=function(a){this.visitors.push(a)},d.prototype.addPreProcessor=function(a,b){var c;for(c=0;c<this.preProcessors.length&&!(this.preProcessors[c].priority>=b);c++);this.preProcessors.splice(c,0,{preProcessor:a,priority:b})},d.prototype.addPostProcessor=function(a,b){var c;for(c=0;c<this.postProcessors.length&&!(this.postProcessors[c].priority>=b);c++);this.postProcessors.splice(c,0,{postProcessor:a,priority:b})},d.prototype.addFileManager=function(a){this.fileManagers.push(a)},d.prototype.getPreProcessors=function(){for(var a=[],b=0;b<this.preProcessors.length;b++)a.push(this.preProcessors[b].preProcessor);return a},d.prototype.getPostProcessors=function(){for(var a=[],b=0;b<this.postProcessors.length;b++)a.push(this.postProcessors[b].postProcessor);return a},d.prototype.getVisitors=function(){return this.visitors},d.prototype.getFileManagers=function(){return this.fileManagers},b.exports=d},{}],39:[function(a,b,c){var d=a("../less-error"),e=a("../tree");(b.exports=function(a,b){this.fileInfo=b}).prototype.eval=function(a,b){var c,f={};c={add:function(a,b){f[a]=b},addMultiple:function(a){Object.keys(a).forEach(function(b){f[b]=a[b]})}};try{new Function("functions","tree","fileInfo",a)(c,e,this.fileInfo)}catch(a){b(new d({message:"Plugin evaluation error: '"+a.name+": "+a.message.replace(/["]/g,"'")+"'",filename:this.fileInfo.filename}),null)}b(null,{functions:f})}},{"../less-error":31,"../tree":61}],40:[function(a,b,c){var d;b.exports=function(b,c,e){var f=function(b,e,g){if("function"==typeof e&&(g=e,e={}),!g){d||(d="undefined"==typeof Promise?a("promise"):Promise);var h=this;return new d(function(a,c){f.call(h,b,e,function(b,d){b?c(b):a(d)})})}this.parse(b,e,function(a,b,d,e){if(a)return g(a);var f;try{f=new c(b,d).toCSS(e)}catch(a){return g(a)}g(null,f)})};return f}},{promise:void 0}],41:[function(a,b,c){b.exports=function(a,b){var c=function(a){this.options=a};return c.prototype.toCSS=function(b,c,d){var e=new a({contentsIgnoredCharsMap:d.contentsIgnoredChars,rootNode:b,contentsMap:d.contents,sourceMapFilename:this.options.sourceMapFilename,sourceMapURL:this.options.sourceMapURL,outputFilename:this.options.sourceMapOutputFilename,sourceMapBasepath:this.options.sourceMapBasepath,sourceMapRootpath:this.options.sourceMapRootpath,outputSourceFiles:this.options.outputSourceFiles,sourceMapGenerator:this.options.sourceMapGenerator,sourceMapFileInline:this.options.sourceMapFileInline}),f=e.toCSS(c);return this.sourceMap=e.sourceMap,this.sourceMapURL=e.sourceMapURL,this.options.sourceMapInputFilename&&(this.sourceMapInputFilename=e.normalizeFilename(this.options.sourceMapInputFilename)),f+this.getCSSAppendage()},c.prototype.getCSSAppendage=function(){var a=this.sourceMapURL;if(this.options.sourceMapFileInline){if(void 0===this.sourceMap)return"";a="data:application/json;base64,"+b.encodeBase64(this.sourceMap)}return a?"/*# sourceMappingURL="+a+" */":""},c.prototype.getExternalSourceMap=function(){return this.sourceMap},c.prototype.setExternalSourceMap=function(a){this.sourceMap=a},c.prototype.isInline=function(){return this.options.sourceMapFileInline},c.prototype.getSourceMapURL=function(){return this.sourceMapURL},c.prototype.getOutputFilename=function(){return this.options.sourceMapOutputFilename},c.prototype.getInputFilename=function(){return this.sourceMapInputFilename},c}},{}],42:[function(a,b,c){b.exports=function(a){var b=function(b){this._css=[],this._rootNode=b.rootNode,this._contentsMap=b.contentsMap,
this._contentsIgnoredCharsMap=b.contentsIgnoredCharsMap,b.sourceMapFilename&&(this._sourceMapFilename=b.sourceMapFilename.replace(/\\/g,"/")),this._outputFilename=b.outputFilename,this.sourceMapURL=b.sourceMapURL,b.sourceMapBasepath&&(this._sourceMapBasepath=b.sourceMapBasepath.replace(/\\/g,"/")),b.sourceMapRootpath?(this._sourceMapRootpath=b.sourceMapRootpath.replace(/\\/g,"/"),"/"!==this._sourceMapRootpath.charAt(this._sourceMapRootpath.length-1)&&(this._sourceMapRootpath+="/")):this._sourceMapRootpath="",this._outputSourceFiles=b.outputSourceFiles,this._sourceMapGeneratorConstructor=a.getSourceMapGenerator(),this._lineNumber=0,this._column=0};return b.prototype.normalizeFilename=function(a){return a=a.replace(/\\/g,"/"),this._sourceMapBasepath&&0===a.indexOf(this._sourceMapBasepath)&&(a=a.substring(this._sourceMapBasepath.length),"\\"!==a.charAt(0)&&"/"!==a.charAt(0)||(a=a.substring(1))),(this._sourceMapRootpath||"")+a},b.prototype.add=function(a,b,c,d){if(a){var e,f,g,h,i;if(b){var j=this._contentsMap[b.filename];this._contentsIgnoredCharsMap[b.filename]&&(c-=this._contentsIgnoredCharsMap[b.filename],c<0&&(c=0),j=j.slice(this._contentsIgnoredCharsMap[b.filename])),j=j.substring(0,c),f=j.split("\n"),h=f[f.length-1]}if(e=a.split("\n"),g=e[e.length-1],b)if(d)for(i=0;i<e.length;i++)this._sourceMapGenerator.addMapping({generated:{line:this._lineNumber+i+1,column:0===i?this._column:0},original:{line:f.length+i,column:0===i?h.length:0},source:this.normalizeFilename(b.filename)});else this._sourceMapGenerator.addMapping({generated:{line:this._lineNumber+1,column:this._column},original:{line:f.length,column:h.length},source:this.normalizeFilename(b.filename)});1===e.length?this._column+=g.length:(this._lineNumber+=e.length-1,this._column=g.length),this._css.push(a)}},b.prototype.isEmpty=function(){return 0===this._css.length},b.prototype.toCSS=function(a){if(this._sourceMapGenerator=new this._sourceMapGeneratorConstructor({file:this._outputFilename,sourceRoot:null}),this._outputSourceFiles)for(var b in this._contentsMap)if(this._contentsMap.hasOwnProperty(b)){var c=this._contentsMap[b];this._contentsIgnoredCharsMap[b]&&(c=c.slice(this._contentsIgnoredCharsMap[b])),this._sourceMapGenerator.setSourceContent(this.normalizeFilename(b),c)}if(this._rootNode.genCSS(a,this),this._css.length>0){var d,e=JSON.stringify(this._sourceMapGenerator.toJSON());this.sourceMapURL?d=this.sourceMapURL:this._sourceMapFilename&&(d=this._sourceMapFilename),this.sourceMapURL=d,this.sourceMap=e}return this._css.join("")},b}},{}],43:[function(a,b,c){var d=a("./contexts"),e=a("./visitors"),f=a("./tree");b.exports=function(a,b){b=b||{};var c,g=b.variables,h=new d.Eval(b);"object"!=typeof g||Array.isArray(g)||(g=Object.keys(g).map(function(a){var b=g[a];return b instanceof f.Value||(b instanceof f.Expression||(b=new f.Expression([b])),b=new f.Value([b])),new f.Rule("@"+a,b,!1,null,0)}),h.frames=[new f.Ruleset(null,g)]);var i,j=[],k=[new e.JoinSelectorVisitor,new e.ExtendVisitor,new e.ToCSSVisitor({compress:Boolean(b.compress)})];if(b.pluginManager){var l=b.pluginManager.getVisitors();for(i=0;i<l.length;i++){var m=l[i];m.isPreEvalVisitor?j.push(m):m.isPreVisitor?k.splice(0,0,m):k.push(m)}}for(i=0;i<j.length;i++)j[i].run(a);for(c=a.eval(h),i=0;i<k.length;i++)k[i].run(c);return c}},{"./contexts":10,"./tree":61,"./visitors":86}],44:[function(a,b,c){var d=a("./node"),e=function(a){this.value=a};e.prototype=new d,e.prototype.type="Alpha",e.prototype.accept=function(a){this.value=a.visit(this.value)},e.prototype.eval=function(a){return this.value.eval?new e(this.value.eval(a)):this},e.prototype.genCSS=function(a,b){b.add("alpha(opacity="),this.value.genCSS?this.value.genCSS(a,b):b.add(this.value),b.add(")")},b.exports=e},{"./node":69}],45:[function(a,b,c){var d=a("./node"),e=function(a,b,c,d,e,f){this.value=a,this.index=b,this.mapLines=d,this.currentFileInfo=c,this.rulesetLike=void 0!==e&&e,this.isReferenced=f||!1};e.prototype=new d,e.prototype.type="Anonymous",e.prototype.eval=function(){return new e(this.value,this.index,this.currentFileInfo,this.mapLines,this.rulesetLike,this.isReferenced)},e.prototype.compare=function(a){return a.toCSS&&this.toCSS()===a.toCSS()?0:void 0},e.prototype.isRulesetLike=function(){return this.rulesetLike},e.prototype.genCSS=function(a,b){b.add(this.value,this.currentFileInfo,this.index,this.mapLines)},e.prototype.markReferenced=function(){this.isReferenced=!0},e.prototype.getIsReferenced=function(){return!this.currentFileInfo||!this.currentFileInfo.reference||this.isReferenced},b.exports=e},{"./node":69}],46:[function(a,b,c){var d=a("./node"),e=function(a,b){this.key=a,this.value=b};e.prototype=new d,e.prototype.type="Assignment",e.prototype.accept=function(a){this.value=a.visit(this.value)},e.prototype.eval=function(a){return this.value.eval?new e(this.key,this.value.eval(a)):this},e.prototype.genCSS=function(a,b){b.add(this.key+"="),this.value.genCSS?this.value.genCSS(a,b):b.add(this.value)},b.exports=e},{"./node":69}],47:[function(a,b,c){var d=a("./node"),e=function(a,b,c){this.key=a,this.op=b,this.value=c};e.prototype=new d,e.prototype.type="Attribute",e.prototype.eval=function(a){return new e(this.key.eval?this.key.eval(a):this.key,this.op,this.value&&this.value.eval?this.value.eval(a):this.value)},e.prototype.genCSS=function(a,b){b.add(this.toCSS(a))},e.prototype.toCSS=function(a){var b=this.key.toCSS?this.key.toCSS(a):this.key;return this.op&&(b+=this.op,b+=this.value.toCSS?this.value.toCSS(a):this.value),"["+b+"]"},b.exports=e},{"./node":69}],48:[function(a,b,c){var d=a("./node"),e=a("../functions/function-caller"),f=function(a,b,c,d){this.name=a,this.args=b,this.index=c,this.currentFileInfo=d};f.prototype=new d,f.prototype.type="Call",f.prototype.accept=function(a){this.args&&(this.args=a.visitArray(this.args))},f.prototype.eval=function(a){var b,c=this.args.map(function(b){return b.eval(a)}),d=new e(this.name,a,this.index,this.currentFileInfo);if(d.isValid())try{if(null!=(b=d.call(c)))return b}catch(a){throw{type:a.type||"Runtime",message:"error evaluating function `"+this.name+"`"+(a.message?": "+a.message:""),index:this.index,filename:this.currentFileInfo.filename}}return new f(this.name,c,this.index,this.currentFileInfo)},f.prototype.genCSS=function(a,b){b.add(this.name+"(",this.currentFileInfo,this.index);for(var c=0;c<this.args.length;c++)this.args[c].genCSS(a,b),c+1<this.args.length&&b.add(", ");b.add(")")},b.exports=f},{"../functions/function-caller":20,"./node":69}],49:[function(a,b,c){function d(a,b){return Math.min(Math.max(a,0),b)}function e(a){return"#"+a.map(function(a){return a=d(Math.round(a),255),(a<16?"0":"")+a.toString(16)}).join("")}var f=a("./node"),g=a("../data/colors"),h=function(a,b,c){Array.isArray(a)?this.rgb=a:6==a.length?this.rgb=a.match(/.{2}/g).map(function(a){return parseInt(a,16)}):this.rgb=a.split("").map(function(a){return parseInt(a+a,16)}),this.alpha="number"==typeof b?b:1,void 0!==c&&(this.value=c)};h.prototype=new f,h.prototype.type="Color",h.prototype.luma=function(){var a=this.rgb[0]/255,b=this.rgb[1]/255,c=this.rgb[2]/255;return a=a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4),b=b<=.03928?b/12.92:Math.pow((b+.055)/1.055,2.4),c=c<=.03928?c/12.92:Math.pow((c+.055)/1.055,2.4),.2126*a+.7152*b+.0722*c},h.prototype.genCSS=function(a,b){b.add(this.toCSS(a))},h.prototype.toCSS=function(a,b){var c,e,f=a&&a.compress&&!b;if(this.value)return this.value;if((e=this.fround(a,this.alpha))<1)return"rgba("+this.rgb.map(function(a){return d(Math.round(a),255)}).concat(d(e,1)).join(","+(f?"":" "))+")";if(c=this.toRGB(),f){var g=c.split("");g[1]===g[2]&&g[3]===g[4]&&g[5]===g[6]&&(c="#"+g[1]+g[3]+g[5])}return c},h.prototype.operate=function(a,b,c){for(var d=[],e=this.alpha*(1-c.alpha)+c.alpha,f=0;f<3;f++)d[f]=this._operate(a,b,this.rgb[f],c.rgb[f]);return new h(d,e)},h.prototype.toRGB=function(){return e(this.rgb)},h.prototype.toHSL=function(){var a,b,c=this.rgb[0]/255,d=this.rgb[1]/255,e=this.rgb[2]/255,f=this.alpha,g=Math.max(c,d,e),h=Math.min(c,d,e),i=(g+h)/2,j=g-h;if(g===h)a=b=0;else{switch(b=i>.5?j/(2-g-h):j/(g+h),g){case c:a=(d-e)/j+(d<e?6:0);break;case d:a=(e-c)/j+2;break;case e:a=(c-d)/j+4}a/=6}return{h:360*a,s:b,l:i,a:f}},h.prototype.toHSV=function(){var a,b,c=this.rgb[0]/255,d=this.rgb[1]/255,e=this.rgb[2]/255,f=this.alpha,g=Math.max(c,d,e),h=Math.min(c,d,e),i=g,j=g-h;if(b=0===g?0:j/g,g===h)a=0;else{switch(g){case c:a=(d-e)/j+(d<e?6:0);break;case d:a=(e-c)/j+2;break;case e:a=(c-d)/j+4}a/=6}return{h:360*a,s:b,v:i,a:f}},h.prototype.toARGB=function(){return e([255*this.alpha].concat(this.rgb))},h.prototype.compare=function(a){return a.rgb&&a.rgb[0]===this.rgb[0]&&a.rgb[1]===this.rgb[1]&&a.rgb[2]===this.rgb[2]&&a.alpha===this.alpha?0:void 0},h.fromKeyword=function(a){var b,c=a.toLowerCase();if(g.hasOwnProperty(c)?b=new h(g[c].slice(1)):"transparent"===c&&(b=new h([0,0,0],0)),b)return b.value=a,b},b.exports=h},{"../data/colors":11,"./node":69}],50:[function(a,b,c){var d=a("./node"),e=function(a){" "===a?(this.value=" ",this.emptyOrWhitespace=!0):(this.value=a?a.trim():"",this.emptyOrWhitespace=""===this.value)};e.prototype=new d,e.prototype.type="Combinator";var f={"":!0," ":!0,"|":!0};e.prototype.genCSS=function(a,b){var c=a.compress||f[this.value]?"":" ";b.add(c+this.value+c)},b.exports=e},{"./node":69}],51:[function(a,b,c){var d=a("./node"),e=a("./debug-info"),f=function(a,b,c,d){this.value=a,this.isLineComment=b,this.currentFileInfo=d};f.prototype=new d,f.prototype.type="Comment",f.prototype.genCSS=function(a,b){this.debugInfo&&b.add(e(a,this),this.currentFileInfo,this.index),b.add(this.value)},f.prototype.isSilent=function(a){var b=this.currentFileInfo&&this.currentFileInfo.reference&&!this.isReferenced,c=a.compress&&"!"!==this.value[2];return this.isLineComment||b||c},f.prototype.markReferenced=function(){this.isReferenced=!0},b.exports=f},{"./debug-info":53,"./node":69}],52:[function(a,b,c){var d=a("./node"),e=function(a,b,c,d,e){this.op=a.trim(),this.lvalue=b,this.rvalue=c,this.index=d,this.negate=e};e.prototype=new d,e.prototype.type="Condition",e.prototype.accept=function(a){this.lvalue=a.visit(this.lvalue),this.rvalue=a.visit(this.rvalue)},e.prototype.eval=function(a){var b=function(a,b,c){switch(a){case"and":return b&&c;case"or":return b||c;default:switch(d.compare(b,c)){case-1:return"<"===a||"=<"===a||"<="===a;case 0:return"="===a||">="===a||"=<"===a||"<="===a;case 1:return">"===a||">="===a;default:return!1}}}(this.op,this.lvalue.eval(a),this.rvalue.eval(a));return this.negate?!b:b},b.exports=e},{"./node":69}],53:[function(a,b,c){var d=function(a,b,c){var e="";if(a.dumpLineNumbers&&!a.compress)switch(a.dumpLineNumbers){case"comments":e=d.asComment(b);break;case"mediaquery":e=d.asMediaQuery(b);break;case"all":e=d.asComment(b)+(c||"")+d.asMediaQuery(b)}return e};d.asComment=function(a){return"/* line "+a.debugInfo.lineNumber+", "+a.debugInfo.fileName+" */\n"},d.asMediaQuery=function(a){var b=a.debugInfo.fileName;return/^[a-z]+:\/\//i.test(b)||(b="file://"+b),"@media -sass-debug-info{filename{font-family:"+b.replace(/([.:\/\\])/g,function(a){return"\\"==a&&(a="/"),"\\"+a})+"}line{font-family:\\00003"+a.debugInfo.lineNumber+"}}\n"},b.exports=d},{}],54:[function(a,b,c){var d=a("./node"),e=a("../contexts"),f=function(a,b){this.ruleset=a,this.frames=b};f.prototype=new d,f.prototype.type="DetachedRuleset",f.prototype.evalFirst=!0,f.prototype.accept=function(a){this.ruleset=a.visit(this.ruleset)},f.prototype.eval=function(a){var b=this.frames||a.frames.slice(0);return new f(this.ruleset,b)},f.prototype.callEval=function(a){return this.ruleset.eval(this.frames?new e.Eval(a,this.frames.concat(a.frames)):a)},b.exports=f},{"../contexts":10,"./node":69}],55:[function(a,b,c){var d=a("./node"),e=a("../data/unit-conversions"),f=a("./unit"),g=a("./color"),h=function(a,b){this.value=parseFloat(a),this.unit=b&&b instanceof f?b:new f(b?[b]:void 0)};h.prototype=new d,h.prototype.type="Dimension",h.prototype.accept=function(a){this.unit=a.visit(this.unit)},h.prototype.eval=function(a){return this},h.prototype.toColor=function(){return new g([this.value,this.value,this.value])},h.prototype.genCSS=function(a,b){if(a&&a.strictUnits&&!this.unit.isSingular())throw new Error("Multiple units in dimension. Correct the units or use the unit function. Bad unit: "+this.unit.toString());var c=this.fround(a,this.value),d=String(c);if(0!==c&&c<1e-6&&c>-1e-6&&(d=c.toFixed(20).replace(/0+$/,"")),a&&a.compress){if(0===c&&this.unit.isLength())return void b.add(d);c>0&&c<1&&(d=d.substr(1))}b.add(d),this.unit.genCSS(a,b)},h.prototype.operate=function(a,b,c){var d=this._operate(a,b,this.value,c.value),e=this.unit.clone();if("+"===b||"-"===b)if(0===e.numerator.length&&0===e.denominator.length)e=c.unit.clone(),this.unit.backupUnit&&(e.backupUnit=this.unit.backupUnit);else if(0===c.unit.numerator.length&&0===e.denominator.length);else{if(c=c.convertTo(this.unit.usedUnits()),a.strictUnits&&c.unit.toString()!==e.toString())throw new Error("Incompatible units. Change the units or use the unit function. Bad units: '"+e.toString()+"' and '"+c.unit.toString()+"'.");d=this._operate(a,b,this.value,c.value)}else"*"===b?(e.numerator=e.numerator.concat(c.unit.numerator).sort(),e.denominator=e.denominator.concat(c.unit.denominator).sort(),e.cancel()):"/"===b&&(e.numerator=e.numerator.concat(c.unit.denominator).sort(),e.denominator=e.denominator.concat(c.unit.numerator).sort(),e.cancel());return new h(d,e)},h.prototype.compare=function(a){var b,c;if(a instanceof h){if(this.unit.isEmpty()||a.unit.isEmpty())b=this,c=a;else if(b=this.unify(),c=a.unify(),0!==b.unit.compare(c.unit))return;return d.numericCompare(b.value,c.value)}},h.prototype.unify=function(){return this.convertTo({length:"px",duration:"s",angle:"rad"})},h.prototype.convertTo=function(a){var b,c,d,f,g,i=this.value,j=this.unit.clone(),k={};if("string"==typeof a){for(b in e)e[b].hasOwnProperty(a)&&(k={},k[b]=a);a=k}g=function(a,b){return d.hasOwnProperty(a)?(b?i/=d[a]/d[f]:i*=d[a]/d[f],f):a};for(c in a)a.hasOwnProperty(c)&&(f=a[c],d=e[c],j.map(g));return j.cancel(),new h(i,j)},b.exports=h},{"../data/unit-conversions":13,"./color":49,"./node":69,"./unit":78}],56:[function(a,b,c){var d=a("./node"),e=a("./selector"),f=a("./ruleset"),g=function(a,b,c,d,f,g,h,i){var j;if(this.name=a,this.value=b,c)for(Array.isArray(c)?this.rules=c:(this.rules=[c],this.rules[0].selectors=new e([],null,null,this.index,f).createEmptySelectors()),j=0;j<this.rules.length;j++)this.rules[j].allowImports=!0;this.index=d,this.currentFileInfo=f,this.debugInfo=g,this.isReferenced=h,this.isRooted=i||!1};g.prototype=new d,g.prototype.type="Directive",g.prototype.accept=function(a){var b=this.value,c=this.rules;c&&(this.rules=a.visitArray(c)),b&&(this.value=a.visit(b))},g.prototype.isRulesetLike=function(){return this.rules||!this.isCharset()},g.prototype.isCharset=function(){return"@charset"===this.name},g.prototype.genCSS=function(a,b){var c=this.value,d=this.rules;b.add(this.name,this.currentFileInfo,this.index),c&&(b.add(" "),c.genCSS(a,b)),d?this.outputRuleset(a,b,d):b.add(";")},g.prototype.eval=function(a){var b,c,d=this.value,e=this.rules;return b=a.mediaPath,c=a.mediaBlocks,a.mediaPath=[],a.mediaBlocks=[],d&&(d=d.eval(a)),e&&(e=[e[0].eval(a)],e[0].root=!0),a.mediaPath=b,a.mediaBlocks=c,new g(this.name,d,e,this.index,this.currentFileInfo,this.debugInfo,this.isReferenced,this.isRooted)},g.prototype.variable=function(a){if(this.rules)return f.prototype.variable.call(this.rules[0],a)},g.prototype.find=function(){if(this.rules)return f.prototype.find.apply(this.rules[0],arguments)},g.prototype.rulesets=function(){if(this.rules)return f.prototype.rulesets.apply(this.rules[0])},g.prototype.markReferenced=function(){var a,b;if(this.isReferenced=!0,this.rules)for(b=this.rules,a=0;a<b.length;a++)b[a].markReferenced&&b[a].markReferenced()},g.prototype.getIsReferenced=function(){return!this.currentFileInfo||!this.currentFileInfo.reference||this.isReferenced},g.prototype.outputRuleset=function(a,b,c){var d,e=c.length;if(a.tabLevel=1+(0|a.tabLevel),a.compress){for(b.add("{"),d=0;d<e;d++)c[d].genCSS(a,b);return b.add("}"),void a.tabLevel--}var f="\n"+Array(a.tabLevel).join("  "),g=f+"  ";if(e){for(b.add(" {"+g),c[0].genCSS(a,b),d=1;d<e;d++)b.add(g),c[d].genCSS(a,b);b.add(f+"}")}else b.add(" {"+f+"}");a.tabLevel--},b.exports=g},{"./node":69,"./ruleset":75,"./selector":76}],57:[function(a,b,c){var d=a("./node"),e=a("./paren"),f=a("./combinator"),g=function(a,b,c,d){this.combinator=a instanceof f?a:new f(a),this.value="string"==typeof b?b.trim():b||"",this.index=c,this.currentFileInfo=d};g.prototype=new d,g.prototype.type="Element",g.prototype.accept=function(a){var b=this.value;this.combinator=a.visit(this.combinator),"object"==typeof b&&(this.value=a.visit(b))},g.prototype.eval=function(a){return new g(this.combinator,this.value.eval?this.value.eval(a):this.value,this.index,this.currentFileInfo)},g.prototype.genCSS=function(a,b){b.add(this.toCSS(a),this.currentFileInfo,this.index)},g.prototype.toCSS=function(a){a=a||{};var b=this.value,c=a.firstSelector;return b instanceof e&&(a.firstSelector=!0),b=b.toCSS?b.toCSS(a):b,a.firstSelector=c,""===b&&"&"===this.combinator.value.charAt(0)?"":this.combinator.toCSS(a)+b},b.exports=g},{"./combinator":50,"./node":69,"./paren":71}],58:[function(a,b,c){var d=a("./node"),e=a("./paren"),f=a("./comment"),g=function(a){if(this.value=a,!a)throw new Error("Expression requires an array parameter")};g.prototype=new d,g.prototype.type="Expression",g.prototype.accept=function(a){this.value=a.visitArray(this.value)},g.prototype.eval=function(a){var b,c=this.parens&&!this.parensInOp,d=!1;return c&&a.inParenthesis(),this.value.length>1?b=new g(this.value.map(function(b){return b.eval(a)})):1===this.value.length?(this.value[0].parens&&!this.value[0].parensInOp&&(d=!0),b=this.value[0].eval(a)):b=this,c&&a.outOfParenthesis(),this.parens&&this.parensInOp&&!a.isMathOn()&&!d&&(b=new e(b)),b},g.prototype.genCSS=function(a,b){for(var c=0;c<this.value.length;c++)this.value[c].genCSS(a,b),c+1<this.value.length&&b.add(" ")},g.prototype.throwAwayComments=function(){this.value=this.value.filter(function(a){return!(a instanceof f)})},g.prototype.markReferenced=function(){this.value.forEach(function(a){a.markReferenced&&a.markReferenced()})},b.exports=g},{"./comment":51,"./node":69,"./paren":71}],59:[function(a,b,c){var d=a("./node"),e=function a(b,c,d){switch(this.selector=b,this.option=c,this.index=d,this.object_id=a.next_id++,this.parent_ids=[this.object_id],c){case"all":this.allowBefore=!0,this.allowAfter=!0;break;default:this.allowBefore=!1,this.allowAfter=!1}};e.next_id=0,e.prototype=new d,e.prototype.type="Extend",e.prototype.accept=function(a){this.selector=a.visit(this.selector)},e.prototype.eval=function(a){return new e(this.selector.eval(a),this.option,this.index)},e.prototype.clone=function(a){return new e(this.selector,this.option,this.index)},e.prototype.findSelfSelectors=function(a){var b,c,d=[];for(b=0;b<a.length;b++)c=a[b].elements,b>0&&c.length&&""===c[0].combinator.value&&(c[0].combinator.value=" "),d=d.concat(a[b].elements);this.selfSelectors=[{elements:d}]},b.exports=e},{"./node":69}],60:[function(a,b,c){var d=a("./node"),e=a("./media"),f=a("./url"),g=a("./quoted"),h=a("./ruleset"),i=a("./anonymous"),j=function(a,b,c,d,e){if(this.options=c,this.index=d,this.path=a,this.features=b,this.currentFileInfo=e,void 0!==this.options.less||this.options.inline)this.css=!this.options.less||this.options.inline;else{var f=this.getPath();f&&/[#\.\&\?\/]css([\?;].*)?$/.test(f)&&(this.css=!0)}};j.prototype=new d,j.prototype.type="Import",j.prototype.accept=function(a){this.features&&(this.features=a.visit(this.features)),this.path=a.visit(this.path),this.options.plugin||this.options.inline||!this.root||(this.root=a.visit(this.root))},j.prototype.genCSS=function(a,b){this.css&&void 0===this.path.currentFileInfo.reference&&(b.add("@import ",this.currentFileInfo,this.index),this.path.genCSS(a,b),this.features&&(b.add(" "),this.features.genCSS(a,b)),b.add(";"))},j.prototype.getPath=function(){return this.path instanceof f?this.path.value.value:this.path.value},j.prototype.isVariableImport=function(){var a=this.path;return a instanceof f&&(a=a.value),!(a instanceof g)||a.containsVariables()},j.prototype.evalForImport=function(a){var b=this.path;return b instanceof f&&(b=b.value),new j(b.eval(a),this.features,this.options,this.index,this.currentFileInfo)},j.prototype.evalPath=function(a){var b=this.path.eval(a),c=this.currentFileInfo&&this.currentFileInfo.rootpath;if(!(b instanceof f)){if(c){var d=b.value;d&&a.isPathRelative(d)&&(b.value=c+d)}b.value=a.normalizePath(b.value)}return b},j.prototype.eval=function(a){var b,c,d=this.features&&this.features.eval(a);if(this.options.plugin)return c=a.frames[0]&&a.frames[0].functionRegistry,c&&this.root&&this.root.functions&&c.addMultiple(this.root.functions),[];if(this.skip&&("function"==typeof this.skip&&(this.skip=this.skip()),this.skip))return[];if(this.options.inline){var f=new i(this.root,0,{filename:this.importedFilename,reference:this.path.currentFileInfo&&this.path.currentFileInfo.reference},!0,!0,!1);return this.features?new e([f],this.features.value):[f]}if(this.css){var g=new j(this.evalPath(a),d,this.options,this.index);if(!g.css&&this.error)throw this.error;return g}return b=new h(null,this.root.rules.slice(0)),b.evalImports(a),this.features?new e(b.rules,this.features.value):b.rules},b.exports=j},{"./anonymous":45,"./media":65,"./node":69,"./quoted":72,"./ruleset":75,"./url":79}],61:[function(a,b,c){var d={};d.Node=a("./node"),d.Alpha=a("./alpha"),d.Color=a("./color"),d.Directive=a("./directive"),d.DetachedRuleset=a("./detached-ruleset"),d.Operation=a("./operation"),d.Dimension=a("./dimension"),d.Unit=a("./unit"),d.Keyword=a("./keyword"),d.Variable=a("./variable"),d.Ruleset=a("./ruleset"),d.Element=a("./element"),d.Attribute=a("./attribute"),d.Combinator=a("./combinator"),d.Selector=a("./selector"),d.Quoted=a("./quoted"),d.Expression=a("./expression"),d.Rule=a("./rule"),d.Call=a("./call"),d.URL=a("./url"),d.Import=a("./import"),d.mixin={Call:a("./mixin-call"),Definition:a("./mixin-definition")},d.Comment=a("./comment"),d.Anonymous=a("./anonymous"),d.Value=a("./value"),d.JavaScript=a("./javascript"),d.Assignment=a("./assignment"),d.Condition=a("./condition"),d.Paren=a("./paren"),d.Media=a("./media"),d.UnicodeDescriptor=a("./unicode-descriptor"),d.Negative=a("./negative"),d.Extend=a("./extend"),d.RulesetCall=a("./ruleset-call"),b.exports=d},{"./alpha":44,"./anonymous":45,"./assignment":46,"./attribute":47,"./call":48,"./color":49,"./combinator":50,"./comment":51,"./condition":52,"./detached-ruleset":54,"./dimension":55,"./directive":56,"./element":57,"./expression":58,"./extend":59,"./import":60,"./javascript":62,"./keyword":64,"./media":65,"./mixin-call":66,"./mixin-definition":67,"./negative":68,"./node":69,"./operation":70,"./paren":71,"./quoted":72,"./rule":73,"./ruleset":75,"./ruleset-call":74,"./selector":76,"./unicode-descriptor":77,"./unit":78,"./url":79,"./value":80,"./variable":81}],62:[function(a,b,c){var d=a("./js-eval-node"),e=a("./dimension"),f=a("./quoted"),g=a("./anonymous"),h=function(a,b,c,d){this.escaped=b,this.expression=a,this.index=c,this.currentFileInfo=d};h.prototype=new d,h.prototype.type="JavaScript",h.prototype.eval=function(a){var b=this.evaluateJavaScript(this.expression,a);return"number"==typeof b?new e(b):"string"==typeof b?new f('"'+b+'"',b,this.escaped,this.index):new g(Array.isArray(b)?b.join(", "):b)},b.exports=h},{"./anonymous":45,"./dimension":55,"./js-eval-node":63,"./quoted":72}],63:[function(a,b,c){var d=a("./node"),e=a("./variable"),f=function(){};f.prototype=new d,f.prototype.evaluateJavaScript=function(a,b){var c,d=this,f={};if(void 0!==b.javascriptEnabled&&!b.javascriptEnabled)throw{message:"You are using JavaScript, which has been disabled.",filename:this.currentFileInfo.filename,index:this.index};a=a.replace(/@\{([\w-]+)\}/g,function(a,c){return d.jsify(new e("@"+c,d.index,d.currentFileInfo).eval(b))});try{a=new Function("return ("+a+")")}catch(b){throw{message:"JavaScript evaluation error: "+b.message+" from `"+a+"`",filename:this.currentFileInfo.filename,index:this.index}}var g=b.frames[0].variables();for(var h in g)g.hasOwnProperty(h)&&(f[h.slice(1)]={value:g[h].value,toJS:function(){return this.value.eval(b).toCSS()}});try{c=a.call(f)}catch(a){throw{message:"JavaScript evaluation error: '"+a.name+": "+a.message.replace(/["]/g,"'")+"'",filename:this.currentFileInfo.filename,index:this.index}}return c},f.prototype.jsify=function(a){return Array.isArray(a.value)&&a.value.length>1?"["+a.value.map(function(a){return a.toCSS()}).join(", ")+"]":a.toCSS()},b.exports=f},{"./node":69,"./variable":81}],64:[function(a,b,c){var d=a("./node"),e=function(a){this.value=a};e.prototype=new d,e.prototype.type="Keyword",e.prototype.genCSS=function(a,b){if("%"===this.value)throw{type:"Syntax",message:"Invalid % without number"};b.add(this.value)},e.True=new e("true"),e.False=new e("false"),b.exports=e},{"./node":69}],65:[function(a,b,c){var d=a("./ruleset"),e=a("./value"),f=a("./selector"),g=a("./anonymous"),h=a("./expression"),i=a("./directive"),j=function(a,b,c,g){this.index=c,this.currentFileInfo=g;var h=new f([],null,null,this.index,this.currentFileInfo).createEmptySelectors();this.features=new e(b),this.rules=[new d(h,a)],this.rules[0].allowImports=!0};j.prototype=new i,j.prototype.type="Media",j.prototype.isRulesetLike=!0,j.prototype.accept=function(a){this.features&&(this.features=a.visit(this.features)),this.rules&&(this.rules=a.visitArray(this.rules))},j.prototype.genCSS=function(a,b){b.add("@media ",this.currentFileInfo,this.index),this.features.genCSS(a,b),this.outputRuleset(a,b,this.rules)},j.prototype.eval=function(a){a.mediaBlocks||(a.mediaBlocks=[],a.mediaPath=[]);var b=new j(null,[],this.index,this.currentFileInfo);this.debugInfo&&(this.rules[0].debugInfo=this.debugInfo,b.debugInfo=this.debugInfo);var c=!1;a.strictMath||(c=!0,a.strictMath=!0);try{b.features=this.features.eval(a)}finally{c&&(a.strictMath=!1)}return a.mediaPath.push(b),a.mediaBlocks.push(b),this.rules[0].functionRegistry=a.frames[0].functionRegistry.inherit(),a.frames.unshift(this.rules[0]),b.rules=[this.rules[0].eval(a)],a.frames.shift(),a.mediaPath.pop(),0===a.mediaPath.length?b.evalTop(a):b.evalNested(a)},j.prototype.evalTop=function(a){var b=this;if(a.mediaBlocks.length>1){var c=new f([],null,null,this.index,this.currentFileInfo).createEmptySelectors();b=new d(c,a.mediaBlocks),b.multiMedia=!0}return delete a.mediaBlocks,delete a.mediaPath,b},j.prototype.evalNested=function(a){var b,c,f=a.mediaPath.concat([this]);for(b=0;b<f.length;b++)c=f[b].features instanceof e?f[b].features.value:f[b].features,f[b]=Array.isArray(c)?c:[c];return this.features=new e(this.permute(f).map(function(a){for(a=a.map(function(a){return a.toCSS?a:new g(a)}),b=a.length-1;b>0;b--)a.splice(b,0,new g("and"));return new h(a)})),new d([],[])},j.prototype.permute=function(a){if(0===a.length)return[];if(1===a.length)return a[0];for(var b=[],c=this.permute(a.slice(1)),d=0;d<c.length;d++)for(var e=0;e<a[0].length;e++)b.push([a[0][e]].concat(c[d]));return b},j.prototype.bubbleSelectors=function(a){a&&(this.rules=[new d(a.slice(0),[this.rules[0]])])},b.exports=j},{"./anonymous":45,"./directive":56,"./expression":58,"./ruleset":75,"./selector":76,"./value":80}],66:[function(a,b,c){var d=a("./node"),e=a("./selector"),f=a("./mixin-definition"),g=a("../functions/default"),h=function(a,b,c,d,f){this.selector=new e(a),this.arguments=b||[],this.index=c,this.currentFileInfo=d,this.important=f};h.prototype=new d,h.prototype.type="MixinCall",h.prototype.accept=function(a){this.selector&&(this.selector=a.visit(this.selector)),this.arguments.length&&(this.arguments=a.visitArray(this.arguments))},h.prototype.eval=function(a){var b,c,d,e,h,i,j,k,l,m,n,o,p,q,r,s,t=[],u=[],v=!1,w=[],x=[],y=-1,z=0,A=1,B=2;for(j=0;j<this.arguments.length;j++)if(e=this.arguments[j],h=e.value.eval(a),e.expand&&Array.isArray(h.value))for(h=h.value,k=0;k<h.length;k++)t.push({value:h[k]});else t.push({name:e.name,value:h});for(s=function(b){return b.matchArgs(null,a)},j=0;j<a.frames.length;j++)if((b=a.frames[j].find(this.selector,null,s)).length>0){for(n=!0,k=0;k<b.length;k++){for(c=b[k].rule,d=b[k].path,m=!1,l=0;l<a.frames.length;l++)if(!(c instanceof f)&&c===(a.frames[l].originalRuleset||a.frames[l])){m=!0;break}m||c.matchArgs(t,a)&&(o={mixin:c,group:function(b,c){var d,e,f;for(d=0;d<2;d++){for(x[d]=!0,g.value(d),e=0;e<c.length&&x[d];e++)f=c[e],f.matchCondition&&(x[d]=x[d]&&f.matchCondition(null,a));b.matchCondition&&(x[d]=x[d]&&b.matchCondition(t,a))}return x[0]||x[1]?x[0]!=x[1]?x[1]?A:B:z:y}(c,d)},o.group!==y&&w.push(o),v=!0)}for(g.reset(),q=[0,0,0],k=0;k<w.length;k++)q[w[k].group]++;if(q[z]>0)p=B;else if(p=A,q[A]+q[B]>1)throw{type:"Runtime",message:"Ambiguous use of `default()` found when matching for `"+this.format(t)+"`",index:this.index,filename:this.currentFileInfo.filename};for(k=0;k<w.length;k++)if((o=w[k].group)===z||o===p)try{c=w[k].mixin,c instanceof f||(r=c.originalRuleset||c,c=new f("",[],c.rules,null,!1),c.originalRuleset=r),Array.prototype.push.apply(u,c.evalCall(a,t,this.important).rules)}catch(a){throw{message:a.message,index:this.index,filename:this.currentFileInfo.filename,stack:a.stack}}if(v){if(!this.currentFileInfo||!this.currentFileInfo.reference)for(j=0;j<u.length;j++)i=u[j],i.markReferenced&&i.markReferenced();return u}}throw n?{type:"Runtime",message:"No matching definition was found for `"+this.format(t)+"`",index:this.index,filename:this.currentFileInfo.filename}:{type:"Name",message:this.selector.toCSS().trim()+" is undefined",index:this.index,filename:this.currentFileInfo.filename}},h.prototype.format=function(a){return this.selector.toCSS().trim()+"("+(a?a.map(function(a){var b="";return a.name&&(b+=a.name+":"),a.value.toCSS?b+=a.value.toCSS():b+="???",b}).join(", "):"")+")"},b.exports=h},{"../functions/default":19,"./mixin-definition":67,"./node":69,"./selector":76}],67:[function(a,b,c){var d=a("./selector"),e=a("./element"),f=a("./ruleset"),g=a("./rule"),h=a("./expression"),i=a("../contexts"),j=function(a,b,c,f,g,h){this.name=a,this.selectors=[new d([new e(null,a,this.index,this.currentFileInfo)])],this.params=b,this.condition=f,this.variadic=g,this.arity=b.length,this.rules=c,this._lookups={};var i=[];this.required=b.reduce(function(a,b){return!b.name||b.name&&!b.value?a+1:(i.push(b.name),a)},0),this.optionalParameters=i,this.frames=h};j.prototype=new f,j.prototype.type="MixinDefinition",j.prototype.evalFirst=!0,j.prototype.accept=function(a){this.params&&this.params.length&&(this.params=a.visitArray(this.params)),this.rules=a.visitArray(this.rules),this.condition&&(this.condition=a.visit(this.condition))},j.prototype.evalParams=function(a,b,c,d){var e,j,k,l,m,n,o,p,q=new f(null,null),r=this.params.slice(0),s=0;if(b.frames&&b.frames[0]&&b.frames[0].functionRegistry&&(q.functionRegistry=b.frames[0].functionRegistry.inherit()),b=new i.Eval(b,[q].concat(b.frames)),c)for(c=c.slice(0),s=c.length,k=0;k<s;k++)if(j=c[k],n=j&&j.name){for(o=!1,l=0;l<r.length;l++)if(!d[l]&&n===r[l].name){d[l]=j.value.eval(a),q.prependRule(new g(n,j.value.eval(a))),o=!0;break}if(o){c.splice(k,1),k--;continue}throw{type:"Runtime",message:"Named argument for "+this.name+" "+c[k].name+" not found"}}for(p=0,k=0;k<r.length;k++)if(!d[k]){if(j=c&&c[p],n=r[k].name)if(r[k].variadic){for(e=[],l=p;l<s;l++)e.push(c[l].value.eval(a));q.prependRule(new g(n,new h(e).eval(a)))}else{if(m=j&&j.value)m=m.eval(a);else{if(!r[k].value)throw{type:"Runtime",message:"wrong number of arguments for "+this.name+" ("+s+" for "+this.arity+")"};m=r[k].value.eval(b),q.resetCache()}q.prependRule(new g(n,m)),d[k]=m}if(r[k].variadic&&c)for(l=p;l<s;l++)d[l]=c[l].value.eval(a);p++}return q},j.prototype.makeImportant=function(){var a=this.rules?this.rules.map(function(a){return a.makeImportant?a.makeImportant(!0):a
}):this.rules;return new j(this.name,this.params,a,this.condition,this.variadic,this.frames)},j.prototype.eval=function(a){return new j(this.name,this.params,this.rules,this.condition,this.variadic,this.frames||a.frames.slice(0))},j.prototype.evalCall=function(a,b,c){var d,e,j=[],k=this.frames?this.frames.concat(a.frames):a.frames,l=this.evalParams(a,new i.Eval(a,k),b,j);return l.prependRule(new g("@arguments",new h(j).eval(a))),d=this.rules.slice(0),e=new f(null,d),e.originalRuleset=this,e=e.eval(new i.Eval(a,[this,l].concat(k))),c&&(e=e.makeImportant()),e},j.prototype.matchCondition=function(a,b){return!(this.condition&&!this.condition.eval(new i.Eval(b,[this.evalParams(b,new i.Eval(b,this.frames?this.frames.concat(b.frames):b.frames),a,[])].concat(this.frames||[]).concat(b.frames))))},j.prototype.matchArgs=function(a,b){var c,d=a&&a.length||0,e=this.optionalParameters,f=a?a.reduce(function(a,b){return e.indexOf(b.name)<0?a+1:a},0):0;if(this.variadic){if(f<this.required-1)return!1}else{if(f<this.required)return!1;if(d>this.params.length)return!1}c=Math.min(f,this.arity);for(var g=0;g<c;g++)if(!this.params[g].name&&!this.params[g].variadic&&a[g].value.eval(b).toCSS()!=this.params[g].value.eval(b).toCSS())return!1;return!0},b.exports=j},{"../contexts":10,"./element":57,"./expression":58,"./rule":73,"./ruleset":75,"./selector":76}],68:[function(a,b,c){var d=a("./node"),e=a("./operation"),f=a("./dimension"),g=function(a){this.value=a};g.prototype=new d,g.prototype.type="Negative",g.prototype.genCSS=function(a,b){b.add("-"),this.value.genCSS(a,b)},g.prototype.eval=function(a){return a.isMathOn()?new e("*",[new f(-1),this.value]).eval(a):new g(this.value.eval(a))},b.exports=g},{"./dimension":55,"./node":69,"./operation":70}],69:[function(a,b,c){var d=function(){};d.prototype.toCSS=function(a){var b=[];return this.genCSS(a,{add:function(a,c,d){b.push(a)},isEmpty:function(){return 0===b.length}}),b.join("")},d.prototype.genCSS=function(a,b){b.add(this.value)},d.prototype.accept=function(a){this.value=a.visit(this.value)},d.prototype.eval=function(){return this},d.prototype._operate=function(a,b,c,d){switch(b){case"+":return c+d;case"-":return c-d;case"*":return c*d;case"/":return c/d}},d.prototype.fround=function(a,b){var c=a&&a.numPrecision;return null==c?b:Number((b+2e-16).toFixed(c))},d.compare=function(a,b){if(a.compare&&"Quoted"!==b.type&&"Anonymous"!==b.type)return a.compare(b);if(b.compare)return-b.compare(a);if(a.type===b.type){if(a=a.value,b=b.value,!Array.isArray(a))return a===b?0:void 0;if(a.length===b.length){for(var c=0;c<a.length;c++)if(0!==d.compare(a[c],b[c]))return;return 0}}},d.numericCompare=function(a,b){return a<b?-1:a===b?0:a>b?1:void 0},b.exports=d},{}],70:[function(a,b,c){var d=a("./node"),e=a("./color"),f=a("./dimension"),g=function(a,b,c){this.op=a.trim(),this.operands=b,this.isSpaced=c};g.prototype=new d,g.prototype.type="Operation",g.prototype.accept=function(a){this.operands=a.visit(this.operands)},g.prototype.eval=function(a){var b=this.operands[0].eval(a),c=this.operands[1].eval(a);if(a.isMathOn()){if(b instanceof f&&c instanceof e&&(b=b.toColor()),c instanceof f&&b instanceof e&&(c=c.toColor()),!b.operate)throw{type:"Operation",message:"Operation on an invalid type"};return b.operate(a,this.op,c)}return new g(this.op,[b,c],this.isSpaced)},g.prototype.genCSS=function(a,b){this.operands[0].genCSS(a,b),this.isSpaced&&b.add(" "),b.add(this.op),this.isSpaced&&b.add(" "),this.operands[1].genCSS(a,b)},b.exports=g},{"./color":49,"./dimension":55,"./node":69}],71:[function(a,b,c){var d=a("./node"),e=function(a){this.value=a};e.prototype=new d,e.prototype.type="Paren",e.prototype.genCSS=function(a,b){b.add("("),this.value.genCSS(a,b),b.add(")")},e.prototype.eval=function(a){return new e(this.value.eval(a))},b.exports=e},{"./node":69}],72:[function(a,b,c){var d=a("./node"),e=a("./js-eval-node"),f=a("./variable"),g=function(a,b,c,d,e){this.escaped=null==c||c,this.value=b||"",this.quote=a.charAt(0),this.index=d,this.currentFileInfo=e};g.prototype=new e,g.prototype.type="Quoted",g.prototype.genCSS=function(a,b){this.escaped||b.add(this.quote,this.currentFileInfo,this.index),b.add(this.value),this.escaped||b.add(this.quote)},g.prototype.containsVariables=function(){return this.value.match(/(`([^`]+)`)|@\{([\w-]+)\}/)},g.prototype.eval=function(a){function b(a,b,c){var d=a;do{a=d,d=a.replace(b,c)}while(a!==d);return d}var c=this,d=this.value,e=function(b,d){return String(c.evaluateJavaScript(d,a))},h=function(b,d){var e=new f("@"+d,c.index,c.currentFileInfo).eval(a,!0);return e instanceof g?e.value:e.toCSS()};return d=b(d,/`([^`]+)`/g,e),d=b(d,/@\{([\w-]+)\}/g,h),new g(this.quote+d+this.quote,d,this.escaped,this.index,this.currentFileInfo)},g.prototype.compare=function(a){return"Quoted"!==a.type||this.escaped||a.escaped?a.toCSS&&this.toCSS()===a.toCSS()?0:void 0:d.numericCompare(this.value,a.value)},b.exports=g},{"./js-eval-node":63,"./node":69,"./variable":81}],73:[function(a,b,c){function d(a,b){var c,d="",e=b.length,f={add:function(a){d+=a}};for(c=0;c<e;c++)b[c].eval(a).genCSS(a,f);return d}var e=a("./node"),f=a("./value"),g=a("./keyword"),h=function(a,b,c,d,g,h,i,j){this.name=a,this.value=b instanceof e?b:new f([b]),this.important=c?" "+c.trim():"",this.merge=d,this.index=g,this.currentFileInfo=h,this.inline=i||!1,this.variable=void 0!==j?j:a.charAt&&"@"===a.charAt(0)};h.prototype=new e,h.prototype.type="Rule",h.prototype.genCSS=function(a,b){b.add(this.name+(a.compress?":":": "),this.currentFileInfo,this.index);try{this.value.genCSS(a,b)}catch(a){throw a.index=this.index,a.filename=this.currentFileInfo.filename,a}b.add(this.important+(this.inline||a.lastRule&&a.compress?"":";"),this.currentFileInfo,this.index)},h.prototype.eval=function(a){var b,c=!1,e=this.name,f=this.variable;"string"!=typeof e&&(e=1===e.length&&e[0]instanceof g?e[0].value:d(a,e),f=!1),"font"!==e||a.strictMath||(c=!0,a.strictMath=!0);try{if(a.importantScope.push({}),b=this.value.eval(a),!this.variable&&"DetachedRuleset"===b.type)throw{message:"Rulesets cannot be evaluated on a property.",index:this.index,filename:this.currentFileInfo.filename};var i=this.important,j=a.importantScope.pop();return!i&&j.important&&(i=j.important),new h(e,b,i,this.merge,this.index,this.currentFileInfo,this.inline,f)}catch(a){throw"number"!=typeof a.index&&(a.index=this.index,a.filename=this.currentFileInfo.filename),a}finally{c&&(a.strictMath=!1)}},h.prototype.makeImportant=function(){return new h(this.name,this.value,"!important",this.merge,this.index,this.currentFileInfo,this.inline)};var i=function(a){Array.isArray(a)?a.forEach(function(a){i(a)}):a.markReferenced&&a.markReferenced()};h.prototype.markReferenced=function(){this.value&&i(this.value)},b.exports=h},{"./keyword":64,"./node":69,"./value":80}],74:[function(a,b,c){var d=a("./node"),e=a("./variable"),f=function(a){this.variable=a};f.prototype=new d,f.prototype.type="RulesetCall",f.prototype.eval=function(a){return new e(this.variable).eval(a).callEval(a)},b.exports=f},{"./node":69,"./variable":81}],75:[function(a,b,c){var d=a("./node"),e=a("./rule"),f=a("./selector"),g=a("./element"),h=a("./paren"),i=a("../contexts"),j=a("../functions/function-registry"),k=a("../functions/default"),l=a("./debug-info"),m=function(a,b,c){this.selectors=a,this.rules=b,this._lookups={},this.strictImports=c};m.prototype=new d,m.prototype.type="Ruleset",m.prototype.isRuleset=!0,m.prototype.isRulesetLike=!0,m.prototype.accept=function(a){this.paths?a.visitArray(this.paths,!0):this.selectors&&(this.selectors=a.visitArray(this.selectors)),this.rules&&this.rules.length&&(this.rules=a.visitArray(this.rules))},m.prototype.eval=function(a){var b,c,d,f,g=this.selectors,h=!1;if(g&&(c=g.length)){for(b=[],k.error({type:"Syntax",message:"it is currently only allowed in parametric mixin guards,"}),f=0;f<c;f++)d=g[f].eval(a),b.push(d),d.evaldCondition&&(h=!0);k.reset()}else h=!0;var i,l,n=this.rules?this.rules.slice(0):null,o=new m(b,n,this.strictImports);o.originalRuleset=this,o.root=this.root,o.firstRoot=this.firstRoot,o.allowImports=this.allowImports,this.debugInfo&&(o.debugInfo=this.debugInfo),h||(n.length=0),o.functionRegistry=function(a){for(var b,c=0,d=a.length;c!==d;++c)if(b=a[c].functionRegistry)return b;return j}(a.frames).inherit();var p=a.frames;p.unshift(o);var q=a.selectors;q||(a.selectors=q=[]),q.unshift(this.selectors),(o.root||o.allowImports||!o.strictImports)&&o.evalImports(a);var r=o.rules,s=r?r.length:0;for(f=0;f<s;f++)r[f].evalFirst&&(r[f]=r[f].eval(a));var t=a.mediaBlocks&&a.mediaBlocks.length||0;for(f=0;f<s;f++)"MixinCall"===r[f].type?(n=r[f].eval(a).filter(function(a){return!(a instanceof e&&a.variable)||!o.variable(a.name)}),r.splice.apply(r,[f,1].concat(n)),s+=n.length-1,f+=n.length-1,o.resetCache()):"RulesetCall"===r[f].type&&(n=r[f].eval(a).rules.filter(function(a){return!(a instanceof e&&a.variable)}),r.splice.apply(r,[f,1].concat(n)),s+=n.length-1,f+=n.length-1,o.resetCache());for(f=0;f<r.length;f++)i=r[f],i.evalFirst||(r[f]=i=i.eval?i.eval(a):i);for(f=0;f<r.length;f++)if((i=r[f])instanceof m&&i.selectors&&1===i.selectors.length&&i.selectors[0].isJustParentSelector()){r.splice(f--,1);for(var u=0;u<i.rules.length;u++)(l=i.rules[u])instanceof e&&l.variable||r.splice(++f,0,l)}if(p.shift(),q.shift(),a.mediaBlocks)for(f=t;f<a.mediaBlocks.length;f++)a.mediaBlocks[f].bubbleSelectors(b);return o},m.prototype.evalImports=function(a){var b,c,d=this.rules;if(d)for(b=0;b<d.length;b++)"Import"===d[b].type&&(c=d[b].eval(a),c&&c.length?(d.splice.apply(d,[b,1].concat(c)),b+=c.length-1):d.splice(b,1,c),this.resetCache())},m.prototype.makeImportant=function(){return new m(this.selectors,this.rules.map(function(a){return a.makeImportant?a.makeImportant():a}),this.strictImports)},m.prototype.matchArgs=function(a){return!a||0===a.length},m.prototype.matchCondition=function(a,b){var c=this.selectors[this.selectors.length-1];return!!c.evaldCondition&&!(c.condition&&!c.condition.eval(new i.Eval(b,b.frames)))},m.prototype.resetCache=function(){this._rulesets=null,this._variables=null,this._lookups={}},m.prototype.variables=function(){return this._variables||(this._variables=this.rules?this.rules.reduce(function(a,b){if(b instanceof e&&b.variable===!0&&(a[b.name]=b),"Import"===b.type&&b.root&&b.root.variables){var c=b.root.variables();for(var d in c)c.hasOwnProperty(d)&&(a[d]=c[d])}return a},{}):{}),this._variables},m.prototype.variable=function(a){return this.variables()[a]},m.prototype.rulesets=function(){if(!this.rules)return[];var a,b,c=[],d=this.rules,e=d.length;for(a=0;a<e;a++)b=d[a],b.isRuleset&&c.push(b);return c},m.prototype.prependRule=function(a){var b=this.rules;b?b.unshift(a):this.rules=[a]},m.prototype.find=function(a,b,c){b=b||this;var d,e,g=[],h=a.toCSS();return h in this._lookups?this._lookups[h]:(this.rulesets().forEach(function(h){if(h!==b)for(var i=0;i<h.selectors.length;i++)if(d=a.match(h.selectors[i])){if(a.elements.length>d){if(!c||c(h)){e=h.find(new f(a.elements.slice(d)),b,c);for(var j=0;j<e.length;++j)e[j].path.push(h);Array.prototype.push.apply(g,e)}}else g.push({rule:h,path:[]});break}}),this._lookups[h]=g,g)},m.prototype.genCSS=function(a,b){var c,d,e,f,g,h=[],i=[];a.tabLevel=a.tabLevel||0,this.root||a.tabLevel++;var j,k=a.compress?"":Array(a.tabLevel+1).join("  "),m=a.compress?"":Array(a.tabLevel).join("  "),n=0,o=0;for(c=0;c<this.rules.length;c++)f=this.rules[c],"Comment"===f.type?(o===c&&o++,i.push(f)):f.isCharset&&f.isCharset()?(i.splice(n,0,f),n++,o++):"Import"===f.type?(i.splice(o,0,f),o++):i.push(f);if(i=h.concat(i),!this.root){e=l(a,this,m),e&&(b.add(e),b.add(m));var p,q=this.paths,r=q.length;for(j=a.compress?",":",\n"+m,c=0;c<r;c++)if(g=q[c],p=g.length)for(c>0&&b.add(j),a.firstSelector=!0,g[0].genCSS(a,b),a.firstSelector=!1,d=1;d<p;d++)g[d].genCSS(a,b);b.add((a.compress?"{":" {\n")+k)}for(c=0;c<i.length;c++){f=i[c],c+1===i.length&&(a.lastRule=!0);var s=a.lastRule;(function(a){return"boolean"==typeof a.isRulesetLike?a.isRulesetLike:"function"==typeof a.isRulesetLike&&a.isRulesetLike()})(f)&&(a.lastRule=!1),f.genCSS?f.genCSS(a,b):f.value&&b.add(f.value.toString()),a.lastRule=s,a.lastRule?a.lastRule=!1:b.add(a.compress?"":"\n"+k)}this.root||(b.add(a.compress?"}":"\n"+m+"}"),a.tabLevel--),b.isEmpty()||a.compress||!this.firstRoot||b.add("\n")},m.prototype.markReferenced=function(){var a;if(this.selectors)for(a=0;a<this.selectors.length;a++)this.selectors[a].markReferenced();if(this.rules)for(a=0;a<this.rules.length;a++)this.rules[a].markReferenced&&this.rules[a].markReferenced()},m.prototype.getIsReferenced=function(){var a,b,c,d;if(this.paths)for(a=0;a<this.paths.length;a++)for(c=this.paths[a],b=0;b<c.length;b++)if(c[b].getIsReferenced&&c[b].getIsReferenced())return!0;if(this.selectors)for(a=0;a<this.selectors.length;a++)if(d=this.selectors[a],d.getIsReferenced&&d.getIsReferenced())return!0;return!1},m.prototype.joinSelectors=function(a,b,c){for(var d=0;d<c.length;d++)this.joinSelector(a,b,c[d])},m.prototype.joinSelector=function(a,b,c){function d(a,b){var c,d;if(0===a.length)c=new h(a[0]);else{var e=[];for(d=0;d<a.length;d++)e.push(new g(null,a[d],b.index,b.currentFileInfo));c=new h(new f(e))}return c}function e(a,b){var c;return c=new g(null,a,b.index,b.currentFileInfo),new f([c])}function i(a,b,c){var f,h,m,n,o,p,q,r,s,t,u=!1;for(n=[],o=[[]],f=0;f<c.elements.length;f++)if(r=c.elements[f],"&"!==r.value){var v=function(a){var b;return"Paren"!==a.value.type?null:(b=a.value.value,"Selector"!==b.type?null:b)}(r);if(null!=v){l(n,o);var w,x=[],y=[];for(w=i(x,b,v),u=u||w,m=0;m<x.length;m++){var z=e(d(x[m],r),r);k(o,[z],r,c,y)}o=y,n=[]}else n.push(r)}else{for(u=!0,p=[],l(n,o),h=0;h<o.length;h++)if(q=o[h],0===b.length)q.length>0&&q[0].elements.push(new g(r.combinator,"",r.index,r.currentFileInfo)),p.push(q);else for(m=0;m<b.length;m++){var A=j(q,b[m],r,c);p.push(A)}o=p,n=[]}for(l(n,o),f=0;f<o.length;f++)(s=o[f].length)>0&&(a.push(o[f]),t=o[f][s-1],o[f][s-1]=t.createDerived(t.elements,c.extendList));return u}function j(a,b,c,d){var e,f,h;if(e=[],a.length>0?(e=a.slice(0),f=e.pop(),h=d.createDerived(f.elements.slice(0))):h=d.createDerived([]),b.length>0){var i=c.combinator,j=b[0].elements[0];i.emptyOrWhitespace&&!j.combinator.emptyOrWhitespace&&(i=j.combinator),h.elements.push(new g(i,j.value,c.index,c.currentFileInfo)),h.elements=h.elements.concat(b[0].elements.slice(1))}return 0!==h.elements.length&&e.push(h),b.length>1&&(e=e.concat(b.slice(1))),e}function k(a,b,c,d,e){var f;for(f=0;f<a.length;f++){var g=j(a[f],b,c,d);e.push(g)}return e}function l(a,b){var c,d;if(0!==a.length){if(0===b.length)return void b.push([new f(a)]);for(c=0;c<b.length;c++)d=b[c],d.length>0?d[d.length-1]=d[d.length-1].createDerived(d[d.length-1].elements.concat(a)):d.push(new f(a))}}var m,n;if(n=[],!i(n,b,c))if(b.length>0)for(n=[],m=0;m<b.length;m++)n.push(b[m].concat(c));else n=[[c]];for(m=0;m<n.length;m++)a.push(n[m])},b.exports=m},{"../contexts":10,"../functions/default":19,"../functions/function-registry":21,"./debug-info":53,"./element":57,"./node":69,"./paren":71,"./rule":73,"./selector":76}],76:[function(a,b,c){var d=a("./node"),e=a("./element"),f=function(a,b,c,d,e,f){this.elements=a,this.extendList=b,this.condition=c,this.currentFileInfo=e||{},this.isReferenced=f,c||(this.evaldCondition=!0)};f.prototype=new d,f.prototype.type="Selector",f.prototype.accept=function(a){this.elements&&(this.elements=a.visitArray(this.elements)),this.extendList&&(this.extendList=a.visitArray(this.extendList)),this.condition&&(this.condition=a.visit(this.condition))},f.prototype.createDerived=function(a,b,c){c=null!=c?c:this.evaldCondition;var d=new f(a,b||this.extendList,null,this.index,this.currentFileInfo,this.isReferenced);return d.evaldCondition=c,d.mediaEmpty=this.mediaEmpty,d},f.prototype.createEmptySelectors=function(){var a=new e("","&",this.index,this.currentFileInfo),b=[new f([a],null,null,this.index,this.currentFileInfo)];return b[0].mediaEmpty=!0,b},f.prototype.match=function(a){var b,c,d=this.elements,e=d.length;if(a.CacheElements(),0===(b=a._elements.length)||e<b)return 0;for(c=0;c<b;c++)if(d[c].value!==a._elements[c])return 0;return b},f.prototype.CacheElements=function(){if(!this._elements){var a=this.elements.map(function(a){return a.combinator.value+(a.value.value||a.value)}).join("").match(/[,&#\*\.\w-]([\w-]|(\\.))*/g);a?"&"===a[0]&&a.shift():a=[],this._elements=a}},f.prototype.isJustParentSelector=function(){return!this.mediaEmpty&&1===this.elements.length&&"&"===this.elements[0].value&&(" "===this.elements[0].combinator.value||""===this.elements[0].combinator.value)},f.prototype.eval=function(a){var b=this.condition&&this.condition.eval(a),c=this.elements,d=this.extendList;return c=c&&c.map(function(b){return b.eval(a)}),d=d&&d.map(function(b){return b.eval(a)}),this.createDerived(c,d,b)},f.prototype.genCSS=function(a,b){var c,d;if(a&&a.firstSelector||""!==this.elements[0].combinator.value||b.add(" ",this.currentFileInfo,this.index),!this._css)for(c=0;c<this.elements.length;c++)d=this.elements[c],d.genCSS(a,b)},f.prototype.markReferenced=function(){this.isReferenced=!0},f.prototype.getIsReferenced=function(){return!this.currentFileInfo.reference||this.isReferenced},f.prototype.getIsOutput=function(){return this.evaldCondition},b.exports=f},{"./element":57,"./node":69}],77:[function(a,b,c){var d=a("./node"),e=function(a){this.value=a};e.prototype=new d,e.prototype.type="UnicodeDescriptor",b.exports=e},{"./node":69}],78:[function(a,b,c){var d=a("./node"),e=a("../data/unit-conversions"),f=function(a,b,c){this.numerator=a?a.slice(0).sort():[],this.denominator=b?b.slice(0).sort():[],c?this.backupUnit=c:a&&a.length&&(this.backupUnit=a[0])};f.prototype=new d,f.prototype.type="Unit",f.prototype.clone=function(){return new f(this.numerator.slice(0),this.denominator.slice(0),this.backupUnit)},f.prototype.genCSS=function(a,b){var c=a&&a.strictUnits;1===this.numerator.length?b.add(this.numerator[0]):!c&&this.backupUnit?b.add(this.backupUnit):!c&&this.denominator.length&&b.add(this.denominator[0])},f.prototype.toString=function(){var a,b=this.numerator.join("*");for(a=0;a<this.denominator.length;a++)b+="/"+this.denominator[a];return b},f.prototype.compare=function(a){return this.is(a.toString())?0:void 0},f.prototype.is=function(a){return this.toString().toUpperCase()===a.toUpperCase()},f.prototype.isLength=function(){return Boolean(this.toCSS().match(/px|em|%|in|cm|mm|pc|pt|ex/))},f.prototype.isEmpty=function(){return 0===this.numerator.length&&0===this.denominator.length},f.prototype.isSingular=function(){return this.numerator.length<=1&&0===this.denominator.length},f.prototype.map=function(a){var b;for(b=0;b<this.numerator.length;b++)this.numerator[b]=a(this.numerator[b],!1);for(b=0;b<this.denominator.length;b++)this.denominator[b]=a(this.denominator[b],!0)},f.prototype.usedUnits=function(){var a,b,c={};b=function(b){return a.hasOwnProperty(b)&&!c[d]&&(c[d]=b),b};for(var d in e)e.hasOwnProperty(d)&&(a=e[d],this.map(b));return c},f.prototype.cancel=function(){var a,b,c={};for(b=0;b<this.numerator.length;b++)a=this.numerator[b],c[a]=(c[a]||0)+1;for(b=0;b<this.denominator.length;b++)a=this.denominator[b],c[a]=(c[a]||0)-1;this.numerator=[],this.denominator=[];for(a in c)if(c.hasOwnProperty(a)){var d=c[a];if(d>0)for(b=0;b<d;b++)this.numerator.push(a);else if(d<0)for(b=0;b<-d;b++)this.denominator.push(a)}this.numerator.sort(),this.denominator.sort()},b.exports=f},{"../data/unit-conversions":13,"./node":69}],79:[function(a,b,c){var d=a("./node"),e=function(a,b,c,d){this.value=a,this.currentFileInfo=c,this.index=b,this.isEvald=d};e.prototype=new d,e.prototype.type="Url",e.prototype.accept=function(a){this.value=a.visit(this.value)},e.prototype.genCSS=function(a,b){b.add("url("),this.value.genCSS(a,b),b.add(")")},e.prototype.eval=function(a){var b,c=this.value.eval(a);if(!this.isEvald&&(b=this.currentFileInfo&&this.currentFileInfo.rootpath,b&&"string"==typeof c.value&&a.isPathRelative(c.value)&&(c.quote||(b=b.replace(/[\(\)'"\s]/g,function(a){return"\\"+a})),c.value=b+c.value),c.value=a.normalizePath(c.value),a.urlArgs&&!c.value.match(/^\s*data:/))){var d=c.value.indexOf("?")===-1?"?":"&",f=d+a.urlArgs;c.value.indexOf("#")!==-1?c.value=c.value.replace("#",f+"#"):c.value+=f}return new e(c,this.index,this.currentFileInfo,!0)},b.exports=e},{"./node":69}],80:[function(a,b,c){var d=a("./node"),e=function(a){if(this.value=a,!a)throw new Error("Value requires an array argument")};e.prototype=new d,e.prototype.type="Value",e.prototype.accept=function(a){this.value&&(this.value=a.visitArray(this.value))},e.prototype.eval=function(a){return 1===this.value.length?this.value[0].eval(a):new e(this.value.map(function(b){return b.eval(a)}))},e.prototype.genCSS=function(a,b){var c;for(c=0;c<this.value.length;c++)this.value[c].genCSS(a,b),c+1<this.value.length&&b.add(a&&a.compress?",":", ")},b.exports=e},{"./node":69}],81:[function(a,b,c){var d=a("./node"),e=function(a,b,c){this.name=a,this.index=b,this.currentFileInfo=c||{}};e.prototype=new d,e.prototype.type="Variable",e.prototype.eval=function(a){var b,c=this.name;if(0===c.indexOf("@@")&&(c="@"+new e(c.slice(1),this.index,this.currentFileInfo).eval(a).value),this.evaluating)throw{type:"Name",message:"Recursive variable definition for "+c,filename:this.currentFileInfo.filename,index:this.index};if(this.evaluating=!0,b=this.find(a.frames,function(b){var d=b.variable(c);if(d){if(d.important){a.importantScope[a.importantScope.length-1].important=d.important}return d.value.eval(a)}}))return this.evaluating=!1,b;throw{type:"Name",message:"variable "+c+" is undefined",filename:this.currentFileInfo.filename,index:this.index}},e.prototype.find=function(a,b){for(var c,d=0;d<a.length;d++)if(c=b.call(a,a[d]))return c;return null},b.exports=e},{"./node":69}],82:[function(a,b,c){b.exports={getLocation:function(a,b){for(var c=a+1,d=null,e=-1;--c>=0&&"\n"!==b.charAt(c);)e++;return"number"==typeof a&&(d=(b.slice(0,a).match(/\n/g)||"").length),{line:d,column:e}}}},{}],83:[function(a,b,c){var d=a("../tree"),e=a("./visitor"),f=a("../logger"),g=function(){this._visitor=new e(this),this.contexts=[],this.allExtendsStack=[[]]};g.prototype={run:function(a){return a=this._visitor.visit(a),a.allExtends=this.allExtendsStack[0],a},visitRule:function(a,b){b.visitDeeper=!1},visitMixinDefinition:function(a,b){b.visitDeeper=!1},visitRuleset:function(a,b){if(!a.root){var c,e,f,g,h=[],i=a.rules,j=i?i.length:0;for(c=0;c<j;c++)a.rules[c]instanceof d.Extend&&(h.push(i[c]),a.extendOnEveryPath=!0);var k=a.paths;for(c=0;c<k.length;c++){var l=k[c],m=l[l.length-1],n=m.extendList;for(g=n?n.slice(0).concat(h):h,g&&(g=g.map(function(a){return a.clone()})),e=0;e<g.length;e++)this.foundExtends=!0,f=g[e],f.findSelfSelectors(l),f.ruleset=a,0===e&&(f.firstExtendOnThisSelectorPath=!0),this.allExtendsStack[this.allExtendsStack.length-1].push(f)}this.contexts.push(a.selectors)}},visitRulesetOut:function(a){a.root||(this.contexts.length=this.contexts.length-1)},visitMedia:function(a,b){a.allExtends=[],this.allExtendsStack.push(a.allExtends)},visitMediaOut:function(a){this.allExtendsStack.length=this.allExtendsStack.length-1},visitDirective:function(a,b){a.allExtends=[],this.allExtendsStack.push(a.allExtends)},visitDirectiveOut:function(a){this.allExtendsStack.length=this.allExtendsStack.length-1}};var h=function(){this._visitor=new e(this)};h.prototype={run:function(a){var b=new g;if(this.extendIndicies={},b.run(a),!b.foundExtends)return a;a.allExtends=a.allExtends.concat(this.doExtendChaining(a.allExtends,a.allExtends)),this.allExtendsStack=[a.allExtends];var c=this._visitor.visit(a);return this.checkExtendsForNonMatched(a.allExtends),c},checkExtendsForNonMatched:function(a){var b=this.extendIndicies;a.filter(function(a){return!a.hasFoundMatches&&1==a.parent_ids.length}).forEach(function(a){var c="_unknown_";try{c=a.selector.toCSS({})}catch(a){}b[a.index+" "+c]||(b[a.index+" "+c]=!0,f.warn("extend '"+c+"' has no matches"))})},doExtendChaining:function(a,b,c){var e,f,g,h,i,j,k,l,m=[],n=this;for(c=c||0,e=0;e<a.length;e++)for(f=0;f<b.length;f++)j=a[e],k=b[f],j.parent_ids.indexOf(k.object_id)>=0||(i=[k.selfSelectors[0]],g=n.findMatch(j,i),g.length&&(j.hasFoundMatches=!0,j.selfSelectors.forEach(function(a){h=n.extendSelector(g,i,a),l=new d.Extend(k.selector,k.option,0),l.selfSelectors=h,h[h.length-1].extendList=[l],m.push(l),l.ruleset=k.ruleset,l.parent_ids=l.parent_ids.concat(k.parent_ids,j.parent_ids),k.firstExtendOnThisSelectorPath&&(l.firstExtendOnThisSelectorPath=!0,k.ruleset.paths.push(h))})));if(m.length){if(this.extendChainCount++,c>100){var o="{unable to calculate}",p="{unable to calculate}";try{o=m[0].selfSelectors[0].toCSS(),p=m[0].selector.toCSS()}catch(a){}throw{message:"extend circular reference detected. One of the circular extends is currently:"+o+":extend("+p+")"}}return m.concat(n.doExtendChaining(m,b,c+1))}return m},visitRule:function(a,b){b.visitDeeper=!1},visitMixinDefinition:function(a,b){b.visitDeeper=!1},visitSelector:function(a,b){b.visitDeeper=!1},visitRuleset:function(a,b){if(!a.root){var c,d,e,f,g=this.allExtendsStack[this.allExtendsStack.length-1],h=[],i=this;for(e=0;e<g.length;e++)for(d=0;d<a.paths.length;d++)if(f=a.paths[d],!a.extendOnEveryPath){var j=f[f.length-1].extendList;j&&j.length||(c=this.findMatch(g[e],f),c.length&&(g[e].hasFoundMatches=!0,g[e].selfSelectors.forEach(function(a){h.push(i.extendSelector(c,f,a))})))}a.paths=a.paths.concat(h)}},findMatch:function(a,b){var c,d,e,f,g,h,i,j=this,k=a.selector.elements,l=[],m=[];for(c=0;c<b.length;c++)for(d=b[c],e=0;e<d.elements.length;e++)for(f=d.elements[e],(a.allowBefore||0===c&&0===e)&&l.push({pathIndex:c,index:e,matched:0,initialCombinator:f.combinator}),h=0;h<l.length;h++)i=l[h],g=f.combinator.value,""===g&&0===e&&(g=" "),!j.isElementValuesEqual(k[i.matched].value,f.value)||i.matched>0&&k[i.matched].combinator.value!==g?i=null:i.matched++,i&&(i.finished=i.matched===k.length,i.finished&&!a.allowAfter&&(e+1<d.elements.length||c+1<b.length)&&(i=null)),i?i.finished&&(i.length=k.length,i.endPathIndex=c,i.endPathElementIndex=e+1,l.length=0,m.push(i)):(l.splice(h,1),h--);return m},isElementValuesEqual:function(a,b){if("string"==typeof a||"string"==typeof b)return a===b;if(a instanceof d.Attribute)return a.op===b.op&&a.key===b.key&&(a.value&&b.value?(a=a.value.value||a.value,b=b.value.value||b.value,a===b):!a.value&&!b.value);if(a=a.value,b=b.value,a instanceof d.Selector){if(!(b instanceof d.Selector)||a.elements.length!==b.elements.length)return!1;for(var c=0;c<a.elements.length;c++){if(a.elements[c].combinator.value!==b.elements[c].combinator.value&&(0!==c||(a.elements[c].combinator.value||" ")!==(b.elements[c].combinator.value||" ")))return!1;if(!this.isElementValuesEqual(a.elements[c].value,b.elements[c].value))return!1}return!0}return!1},extendSelector:function(a,b,c){var e,f,g,h,i,j=0,k=0,l=[];for(e=0;e<a.length;e++)h=a[e],f=b[h.pathIndex],g=new d.Element(h.initialCombinator,c.elements[0].value,c.elements[0].index,c.elements[0].currentFileInfo),h.pathIndex>j&&k>0&&(l[l.length-1].elements=l[l.length-1].elements.concat(b[j].elements.slice(k)),k=0,j++),i=f.elements.slice(k,h.index).concat([g]).concat(c.elements.slice(1)),j===h.pathIndex&&e>0?l[l.length-1].elements=l[l.length-1].elements.concat(i):(l=l.concat(b.slice(j,h.pathIndex)),l.push(new d.Selector(i))),j=h.endPathIndex,(k=h.endPathElementIndex)>=b[j].elements.length&&(k=0,j++);return j<b.length&&k>0&&(l[l.length-1].elements=l[l.length-1].elements.concat(b[j].elements.slice(k)),j++),l=l.concat(b.slice(j,b.length))},visitRulesetOut:function(a){},visitMedia:function(a,b){var c=a.allExtends.concat(this.allExtendsStack[this.allExtendsStack.length-1]);c=c.concat(this.doExtendChaining(c,a.allExtends)),this.allExtendsStack.push(c)},visitMediaOut:function(a){var b=this.allExtendsStack.length-1;this.allExtendsStack.length=b},visitDirective:function(a,b){var c=a.allExtends.concat(this.allExtendsStack[this.allExtendsStack.length-1]);c=c.concat(this.doExtendChaining(c,a.allExtends)),this.allExtendsStack.push(c)},visitDirectiveOut:function(a){var b=this.allExtendsStack.length-1;this.allExtendsStack.length=b}},b.exports=h},{"../logger":32,"../tree":61,"./visitor":89}],84:[function(a,b,c){function d(a){this.imports=[],this.variableImports=[],this._onSequencerEmpty=a,this._currentDepth=0}d.prototype.addImport=function(a){var b=this,c={callback:a,args:null,isReady:!1};return this.imports.push(c),function(){c.args=Array.prototype.slice.call(arguments,0),c.isReady=!0,b.tryRun()}},d.prototype.addVariableImport=function(a){this.variableImports.push(a)},d.prototype.tryRun=function(){this._currentDepth++;try{for(;;){for(;this.imports.length>0;){var a=this.imports[0];if(!a.isReady)return;this.imports=this.imports.slice(1),a.callback.apply(null,a.args)}if(0===this.variableImports.length)break;var b=this.variableImports[0];this.variableImports=this.variableImports.slice(1),b()}}finally{this._currentDepth--}0===this._currentDepth&&this._onSequencerEmpty&&this._onSequencerEmpty()},b.exports=d},{}],85:[function(a,b,c){var d=a("../contexts"),e=a("./visitor"),f=a("./import-sequencer"),g=function(a,b){this._visitor=new e(this),this._importer=a,this._finish=b,this.context=new d.Eval,this.importCount=0,this.onceFileDetectionMap={},this.recursionDetector={},this._sequencer=new f(this._onSequencerEmpty.bind(this))};g.prototype={isReplacing:!1,run:function(a){try{this._visitor.visit(a)}catch(a){this.error=a}this.isFinished=!0,this._sequencer.tryRun()},_onSequencerEmpty:function(){this.isFinished&&this._finish(this.error)},visitImport:function(a,b){var c=a.options.inline;if(!a.css||c){var e=new d.Eval(this.context,this.context.frames.slice(0)),f=e.frames[0];this.importCount++,a.isVariableImport()?this._sequencer.addVariableImport(this.processImportNode.bind(this,a,e,f)):this.processImportNode(a,e,f)}b.visitDeeper=!1},processImportNode:function(a,b,c){var d,e=a.options.inline;try{d=a.evalForImport(b)}catch(b){b.filename||(b.index=a.index,b.filename=a.currentFileInfo.filename),a.css=!0,a.error=b}if(!d||d.css&&!e)this.importCount--,this.isFinished&&this._sequencer.tryRun();else{d.options.multiple&&(b.importMultiple=!0);for(var f=void 0===d.css,g=0;g<c.rules.length;g++)if(c.rules[g]===a){c.rules[g]=d;break}var h=this.onImported.bind(this,d,b),i=this._sequencer.addImport(h);this._importer.push(d.getPath(),f,d.currentFileInfo,d.options,i)}},onImported:function(a,b,c,d,e,f){c&&(c.filename||(c.index=a.index,c.filename=a.currentFileInfo.filename),this.error=c);var g=this,h=a.options.inline,i=a.options.plugin,j=a.options.optional,k=e||f in g.recursionDetector;if(b.importMultiple||(a.skip=!!k||function(){return f in g.onceFileDetectionMap||(g.onceFileDetectionMap[f]=!0,!1)}),!f&&j&&(a.skip=!0),d&&(a.root=d,a.importedFilename=f,!h&&!i&&(b.importMultiple||!k))){g.recursionDetector[f]=!0;var l=this.context;this.context=b;try{this._visitor.visit(d)}catch(c){this.error=c}this.context=l}g.importCount--,g.isFinished&&g._sequencer.tryRun()},visitRule:function(a,b){"DetachedRuleset"===a.value.type?this.context.frames.unshift(a):b.visitDeeper=!1},visitRuleOut:function(a){"DetachedRuleset"===a.value.type&&this.context.frames.shift()},visitDirective:function(a,b){this.context.frames.unshift(a)},visitDirectiveOut:function(a){this.context.frames.shift()},visitMixinDefinition:function(a,b){this.context.frames.unshift(a)},visitMixinDefinitionOut:function(a){this.context.frames.shift()},visitRuleset:function(a,b){this.context.frames.unshift(a)},visitRulesetOut:function(a){this.context.frames.shift()},visitMedia:function(a,b){this.context.frames.unshift(a.rules[0])},visitMediaOut:function(a){this.context.frames.shift()}},b.exports=g},{"../contexts":10,"./import-sequencer":84,"./visitor":89}],86:[function(a,b,c){var d={Visitor:a("./visitor"),ImportVisitor:a("./import-visitor"),ExtendVisitor:a("./extend-visitor"),JoinSelectorVisitor:a("./join-selector-visitor"),ToCSSVisitor:a("./to-css-visitor")};b.exports=d},{"./extend-visitor":83,
"./import-visitor":85,"./join-selector-visitor":87,"./to-css-visitor":88,"./visitor":89}],87:[function(a,b,c){var d=a("./visitor"),e=function(){this.contexts=[[]],this._visitor=new d(this)};e.prototype={run:function(a){return this._visitor.visit(a)},visitRule:function(a,b){b.visitDeeper=!1},visitMixinDefinition:function(a,b){b.visitDeeper=!1},visitRuleset:function(a,b){var c,d=this.contexts[this.contexts.length-1],e=[];this.contexts.push(e),a.root||(c=a.selectors,c&&(c=c.filter(function(a){return a.getIsOutput()}),a.selectors=c.length?c:c=null,c&&a.joinSelectors(e,d,c)),c||(a.rules=null),a.paths=e)},visitRulesetOut:function(a){this.contexts.length=this.contexts.length-1},visitMedia:function(a,b){var c=this.contexts[this.contexts.length-1];a.rules[0].root=0===c.length||c[0].multiMedia},visitDirective:function(a,b){var c=this.contexts[this.contexts.length-1];a.rules&&a.rules.length&&(a.rules[0].root=a.isRooted||0===c.length||null)}},b.exports=e},{"./visitor":89}],88:[function(a,b,c){var d=a("../tree"),e=a("./visitor"),f=function(a){this._visitor=new e(this),this._context=a};f.prototype={isReplacing:!0,run:function(a){return this._visitor.visit(a)},visitRule:function(a,b){if(!a.variable)return a},visitMixinDefinition:function(a,b){a.frames=[]},visitExtend:function(a,b){},visitComment:function(a,b){if(!a.isSilent(this._context))return a},visitMedia:function(a,b){if(a.accept(this._visitor),b.visitDeeper=!1,a.rules.length)return a},visitImport:function(a,b){if(void 0===a.path.currentFileInfo.reference||!a.css)return a},visitDirective:function(a,b){if("@charset"===a.name){if(!a.getIsReferenced())return;if(this.charset){if(a.debugInfo){var c=new d.Comment("/* "+a.toCSS(this._context).replace(/\n/g,"")+" */\n");return c.debugInfo=a.debugInfo,this._visitor.visit(c)}return}this.charset=!0}if(a.rules&&a.rules.length){if(this._mergeRules(a.rules[0].rules),a.accept(this._visitor),b.visitDeeper=!1,a.getIsReferenced())return a;if(!a.rules||!a.rules.length)return;if(function(a){var b,c=a.rules;1!==c.length||c[0].paths&&0!==c[0].paths.length||(c=c[0].rules);for(var d=0;d<c.length;d++)if(b=c[d],b.getIsReferenced&&b.getIsReferenced())return!0;return!1}(a))return a.markReferenced(),a}else if(a.getIsReferenced())return a},checkPropertiesInRoot:function(a){for(var b,c=0;c<a.length;c++)if((b=a[c])instanceof d.Rule&&!b.variable)throw{message:"properties must be inside selector blocks, they cannot be in the root.",index:b.index,filename:b.currentFileInfo?b.currentFileInfo.filename:null}},visitRuleset:function(a,b){var c,e=[];if(a.firstRoot&&this.checkPropertiesInRoot(a.rules),a.root)a.accept(this._visitor),b.visitDeeper=!1,(a.firstRoot||a.rules&&a.rules.length>0)&&e.splice(0,0,a);else{a.paths&&(a.paths=a.paths.filter(function(a){var b;for(" "===a[0].elements[0].combinator.value&&(a[0].elements[0].combinator=new d.Combinator("")),b=0;b<a.length;b++)if(a[b].getIsReferenced()&&a[b].getIsOutput())return!0;return!1}));for(var f=a.rules,g=f?f.length:0,h=0;h<g;)c=f[h],c&&c.rules?(e.push(this._visitor.visit(c)),f.splice(h,1),g--):h++;g>0?a.accept(this._visitor):a.rules=null,b.visitDeeper=!1,f=a.rules,f&&(this._mergeRules(f),f=a.rules),f&&(this._removeDuplicateRules(f),f=a.rules),f&&f.length>0&&a.paths.length>0&&e.splice(0,0,a)}return 1===e.length?e[0]:e},_removeDuplicateRules:function(a){if(a){var b,c,e,f={};for(e=a.length-1;e>=0;e--)if((c=a[e])instanceof d.Rule)if(f[c.name]){b=f[c.name],b instanceof d.Rule&&(b=f[c.name]=[f[c.name].toCSS(this._context)]);var g=c.toCSS(this._context);b.indexOf(g)!==-1?a.splice(e,1):b.push(g)}else f[c.name]=c}},_mergeRules:function(a){if(a){for(var b,c,e,f={},g=0;g<a.length;g++)(c=a[g])instanceof d.Rule&&c.merge&&(e=[c.name,c.important?"!":""].join(","),f[e]?a.splice(g--,1):f[e]=[],f[e].push(c));Object.keys(f).map(function(a){function e(a){return new d.Expression(a.map(function(a){return a.value}))}if(b=f[a],b.length>1){c=b[0];var g=[],h=[];b.map(function(a){"+"===a.merge&&(h.length>0&&g.push(e(h)),h=[]),h.push(a)}),g.push(e(h)),c.value=function(a){return new d.Value(a.map(function(a){return a}))}(g)}})}},visitAnonymous:function(a,b){if(a.getIsReferenced())return a.accept(this._visitor),a}},b.exports=f},{"../tree":61,"./visitor":89}],89:[function(a,b,c){function d(a){return a}function e(a,b){var c,d;for(c in a)if(a.hasOwnProperty(c))switch(typeof(d=a[c])){case"function":d.prototype&&d.prototype.type&&(d.prototype.typeIndex=b++);break;case"object":b=e(d,b)}return b}var f=a("../tree"),g={visitDeeper:!0},h=!1,i=function(a){this._implementation=a,this._visitFnCache=[],h||(e(f,1),h=!0)};i.prototype={visit:function(a){if(!a)return a;var b=a.typeIndex;if(!b)return a;var c,e=this._visitFnCache,f=this._implementation,h=b<<1,i=1|h,j=e[h],k=e[i],l=g;if(l.visitDeeper=!0,j||(c="visit"+a.type,j=f[c]||d,k=f[c+"Out"]||d,e[h]=j,e[i]=k),j!==d){var m=j.call(f,a,l);f.isReplacing&&(a=m)}return l.visitDeeper&&a&&a.accept&&a.accept(this),k!=d&&k.call(f,a),a},visitArray:function(a,b){if(!a)return a;var c,d=a.length;if(b||!this._implementation.isReplacing){for(c=0;c<d;c++)this.visit(a[c]);return a}var e=[];for(c=0;c<d;c++){var f=this.visit(a[c]);void 0!==f&&(f.splice?f.length&&this.flatten(f,e):e.push(f))}return e},flatten:function(a,b){b||(b=[]);var c,d,e,f,g,h;for(d=0,c=a.length;d<c;d++)if(void 0!==(e=a[d]))if(e.splice)for(g=0,f=e.length;g<f;g++)void 0!==(h=e[g])&&(h.splice?h.length&&this.flatten(h,b):b.push(h));else b.push(e);return b}},b.exports=i},{"../tree":61}],90:[function(a,b,c){function d(){if(!h){h=!0;for(var a,b=g.length;b;){a=g,g=[];for(var c=-1;++c<b;)a[c]();b=g.length}h=!1}}function e(){}var f=b.exports={},g=[],h=!1;f.nextTick=function(a){g.push(a),h||setTimeout(d,0)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=e,f.addListener=e,f.once=e,f.off=e,f.removeListener=e,f.removeAllListeners=e,f.emit=e,f.binding=function(a){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(a){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],91:[function(a,b,c){"use strict";function d(a){function b(a){if(null===i)return void k.push(a);g(function(){var b=i?a.onFulfilled:a.onRejected;if(null===b)return void(i?a.resolve:a.reject)(j);var c;try{c=b(j)}catch(b){return void a.reject(b)}a.resolve(c)})}function c(a){try{if(a===l)throw new TypeError("A promise cannot be resolved with itself.");if(a&&("object"==typeof a||"function"==typeof a)){var b=a.then;if("function"==typeof b)return void f(b.bind(a),c,d)}i=!0,j=a,h()}catch(a){d(a)}}function d(a){i=!1,j=a,h()}function h(){for(var a=0,c=k.length;a<c;a++)b(k[a]);k=null}if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof a)throw new TypeError("not a function");var i=null,j=null,k=[],l=this;this.then=function(a,c){return new l.constructor(function(d,f){b(new e(a,c,d,f))})},f(a,c,d)}function e(a,b,c,d){this.onFulfilled="function"==typeof a?a:null,this.onRejected="function"==typeof b?b:null,this.resolve=c,this.reject=d}function f(a,b,c){var d=!1;try{a(function(a){d||(d=!0,b(a))},function(a){d||(d=!0,c(a))})}catch(a){if(d)return;d=!0,c(a)}}var g=a("asap");b.exports=d},{asap:93}],92:[function(a,b,c){"use strict";function d(a){this.then=function(b){return"function"!=typeof b?this:new e(function(c,d){f(function(){try{c(b(a))}catch(a){d(a)}})})}}var e=a("./core.js"),f=a("asap");b.exports=e,d.prototype=e.prototype;var g=new d(!0),h=new d(!1),i=new d(null),j=new d(void 0),k=new d(0),l=new d("");e.resolve=function(a){if(a instanceof e)return a;if(null===a)return i;if(void 0===a)return j;if(a===!0)return g;if(a===!1)return h;if(0===a)return k;if(""===a)return l;if("object"==typeof a||"function"==typeof a)try{var b=a.then;if("function"==typeof b)return new e(b.bind(a))}catch(a){return new e(function(b,c){c(a)})}return new d(a)},e.all=function(a){var b=Array.prototype.slice.call(a);return new e(function(a,c){function d(f,g){try{if(g&&("object"==typeof g||"function"==typeof g)){var h=g.then;if("function"==typeof h)return void h.call(g,function(a){d(f,a)},c)}b[f]=g,0==--e&&a(b)}catch(a){c(a)}}if(0===b.length)return a([]);for(var e=b.length,f=0;f<b.length;f++)d(f,b[f])})},e.reject=function(a){return new e(function(b,c){c(a)})},e.race=function(a){return new e(function(b,c){a.forEach(function(a){e.resolve(a).then(b,c)})})},e.prototype.catch=function(a){return this.then(null,a)}},{"./core.js":91,asap:93}],93:[function(a,b,c){(function(a){function c(){for(;e.next;){e=e.next;var a=e.task;e.task=void 0;var b=e.domain;b&&(e.domain=void 0,b.enter());try{a()}catch(a){if(i)throw b&&b.exit(),setTimeout(c,0),b&&b.enter(),a;setTimeout(function(){throw a},0)}b&&b.exit()}g=!1}function d(b){f=f.next={task:b,domain:i&&a.domain,next:null},g||(g=!0,h())}var e={task:void 0,next:null},f=e,g=!1,h=void 0,i=!1;if(void 0!==a&&a.nextTick)i=!0,h=function(){a.nextTick(c)};else if("function"==typeof setImmediate)h="undefined"!=typeof window?setImmediate.bind(window,c):function(){setImmediate(c)};else if("undefined"!=typeof MessageChannel){var j=new MessageChannel;j.port1.onmessage=c,h=function(){j.port2.postMessage(0)}}else h=function(){setTimeout(c,0)};b.exports=d}).call(this,a("_process"))},{_process:90}],94:[function(a,b,c){"function"!=typeof Promise.prototype.done&&(Promise.prototype.done=function(a,b){(arguments.length?this.then.apply(this,arguments):this).then(null,function(a){setTimeout(function(){throw a},0)})})},{}],95:[function(a,b,c){a("asap");"undefined"==typeof Promise&&(Promise=a("./lib/core.js"),a("./lib/es6-extensions.js")),a("./polyfill-done.js")},{"./lib/core.js":91,"./lib/es6-extensions.js":92,"./polyfill-done.js":94,asap:93}]},{},[2])(2)}),function(){var a=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(a){return window.setTimeout(a,20)},b=function(c,d){function e(){this.q=[],this.add=function(a){this.q.push(a)};var a,b;this.call=function(){for(a=0,b=this.q.length;a<b;a++)this.q[a].call()}}function f(a,b){return a.currentStyle?a.currentStyle[b]:window.getComputedStyle?window.getComputedStyle(a,null).getPropertyValue(b):a.style[b]}function g(b,c){if(b.resizedAttached){if(b.resizedAttached)return void b.resizedAttached.add(c)}else b.resizedAttached=new e,b.resizedAttached.add(c);b.resizeSensor=document.createElement("div"),b.resizeSensor.className="resize-sensor";var d="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;",g="position: absolute; left: 0; top: 0; transition: 0s;";b.resizeSensor.style.cssText=d,b.resizeSensor.innerHTML='<div class="resize-sensor-expand" style="'+d+'"><div style="'+g+'"></div></div><div class="resize-sensor-shrink" style="'+d+'"><div style="'+g+' width: 200%; height: 200%"></div></div>',b.appendChild(b.resizeSensor),"static"==f(b,"position")&&(b.style.position="relative");var h=b.resizeSensor.childNodes[0],i=h.childNodes[0],j=b.resizeSensor.childNodes[1],k=function(){i.style.width=1e5+"px",i.style.height=1e5+"px",h.scrollLeft=1e5,h.scrollTop=1e5,j.scrollLeft=1e5,j.scrollTop=1e5};k();var l=!1,m=function(){b.resizedAttached&&(l&&(b.resizedAttached.call(),l=!1),a(m))};a(m);var n,o,p,q,r=function(){(p=b.offsetWidth)==n&&(q=b.offsetHeight)==o||(l=!0,n=p,o=q),k()},s=function(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener(b,c)};s(h,"scroll",r),s(j,"scroll",r)}var h=Object.prototype.toString.call(c),i="[object Array]"===h||"[object NodeList]"===h||"[object HTMLCollection]"===h||"undefined"!=typeof jQuery&&c instanceof jQuery||"undefined"!=typeof Elements&&c instanceof Elements;if(i)for(var j=0,k=c.length;j<k;j++)g(c[j],d);else g(c,d);this.detach=function(){if(i)for(var a=0,d=c.length;a<d;a++)b.detach(c[a]);else b.detach(c)}};b.detach=function(a){a.resizeSensor&&(a.removeChild(a.resizeSensor),delete a.resizeSensor,delete a.resizedAttached)},"undefined"!=typeof module&&void 0!==module.exports?module.exports=b:window.ResizeSensor=b}(),define("resize-sensor",function(){}),function(){var a=window.ResizeSensor;"undefined"!=typeof module&&void 0!==module.exports&&(a=require("./ResizeSensor"));var b=this.ElementQueries=function(){function c(a){a||(a=document.documentElement);var b=getComputedStyle(a,"fontSize");return parseFloat(b)||16}function d(a,b){var d=b.replace(/[0-9]*/,"");switch(b=parseFloat(b),d){case"px":return b;case"em":return b*c(a);case"rem":return b*c();case"vw":return b*document.documentElement.clientWidth/100;case"vh":return b*document.documentElement.clientHeight/100;case"vmin":case"vmax":var e=document.documentElement.clientWidth/100,f=document.documentElement.clientHeight/100;return b*(0,Math["vmin"===d?"min":"max"])(e,f);default:return b}}function e(a){this.element=a,this.options={};var b,c,e,f,g,h,i,j=0,k=0;this.addOption=function(a){var b=[a.mode,a.property,a.value].join(",");this.options[b]=a};var l=["min-width","min-height","max-width","max-height"];this.call=function(){j=this.element.offsetWidth,k=this.element.offsetHeight,g={};for(b in this.options)this.options.hasOwnProperty(b)&&(c=this.options[b],e=d(this.element,c.value),f="width"==c.property?j:k,i=c.mode+"-"+c.property,h="","min"==c.mode&&f>=e&&(h+=c.value),"max"==c.mode&&f<=e&&(h+=c.value),g[i]||(g[i]=""),h&&-1===(" "+g[i]+" ").indexOf(" "+h+" ")&&(g[i]+=" "+h));for(var a in l)l.hasOwnProperty(a)&&(g[l[a]]?this.element.setAttribute(l[a],g[l[a]].substr(1)):this.element.removeAttribute(l[a]))}}function f(b,c){b.elementQueriesSetupInformation?b.elementQueriesSetupInformation.addOption(c):(b.elementQueriesSetupInformation=new e(b),b.elementQueriesSetupInformation.addOption(c),b.elementQueriesSensor=new a(b,function(){b.elementQueriesSetupInformation.call()})),b.elementQueriesSetupInformation.call(),n&&o.indexOf(b)<0&&o.push(b)}function g(a,b,c,d){void 0===p[b]&&(p[b]={}),void 0===p[b][c]&&(p[b][c]={}),void 0===p[b][c][d]?p[b][c][d]=a:p[b][c][d]+=","+a}function h(){var a;if(document.querySelectorAll&&(a=document.querySelectorAll.bind(document)),a||"undefined"==typeof $$||(a=$$),a||"undefined"==typeof jQuery||(a=jQuery),!a)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return a}function i(){var a=h();for(var b in p)if(p.hasOwnProperty(b))for(var c in p[b])if(p[b].hasOwnProperty(c))for(var d in p[b][c])if(p[b][c].hasOwnProperty(d))for(var e=a(p[b][c][d]),g=0,i=e.length;g<i;g++)f(e[g],{mode:b,property:c,value:d})}function j(b){function c(){var a,c=!1;for(a in d)d.hasOwnProperty(a)&&e[a].minWidth&&b.offsetWidth>e[a].minWidth&&(c=a);if(c||(c=g),h!=c)if(i[c])d[h].style.display="none",d[c].style.display="block",h=c;else{var j=new Image;j.onload=function(){d[c].src=f[c],d[h].style.display="none",d[c].style.display="block",i[c]=!0,h=c},j.src=f[c]}else d[c].src=f[c]}var d=[],e=[],f=[],g=0,h=-1,i=[];for(var j in b.children)if(b.children.hasOwnProperty(j)&&b.children[j].tagName&&"img"===b.children[j].tagName.toLowerCase()){d.push(b.children[j]);var k=b.children[j].getAttribute("min-width")||b.children[j].getAttribute("data-min-width"),l=b.children[j].getAttribute("data-src")||b.children[j].getAttribute("url");f.push(l);var m={minWidth:k};e.push(m),k?b.children[j].style.display="none":(g=d.length-1,b.children[j].style.display="block")}h=g,b.resizeSensor=new a(b,c),c(),n&&o.push(b)}function k(){for(var a=h(),b=a("[data-responsive-image],[responsive-image]"),c=0,d=b.length;c<d;c++)j(b[c])}function l(a){var b,c;for(a=a.replace(/'/g,'"');null!==(b=q.exec(a));)for(c=b[1]+b[3],attrs=b[2];null!==(attrMatch=r.exec(attrs));)g(c,attrMatch[1],attrMatch[2],attrMatch[3])}function m(a){var b="";if(a)if("string"==typeof a)a=a.toLowerCase(),-1===a.indexOf("min-width")&&-1===a.indexOf("max-width")||l(a);else for(var c=0,d=a.length;c<d;c++)1===a[c].type?(b=a[c].selectorText||a[c].cssText,-1!==b.indexOf("min-height")||-1!==b.indexOf("max-height")?l(b):-1===b.indexOf("min-width")&&-1===b.indexOf("max-width")||l(b)):4===a[c].type&&m(a[c].cssRules||a[c].rules)}var n=!1,o=[],p={},q=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/gim,r=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/gim,s=!1;this.init=function(a){n=void 0!==a&&a;for(var b=0,c=document.styleSheets.length;b<c;b++)try{m(document.styleSheets[b].cssRules||document.styleSheets[b].rules||document.styleSheets[b].cssText)}catch(a){if("SecurityError"!==a.name)throw a}if(!s){var d=document.createElement("style");d.type="text/css",d.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img { width: 100%;}",document.getElementsByTagName("head")[0].appendChild(d),s=!0}i(),k()},this.update=function(a){this.init(a)},this.detach=function(){if(!this.withTracking)throw"withTracking is not enabled. We can not detach elements since we don not store it.Use ElementQueries.withTracking = true; before domready or call ElementQueryes.update(true).";for(var a;a=o.pop();)b.detach(a);o=[]}};b.update=function(a){b.instance.update(a)},b.detach=function(a){a.elementQueriesSetupInformation?(a.elementQueriesSensor.detach(),delete a.elementQueriesSetupInformation,delete a.elementQueriesSensor):a.resizeSensor&&(a.resizeSensor.detach(),delete a.resizeSensor)},b.withTracking=!1,b.init=function(){b.instance||(b.instance=new b),b.instance.init(b.withTracking)};var c=function(a){/*@cc_on
         @if (@_win32 || @_win64)
         document.write('<script id="ieScriptLoad" defer src="//:"><\/script>');
         document.getElementById('ieScriptLoad').onreadystatechange = function() {
         if (this.readyState == 'complete') {
         callback();
         }
         };
         @end @*/
if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var b=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(a(),clearInterval(b))},10);else window.onload=a};b.listen=function(){c(b.init)},"undefined"!=typeof module&&void 0!==module.exports?module.exports=b:(window.ElementQueries=b,b.listen())}(),define("element-queries",["resize-sensor"],function(a){return function(){return a.ElementQueries}}(this)),define("extensions.qliktech/widget/widget-styling",["assets/external/less/less","element-queries","core.utils/deferred"],function(a,b,c){function d(a){return k.test(a)}function e(a){return/\{{[^}]*}}/im.test(a)}function f(a){b.detach(a);for(var c=0;c<a.children.length;++c)f(a.children[c])}function g(a){(j.indexOf(a.htmlElement.id)===-1||a.template.isDirty&&a.template.isDirty())&&(b.init(),j.indexOf(a.htmlElement.id)===-1&&j.push(a.htmlElement.id)),a.$scope.$on("$destroy",function(){j=j.splice(j.indexOf(a.htmlElement.id),1),f(a.$element[0])})}function h(b,c){var d="#widget"+c+" {"+b+"}";return a.render(d)}function i(a,b,e){return b?h(b,e).then(function(b){a.styleElement.innerHTML=b.css,d(b.css)&&g(a)}):(a.styleElement.innerHTML="",c.resolve())}var j=[],k=new RegExp("(?:min|max)-(?:width|height)");return{hasAngularBindings:e,updateLess:i,processLess:h,hasElementQuery:d,enableElementQueries:g}}),define("extensions.qliktech/widget/widget-properties",["util"],function(a){function b(a){return a&&0===a.indexOf(C)?a.substring(9):a}function c(a){return a&&0!==a.indexOf(C)?C+a:a}function d(a,b){var c=b.length,d=0,e=!1;return a?(a.forEach(function(a){if(a.ref&&0===a.ref.indexOf(b)){var f=parseInt(a.ref.substring(c));f>d&&(d=f),D[b]&&f===D[b]+1&&(e=!0)}}),D[b]&&!e||(D[b]=d)):D[b]=0,D[b]+=1,b+D[b]}function e(a,b){a&&a.forEach(function(c,d){c.ref===b&&a.splice(d,1)})}function f(a,b){var c=-1;return a&&a.some(function(a,d){if(a.ref===b)return c=d,!0}),c}function g(a){return a.settings?a.settings.sort(function(a,b){return a.order===b.order?0:!a.order||a.order<b.order?-1:1}):[]}function h(a,b){return a.settings?a.settings.filter(function(a){return(a.parent||B)===b}).sort(function(a,b){return a.order===b.order?0:!a.order||a.order<b.order?-1:1}):[]}function i(b){var d=a.extend(!0,{},b);return d.type=d.type||"string",d.label=d.label||d.ref,d.defaultValue=d.defaultValue||"boolean"!==d.type&&"","string"!==d.type||d.component||(d.expression=d.expression||"optional"),"text"===b.component?delete d.ref:d.ref=c(d.ref),d}function j(a,b){var c={};return h(a,b).forEach(function(a){c[a.ref]=i(a)}),c}function k(a){o(a,y,{ref:B})}function l(a,b){return b===y||(b===z?!m(a)&&!n(a):b===A&&((m(a)||n(a))&&a.sorting!==!0))}function m(a){return void 0!==a.measures&&(a.measures.max>0||void 0===a.measures.max)}function n(a){return void 0!==a.dimensions&&(a.dimensions.max>0||void 0===a.dimensions.max)}function o(a,b,c){switch(b){case z:a.measures={min:1,max:1};break;case y:a.sections=a.sections||[];var e=c||{};e.type=b,e.ref=e.ref||d(a.sections,b),e.label=e.label||"Settings",a.sections.push(e);break;case A:a.sorting=!0}}function p(a,b,c){return b===z?(delete a.measures,delete a.dimensions,void delete a.sorting):b===A?void delete a.sorting:("section-header"===b&&h(a,c).forEach(function(b){t(a,b)}),void e(a.sections,c))}function q(a,b){if(!b||"q"===b.substr(0,1).toLowerCase())return!1;if(x.indexOf(b.toLowerCase())>-1)return!1;var c=!0;return a.settings&&a.settings.forEach(function(a){a.ref===b&&(c=!1)}),c}function r(a,b,c){b=b.item||b,a.settings||(a.settings=[]),a.sections||k(a),b.parent&&"general"!==b.parent||(b.parent=B),b.ref=b.ref||d(a.settings,"property"),b.label=b.label||b.ref.substr(0,1).toUpperCase()+b.ref.substring(1),c||u(a,b),a.settings.push(b)}function s(a,c,d,e,g){c=c.item||c,c.ref=b(c.ref);var h=c.parent===d;void 0===c.order&&(c.order=f(a.settings,c.ref));var i=c.order;c.parent=d,t(a,c,h,g),c.order=e-(c.order<e&&h?1:0),h&&u(a,c,!1,i),r(a,c,h)}function t(a,c,d,f){c=c.item||c,e(a.settings,b(c.ref)),d||u(a,c,!0,null,f)}function u(a,b,c,d,e){var f=h(a,e||b.parent);isNaN(b.order)||b.order>f.length||b.order<0?b.order=f.length:c||void 0===d?c?f.forEach(function(a){a.order>b.order&&a.order--}):f.forEach(function(a){a.order>=b.order&&a.order++}):d<b.order?f.forEach(function(a){a.order>d&&a.order<=b.order&&a.order--}):f.forEach(function(a){a.order>=b.order&&a.order<d&&a.order++})}function v(a){var b={};return a&&a.properties&&(n(a.properties)&&(b.dimensions=a.properties.dimensions),m(a.properties)&&(b.measures=a.properties.measures)),b}function w(a){var b={type:"items",component:"accordion",items:{}};if(a&&a.properties){var c=a.properties;(m(c)||n(c))&&(b.items.data={uses:z,items:{measures:{disabledRef:""},dimensions:{disabledRef:""}}},c.sorting&&(b.items.sorting={uses:A})),b.items.settings={uses:"settings",items:{}},(!c.sections||c.sections.length<1)&&c.settings&&c.settings.length>0&&k(c),c.sections&&c.sections.length>0&&c.sections.forEach(function(a){b.items.settings.items[a.ref]={ref:a.ref,type:"items",label:a.label,items:j(c,a.ref)}})}return b}var x=["showtitles","title","subtitle","footnote"],y="header",z="data",A="sorting",B="settings",C="settings.",D={};return{addScope:c,stripScope:b,canAddSection:l,addSection:o,removeSection:p,addItem:r,removeItem:t,moveItem:s,getData:v,getDefinition:w,isValidRef:q,getSectionItemsArr:h,getSectionsItemsArr:g}}),define("extensions.qliktech/widget/widget",["qvangular","core.utils/deferred","translator","qlik","dev-hub.custom-components/custom-components","objects.extension/default-extension","objects.extension/object-conversion","dev-hub.models/widget-template","./widget-styling","./widget-properties"],function(a,b,c,d,e,f,g,h,i,j){function k(a,b,c,d){d=d&&"hard"===d?" hard-error":" soft-error",a.$scope.error={title:b,message:c},a.htmlElement.innerHTML='<div qv-errorhandler class="object-error'+d+'" ng-class="hard-error" tid="widget.Error"><div class="object-error-content"><div class="object-error-title"><span>{{error.title}}</span>\t</div>\t<div ng-if="error.message" class="object-error-message">{{error.message}}</div></div></div>',m(a.htmlElement)(a.$scope)}function l(a,d,e){var f=e.templateId,g=new b;return a.htmlElement||(a.styleElement=document.createElement("style"),d.appendChild(a.styleElement),a.htmlElement=document.createElement("div"),a.htmlElement.id="widget"+e.qInfo.qId,a.htmlElement.style.height="100%",a.htmlElement.style.overflow="auto",d.appendChild(a.htmlElement)),f?(h.get(f).then(function(b){function d(){function d(b){return i.updateLess(a,b,e.qInfo.qId).catch(function(b){k(a,c.get("Widget.InvalidCss"," "),b.message)})}i.hasAngularBindings(b.css)?m("<style>"+b.css+"</style>")(a.$scope,function(a){n(function(){d(a[0].innerHTML)})}):d(b.css)}a.template=b,f!==a.templateId||a.version!==b.version?(a.templateId=f,a.version=b.version,a.htmlElement.innerHTML=b.html,e.dependencies=b.dependencies,m(a.htmlElement)(a.$scope),d()):(d(),n(function(){g.resolve()}))},function(b){k(a,c.get(b||"Widget.TemplateNotFound",[f]),c.get(b||"Widget.TemplateNotFound",[f])),g.resolve()}),g.promise):(k(a,c.get("Widget.NoTemplate"),f),g.resolve(),g.promise())}var m=a.getService("$compile"),n=a.getService("$timeout");return{initialProperties:{qHyperCubeDef:{qDimensions:[],qMeasures:[],qInitialDataFetch:[{qWidth:10,qHeight:100}]},templateId:""},init:function(a,d){var f=function(){return h.get(d.templateId).then(function(a){return e.init(a.dependencies)},function(){return b.reject(c.get("Widget.TemplateNotFound",[d.widgetMeta&&d.widgetMeta.name||d.templateId,d.widgetMeta&&d.widgetMeta.libid]))})};return d.widgetMeta&&d.widgetMeta.libid?h.getTemplateListFromLibrary(d.widgetMeta.libid).then(function(){return f()}):f()},mapProperties:function(a){var c=this,d=new b,e=h.getLoaded(a.layout.templateId),g={};return e&&e.properties&&(e.properties.measures&&(g.measures=JSON.parse(JSON.stringify(e.properties.measures))),e.properties.dimensions&&(g.dimensions=JSON.parse(JSON.stringify(e.properties.dimensions)))),c.data=j.getData(e),c.definition=j.getDefinition(e),f.mapProperties.apply(c),d.resolve(g),d.promise},support:{cssScaling:!1,snapshot:!0,export:!0,exportData:function(a){return!!a.qHyperCube&&(a.qHyperCube.qDimensionInfo.length>0||a.qHyperCube.qMeasureInfo.length>0)},sharing:!1},importProperties:function(a,b,c){var d=h.getLoaded(b.templateId);c.data=j.getData(d),c.definition=j.getDefinition(d);var e=g.hypercube.importProperties(a,b,c);return b.templateId&&(e.qProperty.templateId=b.templateId,e.qProperty.widgetMeta={libid:d.libid,name:d.name}),c.overrideHasNewType(c),e},paint:function(a,b){return this.$scope.ext.overrideHasNewType(this.$scope.ext),this.$scope.ext.templateId=b.templateId,this.$scope.app||(this.$scope.app=d.currApp(this)),this.$scope.data||(this.$scope.data=d.table(this)),this.$scope.navigation||(this.$scope.navigation=d.navigation),this.$scope.layout=b,this.$scope.settings=b.settings||{},this.$scope.settings.title=b.title,this.$scope.settings.subtitle=b.subtitle,this.$scope.settings.footnote=b.footnote,l(this,a[0],b)},overrideHasNewType:function(a){a.hasNewType=function(a,b,c){return a.ext.templateId!==c.templateId}},controller:["$scope",function(){}]}});